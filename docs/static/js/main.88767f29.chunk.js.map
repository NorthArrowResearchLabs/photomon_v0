{"version":3,"sources":["lib/localdb.js","lib/sensors.js","config.js","components/PhotoSeries/views/tags/XYTagChip.style.js","components/PhotoSeries/views/tags/XYTagChip.jsx","components/PhotoSeries/views/tags/XYTagSelect.jsx","components/PhotoSeries/views/tags/XYTagSelect.style.js","components/PhotoSeries/views/tags/XYTagChooser.jsx","components/PhotoSeries/views/tags/XYTagChooser.style.js","components/PhotoSeries/views/tags/useXYTags.js","components/PhotoSeries/views/subViews/BrokenImg.jsx","components/PhotoSeries/views/subViews/Photo.jsx","components/PhotoSeries/views/subViews/Photo.style.js","lib/useComponentSize.js","lib/SeriesConfig.js","components/PhotoSeries/views/tags/TagChip.jsx","components/PhotoSeries/views/controls/ShortLongText.jsx","lib/Tags.js","components/maps/markers/Dot.jsx","components/maps/BaseStaticMap.jsx","components/maps/MapDot.jsx","mapStyles/index.js","components/maps/controls/StyleButtons.jsx","components/PhotoSeries/views/controls/UserListItem.jsx","components/PhotoSeries/views/dialogs/BigText.jsx","components/PhotoSeries/views/dialogs/DeleteDialog.jsx","components/PhotoSeries/views/dialogs/BigTextEdit.jsx","components/PhotoSeries/views/controls/PhotoFadeSlider.jsx","lib/useCamera.js","components/PhotoSeries/views/controls/TagControl.style.js","components/PhotoSeries/views/controls/TagView.jsx","components/PhotoSeries/views/controls/DateControl.jsx","components/PhotoSeries/views/controls/TagControl.jsx","components/PhotoSeries/views/dialogs/TagEdit.jsx","components/PhotoSeries/views/controls/DateView.jsx","components/PhotoSeries/views/subViews/PhotoInfoInner.jsx","components/maps/markers/MyLocation.jsx","components/maps/controls/MyLocationButton.jsx","components/maps/BaseMap.jsx","components/PhotoSeries/views/dialogs/MapDirPicker.jsx","components/PhotoSeries/views/subViews/SeriesEditInner.jsx","components/PhotoSeries/views/subViews/SeriesEditInner.style.js","components/PhotoSeries/views/subViews/PhotoGrid.jsx","components/PhotoSeries/views/subViews/PhotoGrid.style.js","components/PhotoSeries/views/NewPhoto.jsx","lib/Photo.js","lib/Series.js","lib/datelib.js","lib/useFileInput.js","components/PhotoSeries/views/controls/LibraryFilePicker.jsx","components/PhotoSeries/views/NewPhotoInfo.jsx","components/PhotoSeries/views/NewPhotoInfo.style.js","components/PhotoSeries/views/PhotoReviewTool.jsx","components/PhotoSeries/views/PhotoReviewTool.style.js","components/PhotoSeries/views/CameraTool.jsx","components/PhotoSeries/views/CameraTool.style.js","components/PhotoSeries/contexts.js","lib/util.js","translations.js","graphql/fragments.js","graphql/queries.js","themes/index.js","contexts.js","components/auth/useAuthCommon.js","icons/AppLogo.jsx","components/auth/AuthContainer.jsx","components/auth/Loading.jsx","lib/ErrorBoundary.jsx","components/misc/ErrorScreen.jsx","graphql/mutations.js","graphql/Error.connect.js","lib/useGraphQL.js","components/auth/auth.style.js","components/auth/SignIn.jsx","components/auth/ConfirmSignIn.jsx","components/auth/RequireNewPassword.jsx","components/auth/SignUp.jsx","components/auth/ConfirmSignUp.jsx","components/auth/ForgotPassword.jsx","lib/useAuthentication.js","components/misc/InstallPrompt.jsx","lib/useShowAddToHome.js","lib/useOnline.js","lib/useResponsive.js","redux/actions.js","redux/reducers/map.js","redux/reducers/home.js","redux/reducers/uploader.js","redux/reducers/flags.js","redux/reducers/index.js","redux/storeConfig.js","redux/withReduxProvider.js","components/UploadControl.jsx","lib/s3upload.js","graphql/Uploader.connect.js","permissions.js","components/PhotoSeries/views/QRDisplay.jsx","icons/QRCode.jsx","components/PhotoSeries/views/controls/AddFab.jsx","components/PhotoSeries/views/controls/ContextMenu.jsx","components/PhotoSeries/views/subViews/SeriesInfo.jsx","components/PhotoSeries/views/subViews/SeriesInfo.style.js","components/PhotoSeries/views/subViews/SwipeShow.jsx","components/PhotoSeries/views/subViews/SwipeShow.style.js","components/PhotoSeries/views/SeriesView.style.js","components/PhotoSeries/views/SeriesView.jsx","components/PhotoSeries/views/SeriesEdit.jsx","components/PhotoSeries/views/SeriesEdit.style.js","components/PhotoSeries/views/Slideshow.jsx","components/PhotoSeries/views/Slideshow.style.js","components/PhotoSeries/views/dialogs/CancelConfirm.jsx","components/PhotoSeries/views/subViews/PhotoInfo.jsx","components/PhotoSeries/views/PhotoViewTool.jsx","components/PhotoSeries/views/PhotoViewTool.style.js","lib/AccessHelper.js","components/PhotoSeries/views/SeriesNotFound.jsx","components/PhotoSeries/views/SeriesLoading.jsx","components/PhotoSeries/index.jsx","graphql/Series.connect.js","lib/useClusteredData.js","components/maps/HomeMap.style.js","icons/AppLogoSimple.jsx","icons/Apple.jsx","components/misc/FeatureDisabled.jsx","components/SideDrawer.jsx","components/TopBar.jsx","components/Search/SearchInput.jsx","components/misc/SeriesListItem.jsx","components/misc/ClusterSelected.jsx","components/maps/markers/Single.jsx","components/maps/markers/Cluster.jsx","components/maps/HomeMap.jsx","graphql/Map.connect.js","components/Search/SearchContextItem.jsx","components/Search/SearchContextResults.jsx","components/Search/SearchEnder.jsx","components/Search/SearchResults.jsx","components/Search/SearchPlaceholder.jsx","components/Search/Search.jsx","graphql/Search.connect.js","components/MyProfile/MeCard.jsx","components/MyProfile/MyProfile.jsx","graphql/Profile.connect.js","components/MyFeed/FeedEnder.jsx","components/misc/FindOnMapButton.jsx","components/MyFeed/FeedItem.jsx","components/MyFeed/MyFeed.jsx","graphql/Feed.connect.js","components/PhotoSeries/views/QRReader.jsx","components/misc/OfflineBar.jsx","components/BottomBar.jsx","App.jsx","App.connect.js","serviceWorker.js","index.js"],"names":["dbPromise","openDb","upgradeDB","console","log","store","createObjectStore","localDb","imgStore","catch","e","error","localUUID","prefix","concat","uuidv4","get","_x","_get","apply","this","arguments","_callee","key","db","_Users_matt_Work_Git_PBR_PhotoMonitoring_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default","a","wrap","_context","prev","next","sent","abrupt","transaction","objectStore","stop","setEntry","_x3","_x4","_setEntry","_callee5","val","tx","_context5","put","complete","useGeolocation","_useState","useState","accuracy","altitude","altitudeAccuracy","heading","latitude","longitude","speed","timestamp","Date","now","_useState2","Object","_Users_matt_Work_Git_PBR_PhotoMonitoring_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__","state","setState","mountedRef","useRef","watchIdRef","current","onEvent","event","coords","useEffect","navigator","geolocation","getCurrentPosition","watchPosition","clearWatch","useDeviceOrientation","_useState3","absolute","alpha","beta","gamma","_useState4","deviceOrientation","setDeviceOrientation","handleDeviceOrientation","window","addEventListener","removeEventListener","isIos","test","userAgent","vendor","opera","isPhone","substr","__webpack_require__","d","__webpack_exports__","mapConfig","home","endpoints","aws","ACCESS","_mapStyles__WEBPACK_IMPORTED_MODULE_0__","_material_ui_core_colors__WEBPACK_IMPORTED_MODULE_1__","_material_ui_core_colors__WEBPACK_IMPORTED_MODULE_2__","_material_ui_core_colors__WEBPACK_IMPORTED_MODULE_3__","tagColors","mapBoxToken","process","styles","MapStyles","baseurl","REACT_APP_BASEURL","AppStateTypes","FEED","MAP","SEARCH","PROFILE","SERIES","QRCAPTURE","NEW_SERIES_CAMERA","NEW_SERIES_LIBRARY","SEARCH_TABS","TAG","LOCATION","USER","MapModeTypes","FREE","graphql","Auth","region","userPoolId","userPoolWebClientId","mandatorySignIn","cookieStorage","domain","expires","secure","OPEN","label","description","color","green","PRIVATE","red","PUBLIC","blue","tagChips","useStyles","makeStyles","theme","xyTagChip","cursor","fontSize","background","height","position","left","top","editing","reversedChip","flexDirection","right","deleteIcon","width","chipAvatarIcon","chipAvatar","reversedDelete","margin","chipBucket","display","reversedChipBucket","XYTagChip","_ref","edit","tag","newSize","onTagDragOver","onTagDragStop","onTagDelete","onNewTag","props","objectWithoutProperties","isReversed","relCoords","x","newWidth","classes","useTheme","stopBadness","preventDefault","stopPropagation","react_default","createElement","react_draggable_default","disabled","bounds","bottom","newHeight","y","onDrag","data","onStop","onClick","className","classNames","Chip","assign","style","palette","getContrastText","id","onDelete","Cancel_default","avatar","Avatar","MyLocation_default","root","noOptionsMessage","padding","spacing","singleValue","placeholder","input","valueContainer","flexWrap","flex","alignItems","overflow","paper","zIndex","marginTop","XYTagSelect","tagConfig","onChange","options","values","map","tc","value","allowAdditions","react_select_esm","components","Control","Menu","NoOptionsMessage","Option","Placeholder","ValueContainer","blurInputOnSelect","isClearable","isSearchable","Creatable_default","TextField","fullWidth","InputProps","inputComponent","inputProps","objectSpread","selectProps","inputRef","innerRef","children","innerProps","textFieldProps","_ref2","Typography","_ref3","Paper","square","_ref4","ref","_ref5","isFocused","isSelected","MenuItem","buttonRef","selected","component","fontWeight","_ref6","header","listItem","dlgBody","paddingLeft","paddingRight","paddingBottom","closeButton","grey","XYTagChooser","open","seriesConfig","onClose","xyTags","tags","filter","t","allowXY","Dialog","scroll","fullScreen","paperScrollPaper","aria-labelledby","DialogTitle","IconButton","Close_default","length","variant","tagType","idx","tags_XYTagSelect","useXYTags","photo","setResizeActive","useContext","SeriesContext","slicedToArray","isDragging","setIsDragging","newTagDialog","setNewTagDialog","tagClass","Tags","addTag","__isNew__","createNewXYTagObj","createExistingXYTagObj","toConsumableArray","updateTagLocation","oldTag","newX","parseInt","multiplier","newY","onAddTagTrigger","pageX","innerWidth","pageY","innerHeight","TagChooser","tags_XYTagChooser","Boolean","getRelXYTags","flexGrow","opacity","textAlign","icon","primary","secondary","BrokenImg","BrokenImage_default","inner","transform","img","brokenImg","formControl","Photo","showTags","transition","refImgWrap","setNewSize","url","setUrl","_useState5","_useState6","broken","setBroken","_useState7","_useState8","urlRetryCounter","setURLRetryCounter","_getURL","asyncToGenerator","regenerator_default","mark","dbval","newUrl","indexOf","base64","getPhotoUrl","getURL","_useComponentSize","useComponentSize","_useComponentSize$siz","size","urlWithRetries","_useXYTags","tags_XYTagChip","subViews_BrokenImg","alt","onError","err","setTimeout","src","onLoad","_event$target","target","naturalHeight","naturalWidth","Math","min","getSize","el","minSize","defaultSize","max","offsetWidth","offsetHeight","resizeActiveRef","resizeActive","setComponentSize","handleResize","handleResizeDebounced","useCallback","debounce","useLayoutEffect","ResizeObserver","resizeObserver","observe","disconnect","TYPES","SeriesConfig","_this","_Users_matt_Work_Git_PBR_PhotoMonitoring_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_2__","getTagType","typeId","config","find","tt","getTagTypeIndex","findIndex","getXYTagTypes","getNonXYTagTypes","allowNonXY","getSeriesMeta","keys","meta","type","reduce","acc","_Users_matt_Work_Git_PBR_PhotoMonitoring_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_1__","_Users_matt_Work_Git_PBR_PhotoMonitoring_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__","default","getPhotoMeta","Error","marginRight","TagChip","_Users_matt_Work_Git_PBR_PhotoMonitoring_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_0__","react__WEBPACK_IMPORTED_MODULE_1___default","_material_ui_core_Chip__WEBPACK_IMPORTED_MODULE_2__","_material_ui_icons_Cancel__WEBPACK_IMPORTED_MODULE_3___default","react__WEBPACK_IMPORTED_MODULE_0__","react__WEBPACK_IMPORTED_MODULE_0___default","n","classnames__WEBPACK_IMPORTED_MODULE_1__","classnames__WEBPACK_IMPORTED_MODULE_1___default","_material_ui_core_Typography__WEBPACK_IMPORTED_MODULE_2__","_material_ui_core_FormLabel__WEBPACK_IMPORTED_MODULE_3__","_material_ui_core_styles__WEBPACK_IMPORTED_MODULE_4__","whiteSpace","&::before","content","ShortLongText","text","formLabel","defaultProps","_Users_matt_Work_Git_PBR_PhotoMonitoring_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_1__","findTagById","tagId","getXYTags","xyTagIds","getNonXYTags","NonXYTagIds","createNewTagObj","createExistingTagObj","_Users_matt_Work_Git_PBR_PhotoMonitoring_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_0__","group","main","transformOrigin","rootActive","svgDot","dot","stroke","contrastText","strokeWidth","fill","directionIndicator","name","textShadow","nameActive","dark","Single","direction","version","viewBox","cx","cy","r","svgArc","fillOpacity","strokeOpacity","BaseStaticMap","controlPadding","viewport","mapStyles","onMapDataEvent","passthroughProps","mapRef","currStyle","setCurrStyle","projection","setProjection","recalcProjection","getDistanceScales","useMemo","esm","mapStyle","onData","mapboxApiAccessToken","StyleButtons","Array","isArray","c","handleChild","child","stylechooser","initStyle","MapDot","staticMap","editable","Map","BaseMap","mapProps","touchRotate","dragRotate","showMe","lockPan","onViewportChange","Dot","_Satellite_json__WEBPACK_IMPORTED_MODULE_0__","_TopoMap_json__WEBPACK_IMPORTED_MODULE_1__","_material_ui_icons__WEBPACK_IMPORTED_MODULE_2__","_material_ui_icons__WEBPACK_IMPORTED_MODULE_3__","_material_ui_icons__WEBPACK_IMPORTED_MODULE_4__","_material_ui_icons__WEBPACK_IMPORTED_MODULE_5__","toolTip","Icon","SatelliteOutlined","ActiveIcon","SatIcon","Satellite","TerrainOutlined","Terrain","TopoMap","speedDialFab","border","speedDialAction","marginBottom","speedDialIcon","speedDialLabel","actionsClosed","setOpen","noEventSetOpen","_material_ui_lab_SpeedDial__WEBPACK_IMPORTED_MODULE_2__","ariaLabel","speedDial","fab","_material_ui_lab_SpeedDialAction__WEBPACK_IMPORTED_MODULE_3__","tooltipPlacement","ButtonProps","TooltipClasses","tooltip","tooltipTitle","tooltipOpen","_material_ui_core_ListItem__WEBPACK_IMPORTED_MODULE_1__","_material_ui_core_ListItemText__WEBPACK_IMPORTED_MODULE_2__","_material_ui_core_ListItemAvatar__WEBPACK_IMPORTED_MODULE_3__","_material_ui_core_Avatar__WEBPACK_IMPORTED_MODULE_4__","_material_ui_core_styles__WEBPACK_IMPORTED_MODULE_5__","imgContainer","gravatarImg","objectFit","UserListItem","user","loading","onAvatarClick","button","disableGutters","gravatar","username","_material_ui_core_Typography__WEBPACK_IMPORTED_MODULE_1__","_material_ui_core_DialogContent__WEBPACK_IMPORTED_MODULE_2__","_material_ui_core_Dialog__WEBPACK_IMPORTED_MODULE_3__","_material_ui_core_IconButton__WEBPACK_IMPORTED_MODULE_4__","_material_ui_core_DialogTitle__WEBPACK_IMPORTED_MODULE_5__","_material_ui_icons_Close__WEBPACK_IMPORTED_MODULE_6__","_material_ui_icons_Close__WEBPACK_IMPORTED_MODULE_6___default","_material_ui_core_styles__WEBPACK_IMPORTED_MODULE_7__","body","title","alignSelf","dlgTitle","BigText","maxWidth","disableTypography","_material_ui_core_Dialog__WEBPACK_IMPORTED_MODULE_1__","_material_ui_core_DialogTitle__WEBPACK_IMPORTED_MODULE_2__","_material_ui_core_DialogContent__WEBPACK_IMPORTED_MODULE_3__","_material_ui_core_Button__WEBPACK_IMPORTED_MODULE_4__","_material_ui_core_Typography__WEBPACK_IMPORTED_MODULE_5__","_material_ui_core_DialogActions__WEBPACK_IMPORTED_MODULE_6__","DeleteDialog","message","onConfirm","disableBackdropClick","disableEscapeKeyDown","BigTextEdit","onOk","multiline","setValue","_material_ui_core_DialogTitle__WEBPACK_IMPORTED_MODULE_7__","_material_ui_core_TextField__WEBPACK_IMPORTED_MODULE_5__","rows","rowsMax","defaultValue","_material_ui_core_DialogActions__WEBPACK_IMPORTED_MODULE_4__","_material_ui_core_Button__WEBPACK_IMPORTED_MODULE_6__","sliderLabel","vertical","rail","boxShadow","track","thumb","marginLeft","PhotoFadeSlider","slider","setSlider","_material_ui_lab_Slider__WEBPACK_IMPORTED_MODULE_3__","orientation","useCamera","onCapture","_Users_matt_Work_Git_PBR_PhotoMonitoring_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_4__","cameraError","setCameraError","cameraOnline","setCameraOnline","camRef","Webcam","document","getElementById","setup","then","captureImage","capturedData","takeBase64Photo","quality","captureRawData","takeImageData","webcamElement","canvasElement","location","protocol","hostname","warn","mediaDevices","getUserMedia","aspectRatio","srcObject","getTracks","Promise","resolve","reject","undefined","audio","video","facingMode","mediaStream","URL","createObjectURL","onloadedmetadata","play","onplaying","imageWidth","videoWidth","imageHeight","videoHeight","context","getContext","drawImage","_this$_drawImage","_drawImage","getImageData","_this2","_this$_drawImage2","toBlob","blob","_this$_drawImage3","toDataURL","TagControl_style","tagContainer","actionButtons","TagControl","tagValues","fieldTitle","rootEdit","textBody","DateControl","hint","timestampToHTML5Input","textField","HTML5InputToTimestamp","onSelectChange","inputValue","action","removedValue","option","newVal","tcv","newCreateVal","v","selectOptions","remainingTags","deleteRemoves","isMulti","onMouseDown","onTouchEnd","_ref7","_ref8","_ref9","dlgContent","overflowY","TagEdit","onCancel","DialogContent","controls_TagControl","field","DialogActions","Button","DateView","formatDate","dlgTitleContainer","catTagTitle","paddingTop","DIALOGS","PhotoInfo","canEdit","delta","_useState2$","activeDialog","activeDialogContext","setActiveDialog","tagInst","TagClass","metaKeys","JSON","parse","createdUser","Fragment","Divider","controls_DateControl","takenOn","controls_DateView","note","TagView","List","list","ListItem","ListItemText","render","dialogs_TagEdit","svgAccuracyDot","MyLocation","accHeight","pixelsPerMeter","accWidth","MyLocationButton","Fab","aria-label","initViewport","lockToBounds","incomingOnViewportChange","incomingOnTransitionStart","onTransitionStart","incomingOnTransitionEnd","onTransitionEnd","transitions","mapContainerRef","mapBoxRef","innerTransitionsRef","defaultViewVals","setViewport","isTransitioning","setIsTransitioning","myPosition","geoMarker","markers_MyLocation","zoom","viewportChange","newViewport","getMap","_bounds","minlng","minlat","maxlng","maxlat","_fitBounds","WebMercatorViewport","fitBounds","offset","dragPan","React","cloneElement","hideNavControls","showZoom","touchZoom","scrollZoom","showCompass","controls_MyLocationButton","transitionDuration","transitionInterpolator","FlyToInterpolator","transitionEasing","easeCubic","bearing","pitch","mapWrapper","sliderWrapper","sliderRoot","MapDirPicker","initLat","initLong","initDir","setCoords","setRotation","_ref2$viewport","FormLabel","mapFormLabel","Slider","step","access","accessRadio","grow","mapInnerWrap","minHeight","minWidth","chips","SeriesEditInner","series","FormControlLabel","control","Switch","checked","dialogs_MapDirPicker","newNote","tile","addFab","notDeleteable","unSelectedTile","& img","selectedTile","snackbarContent","backgroundColor","snackbar","PhotoGrid","photos","columns","multiSelect","onTileClick","selectMode","setSelectMode","selectedItems","setSelectedItems","deleteConfirm","setDeleteConfirm","_useContext","ac","handleCancelSelection","toggleListItem","remaining","arrId","sortedPhotos","sort","b","GridList","cols","cellHeight","canDelete","canUser","photoUrl","GridListTile","handlePhotoTap","handleAddToSelection","Remove_default","Add_default","GridListTileBar","Snackbar","autoHideDuration","ContentProps","aria-describedby","confirmation","MODES","NewPhoto","inputMethod","onCreate","isNewSeries","_Users_matt_Work_Git_PBR_PhotoMonitoring_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_2__","newPhoto","setNewPhoto","SeriesClass","newSeries","setNewSeries","photoRefId","setPhotoRefId","history","mode","_changeMode","geo","changeMode","newModeName","_Users_matt_Work_Git_PBR_PhotoMonitoring_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__","react__WEBPACK_IMPORTED_MODULE_3___default","_CameraTool__WEBPACK_IMPORTED_MODULE_7__","onShutter","refId","photoInitObj","PhotoClass","exif","foundIdx","newData","slice","parser","exifParser","create","Buffer","from","stringify","rawData","orient","geolocate","_controls_LibraryFilePicker__WEBPACK_IMPORTED_MODULE_9__","onLibraryAdd","date","String","DateTimeOriginal","GPSLatitude","isNumeric","GPSLongitude","fullNewPhotoObject","_PhotoReviewTool__WEBPACK_IMPORTED_MODULE_6__","defaultRefPhotoId","captured","onRetry","oldHistory","oldMode","pop","_NewPhotoInfo__WEBPACK_IMPORTED_MODULE_8__","onSave","_Users_matt_Work_Git_PBR_PhotoMonitoring_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__","setMeta","convertJSDatetoTimestamp","Series","formatDatAgo","moment__WEBPACK_IMPORTED_MODULE_0__","moment__WEBPACK_IMPORTED_MODULE_0___default","utctimestamp","format","moment","fromNow","jsDate","utc","isoStr","useFileInput","anyFile","clickRef","element","accept","handleChange","evt","file","files","reader","FileReader","onload","result","readAsDataURL","click","fileClickEl","forceClick","LibraryFilePicker","_useFileInput","PhotoLibrary_default","NewPhotoInfo","seriesDelta","setSeriesDelta","photoDelta","setPhotoDelta","CssBaseline","PhotoInfoInner","newAttr","capturedContainer","referenceContainer","reference","referenceTextContainer","newText","refText","PhotoReviewTool","newRefPhoto","p","refPhoto","cameraErrorText","disabledFab","cameraFab","@media (orientation: landscape)","@media (orientation: portrait)","cameraIcon","cancelFab","cancelIcon","swipeDrawer","libraryFab","myLocationFab","myLocationIcon","CameraTool","setRefPhoto","drawerOpen","setDrawerOpen","_useCamera","autoPlay","playsInline","muted","buttonFab","Camera_default","libraryIcon","SwipeableDrawer","anchor","paperAnchorLeft","onOpen","tabIndex","swipeDrawerContainer","role","onKeyDown","createContext","num","isNaN","parseFloat","isFinite","func","wait","immediate","timeout","_len","innerArgs","_key","callNow","clearTimeout","addLocaleData","frLocaleData","IntlWrapper","index_es","locale","photoSummaryFragment","gql","_templateObject","userSummaryFragment","_templateObject2","seriesSummaryFragment","_templateObject3","seriesFragment","_templateObject4","photoFragment","_templateObject5","userFragment","_templateObject6","allSeries","queries_templateObject","pollQuery","queries_templateObject2","userSeries","queries_templateObject3","seriesFromList","queries_templateObject4","queries_templateObject5","seriesWithTag","queries_templateObject6","tagSearch","_templateObject7","getUser","_templateObject8","_templateObject9","geocode","_templateObject10","getMyFeed","_templateObject11","userSearch","_templateObject12","getWholeSeries","_templateObject13","typography","useNextVariants","colors","fade","lighten","topbar","bottombar","login","themes","createMuiTheme","AppContext","useAuthCommon","containerRef","handleKeyPress","found","getElementsByClassName","createSvgIcon","bgSwoosh","spacer","logo","AuthContainer","ThemeProvider","AppLogo","Loading","auth_AuthContainer","ErrorBoundary","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","hasError","info","_this$state","FallbackUI","fallback","Component","SEND_STATES","stack","fontFamily","ErrorScreen","sendState","reportError","dlgOpen","setDialogOpen","setNote","stackEl","buttonText","Error_default","BugReport_default","DialogContentText","autoFocus","deletePhoto","mutations_templateObject","deleteSeries","mutations_templateObject2","updateSeries","mutations_templateObject3","updatePhoto","mutations_templateObject4","createPhoto","mutations_templateObject5","createSeries","mutations_templateObject6","watchSeries","mutations_templateObject7","unWatchSeries","mutations_templateObject8","reportBug","mutations_templateObject9","withReportBugMutation","mutate","_ref$ownProps","ownProps","reduxState","reportJSON","errObj","env","toString","variables","update","connect","other","uploader","newMap","Wrapped","Amplify","configure","LOCAL_STORAGE_TOKEN","useGraphQL","client","setClient","loaded","setLoaded","createApolloClient","getCurrentToken","currSession","currentSession","accessToken","jwtToken","t0","_callee3","onDone","cache","authLink","httpLink","apolloClient","_context3","InMemoryCache","persistCache","storage","localStorage","setContext","_callee2","_","headers","token","newHeaders","_context2","authorization","_x2","createHttpLink","uri","ApolloClient","link","ApolloLink","tokenName","connectToDevTools","auth_style","forgotPassword","switch","switchButton","&:last-child","borderRadius","&:first-child","phoneNumInner","phoneNumDropdown","warnText","fontStyle","noSignin","SignIn","handleSignup","handleForgotPassword","federated","handleInputChange","handleBeAnonymous","handleSignIn","autoComplete","Toolbar","ConfirmSignIn","handleBack","handleConfirm","RequireNewPassword","change","requiredAttributes","placeholders","attribute","SignUp","signUpFields","signUpFieldLabels","signUpFieldPlaceholders","countryDialCodes","defaultDialCode","selectVal","setSelectVal","handleDialCodeChange","f","FormControl","InputLabel","htmlFor","shrink","required","Select","dialCode","ConfirmSignUp","handleResend","Link","resendCode","ForgotPassword","handleSubmit","handleSendCode","setSent","defaultAuthState","authState","authData","signedIn","useAuthentication","setAuth","authScreen","dist","onStateChange","hideDefault","useAuthentication_SignIn","useAuthentication_Loading","useAuthentication_RequireNewPassword","useAuthentication_ConfirmSignIn","useAuthentication_ConfirmSignUp","useAuthentication_ForgotPassword","useAuthentication_SignUp","isGod","signInUserSession","idToken","payload","signOut","forceSignIn","newProps","changeState","signIn","auth_SignIn","SignInOrig","hide","includes","checkCustomSignUpFields","signUpConfig","sortFields","getDefaultDialCode","I18n","signUp","auth_SignUp","SignUpOrig","_this3","confirm","auth_ConfirmSignIn","ConfirmSignInOrig","_this4","resend","auth_ConfirmSignUp","ConfirmSignUpOrig","challengeParam","split","part","charAt","toUpperCase","toLowerCase","join","auth_RequireNewPassword","RequireNewPasswordOrig","auth_Loading","LoadingOrig","_this5","send","submit","auth_ForgotPassword","ForgotPasswordOrig","messageWrapper","animation","@keyframes installPulse","0%","50%","100%","textWrapper","buttons","InstallPrompt","onInstall","anchorOrigin","horizontal","elevation","paragraph","useShowAddToHome","showInstall","dismissInstall","deferredPrompt","setPrompt","handleBeforePrompt","installPrompt","misc_InstallPrompt","addToHomeScreen","prompt","userChoice","choiceResult","outcome","standalone","useOnline","setOnline","setOffline","newDate","online","offlineSince","metaViewports","getState","_window","_window$screen","screen","wOrient","bIsIos","bIsPhone","windowSize","screenSize","activeElement","tagName","querySelector","contentDict","getAttribute","elsplit","defineProperty","setAttribute","useResponsive","mediaQueries","newState","Actions","actions","newDomain","params","flagName","flagVal","viewportSave","uploadObj","newProgress","mapInit","homeInit","initState","activeUpload","defaultFlags","iOSWarning","install","useLoggedOut","combineReducers","newStateHistory","newCurrentState","activeSeries","initialPhoto","newParams","newHistory","newStore","newActive","flags","persistConfig","persistedReducer","persistReducer","rootReducer","storeConfig","preloadedState","createStore","compose","applyMiddleware","thunk","persistor","persistStore","withReduxProvider","BaseComponent","_storeConfig","es","integration_react","msgText","messageInner","UploadControl","progress","LinearProgress","UploadControlCOSMOSWrapper","useWrapperStyles","displayName","updateUploadProgress","completeActiveUpload","formData","base64val","FormData","preAuth","fields","forEach","fieldkey","append","dataURLtoFile","ext","Content-Type","onUploadProgress","progressEvent","total","floor","axios","post","dataurl","filename","arr","mime","match","bstr","atob","u8arr","Uint8Array","charCodeAt","File","interceptors","request","use","response","dispatch","uploadingRef","_doUpload","s3Upload","components_UploadControl","permissions","admin","create:own","read:any","update:any","delete:any","create:any","nonuser","series_public","series_open","read:own","update:own","delete:own","qrPaper","qrCode","QRDisplay","qrCodeEl","setQRCodeEl","obj","encodedId","encodeURI","QRCode","svgStr","dangerouslySetInnerHTML","__html","pulseCol","light","animationIterationCount","animationTimingFunction","@keyframes fabPulse","90%","directionUp","AddFab","onCameraClick","onLibraryClick","down","setDown","timerRef","downRef","onDown","currentTarget","block","cameraAction","libraryAction","AddFab_AddFabIos","rootContainer","SpeedDial","onBlur","disableFocusRipple","onTouchStart","SpeedDialAction","AddAPhoto_default","useIosStyles","AddFabIos","ContextMenu","anchorEl","menuItems","divider","ListItemIcon","primaryTypographyProps","tagListItem","chip","SeriesInfo","seriesConfigInst","SeriesConfigClass","newTags","existing","count","tagKey","idtk","subheading","photoWrapper","dateCaption","mobileStepper","manualBack","manualForward","tagButton","slideshowButton","dots","SwipeShow","onImageSelect","initPhotoIndex","activePhoto","setActivePhoto","setShowTags","singular","react_swipeable_views_lib_default","axis","index","onChangeIndex","enableMouseEvents","KeyboardArrowRight_default","KeyboardArrowLeft_default","subtitle","actionIcon","Badge","badgeContent","Label_default","MobileStepper","steps","activeStep","isFullScreen","slides","SeriesView_style","appBar","-webkit-overflow-scrolling","tabMenu","mapWrap","toolbarTitle","textOverflow","gridList","titleBar","menuButton","placeholderInner","progressWrapper","placeholderText","SeriesView","onSlideshowStart","onEditSeries","onDeletePhotos","onCameraAdd","onDeleteSeries","onMenuBack","onWatch","onUnWatch","watching","owned","contextEl","setContextEl","showQR","setShowQR","can","delete","contribute","listTypeTab","setListTypeTab","AppBar","ArrowBack_default","aria-haspopup","MoreVert_default","controls_ContextMenu","AddAlertIcon","QRCodeIcon","SlideshowIcon","EditIcon","DeleteIcon","Tabs","Tab","subViews_SwipeShow","subViews_SeriesInfo","controls_AddFab","views_QRDisplay","SeriesEdit","setDelta","swipeAble","slideContainer","slide","dotActive","iconButton","active","last","labelBadge","tagChip","Slideshow","_useStepper","useStepper","lastStep","handleForward","paused","pause","showXYTags","setShowXYTags","duration","titlePosition","PlayCircleFilled_default","PauseCircleFilled_default","nextButton","backButton","interval","setActiveStep","setPaused","setLastStep","createTimer","setInterval","oldStep","destroyTimer","clearInterval","CancelConfirm","dirty","newDelta","dialogs_CancelConfirm","appBarEdit","tipChip","activeButton","STATES","PhotoViewTool","initPhotoId","onUpdatePhoto","setMode","tagsClass","desired","onCommitTags","infoButton","Info_default","containerStyle","photoidx","subViews_PhotoInfo","AccessHelper","userSub","permissionObj","ownOrAny","isOwner","attrs","ownAny","perm","otherPerm","attributes","granted","AccessControl","sub","SeriesNotFound","SeriesLoading","CircularProgress","thickness","VIEW_ONLY_MODES","RepeatablePhotos","modeName","inputMethodINIT","currentUserId","currentUserRole","accessControl","onNewSeries","onChangePhoto","onNewPhoto","onDeletePhoto","AccesHelper","seriesState","pid","ph","seriesId","onApprovePhoto","_ref2$photo","onCreateSeries","_ref4$photo","onNewSeriesReturn","newPid","newInputMethod","canUpdate","to","lastMode","views_SeriesLoading","views_SeriesNotFound","views_SeriesView","photoIdArr","sp","views_SeriesEdit","views_PhotoViewTool","views_Slideshow","contexts","Provider","withGetSelectedQuery","skip","withUpdateSeriesMutation","updateSeriesMutation","sanitizeUpdateParams","optimisticResponse","__typename","_ref10","qdata","readQuery","query","writeQuery","qdataAll","limit","summary","seriesSummaries","s","withUpdatePhotoMutation","_ref11","updatePhotoMutation","sanitizedPhotoDelta","newT","_ref12","updatedPhoto","withDeleteSeriesDeleteMutation","_ref13","deleteSeriesMutation","_ref14","withDeletePhotoMutation","_ref15","deletePhotoMutation","photoId","_ref16","finalCount","photoCount","withCreateNewSeries","_ref17","createSeriesMutation","_ownProps$user","meUserSummary","gravatarProfile","featured","latest","updatedUser","createdBy","updatedBy","createdOn","updatedOn","watchers","_ref18","withCreateNewPhoto","_ref19","createPhotoMutation","newPhotoInput","_ownProps$user2","uploadToken","seriesCreatedBy","paths","base","large","orig","medium","_update","_ref20","withWatchSeriesMutation","_ref21","watchSeriesMutation","_ref22","Set","qFeedData","withUnWatchSeriesMutation","_ref23","unWatchSeriesMutation","_ref24","sid","connectedWithApollo","onAfterSeriesDelete","onBack","queueUpload","currentUser","PhotoSeries","photoNoId","photoData","_state$home$current","doneCreatingSeries","inputObj","desiredParams","newDesiredParams","remainder","useClusteredData","filterBounds","currentZoom","sizeScale","queryVersion","clusteredData","setClusteredData","single","cluster","filteredData","setFilteredData","setVersion","updateDataDebounce","updatedData","_args","updateData","filterDataDebounce","filtered","_args2","filterData","filteredClusteredData","tree","rbush","screenCoords","project","properties","zoomLevels","geoJSON","point","clear","load","_loop","z","radius","sqrt","pow","neighbors","search","minX","minY","maxX","maxY","neighbor","newGeoJSON","centroid","featureCollection","uuid","reducedPhotoCount","points","newZ","geometry","coordinates","push","Apple","FeatureDisabled","IconComp","AppleIcon","drawerInner","disableListItem","fullList","SideDrawer","onDisabledClick","onQRClick","AccountCircle_default","loginButton","CloudDownload_default","ExitToApp_default","borderBottom","searchIcon","transparent","iOsIcon","transparentLogo","transparentLogoIcon","qrButton","qrButtonTransparent","TopBar","isTransparent","hideLogo","appleDlg","setAppleDlg","AppLogoSimple","components_SideDrawer","misc_FeatureDisabled","components_TopBar","TopBar_TopBar","useSearchBarStyles","shape","common","white","&:hover","breakpoints","up","inputRoot","inputInput","pointerEvents","justifyContent","SearchInput","debounceSearchText","blur","Search_default","InputBase","chipContainer","accessLabel","accessPUBLIC","accessPRIVATE","accessOPEN","verticalAlign","titleText","dateContainer","dateLabel","dateText","imgFiller","SeriesListItem","showCreatedOn","showLastPhoto","misc_SeriesListItem","ClusterSelected","seriesCount","onZoomTo","ZoomOutMap_default","&.PUBLIC","&.PRIVATE","&.OPEN","avatarActive","badge","badgeActive","Cluster","numeral","& .myPosMarker","& .singleMarker","& .clusterMarker","topBar","loadingWrapper","zoomOutFab","selectedPopup","defaultView","HomeMap","seriesList","onSeriesClick","onSearchClick","pushMapHistory","popMapHistory","clearMapHistory","mapViewObj","setMapViewObj","mapViewRef","homeMapContainerRef","setCurrentZoom","setTransitions","_useState9","_useState10","selectedItem","setSelectedItem","bufferPts","buffer","units","bbox","updateSelectedItem","item","saveMap","object","pts","lngBuff","latBuff","buffBounds","onMarkerClick","LinearInterpolator","markersRendered","offsetLeft","offsetTop","markers_Single","markers_Cluster","selectedItemRender","misc_ClusterSelected","Search_SearchInput","maxZoom","minZoom","viewZoom","getBounds","_map$getBounds","_map$getBounds$_sw","_sw","minLng","lng","minLat","lat","_map$getBounds$_ne","_ne","maxLng","maxLat","oldMinLng","oldMinLat","oldMaxLng","oldMaxLat","onNativeClick","POLL_INTERVAL","withAllSeries","nextToken","fetchMore","updateQuery","fetchMoreResult","setSeriesProps","readyForPolling","withPollQuery","lastCheck","_ref5$ownProps","seriesProps","updateIncrement","changedSeries","oldList","newSeriesSummaries","seriesStatus","polledSeries","ds","oldSeries","oldId","AllSeriesConnect","PollQueryConnect","mapFuncs","tab","setLastCheck","allSeriesQUERY","pollSeriesQUERY","maps_HomeMap","chosenItem","closeIcon","avatarImg","SearchContextItem","TheIcon","PlaceIcon","LabelIcon","PersonIcon","ListItemAvatar","Search_SearchContextItem","overflowX","listSection","ul","SearchContextResults","contextResults","setContextChoice","cr","SearchEnder","ctxItem","SearchResults","contextChoice","onResultClick","listRef","enderRef","handleScroll","_listRef$current","scrollTop","Search_SearchEnder","subheader","onScroll","SearchPlaceholder","PlaceholderIcon","TABS","tabs","ListWrapper","Search","currentTab","setCurrentTab","defaultText","searchText","setSearchText","searchResults","onMapClick","Search_SearchResults","Search_SearchContextResults","Search_SearchPlaceholder","PortableWifiOffIcon","indicatorColor","flexContainer","centered","TAGS","withTagSearch","ceil","withUserSearch","searchStr","withGeoCode","geocoder","relevance","placeName","center","withTagSeries","tagSeries","withUserSeries","defaultTab","jumpToSeries","jumpToMap","bboxFunc","withContextQuery","withSearchQuery","ComposedSearch","newContextChoice","newTab","MeCard","filterContainer","filterChip","seriesListItemWrap","noneFound","SORT","MyProfile","mySeries","watchingSeries","sortVal","setSort","sortAsc","setSortAsc","sortSetter","newSort","tabFeed","firstname","MyProfile_MeCard","MyProfile_FilterSortItem","asc","useFilterStyles","FilterSortItem","arrow","withuserSeriesQuery","seriesQ","withMyWatchedSeriesQuery","watchedSeriesQ","queryWrapped","arraySeries","components_MyProfile_MyProfile","FeedEnder","placeAvatar","placeIcon","FindOnMapButton","Place_default","findOnMapButtonContainer","titleContainer","seriesName","EVENT_VERBS","FeedItem","onImageClick","onProfileClick","misc_FindOnMapButton","listContainer","vList","feedContainer","MyFeed","events","fetchNewest","dist_es","rowCount","rowHeight","rowRenderer","isScrolling","isVisible","parent","row","MyFeed_FeedItem","wEnd","MyFeed_FeedEnder","almostAtEnd","ROWHEIGHT","withFeedQuery","loadingNewest","loadingMore","myFeed","start","feed","end","jumpToUser","components_MyFeed_MyFeed","qrIcon","tipPaper","docContainer","cameraContainer","snackErr","snackSuccess","snackMsg","QRReader","capturedImg","setCapturedImg","setErr","code","setCode","captureFunc","scannedCode","decodedUrl","jsQRFromBase64","decodeURI","t1","scan","SnackbarContent","jsQR","OfflineBar","sinceStr","setSinceStr","calcSinceStr","clearTimer","homeConfig","borderTop","BottomBar","onHomeClick","edge","HomeOutlined_default","MapOutlined_default","SearchOutlined_default","PersonOutline_default","components_BottomBar","outerRoot","offlineBar","activeWrapper","flexShrink","uploaderContainer","App","onQRCapture","setHomeState","showBottomBar","activeProps","ActiveComponent","FeedConnect","MapConnect","ProfileConnect","SearchConnect","SeriesConnect","misc_OfflineBar","Uploader_connect","App_connect","setUseOffline","bVal","_useAuthentication","_useGraphQL","apolloLoaded","_useOnline","_useShowAddToHome","responsive","appContext","getValues","react_apollo_esm","translations_IntlWrapper","lib_ErrorBoundary","ErrorConnect","isLocalhost","registerValidSW","swUrl","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","onUpdate","onSuccess","require","ReactDOM","href","origin","fetch","contentType","status","ready","unregister","reload","checkValidServiceWorker"],"mappings":"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","file":"static/js/main.88767f29.chunk.js","sourcesContent":["import { openDb } from 'idb'\nimport { localDb } from '../config'\nimport uuidv4 from 'uuid/v4'\n\n/**\n * This is a leftover from the original, static RepeatablePhotos app.\n * For now it's just a decent way of storing the image data\n */\nconst dbPromise = openDb('serieslistDB', 1, upgradeDB => {\n  console.log('UPGRADE NEEDED', upgradeDB)\n  const store = upgradeDB.createObjectStore(localDb.imgStore)\n  console.log('UPGRADE NEEDED STORE', store)\n}).catch(e => {\n  console.error('ERROR', e)\n})\n\nexport const localUUID = (prefix) => {\n  return `__LOCAL_${prefix}::${uuidv4()}`\n}\n\nexport async function get (key) {\n  const db = await dbPromise\n  return db.transaction(localDb.imgStore).objectStore(localDb.imgStore).get(key)\n    .catch(() => false)\n}\nexport async function hasKey (key) {\n  const db = await dbPromise\n  return db.transaction(localDb.imgStore).objectStore(localDb.imgStore).getKey(key)\n    .then(() => true)\n    .catch(() => false)\n}\nexport async function getAll () {\n  const db = await dbPromise\n  return db.transaction(localDb.imgStore).objectStore(localDb.imgStore).getAll()\n}\nexport async function getOne () {\n  const db = await dbPromise\n  return db.transaction(localDb.imgStore).objectStore(localDb.imgStore).getAll(null, 1)\n}\nexport async function setEntry (key, val) {\n  const db = await dbPromise\n  const tx = db.transaction(localDb.imgStore, 'readwrite')\n  tx.objectStore(localDb.imgStore).put(val, key)\n  return tx.complete\n}\nexport async function deleteEntry (key) {\n  const db = await dbPromise\n  const tx = db.transaction(localDb.imgStore, 'readwrite')\n  tx.objectStore(localDb.imgStore).delete(key)\n  return tx.complete\n}\nexport async function clear () {\n  const db = await dbPromise\n  const tx = db.transaction(localDb.imgStore, 'readwrite')\n  tx.objectStore(localDb.imgStore).clear()\n  return tx.complete\n}\nexport async function keys () {\n  const db = await dbPromise\n  return db.transaction(localDb.imgStore).objectStore(localDb.imgStore).getAllKeys()\n}\n","import { useState, useEffect, useRef } from 'react'\n\nexport const useGeolocation = () => {\n  const [state, setState] = useState({\n    accuracy: null,\n    altitude: null,\n    altitudeAccuracy: null,\n    heading: null,\n    latitude: null,\n    longitude: null,\n    speed: null,\n    timestamp: Date.now()\n  })\n  const mountedRef = useRef()\n  const watchIdRef = useRef()\n  mountedRef.current = true\n\n  const onEvent = event => {\n    if (mountedRef.current) {\n      setState({\n        accuracy: event.coords.accuracy,\n        altitude: event.coords.altitude,\n        altitudeAccuracy: event.coords.altitudeAccuracy,\n        heading: event.coords.heading,\n        latitude: event.coords.latitude,\n        longitude: event.coords.longitude,\n        speed: event.coords.speed,\n        timestamp: event.timestamp\n      })\n    }\n  }\n\n  useEffect(() => {\n    navigator.geolocation.getCurrentPosition(onEvent)\n    watchIdRef.current = navigator.geolocation.watchPosition(onEvent)\n\n    return () => {\n      mountedRef.current = false\n      navigator.geolocation.clearWatch(watchIdRef.current)\n    }\n  }, [navigator.geolocation])\n\n  return state\n}\n\nexport function useDeviceOrientation () {\n  const [deviceOrientation, setDeviceOrientation] = useState({ absolute: false, alpha: null, beta: null, gamma: null })\n\n  function handleDeviceOrientation (event) {\n    setDeviceOrientation({\n      absolute: event.absolute,\n      alpha: event.alpha,\n      beta: event.beta,\n      gamma: event.gamma\n    })\n  }\n\n  useEffect(() => {\n    window.addEventListener('deviceorientation', handleDeviceOrientation, true)\n\n    return () => {\n      window.removeEventListener('deviceorientation', handleDeviceOrientation)\n    }\n  }, [])\n\n  return deviceOrientation\n}\n\nexport function playClickAudio (clickSound) {\n  let audio = new Audio('data:audio/mp3;base64,' + clickSound.base64)\n  audio.play()\n}\n\n// Detects if device is on iOS\nexport const isIos = () => {\n  return /iphone|ipad|ipod/i.test(window.navigator.userAgent || navigator.vendor || window.opera || '')\n}\n\nexport const isPhone = () => {\n  const a = (window.navigator.userAgent || navigator.vendor || window.opera || '')\n  return /(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i\n    .test(a) ||\n  /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i\n    .test(a.substr(0, 4))\n}\n","import MapStyles from './mapStyles'\nimport {\n  green, blue, red\n} from '@material-ui/core/colors'\n\nexport default {\n  // Bright Pastel\n  tagColors: [\n    '#418CF0', '#FCB441', '#E0400A', '#056492', '#BFBFBF', '#1A3B69', '#FFE382', '#129CDD', '#CA6B4B',\n    '#005CDB', '#F3D288', '#506381', '#F1B9A8', '#E0830A', '#7893BE'\n  ]\n}\n\nexport const mapConfig = {\n  mapBoxToken: process.env.REACT_APP_MAPBOX_TOKEN,\n  styles: MapStyles\n}\n\nlet baseurl = process.env.REACT_APP_BASEURL\nlet basename = process.env.REACT_APP_BASENAME\nlet domain = process.env.REACT_APP_DOMAIN\nif (process.env.NODE_ENV && process.env.NODE_ENV === 'development') {\n  domain = 'localhost'\n  basename = ''\n}\nconsole.log('config: ', baseurl, basename)\n\nexport const home = {\n  AppStateTypes: {\n    FEED: 'feed', // Looking at the Home Feed\n    MAP: 'map', // Looking at the map\n    SEARCH: 'search', // looking at the search\n    PROFILE: 'profile', // Looking at user information\n    SERIES: 'series', // Looking at one particular series\n    QRCAPTURE: 'QRCapture', // Capture a QRCode\n    NEW_SERIES_CAMERA: 'new_series_camera', // Looking at one particular sereis\n    NEW_SERIES_LIBRARY: 'new_series_library' // Looking at one particular sereis\n  },\n  SEARCH_TABS: {\n    TAG: 'tag',\n    LOCATION: 'location',\n    USER: 'user'\n  },\n  MapModeTypes: {\n    FREE: 'free', //\n    USER: 'user', // filtered to a given user\n    TAG: 'tag' // filtered to a given tag\n  }\n}\n\nexport const federated = {\n  // oauth_config: {\n\n  // },\n  // google_client_id: process.env.REACT_APP_GOOGLE_APP_ID\n}\n\nexport const endpoints = {\n  graphql: process.env.REACT_APP_GRAPHQL\n}\n\nexport const localDb = {\n  imgStore: 'imgStore'\n}\n\nexport const aws = {\n  Auth: {\n    // REQUIRED - Amazon Cognito Identity Pool ID\n    // identityPoolId: process.env.REACT_APP_COGNITO_IDPOOLID, // XX-XXXX-X:XXXXXXXX-XXXX-1234-abcd-1234567890ab\n    // REQUIRED - Amazon Cognito Region\n    region: process.env.REACT_APP_AWS_REGION,\n    // OPTIONAL - Amazon Cognito User Pool ID\n    userPoolId: process.env.REACT_APP_COGNITO_USER_POOL_ID,\n    // OPTIONAL - Amazon Cognito Web Client ID (26-char alphanumeric string)\n    userPoolWebClientId: process.env.REACT_APP_COGNITO_CLIENT_ID,\n    // OPTIONAL - Enforce user authentication prior to accessing AWS resources or not\n    mandatorySignIn: true,\n    // OPTIONAL - Configuration for cookie storage\n    cookieStorage: {\n      // REQUIRED - Cookie domain (only required if cookieStorage is provided)\n      domain: `${domain}`,\n      // OPTIONAL - Cookie path\n      // path: `/${basename}`,\n      // OPTIONAL - Cookie expiration in days\n      expires: 20,\n      // OPTIONAL - Cookie secure flag\n      secure: false\n    }\n\n  }\n\n}\n\nexport const ACCESS = {\n  OPEN: {\n    label: 'Open',\n    description: 'Anyone can see and contribute photos to this series.',\n    color: green\n  },\n  PRIVATE: {\n    label: 'Private',\n    description: 'Can only be seen by their createors',\n    color: red\n  },\n  PUBLIC: {\n    label: 'Public',\n    description: 'Anyone can see this series. Only the owner can add photos.',\n    color: blue\n  }\n}\n","const tagChips = {\n  height: 20\n}\n\nexport default theme => ({\n  xyTagChip: {\n    cursor: 'pointer',\n    color: 'white',\n    fontSize: '0.6em',\n    background: '#444444',\n    height: tagChips.height,\n    position: 'absolute',\n    left: -tagChips.height / 2,\n    top: -tagChips.height / 2\n  },\n  editing: {\n    // color: 'white',\n    // background: theme.palette.secondary.main\n  },\n  // The tag is flipped on the right side of the screen\n  reversedChip: {\n    flexDirection: 'row-reverse',\n    left: 'unset',\n    right: -tagChips.height / 2\n  },\n  deleteIcon: {\n    // color: 'white',\n    width: tagChips.height - 1,\n    height: tagChips.height - 1\n  },\n  chipAvatarIcon: {\n    color: 'white',\n    width: tagChips.height - 4,\n    height: tagChips.height - 4\n  },\n  chipAvatar: {\n    background: 'inherit',\n    width: tagChips.height,\n    height: tagChips.height\n  },\n  reversedDelete: {\n    margin: `0 -${tagChips.height / 8}px 0 ${tagChips.height / 8}px`\n  },\n  // The chip bucket is the container div for the chip and represents the\n  // Actual XY coordinates. The chip itself is offset to make the\n  chipBucket: {\n    width: 1,\n    height: 1,\n    display: 'flex',\n    flexDirection: 'row',\n    position: 'absolute'\n  },\n  reversedChipBucket: {\n    flexDirection: 'row-reverse'\n  }\n})\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport Draggable from 'react-draggable'\n\nimport Chip from '@material-ui/core/Chip'\nimport Avatar from '@material-ui/core/Avatar'\n\nimport CancelIcon from '@material-ui/icons/Cancel'\nimport MyLocation from '@material-ui/icons/MyLocation'\n\nimport { makeStyles, useTheme } from '@material-ui/core/styles'\nimport style from './XYTagChip.style'\n\nconst useStyles = makeStyles(style)\n\nconst XYTagChip = ({\n  color, edit, tag, newSize,\n  onTagDragOver, onTagDragStop, onNewTag, onTagDelete, ...props\n}) => {\n  const isReversed = tag.relCoords.x > newSize.newWidth / 2\n  const classes = useStyles()\n  const theme = useTheme()\n  const stopBadness = (e) => {\n    e.preventDefault()\n    e.stopPropagation()\n  }\n\n  const handleDrag = (e, data) => {\n    stopBadness(e)\n    onTagDragOver(data, tag)\n  }\n  const handleStopDrag = (e, data) => {\n    stopBadness(e)\n    onTagDragStop(data, tag)\n  }\n\n  // Draggable chip if it is editable\n  return (\n    <Draggable\n      disabled={!edit}\n      bounds={{ left: 10, top: 10, right: newSize.newWidth - 10, bottom: newSize.newHeight - 10 }}\n      position={{ x: tag.relCoords.x, y: tag.relCoords.y }}\n      onDrag={handleDrag}\n      onStop={handleStopDrag}\n      onClick={stopBadness}\n    >\n      <div className={classNames(classes.chipBucket, isReversed && classes.reversedChipBucket)}>\n        <Chip\n          style={{\n            background: color ? `${color}!important` : null,\n            color: color ? `${theme.palette.getContrastText(color)}!important` : null\n          }}\n          color={edit ? 'secondary' : 'default'}\n          label={tag.label}\n          data={tag.id}\n          onClick={stopBadness}\n          onDelete={edit ? onTagDelete(tag) : null}\n          deleteIcon={edit ? <CancelIcon className={classNames(classes.deleteIcon, isReversed && classes.reversedDelete)} /> : <div />}\n          className={classNames(\n            classes.xyTagChip,\n            isReversed && classes.reversedChip,\n            edit && classes.editing\n          )}\n          {...props}\n          avatar={<Avatar className={classNames(classes.chipAvatar, edit && classes.editing)}>\n            <MyLocation className={classNames(classes.chipAvatarIcon, edit && classes.editing)} />\n          </Avatar>}\n        />\n      </div>\n    </Draggable>\n  )\n}\n\nXYTagChip.propTypes = {\n  color: PropTypes.string,\n  edit: PropTypes.bool,\n  tag: PropTypes.object.isRequired,\n  newSize: PropTypes.object,\n  onTagDragOver: PropTypes.func,\n  onTagDragStop: PropTypes.func,\n  onNewTag: PropTypes.func,\n  onTagDelete: PropTypes.func\n}\n\nexport default XYTagChip\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\nimport Paper from '@material-ui/core/Paper'\nimport Typography from '@material-ui/core/Typography'\nimport TextField from '@material-ui/core/TextField'\nimport MenuItem from '@material-ui/core/MenuItem'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport Select from 'react-select'\nimport CreatableSelect from 'react-select/lib/Creatable'\nimport style from './XYTagSelect.style'\n\nconst useStyles = makeStyles(style)\n\nconst XYTagSelect = ({ tagConfig, onChange }) => {\n  const classes = useStyles()\n  const options = tagConfig.values.map(tc => ({ label: tc.label, value: tc.id }))\n  console.log('XYTagSelect', tagConfig)\n  return (\n    <div className={classes.root}>\n      {!tagConfig.allowAdditions && (\n        <Select\n          options={options}\n          classes={classes}\n          components={{\n            Control,\n            Menu,\n            NoOptionsMessage,\n            Option,\n            Placeholder,\n            ValueContainer\n          }}\n          value={null}\n          // onBlur={e => e.preventDefault()}\n          blurInputOnSelect\n          isClearable={false}\n          onChange={onChange}\n          placeholder={tagConfig.label}\n          isSearchable\n        />\n      ) }\n      { tagConfig.allowAdditions && (\n        <CreatableSelect\n          options={options}\n          classes={classes}\n          components={{\n            Control,\n            Menu,\n            NoOptionsMessage,\n            Option,\n            Placeholder,\n            ValueContainer\n          }}\n          value={null}\n          isClearable={false}\n          // onBlur={e => e.preventDefault()}\n          blurInputOnSelect\n          onChange={onChange}\n          placeholder={tagConfig.label}\n          isSearchable\n        />\n      )}\n    </div>\n  )\n}\nXYTagSelect.propTypes = {\n  tagConfig: PropTypes.object.isRequired,\n  onChange: PropTypes.func.isRequired\n}\n\nexport default XYTagSelect\n\nfunction Control (props) {\n  return (\n    <TextField\n      fullWidth\n      InputProps={{\n        inputComponent,\n        inputProps: {\n          className: props.selectProps.classes.input,\n          inputRef: props.innerRef,\n          children: props.children,\n          ...props.innerProps\n        }\n      }}\n      {...props.selectProps.textFieldProps}\n    />\n  )\n}\n\nconst NoOptionsMessage = ({ innerProps, selectProps, children }) => (\n  <Typography\n    color='textSecondary'\n    className={selectProps.classes.noOptionsMessage}\n    {...innerProps}\n  >\n    {children}\n  </Typography>\n)\n\nconst Menu = ({ selectProps, innerProps, children }) => (\n  <Paper square className={selectProps.classes.paper} {...innerProps}>\n    {children}\n  </Paper>\n)\n\nconst inputComponent = ({ inputRef, ...props }) => <div ref={inputRef} {...props} />\n\nconst Placeholder = (props) => (\n  <Typography\n    color='textSecondary'\n    className={props.selectProps.classes.placeholder}\n    {...props.innerProps}\n  >\n    {props.children}\n  </Typography>\n)\n\nconst Option = ({ innerRef, isFocused, isSelected, innerProps, children }) => (\n  <MenuItem\n    buttonRef={innerRef}\n    selected={isFocused}\n    component='div'\n    style={{ fontWeight: isSelected ? 500 : 400 }}\n    {...innerProps}\n  >\n    {children}\n  </MenuItem>\n)\n\nconst ValueContainer = ({ selectProps, children }) => (\n  <div className={selectProps.classes.valueContainer}>{children}</div>\n)\nValueContainer.propTypes = {\n  selectProps: PropTypes.object.isRequired,\n  children: PropTypes.any\n}\n","export default theme => ({\n  root: {\n    width: '100%'\n  },\n  noOptionsMessage: {\n    padding: `${theme.spacing(1)}px ${theme.spacing(1) * 2}px`\n  },\n  singleValue: {\n    fontSize: 16\n  },\n  placeholder: {\n    position: 'absolute',\n    left: 2,\n    fontSize: 16\n  },\n  input: {\n    display: 'flex',\n    padding: 0\n  },\n  valueContainer: {\n    display: 'flex',\n    flexWrap: 'wrap',\n    flex: 1,\n    alignItems: 'center',\n    overflow: 'hidden'\n  },\n  paper: {\n    position: 'absolute',\n    zIndex: 100,\n    marginTop: theme.spacing(1),\n    left: 0,\n    right: 0\n  }\n})\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport Typography from '@material-ui/core/Typography'\nimport IconButton from '@material-ui/core/IconButton'\n\nimport CloseIcon from '@material-ui/icons/Close'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport XYTagSelect from './XYTagSelect'\nimport style from './XYTagChooser.style'\n\nconst useStyles = makeStyles(style)\n\nconst XYTagChooser = ({ coords, open, seriesConfig, onNewTag, onClose }) => {\n  const classes = useStyles()\n  const xyTags = seriesConfig.tags.filter(t => t.allowXY)\n  if (!coords) return null\n  return (\n    <Dialog\n      open={open}\n      scroll='paper'\n      fullScreen\n      classes={{ paperScrollPaper: classes.root }}\n      onClose={() => onClose()}\n      aria-labelledby='simple-dialog-title'\n    >\n      <DialogTitle id='simple-dialog-title' className={classes.header}>\n      New Tag:\n        <IconButton className={classes.closeButton} onClick={onClose}>\n          <CloseIcon />\n        </IconButton>\n      </DialogTitle>\n      <div className={classes.dlgBody}>\n        {xyTags.length > 1 && (\n          <Typography variant='caption'>What kind of tag would you like to create?</Typography>\n        )}\n\n        {xyTags.map((tagType, idx) => (\n          <div className={classes.listItem} key={`tagSelect${idx}`}>\n            <XYTagSelect tagConfig={tagType} onChange={onNewTag(coords, tagType)} />\n          </div>\n        ))}\n      </div>\n    </Dialog>\n  )\n}\n\nXYTagChooser.propTypes = {\n  seriesConfig: PropTypes.object.isRequired,\n  open: PropTypes.bool.isRequired,\n  coords: PropTypes.object,\n  onClose: PropTypes.func.isRequired,\n  onNewTag: PropTypes.func.isRequired\n}\n\nexport default XYTagChooser\n","export default theme => ({\n  root: {\n    overflow: 'visible'\n  },\n  header: {\n    padding: theme.spacing(1) * 2\n  },\n  listItem: {\n    flexDirection: 'column'\n  },\n  dlgBody: {\n    paddingLeft: theme.spacing(1) * 2,\n    paddingRight: theme.spacing(1) * 2,\n    paddingBottom: theme.spacing(1) * 2\n  },\n  closeButton: {\n    position: 'absolute',\n    right: theme.spacing(1),\n    top: theme.spacing(1),\n    color: theme.palette.grey[500]\n  }\n})\n","import React, { useState, useContext } from 'react'\nimport { SeriesContext } from '../../contexts'\nimport XYTagChooser from './XYTagChooser'\nimport Tags from '../../../../lib/Tags'\n\nconst useXYTags = (photo, newSize, onChange, setResizeActive) => {\n  const { seriesConfig } = useContext(SeriesContext)\n\n  // we hold the tags in state so that every little drag motion\n  // doesn't cause an updated state until you let go\n  const [isDragging, setIsDragging] = useState(false)\n  const [newTagDialog, setNewTagDialog] = useState(null)\n\n  const tagClass = new Tags(seriesConfig, photo.tags)\n\n  const onNewTag = (coords, tagType) => ({ value, __isNew__: isNew }) => {\n    let addTag = isNew\n      ? tagClass.createNewXYTagObj(value, tagType.id, coords)\n      : tagClass.createExistingXYTagObj(value, tagType.id, coords)\n\n    setNewTagDialog(null)\n    onChange({ ...photo, tags: [...photo.tags, addTag] })\n  }\n\n  const onTagDelete = (tag) => () => {\n    const tags = photo.tags.filter(oldTag => oldTag.id !== tag.id)\n    onChange({\n      ...photo,\n      tags\n    })\n  }\n\n  // When the photo is tapped, send the x,y coords of that tap\n  // to a dialog we will open\n  const onAddTagTrigger = (e) => {\n    if (!newTagDialog) {\n      // Turn off resizing so mobile keyboards don't complete F us.\n      setResizeActive(false)\n      setNewTagDialog({\n        x: parseInt(e.pageX - (window.innerWidth - newSize.newWidth) / 2 * newSize.multiplier, 10),\n        y: parseInt(e.pageY - (window.innerHeight - newSize.newHeight) / 2 * newSize.multiplier, 10)\n      })\n    }\n  }\n\n  // This gets used by the drag AND the stop\n  const updateTagLocation = ({ x, y }, tag) => {\n    const newTags = photo.tags.map(oldTag => {\n      if (oldTag.id !== tag.id) return oldTag\n      else {\n        let newX = parseInt(x / newSize.multiplier, 10)\n        let newY = parseInt(y / newSize.multiplier, 10)\n\n        return {\n          ...oldTag,\n          coords: { x: newX, y: newY }\n        }\n      }\n    })\n    return newTags\n  }\n\n  const onTagDragStop = (coords, tag) => {\n    const tags = updateTagLocation(coords, tag)\n    setIsDragging(false)\n    onChange({\n      ...photo,\n      tags\n    })\n  }\n\n  const onTagDragOver = (coords, tag) => {\n    updateTagLocation(coords, tag)\n    setIsDragging(true)\n  }\n  const TagChooser = () => (\n    <XYTagChooser\n      open={!isDragging && Boolean(newTagDialog)}\n      coords={newTagDialog}\n      seriesConfig={seriesConfig}\n      onNewTag={onNewTag}\n      onClose={() => {\n        setNewTagDialog(null)\n        // Turn on resizing again.\n        setResizeActive(true)\n      }}\n    />\n  )\n\n  return {\n    onNewTag,\n    onTagDelete,\n    onAddTagTrigger,\n    onTagDragOver,\n    onTagDragStop,\n    TagChooser,\n    getRelXYTags: tagClass.getRelXYTags\n  }\n}\n\nexport default useXYTags\n","import React from 'react'\nimport Typography from '@material-ui/core/Typography'\nimport BrokenImageIcon from '@material-ui/icons/BrokenImage'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    flexGrow: 1,\n    padding: '10%',\n    display: 'flex',\n    flexDirection: 'column',\n    opacity: 0.3,\n    textAlign: 'center',\n    color: theme.palette.grey[100]\n  },\n  icon: {\n    width: '100%',\n    flex: '1 1 40%',\n    color: theme.palette.grey[100],\n    opacity: 0.5\n  },\n  primary: {\n    color: theme.palette.grey[100],\n    textAlign: 'center',\n    flex: '1 1 30%',\n    width: '100%'\n  },\n  secondary: {\n    flex: '1 1 30%',\n    width: '100%'\n  }\n}))\n\nconst BrokenImg = () => {\n  const classes = useStyles()\n  return (\n    <div className={classes.root}>\n      <BrokenImageIcon className={classes.icon} />\n      <Typography className={classes.primary}>Img not found</Typography>\n    </div>\n  )\n}\n\nexport default BrokenImg\n","import React, { useState, useRef, useContext, useEffect } from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport { get } from '../../../../lib/localdb' // get, setEntry\nimport useComponentSize from '../../../../lib/useComponentSize'\n\nimport { SeriesContext } from '../../contexts'\nimport XYTagChip from '../tags/XYTagChip'\nimport useXYTags from '../tags/useXYTags'\nimport BrokenImg from './BrokenImg'\nimport style from './Photo.style'\n\nconst useStyles = makeStyles(style)\n\nconst Photo = ({ photo, opacity, edit, showTags, transition, onChange, className }) => {\n  const classes = useStyles()\n  const refImgWrap = useRef(null)\n  const [newSize, setNewSize] = useState({ multiplier: 1 })\n  const [url, setUrl] = useState(null)\n  const [broken, setBroken] = useState(false)\n  const [urlRetryCounter, setURLRetryCounter] = useState(0)\n  const { seriesConfig } = useContext(SeriesContext)\n\n  useEffect(() => {\n    async function getURL () {\n      // If this image hasn't been uploaded yet then go get it from indexDB\n      if (photo.id.indexOf('__LOCAL_') === 0) {\n        const dbval = await get(photo.id)\n        if (dbval && dbval.indexOf('data:image') === 0) setUrl(dbval)\n        // If this image hasn't even been queued for upload then it may just\n        // be sitting in the object\n        else if (photo.base64) {\n          if (photo.base64.indexOf('data:image') === 0) setUrl(photo.base64)\n        }\n      }\n\n      // Otherwise try to form a coherent image\n      else {\n        const newUrl = seriesConfig.getPhotoUrl(photo, 'large')\n        if (refImgWrap.current) setUrl(newUrl)\n      }\n    }\n    getURL()\n  }, [photo])\n\n  const { size: { height, width }, setResizeActive } = useComponentSize(refImgWrap)\n  const urlWithRetries = urlRetryCounter > 0 ? `${url}?retry=${urlRetryCounter}` : url\n\n  // All tag-related info is put in its own hook\n  const { onAddTagTrigger, TagChooser, getRelXYTags, onTagDragOver, onTagDragStop, onTagDelete } = useXYTags(photo, { height, width }, onChange, setResizeActive)\n\n  const handleImageLoaded = event => {\n    if (refImgWrap.current) {\n      setBroken(false)\n      const { naturalHeight, naturalWidth } = event.target\n      // 4 different cases of orientation:\n      const multiplier = Math.min(\n        height / naturalHeight,\n        width / naturalWidth\n      )\n\n      const newWidth = multiplier * naturalWidth\n      const newHeight = multiplier * naturalHeight\n      setNewSize({ newWidth, newHeight, naturalWidth, naturalHeight, multiplier })\n    }\n  }\n\n  return (\n    <div className={classNames(classes.root, className)}\n      style={{ opacity: opacity !== null ? opacity : 1 }}\n      ref={refImgWrap}\n    >\n      <div className={classes.inner}\n        style={{\n          height: newSize ? newSize.newHeight : 1,\n          width: newSize ? newSize.newWidth : 1\n        }}\n        onClick={onAddTagTrigger}\n      >\n        { showTags || edit\n          ? (\n            <div className={className}>\n              { getRelXYTags(newSize.multiplier).map((tag, idx) => (\n                <XYTagChip\n                  key={`xytag-${idx}`}\n                  color={tag.color}\n                  {...{ edit, newSize, tag, onTagDragOver, onTagDragStop, onTagDelete }} />\n              ))}\n            </div>\n          ) : null\n        }\n        {broken && <BrokenImg />}\n        <img className={classNames(broken ? classes.brokenImg : classes.img)}\n          alt={urlWithRetries}\n          onError={(err) => {\n            if (urlRetryCounter < 10) {\n              setBroken(true)\n              console.log('Image Retry', urlRetryCounter)\n              console.error(err)\n              setTimeout(() => {\n                if (refImgWrap.current) setURLRetryCounter(urlRetryCounter + 1)\n              }, 4000)\n            }\n          }}\n          src={urlWithRetries}\n          onLoad={handleImageLoaded}\n          style={{ height: newSize.newHeight, width: newSize.newWidth }}\n        />\n      </div>\n      {edit && <TagChooser />}\n    </div>\n  )\n}\n\nPhoto.propTypes = {\n  className: PropTypes.string,\n  opacity: PropTypes.number,\n  photo: PropTypes.object.isRequired,\n  edit: PropTypes.bool,\n  showTags: PropTypes.bool,\n  transition: PropTypes.string,\n  onChange: PropTypes.func\n}\n\nexport default Photo\n","// import { fade } from '@material-ui/core/styles/colorManipulator'\nexport default theme => ({\n  root: {\n    // maxWidth: 400,\n    display: 'block',\n    position: 'relative',\n    width: '100%',\n    height: '100%',\n    background: 'black',\n    overflow: 'hidden'\n  },\n  inner: {\n    position: 'absolute',\n    top: '50%',\n    left: '50%',\n    transform: 'translateY(-50%) translateX(-50%)',\n    overflow: 'hidden'\n  },\n  xyTags: {\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    // opacity: 0.8,\n    // border: '4px solid red',\n    height: '100%',\n    width: '100%'\n    // background: 'rgba(150, 150, 150, 0.5)'\n  },\n  img: {\n    display: 'block'\n  },\n  brokenImg: {\n    display: 'none'\n  },\n  formControl: {\n    width: '100%'\n  }\n})\n","import { useCallback, useState, useLayoutEffect, useRef } from 'react'\nimport { debounce } from './util'\n\nconst getSize = (el, minSize, defaultSize) => {\n  if (!el) return defaultSize || minSize || { width: 0, height: 0 }\n\n  if (minSize) {\n    return {\n      width: Math.max(minSize.width, el.offsetWidth),\n      height: Math.max(minSize.height, el.offsetHeight)\n    }\n  }\n  else {\n    return {\n      width: el.offsetWidth,\n      height: el.offsetHeight\n    }\n  }\n}\n\nconst useComponentSize = (ref, minSize, defaultSize) => {\n  const resizeActiveRef = useRef()\n  const [resizeActive, setResizeActive] = useState(true)\n\n  resizeActiveRef.current = resizeActive\n  const [size, setComponentSize] = useState(\n    getSize(ref ? ref.current : null, minSize, defaultSize)\n  )\n\n  const handleResize = () => {\n    if (!resizeActiveRef.current || !ref.current) return\n    const newSize = getSize(ref.current, minSize, defaultSize)\n    if (newSize.height !== size.height || newSize.width !== size.width) {\n      // console.log('handleResize Called', { newSize, size })\n      setComponentSize(newSize)\n    }\n  }\n\n  const handleResizeDebounced = useCallback(\n    debounce(handleResize, 500),\n    []\n  )\n\n  useLayoutEffect(() => {\n    if (!ref.current) return\n    handleResize()\n\n    if (typeof ResizeObserver === 'function') {\n      let resizeObserver = new ResizeObserver(handleResizeDebounced)\n      resizeObserver.observe(ref.current)\n\n      return () => {\n        resizeObserver.disconnect(ref.current)\n        resizeObserver = null\n      }\n    }\n    else {\n      window.addEventListener('resize', handleResizeDebounced)\n\n      return () => {\n        window.removeEventListener('resize', handleResizeDebounced)\n      }\n    }\n  },\n  [ref.current])\n\n  return { size, setResizeActive }\n}\n\nexport default useComponentSize\n","const TYPES = {\n  // Series meta gets appended automatically to the seriees\n  SERIES: 'SERIES',\n  // Same but now only gets appended to the photo\n  PHOTO: 'PHOTO'\n}\nclass SeriesConfig {\n  constructor (seriesConfig) {\n    if (!seriesConfig) throw new Error('No seriesConfig object provided to SeriesConfig class')\n    this.config = seriesConfig\n  }\n\n  getTagType = (typeId) => this.config.tags.find(tt => tt.id === typeId)\n  // getTagTypeIndex = (typeId) => this.config.tags.findIndex(tt => tt.id === typeId)\n  getTagTypeIndex = (typeId) => {\n    // console.log('HERE', typeId)\n    return this.config.tags.findIndex(tt => tt.id === typeId)\n  }\n\n  getXYTagTypes = () => this.config.tags.filter(tt => tt.allowXY)\n  getNonXYTagTypes = () => this.config.tags.filter(tt => tt.allowNonXY)\n\n  getSeriesMeta = () => Object.keys(this.config.meta)\n    .filter(key => this.config.meta[key].type === TYPES.SERIES)\n    .reduce((acc, key) => ({\n      ...acc,\n      [key]: this.config.meta[key].default\n    }), {})\n\n  getPhotoMeta = () => Object.keys(this.config.meta)\n    .filter(key => this.config.meta[key].type === TYPES.PHOTO)\n    .reduce((acc, key) => ({\n      ...acc,\n      [key]: this.config.meta[key].default\n    }), {})\n}\n\nexport default SeriesConfig\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Chip from '@material-ui/core/Chip'\nimport CancelIcon from '@material-ui/icons/Cancel'\nimport { makeStyles, useTheme } from '@material-ui/core/styles'\n\nexport const tagChips = {\n  height: 20\n}\n\nconst style = theme => ({\n  root: {\n    fontSize: '0.6em',\n    height: tagChips.height,\n    marginRight: theme.spacing(1) / 2,\n    marginTop: theme.spacing(1) / 2\n  },\n  deleteIcon: {\n    width: tagChips.height - 1,\n    height: tagChips.height - 1\n  },\n  chipAvatar: {\n    width: tagChips.height,\n    height: tagChips.height\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst TagChip = ({ edit, tag, color, onDelete, ...props }) => {\n  const classes = useStyles()\n  const theme = useTheme()\n  return (\n    <Chip\n      style={{\n        background: color || null,\n        color: color ? `${theme.palette.getContrastText(color)}` : null\n      }}\n      label={tag.label}\n      data={tag.id}\n      onDelete={edit ? () => onDelete(tag) : null}\n      deleteIcon={(\n        <CancelIcon\n          className={classes.deleteIcon}\n          onClick={e => {\n            console.log('this click')\n          }}\n          style={{\n            opacity: 0.5,\n            color: color ? `${theme.palette.getContrastText(color)}` : null\n          }}\n        />\n      )}\n      className={classes.root}\n      {...props}\n    />\n  )\n}\n\nTagChip.propTypes = {\n  color: PropTypes.string.isRequired,\n  edit: PropTypes.bool,\n  tag: PropTypes.object.isRequired,\n  onDelete: PropTypes.func\n}\n\nexport default TagChip\n","import React from 'react'\nimport classNames from 'classnames'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport FormLabel from '@material-ui/core/FormLabel'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n    position: 'relative',\n    display: 'block',\n    overflow: 'hidden',\n    whiteSpace: 'pre-line',\n    '&::before': {\n      content: '\"  \"',\n      display: 'block',\n      position: 'absolute',\n      bottom: 0,\n      width: '100%',\n      height: 100,\n      background: `linear-gradient(180deg, rgba(255,255,255,0) 0%, ${theme.palette.background.paper} 100%)`\n    }\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst ShortLongText = ({ label, text, height, onClick }) => {\n  const classes = useStyles()\n  return (\n    <div onClick={onClick}>\n      {label && (\n        <FormLabel className={classes.formLabel}>\n          {label}\n        </FormLabel>\n      )}\n      <Typography\n\n        variant='body1'\n        color='inherit'\n        style={{ height }}\n        className={classNames(classes.root)}\n      >\n        {text}\n      </Typography>\n    </div>\n  )\n}\n\nShortLongText.propTypes = {\n  label: PropTypes.string,\n  text: PropTypes.string,\n  height: PropTypes.number,\n  onClick: PropTypes.func\n}\nShortLongText.defaultProps = {\n  height: 100\n}\n\nexport default ShortLongText\n","import SeriesConfig from './SeriesConfig'\n\nclass Tags {\n  constructor (seriesConfig, tags) {\n    this.tags = tags\n    this.seriesConfig = new SeriesConfig(seriesConfig)\n  }\n\n  findTagById = (typeId, tagId) => {\n    return this.seriesConfig.getTagType(typeId).values\n      .find(tt => tt.id === tagId)\n  }\n\n  // Filter the list of tags to those that are XY tags\n  getXYTags = () => {\n    const xyTagIds = this.seriesConfig.getXYTagTypes().map(tt => tt.id)\n    return this.tags.filter(tag => xyTagIds.indexOf(tag.typeId) > -1 && tag.coords && tag.coords.x)\n  }\n\n  getNonXYTags = () => {\n    const NonXYTagIds = this.seriesConfig.getNonXYTagTypes().map(tt => tt.id)\n    return this.tags.filter(tag => NonXYTagIds.indexOf(tag.typeId) > -1)\n  }\n\n  createNewTagObj = (label, typeId) => (\n    { label, typeId }\n  )\n\n  createExistingTagObj = (id, typeId) => ({\n    ...this.findTagById(typeId, id),\n    typeId\n  })\n\n  createNewXYTagObj = (label, typeId, coords) => ({\n    label,\n    typeId,\n    coords\n  })\n\n  createExistingXYTagObj = (id, typeId, coords) => ({\n    ...this.findTagById(typeId, id),\n    typeId,\n    coords\n  })\n\n  // Get tags in a way that's easy to render them\n  // We augment these tags with relative positions\n  // and a group number for coloring.\n  getRelXYTags = (multiplier) => this.getXYTags().map(tag => ({\n    ...tag,\n    group: this.seriesConfig.getTagTypeIndex(tag.typeId),\n    relCoords: {\n      x: tag.coords.x * multiplier,\n      y: tag.coords.y * multiplier\n    }\n  }))\n}\n\nexport default Tags\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n    color: theme.palette.primary.main,\n    position: 'absolute',\n    top: '50%',\n    left: '50%',\n    textAlign: 'center',\n    transformOrigin: '50% 50%',\n    transform: 'translateY(-50%) translateX(-50%)',\n    zIndex: 1\n  },\n  rootActive: {\n    zIndex: 1000\n  },\n  svgDot: {\n    zIndex: 102,\n    width: 20,\n    height: 20,\n    position: 'absolute',\n    top: '50%',\n    left: '50%',\n    textAlign: 'center',\n    transformOrigin: '50% 50%',\n    transform: 'translateY(-50%) translateX(-50%)'\n  },\n  dot: {\n    stroke: theme.palette.secondary.contrastText,\n    strokeWidth: '1',\n    fill: theme.palette.secondary.main\n  },\n  directionIndicator: {\n    position: 'absolute',\n    left: '50%',\n    // transformOrigin: '50% 50%',\n    // transform: 'translateY(-50%) translateX(-50%)',\n    zIndex: 100\n  },\n  name: {\n    color: 'white',\n    fontWeight: 'bold',\n    textShadow: `\n        0px 0px 4px #000000, \n        0px 0px 4px #000000 \n    `,\n    zIndex: 122,\n    position: 'relative'\n    // textStroke: '1px white'\n  },\n  nameActive: {\n    color: theme.palette.secondary.dark,\n    textShadow: `\n    0px 0px 2px #FFFFFF, \n    0px 0px 2px #FFFFFF,\n    0px 0px 4px #FFFFFF \n`\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst Single = ({ direction }) => {\n  const classes = useStyles()\n  return (\n    <div className={classes.root}>\n      <svg className={classes.svgDot} version='1.1' viewBox='0, 0, 10, 10' >\n        <circle cx='5' cy='5' r='4' className={classes.dot} />\n      </svg>\n      {direction && direction >= 0 ? (\n        <div className={classes.directionIndicator}>\n          <svg className={classes.svgArc}\n            version='1.1'\n            width='100'\n            height='100'\n            viewBox='0, 0, 100, 100'\n            style={{ transform: `translateY(-50%) translateX(-50%) rotateZ(${direction}deg)` }}>\n            <path d='M50,0 C60.946,0.151 72.136,3.514 80.675,10.56 L50,50 L19.325,10.56 C27.938,3.461 39,0.278 50,0 z'\n              fill='#009DC1'\n              fillOpacity='0.444'\n              strokeWidth='0.5'\n              strokeOpacity='0.6'\n              stroke='#FFFFFF'\n            />\n          </svg>\n        </div>\n      ) : null}\n    </div>\n  )\n}\n\nSingle.propTypes = {\n  direction: PropTypes.number\n}\n\nexport default Single\n","import React, { useState, useRef, useMemo } from 'react'\nimport { StaticMap } from 'react-map-gl'\nimport PropTypes from 'prop-types'\nimport { getDistanceScales } from 'viewport-mercator-project'\nimport useComponentSize from '../../lib/useComponentSize'\nimport StyleButtons from './controls/StyleButtons'\nimport { mapConfig } from '../../config'\nimport classNames from 'classnames'\nimport 'mapbox-gl/dist/mapbox-gl.css'\nimport './BaseMap.css'\n\n/**\n * Note that this component technically has state but it is designed to be functionally stateless\n */\nconst BaseStaticMap = (props) => {\n  const {\n    controlPadding,\n    viewport,\n    children,\n    mapStyles,\n    onMapDataEvent,\n    ...passthroughProps\n  } = props\n\n  const mapRef = useRef(null)\n  const { size } = useComponentSize(mapRef, { width: 100, height: 50 })\n\n  const [currStyle, setCurrStyle] = useState(0)\n  const [projection, setProjection] = useState(null)\n\n  const recalcProjection = () => {\n    if (!size || size.width < 10 || size.height < 10) return\n    try {\n      const projection = getDistanceScales(viewport)\n      // console.log('recalcProjection', { projection, size })\n      setProjection(projection)\n    }\n    catch (e) {\n      // Sometimes we don't have a valid bound. Don't make a big deal out of it.\n      console.error(e)\n    }\n  }\n\n  if (!projection) recalcProjection()\n  useMemo(recalcProjection, [size])\n\n  return (\n    <div className={classNames('BaseMap', props.className)} ref={mapRef} style={{ height: '100%', width: '100%' }}>\n      <StaticMap\n        {...viewport}\n        height={size.height}\n        width={size.width}\n        mapStyle={mapStyles[currStyle].style}\n        onData={onMapDataEvent}\n        mapboxApiAccessToken={mapConfig.mapBoxToken}\n        {...passthroughProps}\n      >\n        { mapStyles && mapStyles.length > 1 ? (\n          <StyleButtons\n            controlPadding={controlPadding}\n            currStyle={currStyle}\n            mapStyles={mapStyles}\n            setCurrStyle={setCurrStyle}\n          />\n        ) : null }\n        {\n          children && Array.isArray(children)\n            ? children.map(c => handleChild(c, viewport, size.height, size.width, projection))\n            : handleChild(children, viewport, size.height, size.width, projection)\n        }\n      </StaticMap>\n    </div>\n  )\n}\n\nfunction handleChild (child, viewport, height, width, projection) {\n  return typeof child === 'function'\n    ? child(viewport, height, width, projection)\n    : child\n}\n\nBaseStaticMap.propTypes = {\n  // Anything else we want to add to the map\n  children: PropTypes.any,\n  deckelements: PropTypes.array,\n  data: PropTypes.array,\n  // Maybe we want map controls to be padded\n  controlPadding: PropTypes.object,\n\n  minPitch: PropTypes.number,\n  maxPitch: PropTypes.number,\n  pitch: PropTypes.number,\n\n  // Lock the bounds of a map to a rectangle [minlng, minlat], [maxlng, maxlat]\n  bounds: PropTypes.array,\n  // Lock the possible zoom levels to a range: [minZoom, maxZoom]\n  zoomBounds: PropTypes.array,\n  // InitialBounds of the map.\n  InnerBounds: PropTypes.array,\n\n  // List of valid styles that will get picker buttons\n  mapStyles: PropTypes.array,\n\n  // Just some default props we probably won't set.\n  latitude: PropTypes.number,\n  longitude: PropTypes.number,\n  zoom: PropTypes.number,\n\n  onMapDataEvent: PropTypes.func\n}\nBaseStaticMap.defaultProps = {\n  controlPadding: {},\n  stylechooser: true,\n  // viewport: {\n  //   zoom: 12,\n  //   latitude: 49.3050394,\n  //   longitude: -123.1398254\n  // },\n  initStyle: 0,\n  mapStyles: mapConfig.styles\n}\n\nexport default BaseStaticMap\n","import React from 'react'\nimport PropTypes from 'prop-types'\n// import { makeStyles } from '@material-ui/core/styles'\nimport { Marker } from 'react-map-gl'\nimport BaseMap from './BaseMap'\nimport Dot from './markers/Dot'\nimport BaseStaticMap from './BaseStaticMap'\n// import style from './MapDot.style'\n\n// const useStyles = makeStyles(style)\n\nconst MapDot = ({ staticMap, editable, latitude, longitude, onChange, direction, ...props }) => {\n  const Map = staticMap ? BaseStaticMap : BaseMap\n  // const classes = useStyles()\n  const mapProps = staticMap ? {} : {\n    touchRotate: false,\n    dragRotate: false,\n    showMe: editable,\n    lockPan: !editable,\n    onViewportChange: onChange\n  }\n\n  return (\n    <Map\n      {...mapProps}\n      {...props}\n    >\n      {latitude && longitude ? (\n        <Marker\n          className={'singleMarker'}\n          latitude={latitude}\n          longitude={longitude}\n        >\n          <Dot direction={direction} />\n        </Marker>\n      )\n        : <Dot direction={direction} />\n      }\n\n    </Map>\n  )\n}\n\nMapDot.propTypes = {\n  direction: PropTypes.number,\n  latitude: PropTypes.number,\n  longitude: PropTypes.number,\n  editable: PropTypes.bool,\n  staticMap: PropTypes.bool,\n  onChange: PropTypes.func\n}\n\nexport default MapDot\n","import Satellite from './Satellite.json'\n// import BasicMap from './BasicMap.json'\nimport TopoMap from './TopoMap.json'\n\nimport {\n  Satellite as SatIcon,\n  SatelliteOutlined,\n  // DirectionsCar,\n  // DirectionsCarOutlined,\n  Terrain,\n  TerrainOutlined\n} from '@material-ui/icons'\n\nexport default [\n  {\n    toolTip: 'Sat',\n    Icon: SatelliteOutlined,\n    ActiveIcon: SatIcon,\n    color: 'green',\n    style: Satellite\n  },\n  {\n    toolTip: 'Topo',\n    Icon: TerrainOutlined,\n    ActiveIcon: Terrain,\n    color: 'blue',\n    style: TopoMap\n  }\n]\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\nimport SpeedDial from '@material-ui/lab/SpeedDial'\nimport SpeedDialAction from '@material-ui/lab/SpeedDialAction'\n// import MapLayersIcon from '@material-ui/icons/Layers'\nimport { makeStyles, useTheme } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n    zIndex: 10,\n    position: 'absolute'\n  },\n  speedDialFab: {\n    border: '2px solid',\n    background: theme.palette.text.primary,\n    color: theme.palette.primary.contrastText,\n    width: 40,\n    height: 40\n  },\n  speedDialAction: {\n    border: '2px solid',\n    background: theme.palette.primary.main,\n    color: theme.palette.primary.contrastText,\n    marginTop: 0,\n    marginBottom: 0\n  },\n  speedDialIcon: {\n    // border: '1px solid red'\n  },\n  speedDialLabel: {\n    background: 'black',\n    color: 'white'\n  },\n  actionsClosed: {\n    display: 'none'\n  }\n})\n\nconst useStyles = makeStyles(style)\n\nconst StyleButtons = ({ controlPadding, currStyle, mapStyles, setCurrStyle }) => {\n  const [open, setOpen] = useState(false)\n  const classes = useStyles()\n  const theme = useTheme()\n  const noEventSetOpen = (e, state) => {\n    console.log('noEventSetOpen', e, state)\n    e.preventDefault()\n    e.stopPropagation()\n    setOpen(state)\n  }\n\n  if (!mapStyles || !Array.isArray(mapStyles) || mapStyles.length < 2 || !mapStyles[currStyle]) return null\n\n  const currStyleObj = mapStyles[currStyle]\n  const ActiveIcon = currStyleObj.ActiveIcon\n\n  return (\n    <div className={classes.root} style={{\n      top: controlPadding.top ? controlPadding.top : theme.spacing(2),\n      right: controlPadding.right ? controlPadding.right : theme.spacing(2)\n    }}>\n      {mapStyles.length > 1 && (\n        <SpeedDial\n          ariaLabel='SpeedDial example'\n          className={classes.speedDial}\n          classes={{\n            fab: classes.speedDialFab,\n            actionsClosed: classes.actionsClosed\n          }}\n          icon={<ActiveIcon className={classes.icon} />}\n          // onBlur={(e) => noEventSetOpen(e, false)}\n          onClick={(e) => noEventSetOpen(e, !open)}\n          onClose={(e) => noEventSetOpen(e, false)}\n          // onFocus={(e) => noEventSetOpen(e, true)}\n          // onMouseEnter={(e) => noEventSetOpen(e, true)}\n          // onMouseLeave={(e) => noEventSetOpen(e, false)}\n          open={open}\n          direction='left'\n        >\n\n          {mapStyles.map(({ Icon, ActiveIcon, toolTip }, idx) => (\n            <SpeedDialAction\n              key={`stylebutton${idx}`}\n              // Bit of a hack here. This function isn't quite ready for primetime\n              icon={<Icon className={classes.speedDialIcon} />}\n              tooltipPlacement='bottom'\n              ButtonProps={{\n                classes: {\n                  root: classes.speedDialAction\n                }\n              }}\n              TooltipClasses={{\n                tooltip: classes.speedDialLabel\n              }}\n              tooltipTitle={toolTip}\n              tooltipOpen\n              onClick={() => {\n                console.log('SET', idx)\n                setCurrStyle(idx)\n                setOpen(false)\n              }}\n            />\n          ))}\n\n        </SpeedDial>\n      ) }\n    </div>\n  )\n}\n\nStyleButtons.propTypes = {\n  // controlPadding: {top, right, bottom, left}\n  controlPadding: PropTypes.object,\n  currStyle: PropTypes.number,\n  mapStyles: PropTypes.array,\n  setCurrStyle: PropTypes.func\n}\nStyleButtons.defaultProps = {\n  controlPadding: {}\n}\n\nexport default StyleButtons\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemText from '@material-ui/core/ListItemText'\nimport ListItemAvatar from '@material-ui/core/ListItemAvatar'\nimport Avatar from '@material-ui/core/Avatar'\n// import MenuIcon from '@material-ui/icons/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n  },\n  imgContainer: {\n    // flex: '0 0 50px',\n    // alignSelf: 'flex-start',\n    // height: '100%',\n  },\n  gravatarImg: {\n    objectFit: 'cover',\n    height: '100%',\n    width: '100%'\n  }\n}))\n\nconst UserListItem = ({ user, loading, onAvatarClick, secondary }) => {\n  const classes = useStyles()\n\n  if (loading || !user) return 'LOADING...'\n  // console.log('USER', user)\n\n  return (\n    <ListItem className={classes.root} button={!!onAvatarClick} onClick={onAvatarClick} disableGutters>\n      <ListItemAvatar className={classes.imgContainer}>\n        <Avatar>\n          <img alt='profile' className={classes.gravatarImg} src={user.gravatar} />\n        </Avatar>\n      </ListItemAvatar>\n      <ListItemText\n        primary={user.username}\n        secondary={secondary}\n      />\n    </ListItem>\n  )\n}\n\nUserListItem.propTypes = {\n  user: PropTypes.object,\n  loading: PropTypes.bool,\n  secondary: PropTypes.string,\n  onAvatarClick: PropTypes.func\n}\n\nexport default UserListItem\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport Dialog from '@material-ui/core/Dialog'\nimport IconButton from '@material-ui/core/IconButton'\nimport DialogTitle from '@material-ui/core/DialogTitle'\n\nimport CloseIcon from '@material-ui/icons/Close'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n\n  },\n  body: {\n    overflow: 'hidden',\n    whiteSpace: 'pre-line',\n    paddingBottom: theme.spacing(1)\n  },\n  title: {\n    alignSelf: 'flex-start',\n    width: '100%',\n    margin: 0,\n    display: 'flex',\n    padding: theme.spacing(2)\n  },\n  dlgTitle: {\n    flexGrow: 1\n  },\n  closeButton: {\n    alignSelf: 'flex-start',\n    color: theme.palette.grey[500]\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst BigText = ({ open, onClose, title, body }) => {\n  const classes = useStyles()\n  return (\n    <Dialog\n      scroll='paper'\n      open={open}\n      fullWidth\n      maxWidth='xl'\n      onClose={onClose}\n      aria-labelledby='simple-dialog-title'\n    >\n      <DialogTitle className={classes.title} disableTypography>\n        <Typography className={classes.dlgTitle}>{title}</Typography>\n        <IconButton className={classes.closeButton} onClick={onClose}>\n          <CloseIcon />\n        </IconButton>\n      </DialogTitle>\n      <DialogContent>\n        <Typography variant='body2' className={classes.body}>{body}</Typography>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nBigText.propTypes = {\n  open: PropTypes.bool,\n  onClose: PropTypes.func,\n  title: PropTypes.string,\n  body: PropTypes.string\n}\n\nexport default BigText\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport Button from '@material-ui/core/Button'\nimport Typography from '@material-ui/core/Typography'\nimport DialogActions from '@material-ui/core/DialogActions'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n\n})\nconst useStyles = makeStyles(style)\n\nconst DeleteDialog = ({ title, message, onConfirm, open }) => {\n  const classes = useStyles()\n  return (\n    <Dialog\n      className={classes.root}\n      disableBackdropClick\n      open={open}\n      disableEscapeKeyDown\n      maxWidth='xl'\n      aria-labelledby='confirmation-dialog-title'\n    >\n      <DialogTitle id='confirmation-dialog-title'>{title}</DialogTitle>\n      <DialogContent>\n        <Typography>\n          {message}\n        </Typography>\n\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={() => onConfirm(false)} color='primary'>\n      No\n        </Button>\n        <Button onClick={() => onConfirm(true)} color='primary'>\n      Yes\n        </Button>\n      </DialogActions>\n    </Dialog>\n  )\n}\n\nDeleteDialog.propTypes = {\n  open: PropTypes.bool,\n  title: PropTypes.string.isRequired,\n  message: PropTypes.string.isRequired,\n  onConfirm: PropTypes.func.isRequired\n}\n\nexport default DeleteDialog\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\n// import Typography from '@material-ui/core/Typography'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogActions from '@material-ui/core/DialogActions'\nimport TextField from '@material-ui/core/TextField'\nimport Button from '@material-ui/core/Button'\nimport DialogTitle from '@material-ui/core/DialogTitle'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n\n  },\n  body: {\n    overflow: 'hidden',\n    whiteSpace: 'pre-line',\n    paddingBottom: theme.spacing(1)\n  },\n  title: {\n    margin: 0,\n    padding: theme.spacing(2)\n  },\n  closeButton: {\n    position: 'absolute',\n    right: theme.spacing(1),\n    top: theme.spacing(1),\n    color: theme.palette.grey[500]\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst BigTextEdit = ({ open, onOk, title, body, multiline }) => {\n  const classes = useStyles()\n  const [value, setValue] = useState(body || '')\n  return (\n    <Dialog\n      scroll='paper'\n      open={open}\n      fullWidth\n      onClose={() => onOk(value)}\n    >\n      <DialogTitle className={classes.title}>\n        {title}\n      </DialogTitle>\n      <DialogContent>\n        <TextField\n          className={classes.body}\n          multiline={multiline}\n          fullWidth\n          rows={6}\n          rowsMax={20}\n          onChange={e => setValue(e.target.value)}\n          defaultValue={body}\n        />\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={() => onOk(body)}>Cancel</Button>\n        <div style={{ flexGrow: 1 }} />\n        <Button onClick={() => onOk(value)}>Ok</Button>\n      </DialogActions>\n    </Dialog>\n  )\n}\n\nBigTextEdit.propTypes = {\n  open: PropTypes.bool,\n  multiline: PropTypes.bool,\n  onOk: PropTypes.func,\n  title: PropTypes.string,\n  body: PropTypes.string\n}\n\nexport default BigTextEdit\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport Slider from '@material-ui/lab/Slider'\n// import { Menu as MenuIcon } from '@material-ui/icons'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n    color: 'white',\n    zIndex: 10,\n    display: 'flex',\n    flexDirection: 'column',\n    position: 'absolute',\n    height: '50%',\n    top: '45%',\n    left: '0',\n    transform: 'translateY(-50%)'\n  },\n  sliderLabel: {\n    display: 'block',\n    flexGrow: 1,\n    textAlign: 'center',\n    padding: theme.spacing(3, 0, 3, 0),\n    textShadow: '0 0 5px black, 0 0 5px black'\n  },\n  vertical: {\n    padding: '0px 31px!important',\n    width: '4px!important'\n  },\n  rail: {\n    width: `4px!important`,\n    background: theme.palette.primary.dark,\n    boxShadow: '0 0 10px 5px black'\n  },\n  track: {\n    width: `4px!important`,\n    background: theme.palette.primary.main\n  },\n  thumb: {\n    // transform: 'translate(50%, -50%)',\n    background: theme.palette.primary.main,\n    border: `1px solid ${theme.palette.primary.dark}`,\n    marginLeft: '-8px !important',\n    width: 20,\n    height: 20\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst PhotoFadeSlider = ({ defaultValue, onChange }) => {\n  const classes = useStyles()\n  // we control the state internally so we get a smooth experience\n  const [slider, setSlider] = useState(defaultValue)\n\n  const onSliderMove = (event, value) => {\n    setSlider(value)\n    // send it back if we need to\n    onChange(value)\n  }\n\n  return (\n    <div className={classes.root}>\n      <Typography className={classes.sliderLabel} color='inherit' variant='caption'>New</Typography>\n      <Slider\n        classes={{\n          vertical: classes.vertical,\n          rail: classes.rail,\n          track: classes.track,\n          thumb: classes.thumb\n        }}\n        value={slider}\n        aria-labelledby='label'\n        onChange={onSliderMove}\n        orientation='vertical'\n      />\n      <Typography className={classes.sliderLabel} color='inherit' variant='caption'>Reference</Typography>\n    </div>\n  )\n}\n\nPhotoFadeSlider.propTypes = {\n  defaultValue: PropTypes.number,\n  onChange: PropTypes.func\n}\n\nPhotoFadeSlider.defaultProps = {\n  defaultValue: 100,\n  onChange: () => {}\n}\n\nexport default PhotoFadeSlider\n","import { useState, useEffect, useRef } from 'react'\n\nexport const useCamera = (onCapture, width, height) => {\n  const [cameraError, setCameraError] = useState(false)\n  const [cameraOnline, setCameraOnline] = useState(false)\n  const camRef = useRef()\n\n  useEffect(() => {\n    camRef.current = new Webcam(\n      document.getElementById('webcam'),\n      document.createElement('canvas')\n    )\n    camRef.current.setup(\n      height || window.innerWidth, // width\n      width || window.innerHeight // height\n    )\n      .then((data) => {\n        setCameraOnline(true)\n      })\n      .catch((e) => {\n        console.error(e)\n        setCameraError(true)\n      })\n  }, [width, height])\n\n  const captureImage = () => {\n    if (camRef.current && cameraOnline) {\n      const capturedData = camRef.current.takeBase64Photo({ type: 'jpeg', quality: 1 })\n      onCapture(capturedData)\n    }\n  }\n\n  const captureRawData = () => {\n    if (camRef.current && cameraOnline) {\n      const capturedData = camRef.current.takeImageData()\n      onCapture(capturedData)\n    }\n  }\n\n  return { cameraError, captureImage, cameraOnline, captureRawData }\n}\n\nclass Webcam {\n  constructor (webcamElement, canvasElement) {\n    this.webcamElement = webcamElement\n    this.canvasElement = canvasElement\n\n    if (window.location.protocol !== 'https:' && window.location.hostname !== 'localhost') {\n      console.warn('getUserMedia() must be run from a secure origin: https or localhost.\\nChanging protocol to https.')\n    }\n\n    if (!navigator.mediaDevices && !navigator.getUserMedia) {\n      console.warn(`Your browser doesn't support navigator.mediaDevices.getUserMedia and navigator.getUserMedia.`)\n    }\n  }\n\n  adjustVideoSize (width, height) {\n    const aspectRatio = width / height\n    if (width >= height) {\n      this.webcamElement.width = aspectRatio * this.webcamElement.height\n    }\n    else if (width < height) {\n      this.webcamElement.height = this.webcamElement.width / aspectRatio\n    }\n  }\n\n  async destroy () {\n    try {\n      this.webcamElement.srcObject.getTracks()[0].stop()\n      this.webcamElement = null\n      this.canvasElement = null\n    }\n    catch (e) {\n      console.error(e)\n    }\n  }\n\n  async setup (width, height) {\n    return new Promise((resolve, reject) => {\n      if (navigator.mediaDevices.getUserMedia !== undefined) {\n        navigator.mediaDevices.getUserMedia({ audio: false, video: { facingMode: 'environment', width, height } })\n          .then((mediaStream) => {\n            if ('srcObject' in this.webcamElement) {\n              this.webcamElement.srcObject = mediaStream\n            }\n            else {\n              // For older browsers withouth the srcObject.\n              this.webcamElement.src = window.URL.createObjectURL(mediaStream)\n            }\n            this.webcamElement.onloadedmetadata = (e) => {\n              this.webcamElement.play()\n            }\n            this.webcamElement.onplaying = (e) => {\n              resolve()\n            }\n          })\n          .catch(err => reject(err))\n      }\n      else {\n        reject(new Error('Error accessing camera'))\n      }\n    })\n  }\n\n  _drawImage () {\n    const imageWidth = this.webcamElement.videoWidth\n    const imageHeight = this.webcamElement.videoHeight\n\n    const context = this.canvasElement.getContext('2d')\n    this.canvasElement.width = imageWidth\n    this.canvasElement.height = imageHeight\n\n    context.drawImage(this.webcamElement, 0, 0, imageWidth, imageHeight)\n\n    return { imageHeight, imageWidth }\n  }\n\n  takeImageData () {\n    const { imageHeight, imageWidth } = this._drawImage()\n    const data = { data: null, imageHeight, imageWidth }\n    try {\n      data.data = this.canvasElement\n        .getContext('2d')\n        .getImageData(\n          0,\n          0,\n          imageWidth,\n          imageHeight\n        ).data\n    }\n    catch (e) {}\n\n    return data\n  }\n\n  takeBlobPhoto () {\n    const { imageWidth, imageHeight } = this._drawImage()\n    return new Promise((resolve, reject) => {\n      this.canvasElement.toBlob((blob) => {\n        resolve({ blob, imageHeight, imageWidth })\n      })\n    })\n  }\n\n  takeBase64Photo ({ type, quality } = { type: 'jpeg', quality: 1 }) {\n    const { imageHeight, imageWidth } = this._drawImage()\n    const base64 = this.canvasElement.toDataURL('image/' + type, quality)\n    return { base64, imageHeight, imageWidth }\n  }\n}\n","export default theme => ({\n  root: {\n    width: '100%'\n  },\n  tagContainer: {\n  },\n  formControl: {\n\n  },\n  actionButtons: {\n    textAlign: 'right'\n  },\n  noOptionsMessage: {\n    padding: theme.spacing(1, 2)\n  },\n  singleValue: {\n    fontSize: 16\n  },\n  placeholder: {\n    position: 'absolute',\n    left: 2,\n    fontSize: 16\n  },\n  input: {\n    display: 'flex',\n    padding: 0\n  },\n  valueContainer: {\n    display: 'flex',\n    flexWrap: 'wrap',\n    flex: 1,\n    alignItems: 'center',\n    overflow: 'hidden'\n  },\n  paper: {\n    position: 'absolute',\n    zIndex: 1,\n    marginTop: theme.spacing(1),\n    left: 0,\n    right: 0\n  }\n})\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport Typography from '@material-ui/core/Typography'\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport TagChip from '../tags/TagChip'\nimport style from './TagControl.style'\n\nconst useStyles = makeStyles(style)\n/**\n * Just to be clear: the state here is being stored as []\n */\nconst TagControl = ({ tags, label, tagConfig, className }) => {\n  const classes = useStyles()\n  // Filter to just this tag type\n  const tagValues = tags.filter(tag => tag.typeId === tagConfig.id && !tag.coords)\n\n  return (\n    <div className={classNames(classes.root, className)}>\n      <Typography variant='overline' className={classes.fieldTitle}>\n        {tagConfig.label}\n      </Typography>\n      <div className={classes.tagContainer}>\n        {tagValues.map((tag, idx) => (\n          <TagChip tag={tag} key={`tagchip${idx}`} color={tagConfig.color} />\n        ))}\n      </div>\n\n    </div>\n  )\n}\n\nTagControl.propTypes = {\n  className: PropTypes.string,\n  label: PropTypes.string,\n  tags: PropTypes.array,\n  tagConfig: PropTypes.object\n}\n\nexport default TagControl\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport {\n  TextField,\n  Typography\n} from '@material-ui/core'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { timestampToHTML5Input, HTML5InputToTimestamp } from '../../../../lib/datelib'\n\nconst style = theme => ({\n  root: {\n  },\n  rootEdit: {\n  },\n  formControl: {\n    width: '100%'\n  },\n  textBody: {\n    whiteSpace: 'pre-line'\n  },\n  actionButtons: {\n    textAlign: 'right'\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst DateControl = ({\n  label,\n  value,\n  hint,\n  onChange,\n  className\n}) => {\n  const classes = useStyles()\n  return (\n    <div className={classNames(classes.root, className)}>\n      <Typography variant='overline' className={classes.fieldTitle}>\n        {label}\n      </Typography>\n      <TextField\n        type='datetime-local'\n        fullWidth\n        value={timestampToHTML5Input(value)}\n        className={classes.textField}\n        onChange={(e) => onChange(HTML5InputToTimestamp(e.target.value))}\n      />\n      {hint && <Typography variant='caption' className={classes.hint}>{hint}</Typography>}\n    </div>\n  )\n}\n\nDateControl.propTypes = {\n  className: PropTypes.string,\n  label: PropTypes.string.isRequired,\n  hint: PropTypes.string,\n  value: PropTypes.string, // all timestamps come in as integerstrings\n  onChange: PropTypes.func.isRequired\n}\n\nexport default DateControl\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport Paper from '@material-ui/core/Paper'\nimport TextField from '@material-ui/core/TextField'\nimport Typography from '@material-ui/core/Typography'\nimport MenuItem from '@material-ui/core/MenuItem'\n\nimport Select from 'react-select'\nimport CreatableSelect from 'react-select/lib/Creatable'\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport TagChip from '../tags/TagChip'\nimport style from './TagControl.style'\nconst useStyles = makeStyles(style)\n\n/**\n * Just to be clear: the state here is being stored as []\n */\nconst TagControl = ({\n  tags, onChange,\n  hint, tagConfig, className\n}) => {\n  const classes = useStyles()\n  // console.log('TagControl Rnder', { tags, tagConfig })\n  const onSelectChange = (inputValue, { action, removedValue, option }) => {\n    // If this was the last tag then close the menu\n    switch (action) {\n      case 'clear':\n        onChange([])\n        break\n      case 'remove-value':\n        // Remember we need to potentially remove it from the old AND the new\n        onChange(tags.filter(val => val.id !== removedValue.value))\n        break\n      case 'select-option':\n        const newVal = {\n          ...tagConfig.values.find(tcv => tcv.id === option.value),\n          typeId: tagConfig.id\n        }\n        onChange([...tags, newVal])\n        break\n      case 'create-option':\n        const newLabel = inputValue.find(v => v.__isNew__).value\n        const newCreateVal = {\n          label: newLabel,\n          typeId: tagConfig.id\n        }\n        onChange([...tags, newCreateVal])\n        break\n      default:\n        break\n    }\n  }\n\n  const SingleValue = ({ removeProps, innerProps, data, ...props }) => {\n    // console.log('SingleValue PROPS', { removeProps, innerProps, data, props })\n    return (\n      <TagChip tag={data} onDelete={(e) => {\n        // console.log('EVENT', e)\n        removeProps.onClick()\n      }} color={tagConfig.color} edit />\n    )\n  }\n  SingleValue.propTypes = {\n    removeProps: PropTypes.any,\n    innerProps: PropTypes.any,\n    data: PropTypes.any\n  }\n\n  const MultiValue = ({ removeProps, innerProps, data, ...props }) => {\n    // console.log('MultiValue PROPS', { removeProps, innerProps, data, props })\n    return (\n      <TagChip tag={data} onDelete={(e) => {\n        // console.log('EVENT', e)\n        removeProps.onClick()\n      }} color={tagConfig.color} edit />\n    )\n  }\n  MultiValue.propTypes = {\n    removeProps: PropTypes.any,\n    innerProps: PropTypes.any,\n    data: PropTypes.any\n  }\n\n  // Filter to just this tag type\n  const tagValues = tags.filter(tag => tag.typeId === tagConfig.id && !tag.coords)\n  // Now format it as {label, value: id} for react-select\n  const selectOptions = tagValues.map(val => ({ label: val.label, value: val.id }))\n\n  // Filter out things we haven't chosen yet\n  // Also transform the options into a label/value pair for react-select\n  const remainingTags = tagConfig.values\n    .filter(val => tagValues.map(t => t.id).indexOf(val.id) === -1)\n    .map(val => ({ label: val.label, value: val.id }))\n\n  // console.log('TAG DEBUG', { value, tagValues, tagConfig })\n\n  return (\n    <div className={classNames(classes.root, className)}>\n      <Typography variant='overline' className={classes.fieldTitle}>\n        {tagConfig.label}\n      </Typography>\n      {!tagConfig.allowAdditions && (\n        <Select\n          options={remainingTags}\n          classes={classes}\n          isFocused\n          components={{\n            Control,\n            Menu,\n            //   MultiValue,\n            NoOptionsMessage,\n            Option,\n            Placeholder,\n            //   SingleValue,\n            ValueContainer\n          }}\n          deleteRemoves\n          value={selectOptions}\n          isClearable={false}\n          onChange={onSelectChange}\n          placeholder='Select Tags'\n          isMulti\n          isSearchable\n        />\n      ) }\n      { tagConfig.allowAdditions && (\n        <CreatableSelect\n          options={remainingTags}\n          classes={classes}\n          isFocused\n          deleteRemoves\n          components={{\n            Control,\n            Menu,\n            //   MultiValue,\n            NoOptionsMessage,\n            Option,\n            Placeholder,\n            //   SingleValue,\n            ValueContainer\n          }}\n          value={selectOptions}\n          isClearable={false}\n          onChange={onSelectChange}\n          placeholder='Select Tags'\n          isMulti\n          isSearchable\n        />\n      )}\n      {hint && <Typography variant='caption' className={classes.hint}>{hint}</Typography>}\n    </div>\n  )\n}\n\nTagControl.propTypes = {\n  className: PropTypes.string,\n  hint: PropTypes.string,\n  tags: PropTypes.array,\n  onChange: PropTypes.func.isRequired,\n  tagConfig: PropTypes.object\n}\n\nexport default TagControl\n\nfunction Control (props) {\n  // console.log('CONTROL PROPS', props)\n  return (\n    <TextField\n      fullWidth\n      InputProps={{\n        inputComponent,\n        inputProps: {\n          className: props.selectProps.classes.input,\n          inputRef: props.innerRef,\n          children: props.children,\n          // innerProps: {\n          onMouseDown: (e) => {\n            props.innerProps.onMouseDown(e)\n          },\n          onTouchEnd: (e) => {\n            props.innerProps.onTouchEnd(e)\n          }\n          // }\n          // ...props.innerProps\n        }\n      }}\n      {...props.selectProps.textFieldProps}\n    />\n  )\n}\n\nconst NoOptionsMessage = ({ innerProps, selectProps, children }) => (\n  <Typography\n    color='textSecondary'\n    className={selectProps.classes.noOptionsMessage}\n    {...innerProps}\n  >\n    {children}\n  </Typography>\n)\n\nconst Menu = ({ selectProps, innerProps, children }) => (\n  <Paper square className={selectProps.classes.paper} {...innerProps}>\n    {children}\n    {/* {console.log('MENU PROPS', { selectProps, innerProps, children })} */}\n  </Paper>\n)\n\nconst inputComponent = ({ inputRef, ...props }) => <div ref={inputRef} {...props} />\n\nconst Placeholder = (props) => (\n  <Typography\n    color='textSecondary'\n    className={props.selectProps.classes.placeholder}\n    {...props.innerProps}\n  >\n    {props.children}\n  </Typography>\n)\n\nconst Option = ({ innerRef, isFocused, isSelected, innerProps, children }) => (\n  <MenuItem\n    buttonRef={innerRef}\n    selected={isFocused}\n    component='div'\n    style={{ fontWeight: isSelected ? 500 : 400 }}\n    {...innerProps}\n  >\n    {children}\n  </MenuItem>\n)\n\nconst ValueContainer = ({ selectProps, children }) => (\n  <div className={selectProps.classes.valueContainer}>{children}</div>\n)\nValueContainer.propTypes = {\n  selectProps: PropTypes.any,\n  children: PropTypes.any\n}\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\n// import Typography from '@material-ui/core/Typography'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport Typography from '@material-ui/core/Typography'\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogActions from '@material-ui/core/DialogActions'\nimport Button from '@material-ui/core/Button'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport IconButton from '@material-ui/core/IconButton'\n\nimport CloseIcon from '@material-ui/icons/Close'\nimport TagControl from '../controls/TagControl'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n  },\n  dlgContent: {\n    // position: 'relative',\n    // maxWidth: '200px',\n    overflowY: 'visible!important',\n    paddingBottom: 300\n    // overflowX: 'hidden'\n  },\n  title: {\n    width: '100%',\n    margin: 0,\n    display: 'flex',\n    padding: theme.spacing(2)\n  },\n  dlgTitle: {\n    flexGrow: 1\n  },\n  closeButton: {\n    color: theme.palette.grey[500]\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst TagEdit = ({ open, title, onOk, onCancel, tags, tagConfig }) => {\n  const classes = useStyles()\n  const [value, setValue] = useState(tags)\n  return (\n    <Dialog\n      className={classes.root}\n      scroll='body'\n      fullScreen\n      open={open}\n      onClose={() => onOk(value)}\n    >\n      <DialogTitle className={classes.title} disableTypography>\n        <Typography className={classes.dlgTitle}>{title}</Typography>\n        <IconButton className={classes.closeButton} onClick={onCancel}>\n          <CloseIcon />\n        </IconButton>\n      </DialogTitle>\n      <DialogContent className={classes.dlgContent}>\n        <TagControl\n          className={classes.field}\n          tags={value}\n          tagConfig={tagConfig}\n          onChange={setValue}\n        />\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={onCancel}>Cancel</Button>\n        <div style={{ flexGrow: 1 }} />\n        <Button onClick={() => setValue(tags)}>Reset</Button>\n        <Button onClick={() => onOk(value)}>Ok</Button>\n      </DialogActions>\n    </Dialog>\n  )\n}\n\nTagEdit.propTypes = {\n  open: PropTypes.bool,\n  title: PropTypes.string,\n  onOk: PropTypes.func,\n  onCancel: PropTypes.func,\n  tags: PropTypes.array.isRequired,\n  tagConfig: PropTypes.object.isRequired\n}\n\nexport default TagEdit\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport Typography from '@material-ui/core/Typography'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { formatDate } from '../../../../lib/datelib'\n\nconst style = theme => ({\n  root: { },\n  rootEdit: { },\n  formControl: {\n    width: '100%'\n  },\n  textBody: {\n    whiteSpace: 'pre-line'\n  },\n  actionButtons: {\n    textAlign: 'right'\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst DateView = ({\n  label,\n  value,\n  className\n}) => {\n  const classes = useStyles()\n  return (\n    <div className={classNames(classes.root, className)}>\n      <Typography variant='overline' className={classes.fieldTitle}>\n        {label}\n      </Typography>\n      <Typography variant='body1' className={classes.hint}>{value ? formatDate(value) : ''}</Typography>\n    </div>\n  )\n}\n\nDateView.propTypes = {\n  className: PropTypes.string,\n  label: PropTypes.string.isRequired,\n  value: PropTypes.string\n}\n\nexport default DateView\n","import React, { useContext, useState } from 'react'\nimport PropTypes from 'prop-types'\n\nimport Typography from '@material-ui/core/Typography'\nimport Divider from '@material-ui/core/Divider'\nimport List from '@material-ui/core/List'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemText from '@material-ui/core/ListItemText'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport TagView from '../controls/TagView'\nimport ShortLongText from '../controls/ShortLongText'\nimport DateControl from '../controls/DateControl'\nimport UserListItem from '../controls/UserListItem'\nimport TagClass from '../../../../lib/Tags'\nimport BigTextEdit from '../dialogs/BigTextEdit'\nimport BigText from '../dialogs/BigText'\nimport TagEdit from '../dialogs/TagEdit'\n\nimport { SeriesContext } from '../../contexts'\nimport DateView from '../controls/DateView'\n\nconst style = theme => ({\n  root: {\n    height: '90%',\n    width: '85%'\n  },\n  dlgTitleContainer: {\n    display: 'flex',\n    padding: 0\n  },\n  catTagTitle: {\n    marginTop: theme.spacing(2)\n  },\n  dlgTitle: {\n    flexGrow: 1,\n    paddingTop: theme.spacing(2),\n    paddingBottom: theme.spacing(1),\n    paddingLeft: theme.spacing(3)\n  },\n  field: {\n    marginBottom: theme.spacing(2)\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst DIALOGS = {\n  NOTEEDIT: 'noteEdit',\n  NOTEVIEW: 'noteView',\n  PHOTOTAKEN: 'taken',\n  TAGEDIT: 'tag',\n  CANCEL: 'cancel'\n}\n\nconst PhotoInfo = ({ canEdit, photo, delta, onChange }) => {\n  const classes = useStyles()\n  const { seriesConfig } = useContext(SeriesContext)\n  const [{ activeDialog, activeDialogContext }, setActiveDialog] = useState({})\n\n  const tagInst = new TagClass(seriesConfig, delta.tags || photo.tags)\n\n  let metaKeys = []\n  try {\n    metaKeys = photo.meta ? Object.keys(JSON.parse(photo.meta)) : []\n  }\n  catch (e) {\n    console.error(e)\n  }\n  return (\n    <div>\n      {photo.createdUser && (\n        <React.Fragment>\n          <UserListItem\n            user={photo.createdUser}\n            onAvatarClick={() => seriesConfig.onAvatarClick(photo.createdUser.username)}\n            secondary='uploaded this photo'\n          />\n          <Divider />\n        </React.Fragment>\n      )}\n      {canEdit ? (\n        <DateControl\n          className={classes.field}\n          label='Photo taken on'\n          value={delta.takenOn || photo.takenOn}\n          onChange={takenOn => onChange({ takenOn })}\n          canEdit={canEdit}\n        />\n      )\n        : (\n          <DateView\n            label='Photo taken on'\n            value={delta.takenOn || photo.takenOn}\n          />\n        )}\n\n      {(canEdit || photo.note) && (\n        <ShortLongText\n          label='Photo Note'\n          text={delta.note || photo.note}\n          onClick={() => {\n            if (canEdit) setActiveDialog({ activeDialog: DIALOGS.NOTEEDIT })\n            else setActiveDialog({ activeDialog: DIALOGS.NOTEVIEW })\n          }}\n        />\n      )}\n      <Typography variant='subtitle1' className={classes.catTagTitle}>Category tags</Typography>\n      <Divider />\n      {tagInst.seriesConfig.getNonXYTagTypes().map((tt, idx) => (\n        <div\n          key={`tagtype-${idx}`}\n          onClick={() => canEdit ? setActiveDialog({ activeDialog: DIALOGS.TAGEDIT, activeDialogContext: tt }) : null}\n        >\n          <TagView\n            className={classes.field}\n            label={tt.label}\n            tags={delta.tags || photo.tags}\n            tagConfig={tt}\n          />\n        </div>\n      ))}\n\n      {metaKeys.length > 0 && Object.keys(seriesConfig.meta).length > 0 && (\n        <React.Fragment>\n          <Typography className={classes.heading}>Metadata</Typography>\n          <Divider />\n          <List className={classes.list}>\n            {metaKeys.map((key, idx) => seriesConfig.meta[key] ? (\n              <ListItem key={`metadata${idx}`}>\n                <ListItemText\n                  primary={seriesConfig.meta[key].label}\n                  secondary={seriesConfig.meta[key].render(photo.meta[key])}\n                />\n              </ListItem>\n            ) : null\n            )}\n          </List>\n        </React.Fragment>\n      )}\n      {activeDialog && activeDialog === DIALOGS.NOTEEDIT && (\n        <BigTextEdit\n          open\n          multiline\n          onOk={note => {\n            onChange({ note })\n            setActiveDialog({})\n          }}\n          title='Edit Photo Note'\n          body={delta.note || photo.note}\n        />\n      )}\n      {activeDialog && activeDialog === DIALOGS.NOTEVIEW && (\n        <BigText\n          open\n          multiline\n          onClose={() => setActiveDialog({})}\n          title='Photo Note'\n          body={delta.note || photo.note}\n        />\n      )}\n      {activeDialog && activeDialog === DIALOGS.TAGEDIT && (\n        <TagEdit\n          open\n          title={`Edit Tags: ${activeDialogContext.label}`}\n          onOk={tags => {\n            setActiveDialog({})\n            onChange({ tags })\n          }}\n          onCancel={() => setActiveDialog({})}\n          tags={delta.tags || photo.tags}\n          tagConfig={activeDialogContext}\n        />\n      )}\n    </div>\n  )\n}\n\nPhotoInfo.propTypes = {\n  canEdit: PropTypes.bool,\n  onChange: PropTypes.func.isRequired,\n  photo: PropTypes.object.isRequired,\n  delta: PropTypes.object.isRequired\n}\n\nexport default PhotoInfo\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n    width: 1,\n    height: 1,\n    zIndex: 1\n  },\n  svgDot: {\n    width: 20,\n    height: 20,\n    position: 'absolute',\n    top: '50%',\n    left: '50%',\n    textAlign: 'center',\n    transformOrigin: '50% 50%',\n    transform: 'translateY(-50%) translateX(-50%)'\n  },\n  svgAccuracyDot: {\n    position: 'absolute',\n    top: '50%',\n    left: '50%',\n    textAlign: 'center',\n    transformOrigin: '50% 50%',\n    transform: 'translateY(-50%) translateX(-50%)'\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst MyLocation = ({ position, projection }) => {\n  const classes = useStyles()\n  const accuracy = 20 // assume 20m to start\n  // metersPerPixel [12, 12, 12]\n  // pixelsPerMeter [0: 0.08029229250399847, 1: -0.08029229250399847, 2: 0.08029229250399847]\n  // console.log('POSITION', { position, projection })\n  const accHeight = projection.pixelsPerMeter[0] * (accuracy)\n  const accWidth = projection.pixelsPerMeter[1] * (accuracy)\n  return (\n    <div className={classes.root}>\n      {/* This is the accuracy radius */}\n      <svg\n        style={{ height: accHeight, width: accWidth }}\n        className={classes.svgAccuracyDot}\n        version='1.1'\n        viewBox='0, 0, 100, 100'\n      >\n        <circle cx='50' cy='50' r={49}\n          stroke='#8888FF'\n          fillOpacity='0.4'\n          strokeWidth='1'\n          fill='#AAAAFF'\n        />\n      </svg>\n      {/* This is the dot */}\n      <svg className={classes.svgDot} version='1.1' viewBox='0, 0, 10, 10'>\n        <circle cx='5' cy='5' r='4'\n          stroke='#FFFFFF'\n          strokeWidth='1'\n          fill='#4444FF'\n        />\n      </svg>\n    </div>\n  )\n}\n\nMyLocation.propTypes = {\n  position: PropTypes.object,\n  projection: PropTypes.object\n}\n\nexport default MyLocation\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Fab from '@material-ui/core/Fab'\nimport MyLocationIcon from '@material-ui/icons/MyLocation'\n\nimport { makeStyles, useTheme } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n    border: '1px solid',\n    background: theme.palette.grey[100],\n    color: 'black',\n    width: 40,\n    height: 40,\n    zIndex: 10,\n    position: 'absolute'\n    // margin: theme.spacing(0.5),\n    // padding: theme.spacing(0.5),\n    // border: '2px solid',\n    // borderRadius: theme.spacing(1),\n    // background: theme.palette.common.white,\n    // fontSize: 20,\n    // position: 'absolute',\n    // zIndex: 100,\n    // bottom: theme.spacing(10),\n    // right: theme.spacing(2)\n  }\n})\n\nconst useStyles = makeStyles(style)\n\nconst MyLocationButton = ({ onClick, controlPadding, disabled }) => {\n  const classes = useStyles()\n  const theme = useTheme()\n  return (\n    <Fab\n      disabled={disabled}\n      style={{\n        top: 56 + (controlPadding.top ? controlPadding.top : theme.spacing(2)),\n        right: controlPadding.right ? controlPadding.right : theme.spacing(2)\n      }}\n      aria-label='myLocation'\n      className={classes.root}\n      onClick={onClick}\n    >\n      <MyLocationIcon />\n    </Fab>\n  )\n}\n\nMyLocationButton.propTypes = {\n  controlPadding: PropTypes.object,\n  onClick: PropTypes.func.isRequired,\n  disabled: PropTypes.bool\n}\n\nexport default MyLocationButton\n","import React, { useState, useRef, useMemo, useEffect } from 'react'\nimport ReactMapGL, { NavigationControl, Marker, FlyToInterpolator } from 'react-map-gl'\nimport PropTypes from 'prop-types'\nimport { easeCubic } from 'd3-ease'\nimport WebMercatorViewport, { getDistanceScales } from 'viewport-mercator-project'\nimport useComponentSize from '../../lib/useComponentSize'\nimport MyLocation from './markers/MyLocation'\nimport { useGeolocation } from '../../lib/sensors'\n// import { debounce } from '../../lib/util'\nimport StyleButtons from './controls/StyleButtons'\nimport MyLocationButton from './controls/MyLocationButton'\nimport { mapConfig } from '../../config'\nimport classNames from 'classnames'\nimport 'mapbox-gl/dist/mapbox-gl.css'\nimport './BaseMap.css'\n\n/**\n * Note that this component technically has state but it is designed to be functionally stateless\n */\nconst BaseMap = (props) => {\n  // pull what we need out of the props\n  const {\n    showMe,\n    children,\n    mapStyles,\n    controlPadding,\n    viewport: initViewport,\n    bounds,\n    lockToBounds,\n    lockPan,\n    initStyle,\n    onViewportChange: incomingOnViewportChange,\n    onTransitionStart: incomingOnTransitionStart,\n    onTransitionEnd: incomingOnTransitionEnd,\n    transitions,\n    onMapDataEvent,\n    stylechooser,\n    ...passthroughProps\n  } = props\n\n  const mapContainerRef = useRef(null)\n  const mapBoxRef = useRef(null)\n  const innerTransitionsRef = useRef(null)\n\n  const { size } = useComponentSize(mapContainerRef)\n\n  const [currStyle, setCurrStyle] = useState(initStyle)\n\n  // This is the truth of the viewport!!\n  const [viewport, setViewport] = useState({ ...defaultViewVals, ...initViewport })\n  const [isTransitioning, setIsTransitioning] = useState(false)\n  const [projection, setProjection] = useState(null)\n\n  let myPosition = {}\n  if (showMe) {\n    myPosition = useGeolocation()\n  }\n  const geoMarker = (myPosition.latitude && myPosition.longitude)\n    ? (\n      <Marker key='myPos' className='myPosMarker' latitude={myPosition.latitude} longitude={myPosition.longitude} style={{ zIndex: 1 }}>\n        <MyLocation position={myPosition} projection={projection} />\n      </Marker>\n    ) : null\n\n  // Recalculate the projection if we need to but only when zoom changes\n  useMemo(() => {\n    if (!size || size.width < 10 || size.height < 10) return\n    if (mapStyles.length <= currStyle) setCurrStyle(initStyle)\n    try {\n      const projection = getDistanceScales(viewport)\n      // console.log('recalcProjection', { projection, size })\n      setProjection(projection)\n    }\n    catch (e) {\n      console.log('ERROR', viewport)\n      console.error(e)\n    }\n  }, [viewport.zoom, size])\n\n  const flyToMe = () => {\n    if (!myPosition.latitude || !myPosition.longitude) return\n    const transitionTime = 2000\n    innerTransitionsRef.current = {\n      transitionDuration: transitionTime,\n      transitionInterpolator: new FlyToInterpolator(),\n      transitionEasing: easeCubic\n    }\n    // You get `transitionTime` ms to figure this out. then we just jump\n    setTimeout(() => {\n      if (innerTransitionsRef.current) innerTransitionsRef.current = null\n    }, transitionTime)\n    setViewport({\n      ...viewport,\n      latitude: myPosition.latitude,\n      longitude: myPosition.longitude,\n      zoom: viewport.zoom > 10 ? viewport.zoom : 12\n    })\n  }\n\n  /**\n   * Callback fired when the user changes the viewport object\n   * @param {*} viewport\n   */\n  const onViewportChange = (viewportChange) => {\n    const newViewport = { ...viewportChange }\n    // Here we set/reset the bounds\n    if (bounds && lockToBounds) {\n      if (newViewport.longitude < bounds[0]) newViewport.longitude = bounds[0]\n      else if (newViewport.longitude > bounds[2]) newViewport.longitude = bounds[2]\n\n      if (newViewport.latitude < bounds[1]) newViewport.latitude = bounds[1]\n      else if (newViewport.latitude > bounds[3]) newViewport.latitude = bounds[3]\n    }\n    if (lockPan) {\n      newViewport.latitude = viewport.latitude\n      newViewport.longitude = viewport.longitude\n    }\n\n    // console.log('onViewportChange', newViewport)\n    // Fire the external callback so parent components can track viewport if they need to\n    if (!isTransitioning && typeof incomingOnViewportChange === 'function') {\n      incomingOnViewportChange({\n        viewport: newViewport,\n        size,\n        projection,\n        map: mapBoxRef.current && mapBoxRef.current.getMap()\n      })\n    }\n    setViewport(newViewport)\n  }\n\n  const recalcZoomBounds = () => {\n    // console.log('Should I recalc viewbounds?')\n    if (!bounds || !size || size.width < 10 || size.height < 10 || isTransitioning) return\n    // On the first run we're going to try to center the bounds.\n    const [minlng, minlat, maxlng, maxlat] = bounds\n    try {\n      console.log('recalcZoomBounds')\n      const { longitude, latitude, zoom } = new WebMercatorViewport({ ...size, ...viewport }).fitBounds(\n        [ [minlng, minlat], [maxlng, maxlat] ],\n        { padding: 40, offset: [0, 0] }\n      )\n      console.log('Changing Zoom ', bounds, viewport.zoom, zoom, viewport)\n\n      // console.log('recalcZoomBounds')\n      setViewport({ ...viewport, longitude, latitude, zoom })\n    }\n    catch (e) {\n      // Sometimes we don't have a valid bound. Don't make a big deal out of it.\n      console.error(e)\n    }\n  }\n\n  const handleTransitionStart = () => {\n    console.log('handleTransitionStart (internal)')\n    setIsTransitioning(true)\n    if (typeof incomingOnTransitionStart === 'function') incomingOnTransitionStart()\n  }\n\n  const handleTransitionEnd = () => {\n    console.log('handleTransitionEnd (internal)')\n    setIsTransitioning(false)\n    innerTransitionsRef.current = null\n    if (incomingOnTransitionEnd) incomingOnTransitionEnd()\n    if (typeof incomingOnViewportChange === 'function') {\n      incomingOnViewportChange({\n        viewport,\n        size,\n        projection,\n        map: mapBoxRef.current && mapBoxRef.current.getMap()\n      })\n    }\n  }\n\n  // RecalcZoombounds should only be done sparingly\n  useMemo(recalcZoomBounds, [size, bounds])\n\n  useEffect(() => {\n    setViewport({ ...viewport, ...initViewport })\n  }\n  , [initViewport])\n\n  return (\n    <div className={classNames('mapContainer', props.className)} ref={mapContainerRef}>\n      {size.height > 0 && size.width > 0 && (\n        <ReactMapGL\n          {...viewport}\n          {...(innerTransitionsRef.current || transitions)}\n          ref={map => {\n            mapBoxRef.current = map\n          }}\n          height={size.height}\n          width={size.width}\n          mapStyle={currStyle < mapStyles.length ? mapStyles[currStyle].style : mapStyles[0].style}\n          onData={onMapDataEvent}\n          onTransitionStart={handleTransitionStart}\n          onTransitionEnd={handleTransitionEnd}\n          dragPan={!lockPan}\n          onViewportChange={onViewportChange}\n          mapboxApiAccessToken={mapConfig.mapBoxToken}\n          {...passthroughProps}\n        >\n          {\n            children && Array.isArray(children)\n              ? children.map((c, idx) => c ? React.cloneElement(\n                handleChild(c, viewport, size.height, size.width, projection),\n                { key: `mapChild-${idx}` }\n              ) : null)\n              : handleChild(children, viewport, size.height, size.width, projection)\n          }\n          {/* Make sure the controls are above everything else */}\n          { stylechooser && (\n            <StyleButtons\n              controlPadding={controlPadding}\n              currStyle={currStyle}\n              mapStyles={mapStyles}\n              setCurrStyle={setCurrStyle}\n            />\n          )}\n          {/* Augment children with some props they need to survive in this harsh world */}\n          { !props.hideNavControls && (\n            <NavigationControl\n              onViewportChange={viewport => onViewportChange({ ...viewport, ...size })}\n              showZoom={!props.touchZoom === false && !props.scrollZoom === false}\n              showCompass={!props.touchRotate === false && !props.dragRotate === false}\n            />\n          )}\n          {showMe && !lockPan && (\n            <React.Fragment>\n              {geoMarker}\n              <MyLocationButton disabled={!myPosition || !myPosition.latitude} controlPadding={controlPadding} onClick={flyToMe} />\n            </React.Fragment>\n          )}\n        </ReactMapGL>\n      )}\n    </div>\n  )\n}\n\nBaseMap.propTypes = {\n  // Anything else we want to add to the map\n  children: PropTypes.any,\n  data: PropTypes.array,\n  // Maybe we want map controls to be padded\n  controlPadding: PropTypes.object,\n\n  showMe: PropTypes.bool,\n\n  // Separate transitions from viewport so we can set them independently\n  transitions: PropTypes.object,\n  initStyle: PropTypes.number,\n\n  // Some switches to make things easier\n  stylechooser: PropTypes.bool,\n  lockPan: PropTypes.bool,\n  lockRotation: PropTypes.bool,\n  lockZoom: PropTypes.bool,\n  lockToBounds: PropTypes.bool,\n  hideNavControls: PropTypes.bool,\n\n  // bounds of the map. may be locked or not [minlng, minlat], [maxlng, maxlat]\n  bounds: PropTypes.array,\n\n  // List of valid styles that will get picker buttons\n  mapStyles: PropTypes.array,\n\n  onMapDataEvent: PropTypes.func,\n  onViewportChange: PropTypes.func\n}\n\nBaseMap.defaultProps = {\n  controlPadding: {},\n  stylechooser: true,\n  initStyle: 0,\n  mapStyles: mapConfig.styles,\n  lockToBounds: false\n}\n\nexport default BaseMap\n\nconst defaultViewVals = {\n  latitude: 49.3050394,\n  longitude: -123.1398254,\n  bearing: 0,\n  pitch: 0,\n  zoom: 12\n}\n\nfunction handleChild (child, viewport, height, width, projection) {\n  return typeof child === 'function'\n    ? child(viewport, height, width, projection)\n    : child\n}\n","import React, { useState, useMemo } from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogActions from '@material-ui/core/DialogActions'\nimport Button from '@material-ui/core/Button'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport FormLabel from '@material-ui/core/FormLabel'\nimport Slider from '@material-ui/lab/Slider'\n\nimport MapDot from '../../../maps/MapDot'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n\n  },\n  dlgContent: {\n    display: 'flex',\n    flexDirection: 'column',\n    padding: 0\n  },\n  mapWrapper: {\n    flexGrow: 1\n  },\n  sliderWrapper: {\n    padding: '20px'\n  },\n  slider: {\n\n  },\n  sliderRoot: {\n\n  },\n  body: {\n    overflow: 'hidden',\n    whiteSpace: 'pre-line',\n    paddingBottom: theme.spacing(1)\n  },\n  title: {\n    background: theme.palette.primary.main,\n    color: theme.palette.primary.contrastText,\n    margin: 0,\n    padding: theme.spacing(2)\n  },\n  closeButton: {\n    position: 'absolute',\n    right: theme.spacing(1),\n    top: theme.spacing(1),\n    color: theme.palette.grey[500]\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst MapDirPicker = ({ open, onOk, onCancel, title, latitude: initLat, longitude: initLong, direction: initDir }) => {\n  const classes = useStyles()\n  const [{ longitude, latitude }, setCoords] = useState({ longitude: initLong, latitude: initLat })\n  const [direction, setRotation] = useState(initDir)\n\n  const initViewport = useMemo(() => ({\n    zoom: 18,\n    latitude: initLat,\n    longitude: initLong\n  }), [initLat, initLong])\n\n  const mapChange = ({ viewport: { longitude, latitude } }) => setCoords({ longitude, latitude })\n\n  return (\n    <Dialog\n      scroll='paper'\n      open={open}\n      fullWidth\n      fullScreen\n      onClose={onCancel}\n    >\n      <DialogTitle className={classes.title} disableTypography>\n        <Typography color='inherit'>{title}</Typography>\n      </DialogTitle>\n      <DialogContent className={classes.dlgContent}>\n        <div className={classes.mapWrapper}>\n          <MapDot\n            editable\n            className={classes.map}\n            direction={direction > 0 ? direction : null}\n            viewport={initViewport}\n            onChange={mapChange}\n          />\n        </div>\n        <div className={classes.sliderWrapper}>\n          <FormLabel className={classes.mapFormLabel}>Direction {direction > -1 ? '' : '(off)'}</FormLabel>\n          <Slider\n            classes={{\n              root: classes.sliderRoot\n            }}\n            value={direction || -1}\n            min={-1}\n            max={360}\n            step={1}\n            onChange={(e, value) => setRotation(value)}\n          />\n        </div>\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={onCancel}>Cancel</Button>\n        <div style={{ flexGrow: 1 }} />\n        <Button onClick={() => onOk({ longitude, latitude, direction })}>Ok</Button>\n      </DialogActions>\n    </Dialog>\n  )\n}\n\nMapDirPicker.propTypes = {\n  open: PropTypes.bool,\n  latitude: PropTypes.number,\n  longitude: PropTypes.number,\n  direction: PropTypes.number,\n  onOk: PropTypes.func,\n  onCancel: PropTypes.func,\n  title: PropTypes.string\n}\n\nexport default MapDirPicker\n","\nimport React, { useState } from 'react'\nimport PropTypes from 'prop-types'\n\nimport TextField from '@material-ui/core/TextField'\nimport FormLabel from '@material-ui/core/FormLabel'\nimport Typography from '@material-ui/core/Typography'\nimport FormControlLabel from '@material-ui/core/FormControlLabel'\nimport Switch from '@material-ui/core/Switch'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport MapDot from '../../../maps/MapDot'\n\nimport MapDirPicker from '../dialogs/MapDirPicker'\nimport BigTextEdit from '../dialogs/BigTextEdit'\n\nimport style from './SeriesEditInner.style'\nimport { ACCESS } from '../../../../config'\nimport ShortLongText from '../controls/ShortLongText'\n\nconst DIALOGS = {\n  MAPPICK: 'mapPicker',\n  NOTEEDIT: 'noteEdit'\n}\n\nconst useStyles = makeStyles(style)\n\n/**\n * SeriesEdit appears in two places so we need this to be a bit reusable\n */\nconst SeriesEditInner = ({ series, delta, onChange }) => {\n  const classes = useStyles()\n  const [activeDialog, setActiveDialog] = useState(null)\n\n  const viewport = { zoom: 18 }\n  if ((delta.latitude || series.coords[1]) && (delta.longitude || series.coords[0])) {\n    viewport.longitude = delta.longitude || series.coords[0]\n    viewport.latitude = delta.latitude || series.coords[1]\n  }\n\n  const access = delta.access || series.access || 'PRIVATE'\n  // console.log('ACESS', access)\n  return (\n    <div>\n      <TextField\n        label='Series Name'\n        fullWidth\n        placeholder='New Series'\n        className={classes.field}\n        value={delta.name || series.name || ''}\n        onChange={e => onChange({ ...delta, name: e.target.value })}\n      />\n      <div className={classes.mapWrapper} onClick={() => setActiveDialog(DIALOGS.MAPPICK)}>\n        <FormLabel className={classes.mapFormLabel}>Location</FormLabel>\n        <div className={classes.mapInnerWrap}>\n          <MapDot\n            staticMap\n            className={classes.map}\n            direction={delta.direction || series.direction}\n            viewport={viewport}\n          />\n        </div>\n      </div>\n      <div className={classes.field}>\n        <FormLabel>Series Access</FormLabel>\n        <div className={classes.access}>\n          <FormControlLabel\n            className={classes.accessRadio}\n            control={\n              <Switch\n                checked={['OPEN', 'PUBLIC'].indexOf(access) > -1}\n                onChange={(e) => {\n                  onChange({ ...delta, access: e.target.checked ? 'PUBLIC' : 'PRIVATE' })\n                }}\n                value={'PUBLIC'}\n              />\n            }\n            label={<div>\n              <Typography variant='body2' component='div'>{ACCESS.PUBLIC.label}</Typography>\n              <Typography variant='caption' color='textSecondary' component='div'>{ACCESS.PUBLIC.description}</Typography>\n            </div>}\n\n          />\n          <FormControlLabel\n            className={classes.accessRadio}\n            disabled={['PRIVATE'].indexOf(access) > -1}\n            control={\n              <Switch\n                checked={['OPEN'].indexOf(access) > -1}\n                onChange={(e) => onChange({ ...delta, access: e.target.checked ? 'OPEN' : 'PUBLIC' })}\n                value={'OPEN'}\n              />\n            }\n            label={<div>\n              <Typography variant='body2' component='div'>{ACCESS.OPEN.label}</Typography>\n              <Typography variant='caption' color='textSecondary' component='div'>{ACCESS.OPEN.description}</Typography>\n            </div>}\n          />\n        </div>\n      </div>\n\n      <ShortLongText\n        onClick={() => setActiveDialog(DIALOGS.NOTEEDIT)}\n        className={classes.field}\n        label='Series Note'\n        text={delta.note || series.note}\n      />\n      {activeDialog === DIALOGS.MAPPICK && (\n        <MapDirPicker\n          open\n          title='Series Location & Direction'\n          latitude={delta.latitude || series.coords[1]}\n          longitude={delta.longitude || series.coords[0]}\n          direction={delta.direction || series.direction}\n          onOk={(data) => {\n            onChange({ ...delta, ...data })\n            setActiveDialog(null)\n          }}\n          onCancel={() => setActiveDialog(null)}\n        />\n      )}\n      {activeDialog === DIALOGS.NOTEEDIT && (\n        <BigTextEdit\n          open\n          title='Series Note'\n          body={delta.note || series.note}\n          multiline\n          onOk={(newNote) => {\n            onChange({ ...delta, note: newNote })\n            setActiveDialog(null)\n          }}\n          onCancel={() => setActiveDialog(null)}\n        />\n      )}\n    </div>\n  )\n}\n\nSeriesEditInner.propTypes = {\n  // now some functions\n  series: PropTypes.object.isRequired,\n  delta: PropTypes.object.isRequired,\n  onChange: PropTypes.func.isRequired\n}\n\nexport default SeriesEditInner\n","export default theme => ({\n  root: {\n\n  },\n  inner: {\n    display: 'flex',\n    flexDirection: 'column'\n    // padding: theme.spacing(1)\n  },\n  dlgTitle: {\n    background: theme.palette.primary.main,\n    color: theme.palette.primary.contrastText\n  },\n  access: {\n    display: 'flex',\n    flexDirection: 'column'\n  },\n  accessRadio: {\n    margin: theme.spacing(2, 1)\n    // flex: '1 1 50%'\n  },\n  grow: {\n    flexGrow: 1\n  },\n  field: {\n    flexGrow: 0,\n    marginBottom: theme.spacing(1) * 2\n  },\n  slider: {\n    paddingLeft: theme.spacing(1),\n    paddingRight: theme.spacing(1)\n  },\n  textField: {\n    marginLeft: theme.spacing(1),\n    marginRight: theme.spacing(1),\n    width: '100%'\n  },\n  formLabel: {\n    display: 'block',\n    marginTop: theme.spacing(1),\n    marginBottom: theme.spacing(1)\n  },\n  mapFormLabel: {\n    display: 'block',\n    marginTop: theme.spacing(1),\n    marginBottom: theme.spacing(1)\n  },\n  mapInnerWrap: {\n    flexGrow: 1,\n    height: '200px',\n    minHeight: '200px'\n  },\n  mapWrapper: {\n    flexGrow: 1,\n    display: 'flex',\n    flexDirection: 'column',\n    paddingBottom: theme.spacing(1) * 2\n  },\n  formControl: {\n    margin: theme.spacing(1),\n    minWidth: 120\n  },\n  chips: {\n    display: 'flex',\n    flexWrap: 'wrap'\n  }\n})\n","import React, { useState, useContext } from 'react'\nimport classNames from 'classnames'\nimport PropTypes from 'prop-types'\n\nimport GridList from '@material-ui/core/GridList'\nimport GridListTile from '@material-ui/core/GridListTile'\nimport GridListTileBar from '@material-ui/core/GridListTileBar'\nimport Snackbar from '@material-ui/core/Snackbar'\nimport Button from '@material-ui/core/Button'\nimport Fab from '@material-ui/core/Fab'\n\nimport AddIcon from '@material-ui/icons/Add'\nimport RemoveIcon from '@material-ui/icons/Remove'\n\nimport { SeriesContext } from '../../contexts'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport style from './PhotoGrid.style'\nimport DeleteDialog from '../dialogs/DeleteDialog'\nimport { formatDate } from '../../../../lib/datelib'\n\nconst useStyles = makeStyles(style)\n\nconst PhotoGrid = ({ photos, columns, multiSelect, onDelete, onTileClick }) => {\n  const [selectMode, setSelectMode] = useState(false)\n  const classes = useStyles()\n  const [selectedItems, setSelectedItems] = useState([])\n  const [deleteConfirm, setDeleteConfirm] = useState(false)\n\n  const { seriesConfig, ac } = useContext(SeriesContext)\n\n  const handleAddToSelection = (e, id) => {\n    e.preventDefault()\n    e.stopPropagation()\n\n    setSelectMode(true)\n    toggleListItem(id)\n  }\n\n  const handleCancelSelection = () => {\n    setSelectMode(false)\n    setSelectedItems([])\n  }\n\n  const onDeleteConfirm = (confirmation) => {\n    setDeleteConfirm(false)\n    if (confirmation === true && selectedItems.length < photos.length) onDelete(selectedItems)\n    handleCancelSelection()\n  }\n\n  const toggleListItem = (id) => {\n    const index = selectedItems.indexOf(id)\n    if (index < 0) setSelectedItems([...selectedItems, id])\n    else {\n      const remaining = selectedItems.filter(arrId => arrId !== id)\n      if (remaining.length === 0) handleCancelSelection()\n      setSelectedItems(remaining)\n    }\n  }\n\n  const handlePhotoTap = (e, photo) => {\n    e.preventDefault()\n    e.stopPropagation()\n    // Select / deselect the item in edit mode\n    if (selectMode) toggleListItem(photo.id)\n    // navigate if tileClick selected\n    else onTileClick(photo.id)\n  }\n\n  const sortedPhotos = [...photos]\n  sortedPhotos.sort((a, b) => parseInt(b.takenOn, 10) - parseInt(a.takenOn, 10))\n\n  return (\n    <div>\n      <GridList cols={columns} cellHeight={200} className={classes.root}>\n        {sortedPhotos.map((photo, idx) => {\n          const selected = selectedItems.indexOf(photo.id) > -1\n          const canDelete = ac.canUser('delete', photo, 'photo')\n\n          let photoUrl = seriesConfig.getPhotoUrl(photo, 'thumb') || photo.base64\n\n          return (\n            <GridListTile\n              key={`gridTile${idx}`}\n              onClick={(e) => canDelete && handlePhotoTap(e, photo)}\n              className={classNames(\n                classes.tile,\n                selectMode && !canDelete && classes.notDeleteable,\n                selectMode && canDelete && !selected && classes.unSelectedTile,\n                selectMode && selected && classes.selectedTile\n              )}\n            >\n              <img src={photoUrl} alt={photoUrl} className={classes.img} />\n              {canDelete && multiSelect && (\n                <Fab size='small' aria-label='Add' className={classes.addFab} onClick={(e) => handleAddToSelection(e, photo.id)}>\n                  {!selectMode || !selected ? <AddIcon /> : <RemoveIcon />}\n                </Fab>\n              )}\n              <GridListTileBar\n                title={<span>{formatDate(photo.takenOn)}</span>}\n              />\n            </GridListTile>\n          )\n        })}\n      </GridList>\n      <Snackbar\n        open={selectMode}\n        autoHideDuration={null}\n        ContentProps={{\n          'aria-describedby': 'snackbar-fab-message-id',\n          className: classes.snackbarContent\n        }}\n        message={<span id='snackbar-fab-message-id'>\n          {selectedItems.length >= photos.length ? 'You can\\'t delete all the photos. delete the series instead.' : `${selectedItems.length} Photos selected`}\n        </span>}\n        action={<div>\n          <Button color='inherit' disabled={selectedItems.length >= photos.length} size='small' onClick={() => setDeleteConfirm(true)}>\n                Delete\n          </Button>\n          <Button color='inherit' size='small' onClick={() => handleCancelSelection()}>\n                Cancel\n          </Button>\n        </div>\n        }\n        className={classes.snackbar}\n      />\n\n      <DeleteDialog\n        open={deleteConfirm}\n        onConfirm={onDeleteConfirm}\n        title={`Delete ${selectedItems.length} Photos`}\n        message='Are you sure you want to delete these photos?'\n      />\n    </div>\n\n  )\n}\n\nPhotoGrid.propTypes = {\n  photos: PropTypes.array.isRequired,\n  columns: PropTypes.number,\n\n  multiSelect: PropTypes.bool,\n  onDelete: PropTypes.func,\n  onTileClick: PropTypes.func.isRequired\n}\nPhotoGrid.defaultProps = {\n  multiSelect: true,\n  columns: 2\n}\n\nexport default PhotoGrid\n","import { red } from '@material-ui/core/colors'\nexport default theme => ({\n  root: {\n\n  },\n  tile: {\n\n  },\n  addFab: {\n    position: 'absolute',\n    zIndex: 10,\n    top: theme.spacing(1),\n    left: theme.spacing(1),\n    opacity: 0.3\n  },\n  notDeleteable: {\n    background: theme.palette.primary.dark,\n    opacity: 0.1\n    // '& img': {\n    // }\n  },\n  unSelectedTile: {\n    '& img': {\n      opacity: 0.7\n    }\n  },\n  selectedTile: {\n    padding: `${theme.spacing(2)}px!important`,\n    '& img': {\n      opacity: 1\n    }\n  },\n  img: {\n\n  },\n  snackbarContent: {\n    backgroundColor: red[700]\n  },\n  snackbar: {\n  }\n})\n","import React, { useState, useContext } from 'react'\nimport PropTypes from 'prop-types'\nimport exifParser from 'exif-parser'\nimport { isNumeric } from '../../../lib/util'\n\nimport PhotoReviewTool from './PhotoReviewTool'\nimport CameraTool from './CameraTool'\nimport NewPhotoInfo from './NewPhotoInfo'\nimport LibraryFilePicker from './controls/LibraryFilePicker'\n\nimport PhotoClass from '../../../lib/Photo'\nimport SeriesClass from '../../../lib/Series'\nimport { useDeviceOrientation, useGeolocation } from '../../../lib/sensors'\n\nimport { SeriesContext } from '../contexts'\n\nconst MODES = {\n  CAMERA: 'camera',\n  FILEPICKER: 'library',\n  PHOTOREVIEW: 'photoreview',\n  PHOTOINFOEDIT: 'photoinfoedit'\n}\n\nconst NewPhoto = ({ inputMethod, onCreate, onCancel, isNewSeries }) => {\n  const { seriesConfig, series } = useContext(SeriesContext)\n  const [newPhoto, setNewPhoto] = useState(null)\n  const [newSeries, setNewSeries] = useState(isNewSeries ? new SeriesClass(seriesConfig).series : null)\n\n  const [photoRefId, setPhotoRefId] = useState(null)\n  const [mode, _changeMode] = useState({ current: inputMethod, history: [] })\n  const orientation = useDeviceOrientation()\n  const geo = useGeolocation()\n\n  const photos = series && series.photos ? series.photos : []\n\n  const onLibraryAdd = (data) => {\n    console.log('onLibraryAdd Debug GOT DATA', { data })\n    const find = 'base64,'\n    let exif = {}\n    const foundIdx = data.indexOf(find) + find.length\n    const newData = data.slice(foundIdx)\n    const parser = exifParser.create(Buffer.from(newData, 'base64'))\n    console.log('onLibraryAdd Buffered')\n    try {\n      exif = parser.parse()\n      console.log('got EXIF', JSON.stringify(exif))\n    }\n    catch (err) {\n    // got invalid data, handle error\n      console.error('EXIF ERROR', err)\n    }\n    // Ok, now try to get the datetime off the EXIF\n    let date = String(Date.now())\n    try {\n      if (exif.tags.DateTimeOriginal && String(exif.tags.DateTimeOriginal)) {\n        date = String(exif.tags.DateTimeOriginal)\n      }\n    }\n    catch (err) {\n      console.log('EXIF', exif)\n      console.error('ERROR GETTING TIMESTAMP', err)\n    }\n    console.log('isNewSeries', { isNewSeries })\n    if (isNewSeries) {\n      let { latitude, longitude } = geo\n      // Stanley park as a fallback if we can't get the geo\n      if (!latitude || !longitude) {\n        latitude = 49.3050394\n        longitude = -123.1398254\n      }\n      try {\n        if (exif.tags.GPSLatitude && isNumeric(exif.tags.GPSLatitude) && exif.tags.GPSLongitude && isNumeric(exif.tags.GPSLongitude)) {\n          latitude = exif.tags.GPSLatitude\n          longitude = exif.tags.GPSLongitude\n        }\n      }\n      catch (e) {\n        console.error('GPS Longitude and Latitude could not be determined')\n      }\n      console.log('LATLONG FOR LIB PICK', { geo, latitude, longitude })\n      setNewSeries({ ...newSeries, coords: [longitude, latitude] })\n    }\n    const photoInitObj = new PhotoClass(seriesConfig).photo\n    const fullNewPhotoObject = {\n      ...photoInitObj,\n      takenOn: date,\n      rawData: { exif },\n      base64: data\n    }\n    setNewPhoto(fullNewPhotoObject)\n    changeMode(MODES.PHOTOREVIEW)\n    console.log('onLibraryAdd FINISHED', fullNewPhotoObject)\n  }\n\n  const changeMode = (newModeName) => {\n    console.log('NEWPHOTO changeMode', mode, newModeName)\n    _changeMode({\n      current: newModeName,\n      history: [...mode.history, mode.current]\n    })\n  }\n  const lastMode = () => {\n    if (mode.history.length > 0) {\n      const oldHistory = [...mode.history]\n      const oldMode = oldHistory.pop()\n      _changeMode({\n        current: oldMode,\n        history: oldHistory\n      })\n    }\n    else {\n      onCancel()\n    }\n  }\n\n  const onShutter = (data, refId) => {\n    const photoInitObj = new PhotoClass(seriesConfig).photo\n\n    console.log('onShutter Debug GOT DATA', { data })\n    const find = 'base64,'\n    let exif = {}\n    const foundIdx = data.base64.indexOf(find) + find.length\n    const newData = data.base64.slice(foundIdx)\n    const parser = exifParser.create(Buffer.from(newData, 'base64'))\n    console.log('onLibraryAdd Buffered')\n    try {\n      exif = parser.parse()\n      console.log('got EXIF', JSON.stringify(exif))\n    }\n    catch (err) {\n    // got invalid data, handle error\n      console.error('EXIF ERROR', err)\n    }\n\n    if (isNewSeries) {\n      let { latitude, longitude } = geo\n      // Stanley park as a fallback if we can't get the geo\n      if (!latitude || !longitude) {\n        latitude = 49.3050394\n        longitude = -123.1398254\n      }\n      setNewSeries({ ...newSeries, coords: [longitude, latitude] })\n    }\n    setNewPhoto({\n      ...photoInitObj,\n      rawData: {\n        orient: orientation,\n        geolocate: geo\n      },\n      base64: data.base64\n    })\n    setPhotoRefId(refId)\n    changeMode(MODES.PHOTOREVIEW)\n  }\n\n  let component = null\n  switch (mode.current) {\n    case MODES.CAMERA:\n      component = (\n        <CameraTool\n          photos={photos}\n          onShutter={onShutter}\n          onCancel={onCancel}\n        />\n      )\n      break\n    case MODES.FILEPICKER:\n      component = <LibraryFilePicker\n        onCancel={onCancel}\n        onLibraryAdd={onLibraryAdd}\n      />\n      // fileClick() // move this to useEffect to help with click handling\n      break\n    case MODES.PHOTOREVIEW:\n      component = (\n        <PhotoReviewTool\n          defaultRefPhotoId={photoRefId}\n          photos={photos}\n          captured={newPhoto}\n          onConfirm={() => changeMode(MODES.PHOTOINFOEDIT)}\n          onCancel={onCancel}\n          onRetry={lastMode}\n        />\n      )\n      break\n    case MODES.PHOTOINFOEDIT:\n      component = (\n        <NewPhotoInfo\n          photo={newPhoto}\n          newSeries={newSeries}\n          onSave={onCreate}\n          onCancel={onCancel}\n        />\n      )\n      break\n    default:\n      console.log('NEWPHOTO: default state. you should NEVER see this', mode)\n      onCancel()\n  }\n\n  return component\n}\n\nNewPhoto.propTypes = {\n  inputMethod: PropTypes.oneOf(['camera', 'library']),\n  onCreate: PropTypes.func.isRequired,\n  onCancel: PropTypes.func.isRequired,\n  isNewSeries: PropTypes.bool,\n  seriesConfig: PropTypes.object,\n  // This might be a new series so we might have\n  // actions to work on that\n  // This will be provided EITHER photos or onSeriesCreate\n  photos: PropTypes.array\n}\n\nexport default NewPhoto\n","import { convertJSDatetoTimestamp } from './datelib'\nimport SeriesConfig from './SeriesConfig'\nimport { localUUID } from '../lib/localdb' // get, setEntry\n\nclass Photo {\n  constructor (seriesConfig, photo) {\n    this.config = new SeriesConfig(seriesConfig)\n    if (photo) this.photo = photo\n    else {\n      this.photo = this.newPhoto()\n    }\n  }\n\n  setMeta = () => {\n    this.meta = JSON.stringify(this.config.getPhotoMeta())\n  }\n\n  newPhoto = () => ({\n    id: localUUID('PHOTO'),\n    takenOn: convertJSDatetoTimestamp(new Date()),\n    meta: JSON.stringify(this.config.getPhotoMeta()),\n    tags: []\n  })\n}\n\nexport default Photo\n","import SeriesConfig from './SeriesConfig'\nimport { localUUID } from '../lib/localdb' // get, setEntry\n\nclass Series {\n  constructor (seriesConfig, series) {\n    this.config = new SeriesConfig(seriesConfig)\n    if (series) this.series = series\n    else {\n      this.series = this.newSeries()\n    }\n  }\n\n  setMeta = () => {\n    this.meta = JSON.stringify(this.config.getSeriesMeta())\n  }\n\n  newSeries = () => ({\n    id: localUUID('SERIES'),\n    meta: JSON.stringify(this.config.getSeriesMeta()),\n    photos: []\n  })\n}\n\nexport default Series\n","import moment from 'moment'\n\n/**\n * Takes a UTC unix timestamp integer or string (milliseconds)\n * and a valid moment format string and returns a formatted\n * date string\n * @param {*} utctimestamp\n * @param {*} format\n */\nexport const formatDate = (utctimestamp, format = 'LLLL') => {\n  return moment(utctimestamp, 'x').format(format)\n}\n\nexport const formatDatAgo = (utctimestamp) => {\n  return moment(utctimestamp, 'x').fromNow()\n}\n\n/**\n * Takes a UTC timestamp and returns a moment object in LOCAL mode\n * @param {*} utctimestamp\n */\nexport const parseDate = (utctimestamp) => {\n  return moment(utctimestamp, 'x')\n}\n\n/**\n * This returns the object in LOCAL mode\n * @param {*} jsDate\n */\nexport const convertJSDatetoTimestamp = (jsDate) => {\n  return moment\n    .utc(jsDate)\n    .format('x')\n}\n\n/**\n *\n * @param {*} utctimestamp\n */\nexport function timestampToHTML5Input (utctimestamp) {\n  // // trim the Z and milliseconds + seconds\n  return moment(utctimestamp, 'x').format('YYYY-MM-DDTkk:mm')\n}\n\n/**\n * Returns an integer timestamp\n * @param {*} isoStr\n */\nexport function HTML5InputToTimestamp (isoStr) {\n  return moment(new Date(isoStr), 'YYYY-MM-DDTkk:mm').format('x')\n}\n","import React, { useEffect, useRef } from 'react'\n\nconst useFileInput = (onChange = () => {}, anyFile = false) => {\n  const inputRef = useRef()\n  const clickRef = useRef()\n\n  const element = (\n    <input style={{ display: 'none' }} ref={inputRef} type='file' accept={!anyFile ? 'image/*' : null} />\n  )\n\n  const forceClick = () => {\n    if (inputRef.current) inputRef.current.click()\n  }\n\n  useEffect(() => {\n    const handleChange = evt => {\n      const [file] = [...inputRef.current.files]\n      if (file) {\n        const reader = new FileReader()\n        reader.onload = e => {\n          onChange(e.target.result)\n        }\n        reader.readAsDataURL(file)\n      }\n      inputRef.current.value = null\n    }\n\n    if (inputRef.current) {\n      inputRef.current.addEventListener('change', handleChange)\n      if (!clickRef.current) {\n        inputRef.current.click()\n        clickRef.current = true\n      }\n    }\n    return () => {\n      if (inputRef.current) {\n        inputRef.current.removeEventListener('change', handleChange)\n      }\n    }\n  }, [inputRef.current])\n\n  return { fileClickEl: element, forceClick }\n}\n\nexport default useFileInput\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport PhotoLibraryIcon from '@material-ui/icons/PhotoLibrary'\nimport { makeStyles } from '@material-ui/core/styles'\nimport useFileInput from '../../../../lib/useFileInput'\nimport { Button } from '@material-ui/core'\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    height: '100%',\n    display: 'flex',\n    flexDirection: 'column',\n    textAlign: 'center',\n    color: theme.palette.grey[600],\n    border: `20px solid ${theme.palette.grey[400]}`\n  },\n  icon: {\n    color: theme.palette.grey[600],\n    margin: 'auto',\n    flex: '1 1 50%',\n    height: '70%',\n    width: '70%'\n  },\n  button: {\n    margin: theme.spacing(2)\n  }\n}))\n\nconst LibraryFilePicker = ({ onLibraryAdd, onCancel }) => {\n  const classes = useStyles()\n  const { fileClickEl, forceClick } = useFileInput(onLibraryAdd)\n  return (\n    <div className={classes.root}>\n      {fileClickEl}\n      <PhotoLibraryIcon className={classes.icon}color='inherit' onClick={forceClick} />\n      <Button variant='contained' className={classes.button} color='primary' onClick={forceClick}>\n        Import from Library\n      </Button>\n      <Button variant='outlined' className={classes.button} color='secondary' onClick={onCancel}>\n        Cancel\n      </Button>\n    </div>\n  )\n}\n\nLibraryFilePicker.propTypes = {\n  onLibraryAdd: PropTypes.func.isRequired,\n  onCancel: PropTypes.func.isRequired\n}\n\nexport default LibraryFilePicker\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport Typography from '@material-ui/core/Typography'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport DialogActions from '@material-ui/core/DialogActions'\nimport Button from '@material-ui/core/Button'\n\nimport SeriesEditInner from './subViews/SeriesEditInner'\n\n// import { SeriesContext } from '../contexts'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport style from './NewPhotoInfo.style'\nimport PhotoInfoInner from './subViews/PhotoInfoInner'\n\nconst useStyles = makeStyles(style)\n\nconst NewPhotoInfo = ({ photo, newSeries, onCancel, onSave }) => {\n  const classes = useStyles()\n  // const { series } = useContext(SeriesContext)\n  const [seriesDelta, setSeriesDelta] = useState(newSeries || {})\n  const [photoDelta, setPhotoDelta] = useState(photo)\n\n  // console.log('NewPhotoInfo', {\n  //   seriesDelta,\n  //   photoDelta,\n  //   photo,\n  //   series,\n  //   newSeries,\n  //   onCancel,\n  //   onSave\n  // })\n  // console.log('NewPhotoInfo', { series, seriesDelta, photoDelta })\n\n  return (\n    <div className={classes.root}>\n      <CssBaseline /> {/* You only need this in a root element. Don't put it anywhere else in the dom */}\n      <Dialog\n        fullScreen\n        fullWidth\n        scroll='paper'\n        disableBackdropClick\n        disableEscapeKeyDown\n        onClose={onCancel}\n        aria-labelledby='customized-dialog-title'\n        open\n      >\n        <DialogTitle disableTypography className={classes.dlgTitleContainer}>\n          <Typography variant='h5' className={classes.dlgTitle}>\n          New Photo Properties\n          </Typography>\n        </DialogTitle>\n        <DialogContent>\n\n          {!!newSeries && (\n            <SeriesEditInner\n              series={newSeries}\n              delta={seriesDelta}\n              onChange={setSeriesDelta}\n            />\n          )}\n\n          <PhotoInfoInner\n            photo={photo}\n            canEdit\n            delta={photoDelta}\n            onChange={(newAttr) => setPhotoDelta({ ...photoDelta, ...newAttr })}\n          />\n\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={onCancel} color='primary'>\n            Cancel\n          </Button>\n          <Button onClick={() => onSave({ series: seriesDelta, photo: photoDelta })} color='primary'>\n            Next\n          </Button>\n        </DialogActions>\n      </Dialog>\n    </div>\n  )\n}\n\nNewPhotoInfo.propTypes = {\n  photo: PropTypes.object.isRequired,\n  newSeries: PropTypes.object,\n  // Standard functions\n  onCancel: PropTypes.func.isRequired,\n  onSave: PropTypes.func\n}\n\nexport default NewPhotoInfo\n","export default theme => ({\n  root: {\n\n  },\n  formLabel: {\n    color: theme.palette.text.secondary\n  },\n  mapFormLabel: {\n    marginTop: theme.spacing(2),\n    marginBottom: theme.spacing(1),\n    color: theme.palette.text.secondary\n  },\n  map: {\n    marginBottom: theme.spacing(2)\n  },\n  mapWrapper: {\n    marginBottom: theme.spacing(2)\n  },\n  field: {\n    marginBottom: theme.spacing(2)\n  }\n})\n","import React, { useState, useContext } from 'react'\nimport PropTypes from 'prop-types'\n\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport Snackbar from '@material-ui/core/Snackbar'\nimport Button from '@material-ui/core/Button'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport Photo from './subViews/Photo'\nimport PhotoFadeSlider from './controls/PhotoFadeSlider'\nimport style from './PhotoReviewTool.style'\n\nimport { SeriesContext } from '../contexts'\nconst useStyles = makeStyles(style)\n\nconst PhotoReviewTool = ({\n  captured, defaultRefPhotoId,\n  onConfirm, onCancel, onRetry\n}) => {\n  const { series } = useContext(SeriesContext)\n  const photos = series && series.photos ? series.photos : null\n  const classes = useStyles()\n\n  const newRefPhoto = defaultRefPhotoId\n    ? photos.find(p => p.id === defaultRefPhotoId)\n    : photos && photos.length > 0 ? photos[0] : null\n\n  const [refPhoto, setRefPhoto] = useState(newRefPhoto)\n  const [slider, setSlider] = useState(100)\n\n  if (!captured) return 'Loading...'\n\n  return (\n    <div className={classes.root}>\n      <CssBaseline />\n      { Boolean(refPhoto) && (\n        <PhotoFadeSlider defaultValue={100} onChange={setSlider} />\n      )}\n\n      <div className={classes.captured}>\n        <Photo\n          opacity={slider / 100}\n          className={classes.capturedContainer}\n          photo={captured}\n        />\n      </div>\n      { Boolean(refPhoto) && (\n        <div className={classes.reference} >\n          <Photo\n            className={classes.referenceContainer}\n            photo={refPhoto}\n          />\n        </div>\n      )}\n      <Snackbar\n        open\n        autoHideDuration={null}\n        ContentProps={{\n          'aria-describedby': 'snackbar-fab-message-id',\n          className: classes.snackbarContent\n        }}\n        message={<span id='snackbar-fab-message-id'>Keep this photo?</span>}\n        action={<div>\n          <Button color='inherit' size='small' onClick={onCancel}>\n                Cancel\n          </Button>\n          {Boolean(onRetry) && (\n            <Button color='inherit' size='small' onClick={onRetry}>\n          Retry\n            </Button>\n          )}\n\n          <Button color='inherit' size='small' onClick={onConfirm}>\n                Keep\n          </Button>\n        </div>\n        }\n        className={classes.snackbar}\n      />\n    </div>\n  )\n}\n\nPhotoReviewTool.propTypes = {\n  defaultRefPhotoId: PropTypes.string,\n  captured: PropTypes.object,\n  // Now some functions\n  onConfirm: PropTypes.func.isRequired,\n  onCancel: PropTypes.func.isRequired,\n  onRetry: PropTypes.func // only for camera\n\n}\n\nexport default PhotoReviewTool\n","export default theme => ({\n  root: {\n    background: 'rgb(150,150, 150)',\n    // border: '5px solid red',\n    height: '100%',\n    width: '100%'\n  },\n  capturedContainer: {\n    position: 'absolute',\n    zIndex: 1,\n    height: '100%',\n    width: '100%'\n  },\n  referenceContainer: {\n    position: 'absolute',\n    zIndex: 0,\n    height: '100%',\n    width: '100%'\n  },\n  captured: {\n\n  },\n  reference: {\n\n  },\n  referenceTextContainer: {\n    width: '100%',\n    display: 'flex',\n    color: 'white',\n    background: 'rgba(0,0,0,0.5)',\n    padding: theme.spacing(3),\n    position: 'absolute',\n    zIndex: 4,\n    top: 0\n  },\n  newText: {\n    flexGrow: 1,\n    color: 'white',\n    textShadow: '1 1 1 black',\n    textAlign: 'right'\n  },\n  refText: {\n    flexGrow: 1,\n    color: 'white',\n    textShadow: '1 1 1 black'\n  }\n})\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\n\nimport Fab from '@material-ui/core/Fab'\nimport SwipeableDrawer from '@material-ui/core/SwipeableDrawer'\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport Typography from '@material-ui/core/Typography'\n\nimport CameraIcon from '@material-ui/icons/Camera'\nimport CancelIcon from '@material-ui/icons/Cancel'\nimport PhotoLibraryIcon from '@material-ui/icons/PhotoLibrary'\n\nimport PhotoFadeSlider from './controls/PhotoFadeSlider'\nimport PhotoGrid from './subViews/PhotoGrid'\nimport Photo from './subViews/Photo'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport style from './CameraTool.style'\nimport { useCamera } from '../../../lib/useCamera'\n\nconst useStyles = makeStyles(style)\n\n// https://googlechrome.github.io/samples/image-capture/grab-frame-take-photo.html\nconst CameraTool = ({ photos, onCancel, onShutter, defaultRefPhotoId }) => {\n  const classes = useStyles()\n  const [slider, setSlider] = useState(50)\n  const newRefPhoto = defaultRefPhotoId\n    ? photos.find(p => p.id === defaultRefPhotoId)\n    : photos && photos.length > 0 ? photos[0] : null\n\n  const [refPhoto, setRefPhoto] = useState(newRefPhoto)\n  const [drawerOpen, setDrawerOpen] = useState(false)\n  const { cameraError, captureImage, cameraOnline } = useCamera((data) => onShutter(data, refPhoto ? refPhoto.id : null))\n\n  const handleTileClick = (id) => {\n    setRefPhoto(photos.find(p => p.id === id))\n    setDrawerOpen(false)\n  }\n\n  return (\n    <div className={classes.root}>\n      <CssBaseline />\n      { !cameraError && Boolean(refPhoto) && (\n        <PhotoFadeSlider defaultValue={slider} onChange={setSlider} />\n      )}\n\n      { cameraError && (\n        <div className={classes.cameraErrorText}>\n          <Typography variant='subtitle1' color='inherit'>No Camera Access</Typography>\n          <Typography variant='body2' color='inherit'>Please enabled access in your settings.</Typography>\n        </div>\n      )}\n\n      <div className={classes.captured}>\n        { Boolean(refPhoto) && (\n          <div className={classes.reference} >\n            <Photo\n              className={classes.referenceContainer}\n              opacity={(100 - slider) / 100}\n              photo={refPhoto}\n            />\n          </div>\n        )}\n        { !cameraError && (\n          <video\n            autoPlay\n            playsInline\n            muted\n            id='webcam'\n            width={window.innerWidth}\n            height={window.innerHeight}\n            className={classes.video}\n          />\n        )}\n      </div>\n\n      <Fab\n        color='primary'\n        aria-label='Take Photo'\n        classes={{\n          disabled: classes.disabledFab\n        }}\n        disabled={cameraError || !cameraOnline}\n        className={classNames(classes.cameraFab, classes.buttonFab)}\n        onClick={captureImage}\n      >\n        <CameraIcon className={classes.cameraIcon} />\n      </Fab>\n\n      <Fab\n        color='secondary'\n        aria-label='cancel'\n        onClick={onCancel}\n        classes={{\n          disabled: classes.disabledFab\n        }}\n        className={classNames(classes.cancelFab, classes.buttonFab)}\n      >\n        <CancelIcon className={classes.cancelIcon} />\n      </Fab>\n\n      <Fab\n        aria-label='cancel'\n        className={classNames(classes.libraryFab, classes.buttonFab)}\n        classes={{\n          disabled: classes.disabledFab\n        }}\n        disabled={!photos || photos.length === 0}\n        onClick={() => setDrawerOpen(true)}\n      >\n        <PhotoLibraryIcon className={classes.libraryIcon} />\n      </Fab>\n\n      <SwipeableDrawer\n        anchor='left'\n        open={drawerOpen}\n        classes={{\n          paperAnchorLeft: classes.swipeDrawer\n        }}\n        onClose={() => setDrawerOpen(false)}\n        onOpen={() => setDrawerOpen(true)}\n      >\n        <div\n          tabIndex={0}\n          className={classes.swipeDrawerContainer}\n          role='button'\n          onClick={() => setDrawerOpen(false)}\n          onKeyDown={() => setDrawerOpen(false)}\n        >\n          <PhotoGrid\n            multiSelect={false}\n            columns={1}\n            photos={photos}\n            onTileClick={handleTileClick}\n          />\n        </div>\n      </SwipeableDrawer>\n\n    </div>\n  )\n}\n\nCameraTool.propTypes = {\n  photos: PropTypes.array,\n  defaultRefPhotoId: PropTypes.string, // id of the reference photo\n  onCancel: PropTypes.func.isRequired,\n  onShutter: PropTypes.func.isRequired\n}\n\nexport default CameraTool\n","export default theme => ({\n  root: {\n    background: 'black',\n    // border: '5px solid red',\n    height: '100%',\n    width: '100%'\n  },\n  cameraErrorText: {\n    color: 'white',\n    position: 'absolute',\n    top: '50%',\n    left: '50%',\n    width: '90%',\n    transform: 'translateY(-50%) translateX(-50%)',\n    textAlign: 'center'\n  },\n  disabledFab: {\n    color: '#AAAAA!important',\n    background: '#DDDDDD!important',\n    opacity: 0.2\n  },\n  cameraFab: {\n    position: 'absolute',\n    zIndex: 10,\n    '@media (orientation: landscape)': {\n      right: '20px',\n      top: '50%',\n      transform: 'translateY(-50%)',\n      height: '25vh',\n      width: '25vh'\n    },\n    '@media (orientation: portrait)': {\n      bottom: '20px',\n      left: '50%',\n      transform: 'translateX(-50%)',\n      height: '25vw',\n      width: '25vw'\n    }\n  },\n  cameraIcon: {\n    height: '100%',\n    width: '100%'\n  },\n  cancelFab: {\n    position: 'absolute',\n    zIndex: 10,\n    '@media (orientation: landscape)': {\n      right: '15px',\n      top: '15px',\n      height: '15vh',\n      width: '15vh'\n    },\n    '@media (orientation: portrait)': {\n      right: '15px',\n      bottom: '15px',\n      height: '15vw',\n      width: '15vw'\n    }\n  },\n  cancelIcon: {\n    height: '100%',\n    width: '100%'\n  },\n\n  swipeDrawer: {\n    width: '50%'\n  },\n\n  libraryFab: {\n    position: 'absolute',\n    zIndex: 10,\n    '@media (orientation: landscape)': {\n      left: '15px',\n      top: '15px',\n      height: '15vh',\n      width: '15vh'\n    },\n    '@media (orientation: portrait)': {\n      left: '15px',\n      top: '15px',\n      height: '15vw',\n      width: '15vw'\n    }\n  },\n\n  myLocationFab: {\n    position: 'absolute',\n    zIndex: 10,\n    '@media (orientation: landscape)': {\n      right: '15px',\n      bottom: '15px',\n      height: '15vh',\n      width: '15vh'\n    },\n    '@media (orientation: portrait)': {\n      left: '15px',\n      bottom: '15px',\n      height: '15vw',\n      width: '15vw'\n    }\n  },\n  myLocationIcon: {\n    height: '80%',\n    width: '80%'\n  },\n  capturedContainer: {\n    position: 'absolute',\n    zIndex: 1,\n    height: '100%',\n    width: '100%'\n  },\n  referenceContainer: {\n    position: 'absolute',\n    zIndex: 2,\n    height: '100%',\n    width: '100%'\n  },\n  captured: {\n\n  },\n  reference: {\n\n  },\n  video: {\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    height: '100vh',\n    width: '100vw',\n    zIndex: 1\n    // '@media (orientation: portrait)': {\n    //   transform: 'rotate(90)'\n    // }\n  }\n  // overlayImage: {\n  //   position: 'absolute',\n  //   top: 0,\n  //   left: 0,\n  //   zIndex: 3,\n  //   height: '100vh',\n  //   width: '100vw',\n  //   textAlign: 'center'\n  // },\n  // overlayImageInner: {\n  //   '@media (orientation: landscape)': {\n  //     height: '100%',\n  //     width: 'auto'\n  //   },\n  //   '@media (orientation: portrait)': {\n  //     width: '100%',\n  //     height: 'auto'\n  //   }\n  // },\n  // newImage: {\n  //   position: 'absolute',\n  //   top: 0,\n  //   left: 0,\n  //   zIndex: 2\n  // }\n})\n","import React from 'react'\n\nexport const SeriesContext = React.createContext({})\n","import numeral from 'numeral'\n\nexport const isNumeric = num => {\n  try {\n    return !isNaN(parseFloat(num)) && isFinite(num)\n  }\n  catch (e) {\n    return false\n  }\n}\n/**\n * This is a correction to strip === signs off of base64-encoded strings\n * @param {} x\n */\nexport const urlizeb64 = x => x.replace('+', '-').replace('/', '_').replace(/=+$/, '')\n\n/**\n * We need numbers displayed consistently. This is how we do it.\n * @param {*} num\n * @param {*} precision\n */\nexport function formatNum (num, precision) {\n  try {\n    const precstr = precision > 0 ? '.' + Array(precision + 1).join('0') : ''\n    const newprec = isNumeric(num) ? numeral(num).format(`0,0${precstr}`) : num\n    return newprec.replace(/(\\.(0{0,1}[1-9]*))0+$/, '$1')\n  }\n  catch (e) {\n    return num\n  }\n}\n\n/**\n * Magic function to clear mouse selection. Use sparingly.\n */\nexport function clearSelection () {\n  if (document.selection && document.selection.empty) {\n    document.selection.empty()\n  }\n  else if (window.getSelection) {\n    var sel = window.getSelection()\n    sel.removeAllRanges()\n  }\n}\n\nexport function isObjectWithKeys (obj) {\n  return ((typeof obj === 'object') && (obj !== null) && Object.keys(obj).length > 0)\n}\n\n/**\n * Dom node parsing is weird because it may return an array or a single element with no way to know\n * which is which.\n */\nexport function makeDomArray (domnode) {\n  if (!domnode) return []\n  const keys = Object.keys(domnode)\n  // This is not the pattern we expect\n  if (keys.length > 1 || keys.length === 0) throw Error('Expected nester domnode structure.')\n  if (!domnode) return []\n  if (!domnode[keys[0]]) return []\n  return Array.isArray(domnode[keys[0]]) ? domnode[keys[0]] : [domnode[keys[0]]]\n}\n\nexport function capitalizeFirstLetter (string) {\n  return string.charAt(0).toUpperCase() + string.slice(1)\n}\n\n/**\n * Good for comparing two purely numeric arrays\n * @param {*} arr1\n * @param {*} arr2\n */\nexport function numericArrayCompare (arr1, arr2) {\n  if (!Array.isArray(arr1) || !Array.isArray(arr2)) return false\n  if (arr1.length !== arr2.length) return false\n\n  return !arr1.some((el, idx) => el !== arr2[idx])\n}\n\n/**\n * We need a function to add the padding '=' signs back before we decode\n * @param {*} hash\n */\nexport function decodeUnbufferedBase64 (hash) {\n  const missingPadding = hash.length % 4\n  if (missingPadding !== 0) {\n    const newhash = hash + Array(4 - missingPadding).join('=')\n    return Buffer.from(newhash, 'base64').toString()\n  }\n  else {\n    return Buffer.from(hash, 'base64').toString()\n  }\n}\n\nexport function encodeUnbufferedBase64 (str) {\n  return urlizeb64(Buffer.from(str).toString('base64'))\n}\n\n/**\n *\n * @param {*} o\n */\nexport function isObject (o) {\n  return o instanceof Object && o.constructor === Object\n}\n\n/**\n * XML to JSON is a non-trivial exercise. We can make certain assumptions\n * about our incoming file\n * @param {*} data\n */\nexport function arrToObj (data) {\n  for (const key in data) {\n    // Make sure we're looping over legitimate objects\n    if (data.hasOwnProperty(key)) {\n      const keyDat = data[key]\n      if (keyDat._) {\n        keyDat.val = keyDat._\n        delete keyDat._\n      }\n      if (keyDat.$) {\n        keyDat.attr = keyDat.$\n        delete keyDat.$\n      }\n      if (typeof keyDat === 'object') {\n        data[key] = arrToObj(keyDat)\n        // There's a pattern we want to collapse\n        // It puts every single individual value into its own array. Not cool\n        if (Array.isArray(keyDat) && keyDat.length === 1 && typeof keyDat[0] === 'string') {\n          if (isNumeric(keyDat[0])) data[key] = Number(keyDat[0])\n          else data[key] = keyDat[0].replace(/\\\\/g, '/')\n        }\n        else if (Array.isArray(keyDat) && keyDat.length === 1 &&\n        // The second case is when it puts objects into its own array\n          isObject(keyDat[0]) &&\n          Object.keys(keyDat[0]).length === 1) {\n          // xml2js does a weird thing where attributes get put into the following structure\n          // [{ \"_\": \"475945.992587164,5125837.37170763\", \"$\": { \"units\": \"m\"  } }]\n          data[key] = keyDat[0][Object.keys(keyDat[0])[0]]\n        }\n        // Dynamo DB does not like empty strings\n        if (typeof data[key] && data[key].length === 0) {\n          delete data[key]\n        }\n        if (typeof data[key] === 'string' && isNumeric(data[key])) data[key] = Number(data[key])\n      }\n    }\n  }\n  return data\n}\n\n/**\n * Returns a random number between min (inclusive) and max (exclusive)\n */\nexport function getRandomArbitraryInt (min, max) {\n  return parseInt(Math.random() * (max - min) + min, 10)\n}\n\n/**\n * Returns a function, that, as long as it continues to be invoked, will not\n * be triggered. The function will be called after it stops being called for\n * N milliseconds. If `immediate` is passed, trigger the function on the\n * leading edge, instead of the trailing.\n * @param {*} func\n * @param {*} wait\n * @param {*} immediate\n */\nexport function debounce (func, wait, immediate) {\n  let timeout = null\n  return (...innerArgs) => {\n    const context = this\n    // const args = arguments\n    const callNow = immediate && !timeout\n    clearTimeout(timeout)\n\n    timeout = setTimeout(() => {\n      timeout = null\n      if (!immediate) {\n        // console.log('debounce', innerArgs)\n        func.apply(context, innerArgs)\n      }\n    }, wait)\n    if (callNow) {\n      // console.log('debounce', innerArgs)\n      func.apply(context, innerArgs)\n    }\n  }\n};\n\n// var myEfficientFn = debounce(function() {\n// // All the taxing stuff you do\n// }, 250);\n\n// window.addEventListener('resize', myEfficientFn);\n","// https://medium.com/@shalkam/create-react-app-i18n-the-easy-way-b05536c594cb\nimport React, { useContext } from 'react'\nimport PropTypes from 'prop-types'\nimport { IntlProvider, addLocaleData } from 'react-intl'\nimport frLocaleData from 'react-intl/locale-data/fr'\n\naddLocaleData(frLocaleData)\n\nexport const IntlContext = React.createContext({})\n\n// the format message hook\nexport const useIntl = () => {\n  const intl = useContext(IntlContext)\n  return intl.formatMessage\n}\n\nexport const IntlWrapper = ({ children }) => (\n  <IntlProvider locale='en'>\n    {children}\n  </IntlProvider>\n)\nIntlWrapper.propTypes = {\n  children: PropTypes.any\n}\n","import gql from 'graphql-tag'\n\nexport const photoSummaryFragment = gql`\nfragment photoSummaryFragment on PhotoSummary {\n  id\n  takenOn\n  seriesCreatedBy\n  updatedOn\n  createdOn\n  seriesId\n  createdUser {\n    ...userSummaryFragment\n  }\n  paths {\n    base\n    thumb\n    medium\n    large\n  }\n}\n`\n\nexport const userSummaryFragment = gql`\nfragment userSummaryFragment on UserSummary {\n  id\n  gravatar\n  gravatarProfile\n  username\n}\n`\n\nexport const seriesSummaryFragment = gql`\nfragment seriesSummaryFragment on SeriesSummary {\n  id\n  name\n  access\n  createdUser {\n    ...userSummaryFragment\n  }\n  seriesStatus\n  updatedOn\n  createdOn\n  photoCount\n  coords\n  direction\n  watchers\n  featured {\n    ...photoSummaryFragment\n  }\n  latest {\n    ...photoSummaryFragment\n  }\n}\n${photoSummaryFragment}\n${userSummaryFragment}\n`\n\nexport const seriesFragment = gql`\nfragment seriesFragment on Series {\n  id\n  name\n  note\n  meta\n  watchers\n  createdOn\n  updatedOn\n  createdUser {\n    ...userSummaryFragment\n  }\n  updatedUser {\n    ...userSummaryFragment\n  }\n  coords\n  direction\n  photoCount\n  featured {\n    ...photoSummaryFragment\n  }\n  latest {\n    ...photoSummaryFragment\n  }\n}\n${photoSummaryFragment}\n${userSummaryFragment}\n`\n\nexport const photoFragment = gql`\nfragment photoFragment on Photo {\n  id\n  meta\n  createdOn\n  takenOn\n  updatedOn\n  coords\n  seriesId\n  seriesCreatedBy\n  createdBy\n  updatedBy\n  createdUser {\n    ...userSummaryFragment\n  }\n  updatedUser {\n    ...userSummaryFragment\n  }\n  tags {\n    label\n    typeId\n    coords {\n      x\n      y\n    }\n  }\n  paths {\n    base\n    large\n    thumb\n    medium\n  }\n}\n${userSummaryFragment}\n`\n\nexport const userFragment = gql`\nfragment userFragment on User {\n  id\n  username\n  gravatar\n  watching\n  gravatarProfile\n  meta\n  createdOn\n  updatedOn\n}\n`\n","import gql from 'graphql-tag'\nimport {\n  photoSummaryFragment,\n  photoFragment,\n  seriesSummaryFragment,\n  seriesFragment,\n  userFragment\n} from './fragments'\n\nexport const allSeries = gql`\nquery allSeries($limit: Int, $nextToken: String) {\n  allSeries(limit: $limit, nextToken: $nextToken) @connection(key: \"allSeries\"){\n    seriesSummaries {\n      ...seriesSummaryFragment\n    }\n    nextToken\n  }\n}\n${seriesSummaryFragment}\n`\n\nexport const pollQuery = gql`\nquery pollQuery($lastCheck: String!, $limit: Int, $nextToken: String) {\n  changedSeries(lastCheck: $lastCheck, limit: $limit, nextToken: $nextToken) @connection(key: \"changedSeries\"){\n    seriesSummaries {\n      ...seriesSummaryFragment\n    }\n  }\n}\n${seriesSummaryFragment}\n`\n\nexport const userSeries = gql`\nquery userSeries($createdBy: ID) {\n  userSeries(createdBy: $createdBy ) {\n    seriesSummaries {\n      ...seriesSummaryFragment\n    }\n    nextToken\n  }\n}\n${seriesSummaryFragment}\n`\n\nexport const seriesSummaryFromList = gql`\nquery seriesFromList($seriesList: [ID]) {\n  arraySeries(seriesIds: $seriesList) {\n    ...seriesSummaryFragment\n  }\n}\n${seriesSummaryFragment}\n`\n\nexport const seriesFromList = gql`\nquery seriesFromList($seriesList: [ID]) {\n  arraySeries(seriesIds: $seriesList) {\n    ...seriesFragment\n    photos {\n      ...photoFragment\n    }\n  }\n}\n${seriesFragment}\n${photoFragment}\n`\n\nexport const seriesWithTag = gql`\nquery seriesWithTag($tag: String!, $limit: Int, $nextToken: String) {\n  tagSeries(tag: $tag, limit: $limit, nextToken: $nextToken) {\n    seriesSummaries{\n      ...seriesSummaryFragment\n    }\n    nextToken\n  }\n}\n${seriesSummaryFragment}\n`\n\nexport const tagSearch = gql`\nquery tagSearch($limit: Int, $tag: String) {\n  tags(limit: $limit, tag: $tag ){\n    _id\n    name\n    count\n  }\n}\n`\n\nexport const geoSeries = gql`\nquery seriesInGeoBounds($bounds: [Float], $limit: Int, $nextToken: String) {\n  seriesInGeoBounds(bounds: $bounds, limit: $limit, nextToken: $nextToken) {\n    seriesSummaries {\n      ...seriesSummaryFragment\n    }\n    nextToken\n  }\n}\n${seriesSummaryFragment}\n`\n\nexport const getUser = gql`\nquery getUser($userId: ID) {\n  user(id: $userId){\n    ...userFragment\n  }\n}\n${userFragment}\n`\n\nexport const geocode = gql`\nquery geocode($search: String!) {\n  geocoder(search: $search) {\n    relevance\n    text\n    placeName\n    bbox\n    center\n    # geoType\n    # context\n  }\n}\n`\nexport const getMyFeed = gql`\nquery myFeed($start: String, $end: String, $limit: Int) {\n  myFeed(start: $start, end: $end, limit: $limit) @connection(key: \"myFeed\"){\n    feed {\n      series {\n        ...seriesSummaryFragment\n      }\n      photo {\n        ...photoSummaryFragment\n      }\n      relation\n    }\n    window\n  }\n}\n${seriesSummaryFragment}\n${photoSummaryFragment}\n`\n\nexport const userSearch = gql`\nquery userSearch($searchStr: String!, $limit: Int) {\n  userSearch(searchStr: $searchStr, limit: $limit ){\n    ...userFragment\n  }\n}\n${userFragment}\n`\n\nexport const getWholeSeries = gql`\nquery getWholeSeries($id: ID!) {\n  series(id: $id) {\n    ...seriesFragment\n    photos {\n      ...photoFragment\n    }\n  }\n}\n${seriesFragment}\n${photoFragment}\n`\n","import { createMuiTheme } from '@material-ui/core/styles'\nimport { fade, lighten } from '@material-ui/core/styles/colorManipulator'\n// import {\n//   cyan, teal, indigo, grey, blueGrey, pink, yellow, deepOrange, red\n// } from '@material-ui/core/colors'\n\n// We need this so that it doesn't freak out abotu old variants\nconst typography = {\n  useNextVariants: true\n}\n\nconst colors = {\n  jet: '#3a3335', // JET\n  rose: '#d81e5b', // DOGWOOD ROSE\n  redorange: '#f0544f', // RED-ORANGE\n  papayawhip: '#FDF0D5', // PAPAYA WHIP\n  cblue: '#C6D8D3' // COLUMBIA-BLUE\n}\n\nconst home = {\n  palette: {\n    primary: {\n      main: colors.redorange\n    },\n    secondary: {\n      main: colors.rose\n    },\n    text: {\n      primary: colors.jet,\n      secondary: fade(colors.jet, 0.7)\n    }\n  },\n  typography\n}\n\nconst series = {\n  palette: {\n    primary: {\n      main: lighten(colors.jet, 0.1)\n    },\n    secondary: {\n      main: colors.rose\n    },\n    text: {\n      primary: colors.jet,\n      secondary: fade(colors.jet, 0.7)\n    }\n  },\n  typography\n}\n\nconst topbar = {\n  palette: {\n    primary: {\n      main: colors.redorange\n    },\n    secondary: {\n      main: colors.rose\n    }\n  },\n  typography\n}\n\nconst bottombar = {\n  palette: {\n    primary: {\n      main: colors.papayawhip\n    },\n    secondary: {\n      main: colors.redorange\n    }\n  },\n  typography\n}\n\nconst login = {\n  palette: {\n    primary: {\n      main: colors.redorange\n    },\n    secondary: {\n      main: colors.rose\n    },\n    text: {\n      primary: colors.papayawhip,\n      secondary: fade(colors.papayawhip, 0.7)\n    },\n    background: {\n      default: colors.jet,\n      paper: colors.jet\n    }\n  },\n  typography\n}\n\nexport default {\n  home: createMuiTheme(home),\n  login: createMuiTheme(login),\n  series: createMuiTheme(series),\n  topbar: createMuiTheme(topbar),\n  bottombar: createMuiTheme(bottombar)\n}\n","import React from 'react'\n\nexport const AppContext = React.createContext({})\n","import { useRef, useEffect } from 'react'\n\nconst useAuthCommon = () => {\n  const containerRef = useRef()\n  const handleKeyPress = (event) => {\n    if (event.key === 'Enter') {\n      if (containerRef.current) {\n        try {\n          const found = containerRef.current.getElementsByClassName('enterAction')\n          if (found && found[0]) found[0].click()\n        }\n        catch (e) {\n          console.error('useAuthCommon::handleKeyPress', e)\n        }\n      }\n    }\n  }\n  useEffect(() => {\n    if (containerRef.current) {\n      try {\n        document.addEventListener('keypress', handleKeyPress, false)\n      }\n      catch (e) {\n        console.error('useAuthCommon::useEffect', e)\n      }\n      return () => document.removeEventListener('keypress', handleKeyPress, false)\n    }\n  }, [])\n\n  return containerRef\n}\n\nexport default useAuthCommon\n","import React from 'react'\nimport createSvgIcon from '@material-ui/icons/utils/createSvgIcon'\n\nexport default createSvgIcon(\n  <React.Fragment>\n    <path d='M13.685,2.797c-0.44,1.273 0.852,3.525 -1.082,4.966c-1.247,0.93 -2.133,2.247 -2.743,4.167c-3.78,-7.611 2.788,-8.409 3.682,-10.699c0.64,1.255 5.18,2.608 2.89,4.873c1.28,-2.034 -2.359,-1.862 -2.747,-3.307Z' />\n    <path d='M4.921,5.953c0.883,1.017 3.479,1.024 3.76,3.42c0.181,1.545 0.879,2.971 2.238,4.459c-8.482,-0.532 -5.889,-6.619 -7.425,-8.538c1.407,0.073 4.848,-3.183 5.665,-0.066c-1.121,-2.126 -2.792,1.111 -4.238,0.725Z' />\n    <path d='M3.236,15.092c1.323,-0.256 2.627,-2.5 4.842,-1.546c1.428,0.615 3.013,0.724 4.98,0.292c-4.701,7.079 -8.676,1.79 -11.106,2.161c0.766,-1.183 -0.332,-5.791 2.775,-4.94c-2.402,-0.091 -0.433,2.974 -1.491,4.033Z' />\n    <path d='M10.309,21.121c0.439,-1.274 -0.852,-3.525 1.081,-4.967c1.247,-0.929 2.133,-2.246 2.743,-4.167c3.781,7.611 -2.788,8.409 -3.681,10.699c-0.641,-1.255 -5.181,-2.607 -2.891,-4.873c-1.28,2.034 2.359,1.863 2.748,3.308Z' />\n    <path d='M19.066,18.01c-0.883,-1.017 -3.479,-1.024 -3.76,-3.42c-0.182,-1.544 -0.88,-2.971 -2.238,-4.459c8.482,0.532 5.889,6.619 7.425,8.538c-1.407,-0.072 -4.849,3.183 -5.665,0.067c1.121,2.125 2.792,-1.112 4.238,-0.726Z' />\n    <path d='M20.751,8.871c-1.323,0.256 -2.627,2.501 -4.842,1.546c-1.429,-0.615 -3.013,-0.723 -4.98,-0.291c4.701,-7.08 8.676,-1.791 11.106,-2.162c-0.767,1.183 0.332,5.791 -2.775,4.94c2.401,0.092 0.433,-2.974 1.491,-4.033Z' />\n\n  </React.Fragment>, 'AppLogo')\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport { makeStyles } from '@material-ui/core/styles'\n// import style from './auth.style'\nimport useAuthCommon from './useAuthCommon'\nimport AppLogo from '../../icons/AppLogo'\n\nimport { ThemeProvider } from '@material-ui/styles'\nimport themes from '../../themes'\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    height: '100%'\n  },\n  bgSwoosh: {\n    width: '100%',\n    height: '100%',\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    zIndex: 0\n  },\n  spacer: {\n    flex: '1 1 5%'\n  },\n  logo: {\n    flex: '1 1 40%',\n    width: '100%',\n    minHeight: 90\n  },\n  inner: {\n    margin: '0 auto',\n    width: '100%',\n    height: '100%',\n    minWidth: 200,\n    maxWidth: 300,\n    display: 'flex',\n    flexDirection: 'column',\n    textAlign: 'center'\n  }\n}))\n\nconst AuthContainer = ({ children }) => {\n  const containerRef = useAuthCommon()\n  const classes = useStyles()\n  return (\n    <ThemeProvider theme={themes.login}>\n      <div ref={containerRef} className={classes.root}>\n        <CssBaseline />\n        {/* Look for: LoginSwoosh.svg */}\n        {/* <svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 500 500' preserveAspectRatio='none' className={classes.bgSwoosh}>\n        <path className={classes.bgSwooshFill} d=' M 0 0 L 500 0 C 500 209.782 489.956 180 250 180 C 10.044 180 0 219.954 0 370 L 0 0 Z ' />\n      </svg> */}\n\n        <div className={classes.inner}>\n          {/* Look for: Logo.svg */}\n          <AppLogo className={classes.logo} />\n\n          <Typography variant='h5'>MorPhoto</Typography>\n          {children}\n          <div className={classes.spacer} />\n        </div>\n      </div>\n    </ThemeProvider>\n  )\n}\n\nAuthContainer.propTypes = {\n  children: PropTypes.any\n}\n\nexport default AuthContainer\n","import React from 'react'\nimport PropTypes from 'prop-types'\n// import MenuIcon from '@material-ui/core/Menu'\n// import { makeStyles } from '@material-ui/core/styles'\n// import style from './auth.style'\nimport AuthContainer from './AuthContainer'\nimport { Typography } from '@material-ui/core'\n\n// const useStyles = makeStyles(style)\n\nconst Loading = ({ message }) => {\n  // const classes = useStyles()\n  return (\n    <AuthContainer>\n      <Typography variant='h3'>Loading...</Typography>\n      {message && <Typography variant='overline'>{message}</Typography>}\n    </AuthContainer>\n  )\n}\n\nLoading.propTypes = {\n  message: PropTypes.string\n}\n\nexport default Loading\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\n/**\n * Note: this was one of the few components we didn't use hooks for\n * mostly because I couldn't find an easy way to do getDerivedStateFromError()\n *\n * We might revise this later\n */\nclass ErrorBoundary extends React.Component {\n  constructor (props) {\n    console.log('ErrorBoundary constructor')\n    super(props)\n    this.state = { hasError: false }\n  }\n\n  static getDerivedStateFromError (error) {\n    // Update state so the next render will show the fallback UI.\n    console.log('ErrorBoundary getDerivedStateFromError')\n    console.error(error)\n    return { hasError: true, error }\n  }\n\n  componentDidCatch (error, info) {\n    console.log('ErrorBoundary componentDidCatch')\n    console.error(error)\n    // You can also log the error to an error reporting service\n    // logErrorToMyService(error, info)\n  }\n\n  render () {\n    const { hasError, error } = this.state\n    const { fallback: FallbackUI } = this.props\n    if (hasError) {\n      console.log('ErrorBoundary hasError')\n      // You can render any custom fallback UI\n      return <FallbackUI error={error} />\n    }\n\n    return this.props.children\n  }\n}\nErrorBoundary.propTypes = {\n  children: PropTypes.any,\n  fallback: PropTypes.any\n}\n\nexport default ErrorBoundary\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport Button from '@material-ui/core/Button'\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport DialogContentText from '@material-ui/core/DialogContentText'\nimport TextField from '@material-ui/core/TextField'\nimport DialogActions from '@material-ui/core/DialogActions'\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport BugReportIcon from '@material-ui/icons/BugReport'\nimport ErrorIcon from '@material-ui/icons/Error'\nimport { makeStyles } from '@material-ui/core/styles'\n\nexport const SEND_STATES = {\n  UNSENT: 'UNSENT',\n  SENDING: 'SENDING',\n  SENT: 'SENT',\n  ERROR: 'ERROR'\n}\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    height: '100%',\n    overflow: 'hidden',\n    padding: theme.spacing(1),\n    display: 'flex',\n    flexDirection: 'column',\n    textAlign: 'center',\n    color: theme.palette.text.primary,\n    border: `20px solid ${theme.palette.text.secondary}`\n  },\n  button: {\n    // background: theme.palette.success.main,\n    // color: theme.palette.success.contrastText\n  },\n  icon: {\n    opacity: 0.5,\n    margin: 'auto',\n    flex: '0 1 10%',\n    // height: '50%',\n    width: '50%'\n  },\n  text: {\n  },\n  spacer: {\n    flexGrow: 1\n  },\n  stack: {\n    padding: theme.spacing(2),\n    marginBottom: theme.spacing(2),\n    fontSize: '8px',\n    flexGrow: 1,\n    textAlign: 'left',\n    whiteSpace: 'pre-wrap',\n    overflow: 'scroll',\n    color: theme.palette.error.main,\n    fontFamily: 'Consolas, monaco, monospace'\n  }\n}))\n\nconst ErrorScreen = ({ error, sendState, reportError }) => {\n  const classes = useStyles()\n  const [dlgOpen, setDialogOpen] = useState(false)\n  const [note, setNote] = useState('')\n\n  let stackEl = <div className={classes.spacer} />\n  try {\n    if (process.env.NODE_ENV === 'development') {\n      stackEl = (\n        <Typography className={classes.stack}>\n          {error.stack}\n        </Typography>\n      )\n    }\n  }\n  catch (e) {}\n\n  let buttonText = 'Report this bug'\n  let disabled = false\n  let color = 'primary'\n  switch (sendState) {\n    case SEND_STATES.UNSENT:\n      buttonText = 'Report this bug'\n      break\n    case SEND_STATES.SENDING:\n      disabled = true\n      color = 'default'\n      buttonText = 'Sending...'\n      break\n    case SEND_STATES.SENT:\n      color = 'default'\n      disabled = true\n      buttonText = 'Thank you for your feedback'\n      break\n    case SEND_STATES.ERROR:\n      color = 'secondary'\n      disabled = true\n      buttonText = 'ERROR SENDING BUG REPORT'\n      break\n    default:\n      break\n  }\n\n  return (\n    <div className={classes.root}>\n      <CssBaseline />\n      <ErrorIcon className={classes.icon} color='error' />\n      <Typography variant='subtitle1' className={classes.text} color='inherit'>\n        Something went wrong\n      </Typography>\n      {error && error.message && <Typography variant='body1' className={classes.text} color='inherit'>\n        {error.message}\n      </Typography>}\n      <Button\n        className={classes.button}\n        variant='contained'\n        disabled={disabled}\n        color={color}\n        onClick={() => setDialogOpen(true)}\n      >\n        <BugReportIcon />\n        {buttonText}\n      </Button>\n      {stackEl}\n      <Dialog open={dlgOpen} onClose={() => setDialogOpen(false)} aria-labelledby='form-dialog-title'>\n        <DialogTitle id='form-dialog-title'>Report a bug</DialogTitle>\n        <DialogContent>\n          <DialogContentText>\n            What were you trying to do when the error happened?\n          </DialogContentText>\n          <TextField\n            autoFocus\n            margin='dense'\n            multiline\n            onChange={(e) => setNote(e.target.value)}\n            rowsMax='6'\n            id='note'\n            placeholder='I tried to X and then Y happened...'\n            label='Note'\n            fullWidth\n          />\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={() => setDialogOpen(false)} color='primary'>\n            Cancel\n          </Button>\n          <Button onClick={() => {\n            reportError(note)\n            setDialogOpen(false)\n          }} color='primary'>\n            Send\n          </Button>\n        </DialogActions>\n      </Dialog>\n    </div>\n  )\n}\n\nErrorScreen.propTypes = {\n  error: PropTypes.object,\n  sendState: PropTypes.string,\n  reportError: PropTypes.func.isRequired\n}\n\nexport default ErrorScreen\n","import gql from 'graphql-tag'\nimport { photoFragment, seriesFragment } from './fragments'\n\nexport const deletePhoto = gql`\nmutation deletePhoto($seriesId: ID!, $photoId: ID!) {\n  deletePhoto(seriesId: $seriesId, photoId: $photoId)\n}\n`\n\nexport const deleteSeries = gql`\nmutation deleteSeries($id: ID!) {\n  deleteSeries(id: $id)\n}\n`\n\nexport const updateSeries = gql`\nmutation updateSeries($series: UpdateSeriesInput!) {\n  updateSeries(series: $series){\n    ...seriesFragment\n  }\n}\n`\n\nexport const updatePhoto = gql`\nmutation updatePhoto($photo: UpdatePhotoInput!) {\n  updatePhoto(photo: $photo){\n    ...photoFragment\n    uploadToken\n  }\n}\n`\n\nexport const createPhoto = gql`\nmutation createPhoto($photo: NewPhotoInput!, $ext: String!) {\n  createPhoto(photo: $photo, ext: $ext) {\n    photo {\n      ...photoFragment\n      uploadToken\n    }\n    preAuth\n  }\n}\n${photoFragment}\n`\n\nexport const createSeries = gql`\nmutation createSeries($series: NewSeriesInput!) {\n  createSeries(series: $series) {\n    ...seriesFragment\n    photos {\n      ...photoFragment\n    }\n  }\n}\n${seriesFragment}\n${photoFragment}\n`\n\nexport const watchSeries = gql`\nmutation watch($seriesId: ID) {\n  watchSeries(seriesId: $seriesId)\n}\n`\n\nexport const unWatchSeries = gql`\nmutation unWatch($seriesId: ID) {\n  unWatchSeries(seriesId: $seriesId)\n}\n`\n\nexport const reportBug = gql`\nmutation reportBug($reportJSON: String!) {\n  reportBug(reportJSON: $reportJSON)\n}\n`\n","import React, { useState } from 'react'\n// import PropTypes from 'prop-types'\nimport { graphql } from 'react-apollo'\nimport { connect } from 'react-redux'\nimport ErrorScreen, { SEND_STATES } from '../components/misc/ErrorScreen'\nimport { reportBug } from './mutations'\n\nconst ErrorConnect = (props) => {\n  const [state, setState] = useState(SEND_STATES.UNSENT)\n  const Wrapped = withReportBugMutation(ErrorScreen)\n  return <Wrapped {...props} setState={setState} sendState={state} />\n}\n\nconst withReportBugMutation = graphql(reportBug, {\n  props: ({ mutate, ownProps: { reduxState, error, setState } }) => {\n    console.log('withReportBugMutation props', { mutate, reduxState, error })\n    if (mutate.error) setState(SEND_STATES.ERROR)\n    return {\n      reportError: (note) => {\n        setState(SEND_STATES.SENDING)\n        let reportJSON = ''\n        const errObj = { note, reduxState, error, env: process.env }\n        console.log('withReportBugMutation StartingError', errObj)\n        try {\n          reportJSON = JSON.stringify(errObj)\n        }\n        catch (e) {\n          reportJSON = error.toString()\n        }\n        console.log('withReportBugMutation got through it', reportJSON)\n        return mutate({\n          variables: { reportJSON },\n          update: (store, { data }) => {\n            console.log('withReportBugMutation update', data)\n            setState(SEND_STATES.SENT)\n          }\n        })\n      }\n    }\n  }\n})\n\n/**\n * Map our redux state and functions\n */\nconst mapStateToProps = (state, props) => {\n  const { map, home, uploader, ...other } = state\n  const newMap = map.slice(-5) // only the last 5 map states come through\n\n  return {\n    reduxState: {\n      ...other,\n      map: newMap,\n      home\n    }\n  }\n}\n\nexport default connect(\n  mapStateToProps\n)(ErrorConnect)\n","import { useState, useEffect } from 'react'\nimport { createHttpLink } from 'apollo-link-http'\nimport { setContext } from 'apollo-link-context'\nimport Amplify, { Auth } from 'aws-amplify'\n// import PropTypes from 'prop-types'\nimport { endpoints, aws } from '../config'\nimport { ApolloLink } from 'apollo-link'\nimport { InMemoryCache, ApolloClient } from 'apollo-boost'\nimport { persistCache } from 'apollo-cache-persist'\n\nAmplify.configure(aws)\n\nconst LOCAL_STORAGE_TOKEN = 'apollo-token'\n\nfunction useGraphQL () {\n  const [client, setClient] = useState(null)\n  const [loaded, setLoaded] = useState(false)\n\n  useEffect(() => {\n    createApolloClient((client, loaded) => {\n      setClient(client)\n      setLoaded(loaded)\n    })\n  }, [])\n\n  return { client, loaded }\n}\n\nexport default useGraphQL\n\n/**\n * Helper function to create our Apollo Client object\n * @param {*} tokenFunc\n */\nconst getCurrentToken = async () => {\n  try {\n    const currSession = await Auth.currentSession()\n    return currSession.accessToken.jwtToken\n  }\n  catch (e) {\n    return null\n  }\n}\n\nasync function createApolloClient (onDone) {\n  // Set up our headers for authentication through graphql\n  const cache = new InMemoryCache({\n    // dataIdFromObject: ({ __typename, id }) => __typename && id ? `${__typename}::${id}`\n  })\n\n  try {\n    // See above for additional options, including other storage providers.\n    await persistCache({\n      cache,\n      storage: window.localStorage\n    })\n  }\n  catch (error) {\n    console.error('Error restoring Apollo cache', error)\n    onDone(null, false)\n    return\n  }\n\n  // The auth link is just used to decorate our HTTP headers with authentication data\n  const authLink = setContext(async (_, { headers }) => {\n    const token = await getCurrentToken()\n\n    const newHeaders = {\n      ...headers,\n      authorization: token ? `Bearer ${token}` : ''\n    }\n    // on Dev machines, allow us to fake a user. This will ONLY work with a complimentary\n    // Dev graphql endpoint and singin is still required.\n\n    // This was done so we can test what the App looks like from varying perspectives\n    if (token && process.env.NODE_ENV === 'development' && process.env.REACT_APP_FAKE_USER) {\n      newHeaders.auth_user = process.env.REACT_APP_FAKE_USER\n    }\n    return { headers: newHeaders }\n  })\n\n  // HTTP link creates the network connection to our graphql host\n  const httpLink = createHttpLink({ uri: endpoints.graphql })\n  console.log('Creating Apollo Client Client', endpoints.graphql)\n\n  const apolloClient = new ApolloClient({\n    link: ApolloLink.from([authLink, httpLink]),\n    tokenName: LOCAL_STORAGE_TOKEN,\n    cache,\n    connectToDevTools: process.env.NODE_ENV === 'development'\n  })\n\n  // Now put it all together\n  onDone(apolloClient, true)\n}\n\n// Note: this method comes from isntructions here:\n// https://www.apollographql.com/docs/react/recipes/authentication.html\n// export const withApollo = compose(\n//   lifecycle({\n//     shouldComponentUpdate (nextProps) {\n//       const { authStore: { jwtToken: oldToken } } = nextProps\n//       const { authStore: { jwtToken: newToken } } = this.props\n//       if (newToken === oldToken) {\n//         return true\n//       }\n//       return true\n//     }\n//   }),\n//   withWrapClient\n// )\n","export default theme => ({\n  root: {\n  },\n  spacer: {\n    flexGrow: 1\n  },\n  forgotPassword: {\n    width: '100%',\n    textAlign: 'right'\n  },\n  switch: {\n\n  },\n  switchButton: {\n    flexGrow: 1,\n    '&:last-child': {\n      borderRadius: 0\n    },\n    '&:first-child': {\n      borderRadius: 0\n    }\n  },\n  phoneNumInner: {\n    marginTop: theme.spacing(1),\n    display: 'flex'\n    // border: '1px solid red'\n  },\n  phoneNumDropdown: {\n    margin: theme.spacing(1),\n    minWidth: 120\n  },\n  warnText: {\n    marginTop: theme.spacing(2),\n    fontStyle: 'italic'\n  },\n  noSignin: {\n    margin: theme.spacing(2, 0),\n    padding: theme.spacing(1),\n    textAlign: 'left',\n    border: `1px solid #00000022`,\n    background: `#0000000F`\n  }\n})\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport TextField from '@material-ui/core/TextField'\nimport Button from '@material-ui/core/Button'\nimport Toolbar from '@material-ui/core/Toolbar'\n// import MenuIcon from '@material-ui/core/Menu'\n// import { FederatedButtons } from 'aws-amplify-react'\nimport { makeStyles } from '@material-ui/core/styles'\nimport style from './auth.style'\nimport AuthContainer from './AuthContainer'\nimport { Typography } from '@material-ui/core'\n\nconst useStyles = makeStyles(style)\n\nconst SignIn = ({ loading,\n  handleSignup,\n  federated,\n  handleForgotPassword,\n  handleInputChange,\n  handleBeAnonymous,\n  handleSignIn, ...props }) => {\n  const classes = useStyles()\n  return (\n    <AuthContainer>\n      {/* {props.federated && (\n        <FederatedButtons {...props} />\n      )} */}\n      <TextField\n        id='username'\n        fullWidth\n        key='username'\n        name='username'\n        label='Username'\n        color='inherit'\n        autoFocus\n        className={classes.textField}\n        margin='normal'\n        onChange={handleInputChange}\n      />\n      <TextField\n        fullWidth\n        id='password'\n        label='Password'\n        color='inherit'\n        key='password'\n        name='password'\n        type='password'\n        className={classes.textField}\n        autoComplete='current-password'\n        margin='normal'\n        onChange={handleInputChange}\n      />\n      <Toolbar disableGutters>\n\n        <Button component='button' color='secondary' variant='contained' disabled={loading} onClick={handleSignup}>\n          New Account\n        </Button>\n        <div className={classes.spacer} />\n        <Button\n          className='enterAction'\n          component='button'\n          color='primary'\n          variant='contained'\n          disabled={loading}\n          onClick={handleSignIn}\n        >\n          Sign In\n        </Button>\n      </Toolbar>\n      <Button color='primary' onClick={handleForgotPassword} size='small'>\n      Forgot Password\n      </Button>\n      <div className={classes.noSignin}>\n        <Button fullWidth size='small' variant={'outlined'} onClick={handleBeAnonymous} color='inherit'>\n          Continue without logging in\n        </Button>\n        <Typography variant='caption' className={classes.warnText} color='textSecondary' component='div'>\n          You will not be able to add content and many features will be unavailable.\n        </Typography>\n      </div>\n    </AuthContainer>\n  )\n}\n\nSignIn.propTypes = {\n  loading: PropTypes.bool,\n  federated: PropTypes.object,\n  handleSignup: PropTypes.func.isRequired,\n  handleForgotPassword: PropTypes.func.isRequired,\n  handleInputChange: PropTypes.func.isRequired,\n  handleBeAnonymous: PropTypes.func.isRequired,\n  handleSignIn: PropTypes.func.isRequired\n}\n\nexport default SignIn\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport TextField from '@material-ui/core/TextField'\nimport Button from '@material-ui/core/Button'\nimport Toolbar from '@material-ui/core/Toolbar'\n// import MenuIcon from '@material-ui/core/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nimport style from './auth.style'\nimport AuthContainer from './AuthContainer'\n\nconst useStyles = makeStyles(style)\n\nconst ConfirmSignIn = ({ handleInputChange, handleBack, handleConfirm }) => {\n  const classes = useStyles()\n  return (\n    <AuthContainer>\n      <TextField\n        id='mfaCode'\n        fullWidth\n        autoFocus\n        label='MFA Code'\n        name='code'\n        className={classes.textField}\n        margin='normal'\n        onChange={handleInputChange}\n      />\n\n      <Toolbar disableGutters>\n        <Button color='secondary' variant='contained' onClick={handleBack}>\n          Back\n        </Button>\n        <div className={classes.spacer} />\n        <Button\n          className='enterAction'\n          color='primary'\n          variant='contained'\n          onClick={handleConfirm}\n        >\n          Confirm\n        </Button>\n      </Toolbar>\n    </AuthContainer>\n  )\n}\n\nConfirmSignIn.propTypes = {\n  handleInputChange: PropTypes.func.isRequired,\n  handleBack: PropTypes.func.isRequired,\n  handleConfirm: PropTypes.func.isRequired\n}\n\nexport default ConfirmSignIn\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport TextField from '@material-ui/core/TextField'\nimport Button from '@material-ui/core/Button'\nimport Typography from '@material-ui/core/Typography'\nimport Toolbar from '@material-ui/core/Toolbar'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport style from './auth.style'\nimport AuthContainer from './AuthContainer'\n\nconst useStyles = makeStyles(style)\n\nconst RequireNewPassword = ({ change, requiredAttributes, placeholders, handleInputChange }) => {\n  const classes = useStyles()\n  return (\n    <AuthContainer>\n      <Typography>A new password is required</Typography>\n      <TextField\n        id='newassword'\n        fullWidth\n        autoFocus\n        label='New Password'\n        className={classes.textField}\n        type='password'\n        autoComplete='new-password'\n        margin='normal'\n        onChange={handleInputChange}\n      />\n      {requiredAttributes\n        .map((attribute, idx) => (\n          <TextField\n            fullWidth\n            key={attribute}\n            name={attribute}\n            className={classes.textField}\n            placeholder={placeholders[idx]}\n            type='text'\n            margin='normal'\n            onChange={handleInputChange}\n          />\n        ))}\n\n      <Toolbar disableGutters>\n\n        <Button color='secondary' variant='contained'>\n          Back\n        </Button>\n        <div className={classes.spacer} />\n        <Button\n          color='primary'\n          variant='contained'\n          onClick={change}\n          className='enterAction'\n        >\n          Change\n        </Button>\n      </Toolbar>\n    </AuthContainer>\n  )\n}\n\nRequireNewPassword.propTypes = {\n  change: PropTypes.func.isRequired,\n  handleInputChange: PropTypes.func.isRequired,\n  requiredAttributes: PropTypes.array,\n  placeholders: PropTypes.array\n}\n\nexport default RequireNewPassword\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\nimport TextField from '@material-ui/core/TextField'\nimport Button from '@material-ui/core/Button'\nimport Toolbar from '@material-ui/core/Toolbar'\nimport FormControl from '@material-ui/core/FormControl'\nimport InputLabel from '@material-ui/core/InputLabel'\nimport Select from '@material-ui/core/Select'\nimport AuthContainer from './AuthContainer'\n\n// import MenuIcon from '@material-ui/core/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nimport style from './auth.style'\n// import AuthPhoneNum from './AuthPhoneNum'\nconst useStyles = makeStyles(style)\n\nconst SignUp = ({ handleInputChange, signUpFields, signUpFieldLabels, signUpFieldPlaceholders,\n  handleSignup, handleBack, countryDialCodes, defaultDialCode }) => {\n  console.log('SIGNUPPROPS', { defaultDialCode, countryDialCodes, signUpFields, signUpFieldLabels, signUpFieldPlaceholders })\n  const [selectVal, setSelectVal] = useState(defaultDialCode)\n  const classes = useStyles()\n  const handleDialCodeChange = e => {\n    handleInputChange(e)\n    setSelectVal(e.target.value)\n  }\n  return (\n    <AuthContainer>\n      {\n        signUpFields.map((field, idx) => {\n          return field.key !== 'phone_number' ? (\n            <TextField\n              fullWidth\n              autoFocus={signUpFields.findIndex(f => f.key === field.key) === 0}\n              type={field.type}\n              name={field.key}\n              key={field.key}\n              placeholder={signUpFieldPlaceholders[idx]}\n              label={signUpFieldLabels[idx]}\n              className={classes.textField}\n              margin='normal'\n              onChange={handleInputChange}\n            />\n          ) : (\n            <FormControl\n              className={classes.phoneNumDropdown}\n              fullWidth\n              key='phonenum'\n            >\n              <InputLabel htmlFor='dial_code' shrink>\n                {signUpFieldLabels[idx]}\n                {field.required ? '*' : ''}\n              </InputLabel>\n              <div className={classes.phoneNumInner}>\n                <Select\n                  value={selectVal}\n                  onChange={handleDialCodeChange}\n                  inputProps={{\n                    name: 'dial_code',\n                    id: 'dial_code'\n                  }}\n                >\n                  {countryDialCodes.map(dialCode =>\n                    <option key={dialCode} value={dialCode}>\n                      {dialCode}\n                    </option>\n                  )}\n                </Select>\n                <TextField\n                  placeholder={signUpFieldPlaceholders[idx]}\n                  type='tel'\n                  fullWidth\n                  id='phone_line_number'\n                  key='phone_line_number'\n                  name='phone_line_number'\n                  onChange={handleInputChange}\n                />\n              </div>\n            </FormControl>\n          )\n        })\n      }\n      <Toolbar disableGutters>\n        <Button color='secondary' variant='outlined' onClick={handleBack}>\n          Back\n        </Button>\n        <div className={classes.spacer} />\n        <Button\n          className='enterAction'\n          component='button'\n          color='primary'\n          variant='contained'\n          onClick={handleSignup}\n        >\n          Create Account\n        </Button>\n      </Toolbar>\n    </AuthContainer>\n  )\n}\n\nSignUp.propTypes = {\n  handleInputChange: PropTypes.func.isRequired,\n  signUpFields: PropTypes.array.isRequired,\n  signUpFieldLabels: PropTypes.array.isRequired,\n  signUpFieldPlaceholders: PropTypes.array.isRequired,\n  countryDialCodes: PropTypes.array.isRequired,\n  defaultDialCode: PropTypes.string.isRequired,\n  handleSignup: PropTypes.func.isRequired,\n  handleBack: PropTypes.func.isRequired\n}\n\nexport default SignUp\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport TextField from '@material-ui/core/TextField'\nimport Button from '@material-ui/core/Button'\nimport Link from '@material-ui/core/Link'\nimport Toolbar from '@material-ui/core/Toolbar'\n// import MenuIcon from '@material-ui/core/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nimport style from './auth.style'\nimport AuthContainer from './AuthContainer'\n\nconst useStyles = makeStyles(style)\n\nconst ConfirmSignUp = ({ handleInputChange, handleBack, handleResend, handleConfirm }) => {\n  const classes = useStyles()\n  return (\n    <AuthContainer>\n      <TextField\n        id='username'\n        fullWidth\n        autoFocus\n        name='username'\n        label='Username'\n        className={classes.textField}\n        margin='normal'\n        onChange={handleInputChange}\n      />\n      <TextField\n        id='confirmationCode'\n        fullWidth\n        name='code'\n        label='Confirmation Code'\n        className={classes.textField}\n        margin='normal'\n        onChange={handleInputChange}\n\n      />\n      <Link component='button' variant='body2' className={classes.resendCode} onClick={handleResend}>\n          Resend Code\n      </Link>\n      <Toolbar disableGutters>\n\n        <Button color='secondary' variant='outlined' onClick={handleBack}>\n          Back\n        </Button>\n        <div className={classes.spacer} />\n        <Button\n          color='primary'\n          variant='contained'\n          className='enterAction'\n          onClick={handleConfirm}\n        >\n          Sign In\n        </Button>\n      </Toolbar>\n    </AuthContainer>\n  )\n}\n\nConfirmSignUp.propTypes = {\n  handleInputChange: PropTypes.func.isRequired,\n  handleBack: PropTypes.func.isRequired,\n  handleResend: PropTypes.func.isRequired,\n  handleConfirm: PropTypes.func.isRequired\n}\n\nexport default ConfirmSignUp\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\nimport Link from '@material-ui/core/Link'\nimport TextField from '@material-ui/core/TextField'\nimport Typography from '@material-ui/core/Typography'\nimport Button from '@material-ui/core/Button'\n\nimport Toolbar from '@material-ui/core/Toolbar'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport style from './auth.style'\nimport AuthContainer from './AuthContainer'\n\nconst useStyles = makeStyles(style)\n\nconst ForgotPassword = ({ handleSubmit, handleInputChange, handleSendCode, handleBack }) => {\n  const [sent, setSent] = useState(false)\n  const classes = useStyles()\n  return (\n    <AuthContainer>\n      <Typography>Forgot Password</Typography>\n      {!sent && (\n        <TextField\n          id='username'\n          autoFocus\n          fullWidth\n          label='Username'\n          name='username'\n          className={classes.textField}\n          margin='normal'\n          onChange={handleInputChange}\n        />\n      )}\n      {sent && (\n        <TextField\n          id='changecode'\n          fullWidth\n          autoFocus\n          label='Code'\n          name='code'\n          className={classes.textField}\n          margin='normal'\n          onChange={handleInputChange}\n        />\n      )}\n      {sent && (\n        <TextField\n          id='newpassword'\n          fullWidth\n          label='New Password'\n          className={classes.textField}\n          type='password'\n          name='password'\n          autoComplete='current-password'\n          margin='normal'\n          onChange={handleInputChange}\n        />\n      )}\n      {sent && (\n        <Link component='button' variant='body2' className={classes.resendCode} onClick={handleSendCode}>\n          Resend Code\n        </Link>\n\n      )}\n      <Toolbar disableGutters>\n        <Button\n          color='secondary'\n          variant='outlined'\n          onClick={() => {\n            sent ? setSent(false) : handleBack()\n          }}\n        >\n          Back\n        </Button>\n        <div className={classes.spacer} />\n        {!sent && (\n          <Button\n            color='primary'\n            variant='contained'\n            className='enterAction'\n            onClick={() => {\n              setSent(true)\n              handleSendCode()\n            }}\n          >\n          Send Code\n          </Button>\n        )}\n        {sent && (\n          <Button\n            className='enterAction'\n            color='primary'\n            variant='contained'\n            onClick={handleSubmit}\n          >\n          Submit\n          </Button>\n        )}\n      </Toolbar>\n    </AuthContainer>\n  )\n}\n\nForgotPassword.propTypes = {\n  handleSubmit: PropTypes.func.isRequired,\n  handleInputChange: PropTypes.func.isRequired,\n  handleSendCode: PropTypes.func.isRequired,\n  handleBack: PropTypes.func.isRequired\n}\n\nexport default ForgotPassword\n","import React, { useState } from 'react'\nimport Amplify, { Auth } from 'aws-amplify'\nimport { I18n } from '@aws-amplify/core' // ConsoleLogger as Logger\nimport countryDialCodes from 'aws-amplify-react/dist/Auth/common/country-dial-codes'\nimport {\n  Authenticator,\n  SignIn as SignInOrig,\n  SignUp as SignUpOrig,\n  ConfirmSignIn as ConfirmSignInOrig,\n  ConfirmSignUp as ConfirmSignUpOrig,\n  RequireNewPassword as RequireNewPasswordOrig,\n  Loading as LoadingOrig,\n  VerifyContact as VerifyContactOrig,\n  ForgotPassword as ForgotPasswordOrig\n} from 'aws-amplify-react'\n\nimport CompSignIn from '../components/auth/SignIn'\nimport CompConfirmSignIn from '../components/auth/ConfirmSignIn'\nimport CompRequireNewPassword from '../components/auth/RequireNewPassword'\nimport CompSignUp from '../components/auth/SignUp'\nimport CompLoading from '../components/auth/Loading'\nimport CompConfirmSignUp from '../components/auth/ConfirmSignUp'\n// import CompVerifyContact from '../components/auth/VerifyContact'\nimport CompForgotPassword from '../components/auth/ForgotPassword' // or 'aws-amplify-react-native';\nimport { aws } from '../config'\n\nAmplify.configure(aws)\n\nconst defaultAuthState = { authState: 'init', authData: {}, signedIn: null }\n\nconst useAuthentication = () => {\n  const [{ authState, authData, signedIn }, setAuth] = useState(defaultAuthState)\n\n  // Set up the trinary\n  // if (authState === 'signedIn') signedIn = true\n\n  const handleAuthStateChange = (state, data) => {\n    // console.log('handleAuthStateChange', { state, data })\n    setAuth({\n      authState: state,\n      authData: data,\n      // true = signedIn, false = beAnonymous, null = showLoginScreen\n      signedIn: !state || state.length === 0\n        ? null\n        : state === 'signedIn'\n          ? true\n          : signedIn\n    })\n  }\n\n  const getCurrentToken = async () => {\n    const currSession = await Auth.currentSession()\n    console.log('here', currSession.accessToken)\n    return currSession && currSession.accessToken ? currSession.accessToken : null\n  }\n\n  const signOut = () => Auth.signOut()\n    .then(data => console.log(data))\n    .catch(err => console.log(err))\n\n  const beAnonymous = () => {\n    setAuth({ authState, authData, signedIn: false })\n  }\n\n  const authScreen = signedIn ? null\n    : <Authenticator onStateChange={handleAuthStateChange} hideDefault>\n      <SignIn handleBeAnonymous={beAnonymous} />\n      <Loading message='Loggin in' />\n      <RequireNewPassword />\n      {/* <RequireNewPasswordOrig /> */}\n      <ConfirmSignIn />\n      <ConfirmSignUp />\n      {/* <VerifyContact /> NOT READY */}\n      <VerifyContactOrig />\n      <ForgotPassword />\n      <SignUp />\n      {/* <SignUpOrig /> */}\n    </Authenticator>\n\n  let isGod = false\n  try {\n    isGod = authData.signInUserSession.idToken.payload['cognito:groups'].indexOf('GodUsers') > -1\n  }\n  catch (e) {}\n\n  return {\n    authState,\n    authData,\n    isGod,\n    signOut,\n    getCurrentToken,\n    forceSignIn: () => setAuth(defaultAuthState),\n    signedIn,\n    authScreen\n  }\n}\n\nexport default useAuthentication\n\nclass SignIn extends SignInOrig {\n  showComponent () {\n    const { loading } = this.state\n    const newProps = {\n      ...this.props,\n      loading,\n      handleForgotPassword: () => this.changeState('forgotPassword'),\n      handleSignup: () => this.changeState('signUp'),\n      handleInputChange: this.handleInputChange,\n      handleSignIn: this.signIn\n    }\n    return <CompSignIn {...newProps} />\n  }\n}\n\nclass SignUp extends SignUpOrig {\n  showComponent () {\n    const { hide } = this.props\n    if (hide && hide.includes(SignUp)) {\n      return null\n    }\n    if (this.checkCustomSignUpFields()) {\n      this.signUpFields = this.props.signUpConfig.signUpFields\n    }\n    this.sortFields()\n\n    const newProps = {\n      ...this.props,\n      countryDialCodes,\n      defaultDialCode: this.getDefaultDialCode(),\n      handleInputChange: this.handleInputChange,\n      signUpFields: this.signUpFields,\n      signUpFieldLabels: this.signUpFields.map(field => I18n.get(field.label)),\n      signUpFieldPlaceholders: this.signUpFields.map(field => I18n.get(field.placeholder)),\n      handleSignup: this.signUp,\n      handleBack: () => this.changeState('signIn')\n    }\n    return <CompSignUp {...newProps} />\n  }\n}\n\nclass ConfirmSignIn extends ConfirmSignInOrig {\n  showComponent () {\n    const newProps = {\n      ...this.props,\n      handleBack: () => this.changeState('signIn'),\n      handleInputChange: this.handleInputChange,\n      handleConfirm: this.confirm\n    }\n    return <CompConfirmSignIn {...newProps} />\n  }\n}\n\nclass ConfirmSignUp extends ConfirmSignUpOrig {\n  showComponent () {\n    const newProps = {\n      ...this.props,\n      handleBack: () => this.changeState('signIn'),\n      handleInputChange: this.handleInputChange,\n      handleConfirm: this.confirm,\n      handleResend: this.resend\n    }\n    return <CompConfirmSignUp {...newProps} />\n  }\n}\n\nclass RequireNewPassword extends RequireNewPasswordOrig {\n  showComponent () {\n    const user = this.props.authData\n    const { requiredAttributes } = user.challengeParam\n    const placeholders = Array.isArray(requiredAttributes)\n      ? requiredAttributes.map(attribute => I18n.get(convertToPlaceholder(attribute)))\n      : []\n\n    const newProps = {\n      ...this.props,\n      handleInputChange: this.handleInputChange,\n      requiredAttributes,\n      placeholders,\n      change: this.change\n    }\n    return <CompRequireNewPassword {...newProps} />\n  }\n}\n\nclass Loading extends LoadingOrig {\n  showComponent () {\n    return <CompLoading {...this.props} />\n  }\n}\n// class VerifyContact extends VerifyContactOrig {\n//   showComponent () {\n//     const user = this.props.authData\n//     if (!user) {\n//       verifyLogger.debug('no user for verify')\n//       return null\n//     }\n//     const { unverified } = user\n//     if (!unverified) {\n//       verifyLogger.debug('no unverified on user')\n//       return null\n//     }\n//     const { email, phoneNumber } = unverified\n\n//     const { authData } = this.props\n//     const newProps = {\n//       ...this.props,\n//       handleInputChange: this.handleInputChange,\n//       handleSkip: () => this.changeState('signedIn', authData),\n//       handleVerify: this.verify,\n//       handleSubmit: this.submit\n//     }\n//     return <CompVerifyContact {...newProps} />\n//   }\n// }\nclass ForgotPassword extends ForgotPasswordOrig {\n  showComponent () {\n    const newProps = {\n      ...this.props,\n      handleBack: () => this.changeState('signIn'),\n      handleInputChange: this.handleInputChange,\n      handleConfirm: this.confirm,\n      handleResend: this.send,\n      handleSubmit: this.submit,\n      handleSendCode: this.send\n    }\n    return <CompForgotPassword {...newProps} />\n  }\n}\n\n// const verifyLogger = new Logger('VerifyContact')\n\nfunction convertToPlaceholder (str) {\n  return str.split('_').map(part => part.charAt(0).toUpperCase() + part.substr(1).toLowerCase()).join(' ')\n}\n\n// const eqSpacer = '==============================================================='\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Snackbar from '@material-ui/core/Snackbar'\nimport Typography from '@material-ui/core/Typography'\nimport Paper from '@material-ui/core/Paper'\nimport AppLogo from '../../icons/AppLogo'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { Button } from '@material-ui/core'\nconst useStyles = makeStyles(theme => ({\n  root: {\n\n  },\n  content: {\n\n  },\n  messageWrapper: {\n    display: 'flex'\n  },\n  logo: {\n    height: 50,\n    width: 50\n  },\n  paper: {\n    background: theme.palette.text.primary,\n    color: theme.palette.primary.contrastText,\n    border: `2px solid ${theme.palette.primary.contrastText}`,\n    boxShadow: `0 0 0 0 ${theme.palette.primary.main}`,\n    animation: '$installPulse 2s infinite',\n    padding: theme.spacing(2, 3),\n    width: '100%'\n  },\n  '@keyframes installPulse': {\n    '0%': {\n      boxShadow: `0 0 0 0px ${theme.palette.primary.main}`\n    },\n    '50%': {\n      boxShadow: `0 0 0 0px ${theme.palette.primary.main}`\n    },\n    '100%': {\n      boxShadow: `0 0 0 20px transparent`\n    }\n  },\n  textWrapper: {\n    flexGrow: 1,\n    paddingLeft: theme.spacing(1)\n  },\n  buttons: {\n    display: 'flex'\n  },\n  spacer: {\n    flexGrow: 1\n  }\n}))\n\nconst InstallPrompt = ({ open, onClose, onInstall }) => {\n  const classes = useStyles()\n\n  return (\n    <Snackbar\n      anchorOrigin={{\n        vertical: 'bottom',\n        horizontal: 'center'\n      }}\n      open={open}\n      // autoHideDuration={6000}\n      onClose={onClose}\n    >\n      <Paper className={classes.paper} elevation={24}>\n        <div id='client-snackbar' className={classes.messageWrapper}>\n          <AppLogo className={classes.logo} />\n          <div className={classes.textWrapper}>\n            <Typography variant='body1' color='inherit'>Install MorPhoto</Typography>\n            <Typography variant='body2' color='inherit' paragraph>This app can be installed and used on your device natively and offline if you would like.</Typography>\n            <div className={classes.buttons}>\n              <Button color='secondary' variant='contained' onClick={onClose}>No thanks</Button>\n              <div className={classes.spacer} />\n              <Button color='primary' variant='contained' onClick={onInstall}>Install</Button>\n            </div>\n          </div>\n        </div>\n      </Paper>\n    </Snackbar>\n  )\n}\n\nInstallPrompt.propTypes = {\n  open: PropTypes.bool,\n  onClose: PropTypes.func.isRequired,\n  onInstall: PropTypes.func.isRequired\n}\n\nexport default InstallPrompt\n","import React, { useEffect, useState, useMemo } from 'react'\nimport { isIos } from './sensors'\nimport InstallPrompt from '../components/misc/InstallPrompt'\n/**\n * Everything below here is about the prompt for installing a PWA\n */\n\n// Detects if device is in standalone mode\nconst isInStandaloneMode = () => ('standalone' in window.navigator) && (window.navigator.standalone)\n\nconst useShowAddToHome = (showInstall, dismissInstall) => {\n  const [deferredPrompt, setPrompt] = useState(null)\n\n  const handleBeforePrompt = e => {\n    // Prevent Chrome 67 and earlier from automatically showing the prompt\n    e.preventDefault()\n    // Stash the event so it can be triggered later.\n    setPrompt(e)\n    // showAddToHomeScreen()\n  }\n\n  const installPrompt = useMemo(() => {\n    if (!showInstall || !deferredPrompt) return null\n    return <InstallPrompt open onClose={dismissInstall} onInstall={addToHomeScreen} />\n  }, [showInstall, deferredPrompt])\n\n  useEffect(() => {\n    // window.orientation [0,90,180, 270]\n    // screen\n    // Checks if should display install popup notification:\n    if (isIos() && !isInStandaloneMode()) {\n      console.log('I AM on IOS and I am NOT in standalone mode.')\n    // this.setState({ showInstallMessage: true })\n    }\n\n    window.addEventListener('beforeinstallprompt', handleBeforePrompt)\n    return () => {\n      window.removeEventListener('beforeinstallprompt', handleBeforePrompt)\n    }\n  }, [])\n\n  function addToHomeScreen () {\n    // Show the prompt\n    deferredPrompt.prompt()\n    // Wait for the user to respond to the prompt\n    deferredPrompt.userChoice\n      .then((choiceResult) => {\n        if (choiceResult.outcome === 'accepted') {\n          console.log('User accepted the A2HS prompt')\n          dismissInstall()\n        }\n        else {\n          console.log('User dismissed the A2HS prompt')\n          dismissInstall()\n        }\n        setPrompt(null)\n      })\n  }\n\n  // function showAddToHomeScreen () {\n  //   const a2hsBtn = document.querySelector('.ad2hs-prompt')\n  //   a2hsBtn.style.display = 'block'\n  //   a2hsBtn.addEventListener('click', addToHomeScreen)\n  // }\n\n  return {\n    installPrompt,\n    addToHomeScreen: installPrompt ? addToHomeScreen : null\n  }\n}\n\nexport default useShowAddToHome\n","import { useEffect, useState } from 'react'\n\nconst useOnline = () => {\n  const [state, setState] = useState(null)\n\n  const setOnline = () => {\n    console.log('ONLINE')\n    setState(null)\n  }\n  const setOffline = () => {\n    console.log('OFFLINE')\n    const newDate = Date.now()\n    setState(newDate)\n  }\n\n  useEffect(() => {\n    window.addEventListener('online', setOnline)\n    window.addEventListener('offline', setOffline)\n\n    return () => {\n      window.removeEventListener('online', setOnline)\n      window.removeEventListener('offline', setOffline)\n    }\n  }, [])\n\n  return {\n    online: state === null,\n    offlineSince: state\n  }\n}\n\nexport default useOnline\n","import { useCallback, useState, useLayoutEffect } from 'react'\nimport { debounce } from './util'\nimport { isIos, isPhone } from './sensors'\n\nconst metaViewports = {\n  sm: 'width=device-width, initial-scale=0.5, maximum-scale=0.5, user-scalable=0, shrink-to-fit=no',\n  lg: 'width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no'\n}\n\nconst getState = (state) => {\n  const { orientation, innerWidth, innerHeight, screen: { width, height } } = window\n  const wOrient = [90, 270].indexOf(orientation) !== 0 ? 'portrait' : 'landscape'\n  const bIsIos = isIos()\n  const bIsPhone = isPhone()\n  const windowSize = { width: innerWidth, height: innerHeight }\n  const screenSize = { width, height }\n\n  // VirtualKeyboards are the worst because they don't tell you when they're open.\n  // as a result we put the lockheight attribute on inputs so that the window height doesn't change\n  if (state && window.document.activeElement.tagName.toLowerCase() === 'input') {\n    console.log('preserving height')\n    windowSize.height = state.windowSize.height\n  }\n  else {\n    const minSize = Math.min(windowSize.width, windowSize.height)\n    const viewport = window.document.querySelector('meta[name=viewport]')\n    const contentDict = viewport.getAttribute('content').split(', ').reduce((acc, el) => {\n      const elsplit = el.split('=')\n      return { ...acc, [elsplit[0]]: elsplit[1] }\n    }, {})\n    if (minSize < 350 && contentDict['initial-scale'] === '1.0') {\n      console.log('ZOOM Making it Small')\n      viewport.setAttribute('content', metaViewports.sm)\n    }\n    else if (minSize >= 350 && contentDict['initial-scale'] === '0.5') {\n      console.log('ZOOM Making it Large')\n      viewport.setAttribute('content', metaViewports.lg)\n    }\n  }\n\n  const returnState = {\n    isPhone: bIsPhone,\n    isIos: bIsIos,\n    orientation: wOrient,\n    windowSize,\n    screenSize\n    // This failed. the only way to handle this is to set it explicitly\n    // isVKeyBdOn: bIsPhone && windowSize.height < screenSize.height\n  }\n  return returnState\n}\n\nconst useResponsive = (mediaQueries) => {\n  const [state, setState] = useState(getState())\n\n  const handleResize = (e) => {\n    if (e) {\n      e.preventDefault()\n      e.stopPropagation()\n    }\n    const newState = getState(state)\n    console.log('handleResize', newState)\n    setState(newState)\n  }\n\n  // const handleFlip = (e) => {\n  //   e.preventDefault()\n  //   e.stopPropagation()\n  //   const newState = getState()\n  //   console.log('handleFlip', newState)\n  //   setState(newState)\n  // }\n\n  const handleResizeDebounced = useCallback(debounce(handleResize, 500), [])\n  // const handleFlipDebounced = useCallback(debounce(handleFlip, 500), [])\n\n  useLayoutEffect(() => {\n    handleResizeDebounced()\n    window.addEventListener('resize', handleResizeDebounced)\n    // window.addEventListener('orientationchange', handleFlipDebounced)\n\n    return () => {\n      window.removeEventListener('resize', handleResizeDebounced)\n      // window.removeEventListener('orientationchange', handleFlipDebounced)\n    }\n  },\n  [])\n\n  return state\n}\n\nexport default useResponsive\n","/**\n * We put our action types at the top to keep them straight\n *\n * This is just a handy enumeration we use everywhere to make sure we're\n * all talking about the same ations\n */\nexport const Actions = {\n\n  HOME_CHANGE_STATE: 'HOME_CHANGE_STATE',\n  HOME_CHANGE_ACTIVE_SERIES: 'HOME_CHANGE_ACTIVE_SERIES',\n  HOME_STATE_BACK: 'HOME_STATE_BACK',\n\n  MAP_HISTORY_POP: 'MAP_HISTORY_POP',\n  MAP_HISTORY_PUSH: 'MAP_HISTORY_PUSH',\n  MAP_HISTORY_CLEAR: 'MAP_HISTORY_CLEAR',\n\n  UPLOADER_START: 'UPLOADER_START',\n  UPLOADER_COMPLETE: 'UPLOADER_COMPLETE',\n  UPLOADER_UPDATE_PROGRESS: 'UPLOADER_UPDATE_PROGRESS',\n\n  SETFLAG: 'SETFLAG'\n}\n\n/**\n * Now here are the actual action functions we will be dispatching\n * The actions have arguments related to what they do but they action they\n * dispatch consists only of a type and data3\n */\nexport default {\n  setHomeState: (newDomain, params) => ({ type: Actions.HOME_CHANGE_STATE, data: { newDomain, params } }),\n  homeStateBack: () => ({ type: Actions.HOME_STATE_BACK }),\n  setActiveSeries: (seriesId, initialPhoto) => ({ type: Actions.HOME_CHANGE_ACTIVE_SERIES, data: { seriesId, initialPhoto } }),\n\n  setFlag: (flagName, flagVal) => ({ type: Actions.SETFLAG, data: { flagName, flagVal } }),\n\n  popMapHistory: () => ({ type: Actions.MAP_HISTORY_POP }),\n  pushMapHistory: (viewportSave) => ({ type: Actions.MAP_HISTORY_PUSH, data: viewportSave }),\n  clearMapHistory: () => ({ type: Actions.MAP_HISTORY_CLEAR }),\n\n  queueUpload: (uploadObj) => ({ type: Actions.UPLOADER_START, data: uploadObj }),\n  // startActiveUpload: () => ({ type: Actions.UPLOADER_START }),\n  completeActiveUpload: () => ({ type: Actions.UPLOADER_COMPLETE }),\n  updateUploadProgress: (newProgress) => ({ type: Actions.UPLOADER_UPDATE_PROGRESS, data: newProgress })\n\n}\n","import { Actions } from '../actions'\nimport { home } from '../../config'\nconst mapInit = [\n  {\n    mode: home.MapModeTypes.FREE,\n    // selectedItem: null\n    viewport: {\n      // 'latitude': 49.2707848, // vancouver\n      // 'longitude': -123.0714866,\n      latitude: 36.80191008366581, // Grand Canyon\n      longitude: -111.63999999999784,\n      zoom: 11\n    }\n  }\n]\n\nexport default (state = mapInit, action) => {\n  const { type, data } = action\n\n  switch (type) {\n    case Actions.MAP_HISTORY_CLEAR:\n      const newClearerHistory = state.length > 0 ? [[state.length - 1]] : []\n      return newClearerHistory\n\n    case Actions.MAP_HISTORY_POP:\n      return state.slice(0, -1)\n\n    case Actions.MAP_HISTORY_PUSH:\n      return [...state, data]\n    default:\n      return state\n  }\n}\n","import { Actions } from '../actions'\nimport { home } from '../../config'\n\nconst homeInit = {\n  history: [],\n  current: {\n    domain: home.AppStateTypes.FEED\n    // search: null // { tab, text }\n    // defaultSearchTab:\n    // defaultSearchText:\n    // activeSeries: 'fda17bae-0335-4f0d-9065-dc8d7aa23ed1',\n    // initialPhoto: 'someguid'\n  }\n}\n\nexport default (state = homeInit, action) => {\n  const { type, data } = action\n  const { history, current } = state\n\n  switch (type) {\n    case Actions.HOME_STATE_BACK:\n      const newStateHistory = [...history]\n      const newCurrentState = newStateHistory.length > 0 ? newStateHistory.pop() : homeInit.current\n      return {\n        ...state,\n        current: newCurrentState,\n        history: newStateHistory\n      }\n\n    case Actions.HOME_CHANGE_ACTIVE_SERIES:\n      const { activeSeries, initialPhoto } = current\n      return {\n        ...state,\n        history,\n        current: {\n          ...current,\n          activeSeries: activeSeries || null,\n          initialPhoto: activeSeries && initialPhoto ? initialPhoto : null\n        }\n      }\n\n    case Actions.HOME_CHANGE_STATE:\n      const { newDomain, params } = data\n      const newParams = params || {}\n      const newHistory = [...history, current]\n      return {\n        ...state,\n        history: newHistory,\n        current: {\n          ...current,\n          domain: newDomain,\n          ...newParams\n        }\n      }\n\n    default:\n      return state\n  }\n}\n","import { Actions } from '../actions'\n\nconst initState = {\n  store: [],\n  activeUpload: null\n}\n\nexport default (state = initState, action) => {\n  const { type, data } = action\n  const { store, activeUpload } = state\n\n  switch (type) {\n    case Actions.UPLOADER_START:\n      if (!activeUpload) {\n        return {\n          ...state,\n          activeUpload: data\n        }\n      }\n      else {\n        return {\n          ...state,\n          store: [...store, data]\n        }\n      }\n    case Actions.UPLOADER_COMPLETE:\n      if (store.length === 0) {\n        return {\n          ...state,\n          activeUpload: null\n        }\n      }\n      else {\n        const newStore = [...store]\n        const newActive = newStore.pop()\n        return {\n          ...state,\n          store: newStore,\n          activeUpload: newActive\n        }\n      }\n    case Actions.UPLOADER_UPDATE_PROGRESS:\n      return {\n        ...state,\n        activeUpload: { ...activeUpload, ...data }\n      }\n    default:\n      return state\n  }\n}\n","import { Actions } from '../actions'\nimport { isIos } from '../../lib/sensors'\n\nconst defaultFlags = {\n  iOSWarning: isIos(),\n  install: true,\n  useLoggedOut: false\n}\nexport default (state = defaultFlags, action) => {\n  const { type, data } = action\n\n  switch (type) {\n    case Actions.SETFLAG:\n      const { flagName, flagVal } = data\n      return { ...state, [flagName]: flagVal }\n\n    default:\n      return state\n  }\n}\n","import { combineReducers } from 'redux'\nimport map from './map'\nimport home from './home'\nimport uploader from './uploader'\nimport flags from './flags'\n\nexport default combineReducers({ map, home, uploader, flags })\n","import { createStore, applyMiddleware, compose } from 'redux'\nimport thunk from 'redux-thunk'\nimport rootReducer from './reducers'\nimport { persistStore, persistReducer } from 'redux-persist'\nimport storage from 'redux-persist/lib/storage' // defaults to localStorage for web\n\n// import api from '../middleware/api'\n// https://github.com/reduxjs/redux/blob/master/examples/real-world/src/middleware/api.js\n\nconst persistConfig = {\n  key: 'root',\n  storage\n}\n\nconst persistedReducer = persistReducer(persistConfig, rootReducer)\n\n/**\n * On Dev we want our devTools available\n */\nconst configureStoreDev = preloadedState => {\n  const { devToolsEnhancer } = require('redux-devtools-extension')\n  const { createLogger } = require('redux-logger')\n  const store = createStore(\n    persistedReducer,\n    preloadedState,\n    compose(\n      devToolsEnhancer(),\n      applyMiddleware(\n        thunk,\n        createLogger()\n      )\n    )\n  )\n  if (module.hot) {\n    // Enable Webpack hot module replacement for reducers\n    module.hot.accept('./reducers', () => {\n      store.replaceReducer(rootReducer)\n    })\n  }\n  return store\n}\n\n/**\n * Production gets a simpler more performant store:\n */\nconst configureStoreProd = preloadedState => {\n  const store = createStore(\n    persistedReducer,\n    preloadedState,\n    compose(\n      applyMiddleware(\n        thunk\n      )\n    )\n  )\n  return store\n}\n\nexport default () => {\n  const store = process.env.NODE_ENV === 'production' ? configureStoreProd() : configureStoreDev()\n  return {\n    store,\n    persistor: persistStore(store)\n  }\n}\n","import React from 'react'\nimport { PersistGate } from 'redux-persist/integration/react'\nimport { Provider } from 'react-redux'\nimport storeConfig from './storeConfig'\nimport Loading from '../components/auth/Loading'\n/**\n * In this example, 'store' is the configured Redux store and\n *'persist' is a function that returns a Promise to rehydrate the\n * Redux store using redux-persist\n *\n * FROM: https://medium.com/hexient-labs/redux-store-provider-hoc-3495281905c\n */\nconst withReduxProvider = BaseComponent => (props) => {\n  const { store, persistor } = storeConfig()\n  // console.log('withReduxProvider', { props, store, persistor })\n  return (\n    <Provider store={store}>\n      <PersistGate loading={<Loading />} persistor={persistor}>\n        <BaseComponent {...props} />\n      </PersistGate>\n    </Provider>\n  )\n}\n\nexport default withReduxProvider\n","import React from 'react'\nimport classNames from 'classnames'\nimport PropTypes from 'prop-types'\nimport Paper from '@material-ui/core/Paper'\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport LinearProgress from '@material-ui/core/LinearProgress'\nimport Typography from '@material-ui/core/Typography'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n    background: 'black',\n    color: theme.palette.primary.contrastText,\n    padding: theme.spacing(1) * 2\n  },\n  message: {\n    // width: '100%'\n  },\n  msgText: {\n    display: 'flex'\n  },\n  spacer: {\n    flexGrow: 1\n  },\n  messageInner: {\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst UploadControlUnstyled = ({ className, text, progress }) => {\n  const classes = useStyles()\n  if (!text) return null\n  const message = `Uploading: ${text}`\n  return (\n    <div className={classNames(classes.root, className)}>\n      <div className={classes.messageInner}>\n        <div className={classes.msgText}>\n          <Typography color='inherit'>{message}</Typography>\n          <div className={classes.spacer} />\n          <Typography color='inherit'>{progress}%</Typography>\n        </div>\n        <LinearProgress color='secondary' variant='determinate' value={progress} />\n      </div>\n    </div>\n  )\n}\n\nUploadControlUnstyled.propTypes = {\n  className: PropTypes.string,\n  text: PropTypes.string,\n  progress: PropTypes.number\n}\n\nconst UploadControl = UploadControlUnstyled\nexport default UploadControl\n\nexport const UploadControlCOSMOSWrapper = ({ text, progress }) => {\n  // const [someStateItem, setSomeStateItem] = useState()\n  const classes = useWrapperStyles()\n  return (\n    <div className={classes.root}>\n      <CssBaseline /> {/* You only need this in a root element. Don't put it anywhere else in the dom */}\n      <Paper className={classes.paper}>\n        <Typography variant='h5'>\n          This is a dummy component.\n        </Typography>\n      </Paper>\n      <UploadControl text={text} progress={progress} />\n    </div>\n  )\n}\n\nUploadControlCOSMOSWrapper.propTypes = {\n  text: PropTypes.string,\n  progress: PropTypes.number\n}\nconst wrapperStyle = theme => ({\n  root: {\n    height: '100%',\n    display: 'flex',\n    flexDirection: 'column'\n  },\n  paper: {\n    flexGrow: 1\n  }\n})\n\nconst useWrapperStyles = makeStyles(wrapperStyle)\n\nUploadControlCOSMOSWrapper.displayName = UploadControl.displayName\nexport const UploadControlTest = UploadControlCOSMOSWrapper\n","import axios from 'axios'\nimport FormData from 'form-data'\nimport { get } from './localdb' // get, setEntry\n\n/**\n * DEbuggers for AXIOS\n */\naxios.interceptors.request.use(\n  request => {\n    console.log('AXIOS:::: Starting Request', request)\n    return request\n  },\n  err => {\n    console.log('AXIOS:::: Starting Request ERROR', err)\n    return Promise.reject(err)\n  }\n)\n\naxios.interceptors.response.use(\n  response => {\n    console.log('AXIOS:::: Response', response)\n    return response\n  },\n  err => {\n    console.log('AXIOS:::: Starting Response ERROR', err)\n    return Promise.reject(err)\n  }\n)\n\nexport default async function doUpload (activeUpload, updateUploadProgress, completeActiveUpload) {\n  console.log('UploadConntect: upload start', activeUpload)\n\n  // Initialising the HTML POST form for posting to S3 directly\n  let formData = new FormData()\n  // Take the auth credentials that we got from the backend and add them to our S3 POST\n  Object.keys(activeUpload.preAuth.fields).forEach(fieldkey => {\n    console.log('APPEND', fieldkey, activeUpload.preAuth.fields[fieldkey])\n    formData.append(fieldkey, activeUpload.preAuth.fields[fieldkey])\n  })\n  const base64val = await get(activeUpload.id)\n  const file = dataURLtoFile(base64val, `a.${activeUpload.ext}`)\n  formData.append('file', file)\n\n  const config = {\n    headers: {\n      'Content-Type': 'multipart/form-data'\n    },\n    onUploadProgress: progressEvent => {\n      const { loaded, total } = progressEvent\n      // Do something with the progress details\n      console.log('PROGRESSEVENT', loaded, total, Math.floor(100 * loaded / total))\n      updateUploadProgress({ progress: Math.floor(100 * loaded / total) })\n    }\n  }\n\n  console.log('FORMDATA', formData)\n  // Upload file to S3\n  await axios.post(\n    activeUpload.preAuth.url,\n    formData,\n    config\n  ).catch(err => {\n    console.error(err)\n    console.log(err.stack)\n  })\n  console.log('UploadConntect: upload done')\n  completeActiveUpload()\n}\n\nfunction dataURLtoFile (dataurl, filename) {\n  var arr = dataurl.split(','); var mime = arr[0].match(/:(.*?);/)[1]\n\n  var bstr = atob(arr[1]); var n = bstr.length; var u8arr = new Uint8Array(n)\n  while (n--) {\n    u8arr[n] = bstr.charCodeAt(n)\n  }\n  return new File([u8arr], filename, { type: mime })\n}\n","import React, { useRef, useEffect } from 'react'\nimport PropTypes from 'prop-types'\nimport { connect } from 'react-redux'\nimport actions from '../redux/actions'\nimport UploadControl from '../components/UploadControl'\nimport s3Upload from '../lib/s3upload'\n\nconst UploadConntect = ({\n  activeUpload,\n  completeActiveUpload,\n  updateUploadProgress,\n  ...props\n}) => {\n  const uploadingRef = useRef()\n  useEffect(() => {\n    uploadingRef.current = uploadingRef.current && !!activeUpload\n\n    if (activeUpload && !uploadingRef.current) {\n      s3Upload(activeUpload, updateUploadProgress, completeActiveUpload)\n    }\n  }, [Boolean(activeUpload)])\n\n  if (!activeUpload) return null\n  return <UploadControl text={'Uploading thing'} progress={activeUpload.progress || 0} {...props} />\n}\nUploadConntect.propTypes = {\n  // All from redux\n  activeUpload: PropTypes.object,\n  completeActiveUpload: PropTypes.func.isRequired,\n  updateUploadProgress: PropTypes.func.isRequired\n}\n\n/**\n * Map our redux state and functions\n */\nconst mapStateToProps = (state, props) => {\n  const { activeUpload } = state.uploader\n  return { activeUpload }\n}\n\nconst mapDispatchToProps = dispatch => ({\n  completeActiveUpload: () => {\n    dispatch(actions.completeActiveUpload())\n  },\n  updateUploadProgress: (newProgress) => {\n    dispatch(actions.updateUploadProgress(newProgress))\n  }\n})\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(UploadConntect)\n","/**\n * Valid Roles are: admin, user, nonuser\n *\n * Valid Resources are: series, series_public, series_open, photo\n *\n * For more see:\n * https://docs.google.com/spreadsheets/d/1oXsZrsuyOSFs_tufRluSjQiR6OSTObWiGsKDUKb5vLk/edit#gid=0\n *\n * RTFM:\n * https://onury.io/accesscontrol/?content=guide#resources-and-resource-attributes\n */\nexport default {\n  // Admin is god. Be careful who you give this to.\n  admin: {\n    series: {\n      'create:own': ['*'],\n      'read:any': ['*'],\n      'update:any': ['*'],\n      'delete:any': ['*']\n    },\n    photo: {\n      'create:any': ['*'],\n      'read:any': ['*'],\n      'update:any': ['*'],\n      'delete:any': ['*']\n    }\n  },\n  // Logged out users can see public stuff but nothing esle\n  nonuser: {\n    photo: {\n      'read:any': ['*'],\n      'update:any': ['*'],\n      'delete:any': ['*']\n    },\n    series_public: {\n      'read:any': ['*']\n    },\n    series_open: {\n      'read:any': ['*']\n    }\n  },\n  // Users are the key permissions role in V0\n  // Note: we could inherit from user but we keep it explicit for now\n  user: {\n    series: {\n      'create:own': ['*'],\n      'read:own': ['*'],\n      'update:own': ['*'],\n      'delete:own': ['*']\n    },\n    series_public: {\n      'read:any': ['*']\n    },\n    series_open: {\n      'read:any': ['*'],\n      'update:any': ['photos']\n    },\n    photo: {\n      'read:any': ['*'],\n      'create:own': ['*'],\n      'update:own': ['*'],\n      'delete:own': ['*']\n    }\n  }\n}\n","import React, { useState, useLayoutEffect, useContext } from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport Dialog from '@material-ui/core/Dialog'\n// import MenuIcon from '@material-ui/icons/Menu'\nimport QRCode from 'qrcode'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { Paper } from '@material-ui/core'\nimport { SeriesContext } from '../contexts'\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n  },\n  title: {\n    textAlign: 'center'\n  },\n  qrPaper: {\n    padding: theme.spacing(2)\n  },\n  qrCode: {\n    width: '100%',\n    height: 400\n  }\n}))\n\nconst QRDisplay = ({ onClose, open }) => {\n  const classes = useStyles()\n  const { series } = useContext(SeriesContext)\n  const [qrCodeEl, setQRCodeEl] = useState(null)\n  const obj = { type: 'series', id: series.id }\n  const encodedId = encodeURI(JSON.stringify(obj))\n  const url = `${process.env.PUBLIC_URL}/?fromqr=${encodedId}`\n\n  useLayoutEffect(() => {\n    QRCode.toString(url, (err, svgStr) => {\n      if (err) console.error(err)\n      else setQRCodeEl(svgStr)\n    })\n  }, [series])\n\n  return (\n    <Dialog\n      open={open}\n      onClose={onClose}\n      className={classes.root\n      }>\n      <Paper className={classes.qrPaper}>\n        <Typography variant='subtitle1' component='div' className={classes.title}>{series.name}</Typography>\n        <svg className={classes.qrCode} dangerouslySetInnerHTML={{ __html: qrCodeEl }} />\n        {series.coords && <Typography component='div' className={classes.title}>[ {series.coords[0]}, {series.coords[1]} ]</Typography>}\n      </Paper>\n    </Dialog>\n  )\n}\n\nQRDisplay.propTypes = {\n  onClose: PropTypes.func.isRequired,\n  open: PropTypes.bool\n}\n\nexport default QRDisplay\n","import React from 'react'\nimport createSvgIcon from '@material-ui/icons/utils/createSvgIcon'\n\nexport default createSvgIcon(\n  <React.Fragment>\n    <path d='M22,2l0,20l-20,0l0,-20l20,0Zm-2,2l-16,0l0,16l16,0l0,-16Z' />\n    <rect x='5' y='5' width='4' height='4' />\n    <rect x='15' y='5' width='4' height='4' />\n    <rect x='5' y='15' width='4' height='4' />\n    <rect x='10' y='10' width='1' height='5' />\n    <rect x='11' y='10' width='6' height='2' />\n    <rect x='11' y='12' width='2' height='2' />\n    <rect x='13' y='7' width='1' height='2' />\n    <rect x='14' y='9' width='1' height='1' />\n    <rect x='8' y='10' width='1' height='4' />\n    <rect x='7' y='11' width='1' height='3' />\n    <rect x='9' y='11' width='1' height='1' />\n    <rect x='10' y='6' width='2' height='3' />\n    <rect x='12' y='7' width='1' height='1' />\n    <rect x='15' y='14' width='2' height='4' />\n    <rect x='14' y='14' width='1' height='1' />\n    <rect x='17' y='15' width='2' height='2' />\n    <rect x='11' y='16' width='1' height='3' />\n    <rect x='12' y='15' width='2' height='2' />\n    <rect x='10' y='18' width='1' height='1' />\n  </React.Fragment>, 'QRCode')\n","import React, { useState, useRef, useEffect } from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport SpeedDial from '@material-ui/lab/SpeedDial'\nimport SpeedDialAction from '@material-ui/lab/SpeedDialAction'\nimport Fab from '@material-ui/core/Fab'\nimport { fade } from '@material-ui/core/styles/colorManipulator'\n\n// import useNewImageMenu from '../PhotoSeries/views/controls/useNewImageMenu'\nimport AddCameraIcon from '@material-ui/icons/AddAPhoto'\nimport PhotoLibraryIcon from '@material-ui/icons/PhotoLibrary'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst useStyles = makeStyles(theme => {\n  const pulseCol = fade(theme.palette.secondary.light, 0.4)\n  return {\n    root: {\n    },\n    speedDialFab: {\n      background: theme.palette.secondary.main,\n      color: theme.palette.secondary.contrastText,\n      '&::before': {\n        content: '\"  \"',\n        display: 'block',\n        position: 'absolute',\n        width: '100%',\n        height: '100%',\n        borderRadius: 'inherit',\n        boxShadow: `0 0 0 0 ${pulseCol}`,\n        animation: '$fabPulse 4s',\n        animationIterationCount: 5,\n        animationTimingFunction: 'linear'\n      }\n    },\n    '@keyframes fabPulse': {\n      '0%': {\n        boxShadow: `0 0 0 0px ${pulseCol}`\n      },\n      '90%': {\n        boxShadow: `0 0 0 0px ${pulseCol}`\n      },\n      '100%': {\n        boxShadow: `0 0 0 10px transparent`\n      }\n    },\n    directionUp: {\n    },\n    actionsClosed: {\n      display: 'none'\n    }\n  }\n})\n\nconst AddFab = ({ className, children, onCameraClick, onLibraryClick, isIos }) => {\n  const [open, setOpen] = useState(false)\n  const [down, setDown] = useState(false)\n  const timerRef = useRef()\n  const classes = useStyles()\n  // const theme = useTheme()\n  const downRef = useRef(down)\n  downRef.current = down\n\n  // Make sure to clean up the timer\n  useEffect(() => () => {\n    if (timerRef.current) timerRef.current = null\n  })\n\n  const startTimer = (el) => {\n    setDown(true)\n    if (!open && !timerRef.current) {\n      timerRef.current = setTimeout(() => {\n        if (downRef.current) setOpen(true)\n        timerRef.current = null\n      }, 300)\n    }\n  }\n\n  const onDown = (e) => {\n    // console.log('onDown', e.currentTarget)\n    // setSeries(series)\n    startTimer(e.currentTarget)\n  }\n\n  const block = (e) => {\n    if (e && e.stopPropagation) {\n      e.stopPropagation()\n      e.preventDefault()\n    }\n  }\n\n  const cameraAction = (e) => {\n    console.log('cameraclick')\n    setOpen(false)\n    setDown(false)\n    onCameraClick()\n    block(e)\n  }\n  const libraryAction = (e) => {\n    console.log('libraryClick')\n    setOpen(false)\n    setDown(false)\n    onLibraryClick()\n    block(e)\n  }\n\n  if (isIos) return <AddFabIos {...{ className, onLibraryClick, children }} />\n\n  return (\n    <div className={classNames(classes.rootContainer, className)}>\n      <SpeedDial\n        ariaLabel='SpeedDial photo adder'\n        onBlur={(e) => {\n          setTimeout(() => setOpen(false), 250)\n        }}\n        ButtonProps={{\n          disableFocusRipple: true\n        }}\n        classes={{\n          directionUp: classes.directionUp,\n          actionsClosed: classes.actionsClosed,\n          root: classes.root,\n          fab: classNames(classes.speedDialFab, 'fabanimation')\n        }}\n        icon={children}\n        onClick={(e) => {\n          block(e)\n          setDown(false)\n          if (!open) {\n            console.log('cameraclick MAIN')\n            onCameraClick()\n          }\n        }}\n        onMouseDown={onDown}\n        // onMouseUp={onUp}\n        onTouchStart={onDown}\n        // onTouchEnd={onUp}\n\n        open={open}\n        direction='up'\n      >\n        <SpeedDialAction\n        // Bit of a hack here. This function isn't quite ready for primetime\n          icon={<AddCameraIcon className={classes.speedDialIcon} />}\n          tooltipPlacement='right'\n          tooltipTitle='From Camera'\n          tooltipOpen\n          ButtonProps={{\n            disableFocusRipple: true\n          }}\n          onClick={cameraAction}\n          onMouseDown={onDown}\n          onTouchStart={cameraAction}\n        />\n        <SpeedDialAction\n        // Bit of a hack here. This function isn't quite ready for primetime\n          icon={<PhotoLibraryIcon className={classes.speedDialIcon} />}\n          tooltipPlacement='right'\n          tooltipTitle='From Photo Library'\n          tooltipOpen\n          ButtonProps={{\n            disableFocusRipple: true\n          }}\n          onClick={libraryAction}\n          onMouseDown={onDown}\n          onTouchStart={libraryAction}\n        />\n      </SpeedDial>\n    </div>\n\n  )\n}\n\nAddFab.propTypes = {\n  className: PropTypes.string,\n  children: PropTypes.any,\n  isIos: PropTypes.bool,\n  onCameraClick: PropTypes.func.isRequired,\n  onLibraryClick: PropTypes.func.isRequired\n}\n\nexport default AddFab\n\nconst useIosStyles = makeStyles(theme => {\n  const pulseCol = fade(theme.palette.secondary.light, 0.4)\n  return {\n    root: {\n      background: theme.palette.secondary.main,\n      color: theme.palette.secondary.contrastText,\n      '&::before': {\n        content: '\"  \"',\n        display: 'block',\n        position: 'absolute',\n        width: '100%',\n        height: '100%',\n        borderRadius: 'inherit',\n        boxShadow: `0 0 0 0 ${pulseCol}`,\n        animation: '$fabPulse 4s',\n        animationIterationCount: 5,\n        animationTimingFunction: 'linear'\n      }\n    },\n    '@keyframes fabPulse': {\n      '0%': {\n        boxShadow: `0 0 0 0px ${pulseCol}`\n      },\n      '90%': {\n        boxShadow: `0 0 0 0px ${pulseCol}`\n      },\n      '100%': {\n        boxShadow: `0 0 0 10px transparent`\n      }\n    }\n  }\n})\n\nexport const AddFabIos = ({ className, children, onLibraryClick }) => {\n  const classes = useIosStyles()\n  return (\n    <Fab className={classNames(classes.root, className)} onClick={onLibraryClick} disableFocusRipple>\n      {children}\n    </Fab>\n  )\n}\n\nAddFabIos.propTypes = {\n  className: PropTypes.string,\n  children: PropTypes.any,\n  onLibraryClick: PropTypes.func.isRequired\n}\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Menu from '@material-ui/core/Menu'\nimport MenuItem from '@material-ui/core/MenuItem'\nimport ListItemIcon from '@material-ui/core/ListItemIcon'\nimport ListItemText from '@material-ui/core/ListItemText'\nimport Divider from '@material-ui/core/Divider'\n\n// import { Menu as MenuIcon } from '@material-ui/icons'\n\nconst ContextMenu = ({ anchorEl, onClose, menuItems }) => {\n  return (\n    <Menu\n      anchorEl={anchorEl}\n      open={!!anchorEl}\n      onClose={onClose}\n    >\n      {menuItems.map(({ icon, color, text, hide, disabled, action, divider }, idx) => {\n        const Icon = icon || null\n        if (hide) return null\n        if (divider) return <Divider key={`contextMenu-${idx}`} />\n        return (\n          <MenuItem\n            key={`contextMenu-${idx}`}\n            disabled={disabled}\n            onClick={() => {\n              onClose()\n              action()\n            }}>\n            {Icon && (\n              <ListItemIcon>\n                <Icon color={disabled ? 'disabled' : color} />\n              </ListItemIcon>\n            )}\n            <ListItemText primary={text} primaryTypographyProps={{ color }} />\n          </MenuItem>\n        )\n      })}\n    </Menu>\n  )\n}\n\nContextMenu.propTypes = {\n  anchorEl: PropTypes.object,\n  onClose: PropTypes.func,\n  menuItems: PropTypes.arrayOf(PropTypes.shape({\n    text: PropTypes.string,\n    icon: PropTypes.any,\n    divider: PropTypes.any,\n    hide: PropTypes.bool,\n    disabled: PropTypes.bool,\n    color: PropTypes.string,\n    action: PropTypes.func\n  }))\n}\n\nexport default ContextMenu\n","import React, { useState, useContext } from 'react'\n// import PropTypes from 'prop-types'\n\nimport Divider from '@material-ui/core/Divider'\nimport List from '@material-ui/core/List'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemText from '@material-ui/core/ListItemText'\nimport Typography from '@material-ui/core/Typography'\nimport FormLabel from '@material-ui/core/FormLabel'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport TagChip from '../tags/TagChip'\nimport style from './SeriesInfo.style'\n\nimport ShortLongText from '../controls/ShortLongText'\nimport UserListItem from '../controls/UserListItem'\nimport BigText from '../dialogs/BigText'\nimport { formatDate } from '../../../../lib/datelib'\nimport SeriesConfigClass from '../../../../lib/SeriesConfig'\n\nimport { SeriesContext } from '../../contexts'\n\nconst DIALOGS = {\n  NOTEVIEW: 'NOTEVIEW'\n}\nconst useStyles = makeStyles(style)\n\nconst SeriesInfo = () => {\n  const classes = useStyles()\n  const { series, seriesConfig } = useContext(SeriesContext)\n  const seriesConfigInst = new SeriesConfigClass(seriesConfig)\n  const [activeDialog, setActiveDialog] = useState(null)\n\n  const newTags = series.photos.reduce((acc, { tags }) => {\n    tags.forEach(tag => {\n      if (!acc[tag.typeId]) {\n        acc[tag.typeId] = {\n          [tag.label]: { ...tag, count: 1 }\n        }\n      }\n      else if (acc[tag.typeId][tag.label]) {\n        const existing = acc[tag.typeId][tag.label]\n        acc[tag.typeId][tag.label] = { ...existing, count: existing.count + 1 }\n      }\n      else acc[tag.typeId][tag.label] = { ...tag, count: 1 }\n    })\n    return acc\n  }, {})\n\n  let metaKeys = []\n  try {\n    metaKeys = series.meta ? Object.keys(JSON.parse(series.meta)) : []\n  }\n  catch (e) {\n    console.error(e)\n  }\n\n  return (\n    <div className={classes.root}>\n      <div className={classes.field}>\n        <FormLabel className={classes.formLabel}>\n      Series Name\n        </FormLabel>\n        <Typography variant='body1' color='inherit'>\n          {series.name}\n        </Typography>\n      </div>\n      {series.note && (\n        <ShortLongText\n          label='Series Note'\n          text={series.note}\n          onClick={() => setActiveDialog(DIALOGS.NOTEVIEW)}\n        />\n      )}\n\n      <Typography className={classes.heading} variant='subtitle1'>Series Summary</Typography>\n      <Divider />\n      <List className={classes.list}>\n        {series.createdUser && (\n          <UserListItem\n            user={series.createdUser}\n            onAvatarClick={() => seriesConfig.onAvatarClick(series.createdUser.username)}\n            secondary='created this series'\n          />\n        )}\n        <ListItem disableGutters>\n          <ListItemText\n            primary={`Photos: ${series.photos.length}`}\n            secondary={series.photos.length > 0 && (\n              <span>\n             First: {formatDate(series.photos[series.photos.length - 1].takenOn, 'lll')}\n                <br />\n             Latest: {formatDate(series.photos[0].takenOn, 'lll')}\n              </span>\n            )}\n          />\n        </ListItem>\n\n        <ListItem disableGutters>\n          <ListItemText>\n            <FormLabel className={classes.formLabel}>\n              Tags in use (across all photos)\n            </FormLabel>\n            <Divider />\n            {Object.keys(newTags).length === 0 && (\n              <Typography variant='caption'>No photos in this series have tags</Typography>\n            )}\n            {Object.keys(newTags).map((tagKey, idtk) => (\n              <div key={`tagchipkey${idtk}`} className={classes.tagListItem}>\n                <Typography className={classes.subheading} variant='overline'>{seriesConfigInst.getTagType(tagKey).label}</Typography>\n                <Divider />\n                {Object.values(newTags[tagKey]).length > 0\n                  ? (\n                    Object.values(newTags[tagKey]).map((tag, idx) => (\n                      <TagChip\n                        key={`tagchip-${idtk}-${idx}`}\n                        tag={tag}\n                        color={seriesConfigInst.getTagType(tagKey).color}\n                      />\n                    ))\n                  )\n                  : (\n                    <Typography variant='caption'>No photos in this series have tags</Typography>\n                  )\n                }\n              </div>\n            ))}\n          </ListItemText>\n        </ListItem>\n\n      </List>\n\n      {metaKeys.length > 0 && Object.keys(seriesConfig.meta).length > 0 && (\n        <React.Fragment>\n          <FormLabel className={classes.formLabel}>\n            Metadata\n          </FormLabel>\n          <Divider />\n          <List className={classes.list}>\n            {metaKeys.map((key, idx) => seriesConfig.meta[key] ? (\n              <ListItem key={`metadata${idx}`}>\n                <ListItemText\n                  primary={seriesConfig.meta[key].label}\n                  secondary={seriesConfig.meta[key].render(series.meta[key])}\n                />\n              </ListItem>\n            ) : null\n            )}\n          </List>\n        </React.Fragment>\n      )}\n      {activeDialog === DIALOGS.NOTEVIEW && (\n        <BigText\n          open\n          multiline\n          onClose={() => setActiveDialog(null)}\n          title='Series Note'\n          body={series.note}\n        />\n      )}\n    </div>\n  )\n}\n\nSeriesInfo.propTypes = {\n}\n\nexport default SeriesInfo\n","export default theme => ({\n  root: {\n    margin: theme.spacing(1),\n    backgroundColor: theme.palette.background.paper,\n    paddingBottom: 60 // a little extra room for the FAB\n\n  },\n  field: {\n    marginBottom: theme.spacing(1)\n  },\n  list: {\n    padding: theme.spacing(1)\n  },\n  heading: {\n    marginTop: theme.spacing(1)\n  },\n  tagListItem: {\n    marginTop: theme.spacing(1),\n    marginBottom: theme.spacing(2)\n  },\n  chip: {\n    margin: theme.spacing(0.5)\n  }\n})\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\n\nimport MobileStepper from '@material-ui/core/MobileStepper'\nimport IconButton from '@material-ui/core/IconButton'\nimport GridListTileBar from '@material-ui/core/GridListTileBar'\nimport Badge from '@material-ui/core/Badge'\n\nimport LabelIcon from '@material-ui/icons/Label'\n// import RemoveRedEye from '@material-ui/icons/RemoveRedEye'\nimport KeyboardArrowLeft from '@material-ui/icons/KeyboardArrowLeft'\nimport KeyboardArrowRight from '@material-ui/icons/KeyboardArrowRight'\n\nimport SwipeableViews from 'react-swipeable-views'\nimport Photo from './Photo'\nimport { formatDate } from '../../../../lib/datelib'\nimport { makeStyles, useTheme } from '@material-ui/core/styles'\nimport style from './SwipeShow.style'\n\nconst useStyles = makeStyles(style)\n\nconst SwipeShow = ({ photos, initialPhoto, onImageSelect }) => {\n  const classes = useStyles()\n  const theme = useTheme()\n  const initPhotoIndex = initialPhoto ? photos.findIndex(p => p.id === initialPhoto) || 0 : 0\n  const [activePhoto, setActivePhoto] = useState(initPhotoIndex >= 0 ? initPhotoIndex : 0)\n  const [showTags, setShowTags] = useState(false)\n  const singular = photos.length < 2\n\n  const sortedPhotos = [...photos]\n  sortedPhotos.sort((a, b) => parseInt(b.takenOn, 10) - parseInt(a.takenOn, 10))\n\n  const handleForward = () => setActivePhoto(activePhoto >= sortedPhotos.length ? 0 : activePhoto + 1)\n  const handleBack = () => setActivePhoto(activePhoto <= 0 ? sortedPhotos.length - 1 : activePhoto - 1)\n\n  return (\n    <div className={classes.root}>\n      <div className={classes.inner}>\n        <SwipeableViews\n          axis={theme.direction === 'rtl' ? 'x-reverse' : 'x'}\n          index={activePhoto}\n          onChangeIndex={(val) => setActivePhoto(val)}\n          enableMouseEvents\n        >\n          {sortedPhotos.map((photo, idx) => (\n            <div className={classes.photoWrapper} key={`swipeshowpic-${idx}`} onClick={() => onImageSelect(sortedPhotos[activePhoto].id)}>\n              <Photo photo={photo} className={classes.photo} showTags={showTags} />\n            </div>\n          ))}\n        </SwipeableViews>\n        <IconButton size='small' className={classes.manualBack} onClick={handleBack} color='inherit' disabled={activePhoto === 0}>\n          {theme.direction === 'rtl' ? <KeyboardArrowRight /> : <KeyboardArrowLeft />}\n        </IconButton>\n        <IconButton size='small' className={classes.manualForward} onClick={handleForward} color='inherit' disabled={activePhoto === photos.length - 1}>\n          {theme.direction === 'rtl' ? <KeyboardArrowLeft /> : <KeyboardArrowRight />}\n        </IconButton>\n        <GridListTileBar\n          title={singular ? 'Photo' : `Photo (${activePhoto + 1}/${sortedPhotos.length})`}\n          subtitle={sortedPhotos.length > 0 && (\n            <span>{formatDate(sortedPhotos[activePhoto].takenOn)}</span>\n          )}\n          actionIcon={\n            <React.Fragment>\n              <IconButton className={classes.tagButton} onClick={() => setShowTags(!showTags)}>\n                <Badge color={showTags ? 'primary' : 'secondary'} badgeContent={sortedPhotos[activePhoto].tags ? sortedPhotos[activePhoto].tags.filter(tag => tag.coords).length : null}>\n                  <LabelIcon />\n                </Badge>\n              </IconButton>\n            </React.Fragment>\n          }\n        />\n      </div>\n      {!singular &&\n      <MobileStepper\n        steps={sortedPhotos.length}\n        position='static'\n        activeStep={activePhoto}\n        classes={{\n          root: classes.mobileStepper,\n          dots: classes.dots\n        }}\n      />\n      }\n    </div>\n  )\n}\n\nSwipeShow.propTypes = {\n  // This is just the basic shape of the photo object\n  initialPhoto: PropTypes.string,\n  photos: PropTypes.arrayOf(PropTypes.shape({\n    img: PropTypes.string,\n    tags: PropTypes.array,\n    date: PropTypes.date\n  })),\n  transition: PropTypes.number,\n  onImageSelect: PropTypes.func.isRequired\n}\n\nSwipeShow.defaultProps = {\n  transition: 5000,\n  isFullScreen: false,\n  slides: []\n}\n\nexport default SwipeShow\n","export default theme => ({\n  root: {\n    position: 'relative'\n  },\n  inner: {\n    position: 'relative'\n  },\n  photoWrapper: {\n    minHeight: 250,\n    height: 250\n  },\n  dateCaption: {\n    padding: theme.spacing(1),\n    background: theme.palette.primary.dark,\n    color: theme.palette.primary.contrastText,\n    textAlign: 'center'\n  },\n  mobileStepper: {\n    // position: 'absolute',\n    // bottom: theme.spacing(1),\n    // right: theme.spacing(1)\n  },\n  manualBack: {\n    color: 'white',\n    zIndex: 10,\n    position: 'absolute',\n    transform: 'translateY(-50%)',\n    left: 0,\n    top: '50%'\n  },\n  manualForward: {\n    color: 'white',\n    zIndex: 10,\n    position: 'absolute',\n    transform: 'translateY(-50%)',\n    right: 0,\n    top: '50%'\n  },\n  tagButton: {\n    color: 'rgba(255, 255, 255, 0.54)'\n  },\n  slideshowButton: {\n    color: 'rgba(255, 255, 255, 0.54)'\n  },\n  dots: {\n    margin: '0 auto'\n  }\n})\n","export default theme => ({\n  root: {\n    display: 'flex',\n    height: '100%',\n    flexDirection: 'column',\n    overflow: 'hidden'\n  },\n  appBar: {\n    flexGrow: 0\n  },\n  inner: {\n    position: 'relative',\n    flexGrow: 1,\n    overflowY: 'scroll',\n    '-webkit-overflow-scrolling': 'touch'\n  },\n  tabMenu: {\n    marginTop: theme.spacing(7)\n  },\n  mapWrap: {\n    position: 'absolute',\n    height: '100%',\n    width: '100%',\n    top: 0,\n    left: 0\n  },\n  toolbarTitle: {\n    flexGrow: 1,\n    textOverflow: 'ellipsis',\n    whiteSpace: 'nowrap',\n    overflow: 'hidden'\n  },\n  AddFab: {\n    position: 'absolute',\n    bottom: theme.spacing(2),\n    right: theme.spacing(2),\n    // left: '50%',\n    // transformOrigin: '0% 50%',\n    // transform: 'translateY(-25%) translateX(-50%)',\n    zIndex: 3000\n  },\n  grow: {\n    flexGrow: 1\n  },\n  gridList: {\n    flexWrap: 'nowrap',\n    // Promote the list into his own layer on Chrome. This cost memory but helps keeping high FPS.\n    transform: 'translateZ(0)'\n  },\n  titleBar: {\n    display: 'flex',\n    padding: theme.spacing(1)\n  },\n  menuButton: {\n    // marginLeft: -12,\n    // marginRight: 20\n  },\n  placeholderInner: {\n    position: 'relative',\n    flexGrow: 1,\n    overflow: 'hidden',\n    textAlign: 'center',\n    display: 'flex',\n    height: '100%',\n    flexDirection: 'column'\n  },\n  progressWrapper: {\n    textAlign: 'center',\n    marginBottom: theme.spacing(4)\n  },\n  placeholderText: {\n    opacity: 0.4\n  },\n  placeholder: {\n\n  },\n  progress: {\n    color: theme.palette.grey[300]\n  }\n})\n","import React, { useState, useContext } from 'react'\nimport PropTypes from 'prop-types'\n\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport AppBar from '@material-ui/core/AppBar'\nimport Toolbar from '@material-ui/core/Toolbar'\nimport IconButton from '@material-ui/core/IconButton'\nimport Typography from '@material-ui/core/Typography'\nimport Tabs from '@material-ui/core/Tabs'\nimport Tab from '@material-ui/core/Tab'\n\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack'\n\nimport AddCameraIcon from '@material-ui/icons/AddAPhoto'\nimport MoreIcon from '@material-ui/icons/MoreVert'\n\nimport AddAlertIcon from '@material-ui/icons/AddAlert'\nimport SlideshowIcon from '@material-ui/icons/Slideshow'\nimport EditIcon from '@material-ui/icons/Edit'\nimport DeleteIcon from '@material-ui/icons/Delete'\n\nimport QRDisplay from './QRDisplay'\nimport QRCodeIcon from '../../../icons/QRCode'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport MapDot from '../../maps/MapDot'\nimport AddFab from './controls/AddFab'\n\nimport ContextMenu from './controls/ContextMenu'\n\nimport SeriesInfo from './subViews/SeriesInfo'\nimport SwipeShow from './subViews/SwipeShow'\nimport PhotoGrid from './subViews/PhotoGrid'\n\nimport DeleteDialog from './dialogs/DeleteDialog'\n\nimport { SeriesContext } from '../contexts'\n\nimport style from './SeriesView.style'\nconst useStyles = makeStyles(style)\n\nconst SeriesView = ({\n  onSlideshowStart, onChange,\n  onEditSeries, onDeletePhotos, onCameraAdd,\n  onDeleteSeries, onLibraryAdd, onTileClick, onMenuBack,\n  onWatch, onUnWatch, initialPhoto,\n  watching, owned\n}) => {\n  const classes = useStyles()\n  const [contextEl, setContextEl] = useState()\n  const [showQR, setShowQR] = useState(false)\n  const [deleteConfirm, setDeleteConfirm] = useState(false)\n\n  const { series, seriesConfig, ac } = useContext(SeriesContext)\n\n  const onDeleteConfirm = (confirmation) => {\n    setDeleteConfirm(false)\n    if (confirmation === true) onDeleteSeries(series.id)\n  }\n\n  const viewport = { zoom: 16 }\n  if (series && series.coords && series.coords.length === 2) {\n    viewport.longitude = series.coords[0]\n    viewport.latitude = series.coords[1]\n  }\n\n  const can = {\n    update: ac.canUser('update', series, 'series', '*'),\n    delete: ac.canUser('delete', series, 'series', '*'),\n    contribute: ac.canUser('update', series, 'series', ['photos'])\n  }\n\n  const [listTypeTab, setListTypeTab] = useState(0)\n  return (\n    <div className={classes.root}>\n      <CssBaseline />\n      <AppBar position='static' className={classes.appBar}>\n        <Toolbar disableGutters>\n          <IconButton className={classes.menuButton} color='inherit' onClick={onMenuBack} aria-label='Menu'>\n            <ArrowBackIcon />\n          </IconButton>\n          <Typography variant='subtitle1' color='inherit' className={classes.toolbarTitle}>\n            {series.name || 'Series'}\n          </Typography>\n\n          {/* <IconButton className={classes.menuButton} color='inherit' onClick={onSlideshowStart} aria-label='Menu'>\n            <SlideshowIcon />\n          </IconButton> */}\n          <IconButton\n            aria-haspopup='true'\n            color='inherit'\n            onClick={event => setContextEl(event.currentTarget)}\n          >\n            <MoreIcon />\n          </IconButton>\n\n          <ContextMenu anchorEl={contextEl} onClose={() => setContextEl(null)} menuItems={[\n            {\n              text: 'Watch Series',\n              icon: AddAlertIcon,\n              hide: !onWatch || owned || watching,\n              action: onWatch\n            },\n            {\n              text: 'Unwatch Series',\n              icon: AddAlertIcon,\n              hide: !onUnWatch || owned || !watching,\n              action: onUnWatch\n            },\n            {\n              text: 'Series QR Code',\n              icon: QRCodeIcon,\n              action: () => setShowQR(true)\n            },\n            {\n              text: 'Start Slideshow',\n              icon: SlideshowIcon,\n              hide: !onSlideshowStart,\n              action: onSlideshowStart\n            },\n            { divider: true },\n            {\n              text: 'Edit Series',\n              icon: EditIcon,\n              hide: !onEditSeries || !can.update,\n              action: onEditSeries\n            },\n            {\n              text: 'Delete Series',\n              icon: DeleteIcon,\n              hide: !setDeleteConfirm || !can.delete,\n              color: 'error',\n              action: () => setDeleteConfirm(true)\n            }\n          ]} />\n        </Toolbar>\n        <Tabs variant='fullWidth'\n          value={listTypeTab}\n          onChange={(e, value) => setListTypeTab(value)}\n        >\n          <Tab label='Info' />\n          <Tab label='Map' />\n          <Tab label='Photos' />\n        </Tabs>\n      </AppBar>\n\n      <div className={classes.inner}>\n        {listTypeTab === 0 && (\n          <React.Fragment>\n            {series.photos && series.photos.length > 0 && (\n              <SwipeShow\n                photos={series.photos}\n                initialPhoto={initialPhoto}\n                onImageSelect={onTileClick}\n              />\n            )}\n            <SeriesInfo onChange={onChange} />\n          </React.Fragment>\n        )}\n        {series.photos && listTypeTab === 2 && (\n          <PhotoGrid\n            photos={series.photos}\n            onTileClick={onTileClick}\n            onDelete={onDeletePhotos}\n          />\n        )}\n      </div>\n\n      {listTypeTab === 1 && (\n        <MapDot\n          showMe\n          longitude={series.longitude}\n          latitude={series.latitude}\n          viewport={viewport}\n          direction={series.direction}\n        />\n      )}\n\n      {listTypeTab === 0 && can.contribute && (\n        <AddFab\n          isIos={seriesConfig.isIos}\n          className={classes.AddFab}\n          onCameraClick={onCameraAdd}\n          onLibraryClick={onLibraryAdd}\n        >\n          <AddCameraIcon />\n        </AddFab>\n      )}\n      <QRDisplay open={showQR} onClose={() => setShowQR(false)} />\n      <DeleteDialog\n        open={deleteConfirm}\n        onConfirm={onDeleteConfirm}\n        title='Delete Series'\n        message='Are you sure you want to delete this series? The record and all images associated with it will be gone forever.'\n      />\n    </div>\n  )\n}\n\nSeriesView.propTypes = {\n  initialPhoto: PropTypes.string,\n  watching: PropTypes.bool,\n  owned: PropTypes.bool,\n  // Action functions\n  onSlideshowStart: PropTypes.func.isRequired,\n  onChange: PropTypes.func.isRequired,\n  onDeletePhotos: PropTypes.func.isRequired,\n  onDeleteSeries: PropTypes.func.isRequired,\n  onCameraAdd: PropTypes.func.isRequired,\n  onEditSeries: PropTypes.func.isRequired,\n  onLibraryAdd: PropTypes.func.isRequired,\n  onTileClick: PropTypes.func.isRequired,\n  onMenuBack: PropTypes.func.isRequired,\n  onWatch: PropTypes.func,\n  onUnWatch: PropTypes.func\n}\n\nexport default SeriesView\n","\nimport React, { useState, useContext } from 'react'\nimport PropTypes from 'prop-types'\n\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport DialogActions from '@material-ui/core/DialogActions'\nimport Button from '@material-ui/core/Button'\nimport Typography from '@material-ui/core/Typography'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport { SeriesContext } from '../contexts'\n\nimport style from './SeriesEdit.style'\nimport SeriesEditInner from './subViews/SeriesEditInner'\n\nconst useStyles = makeStyles(style)\n\nconst SeriesEdit = ({ onOk, onCancel }) => {\n  const classes = useStyles()\n  const { series } = useContext(SeriesContext)\n  const [delta, setDelta] = useState({})\n\n  return (\n    <Dialog\n      scroll='paper'\n      className={classes.root}\n      fullScreen\n      open\n      fullWidth\n      onClose={onCancel}\n    >\n      <CssBaseline />\n      <DialogTitle disableTypography className={classes.dlgTitle}>\n        <Typography variant='subtitle1' color='inherit' className={classes.grow}>\n           Edit Series Details\n        </Typography>\n      </DialogTitle>\n      <DialogContent className={classes.inner}>\n        <SeriesEditInner\n          series={series}\n          delta={delta}\n          onChange={setDelta}\n        />\n      </DialogContent>\n      <DialogActions>\n        <Button className={classes.menuButton} color='inherit' onClick={() => setDelta({})} aria-label='Menu'>\n            Reset\n        </Button>\n        <Button className={classes.menuButton} color='inherit' onClick={onCancel} aria-label='Menu'>\n            Cancel\n        </Button>\n        <Button className={classes.menuButton} color='inherit' onClick={() => onOk({ id: series.id, ...delta })} aria-label='Menu'>\n            Ok\n        </Button>\n      </DialogActions>\n    </Dialog>\n  )\n}\n\nSeriesEdit.propTypes = {\n  // now some functions\n  onOk: PropTypes.func.isRequired,\n  onCancel: PropTypes.func.isRequired\n}\n\nexport default SeriesEdit\n","export default theme => ({\n  root: {\n\n  },\n  inner: {\n    display: 'flex',\n    flexDirection: 'column'\n    // padding: theme.spacing(1)\n  },\n  dlgTitle: {\n    background: theme.palette.primary.main,\n    color: theme.palette.primary.contrastText\n  },\n  grow: {\n    flexGrow: 1\n  },\n  field: {\n    flexGrow: 0,\n    marginBottom: theme.spacing(2)\n  },\n  slider: {\n    paddingLeft: theme.spacing(1),\n    paddingRight: theme.spacing(1)\n  },\n  textField: {\n    marginLeft: theme.spacing(1),\n    marginRight: theme.spacing(1),\n    width: '100%'\n  },\n  formLabel: {\n    display: 'block',\n    marginTop: theme.spacing(1),\n    marginBottom: theme.spacing(1)\n  },\n  mapFormLabel: {\n    display: 'block',\n    marginTop: theme.spacing(1),\n    marginBottom: theme.spacing(1)\n  },\n  mapInnerWrap: {\n    flexGrow: 1\n  },\n  mapWrapper: {\n    flexGrow: 1,\n    display: 'flex',\n    flexDirection: 'column',\n    paddingBottom: theme.spacing(2)\n  },\n  formControl: {\n    margin: theme.spacing(1),\n    minWidth: 120\n  },\n  chips: {\n    display: 'flex',\n    flexWrap: 'wrap'\n  }\n})\n","import React, { useState, useEffect, useRef } from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\n\nimport Badge from '@material-ui/core/Badge'\nimport Typography from '@material-ui/core/Typography'\nimport IconButton from '@material-ui/core/IconButton'\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport GridListTile from '@material-ui/core/GridListTile'\nimport GridListTileBar from '@material-ui/core/GridListTileBar'\nimport MobileStepper from '@material-ui/core/MobileStepper'\nimport Button from '@material-ui/core/Button'\n\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack'\nimport LabelIcon from '@material-ui/icons/Label'\nimport PauseIcon from '@material-ui/icons/PauseCircleFilled'\nimport PlayIcon from '@material-ui/icons/PlayCircleFilled'\nimport KeyboardArrowLeft from '@material-ui/icons/KeyboardArrowLeft'\nimport KeyboardArrowRight from '@material-ui/icons/KeyboardArrowRight'\n\nimport { makeStyles, useTheme } from '@material-ui/core/styles'\n\nimport Photo from './subViews/Photo'\nimport { formatDate } from '../../../lib/datelib'\nimport useComponentSize from '../../../lib/useComponentSize'\n\nimport style from './Slideshow.style'\n\nconst useStyles = makeStyles(style)\n\nconst Slideshow = ({ onCancel, photos, transition }) => {\n  const classes = useStyles()\n  const theme = useTheme()\n  const { activeStep, lastStep, handleForward, handleBack, paused, pause, play } = useStepper(photos.length, transition)\n  const [showXYTags, setShowXYTags] = useState(false)\n\n  const refImgWrap = useRef(null)\n  const { size: { height, width } } = useComponentSize(refImgWrap)\n\n  return (\n    <div className={classes.root}>\n      <CssBaseline />\n      <div ref={refImgWrap} className={classes.slideContainer}>\n        {photos.map((slide, idx) => (\n          <GridListTile\n            key={`slide-${idx}`}\n            className={classNames(\n              classes.slide,\n              activeStep === idx && classes.active,\n              lastStep === idx && classes.last\n            )}\n            onClick={() => setShowXYTags(!showXYTags)}\n            style={{\n              height,\n              width,\n              transition: theme.transitions.create(['opacity'], { duration: 1 / 4 * transition })\n            }}\n          >\n            <Photo photo={slide} className={classes.photo} showTags={showXYTags} />\n            <Typography className={classes.labelBadge} >\n            Tags: {showXYTags ? 'On ' : 'Off '}\n              <Badge color='secondary' badgeContent={photos[activeStep].tags.filter(tag => tag.coords).length}>\n                <LabelIcon color='inherit' />\n              </Badge>\n            </Typography>\n\n            <GridListTileBar\n              className={classes.titleBar}\n              titlePosition='top'\n              title={(\n                <Typography color='inherit' variant='caption'>\n                  <IconButton className={classes.iconButton} onClick={(e) => onCancel()}>\n                    <ArrowBackIcon />\n                  </IconButton>\n                  {formatDate(slide.takenOn)}\n                </Typography>\n              )}\n              subtitle={<em>{paused ? 'Paused' : '    '}</em>}\n              actionIcon={paused ? (\n                <IconButton className={classes.iconButton} onClick={(e) => {\n                  e.preventDefault()\n                  e.stopPropagation()\n                  play()\n                }}>\n                  <PlayIcon />\n                </IconButton>\n              ) : (\n                <IconButton className={classes.iconButton} onClick={(e) => {\n                  e.preventDefault()\n                  e.stopPropagation()\n                  pause()\n                }}>\n                  <PauseIcon />\n                </IconButton>\n              )}\n            />\n          </GridListTile>\n        ))}\n        <IconButton size='small' className={classes.manualBack} onClick={handleBack} color='inherit'>\n          {theme.direction === 'rtl' ? <KeyboardArrowRight /> : <KeyboardArrowLeft />}\n        </IconButton>\n        <IconButton size='small' className={classes.manualForward} onClick={handleForward} color='inherit'>\n          {theme.direction === 'rtl' ? <KeyboardArrowLeft /> : <KeyboardArrowRight />}\n        </IconButton>\n      </div>\n\n      <MobileStepper\n        steps={photos.length}\n        position='static'\n        activeStep={activeStep}\n        classes={{\n          root: classes.mobileStepper,\n          dotActive: classes.dotActive\n        }}\n        nextButton={\n          <Button color='inherit' size='small' onClick={handleForward} disabled={activeStep === photos.length - 1}>\n            Next\n            {theme.direction === 'rtl' ? <KeyboardArrowLeft /> : <KeyboardArrowRight />}\n          </Button>\n        }\n        backButton={\n          <Button color='inherit' size='small' onClick={handleBack} disabled={activeStep === 0}>\n            {theme.direction === 'rtl' ? <KeyboardArrowRight /> : <KeyboardArrowLeft />}\n            Back\n          </Button>\n        }\n      />\n    </div>\n  )\n}\n\nSlideshow.propTypes = {\n  // We might want to go full screen\n  isFullScreen: PropTypes.bool,\n  // This is just the basic shape of the photo object\n  photos: PropTypes.array,\n  transition: PropTypes.number,\n  onCancel: PropTypes.func.isRequired\n}\n\nSlideshow.defaultProps = {\n  transition: 5000,\n  isFullScreen: false,\n  slides: []\n}\n\nexport default Slideshow\n\n/**\n * Custom React Hook for all our timer handling\n */\nconst useStepper = (num, interval) => {\n  const [activeStep, setActiveStep] = useState(0)\n  const [paused, setPaused] = useState(false)\n  const [lastStep, setLastStep] = useState(0)\n  const timerRef = useRef()\n\n  const handleForward = () => {\n    setLastStep(activeStep)\n    if (activeStep + 1 >= num) setActiveStep(0)\n    else setActiveStep(activeStep + 1)\n    if (!paused) {\n      destroyTimer()\n      createTimer()\n    }\n  }\n  const handleBack = () => {\n    setLastStep(activeStep)\n    if (activeStep - 1 < 0) setActiveStep(num - 1)\n    else setActiveStep(activeStep - 1)\n    if (!paused) {\n      destroyTimer()\n      createTimer()\n    }\n  }\n\n  const pause = () => {\n    destroyTimer()\n    setPaused(true)\n  }\n  const play = () => {\n    setPaused(false)\n    destroyTimer()\n    createTimer()\n  }\n\n  const createTimer = () => {\n    timerRef.current = window.setInterval(\n      // We need to use the alternate notation for the useState function\n      // because setInterval will only have access to the activeStep it was\n      // initialized with\n      () => setActiveStep(oldStep => {\n        setLastStep(oldStep)\n        return (oldStep + 1 >= num) ? 0 : oldStep + 1\n      })\n      , interval\n    )\n  }\n  const destroyTimer = () => {\n    if (timerRef.current) window.clearInterval(timerRef.current)\n  }\n\n  useEffect(() => {\n    createTimer()\n    return () => {\n      destroyTimer()\n    }\n  }, []) // Pass in empty array to run useEffect only on mount.\n\n  return { activeStep, lastStep, handleForward, handleBack, setActiveStep, paused, pause, play }\n}\n","export default theme => ({\n  root: {\n    // maxWidth: 400,\n    height: '100%',\n    display: 'flex',\n    flexDirection: 'column'\n  },\n  swipeAble: {\n    height: '100%'\n  },\n  slideContainer: {\n    flexGrow: 1\n  },\n  titleBar: {\n    padding: theme.spacing(0, 1),\n    height: '35px!important'\n  },\n  mobileStepper: {\n    flexGrow: 0,\n    background: theme.palette.grey[800],\n    color: theme.palette.getContrastText(theme.palette.grey[800])\n  },\n  slide: {\n    top: 0,\n    zIndex: 0,\n    opacity: 0,\n    position: 'absolute',\n    display: 'block',\n    overflow: 'hidden',\n    width: '100%',\n    height: '100%',\n    minHeight: 300\n  },\n  dotActive: {\n    background: 'white'\n  },\n  iconButton: {\n    color: 'white'\n  },\n  active: {\n    zIndex: 5,\n    opacity: 1\n  },\n  last: {\n    opacity: 1,\n    zIndex: 4\n  },\n  tagContainer: {\n\n  },\n  labelBadge: {\n    color: 'white',\n    zIndex: 10,\n    position: 'absolute',\n    right: theme.spacing(2),\n    bottom: theme.spacing(1),\n    opacity: 0.8\n  },\n  tagChip: {\n    // height: theme.spacing(3),\n    marginRight: theme.spacing(1),\n    fontSize: 10,\n    height: theme.spacing(2),\n    padding: theme.spacing(0.5)\n  },\n  xyTagChip: {\n    position: 'absolute',\n    fontSize: theme.spacing(1),\n    height: theme.spacing(2)\n  },\n  manualBack: {\n    color: 'white',\n    zIndex: 10,\n    position: 'absolute',\n    transform: 'translateY(-50%)',\n    left: 0,\n    top: '50%'\n  },\n  manualForward: {\n    color: 'white',\n    zIndex: 10,\n    position: 'absolute',\n    transform: 'translateY(-50%)',\n    right: 0,\n    top: '50%'\n  }\n})\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport Button from '@material-ui/core/Button'\nimport Typography from '@material-ui/core/Typography'\nimport DialogActions from '@material-ui/core/DialogActions'\n\n// import MenuIcon from '@material-ui/icons/MenuIcon'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n\n})\n\nconst useStyles = makeStyles(style)\n\nconst CancelConfirm = ({ title, message, onConfirm, open }) => {\n  const classes = useStyles()\n  return (\n    <Dialog\n      className={classes.root}\n      disableBackdropClick\n      fullWidth\n      open={open}\n      disableEscapeKeyDown\n      maxWidth='xl'\n      aria-labelledby='confirmation-dialog-title'\n    >\n      <DialogTitle id='confirmation-dialog-title'>{title}</DialogTitle>\n      <DialogContent>\n        <Typography>\n          {message}\n        </Typography>\n\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={() => onConfirm(false)} color='primary'>\n      No\n        </Button>\n        <Button onClick={() => onConfirm(true)} color='secondary'>\n      Yes\n        </Button>\n      </DialogActions>\n    </Dialog>\n  )\n}\n\nCancelConfirm.propTypes = {\n  open: PropTypes.bool,\n  title: PropTypes.string.isRequired,\n  message: PropTypes.string.isRequired,\n  onConfirm: PropTypes.func.isRequired\n}\n\nexport default CancelConfirm\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\n\nimport Button from '@material-ui/core/Button'\nimport Dialog from '@material-ui/core/Dialog'\nimport IconButton from '@material-ui/core/IconButton'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport Typography from '@material-ui/core/Typography'\nimport DialogActions from '@material-ui/core/DialogActions'\n\nimport CloseIcon from '@material-ui/icons/Close'\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport CancelConfirm from '../dialogs/CancelConfirm'\n\nimport PhotoInfoInner from './PhotoInfoInner'\n\nconst style = theme => ({\n  root: {\n    height: '90%',\n    width: '85%'\n  },\n  dlgTitleContainer: {\n    display: 'flex',\n    padding: 0\n  },\n  dlgTitle: {\n    flexGrow: 1,\n    paddingTop: theme.spacing(2),\n    paddingBottom: theme.spacing(1),\n    paddingLeft: theme.spacing(3)\n  },\n  field: {\n    marginBottom: theme.spacing(2)\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst DIALOGS = {\n  NOTEEDIT: 'noteEdit',\n  NOTEVIEW: 'noteView',\n  PHOTOTAKEN: 'taken',\n  TAGEDIT: 'tag',\n  CANCEL: 'cancel'\n}\n\nconst PhotoInfo = ({ canEdit, photo, onCancel, onOk, open }) => {\n  const classes = useStyles()\n  const [activeDialog, setActiveDialog] = useState(null)\n  const [delta, setDelta] = useState({})\n\n  const dirty = delta && Object.keys(delta).length > 0\n\n  return (\n    <Dialog\n      fullScreen\n      fullWidth\n      onClose={() => {\n        if (dirty) setActiveDialog(DIALOGS.CANCEL)\n        else onCancel()\n      }}\n      aria-labelledby='customized-dialog-title'\n      open={open}\n    >\n      <DialogTitle disableTypography className={classes.dlgTitleContainer}>\n        <Typography variant='h5' className={classes.dlgTitle}>\n          Photo Properties\n        </Typography>\n        <IconButton onClick={onCancel}>\n          <CloseIcon />\n        </IconButton>\n      </DialogTitle>\n      <DialogContent>\n        <PhotoInfoInner\n          photo={photo}\n          delta={delta}\n          onChange={newDelta => setDelta({ ...delta, ...newDelta })}\n          canEdit={canEdit}\n        />\n      </DialogContent>\n\n      <DialogActions>\n        {!canEdit && (\n          <Button onClick={onCancel} color='primary'>\n            Ok\n          </Button>\n        )}\n        {canEdit && !dirty && (\n          <Button onClick={onCancel} color='primary'>\n            Back\n          </Button>\n        )}\n        {canEdit && dirty && (\n          <React.Fragment>\n            <Button onClick={() => setActiveDialog(DIALOGS.CANCEL)} color='primary'>\n              Cancel\n            </Button>\n            <Button onClick={() => setDelta({})} color='primary'>\n              Reset\n            </Button>\n            <Button onClick={() => onOk(delta)} color='primary'>\n              Ok\n            </Button>\n          </React.Fragment>\n        )}\n      </DialogActions>\n      {activeDialog && activeDialog === DIALOGS.CANCEL && (\n        <CancelConfirm\n          open\n          title='Lose unsaved changes?'\n          message='You will lose any changes you made to this form'\n          onConfirm={confirm => {\n            setActiveDialog(null)\n            if (confirm) onCancel()\n          }}\n        />\n      )}\n    </Dialog>\n  )\n}\n\nPhotoInfo.propTypes = {\n  canEdit: PropTypes.bool,\n  onCancel: PropTypes.func.isRequired,\n  onOk: PropTypes.func.isRequired,\n  open: PropTypes.bool,\n  photo: PropTypes.object.isRequired\n}\n\nexport default PhotoInfo\n","import React, { useState, useContext } from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\n\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport Button from '@material-ui/core/Button'\nimport MobileStepper from '@material-ui/core/MobileStepper'\nimport Typography from '@material-ui/core/Typography'\nimport AppBar from '@material-ui/core/AppBar'\nimport Toolbar from '@material-ui/core/Toolbar'\nimport IconButton from '@material-ui/core/IconButton'\nimport Badge from '@material-ui/core/Badge'\nimport Chip from '@material-ui/core/Chip'\n\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack'\nimport InfoIcon from '@material-ui/icons/Info'\nimport LabelIcon from '@material-ui/icons/Label'\n\nimport { makeStyles, useTheme } from '@material-ui/core/styles'\n\nimport PhotoInfo from './subViews/PhotoInfo'\nimport Photo from './subViews/Photo'\n\nimport { formatDate } from '../../../lib/datelib'\nimport Tags from '../../../lib/Tags'\nimport SwipeableViews from 'react-swipeable-views'\nimport { SeriesContext } from '../contexts'\n\nimport style from './PhotoViewTool.style'\nconst useStyles = makeStyles(style)\n\nconst STATES = {\n  VIEWPIC: 0,\n  SHOWINFO: 1,\n  SHOWTAGS: 2,\n  EDITTAGS: 3,\n  FIRSTAGEDIT: 4\n}\n\nconst PhotoViewTool = ({ photos, initPhotoId, onMenuBack, onUpdatePhoto, newPhoto }) => {\n  const classes = useStyles()\n  const theme = useTheme()\n  const { series, seriesConfig, ac } = useContext(SeriesContext)\n  const sortedPhotos = [...photos]\n  sortedPhotos.sort((a, b) => parseInt(b.takenOn, 10) - parseInt(a.takenOn, 10))\n  const [activePhoto, setActivePhoto] = useState(initPhotoId ? sortedPhotos.findIndex(p => p.id === initPhotoId) : 0)\n  // This is a special copy of the photo so we can play around with the XY tags and undo\n  // if we need to\n  const photo = photos[activePhoto]\n  const [delta, setDelta] = useState(newPhoto ? photo : {})\n  const [mode, setMode] = useState({\n    current: newPhoto ? STATES.FIRSTAGEDIT : STATES.VIEWPIC,\n    last: null\n  })\n\n  const tagsClass = new Tags(seriesConfig, delta.tags || photo.tags)\n\n  const changeMode = (desired) => {\n    setMode({ current: desired, last: mode.current })\n  }\n\n  const onCommitTags = () => {\n    changeMode(STATES.SHOWTAGS)\n    onUpdatePhoto(photo, { id: photo.id, ...delta })\n  }\n\n  const onCommitTagsFirst = () => {\n    onUpdatePhoto(photo, { id: photo.id, ...delta })\n    onMenuBack()\n  }\n\n  const onCancelTagEdit = () => {\n    changeMode(STATES.SHOWTAGS)\n    setDelta(photo)\n  }\n\n  const photoClick = (e) => {\n    if (mode.current === STATES.VIEWPIC) {\n      e.preventDefault()\n      e.stopPropagation()\n      changeMode(STATES.SHOWINFO)\n    }\n  }\n\n  const can = {\n    update: ac.canUser('update', series, 'series') ||\n            ac.canUser('update', photo, 'photo')\n  }\n\n  return (\n    <div className={classes.root}>\n      <CssBaseline /> {/* You only need this in a root element. Don't put it anywhere else in the dom */}\n      <AppBar position='static' className={classNames(classes.appBar, mode.current !== STATES.VIEWPIC ? classes.appBarEdit : null)}>\n        <Toolbar>\n          {mode.current !== STATES.FIRSTAGEDIT && (\n            <IconButton\n              className={classes.menuButton}\n              color='inherit'\n              aria-label='Menu'\n              onClick={() => onMenuBack()}\n            >\n              <ArrowBackIcon />\n            </IconButton>\n          )}\n          <div className={classes.grow}>\n            <Typography variant='subtitle2' color='inherit' >\n              {newPhoto ? 'Add Tags' : `Photo View (${activePhoto + 1}/${photos.length})`}\n            </Typography>\n            <Typography variant='subtitle2' color='inherit'>\n              {formatDate(photo.takenOn, 'lll')}\n            </Typography>\n          </div>\n\n          { mode.current === STATES.EDITTAGS &&\n          <Button color='inherit' onClick={onCancelTagEdit}>\n            Cancel\n          </Button>\n          }\n\n          { mode.current === STATES.EDITTAGS &&\n          <Button color='inherit' onClick={onCommitTags}>\n            Save\n          </Button>\n          }\n          { mode.current === STATES.FIRSTAGEDIT &&\n          <Button color='inherit' onClick={onCommitTagsFirst}>\n            Next\n          </Button>\n          }\n\n          { can.update && mode.current === STATES.SHOWTAGS &&\n          <Button color='inherit' onClick={() => changeMode(STATES.EDITTAGS)}>\n            Edit\n          </Button>\n          }\n\n          { (mode.current !== STATES.EDITTAGS && mode.current !== STATES.FIRSTAGEDIT) &&\n          <IconButton color='inherit'\n            className={classNames(classes.tagButton, mode.current === STATES.SHOWTAGS && classes.activeButton)}\n            onClick={() => changeMode(mode.current === STATES.SHOWTAGS ? STATES.VIEWPIC : STATES.SHOWTAGS)}\n          >\n            <Badge className={classes.margin} badgeContent={tagsClass.getXYTags().length} color='primary'>\n              <LabelIcon color='inherit' />\n            </Badge>\n          </IconButton>\n          }\n\n          { (mode.current !== STATES.EDITTAGS && mode.current !== STATES.FIRSTAGEDIT) &&\n          <IconButton color='inherit'\n            className={classNames(classes.infoButton, mode.current === STATES.SHOWINFO && classes.activeButton)}\n            onClick={() => changeMode(mode.current === STATES.SHOWINFO ? STATES.VIEWPIC : STATES.SHOWINFO)}\n          >\n            <InfoIcon />\n          </IconButton>\n          }\n\n        </Toolbar>\n      </AppBar>\n      <div className={classes.inner} onClick={photoClick}>\n        <SwipeableViews\n          axis={theme.direction === 'rtl' ? 'x-reverse' : 'x'}\n          index={activePhoto}\n          containerStyle={{ height: '100%' }}\n          style={{ height: '100%' }}\n          disabled={mode.current !== STATES.VIEWPIC}\n          onChangeIndex={(val) => setActivePhoto(val)}\n          enableMouseEvents\n        >\n          {sortedPhotos.map((photoidx, idx) => (\n            <div className={classes.photoWrapper} key={`swipeshowpic-${idx}`}>\n              <Photo\n                showTags={mode.current === STATES.SHOWTAGS}\n                photo={{ ...photoidx, ...delta }}\n                edit={can.update && (mode.current === STATES.EDITTAGS || mode.current === STATES.FIRSTAGEDIT)}\n                onChange={setDelta}\n                onCommitTags={onCommitTags}\n              />\n            </div>\n          ))}\n        </SwipeableViews>\n\n        {mode.current === STATES.VIEWPIC && (\n          <MobileStepper\n            steps={sortedPhotos.length}\n            position='bottom'\n            activeStep={activePhoto}\n            classes={{\n              root: classes.mobileStepper,\n              dots: classes.dots,\n              dot: classes.dot,\n              dotActive: classes.dotActive\n            }}\n          />\n        )}\n      </div>\n      <PhotoInfo\n        open={mode.current === STATES.SHOWINFO}\n        photo={photo}\n        canEdit={can.update}\n        onOk={(newDelta) => {\n          onUpdatePhoto(photo, { id: photo.id, ...newDelta })\n          changeMode(mode.last)\n        }}\n        onCancel={() => changeMode(mode.last)}\n      />\n      { (mode.current === STATES.EDITTAGS || mode.current === STATES.FIRSTAGEDIT) && (\n        <Chip\n          label='Tap to tag features...'\n          onClick={() => {}}\n          className={classes.tipChip}\n        />\n      )}\n    </div>\n  )\n}\n\nPhotoViewTool.propTypes = {\n  photos: PropTypes.array.isRequired,\n  initPhotoId: PropTypes.string,\n  newPhoto: PropTypes.bool,\n  // Now some action functions\n  onMenuBack: PropTypes.func.isRequired,\n  onUpdatePhoto: PropTypes.func.isRequired\n}\n\nexport default PhotoViewTool\n","export default theme => ({\n  root: {\n    display: 'flex',\n    height: '100%',\n    flexDirection: 'column',\n    overflow: 'hidden'\n  },\n  appBar: {\n    flexGrow: 0\n  },\n  appBarEdit: {\n    color: theme.palette.secondary.contrastText,\n    background: theme.palette.secondary.main\n  },\n  grow: {\n    flexGrow: 1\n  },\n  photoWrapper: {\n    height: '100%'\n  },\n  inner: {\n    flex: '1 1',\n    position: 'relative'\n  },\n  tabMenu: {\n    marginTop: theme.spacing(7)\n  },\n  tipChip: {\n    position: 'absolute',\n    zIndex: 11,\n    bottom: 20,\n    left: '50%',\n    opacity: 0.6,\n    transform: 'translateX(-50%)'\n  },\n  mobileStepper: {\n    background: 'none'\n  },\n  dots: {\n    margin: '0 auto'\n  },\n  dot: {\n    border: '1px solid #FFFFFF77'\n  },\n  dotActive: {\n    background: theme.palette.secondary.main\n  },\n  // tagButton: {\n  //   zIndex: 10,\n  //   color: 'white',\n  //   position: 'absolute',\n  //   fontSize: '2.5rem',\n  //   top: 10,\n  //   left: 10,\n  //   opacity: 0.8\n  // },\n  // infoButton: {\n  //   zIndex: 10,\n  //   color: 'white',\n  //   position: 'absolute',\n  //   top: 10,\n  //   right: 10,\n  //   opacity: 0.8\n  // },\n  activeButton: {\n    color: theme.palette.primary.main,\n    opacity: 1\n  }\n})\n","import AccessControl from 'accesscontrol'\n\nclass AccessHelper {\n  constructor (userSub, role, permissionObj) {\n    this.userSub = userSub\n    this.role = role\n    this.permissionObj = permissionObj\n    this.ac = new AccessControl(permissionObj)\n  }\n\n  // Return the string 'Own' or the string 'Any'\n  ownOrAny = (obj) => {\n    if (!obj || !obj.createdUser || !obj.createdUser.id) throw new Error(`No Created user found`)\n    try {\n      return obj.createdUser.id === this.userSub ? 'Own' : 'Any'\n    }\n    catch (e) {\n      return 'Any'\n    }\n  }\n\n  isOwner = (obj) => {\n    if (!obj || !obj.createdUser || !obj.createdUser.id) throw new Error(`No Created user found`)\n    try {\n      return obj.createdUser.id === this.userSub\n    }\n    catch (e) {\n      return false\n    }\n  }\n\n  toString () {\n    console.log('AccessHelper:', { sub: this.userSub, role: this.role })\n  }\n\n  canUser = (action, obj, type, attrs) => {\n    if (['series', 'photo'].indexOf(type) < 0) throw new Error(`canUser: type not supported ${type}`)\n\n    try {\n      const ownAny = this.ownOrAny(obj)\n\n      const perm = this.ac.can(this.role)[`${action}${ownAny}`](type)\n      let otherPerm = null\n      if (type === 'series') {\n        if (obj.access === 'PUBLIC') otherPerm = this.ac.can(this.role)[`${action}${ownAny}`]('series_public')\n        else if (obj.access === 'OPEN') otherPerm = this.ac.can(this.role)[`${action}${ownAny}`]('series_open')\n      }\n\n      // Trying to recreate the form `can(role).readAny`\n      if (attrs) {\n        if (otherPerm) {\n          return !!perm.attributes.find(p => p === '*' || attrs.indexOf(p) > -1) ||\n           !!otherPerm.attributes.find(p => p === '*' || attrs.indexOf(p) > -1)\n        }\n        else return !!perm.attributes.find(p => p === '*' || attrs.indexOf(p) > -1)\n      }\n      else {\n        if (otherPerm) return perm.granted || otherPerm.granted\n        else return perm.granted\n      }\n    }\n    catch (e) {\n      console.error(e)\n      return false\n    }\n  }\n}\n\nexport default AccessHelper\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport AppBar from '@material-ui/core/AppBar'\nimport Toolbar from '@material-ui/core/Toolbar'\nimport IconButton from '@material-ui/core/IconButton'\nimport Typography from '@material-ui/core/Typography'\n\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport style from './SeriesView.style'\nconst useStyles = makeStyles(style)\n\nconst SeriesNotFound = ({ onMenuBack }) => {\n  const classes = useStyles()\n\n  return (\n    <div className={classes.root}>\n      <CssBaseline />\n      <AppBar position='static' className={classes.appBar}>\n        <Toolbar disableGutters>\n          <IconButton className={classes.menuButton} color='inherit' onClick={onMenuBack} aria-label='Menu'>\n            <ArrowBackIcon />\n          </IconButton>\n          <Typography variant='subtitle1' color='inherit' className={classes.toolbarTitle}>\n            Series\n          </Typography>\n        </Toolbar>\n      </AppBar>\n\n      <div className={classes.placeholderInner}>\n        <div className={classes.grow} />\n        <Typography className={classes.placeholderText} variant='h3'>\n            Series not found\n        </Typography>\n        <div className={classes.grow} />\n      </div>\n    </div>\n  )\n}\n\nSeriesNotFound.propTypes = {\n  // Action functions\n  onMenuBack: PropTypes.func.isRequired\n}\n\nexport default SeriesNotFound\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport AppBar from '@material-ui/core/AppBar'\nimport Toolbar from '@material-ui/core/Toolbar'\nimport IconButton from '@material-ui/core/IconButton'\nimport Typography from '@material-ui/core/Typography'\nimport CircularProgress from '@material-ui/core/CircularProgress'\n\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport style from './SeriesView.style'\nconst useStyles = makeStyles(style)\n\nconst SeriesLoading = ({ onMenuBack }) => {\n  const classes = useStyles()\n\n  return (\n    <div className={classes.root}>\n      <CssBaseline />\n      <AppBar position='static' className={classes.appBar}>\n        <Toolbar disableGutters>\n          <IconButton className={classes.menuButton} color='inherit' onClick={onMenuBack} aria-label='Menu'>\n            <ArrowBackIcon />\n          </IconButton>\n          <Typography variant='subtitle1' color='inherit' className={classes.toolbarTitle}>\n            Series\n          </Typography>\n        </Toolbar>\n      </AppBar>\n\n      <div className={classes.placeholderInner}>\n        <div className={classes.grow} />\n        <div className={classes.progressWrapper}>\n          <CircularProgress className={classes.progress} color='inherit' size={150} thickness={5} />\n        </div>\n        <Typography className={classes.placeholderText} variant='h4'>\n            Loading...\n        </Typography>\n        <div className={classes.grow} />\n      </div>\n    </div>\n  )\n}\n\nSeriesLoading.propTypes = {\n  // Action functions\n  onMenuBack: PropTypes.func.isRequired\n}\n\nexport default SeriesLoading\n","import React, { useState, useEffect } from 'react'\nimport PropTypes from 'prop-types'\n\nimport SeriesView from './views/SeriesView'\nimport SeriesEdit from './views/SeriesEdit'\nimport Slideshow from './views/Slideshow'\nimport PhotoViewTool from './views/PhotoViewTool'\nimport NewPhoto from './views/NewPhoto'\nimport { setEntry } from '../../lib/localdb' // get, setEntry\nimport AccesHelper from '../../lib/AccessHelper'\n\nimport { SeriesContext } from './contexts'\nimport SeriesNotFound from './views/SeriesNotFound'\nimport SeriesLoading from './views/SeriesLoading'\n\nexport const MODES = {\n  SERIES_VIEW: 'series',\n  SERIES_EDIT: 'editseries',\n  NEWPHOTO: 'newphoto',\n  NEWSERIES: 'newseries',\n  REVIEW: 'review',\n  PHOTO_VIEW: 'photoviewer',\n  PHOTO_VIEW_NEW: 'newphotoviewer',\n  SLIDESHOW: 'slideshow'\n}\nconst VIEW_ONLY_MODES = [MODES.SERIES_VIEW, MODES.PHOTO_VIEW, MODES.SLIDESHOW]\nconst VALID_STARTMODES = [MODES.SERIES_VIEW, MODES.NEWPHOTO, MODES.NEWSERIES, MODES.PHOTO_REVIEW, MODES.PHOTO_VIEW]\n\n/**\n * This component ties all the Repeat Photo components together\n */\nconst RepeatablePhotos = ({\n  modeName, series, seriesConfig, inputMethod: inputMethodINIT,\n  currentUserId, currentUserRole, accessControl, initialPhoto,\n  onChange, onClose, onDelete, onNewSeries, onChangePhoto,\n  onNewPhoto, onDeletePhoto, loading,\n  onWatch, onUnWatch, watching, owned\n}) => {\n  // Manage view modes separately\n  // This is a pretty normal pattern for context\n  const [seriesState, setState] = useState({\n    series,\n    seriesConfig,\n    ac: accessControl ? new AccesHelper(currentUserId, currentUserRole, accessControl) : null\n  })\n\n  const [mode, setMode] = useState({\n    current: {\n      name: modeName || MODES.SERIES_VIEW,\n      pid: initialPhoto,\n      inputMethod: inputMethodINIT\n    },\n    history: []\n  })\n\n  useEffect(() => {\n    setState({ ...seriesState, series })\n    setMode({\n      current: {\n        name: modeName || MODES.SERIES_VIEW,\n        pid: initialPhoto,\n        inputMethod: inputMethodINIT\n      },\n      history: []\n    })\n  }, [series])\n\n  // When anything changes about a photo\n  const onUpdatePhoto = (photo, photoDelta) => {\n    const newSeries = { ...seriesState.series }\n    newSeries.photos = newSeries.photos.map(ph => ph.id === photoDelta.id ? { ...ph, ...photoDelta } : ph)\n    onChangePhoto(photo, { ...photoDelta, seriesId: newSeries.id })\n  }\n\n  const onApprovePhoto = async ({ photo: { base64, ...photoDelta }, series: seriesDelta }) => {\n    const newSeries = {\n      ...series,\n      photos: [...series.photos, photoDelta]\n    }\n    const ext = base64.split(';')[0].split('/')[1]\n    await setEntry(photoDelta.id, base64)\n    await onNewPhoto(photoDelta, ext)\n\n    setState({ ...seriesState, series: newSeries })\n    changeMode(MODES.PHOTO_VIEW_NEW, photoDelta.id)\n  }\n\n  const onCreateSeries = async ({ photo: { base64, ...photoDelta }, series: seriesDelta }) => {\n    console.log('RepeatablePhotos: waiting for series ID', { seriesDelta, photoDelta })\n    const ext = base64.split(';')[0].split('/')[1]\n    await setEntry(photoDelta.id, base64)\n    const onNewSeriesReturn = await onNewSeries(seriesDelta, photoDelta, ext)\n    console.log('RepeatablePhotos: waiting for series ID DONE', onNewSeriesReturn)\n  }\n\n  // When a photo is removed\n  const onDeletePhotos = (photoIdArr) => {\n    series.photos.filter(sp => photoIdArr.indexOf(sp.id) > -1).forEach(p => onDeletePhoto(p))\n  }\n\n  // Here's our modeChanger. My guess it will get a lot more complicated\n  // once the reducers get in and working\n  const changeMode = (newModeName, newPid, newInputMethod) => {\n    const canUpdate = seriesState.ac.canUser('update', series, 'series')\n    if (seriesState === null) onClose()\n    if (!canUpdate && VIEW_ONLY_MODES.indexOf(newModeName) < 0) {\n      console.error('ILLEGAL MODE CHANGE!!!!!', { from: mode.current, to: newModeName, canUpdate })\n    }\n    else {\n      // console.log('CHANGING MODE TO', newModeName)\n      setMode({\n        current: {\n          name: newModeName,\n          pid: newPid,\n          inputMethod: newInputMethod\n        },\n        history: [...mode.history, mode.current]\n      })\n    }\n  }\n  const lastMode = () => {\n    // console.log('REPEATABLEPHOTOS lastMode', mode)\n    if (mode.history.length > 0) {\n      const oldHistory = [...mode.history]\n      const oldMode = oldHistory.pop()\n      setMode({\n        current: oldMode,\n        history: oldHistory\n      })\n    }\n    else {\n      onClose()\n    }\n  }\n\n  // The action to initiate the photo viewer\n  const viewPhoto = (pid) => {\n    // console.log('DEBUG', mode, series.photos.find(p => p.id === pid))\n    changeMode(MODES.PHOTO_VIEW, pid)\n  }\n\n  let component = null\n\n  if (loading) return <SeriesLoading onMenuBack={onClose} />\n  else if (!seriesState.series && mode.current.name !== MODES.NEWSERIES) return <SeriesNotFound onMenuBack={onClose} />\n\n  switch (mode.current.name) {\n    case MODES.SERIES_VIEW:\n      component = (\n        <SeriesView\n          // This one has lots of functionsgit add\n          onSlideshowStart={() => changeMode(MODES.SLIDESHOW)}\n          onChange={() => {\n            console.log('onChange NOT IMPLEMENTED')\n          }}\n          watching={watching}\n          owned={owned}\n          initialPhoto={initialPhoto}\n          onDeletePhotos={onDeletePhotos}\n          onDeleteSeries={onDelete}\n          onCameraAdd={() => changeMode(MODES.NEWPHOTO, null, 'camera')}\n          onEditSeries={() => changeMode(MODES.SERIES_EDIT)}\n          onLibraryAdd={() => changeMode(MODES.NEWPHOTO, null, 'library')}\n          onTileClick={viewPhoto}\n          onMenuBack={onClose}\n          onWatch={onWatch}\n          onUnWatch={onUnWatch}\n        />\n      )\n      break\n    case MODES.SERIES_EDIT:\n      component = (\n        <SeriesEdit\n          onCancel={() => changeMode(MODES.SERIES_VIEW)}\n          onOk={(seriesDelta) => {\n            onChange(series, { ...seriesDelta, id: series.id })\n            changeMode(MODES.SERIES_VIEW)\n          }}\n        />\n      )\n      break\n    case MODES.PHOTO_VIEW:\n      component = (\n        <PhotoViewTool\n          photos={seriesState.series.photos}\n          initPhotoId={mode.current.pid}\n          onMenuBack={lastMode}\n          onUpdatePhoto={onUpdatePhoto}\n        />\n      )\n      break\n    case MODES.PHOTO_VIEW_NEW:\n      component = (\n        <PhotoViewTool\n          photos={seriesState.series.photos}\n          initPhotoId={mode.current.pid}\n          newPhoto\n          onMenuBack={() => changeMode(MODES.SERIES_VIEW)}\n          onUpdatePhoto={onUpdatePhoto}\n        />\n      )\n      break\n    case MODES.SLIDESHOW:\n      component = (\n        <Slideshow photos={seriesState.series.photos} onCancel={lastMode} />\n      )\n      break\n    case MODES.NEWPHOTO:\n      component = (\n        <NewPhoto\n          inputMethod={mode.current.inputMethod}\n          photos={series ? series.photos : null}\n          onCreate={onApprovePhoto}\n          onCancel={lastMode}\n        />\n      )\n      break\n    case MODES.NEWSERIES:\n      component = (\n        <NewPhoto\n          inputMethod={mode.current.inputMethod}\n          isNewSeries\n          onCreate={onCreateSeries}\n          onCancel={lastMode}\n        />\n      )\n      break\n    default:\n      console.log('REPEATABLEPHOTO: default state. you should NEVER see this', seriesState)\n      component = null\n  }\n\n  return (\n    <SeriesContext.Provider value={seriesState}>\n      {component}\n    </SeriesContext.Provider>\n  )\n}\n\nRepeatablePhotos.propTypes = {\n  modeName: PropTypes.oneOf(VALID_STARTMODES),\n  seriesConfig: PropTypes.object.isRequired,\n  watching: PropTypes.bool,\n  owned: PropTypes.bool,\n\n  currentUserId: PropTypes.string,\n  currentUserRole: PropTypes.string,\n  accessControl: PropTypes.object,\n\n  inputMethod: PropTypes.oneOf(['camera', 'library']),\n  series: PropTypes.object,\n  initialPhoto: PropTypes.string,\n  loading: PropTypes.bool,\n\n  // Now some functions to handle actions we might take\n  onChange: PropTypes.func.isRequired,\n  onChangePhoto: PropTypes.func.isRequired,\n  onDeletePhoto: PropTypes.func.isRequired,\n  onNewPhoto: PropTypes.func.isRequired,\n  onNewSeries: PropTypes.func.isRequired,\n  onDelete: PropTypes.func.isRequired,\n  onClose: PropTypes.func.isRequired,\n  onWatch: PropTypes.func,\n  onUnWatch: PropTypes.func\n\n}\nRepeatablePhotos.defaultProps = {\n  mode: MODES.SERIES_VIEW\n}\n\nexport default RepeatablePhotos\n","import React, { useContext } from 'react'\nimport PropTypes from 'prop-types'\nimport { home } from '../config'\nimport permissions from '../permissions'\nimport { graphql, compose } from 'react-apollo'\nimport { connect } from 'react-redux'\nimport actions from '../redux/actions'\nimport { getWholeSeries, allSeries, getUser, getMyFeed } from './queries'\nimport { deletePhoto, deleteSeries, updateSeries, createPhoto, createSeries, updatePhoto, watchSeries, unWatchSeries } from './mutations'\nimport RepeatablePhotos, { MODES } from '../components/PhotoSeries'\nimport { hasKey, deleteEntry } from '../lib/localdb' // get, setEntry\nimport { AppContext } from '../contexts'\n\nimport { ThemeProvider } from '@material-ui/styles'\nimport themes from '../themes'\n\nconst SeriesConnect = ({\n  series, loading, domain, activeSeries, initialPhoto,\n  onAfterSeriesDelete, onBack, queueUpload,\n  createSeriesMutation, createPhotoMutation,\n  updateSeriesMutation, updatePhotoMutation,\n  deleteSeriesMutation, deletePhotoMutation,\n  watchSeriesMutation, unWatchSeriesMutation\n}) => {\n  const { role, currentUser, seriesConfig, user, signedIn } = useContext(AppContext)\n  let inputMethod = 'camera'\n  // Hack until we can get good loading object sorted\n  if (domain === home.AppStateTypes.NEW_SERIES_CAMERA) inputMethod = 'camera'\n  else if (domain === home.AppStateTypes.NEW_SERIES_LIBRARY) inputMethod = 'library'\n\n  // console.log('SeriesConnect', { series, loading, currentState, activeSeries, role, currentUser })\n  let modeName = MODES.SERIES_VIEW\n  if (domain !== home.AppStateTypes.SERIES) modeName = MODES.NEWSERIES\n\n  console.log('[SERIESCONNECT]', { series, loading })\n  return (\n    <ThemeProvider theme={themes.series}>\n      <RepeatablePhotos\n        modeName={modeName}\n        inputMethod={inputMethod}\n\n        owned={signedIn && user && series && user.id === series.id}\n        watching={signedIn && user && user.watching && user.watching.indexOf(activeSeries) > -1}\n\n        // Everything we need to determine access\n        currentUserId={signedIn ? currentUser.attributes.sub : null}\n        currentUserRole={role}\n        accessControl={permissions}\n        loading={loading}\n        series={series}\n        initialPhoto={initialPhoto}\n        seriesConfig={seriesConfig}\n        // Now some functions to handle actions we might take\n        onNewPhoto={(newPhoto, ext) => {\n          console.log('onNewPhoto::', { newPhoto, ext })\n          return createPhotoMutation(newPhoto, ext, series)\n            .then(({ data }) => {\n              // Don't start an upload until you get back a proper id\n              if (data.createPhoto.preAuth) {\n                const preAuth = JSON.parse(data.createPhoto.preAuth)\n                console.log('PREAUTH::', data.createPhoto.preAuth)\n                queueUpload({\n                  id: newPhoto.id,\n                  seriesId: data.createPhoto.seriesId,\n                  preAuth,\n                  ext\n                })\n              }\n              return data\n            })\n            .catch(err => {\n              console.log('onNewPhoto:: Graphql Error', err.stack)\n              console.error(err)\n            })\n        }}\n        onChangePhoto={(photo, photoDelta) => updatePhotoMutation(photo, photoDelta)\n          .catch(err => {\n            console.log('onChangePhoto:: Graphql Error', err.stack)\n            console.error(err)\n          })\n        }\n        onDeletePhoto={(photo) => deletePhotoMutation(photo.id)\n          .then((...data) => {\n            console.log('onDeletePhoto:: photo deleted', data)\n          })\n          .catch(err => {\n            console.log('onDeletePhoto:: Graphql Error', err.stack)\n            console.error(err)\n          })\n        }\n        onChange={(series, seriesDelta) => updateSeriesMutation(series, seriesDelta)\n          .catch(err => {\n            console.log('onChange:: Graphql Error', err.stack)\n            console.error(err)\n          })\n        }\n        onNewSeries={(newSeries, newPhoto, ext) => {\n          console.log('Series.connect:: onNewSeries starting', { newSeries, photoNoId: newPhoto })\n          return createSeriesMutation(newSeries)\n            .then(async ({ data }) => {\n              console.log('Series.connect:: done createSeriesMutation', data)\n              const { data: photoData } = await createPhotoMutation({ ...newPhoto, seriesId: data.createSeries.id }, ext, data.createSeries)\n\n              console.log('Series.connect:: done createPhotoMutation', photoData)\n              const preAuth = JSON.parse(photoData.createPhoto.preAuth)\n              console.log('Series.connect:: PREAUTH', photoData.createPhoto.preAuth)\n              queueUpload({\n                id: newPhoto.id,\n                seriesId: photoData.createPhoto.seriesId,\n                preAuth,\n                ext\n              })\n              return data\n            })\n            .catch(err => {\n              console.log('onNewSeries:: Graphql Error', err.stack)\n              console.error(err)\n            })\n        }}\n        onDelete={() => deleteSeriesMutation()\n          .then(onAfterSeriesDelete)\n          .catch(err => {\n            console.log('onDelete:: Graphql Error', err.stack)\n            console.error(err)\n          })\n        }\n        onClose={onBack}\n        onWatch={signedIn ? watchSeriesMutation : null}\n        onUnWatch={signedIn ? unWatchSeriesMutation : null}\n      />\n    </ThemeProvider>\n  )\n}\nSeriesConnect.propTypes = {\n  domain: PropTypes.string,\n  activeSeries: PropTypes.string,\n  initialPhoto: PropTypes.string,\n\n  // From Redux\n  onAfterSeriesDelete: PropTypes.func,\n  queueUpload: PropTypes.func,\n  onBack: PropTypes.func,\n\n  // Data from apollo\n  series: PropTypes.object,\n\n  // Functions From Apollo\n  loading: PropTypes.bool,\n  updateSeriesMutation: PropTypes.func,\n  updatePhotoMutation: PropTypes.func,\n  deleteSeriesMutation: PropTypes.func,\n  deletePhotoMutation: PropTypes.func,\n  createSeriesMutation: PropTypes.func,\n  createPhotoMutation: PropTypes.func,\n  watchSeriesMutation: PropTypes.func,\n  unWatchSeriesMutation: PropTypes.func\n}\n\n/**\n * Here's the graphql HOC that gets an individual series\n */\nconst withGetSelectedQuery = graphql(getWholeSeries, {\n  props: ({ data }) => {\n    if (data.error) console.error(data.error)\n    console.log('getWholeSeries:: ', { data })\n    let series = null\n    try {\n      if (!data.loading && !data.error) series = data.series\n    }\n    catch (e) {\n      console.log('getWholeSeries:: error', { data, e })\n      console.error(e)\n    }\n    return {\n      data,\n      loading: data.loading,\n      series\n    }\n  },\n  skip: ({ activeSeries, isNewSeries }) => !activeSeries || isNewSeries,\n  options: ({ activeSeries }) => ({\n    variables: {\n      id: activeSeries\n    }\n  })\n})\n\nconst withUpdateSeriesMutation = graphql(updateSeries, {\n  props: ({ mutate, ownProps }) => ({\n    // We turn this into a thunk so we can handle the business logic here and not in a JSX region\n    updateSeriesMutation: (series, seriesDelta) => mutate({\n\n      variables: { series: sanitizeUpdateParams(seriesDelta, ['id', 'name', 'access', 'note', 'coords', 'direction']) },\n      optimisticResponse: {\n        updateSeries: {\n          ...series,\n          ...seriesDelta,\n          __typename: 'Series'\n        }\n      },\n      update: (store, { data }) => {\n        // console.log('withUpdateSeriesMutation start Manip:', JSON.stringify(data, null, 2))\n        const qdata = store.readQuery({ query: getWholeSeries, variables: { id: ownProps.activeSeries } })\n        qdata.series = { ...qdata.series, ...seriesDelta }\n        store.writeQuery({ query: getWholeSeries, data: qdata })\n        // console.log('withUpdateSeriesMutation Done Manip:', qdata)\n\n        // Update: allSeries\n        // We might not have called this query yet so let it throw if it wants\n        try {\n          const qdataAll = store.readQuery({ query: allSeries, variables: { limit: 100 } })\n          // console.log('withUpdateSeriesMutation qdataAll:', qdataAll)\n          const summary = sanitizeUpdateParams(seriesDelta, ['id', 'name', 'access', 'coords', 'direction'])\n          qdataAll.allSeries.seriesSummaries = qdataAll.allSeries.seriesSummaries.map(s => s.id !== summary.id\n            ? s\n            : { ...s, ...summary }\n          )\n          store.writeQuery({ query: allSeries, data: qdataAll })\n          // console.log('withUpdateSeriesMutation qdataAll WRITE:', qdataAll)\n        }\n        catch (e) { }\n      }\n    })\n  })\n})\n\nconst withUpdatePhotoMutation = graphql(updatePhoto, {\n  props: ({ mutate, ownProps }) => ({\n    // We turn this into a thunk so we can handle the business logic here and not in a JSX region\n    updatePhotoMutation: (photo, photoDelta) => {\n      const sanitizedPhotoDelta = sanitizeUpdateParams(photoDelta, [ 'id', 'seriesId', 'takenOn', 'tags', 'note' ])\n      if (sanitizedPhotoDelta.tags && sanitizedPhotoDelta.tags.length > 0) {\n        sanitizedPhotoDelta.tags = sanitizedPhotoDelta.tags.map(t => {\n          const newT = sanitizeUpdateParams(t, [ 'label', 'typeId', 'coords' ])\n          if (newT.coords) newT.coords = sanitizeUpdateParams(newT.coords, [ 'x', 'y' ])\n          return newT\n        })\n      }\n      // console.log('withUpdatePhotoMutation', sanitizedPHoto)\n      return mutate({\n\n        variables: { photo: sanitizedPhotoDelta },\n        optimisticResponse: {\n          updatePhoto: {\n            ...photo,\n            ...sanitizedPhotoDelta,\n            __typename: 'Photo'\n          }\n        },\n        update: (store, { data }) => {\n          // console.log('updatePhotoMutation start Manip:', JSON.stringify(data, null, 2))\n          const qdata = store.readQuery({ query: getWholeSeries, variables: { id: ownProps.activeSeries } })\n          // Gotta add Typenames\n          const updatedPhoto = {\n            ...sanitizedPhotoDelta,\n            tags: sanitizedPhotoDelta.tags ? sanitizedPhotoDelta.tags.map(t => {\n              const newT = { ...t, __typename: 'Tag' }\n              newT.coords = newT.coords ? { ...newT.coords, __typename: 'ImageCoords' } : null\n              return newT\n            }) : []\n          }\n          // console.log('updatePhotoMutation', updatedPhoto)\n          qdata.series.photos = qdata.series.photos.map(photo => photo.id !== photoDelta.id ? photo : { ...photo, ...updatedPhoto })\n\n          store.writeQuery({ query: getWholeSeries, data: qdata })\n          // console.log('updatePhotoMutation Manip:', { qdata })\n        }\n      })\n    }\n  })\n})\n\nconst withDeleteSeriesDeleteMutation = graphql(deleteSeries, {\n  props: ({ mutate, ownProps }) => {\n    return {\n      deleteSeriesMutation: () => mutate({\n        variables: { id: ownProps.activeSeries },\n        optimisticResponse: {\n          deleteSeries: ownProps.activeSeries\n        },\n        update: (store, { data }) => {\n          try {\n            const qdataAll = store.readQuery({ query: allSeries, variables: { limit: 100 } })\n            qdataAll.allSeries.seriesSummaries = qdataAll.allSeries.seriesSummaries.filter(s => s.id !== data.deleteSeries)\n            store.writeQuery({ query: allSeries, data: qdataAll })\n          }\n          catch (e) { }\n        }\n      })\n    }\n  }\n})\n\nconst withDeletePhotoMutation = graphql(deletePhoto, {\n  props: ({ mutate, ownProps }) => ({\n    // We turn this into a thunk so we can handle the business logic here and not in a JSX region\n    deletePhotoMutation: (photoId) => mutate({\n      variables: { seriesId: ownProps.series.id, photoId },\n      optimisticResponse: {\n        deletePhoto: photoId\n      },\n      update: (store, { data }) => {\n        console.log('deletePhotoMutation start Manip:', JSON.stringify(data, null, 2))\n        let finalCount = null\n\n        const qdata = store.readQuery({ query: getWholeSeries, variables: { id: ownProps.activeSeries } })\n        qdata.series.photos = qdata.series.photos.filter(photo => photo.id !== data.deletePhoto)\n\n        finalCount = qdata.series.photos.length\n        qdata.series.photoCount = finalCount\n        store.writeQuery({ query: getWholeSeries, data: qdata })\n        console.log('deletePhotoMutation start Manip WRITE:', qdata)\n\n        // Update: allSeries\n        // We might not have called this query yet so let it throw if it wants\n        try {\n          const qdataAll = store.readQuery({ query: allSeries, variables: { limit: 100 } })\n          console.log('deletePhotoMutation qdataAll:', qdataAll)\n          qdataAll.allSeries.seriesSummaries = qdataAll.allSeries.seriesSummaries.map(s => s.id !== data.deletePhoto\n            ? s\n            : { ...s, photoCount: finalCount !== null ? finalCount : s.photoCount }\n          )\n          store.writeQuery({ query: allSeries, data: qdataAll })\n          console.log('deletePhotoMutation qdataAll WRITE:', qdataAll)\n        }\n        catch (e) { }\n\n        console.log('Done Manip:', qdata.series.photos)\n      }\n    })\n  })\n})\n\nconst withCreateNewSeries = graphql(createSeries, {\n  props: ({ mutate, ownProps }) => {\n    return {\n      createSeriesMutation: (newSeries) => {\n        const { id, gravatar, gravatarProfile, username } = ownProps.user\n        const meUserSummary = { id, gravatar, gravatarProfile, username, __typename: 'UserSummary' }\n        if (!newSeries.access) newSeries.access = 'PRIVATE'\n        return mutate({\n          variables: { series: sanitizeUpdateParams(newSeries, ['name', 'note', 'access', 'coords', 'direction', 'meta']) },\n          optimisticResponse: {\n            'createSeries': {\n              'id': newSeries.id,\n              'name': newSeries.name,\n              'note': newSeries.note || null,\n              'access': newSeries.access,\n              'meta': newSeries.meta || null,\n              'featured': null,\n              'latest': null,\n              'coords': newSeries.coords || null,\n              'direction': newSeries.direction || null,\n              'photoCount': 0,\n              'photos': [],\n              'createdUser': meUserSummary,\n              'updatedUser': meUserSummary,\n              'createdBy': meUserSummary.id,\n              'updatedBy': meUserSummary.id,\n              'createdOn': Date.now().toString(),\n              'updatedOn': Date.now().toString(),\n              'watchers': 0,\n              __typename: 'Series'\n            }\n          },\n          update: (store, { data }) => {\n          //   // We need to write this query from scratch\n          //   console.log('createSeriesMutation:: STARTING TO CREATE THE SERIES', { data, store, ownProps })\n          //   // dumpLog(store.data, '##CACHE-NEW_SERIES_BEFORE')\n          //   try {\n          //     store.writeQuery({ query: getWholeSeries,\n          //       data: { series: data.createSeries }\n          //     })\n          //     console.log('createSeriesMutation:: Series write getWholeSeries', { series: data.createSeries })\n          //   }\n          //   catch (e) {\n          //     console.log('ERROR: createSeriesMutation:: updating getWholeSeries failed')\n          //   }\n\n            //   try {\n            //     const qdataAll = store.readQuery({ query: allSeries, variables: { limit: 100 } })\n            //     // console.log('createSeriesMutation qdataAll:', qdataAll)\n            //     const newAllSeriesEntry = sanitizeUpdateParams(data.createSeries, [\n            //       'id', 'name', 'access', 'updatedOn', 'updatedOn', 'createdUser', 'createdOn', 'featured',\n            //       'latest', 'coords', 'photoCount', 'seriesStatus', 'direction', 'watchers'\n            //     ])\n            //     qdataAll.allSeries.seriesSummaries.push(newAllSeriesEntry)\n            //     store.writeQuery({ query: allSeries, data: qdataAll })\n            //     // console.log('createSeriesMutation qdataAll WRITE:', qdataAll)\n            //   }\n\n            //   catch (e) {\n            //     // dumpLog(store.data, '##CACHE-NEW_SERIES_ERROR')\n            //     console.log('ERROR: createSeriesMutation:: updating allSeries failed')\n            //   }\n\n            // console.log('Series.connect: createSeriesMutation:: Setting new series id:', data.createSeries)\n            // ownProps.doneCreatingSeries(data.createSeries.id)\n          }\n        })\n      }\n    }\n  }\n})\n\nconst withCreateNewPhoto = graphql(createPhoto, {\n  props: ({ mutate, ownProps }) => {\n    return {\n      createPhotoMutation: (newPhoto, ext, series) => {\n        // When we're not creating a series the seriesId isn't passed in\n        // so we add it now\n        const { base64, ...newPhotoInput } = newPhoto\n        if (!newPhotoInput.seriesId && ownProps.activeSeries) {\n          newPhotoInput.seriesId = ownProps.activeSeries\n        }\n        const { id, gravatar, gravatarProfile, username } = ownProps.user\n        const meUserSummary = { id, gravatar, gravatarProfile, username, __typename: 'UserSummary' }\n\n        // Unfortunately we need to pass a token up to the server and back so we know what's been done\n        newPhotoInput.uploadToken = newPhoto.id\n        console.log('createPhotoMutation::', { newPhotoInput, ext, series })\n        return mutate({\n          variables: { photo: sanitizeUpdateParams(newPhotoInput, [ 'seriesId', 'takenOn', 'meta', 'coords', 'tags', 'note', 'uploadToken' ]), ext },\n          optimisticResponse: {\n            'createPhoto': {\n              'photo': {\n                'id': newPhotoInput.id,\n                'meta': newPhotoInput.meta || null,\n                'seriesId': newPhotoInput.seriesId,\n                'createdOn': Date.now().toString(),\n                'createdUser': meUserSummary,\n                'updatedUser': meUserSummary,\n                'createdBy': meUserSummary.id,\n                'updatedBy': meUserSummary.id,\n                'uploadToken': newPhotoInput.uploadToken,\n                'updatedOn': Date.now().toString(),\n                'seriesCreatedBy': series.createdUser.id, // we can't answer this yet\n                'takenOn': newPhotoInput.takenOn,\n                'coords': newPhotoInput.coords || null,\n                'tags': newPhotoInput.tags || [],\n                'paths': {\n                  base: null,\n                  large: null,\n                  orig: null,\n                  thumb: null,\n                  medium: null,\n                  __typename: 'Paths'\n                },\n                '__typename': 'Photo'\n              },\n              'preAuth': null,\n              '__typename': 'NewPhotoOutput'\n            }\n          },\n          update: async (store, { data }) => {\n            // // Update: getWholeSeries\n            // console.log('createPhotoMutation:: store.readQuery:', { data, store, ownProps })\n            // // Store this base64 in the db\n            // const testId = data.createPhoto.photo.uploadToken\n            // if (data.createPhoto.photo.id.indexOf('__LOCAL_') !== 0 && await hasKey(testId)) {\n            //   console.log('createPhotoMutation:: DEBUG Image has been uploaded. Wiping the DB')\n            //   deleteEntry(testId)\n            // }\n\n            // try {\n            //   const qdata = store.readQuery({ query: getWholeSeries, variables: { id: data.createPhoto.photo.seriesId } })\n            //   qdata.series.photos = qdata.series.photos = [...qdata.series.photos, data.createPhoto.photo]\n\n            //   store.writeQuery({ query: getWholeSeries, data: qdata })\n            // }\n            // catch (e) {\n            //   // This won't fire on new series and that's ok for now.\n            //   console.log('createPhotoMutation:: getWholeSeries ERROR')\n            // }\n\n            // // Update: allSeries\n            // // We might not have called this query yet so let it throw if it wants\n            // let qdataAll = null\n            // try {\n            //   qdataAll = store.readQuery({ query: allSeries, variables: { limit: 100 } })\n            //   console.log('createPhotoMutation:: qdataAll:', qdataAll)\n            //   qdataAll.allSeries.seriesSummaries = qdataAll.allSeries.seriesSummaries.map(s => s.id !== data.createPhoto.photo.seriesId\n            //     ? s\n            //     : { ...s, photoCount: s.photoCount + 1 }\n            //   )\n            //   store.writeQuery({ query: allSeries, data: qdataAll })\n            //   console.log('createPhotoMutation:: qdataAll: WRITE', qdataAll)\n            // }\n            // catch (e) {\n            //   console.log('createPhotoMutation:: allSeries ERROR')\n            // }\n          }\n        })\n      }\n    }\n  }\n})\n\nconst withWatchSeriesMutation = graphql(watchSeries, {\n  props: ({ mutate, ownProps }) => {\n    return {\n      watchSeriesMutation: () => mutate({\n        variables: { seriesId: ownProps.activeSeries },\n        optimisticResponse: {\n          watchSeries: ownProps.activeSeries\n        },\n        update: (store, { data }) => {\n          // TODO: modify the getuser query to add this to the list of favourites\n          // try {\n          const qdataAll = store.readQuery({ query: getUser })\n          qdataAll.user.watching = [...new Set([...qdataAll.user.watching || [], data.watchSeries])]\n          store.writeQuery({ query: getUser, data: qdataAll })\n\n          const qFeedData = store.readQuery({ query: getMyFeed })\n          console.log('DEBUG', qFeedData)\n          // qdataAll.user.watching = [...new Set([...qdataAll.user.watching || [], data.watchSeries])]\n          // store.writeQuery({ query: getUser, data: qdataAll })\n          // }\n          // catch (e) { }\n        }\n      })\n    }\n  }\n})\n\nconst withUnWatchSeriesMutation = graphql(unWatchSeries, {\n  props: ({ mutate, ownProps }) => {\n    return {\n      unWatchSeriesMutation: () => mutate({\n        variables: { seriesId: ownProps.activeSeries },\n        optimisticResponse: {\n          unWatchSeries: ownProps.activeSeries\n        },\n        update: (store, { data }) => {\n          // try {\n          const qdataAll = store.readQuery({ query: getUser })\n          qdataAll.user.watching = qdataAll.user.watching.filter(sid => sid !== data.unWatchSeries)\n          store.writeQuery({ query: getUser, data: qdataAll })\n          // }\n          // catch (e) { }\n        }\n      })\n    }\n  }\n})\n\n/**\n * Compose all our queries together\n */\nconst connectedWithApollo = compose(\n  withGetSelectedQuery,\n  withCreateNewSeries,\n  withCreateNewPhoto,\n  withUpdateSeriesMutation,\n  withUpdatePhotoMutation,\n  withDeleteSeriesDeleteMutation,\n  withDeletePhotoMutation,\n  withWatchSeriesMutation,\n  withUnWatchSeriesMutation\n)(SeriesConnect)\n\n/**\n * Map our redux state and functions\n */\nconst mapStateToProps = (state, props) => {\n  const { current: { activeSeries, initialPhoto, domain } } = state.home\n  return { activeSeries, initialPhoto, domain }\n}\n\nconst mapDispatchToProps = dispatch => ({\n  onBack: () => {\n    dispatch(actions.homeStateBack())\n  },\n  onAfterSeriesDelete: (key, newProgress) => {\n    dispatch(actions.setHomeState(home.AppStateTypes.FEED))\n  },\n  queueUpload: (uploadObj) => {\n    dispatch(actions.queueUpload(uploadObj))\n  },\n  doneCreatingSeries: (activeSeries) => {\n    dispatch(actions.setHomeState(home.AppStateTypes.SERIES, { activeSeries }))\n  }\n})\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(connectedWithApollo)\n\n/**\n * We need to filter out null values and params we don't desire\n */\nfunction sanitizeUpdateParams (inputObj, desiredParams) {\n  const newDesiredParams = [...desiredParams, '__typename']\n  const remainder = Object.keys(inputObj).filter(key => newDesiredParams.indexOf(key) > -1)\n  console.log('sanitizeUpdateParams', { orig: Object.keys(inputObj), remainder })\n  return remainder.reduce((acc, key) => ({ ...acc, [key]: inputObj[key] }), {})\n}\n","import { useState, useEffect, useCallback } from 'react'\nimport uuid from 'uuid/v4'\nimport WebMercatorViewport from 'viewport-mercator-project'\nimport rbush from 'rbush'\nimport { point, centroid, featureCollection } from '@turf/turf'\nimport { debounce } from './util'\n\nconst useClusteredData = (data, filterBounds, currentZoom, viewport, sizeScale, queryVersion) => {\n  const [clusteredData, setClusteredData] = useState([])\n  const [filteredData, setFilteredData] = useState({ single: [], cluster: [] })\n  const [version, setVersion] = useState(0)\n\n  // We promisify and debounce the expensive stuff so it runs outside our render loop\n  const updateDataDebounce = useCallback(debounce(async (...innerArgs) => {\n    const updatedData = await updateData(...innerArgs)\n    setClusteredData(updatedData)\n    // setClusteredData(updatedData)\n    setVersion(version + 1)\n  }, 1000), [])\n\n  const filterDataDebounce = useCallback(debounce(async (...innerArgs) => {\n    const filtered = await filterData(...innerArgs)\n    setFilteredData(filtered)\n  }, 300), [])\n\n  // Here's the really expensive call. Make sure this only runs when the data changes\n  useEffect(() => {\n    updateDataDebounce(data, sizeScale, viewport)\n  }, [data.length, queryVersion])\n\n  useEffect(() => {\n    filterDataDebounce(clusteredData, filterBounds, currentZoom)\n  }, [clusteredData, currentZoom, filterBounds, version])\n\n  return { filteredClusteredData: filteredData }\n}\n\nexport default useClusteredData\n\n// Compute icon clusters\n// We use the projected positions instead of longitude and latitude to build\n// the spatial index, because this particular dataset is distributed all over\n// the world, we can't use some fixed deltaLon and deltaLat\nconst updateData = (data, sizeScale, viewport) => {\n  // console.log('----------------------------------UPDATE CLUSTER----------------------------------', { data, sizeScale, viewport })\n\n  if (!data) {\n    return []\n  }\n  const tree = rbush(9, ['.x', '.y', '.x', '.y'])\n\n  const transform = new WebMercatorViewport({\n    ...viewport,\n    zoom: 0\n  })\n\n  // console.log('DATA', data)\n  // The root of this is GeoJSON so that's what we have to build\n  const newData = data.map(p => {\n    // Create some GeoJSON that we can render as a dot\n    let screenCoords = [0, 0]\n    try {\n      screenCoords = transform.project(p.coords)\n    }\n    catch (e) {\n      console.error(e)\n    }\n    const { longitude, latitude, ...properties } = p\n    return {\n      x: screenCoords[0],\n      y: screenCoords[1],\n      photoCount: properties.photoCount,\n      zoomLevels: [],\n      geoJSON: p.coords ? point(p.coords, { ...properties }) : null\n    }\n  })\n\n  tree.clear()\n  tree.load(newData)\n\n  for (let z = 0; z <= 20; z++) {\n    const radius = sizeScale / Math.sqrt(2) / Math.pow(2, z)\n    // const radius = 60 / Math.sqrt(2) / Math.pow(2, z)\n\n    newData.forEach(p => {\n      if (p.zoomLevels[z] === undefined) {\n        // this point does not belong to a cluster\n        const { x, y } = p\n\n        // find all points within radius that do not belong to a cluster\n        const neighbors = tree\n          .search({\n            minX: x - radius,\n            minY: y - radius,\n            maxX: x + radius,\n            maxY: y + radius\n          })\n          .filter(neighbor => neighbor.zoomLevels[z] === undefined)\n\n        // only show the center point at this zoom level\n        neighbors.forEach(neighbor => {\n          if (neighbor === p) {\n            const newGeoJSON = neighbors.length === 1\n              ? p.geoJSON\n              : centroid(featureCollection(neighbors.map(n => n.geoJSON)))\n\n            newGeoJSON.properties = {\n              ...newGeoJSON.properties,\n              id: newGeoJSON.properties.id || uuid(),\n              count: neighbors.length,\n              reducedPhotoCount: neighbors.reduce((acc, { photoCount }) => photoCount ? acc + photoCount : acc, 0),\n              points: neighbors.map(n => n.geoJSON)\n            }\n            p.zoomLevels[z] = newGeoJSON\n          }\n          else {\n            neighbor.zoomLevels[z] = null\n          }\n        })\n      }\n    })\n  }\n\n  // console.log('----------------------------------UPDATE CLUSTER DONE----------------------------------')\n  return newData.map(({ zoomLevels }) => zoomLevels)\n}\n\nfunction filterData (clusteredData, filterBounds, newZ) {\n  // console.log('----------------------------------FILTER CLUSTER----------------------------------', { clusteredData, filterBounds, newZ })\n\n  return clusteredData\n    // Filter out anything not relevant to this zoom level\n    .filter(d => !!d[newZ])\n    // Restructure the object to be a little more JSON-friendly\n    .reduce((acc, zoomLevels) => {\n      const geoJSON = zoomLevels[newZ]\n      const coords = geoJSON.geometry.coordinates\n      const { count } = geoJSON.properties\n\n      if (!filterBounds || filterBounds.length < 4 || (\n        filterBounds[0] < coords[0] && filterBounds[1] < coords[1] &&\n        filterBounds[2] > coords[0] && filterBounds[3] > coords[1]\n      )) {\n        if (count > 1) acc.cluster.push(geoJSON)\n        else acc.single.push(geoJSON)\n      }\n      return acc\n    }, {\n      single: [],\n      cluster: []\n    })\n}\n","export default theme => ({\n  root: {\n    position: 'relative',\n    height: '100%',\n    '& .myPosMarker': {\n      zIndex: 1\n    },\n    '& .singleMarker': {\n      zIndex: 3\n    },\n    '& .clusterMarker': {\n      zIndex: 2\n    }\n  },\n  fab: {\n    background: theme.palette.secondary.main,\n    color: theme.palette.secondary.contrastText\n  },\n  topBar: {\n    position: 'absolute',\n    zIndex: 1000,\n    top: 0\n  },\n  loadingWrapper: {\n    position: 'absolute',\n    color: theme.palette.text.primary,\n    opacity: 0.5,\n    zIndex: 3000,\n    textAlign: 'center',\n    top: '50%',\n    left: '50%',\n    transform: 'translateY(-50%) translateX(-50%)'\n  },\n  zoomOutFab: {\n    margin: theme.spacing(0.5),\n    padding: theme.spacing(0.5),\n    border: '2px solid',\n    borderRadius: theme.spacing(1),\n    background: theme.palette.common.white,\n    fontSize: 20,\n    position: 'absolute',\n    zIndex: 100,\n    bottom: theme.spacing(2),\n    right: theme.spacing(10)\n  },\n  selectedPopup: {\n    // padding: theme.spacing(0, 1, 0, 1),\n    width: '90%',\n    maxWidth: 400,\n    zIndex: 2000,\n    position: 'absolute',\n    bottom: theme.spacing(1),\n    left: '50%',\n    transformOrigin: '0% 50%',\n    transform: 'translateY(0%) translateX(-50%)'\n  }\n})\n","import React from 'react'\nimport createSvgIcon from '@material-ui/icons/utils/createSvgIcon'\n\nexport default createSvgIcon(\n  <React.Fragment>\n    <path d='M16.432,6.104c-2.671,-1.06 -6.842,4.123 -6.572,5.826c-3.78,-7.611 2.788,-8.409 3.682,-10.699c0.64,1.255 5.18,2.608 2.89,4.873Z' />\n    <path d='M9.159,5.228c-2.254,1.782 0.149,7.986 1.76,8.604c-8.482,-0.532 -5.889,-6.619 -7.425,-8.538c1.407,0.073 4.848,-3.183 5.665,-0.066Z' />\n    <path d='M4.727,11.059c0.417,2.844 6.991,3.864 8.331,2.779c-4.701,7.079 -8.676,1.79 -11.106,2.161c0.766,-1.183 -0.332,-5.791 2.775,-4.94Z' />\n    <path d='M7.561,17.813c2.671,1.061 6.842,-4.122 6.572,-5.826c3.781,7.611 -2.788,8.409 -3.681,10.699c-0.641,-1.255 -5.181,-2.607 -2.891,-4.873Z' />\n    <path d='M14.828,18.736c2.254,-1.783 -0.149,-7.987 -1.76,-8.605c8.482,0.532 5.889,6.619 7.425,8.538c-1.407,-0.072 -4.849,3.183 -5.665,0.067Z' />\n    <path d='M19.26,12.904c-0.417,-2.843 -6.991,-3.864 -8.331,-2.778c4.701,-7.08 8.676,-1.791 11.106,-2.162c-0.767,1.183 0.332,5.791 -2.775,4.94Z' />\n  </React.Fragment>, 'AppLogoSimple')\n","// https://commons.wikimedia.org/wiki/File:Apple_logo_black.svg\n\nimport React from 'react'\nimport createSvgIcon from '@material-ui/icons/utils/createSvgIcon'\n\nexport default createSvgIcon(\n  <React.Fragment>\n    <path d='M21.229,18.388c-0.346,0.799 -0.756,1.535 -1.23,2.211c-0.647,0.922 -1.176,1.56 -1.584,1.914c-0.632,0.582 -1.31,0.88 -2.036,0.897c-0.521,0 -1.149,-0.148 -1.88,-0.449c-0.734,-0.299 -1.408,-0.448 -2.025,-0.448c-0.646,0 -1.34,0.149 -2.081,0.448c-0.743,0.301 -1.342,0.457 -1.799,0.473c-0.696,0.03 -1.39,-0.277 -2.082,-0.921c-0.442,-0.385 -0.995,-1.046 -1.657,-1.982c-0.71,-0.999 -1.294,-2.158 -1.752,-3.48c-0.49,-1.427 -0.735,-2.809 -0.735,-4.147c0,-1.533 0.331,-2.855 0.994,-3.963c0.521,-0.89 1.215,-1.591 2.083,-2.107c0.868,-0.515 1.806,-0.778 2.816,-0.794c0.553,0 1.278,0.17 2.179,0.506c0.898,0.338 1.474,0.509 1.727,0.509c0.189,0 0.83,-0.2 1.916,-0.599c1.027,-0.369 1.894,-0.522 2.604,-0.462c1.924,0.155 3.37,0.914 4.331,2.28c-1.721,1.043 -2.572,2.503 -2.555,4.377c0.016,1.459 0.545,2.674 1.585,3.638c0.472,0.447 0.999,0.793 1.584,1.039c-0.127,0.368 -0.261,0.721 -0.403,1.06Zm-4.413,-17.366c0,1.144 -0.418,2.212 -1.251,3.2c-1.005,1.176 -2.221,1.855 -3.54,1.748c-0.017,-0.138 -0.026,-0.282 -0.026,-0.434c0,-1.098 0.478,-2.273 1.327,-3.234c0.423,-0.486 0.962,-0.891 1.616,-1.214c0.652,-0.318 1.269,-0.493 1.85,-0.523c0.016,0.152 0.024,0.305 0.024,0.457l0,0Z' />\n  </React.Fragment>, 'Apple')\n","\nimport React from 'react'\nimport PropTypes from 'prop-types'\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport Button from '@material-ui/core/Button'\nimport Typography from '@material-ui/core/Typography'\nimport DialogActions from '@material-ui/core/DialogActions'\n\nimport AppleIcon from '../../icons/Apple'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n\n  },\n  icon: {\n    height: 50,\n    width: '100%',\n    margin: '0 auto',\n    color: theme.palette.error.main\n  },\n  title: {\n\n  }\n})\n\nconst useStyles = makeStyles(style)\n\nconst FeatureDisabled = ({ title, message, onClose, open, icon }) => {\n  const classes = useStyles()\n  const IconComp = icon || AppleIcon\n  return (\n    <Dialog\n      className={classes.root}\n      disableBackdropClick\n      fullWidth\n      open={open}\n      disableEscapeKeyDown\n      maxWidth='xl'\n      aria-labelledby='confirmation-dialog-title'\n    >\n      <DialogTitle id='confirmation-dialog-title' className={classes.title}>{title}</DialogTitle>\n      <DialogContent>\n        <IconComp className={classes.icon} />\n        <Typography component='div'>\n          {message}\n        </Typography>\n\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={onClose} color='primary'>\n      Ok\n        </Button>\n      </DialogActions>\n    </Dialog>\n  )\n}\n\nFeatureDisabled.propTypes = {\n  open: PropTypes.bool,\n  title: PropTypes.string.isRequired,\n  icon: PropTypes.any,\n  message: PropTypes.string.isRequired,\n  onClose: PropTypes.func.isRequired\n}\n\nexport default FeatureDisabled\n","import React, { useContext } from 'react'\nimport PropTypes from 'prop-types'\nimport { makeStyles } from '@material-ui/core/styles'\nimport SwipeableDrawer from '@material-ui/core/SwipeableDrawer'\nimport Avatar from '@material-ui/core/Avatar'\n\nimport List from '@material-ui/core/List'\nimport Divider from '@material-ui/core/Divider'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemIcon from '@material-ui/core/ListItemIcon'\nimport ListItemText from '@material-ui/core/ListItemText'\nimport CloudDownload from '@material-ui/icons/CloudDownload'\nimport { AppContext } from '../contexts'\n\nimport ExitToAppIcon from '@material-ui/icons/ExitToApp'\nimport QRCodeIcon from '../icons/QRCode'\nimport AccountCircleIcon from '@material-ui/icons/AccountCircle'\n\nconst useStyles = makeStyles(theme => ({\n  drawerInner: {\n    width: 250,\n    display: 'flex',\n    flexDirection: 'column',\n    height: '100%'\n  },\n  disableListItem: {\n    color: 'rgba(0, 0, 0, 0.26)'\n  },\n  avatar: {\n    height: theme.spacing(7),\n    width: theme.spacing(7),\n    border: `3px solid ${theme.palette.primary.main}`,\n    margin: theme.spacing(0, 1)\n  },\n  gravatarImg: {\n    width: '100%'\n  },\n  spacer: {\n    flexGrow: 1\n  },\n  fullList: {\n    width: 'auto'\n  }\n}))\n\nconst SideDrawer = ({ open, onOpen, onClose, onDisabledClick }) => {\n  const classes = useStyles()\n  const { signOut, signedIn, forceSignIn, user, onQRClick, addToHomeScreen, isIos } = useContext(AppContext)\n  return (\n    <SwipeableDrawer\n      open={open}\n      onClose={onClose}\n      onOpen={onOpen}\n    >\n      <div\n        className={classes.drawerInner}\n        role='presentation'\n        onClick={onClose}\n        onKeyDown={onClose}\n      >\n        {user && user.username && (\n          <List>\n            <ListItem className={classes.root} onClick={() => {}} disableGutters>\n              <Avatar className={classes.avatar}>\n                {signedIn && user\n                  ? <img alt='profile' className={classes.gravatarImg} src={user.gravatar} />\n                  : <AccountCircleIcon color='inherit' className={classes.loginButton} />\n                }\n              </Avatar>\n            </ListItem>\n            <ListItem className={classes.root} onClick={() => {}}>\n              <ListItemText\n                primary={user.username}\n              />\n            </ListItem>\n          </List>\n\n        )}\n        <Divider />\n        <List>\n          <ListItem\n            className={isIos ? classes.disableListItem : null}\n            button\n            onClick={isIos ? onDisabledClick : onQRClick}\n          >\n            <ListItemIcon>\n              <QRCodeIcon />\n            </ListItemIcon>\n            <ListItemText primary={'Scan QR Code'} />\n          </ListItem>\n          {addToHomeScreen && (\n            <ListItem button onClick={addToHomeScreen}>\n              <ListItemIcon>\n                <CloudDownload />\n              </ListItemIcon>\n              <ListItemText primary={'Install this app'} secondary={'It works better!'} />\n            </ListItem>\n          )}\n        </List>\n        <div className={classes.spacer} />\n        <Divider />\n        <List>\n          {signedIn\n            ? (\n              <ListItem button onClick={signOut}>\n                <ListItemIcon>\n                  <ExitToAppIcon />\n                </ListItemIcon>\n                <ListItemText primary={'Sign Out'} />\n              </ListItem>\n            )\n            : (\n              <ListItem button onClick={forceSignIn}>\n                <ListItemIcon>\n                  <AccountCircleIcon />\n                </ListItemIcon>\n                <ListItemText primary={'Sign In'} />\n              </ListItem>\n            )}\n\n        </List>\n      </div>\n    </SwipeableDrawer>\n  )\n}\n\nSideDrawer.propTypes = {\n  open: PropTypes.bool,\n  onOpen: PropTypes.func,\n  onClose: PropTypes.func,\n  onDisabledClick: PropTypes.func\n}\n\nexport default SideDrawer\n\n//         {/*\n// <ContextMenu\n//             anchorEl={contextEl}\n//             onClose={() => setContextEl(null)}\n//             menuItems={[\n//               ...finalMenuItems,\n//               {\n//                 text: 'Sign Out',\n//                 icon: ExitToAppIcon,\n//                 action: signOut\n//               }\n//             ]}\n\n//                       {!signedIn && (\n//             <IconButton\n//               color='inherit'\n//               className={classes.iconButton}\n//               aria-label='Menu'\n//               onClick={forceSignIn}\n//             >\n//               <AccountCircleIcon color='inherit' className={classes.loginButton} />\n//             </IconButton>\n//           )}\n//           /> */}\n","import React, { useState, useContext } from 'react'\nimport classNames from 'classnames'\nimport PropTypes from 'prop-types'\n\nimport Toolbar from '@material-ui/core/Toolbar'\nimport AppBar from '@material-ui/core/AppBar'\nimport IconButton from '@material-ui/core/IconButton'\nimport AppLogoSimple from '../icons/AppLogoSimple'\nimport FeatureDisabled from './misc/FeatureDisabled'\nimport { AppContext } from '../contexts'\n\nimport QRCodeIcon from '../icons/QRCode'\nimport SideDrawer from './SideDrawer'\n\n// import MenuIcon from '@material-ui/core/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { ThemeProvider } from '@material-ui/styles'\nimport themes from '../themes'\nimport { Typography } from '@material-ui/core'\n\nconst style = theme => ({\n  root: {\n    display: 'flex',\n    alignItems: 'center',\n    width: '100%',\n    padding: theme.spacing(0, 1),\n    backgroundColor: theme.palette.primary.main,\n    color: theme.palette.primary.contrastText,\n    borderBottom: `2px solid ${theme.palette.primary}`,\n    background: `linear-gradient(90deg, ${theme.palette.secondary.main} 0%, ${theme.palette.primary.main} 100%)`\n  },\n  searchIcon: {\n    opacity: 0.3,\n    marginRight: theme.spacing(1)\n  },\n  transparent: {\n    backgroundColor: 'transparent',\n    background: 'none',\n    color: theme.palette.text.primary\n    // borderBottom: `2px transparent`\n  },\n  iOsIcon: {\n    color: 'rgba(0, 0, 0, 0.26)'\n  },\n  logo: {\n    padding: theme.spacing(0, 0),\n    height: 40,\n    width: 40\n  },\n  transparentLogo: {\n    background: `linear-gradient(90deg, ${theme.palette.secondary.main} 0%, ${theme.palette.primary.main} 100%)`,\n    padding: theme.spacing(0.5, 0.5)\n  },\n  transparentLogoIcon: {\n    color: 'white',\n    height: 35,\n    width: 35\n  },\n  children: {\n    flexGrow: 1,\n    padding: theme.spacing(0, 1)\n  },\n  qrButton: {\n    padding: theme.spacing(0, 0)\n  },\n  qrButtonTransparent: {\n    background: 'white',\n    padding: theme.spacing(0.5, 0.5)\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst TopBar = ({ className, children, isTransparent, menuItems, hideLogo }) => {\n  const classes = useStyles()\n  const [appleDlg, setAppleDlg] = useState(false)\n  const [drawerOpen, setDrawerOpen] = useState(false)\n  const { onQRClick, isIos } = useContext(AppContext)\n\n  return (\n    <React.Fragment>\n      <AppBar position='static'>\n        <Toolbar className={classNames(classes.root, className, isTransparent ? classes.transparent : null)} disableGutters>\n          {!hideLogo && (\n            <IconButton\n              className={isTransparent ? classes.transparentLogo : classes.logo}\n              color='inherit'\n              onClick={() => setDrawerOpen(true)}\n            >\n              <AppLogoSimple className={isTransparent ? classes.transparentLogoIcon : classes.logo} />\n            </IconButton>\n          )}\n          <div className={classes.children}>\n            {children}\n          </div>\n          <IconButton\n            color='inherit'\n            className={classNames(\n              isIos ? classes.iOsIcon : null,\n              isTransparent ? classes.qrButtonTransparent : classes.qrButton\n            )}\n            aria-label='Menu'\n            onClick={isIos ? () => setAppleDlg(true) : onQRClick}\n          >\n            <QRCodeIcon color='inherit' />\n          </IconButton>\n        </Toolbar>\n      </AppBar>\n      <SideDrawer\n        open={drawerOpen}\n        onClose={() => setDrawerOpen(false)}\n        onOpen={() => setDrawerOpen(true)}\n        onDisabledClick={() => setAppleDlg(true)}\n      />\n      {isIos && (\n        <FeatureDisabled\n          open={appleDlg}\n          title='iOS Feature Disabled'\n          message={<Typography variant='body2' component='div'>\n            <p>This feature cannot function due to a bug in iOS 12 that prevents <strong>direct\n            camera access from progressive web apps</strong>.</p>\n            <p>There is good evidence iOS 13 has things sorted. ETA from Apple is mid-September 2019.</p>\n          </Typography>}\n          onClose={() => setAppleDlg(false)}\n        />\n      )}\n    </React.Fragment>\n  )\n}\n\nTopBar.propTypes = {\n  className: PropTypes.string,\n  children: PropTypes.any,\n  isTransparent: PropTypes.bool,\n  hideLogo: PropTypes.bool,\n  menuItems: PropTypes.arrayOf(PropTypes.shape({\n    callback: PropTypes.func,\n    text: PropTypes.string,\n    icon: PropTypes.any,\n    color: PropTypes.string\n  }))\n}\n\nexport default (props) => <ThemeProvider theme={themes.topbar}><TopBar {...props} /></ThemeProvider>\n","import React, { useRef, useLayoutEffect, useCallback } from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport { fade } from '@material-ui/core/styles/colorManipulator'\nimport InputBase from '@material-ui/core/InputBase'\n\nimport SearchIcon from '@material-ui/icons/Search'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { debounce } from '../../lib/util'\n\nconst useSearchBarStyles = makeStyles(theme => ({\n  root: {\n    position: 'relative',\n    borderRadius: theme.shape.borderRadius,\n    backgroundColor: fade(theme.palette.common.white, 0.3),\n    '&:hover': {\n      backgroundColor: fade(theme.palette.common.white, 0.5)\n    },\n    marginRight: theme.spacing(2),\n    marginLeft: 0,\n    width: '100%',\n    [theme.breakpoints.up('sm')]: {\n      marginLeft: theme.spacing(3),\n      width: 'auto'\n    }\n  },\n  transparent: {\n    backgroundColor: fade(theme.palette.common.white, 0.7),\n    '&:hover': {\n      backgroundColor: fade(theme.palette.common.white, 0.9)\n    }\n  },\n  inputRoot: {\n    color: 'inherit',\n    width: '100%'\n  },\n  inputInput: {\n    padding: theme.spacing(1, 1, 1, 4),\n    transition: theme.transitions.create('width'),\n    width: '100%',\n    [theme.breakpoints.up('md')]: {\n      width: 200\n    }\n  },\n  searchIcon: {\n    width: theme.spacing(4),\n    height: '100%',\n    position: 'absolute',\n    pointerEvents: 'none',\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center'\n  }\n}))\n\n/**\n *\n */\nexport const SearchInput = ({ autoFocus, disabled, onChange, onClick, defaultValue, isTransparent }) => {\n  const inputRef = useRef()\n  const classes = useSearchBarStyles()\n\n  const debounceSearchText = useCallback(\n    debounce(onChange, 500),\n    [onChange]\n  )\n\n  useLayoutEffect(() => {\n    if (inputRef.current && !autoFocus) {\n      console.log('Setting blur')\n      inputRef.current.blur()\n    }\n  }, [autoFocus])\n  return (\n    <div className={classNames(classes.root, isTransparent ? classes.transparent : null)} onClick={onClick}>\n      <div className={classes.searchIcon}>\n        <SearchIcon />\n      </div>\n      <InputBase\n        autoFocus={!disabled && autoFocus}\n        inputProps={{\n          onBlur: () => {\n            // console.log('onBlur')\n            // inputRef.current.focus()\n          }\n        }}\n        onChange={(e) => {\n          // console.log('onChange', e.target.value)\n          debounceSearchText(e.target.value)\n        }}\n        placeholder='Search'\n        disabled={disabled}\n        defaultValue={defaultValue}\n\n        inputRef={inputRef}\n        classes={{\n          root: classes.inputRoot,\n          input: classes.inputInput\n        }}\n      />\n    </div>\n  )\n}\n\nSearchInput.propTypes = {\n  autoFocus: PropTypes.bool,\n  isTransparent: PropTypes.bool,\n  disabled: PropTypes.bool,\n  onChange: PropTypes.func,\n  defaultValue: PropTypes.string,\n  onClick: PropTypes.func\n}\n\nexport default SearchInput\n","import React, { useContext } from 'react'\nimport PropTypes from 'prop-types'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemText from '@material-ui/core/ListItemText'\nimport List from '@material-ui/core/List'\nimport classNames from 'classnames'\nimport Typography from '@material-ui/core/Typography'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { formatDate } from '../../lib/datelib'\n\nimport { ACCESS } from '../../config'\nimport { AppContext } from '../../contexts'\n\nconst style = theme => ({\n  root: {\n    margin: 0,\n    padding: theme.spacing(1)\n  },\n  chipContainer: {\n    display: 'flex',\n    width: '100%'\n  },\n  grow: { flexGrow: 1 },\n  accessLabel: {\n    padding: theme.spacing(0.5, 0.5)\n  },\n  accessPUBLIC: {\n    color: 'white',\n    background: ACCESS.PUBLIC.color[900]\n  },\n  accessPRIVATE: {\n    color: 'white',\n    background: ACCESS.PRIVATE.color[900]\n  },\n  accessOPEN: {\n    color: 'white',\n    background: ACCESS.OPEN.color[900]\n  },\n  img: {\n    verticalAlign: 'top',\n    objectFit: 'cover',\n    height: '100%',\n    width: '100%'\n  },\n  text: {\n    height: '115px',\n    margin: 0,\n    padding: theme.spacing(0, 1),\n    alignSelf: 'flex-start',\n    display: 'flex',\n    flexDirection: 'column'\n  },\n  titleText: {\n    textOverflow: 'ellipsis',\n    whiteSpace: 'nowrap',\n    overflow: 'hidden'\n  },\n  dateContainer: {\n    display: 'flex'\n  },\n  dateLabel: {\n    fontWeight: 'bold',\n    flex: '1 1 50px'\n  },\n  dateText: {\n\n  },\n  imgFiller: {\n    flexGrow: 1,\n    background: theme.palette.text.primary\n  },\n  imgContainer: {\n    flex: '0 0 115px',\n    alignSelf: 'flex-start',\n    height: '100%',\n    minHeight: 115,\n    display: 'flex',\n    flexDirection: 'column'\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst SeriesListItem = ({ series, loading, onClick, children, showCreatedOn, showLastPhoto }) => {\n  const classes = useStyles()\n  const { seriesConfig } = useContext(AppContext)\n  if (loading || !series) return 'LOADING...'\n  let thumb = null\n  let accessLabel = ACCESS.PRIVATE.label\n  try {\n    thumb = seriesConfig.getPhotoUrl(series.featured, 'thumb')\n    accessLabel = series.access ? ACCESS[series.access].label : ACCESS.PRIVATE.label\n  }\n  catch (e) {\n    console.error(e)\n  }\n  return (\n    <ListItem className={classes.root} button component='div' disableGutters>\n      <div className={classes.imgContainer} onClick={onClick}>\n        <div className={classes.imgFiller}>\n          <img alt='thumbnail' src={thumb} className={classes.img} />\n        </div>\n        {series.access && (\n          <Typography className={classNames(classes.accessLabel, classes[`access${series.access}`])}\n            variant='caption'\n            component='div'\n          >\n            {`${series.photoCount || 0} Photos`} <em>({accessLabel})</em>\n          </Typography>\n        )}\n      </div>\n      <ListItemText className={classes.text} disableTypography onClick={onClick}>\n        <Typography variant='body1' component='div' className={classes.titleText}>\n          {series.name || loading}\n        </Typography>\n        <Typography variant='body2' component='div'>\n          <strong>Created by:</strong> {series.createdUser.username}\n        </Typography>\n        <div className={classes.grow} />\n        {showCreatedOn && <div className={classes.dateContainer}>\n          <Typography variant='caption' className={classes.dateLabel}>Created:</Typography>\n          <Typography variant='caption' className={classes.dateText}>{formatDate(series.createdOn, 'lll')}</Typography>\n        </div>}\n        {showLastPhoto && <div className={classes.dateContainer}>\n          <Typography variant='caption' className={classes.dateLabel}>Last Photo:</Typography>\n          <Typography variant='caption' className={classes.dateText}>{formatDate(series.latest.takenOn, 'lll')}</Typography>\n        </div>}\n      </ListItemText>\n      {/*  <TinyChip label='Watching' color='secondary' /> */}\n      {children}\n    </ListItem>\n  )\n}\n\nSeriesListItem.propTypes = {\n  series: PropTypes.object,\n  loading: PropTypes.bool,\n  showCreatedOn: PropTypes.bool,\n  showLastPhoto: PropTypes.bool,\n  onClick: PropTypes.func,\n  children: PropTypes.array\n}\n\nexport default SeriesListItem\n\n// const useCosmosStyles = makeStyles(theme => ({\n//   root: {\n\n//   }\n// }))\n\nexport const SeriesListItemCosmos = (props) => {\n  // const classes = useCosmosStyles()\n  return (\n    <List disablePadding dense>\n      <SeriesListItem {...props} />\n    </List>\n  )\n}\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemText from '@material-ui/core/ListItemText'\nimport List from '@material-ui/core/List'\n// import IconButton from '@material-ui/core/IconButton'\n// import ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction'\nimport ZoomOutMapIcon from '@material-ui/icons/ZoomOutMap'\n// import CancelIcon from '@material-ui/icons/Cancel'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { ListItemIcon } from '@material-ui/core'\n\nconst style = theme => ({\n  root: {\n\n  }\n})\n\nconst useStyles = makeStyles(style)\n\nconst ClusterSelected = ({ seriesCount, reducedPhotoCount, onZoomTo, onClose }) => {\n  const classes = useStyles()\n  console.log('cluster selected', { seriesCount, reducedPhotoCount })\n  return (\n    <List>\n      <ListItem className={classes.root}>\n        <ListItemIcon onClick={onZoomTo}>\n          <ZoomOutMapIcon />\n        </ListItemIcon>\n        <ListItemText\n          onClick={onZoomTo}\n          primary={`${seriesCount} Photo series`}\n          secondary={`containing ${reducedPhotoCount} individual photo${reducedPhotoCount === 1 ? '' : 's'}`}\n        />\n        {/* <ListItemSecondaryAction>\n          <IconButton aria-label='Close' onClick={onClose}>\n            <CancelIcon />\n          </IconButton>\n        </ListItemSecondaryAction> */}\n\n      </ListItem>\n    </List>\n  )\n}\n\nClusterSelected.propTypes = {\n  seriesCount: PropTypes.number.isRequired,\n  reducedPhotoCount: PropTypes.number.isRequired,\n  onZoomTo: PropTypes.func.isRequired,\n  onClose: PropTypes.func.isRequired\n}\n\nexport default ClusterSelected\n","import React from 'react'\nimport classNames from 'classnames'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport Badge from '@material-ui/core/Badge'\nimport Avatar from '@material-ui/core/Avatar'\nimport Camera from '@material-ui/icons/Camera'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { ACCESS } from '../../../config'\n\nconst style = theme => ({\n  root: {\n    color: theme.palette.primary.main,\n    width: 150,\n    position: 'absolute',\n    top: '50%',\n    left: '50%',\n    textAlign: 'center',\n    transformOrigin: '50% 50%',\n    transform: 'translateY(-50%) translateX(-50%)'\n  },\n  rootActive: {\n    zIndex: 1000\n  },\n  icon: {\n    // height: 16,\n    // width: 16\n  },\n  avatar: {\n    position: 'relative',\n    margin: '0 auto',\n    background: 'green',\n    color: 'white',\n    border: '2px solid white',\n    height: 40,\n    width: 40,\n    zIndex: 120,\n    '&.PUBLIC': { background: ACCESS.PUBLIC.color },\n    '&.PRIVATE': { background: ACCESS.PRIVATE.color },\n    '&.OPEN': { background: ACCESS.OPEN.color }\n  },\n  avatarActive: {\n    background: '#FFFF00',\n    color: 'black',\n    border: `2px solid black`,\n    '&.PUBLIC': { background: '#FFFF00' },\n    '&.PRIVATE': { background: '#FFFF00' },\n    '&.OPEN': { background: '#FFFF00' }\n  },\n  badge: {\n    zIndex: 124,\n    color: theme.palette.secondary.contrastText,\n    background: theme.palette.secondary.main,\n    transform: 'scale(1) translate(30%, -30%)'\n  },\n  badgeActive: {\n    color: theme.palette.primary.contrastText,\n    background: theme.palette.primary.main\n  },\n  directionIndicator: {\n    position: 'absolute',\n    top: 20,\n    left: '50%',\n    // transformOrigin: '50% 50%',\n    // transform: 'translateY(-50%) translateX(-50%)',\n    zIndex: 100\n  },\n  name: {\n    color: 'white',\n    fontWeight: 'bold',\n    textShadow: `\n        0px 0px 4px #000000, \n        0px 0px 4px #000000 \n    `,\n    zIndex: 122,\n    position: 'relative'\n    // textStroke: '1px white'\n  },\n  nameActive: {\n    color: 'black',\n    textShadow: `\n    0px 0px 2px #FFFFFF, \n    0px 0px 2px #FFFFFF,\n    0px 0px 4px #FFFFFF \n`\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst Single = ({ name, access, onClick, active, photoCount, direction }) => {\n  const classes = useStyles()\n  return (\n    <div className={classNames(classes.root, active ? classes.rootActive : null, access)}>\n      <Badge classes={{ badge: classNames(classes.badge, active ? classes.badgeActive : null, access) }} badgeContent={photoCount}>\n        <Avatar className={classNames(classes.avatar, active ? classes.avatarActive : null, access)} onClick={onClick}>\n          <Camera className={classes.icon} color='inherit' />\n        </Avatar>\n      </Badge>\n      {direction && direction >= 0 ? (\n        <div className={classes.directionIndicator}>\n          <svg className={classes.svgArc}\n            version='1.1'\n            width='100'\n            height='100'\n            viewBox='0, 0, 100, 100'\n            style={{ transform: `translateY(-50%) translateX(-50%) rotateZ(${direction}deg)` }}>\n            <path d='M50,0 C60.946,0.151 72.136,3.514 80.675,10.56 L50,50 L19.325,10.56 C27.938,3.461 39,0.278 50,0 z'\n              fill='#009DC1'\n              fillOpacity='0.444'\n              strokeWidth='1'\n              strokeOpacity='0.6'\n              stroke='#FFFFFF'\n            />\n          </svg>\n        </div>\n      ) : null}\n      <Typography variant='body1' className={classNames(classes.name, active ? classes.nameActive : null)}>\n        {name}\n      </Typography>\n    </div>\n  )\n}\n\nSingle.propTypes = {\n  access: PropTypes.string,\n  name: PropTypes.string,\n  photoCount: PropTypes.number,\n  onClick: PropTypes.func.isRequired,\n  direction: PropTypes.number,\n  active: PropTypes.bool\n}\n\nexport default Single\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport Avatar from '@material-ui/core/Avatar'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport numeral from 'numeral'\n\nconst style = theme => ({\n  avatar: {\n    background: theme.palette.grey[900],\n    border: `2px solid ${theme.palette.grey[100]}`,\n    color: theme.palette.grey[100]\n  },\n  avatarActive: {\n    background: '#FFFF00',\n    border: `2px solid black`,\n    color: 'black',\n    zIndex: 1000\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst Cluster = ({ seriesCount, active, onClick }) => {\n  const classes = useStyles()\n  return (\n    <Avatar onClick={onClick} className={classNames(classes.avatar, active ? classes.avatarActive : null)}>\n      {numeral(seriesCount).format('0,0')}\n    </Avatar>\n  )\n}\n\nCluster.propTypes = {\n  seriesCount: PropTypes.number,\n  onClick: PropTypes.func.isRequired,\n  active: PropTypes.bool\n}\n\nexport default Cluster\n","\nimport React, { useState, useMemo, useRef, useEffect } from 'react'\nimport PropTypes from 'prop-types'\nimport Paper from '@material-ui/core/Paper'\n// import Typography from '@material-ui/core/Typography'\nimport { FlyToInterpolator, LinearInterpolator, Marker } from 'react-map-gl'\nimport { easeCubic } from 'd3-ease'\nimport { CircularProgress } from '@material-ui/core'\nimport MapStyles from '../../mapStyles'\n\nimport BaseMap from './BaseMap'\nimport useClusteredData from '../../lib/useClusteredData'\nimport { bbox, featureCollection, buffer, point } from '@turf/turf'\nimport { makeStyles } from '@material-ui/core/styles'\n// import { debounce } from '../../lib/util'\nimport style from './HomeMap.style'\n\nimport TopBar from '../TopBar'\nimport SearchInput from '../Search/SearchInput'\nimport SeriesListItem from '../misc/SeriesListItem'\nimport ClusterSelected from '../misc/ClusterSelected'\n\nimport SingleMarker from './markers/Single'\nimport ClusterMarker from './markers/Cluster'\n\nconst useStyles = makeStyles(style)\n\nconst defaultView = {\n  zoom: 4,\n  latitude: 44.629701,\n  longitude: -120.333379\n}\n\nconst SIZESCALE = 80\n\nconst HomeMap = ({\n  seriesList, initViewport, loading, activeSeries, queryVersion,\n  onSeriesClick, onSearchClick,\n  popMapHistory, pushMapHistory, clearMapHistory\n}) => {\n  const [mapViewObj, setMapViewObj] = useState({\n    viewport: { ...defaultView, ...initViewport.viewport },\n    bounds: initViewport.bounds,\n    filterBounds: null\n  })\n  // console.log('INITVIEW', initViewport)\n  const classes = useStyles()\n  const mapViewRef = useRef()\n  const [isTransitioning, setIsTransitioning] = useState(false)\n  const homeMapContainerRef = useRef()\n\n  const [currentZoom, setCurrentZoom] = useState(0)\n  const [transitions, setTransitions] = useState(null)\n  const [selectedItem, setSelectedItem] = useState()\n\n  // This custom hook is heavily debounced\n  const { filteredClusteredData } = useClusteredData(\n    seriesList || [],\n    mapViewObj.filterBounds,\n    currentZoom,\n    mapViewObj.viewport,\n    SIZESCALE,\n    queryVersion\n  )\n\n  // If we're coming back to the map with something aleady selected then we need to\n  // reselect the series we had before\n  useEffect(() => {\n    if (!activeSeries || !seriesList || selectedItem) return\n    try {\n      const selected = seriesList.find(s => s.id === activeSeries)\n      // if (selected && homeMapContainerRef.current) setSelectedItem(selected)\n      if (selected && selected.coords) {\n        const bufferPts = buffer(point(selected.coords), 10, { units: 'meters' })\n        const bounds = bbox(bufferPts)\n        setMapViewObj({ ...mapViewObj, bounds })\n      }\n    }\n    catch (e) {\n      console.error(e)\n    }\n  }, [seriesList])\n  // Once we have the zoom in place we might need to select an initial series\n  useEffect(() => {\n    if (!activeSeries || !filteredClusteredData.single || selectedItem) return\n    try {\n      const selected = filteredClusteredData.single.find(s => s.properties.id === activeSeries)\n      if (selected && homeMapContainerRef.current) setSelectedItem(selected)\n    }\n    catch (e) {\n      console.error(e)\n    }\n  }, [filteredClusteredData.single])\n\n  const saveMap = () => {\n    const { latitude, longitude, zoom, bearing, pitch, altitude } = mapViewRef.current ? mapViewRef.current : mapViewObj.viewport\n    setTimeout(() => pushMapHistory({\n      viewport: { latitude, longitude, zoom, bearing, pitch, altitude }\n    }), 2000)\n  }\n  // const saveMapDebounced = debounce(saveMap, 2000)\n\n  const updateSelectedItem = (item) => {\n    // regardless, set the map selected Item\n    setSelectedItem(item)\n    saveMap()\n  }\n\n  const onZoomTo = (object) => {\n    try {\n      const pts = featureCollection(object.properties.points)\n      const bounds = bbox(pts)\n      // buffer a further 10%\n      const lngBuff = (bounds[2] - bounds[0]) * 0.2\n      const latBuff = (bounds[3] - bounds[1]) * 0.2\n      const buffBounds = [\n        bounds[0] - lngBuff,\n        bounds[1] - latBuff,\n        bounds[2] + lngBuff,\n        bounds[3] + latBuff\n      ]\n\n      setTransitions({\n        transitionDuration: 2000,\n        transitionInterpolator: new FlyToInterpolator(),\n        transitionEasing: easeCubic\n      })\n      setMapViewObj({ ...mapViewObj, bounds: buffBounds })\n      if (object.properties.count > 1) setTimeout(() => updateSelectedItem(null), 2000)\n    }\n    catch (e) {\n      console.error(e)\n    }\n  }\n\n  const onViewportChange = ({ viewport, map }) => {\n    mapViewRef.current = viewport\n    // mapViewObj\n    // {\n    //   \"_sw\": {\n    //     \"lng\": -120.40788003760076,\n    //     \"lat\": 44.609051464438835\n    //   },\n    //   \"_ne\": {\n    //     \"lng\": -120.25887796240545,\n    //     \"lat\": 44.65034319161438\n    //   }\n    // minX, minY, maxX, maxY\n    // [W-122.87948116236043, S26.15346805640254, E-82.00799782432676, N47.3795453070757]\n    const viewZoom = Math.floor(viewport.zoom)\n    if (!isTransitioning && map && map.getBounds) {\n      // console.log('onViewportChange', isTransitioning)\n      const { _sw: { lng: minLng, lat: minLat }, _ne: { lng: maxLng, lat: maxLat } } = map.getBounds()\n      const [oldMinLng, oldMinLat, oldMaxLng, oldMaxLat] = mapViewObj.filterBounds || [minLng, minLat, maxLng, maxLat]\n      if (viewZoom !== currentZoom ||\n        oldMinLng >= minLng || oldMinLat >= minLat ||\n        oldMaxLng <= maxLng || oldMaxLat <= maxLat\n      ) {\n        // console.log('RECALCING filterBounds')\n        const filterBounds = [\n          minLng - (maxLng - minLng) / 2,\n          minLat - (maxLat - minLat) / 2,\n          maxLng + (maxLng - minLng) / 2,\n          maxLat + (maxLat - minLat) / 2\n        ]\n        setMapViewObj({ ...mapViewObj, filterBounds })\n      }\n    }\n    if (viewZoom !== currentZoom) {\n      setCurrentZoom(viewZoom)\n    }\n  }\n  // Debounce this to improve performance\n  // const onViewportChangeDebounced = useCallback(debounce(onViewportChange, 300), [])\n\n  const lock = {}\n\n  const onMarkerClick = (obj) => {\n    // Second click zooms\n    if (selectedItem && selectedItem.properties.id === obj.properties.id) {\n      // console.log('onMarkerClick SECOND CLICK')\n      onZoomTo(selectedItem)\n    }\n    else {\n      // console.log('onMarkerClick First click')\n      setTransitions({\n        transitionDuration: 500,\n        transitionInterpolator: new LinearInterpolator(),\n        transitionEasing: easeCubic\n      })\n      setMapViewObj({\n        viewport: {\n          longitude: obj.geometry.coordinates[0],\n          latitude: obj.geometry.coordinates[1]\n        }\n      })\n    }\n    updateSelectedItem(obj)\n  }\n\n  // This one should be debounced by filteredClusteredData\n  const markersRendered = useMemo(() => ([\n    ...filteredClusteredData.single.map(obj => (\n      <Marker\n        className={'singleMarker'}\n        key={`single-${obj.properties.id}`}\n        latitude={obj.geometry.coordinates[1]}\n        longitude={obj.geometry.coordinates[0]}\n        offsetLeft={0}\n        offsetTop={-20}\n      >\n        <SingleMarker name={obj.properties.name}\n          access={obj.properties.access}\n          photoCount={obj.properties.photoCount}\n          onClick={() => onMarkerClick(obj)}\n          direction={currentZoom > 10 && obj.properties.direction ? obj.properties.direction : null}\n          active={selectedItem && selectedItem.properties.id === obj.properties.id}\n        />\n      </Marker>\n    )),\n    ...filteredClusteredData.cluster.map(obj => (\n      <Marker\n        className='clusterMarker'\n        key={`cluster-${obj.properties.id}`}\n        latitude={obj.geometry.coordinates[1]}\n        longitude={obj.geometry.coordinates[0]}\n        offsetLeft={-20}\n        offsetTop={-20}\n      >\n        <ClusterMarker\n          seriesCount={obj.properties.count}\n          photoCount={obj.properties.reducedPhotoCount}\n          onClick={() => onMarkerClick(obj)}\n          active={\n            selectedItem &&\n            selectedItem.properties.id === obj.properties.id &&\n            selectedItem.properties.count === obj.properties.count\n          }\n        />\n      </Marker>\n    ))\n  ]), [filteredClusteredData, selectedItem])\n\n  const selectedItemRender = useMemo(() => !!selectedItem && (\n    <Paper className={classes.selectedPopup}>\n      {selectedItem.properties.count === 1\n        ? <SeriesListItem\n          series={selectedItem.properties}\n          showCreatedOn\n          showLastPhoto\n          onClick={() => onSeriesClick(selectedItem.properties.id)}\n        />\n        : <ClusterSelected\n          seriesCount={selectedItem.properties.count}\n          reducedPhotoCount={selectedItem.properties.reducedPhotoCount}\n          onClose={() => updateSelectedItem(null)}\n          onZoomTo={() => onZoomTo(selectedItem)}\n        />\n      }\n    </Paper>\n  ), [selectedItem])\n\n  return (\n    <div className={classes.root} ref={homeMapContainerRef}>\n      <TopBar isTransparent className={classes.topBar}>\n        <SearchInput\n          isTransparent\n          onClick={onSearchClick}\n          defaultValue={''}\n        />\n      </TopBar>\n      {loading && (\n        <div className={classes.loadingWrapper}>\n          <CircularProgress size={80} thickness={7} color='inherit' />\n          {/* <Typography variant='h3' color='inherit'>Loading...</Typography> */}\n        </div>\n      )}\n\n      <BaseMap\n        showMe\n        // This should only change on INIT or transition events\n        viewport={mapViewObj.viewport}\n        transitions={transitions}\n        mapStyles={MapStyles}\n        controlPadding={{ top: 56 }}\n        initStyle={MapStyles.length > 1 ? 1 : 0}\n        {...lock}\n        onTransitionStart={() => {\n          // console.log('handletransitionStart')\n          setIsTransitioning(true)\n        }}\n        onTransitionEnd={() => {\n          // console.log('handletransitionEnd')\n          setIsTransitioning(false)\n          setTransitions(null)\n        }}\n        bounds={mapViewObj.bounds}\n        maxZoom={20}\n        minZoom={1}\n        onViewportChange={onViewportChange}\n        onNativeClick={() => {\n          if (selectedItem) updateSelectedItem(null)\n        }}\n      >\n        {markersRendered}\n      </BaseMap>\n\n      {selectedItemRender}\n    </div>\n  )\n}\n\nHomeMap.propTypes = {\n  seriesList: PropTypes.array,\n  queryVersion: PropTypes.number,\n  activeSeries: PropTypes.string,\n  initViewport: PropTypes.object,\n  loading: PropTypes.bool,\n  // These all get loaded up through mapFuncs in HomeMap.connect\n  onSearchClick: PropTypes.func,\n  onSeriesClick: PropTypes.func,\n  popMapHistory: PropTypes.func,\n  pushMapHistory: PropTypes.func,\n  clearMapHistory: PropTypes.func\n}\n\nexport default HomeMap\n\n// function getInitialState (initViewport) {\n//   return {\n//     viewport: { ...defaultView, ...initViewport.viewport },\n//     bounds: initViewport.bounds,\n//     filterBounds: null\n//   }\n// }\n","import React, { useEffect, useState, useRef, useMemo } from 'react'\nimport PropTypes from 'prop-types'\nimport { connect } from 'react-redux'\nimport { graphql } from 'react-apollo'\nimport { allSeries, pollQuery } from './queries'\nimport actions from '../redux/actions'\nimport { home } from '../config'\nimport HomeMap from '../components/maps/HomeMap'\n\nconst POLL_INTERVAL = 20 // (seconds)\n\n/**\n * The outer component handles the lastCheck variable which, when changed will\n * cause the poll event\n */\nconst HomeMapConnector = ({ initViewport, activeSeries, mapFuncs }) => {\n  const [seriesProps, setSeriesProps] = useState()\n  const [queryVersion, setVersion] = useState(0)\n  const updateIncrement = () => setVersion(queryVersion + 1)\n  const timerRef = useRef()\n  const [lastCheck, setLastCheck] = useState(null)\n  timerRef.current = lastCheck\n\n  // These are expensive queries so we render them memoized to prevent erroneous re-renders\n  const allSeriesQUERY = useMemo(() => <AllSeriesConnect setSeriesProps={setSeriesProps} />, [])\n  const pollSeriesQUERY = useMemo(() => <PollQueryConnect lastCheck={lastCheck} seriesProps={seriesProps} updateIncrement={updateIncrement} />, [lastCheck])\n\n  // Initiate the polling process. We simply update the timestamp every N seconds\n  useEffect(() => {\n    if (!seriesProps) return\n    function ping () {\n      if (timerRef.current) setLastCheck(String(Date.now() - POLL_INTERVAL * 1000))\n    }\n    if (!timerRef.current && seriesProps.readyForPolling) timerRef.current = setInterval(ping, POLL_INTERVAL * 1000)\n    return () => {\n      if (timerRef.current) {\n        console.log('clear poll timer')\n        clearInterval(timerRef.current)\n        timerRef.current = null\n      }\n    }\n  }, [seriesProps])\n\n  return (\n    <React.Fragment>\n      {allSeriesQUERY}\n      {pollSeriesQUERY}\n      <HomeMap\n        queryVersion={queryVersion}\n        seriesList={seriesProps && seriesProps.allSeries ? seriesProps.allSeries.seriesSummaries : []}\n        activeSeries={activeSeries}\n        initViewport={initViewport}\n        loading={seriesProps && seriesProps.loading}\n        {...mapFuncs}\n      />\n    </React.Fragment>\n  )\n}\nHomeMapConnector.propTypes = {\n  activeSeries: PropTypes.string, // from redux\n  initViewport: PropTypes.object, // from redux\n  mapFuncs: PropTypes.object // from redux passed straight through to the map\n\n}\n\nconst withAllSeries = graphql(allSeries, {\n  props: ({ data, ownProps }) => {\n    // If there's more data to load we should go get another batch\n    if (!data.loading && !data.error && data.allSeries && data.allSeries.seriesSummaries.length > 0 && data.allSeries.nextToken) {\n      data.fetchMore({\n        variables: { ...data.variables, nextToken: data.allSeries.nextToken },\n        // How do we mush the new query with the old one\n        updateQuery: (prev, { fetchMoreResult }) => {\n          return {\n            allSeries: {\n              ...fetchMoreResult.allSeries,\n              seriesSummaries: [ ...prev.allSeries.seriesSummaries, ...fetchMoreResult.allSeries.seriesSummaries ]\n            }\n          }\n        }\n      })\n    }\n    else if (data.loading || data.error) {\n      ownProps.setSeriesProps(data)\n    }\n    else {\n      ownProps.setSeriesProps({ ...data, readyForPolling: true })\n    }\n    return null\n  },\n  options: {\n    variables: { limit: 100 }\n  }\n})\n\n/**\n * Here's the graphql HOC that gets an individual series\n */\nconst withPollQuery = graphql(pollQuery, {\n  skip: ({ lastCheck }) => !lastCheck,\n  props: ({ data, ownProps: { seriesProps, updateIncrement } }) => {\n    if (data.error) {\n      console.log('POLL FAIL', data.error, data)\n      console.error(data.error)\n    }\n    if (!data.loading && data.changedSeries && data.changedSeries.seriesSummaries) {\n      // console.log('POLLING', { data, seriesProps })\n      const newData = data.changedSeries.seriesSummaries\n      const oldList = seriesProps.allSeries.seriesSummaries\n      console.log('DEBUG', seriesProps)\n      // If the polling has begun and we have some good polling data back then\n      // Process it and decide if we need to incorporate it\n      if (data.changedSeries) {\n        let newSeriesSummaries = seriesProps.allSeries.seriesSummaries\n        newData.forEach(({ seriesStatus, ...polledSeries }) => {\n          if (seriesStatus === 'deleted') {\n            console.log('Polling found a series to delete: ', polledSeries.id)\n            newSeriesSummaries = oldList.filter(s => s.id !== polledSeries.id)\n          }\n          else {\n            const idx = oldList.findIndex(ds => ds.id === polledSeries.id)\n            if (idx >= 0) {\n              console.log('Polling found a series to Update: ', polledSeries.id)\n              newSeriesSummaries = oldList.map((oldSeries, oldId) => oldId === idx ? polledSeries : oldSeries)\n            }\n            else {\n              console.log('Polling found a series to add: ', polledSeries.id)\n              newSeriesSummaries = [...oldList, polledSeries]\n            }\n          }\n          seriesProps.updateQuery((data, options) => {\n            try {\n              const newData = { ...data }\n              newData.allSeries.seriesSummaries = newSeriesSummaries\n              updateIncrement()\n              return data\n            }\n            catch (e) {\n              console.error(e)\n              return data\n            }\n          })\n        })\n      }\n    }\n    return null\n  },\n  options: ({ lastCheck }) => ({\n    variables: {\n      limit: 100,\n      lastCheck\n    }\n  })\n})\n\n// We're using graphql() HOC because it's convenient but it doesn't need to render anything\nconst AllSeriesConnect = withAllSeries(() => null)\nconst PollQueryConnect = withPollQuery(() => null)\n\n// The only part of the state the main view caes about is teh window\nconst mapStateToProps = (state, props) => {\n  const { current: { activeSeries } } = state.home\n  const initViewport = state.map.slice(-1).pop()\n  return { activeSeries, initViewport }\n}\n\n// There are a few presentational actions the main window can use\nconst mapDispatchToProps = dispatch => ({\n  mapFuncs: {\n    onSeriesClick: (activeSeries) => {\n      dispatch(actions.setHomeState(home.AppStateTypes.SERIES, { activeSeries }))\n    },\n    onSearchClick: () => {\n      dispatch(actions.setHomeState(home.AppStateTypes.SEARCH, { search: { tab: home.SEARCH_TABS.LOCATION, text: '' } }))\n    },\n    popMapHistory: () => {\n      dispatch(actions.popMapHistory())\n    },\n    pushMapHistory: (viewportSave) => {\n      dispatch(actions.pushMapHistory(viewportSave))\n    },\n    clearMapHistory: () => {\n      dispatch(actions.clearMapHistory())\n    }\n  }\n})\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(HomeMapConnector)\n","import React from 'react'\nimport classNames from 'classnames'\nimport PropTypes from 'prop-types'\nimport List from '@material-ui/core/List'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemAvatar from '@material-ui/core/ListItemAvatar'\nimport ListItemText from '@material-ui/core/ListItemText'\nimport ListItemIcon from '@material-ui/core/ListItemIcon'\nimport IconButton from '@material-ui/core/IconButton'\nimport Avatar from '@material-ui/core/Avatar'\n\nimport PlaceIcon from '@material-ui/icons/Place'\nimport PersonIcon from '@material-ui/icons/Person'\nimport LabelIcon from '@material-ui/icons/Label'\nimport CancelIcon from '@material-ui/icons/Cancel'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport { Typography } from '@material-ui/core'\nconst useStyles = makeStyles(theme => ({\n  root: {\n\n  },\n  chosenItem: {\n    color: theme.palette.primary.contrastText,\n    background: theme.palette.primary.dark\n  },\n  avatar: {\n    background: theme.palette.primary.main\n  },\n  closeIcon: {\n    color: theme.palette.primary.contrastText,\n    paddingRight: 0\n  },\n  avatarImg: {\n    height: '100%',\n    width: '100%',\n    objectFit: 'cover'\n  }\n}))\n\nconst SearchContextItem = ({ className, variant, name, description, gravatar, onClick, onCancel }) => {\n  const classes = useStyles()\n  let TheIcon = PlaceIcon\n\n  const getAvatar = (src) => () => (\n    <Avatar className={classes.avatar}>\n      <img className={classes.avatarImg} alt='profile' src={src} />\n    </Avatar>\n  )\n\n  switch (variant) {\n    case 'tag':\n      TheIcon = LabelIcon\n      break\n    case 'location':\n      TheIcon = PlaceIcon\n      break\n    case 'user':\n      TheIcon = gravatar ? getAvatar(gravatar) : PersonIcon\n      break\n    default:\n      break\n  }\n  return (\n    <ListItem\n      className={classNames(className, classes.root, onCancel ? classes.chosenItem : null)}\n      button={!!onClick}\n      onClick={onClick}\n    >\n      <ListItemAvatar>\n        <Avatar className={classes.avatar}>\n          <TheIcon color='inherit' />\n        </Avatar>\n      </ListItemAvatar>\n      <ListItemText disableTypography>\n        <Typography variant='body1' color='inherit'>{name}</Typography>\n        <Typography variant='body2' color='inherit'>{description}</Typography>\n      </ListItemText>\n      {onCancel && (\n        <ListItemIcon>\n          <IconButton onClick={onCancel} className={classes.closeIcon}>\n            <CancelIcon color='inherit' />\n          </IconButton>\n        </ListItemIcon>\n      )}\n    </ListItem>\n  )\n}\n\nSearchContextItem.propTypes = {\n  variant: PropTypes.oneOf(['tag', 'location', 'user']),\n  onClick: PropTypes.func,\n  gravatar: PropTypes.string,\n  className: PropTypes.string,\n  name: PropTypes.string.isRequired,\n  description: PropTypes.string,\n  onCancel: PropTypes.func\n}\n\nexport default SearchContextItem\n\nexport const SearchContexItemCosmos = () => {\n  return (\n    <List>\n      <SearchContextItem variant='tag' name='SomeTag' description='Some description of what I am' />\n      <SearchContextItem variant='location' name='Some Location' description='Some description of what I am' />\n      <SearchContextItem variant='user' name='User McUserSon' description='Some description of what I am' />\n    </List>\n  )\n}\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport List from '@material-ui/core/List'\nimport Typography from '@material-ui/core/Typography'\n\nimport SearchContextItem from './SearchContextItem'\n// import MenuIcon from '@material-ui/icons/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    height: '100%',\n    backgroundColor: theme.palette.background.paper,\n    position: 'relative',\n    overflowX: 'hidden',\n    overflowY: 'scroll',\n    flexGrow: 1\n  },\n  listSection: {\n    backgroundColor: 'inherit'\n  },\n  placeholderText: {\n    textAlign: 'center',\n    padding: theme.spacing(3, 1),\n    color: theme.palette.grey[400]\n  },\n  ul: {\n    backgroundColor: 'inherit',\n    padding: 0\n  }\n}))\n\nconst SearchContextResults = ({ variant, loading, contextResults, setContextChoice }) => {\n  const classes = useStyles()\n  if (loading) {\n    return <Typography className={classes.placeholderText} variant='h3'>Searching...</Typography>\n  }\n  else if (!contextResults || contextResults.length === 0) {\n    return <Typography className={classes.placeholderText} variant='h4'>No {variant} results</Typography>\n  }\n\n  return (\n    <List className={classes.root}>\n      {contextResults.map((cr, idx) => (\n        <SearchContextItem\n          key={`scr-${idx}`}\n          variant={variant}\n          onClick={() => setContextChoice(cr)}\n          {...cr}\n        />\n      ))}\n    </List>\n  )\n}\n\nSearchContextResults.propTypes = {\n  variant: PropTypes.oneOf(['tag', 'location', 'user']),\n  loading: PropTypes.bool,\n  contextResults: PropTypes.array.isRequired,\n  setContextChoice: PropTypes.func.isRequired\n}\n\nexport default SearchContextResults\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\n// import MenuIcon from '@material-ui/icons/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nconst useStyles = makeStyles(theme => ({\n  root: {\n    textAlign: 'center',\n    fontStyle: 'italic',\n    padding: theme.spacing(2, 1)\n  }\n}))\n\nconst SearchEnder = ({ style, icon, text }) => {\n  const classes = useStyles()\n  return (\n    <Typography className={classes.root} variant='subtitle1' color='textSecondary' component='div' style={style}>\n      {icon}\n      {text}\n    </Typography>\n  )\n}\n\nSearchEnder.propTypes = {\n  style: PropTypes.object,\n  icon: PropTypes.any,\n  text: PropTypes.string\n}\n\nexport default SearchEnder\n","import React, { useRef, useEffect } from 'react'\nimport PropTypes from 'prop-types'\nimport List from '@material-ui/core/List'\nimport Typography from '@material-ui/core/Typography'\n\nimport SearchContextItem from './SearchContextItem'\nimport SearchEnder from './SearchEnder'\n// import MenuIcon from '@material-ui/icons/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nimport SeriesListItem from '../misc/SeriesListItem'\nimport { debounce } from '../../lib/util'\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    height: '100%',\n    flexGrow: 1,\n    display: 'flex',\n    flexDirection: 'column',\n    overflow: 'hidden'\n  },\n  ctxItem: {\n    flexGrow: 0\n  },\n  list: {\n    flexGrow: 1,\n    backgroundColor: theme.palette.background.paper,\n    position: 'relative',\n    overflowX: 'hidden',\n    overflowY: 'scroll'\n  },\n  placeholderText: {\n    textAlign: 'center',\n    padding: theme.spacing(3, 1),\n    color: theme.palette.grey[400]\n  },\n  listSection: {\n    backgroundColor: 'inherit'\n  },\n  ul: {\n    backgroundColor: 'inherit',\n    padding: 0\n  }\n}))\n\nconst SearchResults = ({ variant, loading, seriesList, contextChoice, onCancel, onResultClick, fetchMore }) => {\n  const classes = useStyles()\n  const listRef = useRef()\n  const enderRef = useRef()\n\n  const handleScroll = debounce(() => {\n    if (!loading && fetchMore && enderRef.current && listRef.current) {\n      const { offsetTop } = enderRef.current\n      const { scrollTop, offsetHeight } = listRef.current\n      const scrollBottom = offsetHeight + scrollTop\n      if (offsetTop < scrollBottom * 2) {\n        console.log('SCROLL', { offsetHeight, scrollTop, offsetTop })\n        fetchMore()\n      }\n    }\n  }, 500)\n\n  useEffect(handleScroll, [seriesList])\n\n  let content = null\n  if (loading) {\n    content = (\n      <Typography className={classes.placeholderText} variant='h3'>Searching...</Typography>\n    )\n  }\n  else if (seriesList && seriesList.length > 0) {\n    content = seriesList.map((series, idx) => (\n      <SeriesListItem\n        key={`series-${idx}`}\n        series={series}\n        onClick={() => onResultClick(series.id)}\n        showCreatedOn\n        showLastPhoto\n      />\n    ))\n    content.push(\n      <div key='ender' ref={enderRef}>\n        <SearchEnder text={fetchMore ? 'Loading...' : 'No More Results'} />\n      </div>\n    )\n  }\n  else {\n    content = (\n      <Typography className={classes.placeholderText} variant='h4'>No series found</Typography>\n    )\n  }\n\n  return (\n    <div className={classes.root}>\n      <SearchContextItem className={classes.ctxItem} {...contextChoice} variant={variant} onCancel={onCancel} />\n      <List className={classes.list} subheader={<li />} onScroll={handleScroll} innerRef={listRef}>\n        {content}\n      </List>\n    </div>\n  )\n}\n\nSearchResults.propTypes = {\n  variant: PropTypes.oneOf(['tag', 'location', 'user']),\n  seriesList: PropTypes.array.isRequired,\n  loading: PropTypes.bool,\n  contextChoice: PropTypes.object.isRequired,\n  onResultClick: PropTypes.func.isRequired,\n  onCancel: PropTypes.func.isRequired,\n  fetchMore: PropTypes.func\n}\n\nexport default SearchResults\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\nimport Typography from '@material-ui/core/Typography'\n// import MenuIcon from '@material-ui/icons/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nconst useStyles = makeStyles(theme => ({\n  root: {\n    flexGrow: 1,\n    padding: '10%',\n    display: 'flex',\n    flexDirection: 'column',\n    opacity: 0.3,\n    textAlign: 'center'\n  },\n  icon: {\n    width: '100%',\n    flex: '1 1 40%',\n    color: theme.palette.primary.light,\n    opacity: 0.5\n  },\n  primary: {\n    flex: '1 1 30%',\n    width: '100%'\n  },\n  secondary: {\n    flex: '1 1 30%',\n    width: '100%'\n  }\n}))\n\nconst SearchPlaceholder = ({ icon, primary, secondary }) => {\n  const classes = useStyles()\n  const PlaceholderIcon = icon\n  return (\n    <div className={classes.root}>\n      <PlaceholderIcon className={classes.icon} />\n      {primary && (\n        <Typography className={classes.primary} variant='h3'>\n          {primary}\n        </Typography>\n      )}\n      {secondary && (\n        <Typography className={classes.secondary} variant='h4'>\n          {secondary}\n        </Typography>\n      )}\n    </div>\n  )\n}\n\nSearchPlaceholder.propTypes = {\n  icon: PropTypes.object,\n  primary: PropTypes.string,\n  secondary: PropTypes.string\n}\n\nexport default SearchPlaceholder\n","import React, { useEffect } from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport Tabs from '@material-ui/core/Tabs'\nimport Tab from '@material-ui/core/Tab'\n\nimport SearchContextResults from './SearchContextResults'\nimport SearchResults from './SearchResults'\nimport SearchPlaceholder from './SearchPlaceholder'\nimport TopBar from '../TopBar'\nimport SearchInput from './SearchInput'\nimport useOnline from '../../lib/useOnline'\nimport { home } from '../../config'\nimport PortableWifiOffIcon from '@material-ui/icons/PortableWifiOff'\nimport LabelIcon from '@material-ui/icons/Label'\nimport PlaceIcon from '@material-ui/icons/Place'\nimport PersonIcon from '@material-ui/icons/Person'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst TABS = home.SEARCH_TABS\n\nconst style = theme => ({\n  root: {\n    height: '100%',\n    display: 'flex',\n    overflow: 'hidden',\n    flexDirection: 'column'\n  },\n  tabs: {\n    // backgroundColor: theme.palette.primary.main,\n    // color: theme.palette.primary.contrastText,\n    // background: `linear-gradient(90deg, ${theme.palette.primary.dark} 0%, ${theme.palette.secondary.dark} 100%)`\n\n  },\n  ListWrapper: {\n    flexGrow: 1,\n    overflow: 'hidden',\n    display: 'flex',\n    flexDirection: 'column'\n  },\n  tab: {\n    flexGrow: 1\n  },\n  grow: {\n    flexGrow: 1\n  }\n})\n\nconst useStyles = makeStyles(style)\n\nconst Search = ({\n  onMenuBack, currentTab, setCurrentTab, defaultText, searchText,\n  setSearchText, contextResults, searchResults, contextChoice,\n  loading, setContextChoice, onMapClick, onResultClick, fetchMore\n}) => {\n  const classes = useStyles()\n\n  const { online } = useOnline()\n\n  // If there's only one thing then use it\n  useEffect(() => {\n    if (contextResults && !searchResults && contextResults.length === 1) {\n      setContextChoice(contextResults[0])\n    }\n  }, [contextResults])\n\n  let placeholder = {}\n  switch (currentTab) {\n    case TABS.TAG:\n      placeholder = { primary: 'Tag search', secondary: 'example: \\'beaver...\\'', icon: LabelIcon }\n      break\n    case TABS.USER:\n      placeholder = { primary: 'User search', secondary: 'example: \\'SuperGreg123...\\'', icon: PersonIcon }\n      break\n    case TABS.LOCATION:\n      placeholder = { primary: 'Location Search', secondary: 'example: \\'Vancouver...\\'', icon: PlaceIcon }\n      break\n\n    default:\n      break\n  }\n\n  let content = null\n  if (!online) {\n    content = (\n      <SearchPlaceholder\n        primary='Search Disabled'\n        secondary='(Offline)'\n        icon={PortableWifiOffIcon}\n      />\n    )\n  }\n  else if (contextChoice && searchResults) {\n    content = (\n      <SearchResults\n        variant={currentTab}\n        loading={loading}\n        onResultClick={onResultClick}\n        fetchMore={fetchMore}\n        seriesList={searchResults}\n        contextChoice={contextChoice}\n        onCancel={() => setContextChoice(null)}\n      />\n    )\n  }\n  else if (contextResults) {\n    content = (\n      <SearchContextResults\n        loading={loading}\n        variant={currentTab}\n        contextResults={contextResults}\n        setContextChoice={currentTab === TABS.LOCATION ? onMapClick : setContextChoice}\n      />\n    )\n  }\n  else if (defaultText.length > 0) {\n    content = (\n      <Typography>Searching for {`'${searchText}'` || '...'}</Typography>\n    )\n  }\n  else {\n    content = <SearchPlaceholder {...placeholder} />\n  }\n\n  return (\n    <div className={classes.root}>\n      <TopBar>\n        <SearchInput\n          disabled={!online}\n          // autoFocus\n          onChange={setSearchText}\n          defaultValue={searchText}\n        />\n      </TopBar>\n      {online && (\n        <Tabs\n          value={currentTab}\n          disabled={!online}\n          onChange={(e, val) => setCurrentTab(val)}\n          indicatorColor='primary'\n          classes={{ flexContainer: classes.tabs }}\n          centered\n        >\n          <Tab className={classes.tab} value={TABS.TAG} label='Tags' />\n          <Tab className={classes.tab} value={TABS.LOCATION} label='Places' />\n          <Tab className={classes.tab} value={TABS.USER} label='Users' />\n        </Tabs>\n      )}\n      <div className={classes.ListWrapper} >\n        {content}\n      </div>\n    </div>\n  )\n}\n\nSearch.propTypes = {\n  onMenuBack: PropTypes.func.isRequired,\n  loading: PropTypes.bool,\n  currentTab: PropTypes.string.isRequired,\n  setCurrentTab: PropTypes.func.isRequired,\n  searchText: PropTypes.string.isRequired,\n  setSearchText: PropTypes.func.isRequired,\n  fetchMore: PropTypes.func,\n  contextResults: PropTypes.array,\n  searchResults: PropTypes.array,\n  contextChoice: PropTypes.object,\n  setContextChoice: PropTypes.func.isRequired,\n  onMapClick: PropTypes.func.isRequired,\n  onResultClick: PropTypes.func.isRequired\n}\nSearch.defaultProps = {\n  currentTab: TABS.TAGS,\n  defaultText: ''\n}\n\nexport default Search\n","import React, { useState, useMemo } from 'react'\nimport PropTypes from 'prop-types'\nimport { home } from '../config'\n// import { smallestHash } from 'geotilehash'\nimport { graphql, compose } from 'react-apollo'\nimport { point, bbox as bboxFunc, buffer } from '@turf/turf'\n\nimport { connect } from 'react-redux'\nimport actions from '../redux/actions'\nimport { tagSearch, seriesWithTag, userSearch, userSeries, geocode } from './queries'\nimport Search from '../components/Search/Search'\n// import { AppContext } from '../contexts'\n// import { debounce } from '../lib/util'\nimport { formatDatAgo } from '../lib/datelib'\n\nconst SearchConnect = ({\n  jumpToMap, jumpToSeries, defaultTab, defaultText, fetchMore\n}) => {\n  // const { role, user } = useContext(AppContext)\n\n  const [currentTab, setCurrentTab] = useState(defaultTab || home.SEARCH_TABS.TAG)\n  // We separate these because one of them needs to be immediate and the\n  const [searchText, setSearchText] = useState(defaultText || '')\n  const [contextChoice, setContextChoice] = useState(null)\n\n  const handleTabChange = (newTab) => {\n    setContextChoice(null)\n    setCurrentTab(newTab)\n  }\n  const handleContextChoiceChange = (newContextChoice) => {\n    setContextChoice(newContextChoice)\n  }\n  const handleSearchTextChange = (text) => {\n    setSearchText(text)\n    setContextChoice(null)\n  }\n\n  let withContextQuery = null\n  let withSearchQuery = null\n\n  switch (currentTab) {\n    case home.SEARCH_TABS.TAG:\n      withContextQuery = withTagSearch\n      withSearchQuery = withTagSeries\n      break\n    case home.SEARCH_TABS.LOCATION:\n      withContextQuery = withGeoCode\n      // withSearchQuery = withGeoSearch\n      break\n    case home.SEARCH_TABS.USER:\n      withContextQuery = withUserSearch\n      withSearchQuery = withUserSeries\n      break\n    default:\n      break\n  }\n\n  const ComposedSearch = useMemo(() => withSearchQuery\n    ? compose(\n      withContextQuery,\n      withSearchQuery\n    )(Search)\n    : withContextQuery(Search), [withContextQuery, withSearchQuery])\n\n  return <ComposedSearch {...{ currentTab, searchText, contextChoice }}\n    onMenuBack={() => {}}\n    onMapClick={jumpToMap}\n    onResultClick={jumpToSeries}\n    setContextChoice={handleContextChoiceChange}\n    fetchMore={fetchMore}\n    setCurrentTab={handleTabChange}\n    setSearchText={handleSearchTextChange}\n  />\n}\nSearchConnect.propTypes = {\n  searchResults: PropTypes.array,\n  contextResults: PropTypes.array,\n  loading: PropTypes.bool,\n  jumpToMap: PropTypes.func,\n  jumpToSeries: PropTypes.func,\n  fetchMore: PropTypes.func\n}\n/*****************************************************************\n *  PART 1: SEARCH QUERIES\n *****************************************************************/\n\n/**\n * Here's the graphql HOC that gets an individual series\n */\nconst withTagSearch = graphql(tagSearch, {\n  props: ({ data }) => {\n    if (data.error) console.error(data.error)\n    // console.log('withTagSearch', data)\n    let series = null\n    try {\n      if (!data.loading && !data.error) series = data.series\n    }\n    catch (e) {\n      console.error(data)\n      console.error(e)\n    }\n    const contextResults = data.tags ? data.tags.map(({ name, count }) => ({\n      name,\n      description: `~ ${count < 10 ? count : Math.ceil(count / 10) * 10} Photo series tagged`\n    })) : []\n\n    return {\n      contextResults,\n      loading: data.loading,\n      series\n    }\n  },\n  // skip: ({ searchText }) => !searchText || searchText.length < 3,\n  options: ({ searchText }) => ({\n    variables: {\n      tag: !searchText || searchText.length < 3 ? '' : searchText,\n      limit: 10\n    }\n  })\n})\n\nconst withUserSearch = graphql(userSearch, {\n  props: ({ data }) => {\n    if (data.error) console.error(data.error)\n    // console.log('withUserSearch', data)\n    let series = null\n    try {\n      if (!data.loading && !data.error) series = data.series\n    }\n    catch (e) {\n      console.error(data)\n      console.error(e)\n    }\n\n    const contextResults = data.userSearch ? data.userSearch.map(({ username, gravatar, createdOn, id }) => ({\n      name: username,\n      id,\n      description: `Joined ${formatDatAgo(createdOn)}`,\n      gravatar\n    })) : []\n\n    return {\n      contextResults,\n      loading: data.loading,\n      series\n    }\n  },\n  skip: ({ searchText }) => !searchText || searchText.length < 3,\n  options: ({ searchText }) => ({\n    variables: {\n      searchStr: searchText,\n      limit: 10\n    }\n  })\n})\n\nconst withGeoCode = graphql(geocode, {\n  props: ({ data }) => {\n    if (data.error) console.error(data.error)\n    // console.log('withGeoCode', data)\n    let series = null\n    try {\n      if (!data.loading && !data.error) series = data.series\n    }\n    catch (e) {\n      console.error(data)\n      console.error(e)\n    }\n\n    const contextResults = data.geocoder ? data.geocoder.map(({ relevance, text, placeName, bbox, center }) => ({\n      name: text,\n      description: placeName,\n      bbox,\n      center,\n      relevance\n    })) : []\n\n    return {\n      contextResults,\n      loading: data.loading,\n      series\n    }\n  },\n  skip: ({ searchText }) => !searchText || searchText.length < 3,\n  options: ({ searchText }) => ({\n    variables: {\n      search: searchText\n      // limit: 10\n    }\n  })\n})\n\n/*****************************************************************\n * PART 2: SERIES SEARCH QUERIES\n *****************************************************************/\n\nconst withTagSeries = graphql(seriesWithTag, {\n  props: ({ data }) => {\n    if (data.error) console.error(data.error)\n    // console.log('withTagSeries', data)\n    let series = null\n    try {\n      if (!data.loading && !data.error) series = data.series\n    }\n    catch (e) {\n      console.error(data)\n      console.error(e)\n    }\n\n    // A second Thunk function designed to get more elements in the feed history\n    const fetchMore = data.loading || !data.tagSeries || !data.tagSeries.nextToken ? null : () => {\n      console.log('fetchMore', data)\n      data.fetchMore({\n        variables: { ...data.variables, nextToken: data.tagSeries.nextToken },\n        // How do we mush the new query with the old one\n        updateQuery: (prev, { fetchMoreResult }) => {\n          return {\n            tagSeries: {\n              ...fetchMoreResult.tagSeries,\n              seriesSummaries: [ ...prev.tagSeries.seriesSummaries, ...fetchMoreResult.tagSeries.seriesSummaries ]\n            }\n          }\n        }\n      })\n    }\n\n    const searchResults = data.tagSeries && data.tagSeries.seriesSummaries\n      ? data.tagSeries.seriesSummaries\n      : []\n\n    return {\n      searchResults,\n      fetchMore,\n      loading: data.loading,\n      series\n    }\n  },\n  skip: ({ contextChoice }) => !contextChoice,\n  options: ({ contextChoice }) => ({\n    variables: {\n      tag: contextChoice.name,\n      limit: 10\n    }\n  })\n})\n\nconst withUserSeries = graphql(userSeries, {\n  props: ({ data }) => {\n    if (data.error) console.error(data.error)\n    // console.log('withUserSeries', data)\n    let series = null\n    try {\n      if (!data.loading && !data.error) series = data.series\n    }\n    catch (e) {\n      console.error(data)\n      console.error(e)\n    }\n\n    // A second Thunk function designed to get more elements in the feed history\n    const fetchMore = data.loading || !data.userSeries || !data.userSeries.nextToken ? null : () => {\n      console.log('fetchMore', data)\n      data.fetchMore({\n        variables: { ...data.variables, nextToken: data.userSeries.nextToken },\n        // How do we mush the new query with the old one\n        updateQuery: (prev, { fetchMoreResult }) => {\n          return {\n            userSeries: {\n              ...fetchMoreResult.userSeries,\n              seriesSummaries: [ ...prev.userSeries.seriesSummaries, ...fetchMoreResult.userSeries.seriesSummaries ]\n            }\n          }\n        }\n      })\n    }\n\n    const searchResults = data.userSeries && data.userSeries.seriesSummaries\n      ? data.userSeries.seriesSummaries\n      : []\n\n    return {\n      searchResults,\n      fetchMore,\n      loading: data.loading,\n      series\n    }\n  },\n  skip: ({ contextChoice }) => !contextChoice,\n  options: ({ contextChoice }) => ({\n    variables: {\n      createdBy: contextChoice.id,\n      limit: 10\n    }\n  })\n})\n\n// const withGeoSearch = graphql(geoSeries, {\n//   props: ({ data }) => {\n//     if (data.error) console.error(data.error)\n//     // console.log('HERE', data)\n//     let series = null\n//     try {\n//       if (!data.loading && !data.error) series = data.series\n//     }\n//     catch (e) {\n//       console.error(data)\n//       console.error(e)\n//     }\n//     return {\n//       data,\n//       loading: data.loading,\n//       series\n//     }\n//   },\n//   skip: ({ contextChoice }) => !contextChoice,\n//   options: ({ contextChoice }) => ({\n//     variables: {\n//       bounds: contextChoice.bbox\n//       // limit: 10\n//       // nextToken\n//     }\n//   })\n// })\n\n/**\n * Map our redux state and functions\n */\nconst mapStateToProps = (state, props) => {\n  const { current: { search, activeSeries, domain } } = state.home\n  return {\n    defaultTab: search ? search.tab : null,\n    defaultText: search ? search.text : null,\n    activeSeries,\n    domain\n  }\n}\n\nconst mapDispatchToProps = dispatch => ({\n  onBack: () => {\n    dispatch(actions.homeStateBack())\n  },\n  queueUpload: (uploadObj) => {\n    dispatch(actions.queueUpload(uploadObj))\n  },\n  jumpToSeries: (seriesId) => {\n    dispatch(actions.setHomeState(home.AppStateTypes.SERIES, { activeSeries: seriesId }))\n  },\n\n  jumpToMap: ({ bbox, center }) => {\n    let bounds = bbox\n    if (!bounds && center) {\n      const bufferPts = buffer(point(center), 500, { units: 'meters' })\n      bounds = bboxFunc(bufferPts)\n    }\n\n    if (bounds) {\n      dispatch(actions.pushMapHistory({\n        mode: home.MapModeTypes.FREE,\n        bounds: bounds\n      }))\n      dispatch(actions.setHomeState(home.AppStateTypes.MAP, { activeSeries: null, initialPhoto: null }))\n    }\n  }\n})\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(SearchConnect)\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemText from '@material-ui/core/ListItemText'\nimport ListItemIcon from '@material-ui/core/ListItemIcon'\n// import MenuIcon from '@material-ui/icons/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { formatDate } from '../../lib/datelib'\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n  },\n  imgContainer: {\n    flex: '0 0 100px',\n    // alignSelf: 'flex-start',\n    // height: '100%',\n    margin: theme.spacing(1, 1, 0, 2)\n  },\n  gravatarImg: {\n    verticalAlign: 'top'\n    // objectFit: 'cover',\n    // height: '100%',\n    // width: '100%'\n  }\n}))\n\nconst MeCard = ({ user, loading, onAvatarClick }) => {\n  const classes = useStyles()\n\n  if (loading || !user) return 'LOADING...'\n  // console.log('USER', user)\n\n  return (\n    <ListItem className={classes.root} onClick={onAvatarClick} disableGutters>\n      <ListItemIcon className={classes.imgContainer}>\n        <img alt='profile' className={classes.gravatarImg} src={user.gravatar} />\n      </ListItemIcon>\n      <ListItemText\n        primary={user.username}\n        secondary={`Member since: ${formatDate(user.createdOn, 'LL')}`}\n      />\n    </ListItem>\n  )\n}\n\nMeCard.propTypes = {\n  user: PropTypes.object,\n  loading: PropTypes.bool,\n  onAvatarClick: PropTypes.func\n}\n\nexport default MeCard\n","import React, { useState, useContext } from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport Divider from '@material-ui/core/Divider'\nimport Tabs from '@material-ui/core/Tabs'\nimport Tab from '@material-ui/core/Tab'\n\nimport SeriesListItem from '../misc/SeriesListItem'\nimport { makeStyles } from '@material-ui/core/styles'\nimport TopBar from '../TopBar'\nimport MeCard from './MeCard'\nimport { Button } from '@material-ui/core'\n\nimport { AppContext } from '../../contexts'\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    background: theme.palette.background.paper,\n    display: 'flex',\n    flexDirection: 'column',\n    height: '100%'\n  },\n  filterContainer: {\n    color: theme.palette.primary.secondary,\n    background: theme.palette.background.default,\n    textAlign: 'center',\n    padding: theme.spacing(1, 1)\n  },\n  filterChip: {\n\n  },\n  seriesListItemWrap: {\n    margin: theme.spacing(1, 0.5)\n  },\n  seriesList: {\n    height: '100%',\n    overflowX: 'hidden',\n    overflowY: 'scroll'\n  },\n  tabs: {\n    // background: theme.palette.background.default\n  },\n  noneFound: {\n    color: theme.palette.text.secondary,\n    textAlign: 'center',\n    padding: theme.spacing(2)\n  }\n}))\n\nconst SORT = {\n  ACTIVITY: 'Last Photo',\n  CREATED: 'Created',\n  NAME: 'Name'\n}\n\nconst MyProfile = ({ mySeries, watchingSeries, loading, jumpToSeries, jumpToMap }) => {\n  const classes = useStyles()\n  const [currentTab, setCurrentTab] = useState(0)\n  const [sortVal, setSort] = useState(SORT.ACTIVITY)\n  const [sortAsc, setSortAsc] = useState(false)\n\n  const { user } = useContext(AppContext)\n\n  const sortSetter = (newSort) => {\n    if (newSort === sortVal) setSortAsc(!sortAsc)\n    else setSort(newSort)\n  }\n\n  let tabFeed = currentTab === 0 ? mySeries : watchingSeries\n\n  switch (sortVal) {\n    case SORT.ACTIVITY:\n      if (sortAsc) tabFeed.sort((a, b) => a.latest.takenOn - b.latest.takenOn)\n      else tabFeed.sort((a, b) => b.latest.takenOn - a.latest.takenOn)\n      break\n    case SORT.CREATED:\n      if (sortAsc) tabFeed.sort((a, b) => a.createdOn - b.createdOn)\n      else tabFeed.sort((a, b) => b.createdOn - a.createdOn)\n      break\n    case SORT.NAME:\n      if (sortAsc) {\n        tabFeed.sort((a, b) => {\n          if (a.name < b.name) {\n            return -1\n          }\n          if (a.name > b.firstname) {\n            return 1\n          }\n          return 0\n        })\n      }\n      else {\n        tabFeed.sort((a, b) => {\n          if (b.name < a.name) {\n            return -1\n          }\n          if (b.name > a.name) {\n            return 1\n          }\n          return 0\n        })\n      }\n      break\n    default:\n      break\n  }\n\n  return (\n    <div className={classes.root}>\n      <TopBar>\n        <Typography>My Profile</Typography>\n      </TopBar>\n      <MeCard user={user} />\n      {/* <Divider /> */}\n      <Tabs\n        value={currentTab}\n        onChange={(e, val) => setCurrentTab(val)}\n        indicatorColor='primary'\n        centered\n        classes={{ flexContainer: classes.tabs }}\n      >\n        <Tab className={classes.tab} value={0} label='My Series' />\n        <Tab className={classes.tab} value={1} label='Watching' />\n      </Tabs>\n      <Divider />\n      <div className={classes.filterContainer}>\n        <FilterSortItem asc={sortAsc} active={sortVal === SORT.NAME} onClick={() => sortSetter(SORT.NAME)} label={SORT.NAME} />\n        |\n        <FilterSortItem asc={sortAsc} active={sortVal === SORT.ACTIVITY} onClick={() => sortSetter(SORT.ACTIVITY)} label={SORT.ACTIVITY} />\n        |\n        <FilterSortItem asc={sortAsc} active={sortVal === SORT.CREATED} onClick={() => sortSetter(SORT.CREATED)} label={SORT.CREATED} />\n      </div>\n      <Divider />\n      <div className={classes.seriesList}>\n        {!loading && (!tabFeed || tabFeed.length === 0) && (\n          <Typography className={classes.noneFound} component='div'>No Series Found</Typography>\n        )}\n        {loading && (\n          <Typography className={classes.noneFound} component='div'>Loading...</Typography>\n        )}\n        {tabFeed.map((series, idx) => (\n          <SeriesListItem\n            key={`seriesListItem${idx}`}\n            series={series}\n            showCreatedOn\n            showLastPhoto\n            onClick={() => jumpToSeries(series.id)}\n          />\n        ))}\n      </div>\n    </div>\n  )\n}\n\nMyProfile.propTypes = {\n  loading: PropTypes.bool,\n  mySeries: PropTypes.array.isRequired,\n  watchingSeries: PropTypes.array.isRequired,\n  jumpToSeries: PropTypes.func.isRequired,\n  jumpToMap: PropTypes.func.isRequired\n}\n\nexport default MyProfile\n\nconst useFilterStyles = makeStyles(theme => ({\n  root: {\n    margin: theme.spacing(0, 1, 0, 1)\n  }\n}))\n\nconst FilterSortItem = ({ active, asc, onClick, label }) => {\n  const classes = useFilterStyles()\n\n  const arrow = asc === true ? '' : ''\n\n  return (\n    <Button\n      size='small'\n      className={classes.root}\n      onClick={onClick}\n      // variant='caption'\n      color={active ? 'secondary' : 'inherit'}\n    >\n      {label}\n      <span style={{ opacity: active ? 1 : 0 }}>\n        {arrow}\n      </span>\n    </Button>\n  )\n}\n\nFilterSortItem.propTypes = {\n  active: PropTypes.bool,\n  asc: PropTypes.bool,\n  onClick: PropTypes.func.isRequired,\n  label: PropTypes.string.isRequired\n}\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport { graphql, compose } from 'react-apollo'\nimport actions from '../redux/actions'\nimport { connect } from 'react-redux'\nimport { home } from '../config'\n\nimport { userSeries, seriesFromList } from './queries'\nimport MyProfile from '../components/MyProfile/MyProfile'\n\nconst ProfileConnect = ({ data, jumpToSeries, jumpToMap }) => {\n  const { seriesQ, watchedSeriesQ } = data\n\n  const mySeries = seriesQ && seriesQ.userSeries && seriesQ.userSeries.seriesSummaries ? seriesQ.userSeries.seriesSummaries : []\n  const watchingSeries = watchedSeriesQ && watchedSeriesQ.arraySeries ? watchedSeriesQ.arraySeries : []\n  // console.log('ProfileConnect', { mySeries, watchedSeriesQ, watchingSeries })\n\n  const loading = Boolean(\n    (seriesQ && seriesQ.loading) ||\n    (watchedSeriesQ && watchedSeriesQ.loading)\n  )\n\n  return <MyProfile {...{ loading, mySeries, watchingSeries, jumpToSeries, jumpToMap }} />\n}\n\nProfileConnect.propTypes = {\n  data: PropTypes.object, // from graphql\n  jumpToSeries: PropTypes.func, // from redux\n  jumpToMap: PropTypes.func // from redux\n}\n\nconst withuserSeriesQuery = graphql(userSeries, {\n  props: ({ data, ownProps }) => {\n    // console.log('ProfileConnect withuserSeriesQuery', { data, ownProps })\n    return { data: { ...ownProps.data, seriesQ: data } }\n  }\n})\n\nconst withMyWatchedSeriesQuery = graphql(seriesFromList, {\n  props: ({ data, ownProps }) => {\n    // console.log('ProfileConnect withMyWatchedSeriesQuery', { data, ownProps })\n    return { data: { ...ownProps.data, watchedSeriesQ: data } }\n  },\n  skip: ({ data, user }) => {\n    try {\n      return user.watching.length < 1\n    }\n    catch (e) {\n      return true\n    }\n  },\n  options: ({ data, user }) => {\n    return {\n      variables: { seriesList: user.watching }\n    }\n  }\n})\n\n/**\n * Compose all our queries together\n */\nconst queryWrapped = compose(\n  withuserSeriesQuery,\n  // withMyPhotosQuery,\n  withMyWatchedSeriesQuery\n)(ProfileConnect)\n\n/**\n * Map our redux state and functions\n */\nconst mapStateToProps = (state, props) => {\n  return { }\n}\n\nconst mapDispatchToProps = dispatch => ({\n  jumpToSeries: (seriesId) => {\n    dispatch(actions.setHomeState(home.AppStateTypes.SERIES, { activeSeries: seriesId }))\n  },\n  jumpToMap: (seriesId) => {\n    dispatch(actions.setHomeState(home.AppStateTypes.MAP, { activeSeries: seriesId }))\n  }\n})\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(queryWrapped)\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\n// import MenuIcon from '@material-ui/icons/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nconst useStyles = makeStyles(theme => ({\n  root: {\n    display: 'flex',\n    alignItems: 'center'\n  },\n  grow: { flexGrow: 1 },\n  text: {\n    textAlign: 'center',\n    fontStyle: 'italic',\n    padding: theme.spacing(2, 1)\n  }\n}))\n\nconst FeedEnder = ({ style, icon, text }) => {\n  const classes = useStyles()\n  return (\n    <div className={classes.root}>\n      <div className={classes.grow} />\n      {icon}\n      <Typography className={classes.text} variant='subtitle1' color='textSecondary' component='div' style={style}>\n        {text}\n      </Typography>\n      <div className={classes.grow} />\n    </div>\n  )\n}\n\nFeedEnder.propTypes = {\n  style: PropTypes.object,\n  icon: PropTypes.any,\n  text: PropTypes.string\n}\n\nexport default FeedEnder\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Avatar from '@material-ui/core/Avatar'\nimport IconButton from '@material-ui/core/IconButton'\n\nimport PlaceIcon from '@material-ui/icons/Place'\nimport { makeStyles } from '@material-ui/core/styles'\nconst useStyles = makeStyles(theme => ({\n  root: {\n    textAlign: 'center'\n  },\n  placeAvatar: {\n    color: theme.palette.primary.contrastText,\n    border: `2px solid ${theme.palette.primary.contrastText}`,\n    background: theme.palette.text.primary,\n    margin: 'auto'\n  },\n  placeIcon: {\n  }\n}))\n\nconst FindOnMapButton = ({ onClick }) => {\n  const classes = useStyles()\n  return (\n    <div className={classes.root}>\n      <Avatar className={classes.placeAvatar}>\n        <IconButton color='inherit' onClick={e => {\n          e.preventDefault()\n          e.stopPropagation()\n          onClick()\n        }}>\n          <PlaceIcon color='inherit' />\n        </IconButton>\n      </Avatar>\n      {/* <Typography variant='caption' component='div'>MAP</Typography> */}\n    </div>\n  )\n}\n\nFindOnMapButton.propTypes = {\n  onClick: PropTypes.func.isRequired\n}\n\nexport default FindOnMapButton\n","import React, { useContext } from 'react'\nimport PropTypes from 'prop-types'\nimport Paper from '@material-ui/core/Paper'\nimport Typography from '@material-ui/core/Typography'\n// import MenuIcon from '@material-ui/icons/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nimport FindOnMapButton from '../misc/FindOnMapButton'\n// import StarIcon from '@material-ui/icons/Star'\n// import StarBorderIcon from '@material-ui/icons/StarBorder'\nimport { Avatar } from '@material-ui/core'\nimport { AppContext } from '../../contexts'\nimport { formatDate } from '../../lib/datelib'\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    height: '100%',\n    // borderTop: `4px solid ${theme.palette.grey[700]}`\n    padding: theme.spacing(0.5, 1)\n  },\n  imgContainer: {\n    overflow: 'hidden',\n    height: '100%',\n    position: 'relative'\n  },\n  findOnMapButtonContainer: {\n    position: 'absolute',\n    opacity: 0.8,\n    bottom: theme.spacing(1),\n    right: theme.spacing(1)\n  },\n  titleContainer: {\n    background: '#444444AA',\n    textShadow: '1px 1px 10px black',\n    color: 'white',\n    position: 'absolute',\n    alignItems: 'center',\n    display: 'flex',\n    top: 0,\n    width: '100%',\n    paddingRight: theme.spacing(1)\n  },\n  avatar: {\n    border: '1px solid white',\n    margin: theme.spacing(0, 1)\n  },\n  title: {\n    flex: '1 1 50%',\n    overflow: 'hidden'\n  },\n  seriesName: {\n    textOverflow: 'ellipsis',\n    whiteSpace: 'nowrap',\n    overflow: 'hidden'\n  },\n  img: {\n    objectFit: 'cover',\n    height: '100%',\n    width: '100%'\n  },\n  gravatarImg: {\n    width: '100%'\n  }\n}))\n\nconst EVENT_VERBS = {\n  DELETE: 'Deleted',\n  ADD: 'Added'\n}\n\nconst FeedItem = ({ event, onMapClick, onImageClick, onProfileClick, onSeriesClick }) => {\n  const { series, photo } = event\n  // console.log('EVENT', { series, relation, photo })\n  const classes = useStyles()\n  const { seriesConfig } = useContext(AppContext)\n  return (\n    <div className={classes.root}>\n      <Paper className={classes.imgContainer}>\n        <img\n          alt='medium'\n          className={classes.img}\n          src={seriesConfig.getPhotoUrl(photo, 'medium')}\n          onClick={() => onImageClick(series.id, photo.id)}\n        />\n        <div className={classes.titleContainer}>\n          <Avatar onClick={() => onProfileClick(photo.createdUser.username)} className={classes.avatar}>\n            <img alt='profile' className={classes.gravatarImg} src={photo.createdUser.gravatar} />\n          </Avatar>\n          <div className={classes.title}>\n            <Typography className={classes.seriesName} variant='body1' color='inherit'>{series.name}</Typography>\n            <Typography variant='body2' color='inherit'>{photo.createdUser.username} {EVENT_VERBS.ADD} a photo</Typography>\n            <Typography variant='caption' color='inherit'>{formatDate(photo.updatedOn)}</Typography>\n          </div>\n          <FindOnMapButton onClick={() => onMapClick(series.id, photo.id)} />\n        </div>\n      </Paper>\n    </div>\n  )\n}\n\nFeedItem.propTypes = {\n  // TODO: THIS IS NOT THE SHAPE WE WANT. NEED TO HASH THIS OUT\n  event: PropTypes.object.isRequired,\n  onSeriesClick: PropTypes.func.isRequired,\n  onImageClick: PropTypes.func.isRequired,\n  onProfileClick: PropTypes.func.isRequired,\n  onMapClick: PropTypes.func.isRequired\n}\n\nexport default FeedItem\n\nexport const FeedItemCosmos = (props) => {\n  return (\n    <div>\n      <FeedItem {...props} />\n      <FeedItem {...props} />\n      <FeedItem {...props} />\n      <FeedItem {...props} />\n      <FeedItem {...props} />\n      <FeedItem {...props} />\n      <FeedItem {...props} />\n      <FeedItem {...props} />\n      <FeedItem {...props} />\n      <FeedItem {...props} />\n      <FeedItem {...props} />\n    </div>\n  )\n}\nFeedItemCosmos.propTypes = {\n  // TODO: THIS IS NOT THE SHAPE WE WANT. NEED TO HASH THIS OUT\n  event: PropTypes.object.isRequired\n}\n","import React, { useRef } from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\n\nimport { List } from 'react-virtualized' // InfiniteLoader\nimport useOnline from '../../lib/useOnline'\nimport FeedEnder from './FeedEnder'\n\nimport ErrorIcon from '@material-ui/icons/Error'\nimport { makeStyles } from '@material-ui/core/styles'\nimport FeedItem from './FeedItem'\n\nimport TopBar from '../TopBar'\n\nimport useComponentSize from '../../lib/useComponentSize'\nimport { CircularProgress } from '@material-ui/core'\n\nconst ROWHEIGHT = 300\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    display: 'flex',\n    flexDirection: 'column',\n    height: '100%'\n  },\n  listContainer: {\n    flexGrow: 1,\n    overflow: 'hidden'\n  },\n  vList: {\n    height: '100%',\n    width: '100%'\n  },\n  feedContainer: {\n    flexGrow: 1,\n    // Promote the list into his own layer on Chrome. This cost memory but helps keeping high FPS.\n    transform: 'translateZ(0)'\n  },\n  grow: {\n    flexGrow: 1\n  }\n}))\n\nconst MyFeed = ({\n  events, loading, onMapClick, onImageClick, onProfileClick,\n  onSeriesClick, fetchNewest, fetchMore, window\n}) => {\n  const classes = useStyles()\n  const listRef = useRef()\n  const { size } = useComponentSize(listRef)\n  const { online } = useOnline()\n\n  const rowRenderer = ({\n    index, // Index of row\n    isScrolling, // The List is currently being scrolled\n    isVisible, // This row is visible within the List (eg it is not an overscanned row)\n    key, // Unique key within array of rendered rows\n    parent, // Reference to the parent List (instance)\n    style // Style object to be applied to row (to position it);\n    // This must be passed through to the rendered row element.\n  }) => {\n    const row = events[index]\n    let content\n    if (index < events.length && row) {\n      content = <FeedItem\n        event={events[index]}\n        onSeriesClick={onSeriesClick}\n        onImageClick={onImageClick}\n        onProfileClick={onProfileClick}\n        onMapClick={onMapClick}\n      />\n    }\n    else if (index === events.length) {\n      // content = <div className={classes.placeholder} style={{ width: row.size }} />\n      const wEnd = window && window[0] === 0\n      content = <FeedEnder icon={<CircularProgress size={30} thickness={2} color='inherit' />} text='Loading...' />\n\n      const almostAtEnd = ROWHEIGHT * 4 + parent.state.scrollTop > style.top\n\n      if (!online) {\n        content = <FeedEnder icon={<ErrorIcon />} text='Cannot Refresh Offline' />\n      }\n      else if (wEnd) {\n        content = <FeedEnder text='End of feed' />\n      }\n      // Only if we're online, not loading and visible\n      else if (!loading && almostAtEnd) {\n        fetchMore()\n      }\n    }\n\n    return (\n      <div className={classes.row} key={key} style={style}>\n        {content}\n      </div>\n    )\n  }\n  rowRenderer.propTypes = {\n    index: PropTypes.any,\n    key: PropTypes.any,\n    style: PropTypes.any,\n    isScrolling: PropTypes.any,\n    isVisible: PropTypes.any,\n    parent: PropTypes.any\n  }\n\n  // console.log('DEBUGLIST', size)\n\n  return (\n    <div className={classes.root}>\n      <TopBar>\n        <Typography className={classes.grow}>Home Feed</Typography>\n      </TopBar>\n      <div className={classes.listContainer} ref={listRef}>\n        <List\n          height={size.height}\n          width={size.width}\n          className={classes.vList}\n          rowCount={events.length + 1}\n          rowHeight={ROWHEIGHT}\n          rowRenderer={rowRenderer}\n        />\n      </div>\n    </div>\n  )\n}\n\nMyFeed.propTypes = {\n  events: PropTypes.array.isRequired,\n  loading: PropTypes.bool,\n  window: PropTypes.arrayOf(PropTypes.number),\n  onSeriesClick: PropTypes.func.isRequired,\n  onImageClick: PropTypes.func.isRequired,\n  onProfileClick: PropTypes.func.isRequired,\n  onMapClick: PropTypes.func.isRequired,\n  fetchNewest: PropTypes.func.isRequired,\n  fetchMore: PropTypes.func.isRequired\n}\n\nexport default MyFeed\n","import React, { useRef, useState, useEffect } from 'react'\nimport PropTypes from 'prop-types'\nimport { graphql } from 'react-apollo'\nimport { home } from '../config'\nimport actions from '../redux/actions'\nimport { connect } from 'react-redux'\nimport { getMyFeed } from './queries'\nimport MyFeed from '../components/MyFeed/MyFeed'\nimport useOnline from '../lib/useOnline'\n\nconst POLL_INTERVAL = 20 // (seconds)\nconst FEED_LIMIT = 5 // (items to load)\n\nconst FeedConnect = ({\n  data, loading, fetchMore, fetchNewest,\n  loadingNewest,\n  loadingMore,\n  jumpToSeries,\n  jumpToMap,\n  jumpToUser\n}) => {\n  const timerRef = useRef()\n  const { online } = useOnline()\n  const [lastCheck, setLastCheck] = useState(null)\n  timerRef.current = lastCheck\n\n  // Initiate the polling process. We simply update the timestamp every N seconds\n  useEffect(() => {\n    function ping () {\n      if (!loading && online) fetchNewest()\n      if (timerRef.current) setLastCheck(String(Date.now() - POLL_INTERVAL * 1000))\n    }\n    if (!timerRef.current) timerRef.current = setInterval(ping, POLL_INTERVAL * 1000)\n    return () => {\n      if (timerRef.current) {\n        console.log('clear poll timer')\n        clearInterval(timerRef.current)\n        timerRef.current = null\n      }\n    }\n  }, [])\n\n  const events = data.myFeed ? data.myFeed.feed || [] : []\n  const window = data.myFeed ? data.myFeed.window.map(v => parseInt(v, 10)) || [null, null] : [null, null]\n\n  return (\n    <MyFeed {...{ events, loading, window, fetchMore, fetchNewest, jumpToSeries }}\n      onSeriesClick={() => {}}\n      onImageClick={jumpToSeries}\n      onProfileClick={jumpToUser}\n      onMapClick={jumpToMap}\n    />\n  )\n}\n\nFeedConnect.propTypes = {\n  data: PropTypes.object, // from graphql\n  loading: PropTypes.bool, // from graphql\n  loadingNewest: PropTypes.bool, // from graphql\n  loadingMore: PropTypes.bool, // from graphql\n  fetchMore: PropTypes.func,\n  fetchNewest: PropTypes.func,\n  jumpToSeries: PropTypes.func,\n  jumpToMap: PropTypes.func,\n  jumpToUser: PropTypes.func\n}\n\nconst withFeedQuery = graphql(getMyFeed, {\n  props: ({ data }) => {\n    if (data.error) console.error(data.error)\n\n    // TODO: Not sure this will propagate correctly. Test it.\n    let loadingNewest = false\n    let loadingMore = false\n\n    // console.log('withFeedQuery', data)\n\n    // One Thunk function designed for getting everything since the last check\n    const fetchNewest = () => {\n      loadingNewest = true\n      console.log('fetchNewest', data)\n      if (data.myFeed) {\n        data.fetchMore({\n          variables: { ...data.variables, start: data.myFeed.window[1] },\n          // How do we mush the new query with the old one\n          updateQuery: (prev, { fetchMoreResult }) => {\n            loadingNewest = false\n            return {\n              myFeed: {\n                ...fetchMoreResult.myFeed,\n                // put the newest stuff first\n                feed: [ ...fetchMoreResult.myFeed.feed, ...prev.myFeed.feed ],\n                window: [prev.myFeed.window[0], fetchMoreResult.myFeed.window[1]]\n              }\n            }\n          }\n        })\n      }\n    }\n\n    // A second Thunk function designed to get more elements in the feed history\n    const fetchMore = () => {\n      loadingMore = true\n      console.log('fetchMore', data)\n      if (data.myFeed) {\n        data.fetchMore({\n          variables: { ...data.variables, end: data.myFeed.window[0] },\n          // How do we mush the new query with the old one\n          updateQuery: (prev, { fetchMoreResult }) => {\n            loadingMore = false\n            return {\n              myFeed: {\n                ...fetchMoreResult.myFeed,\n                feed: [ ...prev.myFeed.feed, ...fetchMoreResult.myFeed.feed ],\n                window: [fetchMoreResult.myFeed.window[0], prev.myFeed.window[1]]\n              }\n            }\n          }\n        })\n      }\n    }\n\n    return {\n      data,\n      loadingNewest,\n      loadingMore,\n      fetchNewest, // This is the poll we do every n seconds\n      fetchMore, // This is when we scroll to the bottom of the list\n      loading: data.loading\n    }\n  },\n  // skip: ({ activeSeries, isNewSeries }) => !activeSeries || isNewSeries,\n  options: ({ activeSeries }) => ({\n    variables: {\n      limit: FEED_LIMIT\n    }\n  })\n})\n\n/**\n * Map our redux state and functions\n */\nconst mapStateToProps = (state, props) => {\n  return { }\n}\n\n// We're using graphql() HOC because it's convenient but it doesn't need to render anything\n// const FeedQueryConnect = withFeedQuery(() => null)\nconst mapDispatchToProps = dispatch => ({\n  jumpToSeries: (seriesId, photoId) => {\n    dispatch(actions.setHomeState(home.AppStateTypes.SERIES, { activeSeries: seriesId, initialPhoto: photoId }))\n  },\n  jumpToUser: (username) => {\n    dispatch(actions.setHomeState(home.AppStateTypes.SEARCH, { search: { tab: home.SEARCH_TABS.USER, text: username } }))\n  },\n  jumpToMap: (seriesId, photoId) => {\n    dispatch(actions.pushMapHistory({\n      mode: home.MapModeTypes.FREE\n    }))\n    dispatch(actions.setHomeState(home.AppStateTypes.MAP, { activeSeries: seriesId, initialPhoto: photoId }))\n  }\n})\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(\n  withFeedQuery(FeedConnect)\n)\n","import React, { useState, useEffect, useCallback } from 'react'\nimport PropTypes from 'prop-types'\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport AppBar from '@material-ui/core/AppBar'\nimport Toolbar from '@material-ui/core/Toolbar'\nimport Snackbar from '@material-ui/core/Snackbar'\nimport SnackbarContent from '@material-ui/core/SnackbarContent'\nimport IconButton from '@material-ui/core/IconButton'\nimport Typography from '@material-ui/core/Typography'\nimport QRcodeIcon from '../../../icons/QRCode'\nimport jsQR from 'jsqr'\nimport { debounce } from '../../../lib/util'\nimport {\n  green, red\n} from '@material-ui/core/colors'\n\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack'\nimport Paper from '@material-ui/core/Paper'\n// import MenuIcon from '@material-ui/icons/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { useCamera } from '../../../lib/useCamera'\n\nconst CAMERAWIDTH = 400\nconst CAMERAHEIGHT = 400\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    display: 'flex',\n    height: '100%',\n    flexDirection: 'column'\n  },\n  qrIcon: {\n    border: '5px solid red',\n    padding: theme.spacing(2),\n    position: 'absolute',\n    color: 'white',\n    opacity: 0.4,\n    zIndex: 2,\n    width: '70%',\n    height: '70%',\n    top: '50%',\n    left: '50%',\n    transformOrigin: '50% 50%',\n    transform: 'translateY(-50%) translateX(-50%)'\n  },\n  appBar: {\n\n  },\n  inner: {\n    padding: theme.spacing(2),\n    height: '100%',\n    flexGrow: 1,\n    overflow: 'hidden'\n  },\n  tipPaper: {\n    padding: theme.spacing(2),\n    margin: theme.spacing(2)\n  },\n  docContainer: {\n    flexGrow: 1,\n    padding: theme.spacing(2)\n  },\n  cameraContainer: {\n    width: '80%',\n    margin: '0 auto',\n    position: 'relative',\n    // this is a CSS trick: https://spin.atomicobject.com/2015/07/14/css-responsive-square/\n    '&::before': {\n      content: ' ',\n      display: 'block',\n      paddingTop: '100%'\n    }\n  },\n  snackErr: {\n    background: red[500],\n    color: 'white'\n  },\n  snackSuccess: {\n    background: green[500],\n    color: 'white'\n  },\n  snackMsg: {\n\n  },\n  video: {\n    height: '100%',\n    width: '100%',\n    verticalAlign: 'top'\n    // display: 'none'\n    // position: 'absolute'\n    // top: 0,\n    // left: 0,\n    // zIndex: 1\n    // '@media (orientation: portrait)': {\n    //   transform: 'rotate(90)'\n    // }\n  }\n}))\n\nconst QRReader = ({ onMenuBack, onCapture }) => {\n  const classes = useStyles()\n  const [capturedImg, setCapturedImg] = useState()\n  const [err, setErr] = useState(null)\n  const [code, setCode] = useState(null)\n\n  const { cameraError, captureRawData, cameraOnline } = useCamera(setCapturedImg, CAMERAWIDTH, CAMERAHEIGHT)\n  // limit to 10 frames per second\n  const captureFunc = useCallback(debounce(captureRawData, 100), [cameraOnline, cameraError])\n\n  useEffect(() => {\n    if (cameraOnline && !cameraError && !err && !code) {\n      if (!capturedImg || !capturedImg.data) captureFunc()\n      else {\n        const scan = async () => {\n          let scannedCode = null\n          try {\n            scannedCode = await jsQRFromBase64(capturedImg)\n          }\n          catch (e) {\n            console.error(e)\n          }\n          try {\n            if (scannedCode) {\n              const find = '?fromqr='\n              const foundIdx = scannedCode.data.indexOf(find) + find.length\n              const newData = scannedCode.data.slice(foundIdx)\n              console.log('DEBUG', { data: scannedCode.data, newData })\n              const decodedUrl = JSON.parse(decodeURI(newData))\n              if (!decodedUrl.type || !decodedUrl.id) throw new Error('Type or ID missing from QR Code')\n              setCode(decodedUrl)\n              setErr(null)\n              console.log('QRCODE', scannedCode)\n            }\n            captureFunc()\n          }\n          catch (e) {\n            setErr('Not a valid QR Code')\n            console.error(e)\n            captureFunc()\n          }\n        }\n        scan()\n      }\n    }\n  }, [cameraOnline, capturedImg, err, code])\n\n  // console.log(capturedImg)\n  return (\n    <div className={classes.root}>\n      <CssBaseline /> {/* You only need this in a root element. Don't put it anywhere else in the dom */}\n      <AppBar position='static' className={classes.appBar}>\n        <Toolbar disableGutters>\n          <IconButton className={classes.menuButton} color='inherit' onClick={onMenuBack} aria-label='Menu'>\n            <ArrowBackIcon />\n          </IconButton>\n          <Typography variant='subtitle1' color='inherit' className={classes.toolbarTitle}>\n            Capture QR Code\n          </Typography>\n        </Toolbar>\n      </AppBar>\n      <div className={classes.inner}>\n        <Paper className={classes.cameraContainer}>\n          <QRcodeIcon className={classes.qrIcon} />\n          <video\n            autoPlay\n            playsInline\n            muted\n            id='webcam'\n            className={classes.video}\n          />\n        </Paper>\n        <Paper className={classes.tipPaper}>\n          <Typography>TIP: You can find the QR code for a series in the SHARE tab of that series</Typography>\n        </Paper>\n      </div>\n      <Snackbar\n        anchorOrigin={{ vertical: 'bottom', horizontal: 'center' }}\n        open={!!err}\n        autoHideDuration={2000}\n        onClose={() => setErr(null)}\n      >\n        <SnackbarContent\n          className={classes.snackErr}\n          message={<span className={classes.snackMsg}>{err}</span>}\n        />\n      </Snackbar>\n      <Snackbar\n        anchorOrigin={{ vertical: 'bottom', horizontal: 'center' }}\n        open={cameraError}\n      >\n        <SnackbarContent\n          className={classes.snackErr}\n          message={<span className={classes.snackMsg}>Camera Error. Check your device's permissions</span>}\n        />\n      </Snackbar>\n      <Snackbar\n        anchorOrigin={{ vertical: 'bottom', horizontal: 'center' }}\n        open={!!code}\n        autoHideDuration={500}\n        onClose={() => onCapture(code.type, code.id)}\n      >\n        <SnackbarContent\n          className={classes.snackSuccess}\n          message={<span className={classes.snackMsg}>Valid QR Code found!</span>}\n        />\n      </Snackbar>\n\n    </div>\n  )\n}\n\nQRReader.propTypes = {\n  onMenuBack: PropTypes.func.isRequired,\n  onCapture: PropTypes.func.isRequired\n}\n\nexport default QRReader\n\nconst jsQRFromBase64 = ({ data, imageHeight, imageWidth }) => {\n  return new Promise((resolve, reject) => {\n    try {\n      // console.log(imageHeight, imageWidth)\n      const qrCode = jsQR(data, imageWidth, imageHeight)\n      resolve(qrCode)\n    }\n    catch (e) {\n      reject(e)\n    }\n  })\n}\n","import React, { useRef, useEffect, useState, useContext } from 'react'\nimport Typography from '@material-ui/core/Typography'\n// import MenuIcon from '@material-ui/icons/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nimport moment from 'moment'\nimport { AppContext } from '../../contexts'\n\nconst CHECKINTERVAL = 5000\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    background: 'black',\n    color: 'white',\n    textAlign: 'center'\n  }\n}))\n\nconst OfflineBar = () => {\n  const classes = useStyles()\n  const { online, offlineSince } = useContext(AppContext)\n  const [sinceStr, setSinceStr] = useState()\n  const timerRef = useRef()\n\n  const calcSinceStr = () => {\n    const newText = moment(offlineSince, 'x').fromNow()\n    // console.log('OFFLINE SINCE', since, newText)\n    setSinceStr(newText)\n  }\n  const clearTimer = () => {\n    if (timerRef.current) {\n      clearInterval(timerRef.current)\n      timerRef.current = null\n    }\n  }\n\n  useEffect(() => {\n    if (offlineSince && !timerRef.current) {\n      calcSinceStr()\n      timerRef.current = setInterval(calcSinceStr, CHECKINTERVAL)\n    }\n    else if (!offlineSince)clearTimer()\n    return () => {\n      clearTimer()\n    }\n  }, [offlineSince])\n\n  if (online) return null\n  return (\n    <Typography className={classes.root} variant='caption' component='div'>\n      Offline ({sinceStr})\n    </Typography>\n  )\n}\n\nexport default OfflineBar\n","import React, { useContext } from 'react'\nimport classNames from 'classnames'\nimport PropTypes from 'prop-types'\n\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport AppBar from '@material-ui/core/AppBar'\nimport Paper from '@material-ui/core/Paper'\nimport Typography from '@material-ui/core/Typography'\nimport Toolbar from '@material-ui/core/Toolbar'\nimport Button from '@material-ui/core/Button'\n// import Fab from '@material-ui/core/Fab'\n\nimport HomeIcon from '@material-ui/icons/HomeOutlined'\nimport MapIcon from '@material-ui/icons/MapOutlined'\nimport SearchIcon from '@material-ui/icons/SearchOutlined'\nimport AddIcon from '@material-ui/icons/Add'\nimport PersonOutline from '@material-ui/icons/PersonOutline'\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport AddFab from '../components/PhotoSeries/views/controls/AddFab'\nimport OfflineBar from './misc/OfflineBar'\n\nimport { AppContext } from '../contexts'\n\nimport { home as homeConfig } from '../config'\n\nconst STATES = homeConfig.AppStateTypes\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    borderTop: `2px solid ${theme.palette.secondary.main}`\n  },\n  text: {\n    padding: theme.spacing(2, 2, 0)\n  },\n  paper: {\n    paddingBottom: 50\n  },\n  list: {\n    marginBottom: theme.spacing(2)\n  },\n  subheader: {\n    backgroundColor: theme.palette.background.paper\n  },\n  grow: {\n    flexGrow: 1\n  },\n  addFab: {\n    position: 'absolute',\n    bottom: 0,\n    left: '50%',\n    transformOrigin: '0% 100%',\n    // Promote the list into his own layer on Chrome. This cost memory but helps keeping high FPS.\n    transform: 'translateY(-25%) translateX(-50%) translateZ(0)',\n    zIndex: 3000\n  },\n  spacer: {\n    width: 40,\n    flexGrow: 1\n  }\n}))\n\nconst BottomBar = ({ className, domain, signedIn, onHomeClick, onMapClick, onSearchClick, onProfileClick, onCameraClick, onLibraryClick }) => {\n  const classes = useStyles()\n  const { isIos, online } = useContext(AppContext)\n  return (\n    <AppBar position='static' className={classNames(classes.root, className)}>\n      <Toolbar>\n        {signedIn && (\n          <Button\n            edge='start'\n            className={classes.grow}\n            color={domain === STATES.FEED ? 'secondary' : 'inherit'}\n            onClick={onHomeClick}\n          >\n            <HomeIcon />\n          </Button>\n        )}\n        <Button\n          edge='start'\n          className={classes.grow}\n          color={domain === STATES.MAP ? 'secondary' : 'inherit'}\n          onClick={onMapClick}\n        >\n          <MapIcon />\n        </Button>\n        {signedIn && (\n          <AddFab\n            isIos={isIos}\n            className={classes.addFab}\n            onCameraClick={onCameraClick}\n            onLibraryClick={onLibraryClick}\n          >\n            <AddIcon />\n          </AddFab>\n        )}\n        <div className={classes.spacer} />\n        <Button\n          color={domain === STATES.SEARCH ? 'secondary' : 'inherit'}\n          className={classes.grow}\n          disabled={!online}\n          onClick={onSearchClick}\n        >\n          <SearchIcon />\n        </Button>\n        {signedIn && (\n          <Button\n            edge='end'\n            color={domain === STATES.PROFILE ? 'secondary' : 'inherit'}\n            className={classes.grow}\n            onClick={onProfileClick}\n          >\n            <PersonOutline />\n          </Button>\n        )}\n      </Toolbar>\n    </AppBar>\n  )\n}\n\nBottomBar.propTypes = {\n  className: PropTypes.string,\n  domain: PropTypes.string,\n  signedIn: PropTypes.bool,\n  // Here are our button handlers\n  onHomeClick: PropTypes.func.isRequired,\n  onMapClick: PropTypes.func.isRequired,\n  onSearchClick: PropTypes.func.isRequired,\n  onProfileClick: PropTypes.func.isRequired,\n  onCameraClick: PropTypes.func.isRequired,\n  onLibraryClick: PropTypes.func.isRequired\n}\n\nexport default BottomBar\n\nexport const BottomBarCosmosWrapper = (props) => {\n  // const [someStateItem, setSomeStateItem] = useState()\n  const classes = useWrapperStyles()\n  return (\n    <div className={classes.root}>\n      <OfflineBar />\n      <CssBaseline /> {/* You only need this in a root element. Don't put it anywhere else in the dom */}\n      <Paper className={classes.paper}>\n        <Typography variant='h5'>\n          This is a dummy component.\n        </Typography>\n      </Paper>\n      <BottomBar {...props} />\n    </div>\n  )\n}\n\nconst wrapperStyle = theme => ({\n  root: {\n    height: '100%',\n    display: 'flex',\n    flexDirection: 'column'\n  },\n  paper: {\n    flexGrow: 1\n  }\n})\n\nconst useWrapperStyles = makeStyles(wrapperStyle)\n","import React, { useContext, useEffect } from 'react'\nimport PropTypes from 'prop-types'\n\nimport CssBaseline from '@material-ui/core/CssBaseline'\n\nimport UploaderConnect from './graphql/Uploader.connect'\nimport SeriesConnect from './graphql/Series.connect'\nimport MapConnect from './graphql/Map.connect'\nimport SearchConnect from './graphql/Search.connect'\nimport ProfileConnect from './graphql/Profile.connect'\nimport FeedConnect from './graphql/Feed.connect'\nimport QRReader from './components/PhotoSeries/views/QRReader'\n\nimport OfflineBar from './components/misc/OfflineBar'\nimport BottomBar from './components/BottomBar'\nimport { AppContext } from './contexts'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport { home as homeConfig } from './config'\n\nimport { ThemeProvider } from '@material-ui/styles'\nimport themes from './themes'\n// import { DesktopWindowsTwoTone } from '@material-ui/icons'\n\nconst STATES = homeConfig.AppStateTypes\n\nconst useStyles = makeStyles(theme => ({\n  outerRoot: {\n    height: '100%',\n    overflow: 'hidden'\n  },\n  root: {\n    height: '100%',\n    overflow: 'hidden',\n    display: 'flex',\n    flexDirection: 'column'\n  },\n  offlineBar: {\n    flex: '0 0'\n  },\n  activeWrapper: {\n    overflow: 'hidden',\n    flexGrow: 1,\n    flexShrink: 1,\n    height: '100%'\n  },\n  uploaderContainer: {\n    zIndex: 2000,\n    flex: '0 0'\n  }\n}))\n\n/**\n * This is the over-arching wrapper for the app. It combines all the\n * same place. Time will tell if that's a good strategy.\n */\nconst App = ({ domain, onQRCapture, onMenuBack, setHomeState, onCameraClick, onLibraryClick, children }) => {\n  const classes = useStyles()\n  const { signedIn, user, windowSize } = useContext(AppContext)\n\n  useEffect(() => {\n    // Anonymous Users are only allowed home and search\n    if (!signedIn && [STATES.MAP, STATES.SEARCH, STATES.SERIES, STATES.QRCAPTURE].indexOf(domain) < 0) setHomeState(STATES.MAP)\n  }, [domain])\n\n  let showBottomBar = true\n  let activeProps = {}\n  let ActiveComponent = FeedConnect\n  switch (domain) {\n    case STATES.FEED:\n      ActiveComponent = FeedConnect\n      break\n    case STATES.MAP:\n      ActiveComponent = MapConnect\n      break\n    case STATES.PROFILE:\n      ActiveComponent = ProfileConnect\n      activeProps = { user }\n      break\n    case STATES.SEARCH:\n      ActiveComponent = SearchConnect\n      break\n    case STATES.SERIES:\n      ActiveComponent = SeriesConnect\n      activeProps = { user }\n      showBottomBar = false\n      break\n    case STATES.NEW_SERIES_CAMERA:\n      activeProps = { user }\n      ActiveComponent = SeriesConnect\n      showBottomBar = false\n      break\n    case STATES.NEW_SERIES_LIBRARY:\n      activeProps = { user }\n      ActiveComponent = SeriesConnect\n      showBottomBar = false\n      break\n    case STATES.QRCAPTURE:\n      ActiveComponent = QRReader\n      showBottomBar = false\n      activeProps = { onCapture: onQRCapture, onMenuBack }\n      break\n    default:\n      break\n  }\n\n  return (\n    <div className={classes.outerRoot}>\n      <div className={classes.root} style={{ width: windowSize.width, height: windowSize.height }}>\n        <CssBaseline /> {/* You only need this in a root element. Don't put it anywhere else in the dom */}\n        <OfflineBar className={classes.offlineBar} />\n        <div className={classes.activeWrapper}>\n          <ActiveComponent {...activeProps} />\n        </div>\n        { showBottomBar && (\n          <ThemeProvider theme={themes.bottombar}>\n            <BottomBar\n              signedIn={signedIn}\n              domain={domain}\n              onHomeClick={() => setHomeState(STATES.FEED)}\n              onMapClick={() => setHomeState(STATES.MAP)}\n              onSearchClick={() => setHomeState(STATES.SEARCH, { search: null })}\n              onProfileClick={() => setHomeState(STATES.PROFILE)}\n              onCameraClick={onCameraClick}\n              onLibraryClick={onLibraryClick}\n            />\n          </ThemeProvider>\n        )}\n        {/* Uploader is persistent across all views */}\n        <UploaderConnect className={classes.uploaderContainer} />\n        {children}\n      </div>\n    </div>\n  )\n}\n\nApp.propTypes = {\n  // All of this comes in from From Redux\n  domain: PropTypes.string.isRequired,\n  children: PropTypes.any,\n  setHomeState: PropTypes.func.isRequired,\n  onCameraClick: PropTypes.func.isRequired,\n  onLibraryClick: PropTypes.func.isRequired,\n  onQRCapture: PropTypes.func.isRequired,\n  onMenuBack: PropTypes.func.isRequired\n}\n\nexport default App\n","import React, { useEffect } from 'react'\nimport { Query, ApolloProvider, compose } from 'react-apollo'\nimport { IntlWrapper } from './translations'\nimport { getUser } from './graphql/queries'\nimport themes from './themes'\nimport { AppContext } from './contexts'\nimport Loading from './components/auth/Loading'\nimport ErrorBoundary from './lib/ErrorBoundary'\nimport ErrorConnect from './graphql/Error.connect'\nimport useGraphQL from './lib/useGraphQL'\nimport useAuthentication from './lib/useAuthentication'\nimport useShowAddToHome from './lib/useShowAddToHome'\nimport useOnline from './lib/useOnline'\nimport useResponsive from './lib/useResponsive'\nimport withReduxProvider from './redux/withReduxProvider'\nimport { connect } from 'react-redux'\nimport actions from './redux/actions'\nimport config, { home as homeConfig } from './config'\n\nimport App from './App'\nimport { ThemeProvider } from '@material-ui/styles'\n\n/**\n * HOC for AppContext and ApolloProvider\n */\nexport const withApolloAuthProvider = Wrapped => ({\n  onQRClick, onAvatarClick, setUseOffline, dismissInstall, flags, ...props\n}) => {\n  // console.log('withApolloAuthProvider', props)\n  const { isGod, signedIn, authData, signOut, authScreen, forceSignIn } = useAuthentication(flags.useLoggedOut, setUseOffline)\n\n  const { client: apolloClient, loaded: apolloLoaded } = useGraphQL()\n\n  // This triggers all the PWA Goodness\n  const { online, offlineSince } = useOnline()\n  const { installPrompt, addToHomeScreen } = useShowAddToHome(flags.install, dismissInstall)\n  const responsive = useResponsive()\n\n  // If the user hasn't decided to be anonymous or sign in yet show them the login screen\n  // console.log('Rendering AppConnect', { flags, responsive, props, signedIn, isGod, authData })\n  useEffect(() => {\n    if (signedIn === true && flags.useLoggedOut) setUseOffline(false)\n    else if (signedIn === false && !flags.useLoggedOut) setUseOffline(true)\n  }, [signedIn])\n\n  if (!apolloLoaded) return <Loading message='DBStore' />\n\n  if (signedIn === null && !flags.useLoggedOut) return authScreen\n\n  // These are the things the rest of the app needs to find:\n  const appContext = {\n    signOut,\n    forceSignIn: () => {\n      setUseOffline(false)\n      forceSignIn()\n    },\n    online,\n    offlineSince,\n    ...responsive,\n    signedIn: Boolean(signedIn),\n    role: !signedIn\n      ? 'nonuser'\n      : isGod\n        ? 'admin'\n        : 'user',\n    currentUser: authData, // TODO: Need this supported by a graphql query\n    onQRClick,\n    addToHomeScreen,\n    seriesConfig: {\n      meta: {},\n      tags: [\n        {\n          isIos: responsive.isIos,\n          id: 'freeBothType',\n          label: null,\n          color: config.tagColors[0],\n          allowXY: true,\n          allowNonXY: true,\n          allowAdditions: true,\n          // This one returns a promise\n          getValues: () => Promise.resolve(['a', 'b', 'c']),\n          values: []\n        }\n      ],\n      onAvatarClick,\n      getPhotoUrl: (photo, size) => {\n        try {\n          return `${photo.paths.base}${photo.paths[size]}`\n        }\n        catch (e) {\n          return null\n        }\n      }\n    }\n  }\n\n  return (\n  // We wrap the outside in an error handler\n\n    <ThemeProvider theme={themes.home}>\n      <ApolloProvider client={apolloClient}>\n        <Query query={getUser} skip={!signedIn}>\n          {({ loading, error, data }) => {\n            if (loading) return <Loading message='UserData' />\n            if (error) {\n              console.error(error)\n            }\n            if (signedIn) appContext.user = data.user\n            return (\n              <AppContext.Provider value={appContext}>\n                <IntlWrapper>\n                  <Wrapped {...props}>\n                    {installPrompt}\n                  </Wrapped>\n                </IntlWrapper>\n              </AppContext.Provider>\n            )\n          }}\n        </Query>\n      </ApolloProvider>\n    </ThemeProvider>\n  )\n}\n\n/**\n * Map our redux state and functions\n */\nconst mapStateToProps = (state, props) => {\n  const { domain } = state.home.current\n  return { domain, flags: state.flags }\n}\n\nconst mapDispatchToProps = dispatch => ({\n  setHomeState: (newDomain, newParams) => {\n    dispatch(actions.setHomeState(newDomain, newParams))\n  },\n  onCameraClick: () => {\n    dispatch(actions.setHomeState(homeConfig.AppStateTypes.NEW_SERIES_CAMERA))\n  },\n  onLibraryClick: () => {\n    dispatch(actions.setHomeState(homeConfig.AppStateTypes.NEW_SERIES_LIBRARY))\n  },\n  dismissInstall: () => {\n    dispatch(actions.setFlag('install', false))\n  },\n  setUseOffline: (bVal) => {\n    dispatch(actions.setFlag('useLoggedOut', bVal))\n  },\n  onQRClick: () => {\n    dispatch(actions.setHomeState(homeConfig.AppStateTypes.QRCAPTURE))\n  },\n  onMenuBack: () => {\n    dispatch(actions.homeStateBack())\n  },\n  onAvatarClick: (username) => {\n    dispatch(actions.setHomeState(homeConfig.AppStateTypes.SEARCH, {\n      search: { tab: homeConfig.SEARCH_TABS.USER, text: username }\n    }))\n  },\n  onQRCapture: (type, activeSeries) => {\n    switch (type) {\n      case 'series':\n        dispatch(actions.setHomeState(homeConfig.AppStateTypes.SERIES, { activeSeries }))\n        break\n      default:\n        break\n    }\n  }\n})\n\nconst withErrorBoundary = (Wrapped) => (props) => (\n  <ErrorBoundary fallback={ErrorConnect}>\n    <Wrapped {...props} />\n  </ErrorBoundary>\n)\n\n/**\n * Nearly everything we do depends on who you are as a user so we commit this to state\n */\n\n// The order we compose things here matters a lot\nexport default compose(\n  // ORDER IS CRITICAL HERE\n  withReduxProvider,\n  connect(\n    mapStateToProps,\n    mapDispatchToProps\n  ),\n  withApolloAuthProvider,\n  withErrorBoundary\n)(App)\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n)\n\nexport function register (config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href)\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config)\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\n          )\n        })\n      }\n      else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config)\n      }\n    })\n  }\n}\n\nfunction registerValidSW (swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing\n        if (installingWorker == null) {\n          return\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n              )\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration)\n              }\n            }\n            else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.')\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration)\n              }\n            }\n          }\n        }\n      }\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error)\n    })\n}\n\nfunction checkValidServiceWorker (swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type')\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload()\n          })\n        })\n      }\n      else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config)\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      )\n    })\n}\n\nexport function unregister () {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister()\n    })\n  }\n}\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport AppConnect from './App.connect'\nimport * as serviceWorker from './serviceWorker'\n// Here's our global overrides css\nimport './index.css'\n// This is the font we need\nrequire('typeface-roboto')\n\nconsole.log('Rendering Main App')\nReactDOM.render(<AppConnect />, document.getElementById('root'))\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.register()\n"],"sourceRoot":""}