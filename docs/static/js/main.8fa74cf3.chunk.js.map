{"version":3,"sources":["lib/SeriesConfig.js","lib/Photo.js","lib/datelib.js","lib/util.js","translations.js","graphql/fragments.js","graphql/queries.js","themes/index.js","contexts.js","components/auth/useAuthCommon.js","icons/AppLogo.jsx","components/auth/AuthContainer.jsx","components/auth/Loading.jsx","lib/ErrorBoundary.jsx","components/misc/ErrorScreen.jsx","graphql/mutations.js","containers/Error.connect.js","mapStyles/index.js","config.js","graphql/mutations/updateQueries.js","graphql/mutations/createSeries.js","graphql/offline.js","graphql/useGraphQL.js","components/auth/auth.style.js","components/auth/SignIn.jsx","components/auth/ConfirmSignIn.jsx","components/auth/RequireNewPassword.jsx","components/auth/SignUp.jsx","components/auth/ConfirmSignUp.jsx","components/auth/ForgotPassword.jsx","lib/useAuthentication.js","lib/sensors.js","components/misc/InstallPrompt.jsx","lib/useShowAddToHome.js","lib/useOnline.js","lib/useResponsive.js","redux/actions.js","redux/reducers/map.js","redux/reducers/home.js","redux/reducers/uploader.js","redux/reducers/flags.js","redux/reducers/offline.js","redux/reducers/index.js","redux/storeConfig.js","redux/withReduxProvider.js","components/UploadControl.jsx","lib/s3upload.js","containers/Uploader.connect.js","permissions.js","graphql/mutations/deleteSeries.js","graphql/mutations/updateSeries.js","graphql/mutations/deletePhoto.js","graphql/mutations/createPhoto.js","graphql/mutations/updatePhoto.js","graphql/mutations/watch.js","graphql/mutations/unwatch.js","components/PhotoSeries/contexts.js","components/PhotoSeries/views/QRDisplay.jsx","icons/QRCode.jsx","components/PhotoSeries/views/controls/AddFab.jsx","components/PhotoSeries/views/controls/ContextMenu.jsx","components/PhotoSeries/views/tags/TagChip.jsx","components/PhotoSeries/views/controls/ShortLongText.jsx","components/PhotoSeries/views/controls/UserListItem.jsx","components/PhotoSeries/views/dialogs/BigText.jsx","components/PhotoSeries/views/subViews/SeriesInfo.jsx","components/PhotoSeries/views/subViews/SeriesInfo.style.js","lib/useComponentSize.js","components/PhotoSeries/views/tags/XYTagChip.style.js","components/PhotoSeries/views/tags/XYTagChip.jsx","components/PhotoSeries/views/tags/XYTagSelect.jsx","components/PhotoSeries/views/tags/XYTagSelect.style.js","components/PhotoSeries/views/tags/XYTagChooser.jsx","components/PhotoSeries/views/tags/XYTagChooser.style.js","lib/Tags.js","components/PhotoSeries/views/tags/useXYTags.js","components/PhotoSeries/views/subViews/BrokenImg.jsx","components/PhotoSeries/views/subViews/RawImage.jsx","components/PhotoSeries/views/subViews/Photo.jsx","components/PhotoSeries/views/subViews/Photo.style.js","components/PhotoSeries/views/subViews/SwipeShow.jsx","components/PhotoSeries/views/subViews/SwipeShow.style.js","components/PhotoSeries/views/dialogs/DeleteDialog.jsx","components/PhotoSeries/views/subViews/PhotoGrid.jsx","components/PhotoSeries/views/subViews/PhotoGrid.style.js","components/PhotoSeries/views/SeriesView.style.js","components/PhotoSeries/views/SeriesView.jsx","components/maps/markers/MyLocation.jsx","components/maps/controls/StyleButtons.jsx","components/maps/controls/MyLocationButton.jsx","components/maps/BaseMap.jsx","components/maps/markers/Dot.jsx","components/maps/BaseStaticMap.jsx","components/maps/MapDot.jsx","components/PhotoSeries/views/dialogs/MapDirPicker.jsx","components/PhotoSeries/views/dialogs/BigTextEdit.jsx","components/PhotoSeries/views/subViews/SeriesEditInner.jsx","components/PhotoSeries/views/subViews/SeriesEditInner.style.js","components/PhotoSeries/views/SeriesEdit.jsx","components/PhotoSeries/views/SeriesEdit.style.js","components/PhotoSeries/views/Slideshow.jsx","components/PhotoSeries/views/Slideshow.style.js","components/PhotoSeries/views/dialogs/CancelConfirm.jsx","components/PhotoSeries/views/controls/TagControl.style.js","components/PhotoSeries/views/controls/TagView.jsx","components/PhotoSeries/views/controls/DateControl.jsx","components/PhotoSeries/views/controls/TagControl.jsx","components/PhotoSeries/views/dialogs/TagEdit.jsx","components/PhotoSeries/views/controls/DateView.jsx","components/PhotoSeries/views/subViews/PhotoInfoInner.jsx","components/PhotoSeries/views/subViews/PhotoInfo.jsx","components/PhotoSeries/views/PhotoViewTool.jsx","components/PhotoSeries/views/PhotoViewTool.style.js","components/PhotoSeries/views/controls/PhotoFadeSlider.jsx","components/PhotoSeries/views/PhotoReviewTool.jsx","components/PhotoSeries/views/PhotoReviewTool.style.js","lib/useCamera.js","components/PhotoSeries/views/CameraTool.jsx","components/PhotoSeries/views/CameraTool.style.js","components/PhotoSeries/views/NewPhotoInfo.jsx","components/PhotoSeries/views/NewPhotoInfo.style.js","lib/useFileInput.js","components/PhotoSeries/views/controls/LibraryFilePicker.jsx","lib/Series.js","components/PhotoSeries/views/NewPhoto.jsx","lib/AccessHelper.js","components/PhotoSeries/views/SeriesNotFound.jsx","components/PhotoSeries/views/SeriesLoading.jsx","components/PhotoSeries/index.jsx","containers/Series.connect.js","lib/useClusteredData.js","components/maps/HomeMap.style.js","icons/AppLogoSimple.jsx","icons/Apple.jsx","components/misc/FeatureDisabled.jsx","components/SideDrawer.jsx","components/TopBar.jsx","components/Search/SearchInput.jsx","components/misc/SeriesListItem.jsx","components/misc/ClusterSelected.jsx","components/misc/ViewListDialog.jsx","components/maps/markers/Single.jsx","components/maps/markers/Cluster.jsx","components/maps/HomeMap.jsx","containers/Map.connect.js","components/Search/SearchContextItem.jsx","components/Search/SearchContextResults.jsx","components/Search/SearchEnder.jsx","components/Search/SearchResults.jsx","components/Search/SearchPlaceholder.jsx","components/Search/Search.jsx","containers/Search.connect.js","components/MyProfile/MeCard.jsx","components/MyProfile/MyProfile.jsx","containers/Profile.connect.js","components/MyFeed/FeedEnder.jsx","components/misc/FindOnMapButton.jsx","components/MyFeed/FeedItem.jsx","components/MyFeed/MyFeed.jsx","containers/Feed.connect.js","components/maps/OfflineMap.style.js","components/maps/OfflineMap.jsx","containers/OfflineMap.connect.js","components/PhotoSeries/views/QRReader.jsx","components/misc/OfflineBar.jsx","components/BottomBar.jsx","components/App.jsx","containers/App.connect.js","serviceWorker.js","index.js"],"names":["TYPES","SeriesConfig","seriesConfig","_this","this","Object","_Users_matt_Work_Git_PBR_PhotoMonitoring_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_2__","getTagType","typeId","config","tags","find","tt","id","getTagTypeIndex","findIndex","getXYTagTypes","filter","allowXY","getNonXYTagTypes","allowNonXY","getSeriesMeta","keys","meta","key","type","reduce","acc","_Users_matt_Work_Git_PBR_PhotoMonitoring_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_1__","_Users_matt_Work_Git_PBR_PhotoMonitoring_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__","default","getPhotoMeta","Error","__webpack_exports__","Photo","photo","setMeta","JSON","stringify","newPhoto","concat","uuidv4","uploadToken","takenOn","convertJSDatetoTimestamp","Date","getExif","dataUrl","console","log","exif","exifDateTime","exifGPS","foundIdx","indexOf","length","newData","slice","exifParser","create","Buffer","from","parse","err","DateTimeOriginal","String","GPSLatitude","isNumeric","GPSLongitude","e","error","__webpack_require__","d","formatDate","formatDatAgo","timestampToHTML5Input","HTML5InputToTimestamp","moment__WEBPACK_IMPORTED_MODULE_0__","moment__WEBPACK_IMPORTED_MODULE_0___default","n","utctimestamp","format","arguments","undefined","moment","fromNow","jsDate","utc","isoStr","debounce","num","isNaN","parseFloat","isFinite","func","wait","immediate","timeout","_len","innerArgs","Array","_key","context","callNow","clearTimeout","setTimeout","apply","addLocaleData","frLocaleData","React","createContext","IntlWrapper","_ref","children","react_default","a","createElement","index_es","locale","photoSummaryFragment","gql","_templateObject","photoSummaryKeys","userSummaryFragment","_templateObject2","seriesSummaryFragment","_templateObject3","seriesSummaryKeys","seriesFragment","_templateObject4","seriesKeys","photoFragment","_templateObject5","userFragment","_templateObject6","allSeries","queries_templateObject","pollQuery","queries_templateObject2","userSeries","queries_templateObject3","seriesFromList","queries_templateObject4","queries_templateObject5","seriesWithTag","queries_templateObject6","tagSearch","_templateObject7","geoSeriesIdOnly","_templateObject8","_templateObject9","getUser","_templateObject10","geocode","_templateObject11","getMyFeed","_templateObject12","userSearch","_templateObject13","getWholeSeries","_templateObject14","typography","useNextVariants","overrides","MuiDialog","paper","@media (max-width:321px)","margin","paperFullWidth","width","colors","home","palette","primary","main","secondary","text","fade","series","lighten","topbar","bottombar","login","background","themes","createMuiTheme","AppContext","useAuthCommon","containerRef","useRef","handleKeyPress","event","current","found","getElementsByClassName","click","useEffect","document","addEventListener","removeEventListener","createSvgIcon","Fragment","useStyles","makeStyles","theme","root","height","bgSwoosh","position","top","left","zIndex","spacer","flex","logo","minHeight","inner","minWidth","maxWidth","display","flexDirection","textAlign","AuthContainer","classes","ThemeProvider","ref","className","CssBaseline","AppLogo","Typography","variant","Loading","message","auth_AuthContainer","ErrorBoundary","props","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","state","hasError","info","_this$state","FallbackUI","fallback","Component","SEND_STATES","overflow","padding","spacing","color","border","button","icon","opacity","flexGrow","stack","marginBottom","fontSize","whiteSpace","fontFamily","ErrorScreen","sendState","reportError","_useState","useState","_useState2","slicedToArray","dlgOpen","setDialogOpen","_useState3","_useState4","note","setNote","stackEl","buttonText","disabled","Error_default","Button","onClick","BugReport_default","Dialog","open","fullWidth","onClose","aria-labelledby","DialogTitle","DialogContent","DialogContentText","TextField","autoFocus","multiline","onChange","target","value","rowsMax","placeholder","label","DialogActions","deletePhoto","mutations_templateObject","deleteSeries","mutations_templateObject2","updateSeries","mutations_templateObject3","updateSeriesKeys","updatePhoto","mutations_templateObject4","updatePhotoKeys","createPhoto","mutations_templateObject5","newPhotoKeys","createSeries","mutations_templateObject6","newSeriesKeys","watchSeries","mutations_templateObject7","unWatchSeries","mutations_templateObject8","reportBug","mutations_templateObject9","withReportBugMutation","graphql","mutate","_ref$ownProps","ownProps","reduxState","setState","reportJSON","errObj","env","process","toString","variables","update","store","_ref2","data","connect","map","other","uploader","objectWithoutProperties","newMap","objectSpread","Wrapped","assign","src_mapStyles","toolTip","Icon","SatelliteOutlined","ActiveIcon","SatIcon","style","Satellite","TerrainOutlined","Terrain","TopoMap","tagColors","mapConfig","mapBoxToken","styles","MapStyles","baseurl","REACT_APP_BASEURL","Offline","seriesImgsToCache","highestOfflineTileZoom","maxMapTileArea","AppStateTypes","FEED","MAP","SEARCH","PROFILE","SERIES","QRCAPTURE","NEW_SERIES_CAMERA","NEW_SERIES_LIBRARY","OFFLINE_DOWNLOAD","SEARCH_TABS","TAG","LOCATION","USER","MapModeTypes","FREE","endpoints","aws","Auth","region","userPoolId","userPoolWebClientId","mandatorySignIn","cookieStorage","domain","expires","secure","ACCESS","OPEN","description","green","PRIVATE","red","PUBLIC","blue","getWholeSeriesUpdate","query","qVal","readQuery","_","cloneDeep","writeQuery","getWholeSeriesPhotoUpdate","remove","seriesId","photos","ph","idx","toConsumableArray","updateSeriesSummaries","origArr","newArr","s","newAllSeriesEntry","pick","seriesStatus","__typename","allSeriesUpdate","limit","seriesSummaries","nextToken","allSeriesPhotoUpdate","newS","latest","featured","photoSummary","feedUpdate","myFeed","feed","window","fItem","fitem","newSeriesSummary","newPhotoSummary","_id","relation","updateFeedList","watchUpdate","user","watching","sid","Set","withMutation","createSeriesMutation","newSeries","ext","_ownProps$user","meUserSummary","gravatar","gravatarProfile","username","access","optimisticResponse","createOptimisticResponse","mutationStackId","pushMutationPromise","updateThunk","doneCreatingSeries","then","popMutationPromise","cb","createdSeries","_ref3","name","coords","direction","photoCount","createdUser","updatedUser","createdBy","updatedBy","createdOn","now","updatedOn","watchers","seriesCreatedBy","paths","base","large","orig","thumb","medium","preAuth","mutations_createSeries","localforage","storeName","imgStore","createInstance","stateStore","OFFLINEMUTATIONS","getPendingPromise","getItem","mutations","setPendingPromise","setItem","params","mutation","pm","proxyUpdateForId","proxy","resp","updateHandler","__optimistic","Promise","resolve","restoreRequests","client","forEach","pendingMutation","Amplify","configure","LOCAL_STORAGE_TOKEN","APOLLOSTATES","INITIALIZING","AUTHENTICATING","LOADING","APPLY_MUTATIONS","ERROR","DONE","useGraphQL","setClient","done","setDone","_useState5","_useState6","currState","setCurrState","createApolloClient","newClient","newState","getCurrentToken","asyncToGenerator","regenerator_default","mark","_callee","currSession","wrap","_context","prev","next","currentSession","sent","abrupt","accessToken","jwtToken","t0","stop","_callee3","cache","authLink","httpLink","retry","apolloClient","_context3","InMemoryCache","persistCache","storage","setContext","_callee2","headers","token","newHeaders","_context2","authorization","_x2","_x3","createHttpLink","uri","RetryLink","attempts","max","Infinity","ApolloClient","link","ApolloLink","tokenName","addTypename","connectToDevTools","auth_style","forgotPassword","switch","switchButton","&:last-child","borderRadius","&:first-child","phoneNumInner","marginTop","phoneNumDropdown","warnText","fontStyle","noSignin","SignIn","loading","handleSignup","handleForgotPassword","federated","handleInputChange","handleBeAnonymous","handleSignIn","textField","autoComplete","Toolbar","disableGutters","component","size","ConfirmSignIn","handleBack","handleConfirm","RequireNewPassword","change","requiredAttributes","placeholders","attribute","SignUp","signUpFields","signUpFieldLabels","signUpFieldPlaceholders","countryDialCodes","defaultDialCode","selectVal","setSelectVal","handleDialCodeChange","field","f","FormControl","InputLabel","htmlFor","shrink","required","Select","inputProps","dialCode","ConfirmSignUp","handleResend","Link","resendCode","ForgotPassword","handleSubmit","handleSendCode","setSent","defaultAuthState","authState","authData","signedIn","useAuthentication","_useState2$","setAuth","authScreen","dist","onStateChange","hideDefault","useAuthentication_SignIn","useAuthentication_Loading","useAuthentication_RequireNewPassword","useAuthentication_ConfirmSignIn","useAuthentication_ConfirmSignUp","useAuthentication_ForgotPassword","useAuthentication_SignUp","isGod","signInUserSession","idToken","payload","signOut","catch","forceSignIn","newProps","changeState","signIn","auth_SignIn","SignInOrig","_this2","hide","includes","checkCustomSignUpFields","signUpConfig","sortFields","getDefaultDialCode","I18n","get","signUp","auth_SignUp","SignUpOrig","_this3","confirm","auth_ConfirmSignIn","ConfirmSignInOrig","_this4","resend","auth_ConfirmSignUp","ConfirmSignUpOrig","challengeParam","isArray","split","part","charAt","toUpperCase","substr","toLowerCase","join","auth_RequireNewPassword","RequireNewPasswordOrig","auth_Loading","LoadingOrig","_this5","send","submit","auth_ForgotPassword","ForgotPasswordOrig","useGeolocation","accuracy","altitude","altitudeAccuracy","heading","latitude","longitude","speed","timestamp","mountedRef","watchIdRef","onEvent","navigator","geolocation","getCurrentPosition","watchPosition","clearWatch","isIos","test","userAgent","vendor","opera","content","messageWrapper","contrastText","boxShadow","animation","@keyframes installPulse","0%","50%","100%","textWrapper","paddingLeft","buttons","InstallPrompt","onInstall","Snackbar","anchorOrigin","vertical","horizontal","Paper","elevation","paragraph","useShowAddToHome","showInstall","dismissInstall","deferredPrompt","setPrompt","handleBeforePrompt","preventDefault","installPrompt","useMemo","misc_InstallPrompt","addToHomeScreen","prompt","userChoice","choiceResult","outcome","standalone","useOnline","onLine","newDate","online","offlineSince","getState","_window","orientation","innerWidth","innerHeight","_window$screen","screen","wOrient","bIsIos","bIsPhone","isPhone","windowSize","screenSize","activeElement","tagName","useResponsive","mediaQueries","handleResizeDebounced","useCallback","stopPropagation","useLayoutEffect","Actions","actions","newDomain","initialPhoto","flagName","flagVal","viewport","bVal","viewportSave","uploadObj","newProgress","mapInit","mode","zoom","homeInit","history","initState","activeUpload","defaultFlags","iOSWarning","install","useLoggedOut","offlineInit","completedDownload","combineReducers","action","newStateHistory","newCurrentState","pop","activeSeries","newParams","newHistory","newStore","newActive","flags","defineProperty","offline","persistConfig","persistedReducer","persistReducer","rootReducer","storeConfig","preloadedState","createStore","compose","applyMiddleware","thunk","persistor","persistStore","withReduxProvider","BaseComponent","_storeConfig","es","integration_react","msgText","messageInner","UploadControl","progress","classNames","LinearProgress","UploadControlCOSMOSWrapper","useWrapperStyles","displayName","updateUploadProgress","completeActiveUpload","formData","file","FormData","fields","fieldkey","substring","append","Content-Type","onUploadProgress","progressEvent","loaded","total","Math","floor","axios","post","url","t1","removeItem","t2","t3","interceptors","request","use","reject","response","dispatch","uploadingRef","_x","_doUpload","s3Upload","Boolean","components_UploadControl","permissions","admin","create:own","read:any","update:any","delete:any","create:any","nonuser","series_public","series_open","read:own","update:own","delete:own","deleteSeriesMutation","onAfterSeriesDelete","mutations_deleteSeries","updateSeriesMutation","seriesDelta","mutations_updateSeries","deletePhotoMutation","photoId","mutations_deletePhoto","createPhotoMutation","newPhotoInput","mutations_createPhoto","updatePhotoMutation","photoDelta","newUpdatePhoto","t","newT","mutations_updatePhoto","watchSeriesMutation","watch","unWatchSeriesMutation","unwatch","SeriesContext","title","qrPaper","qrCode","QRDisplay","useContext","qrCodeEl","setQRCodeEl","obj","encodedId","encodeURI","QRCode","svgStr","dangerouslySetInnerHTML","__html","x","y","pulseCol","light","speedDialFab","&::before","animationIterationCount","animationTimingFunction","@keyframes fabPulse","90%","directionUp","actionsClosed","AddFab","onCameraClick","onLibraryClick","setOpen","down","setDown","timerRef","downRef","elRef","onDown","currentTarget","block","cameraAction","libraryAction","AddFab_AddFabIos","rootContainer","SpeedDial","ariaLabel","onBlur","ButtonProps","disableFocusRipple","fab","onMouseDown","onTouchStart","SpeedDialAction","AddAPhoto_default","speedDialIcon","tooltipPlacement","tooltipTitle","tooltipOpen","PhotoLibrary_default","useIosStyles","AddFabIos","Fab","ContextMenu","anchorEl","menuItems","Menu_Menu","divider","Divider","MenuItem","ListItemIcon","ListItemText","primaryTypographyProps","tagChips","marginRight","deleteIcon","chipAvatar","TagChip","edit","tag","onDelete","useTheme","Chip","getContrastText","Cancel_default","bottom","ShortLongText","FormLabel","formLabel","defaultProps","imgContainer","gravatarImg","objectFit","UserListItem","onAvatarClick","ListItem","ListItemAvatar","Avatar","alt","src","body","paddingBottom","alignSelf","dlgTitle","closeButton","BigText","scroll","disableTypography","IconButton","Close_default","DIALOGS","backgroundColor","list","numPhotos","tagListItem","chip","SeriesInfo","_useContext","seriesConfigInst","SeriesConfigClass","activeDialog","setActiveDialog","newTags","existing","count","metaKeys","controls_ShortLongText","List","dense","controls_UserListItem","tagKey","idtk","subheading","values","tags_TagChip","render","dialogs_BigText","getSize","el","minSize","defaultSize","offsetWidth","offsetHeight","useComponentSize","resizeActiveRef","resizeActive","setResizeActive","setComponentSize","handleResize","newSize","ResizeObserver","resizeObserver","observe","disconnect","xyTagChip","cursor","editing","reversedChip","right","chipAvatarIcon","reversedDelete","chipBucket","reversedChipBucket","XYTagChip","onTagDragOver","onTagDragStop","onTagDelete","onNewTag","isReversed","relCoords","newWidth","stopBadness","react_draggable_default","bounds","newHeight","onDrag","onStop","avatar","MyLocation_default","noOptionsMessage","singleValue","input","valueContainer","flexWrap","alignItems","XYTagSelect","tagConfig","options","tc","allowAdditions","react_select_esm","components","Control","Menu","NoOptionsMessage","Option","Placeholder","ValueContainer","blurInputOnSelect","isClearable","isSearchable","Creatable_default","InputProps","inputComponent","selectProps","inputRef","innerRef","innerProps","textFieldProps","square","_ref4","_ref5","isFocused","isSelected","buttonRef","selected","fontWeight","_ref6","header","listItem","dlgBody","paddingRight","grey","XYTagChooser","xyTags","fullScreen","paperScrollPaper","tagType","tags_XYTagSelect","Tags","findTagById","tagId","getXYTags","xyTagIds","getNonXYTags","NonXYTagIds","createNewTagObj","createExistingTagObj","createNewXYTagObj","createExistingXYTagObj","getRelXYTags","multiplier","group","useXYTags","isDragging","setIsDragging","newTagDialog","setNewTagDialog","tagClass","addTag","__isNew__","updateTagLocation","oldTag","newX","parseInt","newY","onAddTagTrigger","pageX","pageY","TagChooser","tags_XYTagChooser","circularProgress","BrokenImg","CircularProgress","BrokenImage_default","img","imgBroken","RawImage","getPhotoUrls","sizePriority","imgRef","cover","imgUrls","setImgUrls","altIndex","setAltIndex","broken","setBroken","finalURl","subViews_BrokenImg","onError","brokenImg","formControl","showTags","transition","refImgWrap","setNewSize","_useComponentSize","_useComponentSize$siz","_useXYTags","_imgRef$current","naturalHeight","naturalWidth","min","handleNewSize","tags_XYTagChip","subViews_RawImage","rawImage","photoWrapper","dateCaption","dark","mobileStepper","manualBack","transform","manualForward","tagButton","slideshowButton","dots","SwipeShow","onImageSelect","initPhotoIndex","p","activePhoto","setActivePhoto","setShowTags","singular","sortedPhotos","sort","b","react_swipeable_views_lib_default","axis","index","onChangeIndex","val","enableMouseEvents","subViews_Photo","KeyboardArrowRight_default","KeyboardArrowLeft_default","GridListTileBar","subtitle","actionIcon","Badge","badgeContent","Label_default","MobileStepper","steps","activeStep","isFullScreen","slides","DeleteDialog","onConfirm","disableBackdropClick","disableEscapeKeyDown","tile","addFab","notDeleteable","unSelectedTile","& img","selectedTile","snackbarContent","snackbar","PhotoGrid","columns","multiSelect","onTileClick","selectMode","setSelectMode","selectedItems","setSelectedItems","urls","setUrls","_useState7","_useState8","deleteConfirm","setDeleteConfirm","ac","handleCancelSelection","toggleListItem","remaining","arrId","t4","t5","t6","t7","t8","t9","GridList","cols","cellHeight","canDelete","canUser","GridListTile","handlePhotoTap","aria-label","handleAddToSelection","Remove_default","Add_default","autoHideDuration","ContentProps","aria-describedby","dialogs_DeleteDialog","confirmation","SeriesView_style","appBar","overflowY","-webkit-overflow-scrolling","tabMenu","mapWrap","toolbarTitle","textOverflow","grow","gridList","titleBar","menuButton","placeholderInner","progressWrapper","placeholderText","SeriesView","onSlideshowStart","onEditSeries","onDeletePhotos","onCameraAdd","onDeleteSeries","onLibraryAdd","onMenuBack","onWatch","onUnWatch","onFindOnMap","owned","contextEl","setContextEl","showQR","setShowQR","listTypeTab","setListTypeTab","can","delete","contribute","dialogOpen","AppBar","ArrowBack_default","aria-haspopup","MoreVert_default","controls_ContextMenu","PlaceIcon","AddAlertIcon","QRCodeIcon","SlideshowIcon","EditIcon","DeleteIcon","Tabs","Tab","subViews_SwipeShow","subViews_SeriesInfo","subViews_PhotoGrid","controls_AddFab","views_QRDisplay","svgDot","transformOrigin","svgAccuracyDot","MyLocation","projection","accHeight","pixelsPerMeter","accWidth","version","viewBox","cx","cy","r","stroke","fillOpacity","strokeWidth","fill","speedDialAction","speedDialLabel","StyleButtons","controlPadding","currStyle","mapStyles","setCurrStyle","noEventSetOpen","speedDial","TooltipClasses","tooltip","MyLocationButton","BaseMap","myPosition","showMe","initViewport","lockToBounds","lockPan","initStyle","incomingOnViewportChange","onViewportChange","incomingOnTransitionStart","onTransitionStart","incomingOnTransitionEnd","onTransitionEnd","transitions","onMapDataEvent","stylechooser","passthroughProps","mapContainerRef","mapBoxRef","innerTransitionsRef","defaultViewVals","setViewport","isTransitioning","setIsTransitioning","setProjection","geoMarker","esm","captureDrag","markers_MyLocation","getDistanceScales","viewportChange","newViewport","getMap","_bounds","minlng","minlat","maxlng","maxlat","_fitBounds","WebMercatorViewport","fitBounds","offset","mapStyle","onData","dragPan","mapboxApiAccessToken","c","cloneElement","handleChild","controls_StyleButtons","hideNavControls","showZoom","touchZoom","scrollZoom","showCompass","touchRotate","dragRotate","controls_MyLocationButton","transitionDuration","transitionInterpolator","FlyToInterpolator","transitionEasing","easeCubic","bearing","pitch","child","rootActive","dot","directionIndicator","textShadow","nameActive","Single","svgArc","strokeOpacity","BaseStaticMap","mapRef","recalcProjection","MapDot","staticMap","editable","Map","mapProps","Dot","dlgContent","mapWrapper","sliderWrapper","slider","sliderRoot","MapDirPicker","onOk","onCancel","initLat","initLong","initDir","setCoords","setRotation","maps_MapDot","_ref2$viewport","mapFormLabel","Slider","step","textArea","BigTextEdit","setValue","rows","defaultValue","accessRadio","marginLeft","mapInnerWrap","chips","SeriesEditInner","delta","FormControlLabel","control","Switch","checked","dialogs_MapDirPicker","dialogs_BigTextEdit","newNote","SeriesEdit","setDelta","subViews_SeriesEditInner","swipeAble","slideContainer","slide","dotActive","iconButton","active","last","tagContainer","labelBadge","tagChip","Slideshow","_useStepper","useStepper","lastStep","handleForward","paused","pause","play","showXYTags","setShowXYTags","duration","titlePosition","PlayCircleFilled_default","PauseCircleFilled_default","nextButton","backButton","interval","setActiveStep","setPaused","setLastStep","createTimer","setInterval","oldStep","destroyTimer","clearInterval","CancelConfirm","TagControl_style","actionButtons","TagControl","tagValues","fieldTitle","rootEdit","textBody","DateControl","hint","onSelectChange","inputValue","removedValue","option","newVal","tcv","newCreateVal","v","selectOptions","remainingTags","deleteRemoves","isMulti","onTouchEnd","_ref7","_ref8","_ref9","TagEdit","controls_TagControl","DateView","dlgTitleContainer","catTagTitle","paddingTop","PhotoInfo","canEdit","activeDialogContext","tagInst","TagClass","controls_DateControl","controls_DateView","TagView","dialogs_TagEdit","dirty","PhotoInfoInner","newDelta","dialogs_CancelConfirm","appBarEdit","tipChip","activeButton","STATES","PhotoViewTool","initPhotoId","onUpdatePhoto","setMode","tagsClass","changeMode","desired","onCommitTags","infoButton","Info_default","containerStyle","photoidx","subViews_PhotoInfo","sliderLabel","rail","track","PhotoFadeSlider","setSlider","captured","reference","libraryFab","@media (orientation: landscape)","@media (orientation: portrait)","swipeDrawer","referenceTextContainer","newText","refText","PhotoReviewTool","defaultRefPhotoId","onRetry","newRefPhoto","refPhoto","setRefPhoto","drawerOpen","setDrawerOpen","controls_PhotoFadeSlider","buttonFab","disabledFab","libraryIcon","SwipeableDrawer","anchor","paperAnchorLeft","onOpen","tabIndex","swipeDrawerContainer","role","onKeyDown","useCamera","onCapture","cameraError","setCameraError","cameraOnline","setCameraOnline","camRef","Webcam","getElementById","setup","destroy","captureImage","capturedData","takeDataURLPhoto","quality","captureRawData","takeImageData","webcamElement","canvasElement","location","protocol","hostname","warn","mediaDevices","getUserMedia","aspectRatio","srcObject","getTracks","audio","video","facingMode","mediaStream","URL","createObjectURL","onloadedmetadata","onplaying","imageWidth","videoWidth","imageHeight","videoHeight","getContext","drawImage","_this$_drawImage","_drawImage","getImageData","_this$_drawImage2","toBlob","fileBlob","_this$_drawImage3","toDataURL","cameraErrorText","cameraFab","cameraIcon","cancelFab","cancelIcon","myLocationFab","myLocationIcon","CameraTool","onShutter","setSize","_useCamera","autoPlay","playsInline","muted","Camera_default","NewPhotoInfo","onSave","setSeriesDelta","setPhotoDelta","newAttr","useFileInput","preferCamera","initialClick","anyFile","clickRef","element","accept","capture","handleChange","evt","files","reader","FileReader","onloadend","result","getExtFromFile","readAsDataURL","fileClickEl","forceClick","LibraryFilePicker","cameraPicker","_useFileInput","cameraWords","PhotoLibraryIcon","CameraAltIcon","Series","MODES","NewPhoto","inputMethod","onCreate","isNewSeries","newPhotoData","setNewPhotoData","SeriesClass","setNewSeries","PhotoClass","setNewPhoto","photoRefId","setPhotoRefId","_useState9","_useState10","_changeMode","absolute","alpha","beta","gamma","deviceOrientation","setDeviceOrientation","handleDeviceOrientation","useDeviceOrientation","geo","newModeName","_getExif","date","_newPhoto","rawData","sensors","views_CameraTool","refId","_getExif2","controls_LibraryFilePicker","views_PhotoReviewTool","oldHistory","oldMode","views_NewPhotoInfo","AccessHelper","userSub","permissionObj","ownOrAny","isOwner","attrs","ownAny","perm","otherPerm","attributes","granted","AccessControl","sub","SeriesNotFound","SeriesLoading","thickness","VIEW_ONLY_MODES","RepeatablePhotos","modeName","inputMethodINIT","currentUserId","currentUserRole","accessControl","onNewSeries","onChangePhoto","onNewPhoto","onDeletePhoto","AccesHelper","seriesState","pid","onApprovePhoto","newPid","newInputMethod","canUpdate","to","lastMode","views_SeriesLoading","views_SeriesNotFound","views_SeriesView","photoIdArr","sp","views_SeriesEdit","views_PhotoViewTool","views_Slideshow","views_NewPhoto","Provider","withGetSelectedQuery","skip","connectedWithApollo","onBack","queueUpload","currentUser","INPUT_MODES","getValues","PhotoSeries","_x6","_x4","_x5","_state$home$current","useClusteredData","filterBounds","currentZoom","sizeScale","queryVersion","clusteredData","setClusteredData","single","cluster","filteredData","setFilteredData","setVersion","updateDataDebounce","updatedData","_args","updateData","filterDataDebounce","filtered","_args2","filterData","filteredClusteredData","tree","rbush","screenCoords","project","properties","zoomLevels","geoJSON","point","clear","load","_loop","z","radius","sqrt","pow","neighbors","search","minX","minY","maxX","maxY","neighbor","newGeoJSON","centroid","featureCollection","uuid","reducedPhotoCount","points","newZ","geometry","coordinates","push","Apple","FeatureDisabled","IconComp","AppleIcon","PaperProps","drawerInner","disableListItem","fullList","SideDrawer","onDisabledClick","onQRClick","onOfflineMenuClick","AccountCircle_default","loginButton","MobileScreenShare_default","CloudDownload_default","ExitToApp_default","borderBottom","searchIcon","transparent","iOsIcon","transparentLogo","transparentLogoIcon","qrButton","qrButtonTransparent","TopBar","isTransparent","hideLogo","appleDlg","setAppleDlg","AppLogoSimple","components_SideDrawer","misc_FeatureDisabled","components_TopBar","TopBar_TopBar","useSearchBarStyles","shape","common","white","&:hover","breakpoints","up","inputRoot","inputInput","pointerEvents","justifyContent","SearchInput","debounceSearchText","blur","Search_default","InputBase","chipContainer","accessLabel","accessPUBLIC","accessPRIVATE","accessOPEN","verticalAlign","textSm","titleText","dateContainer","dateLabel","dateText","imgFiller","imgContainerSm","SeriesListItem","showCreatedOn","showLastPhoto","small","misc_SeriesListItem","listItemText","compoundButton","ClusterSelected","seriesCount","onZoomTo","onViewList","ZoomOutMap_default","ViewList_default","overflowX","ViewListDialog","seriesList","onSelect","disablePadding","&.PUBLIC","&.PRIVATE","&.OPEN","avatarActive","badge","badgeActive","Cluster","numeral","& .myPosMarker","& .singleMarker","& .clusterMarker","topBar","loadingWrapper","zoomOutFab","selectedPopup","defaultView","HomeMap","onSeriesNavigate","onSeriesMapSelect","onSearchClick","pushMapHistory","popMapHistory","clearMapHistory","mapViewObj","setMapViewObj","mapViewRef","homeMapContainerRef","setCurrentZoom","showViewList","setShowViewList","setTransitions","_useState11","_useState12","selectedItem","setSelectedItem","bufferPts","buffer","units","bbox","updateSelectedItem","item","delay","saveObj","transitionInterruption","maxZoom","minZoom","maxPitch","minPitch","saveMap","object","pts","paddedPoint","lngBuff","latBuff","buffBounds","onMarkerClick","LinearInterpolator","markersRendered","offsetLeft","offsetTop","markers_Single","markers_Cluster","selectedItemRender","misc_ClusterSelected","Search_SearchInput","components_maps_BaseMap","viewZoom","getBounds","_map$getBounds","_map$getBounds$_sw","_sw","minLng","lng","minLat","lat","_map$getBounds$_ne","_ne","maxLng","maxLat","oldMinLng","oldMinLat","oldMaxLng","oldMaxLat","onNativeClick","misc_ViewListDialog","POLL_INTERVAL","withAllSeries","fetchMore","updateQuery","fetchMoreResult","setSeriesProps","readyForPolling","withPollQuery","lastCheck","_ref5$ownProps","seriesProps","updateIncrement","changedSeries","oldList","newSeriesSummaries","polledSeries","ds","oldSeries","oldId","AllSeriesConnect","PollQueryConnect","mapFuncs","tab","setLastCheck","allSeriesQUERY","pollSeriesQUERY","maps_HomeMap","chosenItem","closeIcon","avatarImg","SearchContextItem","TheIcon","LabelIcon","PersonIcon","Search_SearchContextItem","listSection","ul","SearchContextResults","contextResults","setContextChoice","cr","SearchEnder","ctxItem","SearchResults","contextChoice","onResultClick","listRef","enderRef","handleScroll","_listRef$current","scrollTop","Search_SearchEnder","subheader","onScroll","SearchPlaceholder","PlaceholderIcon","TABS","tabs","ListWrapper","Search","currentTab","setCurrentTab","defaultText","searchText","setSearchText","searchResults","onMapClick","Search_SearchResults","Search_SearchContextResults","Search_SearchPlaceholder","PortableWifiOffIcon","indicatorColor","flexContainer","centered","TAGS","withTagSearch","ceil","withUserSearch","searchStr","withGeoCode","geocoder","_ref10","relevance","placeName","center","_ref11","_ref12","withTagSeries","_ref13","tagSeries","_ref14","_ref15","_ref16","withUserSeries","_ref17","_ref18","_ref19","_ref20","defaultTab","jumpToSeries","jumpToMap","_ref21","bboxFunc","withContextQuery","withSearchQuery","ComposedSearch","newContextChoice","newTab","MeCard","filterContainer","filterChip","seriesListItemWrap","noneFound","SORT","MyProfile","mySeries","watchingSeries","sortVal","setSort","sortAsc","setSortAsc","sortSetter","newSort","tabFeed","firstname","MyProfile_MeCard","MyProfile_FilterSortItem","asc","useFilterStyles","FilterSortItem","arrow","withuserSeriesQuery","seriesQ","withMyWatchedSeriesQuery","watchedSeriesQ","queryWrapped","arraySeries","components_MyProfile_MyProfile","FeedEnder","placeAvatar","placeIcon","FindOnMapButton","Place_default","findOnMapButtonContainer","titleContainer","seriesName","EVENT_VERBS","FeedItem","onImageClick","onProfileClick","onSeriesClick","misc_FindOnMapButton","listContainer","vList","feedContainer","MyFeed","events","fetchNewest","dist_es","rowCount","rowHeight","rowRenderer","isScrolling","isVisible","parent","row","MyFeed_FeedItem","wEnd","MyFeed_FeedEnder","almostAtEnd","ROWHEIGHT","withFeedQuery","loadingNewest","loadingMore","start","end","jumpToUser","components_MyFeed_MyFeed","rectContents","black","areaLabel","rectContentsDownloading","rectIcon","tooBig","tickText","svgRect","svgCutout","svgBorder","svgBorderNavigating","svgBorderLocked","svgBorderTooBig","svgBorderDownloading","downloadingProgress","downloadingProgressCircle","snackError","OfflineMap","toolState","onStartDownload","onUnlock","onCancelComplete","mapWrapperRef","setBounds","viewState","area","setArea","classWithState","setGeoState","rectSide","newArea","abs","metersPerPixel","dx","degreesPerPixel","dy","newBounds","snack","onSnackClose","snackTimeout","SnackbarContent","unlocked","doubleClickZoom","rectStyle","boxCorners","totalProgress","tileTick","seriesTick","seriesPhotoTick","CheckCircleOutline_default","Lock_default","SignalWifiOff_default","xmlns","fillRule","withGeoSearch","seriesInGeoBounds","setSeriesIds","ids","WholeSeriesConnect","onDone","GeoQuery","lastMapViewport","_state$offline","setOfflineCompleted","setOfflineViewport","setToolState","limiterRef","seriesIds","activeSeriesId","setActiveSeriesId","seriesPhotos","setSeriesPhotos","setTileTick","_useState13","_useState14","setSeriesTick","_useState15","_useState16","setSeriesPhotoTick","tileTickRef","onTileTick","onSeriesPhotoTick","onSeriesTick","theTick","theIds","thePhotos","addCount","schedule","makeRequest","finalState","geoSeriesQuery","wholeSeriesQuery","dropWaitingJobs","Bottleneck","maxConcurrent","tiles","zoomRange","xtileLeft","long2tile","xtileRight","ytileTop","lat2tile","ytileBottom","getTileURL","getTiles","newTotal","maps_OfflineMap","method","xhr","XMLHttpRequest","onload","status","statusText","onerror","replace","qrIcon","backupText","manualImg","tipPaper","docContainer","cameraContainer","cameraContainerError","snackErr","snackSuccess","snackMsg","QRReader","capturedBlob","setCapturedBlob","setErr","code","setCode","captureFunc","scan","scannedCode","decodedUrl","jsQRFromBlob","decodeURI","jsQR","OfflineBar","sinceStr","setSinceStr","calcSinceStr","clearTimer","homeConfig","borderTop","BottomBar","onHomeClick","edge","HomeOutlined_default","MapOutlined_default","SearchOutlined_default","PersonOutline_default","components_BottomBar","outerRoot","offlineBar","activeWrapper","flexShrink","uploaderContainer","App","onQRCapture","setHomeState","showBottomBar","activeProps","ActiveComponent","FeedConnect","MapConnect","ProfileConnect","SearchConnect","SeriesConnect","misc_OfflineBar","Uploader_connect","setUseOffline","_useAuthentication","_useGraphQL","apolloDone","apolloState","_useOnline","_useShowAddToHome","responsive","appContext","_getPhotoUrls","react_apollo_esm","translations_IntlWrapper","lib_ErrorBoundary","ErrorConnect","isLocalhost","match","registerValidSW","swUrl","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","onUpdate","onSuccess","require","ReactDOM","App_connect","href","origin","fetch","contentType","ready","unregister","reload","checkValidServiceWorker"],"mappings":"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","file":"static/js/main.8fa74cf3.chunk.js","sourcesContent":["const TYPES = {\n  // Series meta gets appended automatically to the seriees\n  SERIES: 'SERIES',\n  // Same but now only gets appended to the photo\n  PHOTO: 'PHOTO'\n}\nclass SeriesConfig {\n  constructor (seriesConfig) {\n    if (!seriesConfig) throw new Error('No seriesConfig object provided to SeriesConfig class')\n    this.config = seriesConfig\n  }\n\n  getTagType = (typeId) => this.config.tags.find(tt => tt.id === typeId)\n  // getTagTypeIndex = (typeId) => this.config.tags.findIndex(tt => tt.id === typeId)\n  getTagTypeIndex = (typeId) => {\n    // console.log('HERE', typeId)\n    return this.config.tags.findIndex(tt => tt.id === typeId)\n  }\n\n  getXYTagTypes = () => this.config.tags.filter(tt => tt.allowXY)\n  getNonXYTagTypes = () => this.config.tags.filter(tt => tt.allowNonXY)\n\n  getSeriesMeta = () => Object.keys(this.config.meta)\n    .filter(key => this.config.meta[key].type === TYPES.SERIES)\n    .reduce((acc, key) => ({\n      ...acc,\n      [key]: this.config.meta[key].default\n    }), {})\n\n  getPhotoMeta = () => Object.keys(this.config.meta)\n    .filter(key => this.config.meta[key].type === TYPES.PHOTO)\n    .reduce((acc, key) => ({\n      ...acc,\n      [key]: this.config.meta[key].default\n    }), {})\n}\n\nexport default SeriesConfig\n","import { convertJSDatetoTimestamp } from './datelib'\nimport SeriesConfig from './SeriesConfig'\nimport uuidv4 from 'uuid/v4'\nimport exifParser from 'exif-parser'\nimport { isNumeric } from './util'\n\nclass Photo {\n  constructor (seriesConfig, photo) {\n    this.config = new SeriesConfig(seriesConfig)\n    if (photo) this.photo = photo\n    else {\n      this.photo = this.newPhoto()\n    }\n  }\n\n  setMeta = () => {\n    this.meta = JSON.stringify(this.config.getPhotoMeta())\n  }\n\n  newPhoto = () => ({\n    id: `L-${uuidv4()}`,\n    uploadToken: uuidv4(),\n    takenOn: convertJSDatetoTimestamp(new Date()),\n    meta: JSON.stringify(this.config.getPhotoMeta()),\n    tags: []\n  })\n}\n\nexport default Photo\n\nexport const getObjectUrl = async (store, key) => {\n  try {\n    const dbval = await store.getItem(key)\n    const urlVal = window.URL.createObjectURL(dbval)\n    if (urlVal && urlVal.indexOf('data:image') === 0) {\n      return urlVal\n    }\n  }\n  catch (e) {\n    console.error(e)\n  }\n\n  return null\n}\n\nexport const getExif = (dataUrl) => {\n  console.log('onLibraryAdd Buffered')\n\n  let exif = null\n  let exifDateTime = null\n  let exifGPS = null\n  try {\n    const find = 'base64,'\n    const foundIdx = dataUrl.indexOf(find) + find.length\n    const newData = dataUrl.slice(foundIdx)\n    const parser = exifParser.create(Buffer.from(newData, 'base64'))\n    exif = parser.parse()\n    console.log('got EXIF', exif)\n  }\n  catch (err) {\n  // got invalid data, handle error\n    console.log('EXIF ERROR', err)\n  }\n  if (exif && exif.tags) {\n    // Try to parse the DateTime of the original image\n    try {\n      if (exif.tags && exif.tags.DateTimeOriginal && String(exif.tags.DateTimeOriginal)) {\n        exifDateTime = String(exif.tags.DateTimeOriginal)\n      }\n    }\n    catch (err) {\n      console.log('ERROR GETTING TIMESTAMP', { err, exif })\n    }\n    // Try to pull out the GPS info from the image\n    try {\n      if (exif.tags.GPSLatitude && isNumeric(exif.tags.GPSLatitude) && exif.tags.GPSLongitude && isNumeric(exif.tags.GPSLongitude)) {\n        exifGPS = [exif.tags.GPSLongitude, exif.tags.GPSLatitude]\n      }\n    }\n    catch (e) {\n      console.error('GPS Longitude and Latitude could not be determined')\n    }\n  }\n  return { exif, exifDateTime, exifGPS }\n}\n","import moment from 'moment'\n\n/**\n * Takes a UTC unix timestamp integer or string (milliseconds)\n * and a valid moment format string and returns a formatted\n * date string\n * @param {*} utctimestamp\n * @param {*} format\n */\nexport const formatDate = (utctimestamp, format = 'LLLL') => {\n  return moment(utctimestamp, 'x').format(format)\n}\n\nexport const formatDatAgo = (utctimestamp) => {\n  return moment(utctimestamp, 'x').fromNow()\n}\n\n/**\n * Takes a UTC timestamp and returns a moment object in LOCAL mode\n * @param {*} utctimestamp\n */\nexport const parseDate = (utctimestamp) => {\n  return moment(utctimestamp, 'x')\n}\n\n/**\n * This returns the object in LOCAL mode\n * @param {*} jsDate\n */\nexport const convertJSDatetoTimestamp = (jsDate) => {\n  return moment\n    .utc(jsDate)\n    .format('x')\n}\n\n/**\n *\n * @param {*} utctimestamp\n */\nexport function timestampToHTML5Input (utctimestamp) {\n  // // trim the Z and milliseconds + seconds\n  return moment(utctimestamp, 'x').format('YYYY-MM-DDTkk:mm')\n}\n\n/**\n * Returns an integer timestamp\n * @param {*} isoStr\n */\nexport function HTML5InputToTimestamp (isoStr) {\n  return moment(new Date(isoStr), 'YYYY-MM-DDTkk:mm').format('x')\n}\n","import numeral from 'numeral'\n\nexport const isNumeric = num => {\n  try {\n    return !isNaN(parseFloat(num)) && isFinite(num)\n  }\n  catch (e) {\n    return false\n  }\n}\n/**\n * This is a correction to strip === signs off of base64-encoded strings\n * @param {} x\n */\nexport const urlizeb64 = x => x.replace('+', '-').replace('/', '_').replace(/=+$/, '')\n\n/**\n * We need numbers displayed consistently. This is how we do it.\n * @param {*} num\n * @param {*} precision\n */\nexport function formatNum (num, precision) {\n  try {\n    const precstr = precision > 0 ? '.' + Array(precision + 1).join('0') : ''\n    const newprec = isNumeric(num) ? numeral(num).format(`0,0${precstr}`) : num\n    return newprec.replace(/(\\.(0{0,1}[1-9]*))0+$/, '$1')\n  }\n  catch (e) {\n    return num\n  }\n}\n\n/**\n * Magic function to clear mouse selection. Use sparingly.\n */\nexport function clearSelection () {\n  if (document.selection && document.selection.empty) {\n    document.selection.empty()\n  }\n  else if (window.getSelection) {\n    var sel = window.getSelection()\n    sel.removeAllRanges()\n  }\n}\n\nexport function isObjectWithKeys (obj) {\n  return ((typeof obj === 'object') && (obj !== null) && Object.keys(obj).length > 0)\n}\n\n/**\n * Dom node parsing is weird because it may return an array or a single element with no way to know\n * which is which.\n */\nexport function makeDomArray (domnode) {\n  if (!domnode) return []\n  const keys = Object.keys(domnode)\n  // This is not the pattern we expect\n  if (keys.length > 1 || keys.length === 0) throw Error('Expected nester domnode structure.')\n  if (!domnode) return []\n  if (!domnode[keys[0]]) return []\n  return Array.isArray(domnode[keys[0]]) ? domnode[keys[0]] : [domnode[keys[0]]]\n}\n\nexport function capitalizeFirstLetter (string) {\n  return string.charAt(0).toUpperCase() + string.slice(1)\n}\n\n/**\n * Good for comparing two purely numeric arrays\n * @param {*} arr1\n * @param {*} arr2\n */\nexport function numericArrayCompare (arr1, arr2) {\n  if (!Array.isArray(arr1) || !Array.isArray(arr2)) return false\n  if (arr1.length !== arr2.length) return false\n\n  return !arr1.some((el, idx) => el !== arr2[idx])\n}\n\n/**\n * We need a function to add the padding '=' signs back before we decode\n * @param {*} hash\n */\nexport function decodeUnbufferedBase64 (hash) {\n  const missingPadding = hash.length % 4\n  if (missingPadding !== 0) {\n    const newhash = hash + Array(4 - missingPadding).join('=')\n    return Buffer.from(newhash, 'base64').toString()\n  }\n  else {\n    return Buffer.from(hash, 'base64').toString()\n  }\n}\n\nexport function encodeUnbufferedBase64 (str) {\n  return urlizeb64(Buffer.from(str).toString('base64'))\n}\n\n/**\n *\n * @param {*} o\n */\nexport function isObject (o) {\n  return o instanceof Object && o.constructor === Object\n}\n\n/**\n * XML to JSON is a non-trivial exercise. We can make certain assumptions\n * about our incoming file\n * @param {*} data\n */\nexport function arrToObj (data) {\n  for (const key in data) {\n    // Make sure we're looping over legitimate objects\n    if (data.hasOwnProperty(key)) {\n      const keyDat = data[key]\n      if (keyDat._) {\n        keyDat.val = keyDat._\n        delete keyDat._\n      }\n      if (keyDat.$) {\n        keyDat.attr = keyDat.$\n        delete keyDat.$\n      }\n      if (typeof keyDat === 'object') {\n        data[key] = arrToObj(keyDat)\n        // There's a pattern we want to collapse\n        // It puts every single individual value into its own array. Not cool\n        if (Array.isArray(keyDat) && keyDat.length === 1 && typeof keyDat[0] === 'string') {\n          if (isNumeric(keyDat[0])) data[key] = Number(keyDat[0])\n          else data[key] = keyDat[0].replace(/\\\\/g, '/')\n        }\n        else if (Array.isArray(keyDat) && keyDat.length === 1 &&\n        // The second case is when it puts objects into its own array\n          isObject(keyDat[0]) &&\n          Object.keys(keyDat[0]).length === 1) {\n          // xml2js does a weird thing where attributes get put into the following structure\n          // [{ \"_\": \"475945.992587164,5125837.37170763\", \"$\": { \"units\": \"m\"  } }]\n          data[key] = keyDat[0][Object.keys(keyDat[0])[0]]\n        }\n        // Dynamo DB does not like empty strings\n        if (typeof data[key] && data[key].length === 0) {\n          delete data[key]\n        }\n        if (typeof data[key] === 'string' && isNumeric(data[key])) data[key] = Number(data[key])\n      }\n    }\n  }\n  return data\n}\n\n/**\n * Returns a random number between min (inclusive) and max (exclusive)\n */\nexport function getRandomArbitraryInt (min, max) {\n  return parseInt(Math.random() * (max - min) + min, 10)\n}\n\n/**\n * Returns a function, that, as long as it continues to be invoked, will not\n * be triggered. The function will be called after it stops being called for\n * N milliseconds. If `immediate` is passed, trigger the function on the\n * leading edge, instead of the trailing.\n * @param {*} func\n * @param {*} wait\n * @param {*} immediate\n */\nexport function debounce (func, wait, immediate) {\n  let timeout = null\n  return (...innerArgs) => {\n    const context = this\n    // const args = arguments\n    const callNow = immediate && !timeout\n    clearTimeout(timeout)\n\n    timeout = setTimeout(() => {\n      timeout = null\n      if (!immediate) {\n        // console.log('debounce', innerArgs)\n        func.apply(context, innerArgs)\n      }\n    }, wait)\n    if (callNow) {\n      // console.log('debounce', innerArgs)\n      func.apply(context, innerArgs)\n    }\n  }\n};\n\n// var myEfficientFn = debounce(function() {\n// // All the taxing stuff you do\n// }, 250);\n\n// window.addEventListener('resize', myEfficientFn);\n","// https://medium.com/@shalkam/create-react-app-i18n-the-easy-way-b05536c594cb\nimport React, { useContext } from 'react'\nimport PropTypes from 'prop-types'\nimport { IntlProvider, addLocaleData } from 'react-intl'\nimport frLocaleData from 'react-intl/locale-data/fr'\n\naddLocaleData(frLocaleData)\n\nexport const IntlContext = React.createContext({})\n\n// the format message hook\nexport const useIntl = () => {\n  const intl = useContext(IntlContext)\n  return intl.formatMessage\n}\n\nexport const IntlWrapper = ({ children }) => (\n  <IntlProvider locale='en'>\n    {children}\n  </IntlProvider>\n)\nIntlWrapper.propTypes = {\n  children: PropTypes.any\n}\n","import gql from 'graphql-tag'\n\nexport const photoSummaryFragment = gql`\nfragment photoSummaryFragment on PhotoSummary {\n  id\n  takenOn\n  seriesCreatedBy\n  updatedOn\n  createdOn\n  seriesId\n  createdUser {\n    ...userSummaryFragment\n  }\n  paths {\n    base\n    thumb\n    medium\n    large\n    __typename\n  }\n  __typename\n}\n`\nexport const photoSummaryKeys = [\n  'id',\n  'takenOn',\n  'seriesCreatedBy',\n  'updatedOn',\n  'createdOn',\n  'seriesId',\n  'createdUser',\n  'applyPatches'\n]\n\nexport const userSummaryFragment = gql`\nfragment userSummaryFragment on UserSummary {\n  id\n  gravatar\n  gravatarProfile\n  username\n  __typename\n}\n`\nexport const userSummaryKeys = [\n  'id',\n  'gravatar',\n  'gravatarProfile',\n  'username'\n]\n\nexport const seriesSummaryFragment = gql`\nfragment seriesSummaryFragment on SeriesSummary {\n  id\n  name\n  access\n  createdUser {\n    ...userSummaryFragment\n  }\n  seriesStatus\n  updatedOn\n  createdOn\n  photoCount\n  coords\n  direction\n  watchers\n  featured {\n    ...photoSummaryFragment\n  }\n  latest {\n    ...photoSummaryFragment\n  }\n  __typename\n}\n${photoSummaryFragment}\n${userSummaryFragment}\n`\nexport const seriesSummaryKeys = [\n  'id',\n  'name',\n  'access',\n  'createdUser',\n  'seriesStatus',\n  'updatedOn',\n  'createdOn',\n  'photoCount',\n  'coords',\n  'direction',\n  'watchers',\n  'featured',\n  'latest'\n]\n\nexport const seriesFragment = gql`\nfragment seriesFragment on Series {\n  id\n  name\n  access\n  note\n  meta\n  watchers\n  createdOn\n  updatedOn\n  createdUser {\n    ...userSummaryFragment\n  }\n  updatedUser {\n    ...userSummaryFragment\n  }\n  coords\n  direction\n  photoCount\n  featured {\n    ...photoSummaryFragment\n  }\n  latest {\n    ...photoSummaryFragment\n  }\n  __typename\n}\n${photoSummaryFragment}\n${userSummaryFragment}\n`\nexport const seriesKeys = [\n  'id',\n  'name',\n  'access',\n  'note',\n  'meta',\n  'watchers',\n  'createdOn',\n  'updatedOn',\n  'createdUser',\n  'updatedUser',\n  'coords',\n  'direction',\n  'photoCount',\n  'featured',\n  'latest'\n]\n\nexport const photoFragment = gql`\nfragment photoFragment on Photo {\n  id\n  meta\n  createdOn\n  takenOn\n  updatedOn\n  coords\n  seriesId\n  seriesCreatedBy\n  createdBy\n  updatedBy\n  uploadToken\n  createdUser {\n    ...userSummaryFragment\n  }\n  updatedUser {\n    ...userSummaryFragment\n  }\n  tags {\n    label\n    typeId\n    coords {\n      x\n      y\n      __typename\n    }\n    __typename\n  }\n  paths {\n    base\n    large\n    thumb\n    medium\n    __typename\n  }\n  __typename\n}\n${userSummaryFragment}\n`\nexport const photoKeys = [\n  'id',\n  'meta',\n  'createdOn',\n  'takenOn',\n  'updatedOn',\n  'coords',\n  'seriesId',\n  'seriesCreatedBy',\n  'createdBy',\n  'updatedBy',\n  'uploadToken',\n  'createdUser',\n  'updatedUser',\n  'tags',\n  'paths'\n]\n\nexport const userFragment = gql`\nfragment userFragment on User {\n  id\n  username\n  gravatar\n  watching\n  gravatarProfile\n  meta\n  createdOn\n  updatedOn\n  __typename\n}\n`\nexport const userKeys = [\n  'id',\n  'username',\n  'gravatar',\n  'watching',\n  'gravatarProfile',\n  'meta',\n  'createdOn',\n  'updatedOn'\n]\n","import gql from 'graphql-tag'\nimport {\n  photoSummaryFragment,\n  photoFragment,\n  seriesSummaryFragment,\n  seriesFragment,\n  userFragment\n} from './fragments'\n\nexport const allSeries = gql`\nquery allSeries($limit: Int, $nextToken: String) {\n  allSeries(limit: $limit, nextToken: $nextToken) @connection(key: \"allSeries\"){\n    seriesSummaries {\n      ...seriesSummaryFragment\n    }\n    nextToken\n    __typename\n  }\n}\n${seriesSummaryFragment}\n`\n\nexport const pollQuery = gql`\nquery pollQuery($lastCheck: String!, $limit: Int, $nextToken: String) {\n  changedSeries(lastCheck: $lastCheck, limit: $limit, nextToken: $nextToken) @connection(key: \"changedSeries\"){\n    seriesSummaries {\n      ...seriesSummaryFragment\n    }\n    __typename\n  }\n}\n${seriesSummaryFragment}\n`\n\nexport const userSeries = gql`\nquery userSeries($createdBy: ID) {\n  userSeries(createdBy: $createdBy ) {\n    seriesSummaries {\n      ...seriesSummaryFragment\n    }\n    nextToken\n    __typename\n  }\n}\n${seriesSummaryFragment}\n`\n\nexport const seriesSummaryFromList = gql`\nquery seriesFromList($seriesList: [ID]) {\n  arraySeries(seriesIds: $seriesList) {\n    ...seriesSummaryFragment\n  }\n}\n${seriesSummaryFragment}\n`\n\nexport const seriesFromList = gql`\nquery seriesFromList($seriesList: [ID]) {\n  arraySeries(seriesIds: $seriesList) {\n    ...seriesFragment\n    photos {\n      ...photoFragment\n    }\n  }\n}\n${seriesFragment}\n${photoFragment}\n`\n\nexport const seriesWithTag = gql`\nquery seriesWithTag($tag: String!, $limit: Int, $nextToken: String) {\n  tagSeries(tag: $tag, limit: $limit, nextToken: $nextToken) {\n    seriesSummaries{\n      ...seriesSummaryFragment\n    }\n    nextToken\n    __typename\n  }\n}\n${seriesSummaryFragment}\n`\n\nexport const tagSearch = gql`\nquery tagSearch($limit: Int, $tag: String) {\n  tags(limit: $limit, tag: $tag ){\n    _id\n    name\n    count\n    __typename\n  }\n}\n`\n\nexport const geoSeries = gql`\nquery seriesInGeoBounds($bounds: [Float], $limit: Int, $nextToken: String) {\n  seriesInGeoBounds(bounds: $bounds, limit: $limit, nextToken: $nextToken) {\n    seriesSummaries {\n      ...seriesSummaryFragment\n    }\n    nextToken\n    __typename\n  }\n}\n${seriesSummaryFragment}\n`\n\nexport const geoSeriesIdOnly = gql`\nquery seriesInGeoBoundsIdOnly($bounds: [Float], $limit: Int, $nextToken: String) {\n  seriesInGeoBounds(bounds: $bounds, limit: $limit, nextToken: $nextToken) {\n    seriesSummaries {\n      id\n      name\n    }\n    nextToken\n    __typename\n  }\n}\n`\n\nexport const getUser = gql`\nquery getUser($userId: ID) {\n  user(id: $userId){\n    ...userFragment\n  }\n}\n${userFragment}\n`\n\nexport const geocode = gql`\nquery geocode($search: String!) {\n  geocoder(search: $search) {\n    relevance\n    text\n    placeName\n    bbox\n    center\n    # geoType\n    # context\n    __typename\n  }\n}\n`\nexport const getMyFeed = gql`\nquery myFeed($start: String, $end: String, $limit: Int) {\n  myFeed(start: $start, end: $end, limit: $limit) @connection(key: \"myFeed\"){\n    feed {\n      _id\n      series {\n        ...seriesSummaryFragment\n      }\n      photo {\n        ...photoSummaryFragment\n      }\n      relation\n      __typename\n    }\n    window\n    __typename\n  }\n}\n${seriesSummaryFragment}\n${photoSummaryFragment}\n`\n\nexport const userSearch = gql`\nquery userSearch($searchStr: String!, $limit: Int) {\n  userSearch(searchStr: $searchStr, limit: $limit ){\n    ...userFragment\n  }\n}\n${userFragment}\n`\n\nexport const getWholeSeries = gql`\nquery getWholeSeries($id: ID!) {\n  series(id: $id) {\n    ...seriesFragment\n    photos {\n      ...photoFragment\n    }\n  }\n}\n${seriesFragment}\n${photoFragment}\n`\n","import { createMuiTheme } from '@material-ui/core/styles'\nimport { fade, lighten } from '@material-ui/core/styles/colorManipulator'\n// import {\n//   cyan, teal, indigo, grey, blueGrey, pink, yellow, deepOrange, red\n// } from '@material-ui/core/colors'\n\n// We need this so that it doesn't freak out abotu old variants\nconst typography = {\n  useNextVariants: true\n}\n\nconst overrides = {\n  // Name of the component ⚛️\n  MuiDialog: {\n    paper: {\n      '@media (max-width:321px)': {\n        margin: 10\n      }\n    },\n    paperFullWidth: {\n      '@media (max-width:321px)': {\n        width: 'calc(100% - 20px)'\n      }\n    }\n  }\n}\n\nconst colors = {\n  jet: '#3a3335', // JET\n  rose: '#d81e5b', // DOGWOOD ROSE\n  redorange: '#f0544f', // RED-ORANGE\n  papayawhip: '#FDF0D5', // PAPAYA WHIP\n  cblue: '#C6D8D3' // COLUMBIA-BLUE\n}\n\nconst home = {\n  palette: {\n    primary: {\n      main: colors.redorange\n    },\n    secondary: {\n      main: colors.rose\n    },\n    text: {\n      primary: colors.jet,\n      secondary: fade(colors.jet, 0.7)\n    }\n  },\n  typography,\n  overrides\n}\n\nconst series = {\n  palette: {\n    primary: {\n      main: lighten(colors.jet, 0.1)\n    },\n    secondary: {\n      main: colors.rose\n    },\n    text: {\n      primary: colors.jet,\n      secondary: fade(colors.jet, 0.7)\n    }\n  },\n  typography,\n  overrides\n\n}\n\nconst topbar = {\n  palette: {\n    primary: {\n      main: colors.redorange\n    },\n    secondary: {\n      main: colors.rose\n    }\n  },\n  typography\n}\n\nconst bottombar = {\n  palette: {\n    primary: {\n      main: colors.papayawhip\n    },\n    secondary: {\n      main: colors.redorange\n    }\n  },\n  typography\n}\n\nconst login = {\n  palette: {\n    primary: {\n      main: colors.redorange\n    },\n    secondary: {\n      main: colors.rose\n    },\n    text: {\n      primary: colors.papayawhip,\n      secondary: fade(colors.papayawhip, 0.7)\n    },\n    background: {\n      default: colors.jet,\n      paper: colors.jet\n    }\n  },\n  typography,\n  overrides\n}\n\nexport default {\n  home: createMuiTheme(home),\n  login: createMuiTheme(login),\n  series: createMuiTheme(series),\n  topbar: createMuiTheme(topbar),\n  bottombar: createMuiTheme(bottombar)\n}\n","import React from 'react'\n\nexport const AppContext = React.createContext({})\n","import { useRef, useEffect } from 'react'\n\nconst useAuthCommon = () => {\n  const containerRef = useRef()\n  const handleKeyPress = (event) => {\n    if (event.key === 'Enter') {\n      if (containerRef.current) {\n        try {\n          const found = containerRef.current.getElementsByClassName('enterAction')\n          if (found && found[0]) found[0].click()\n        }\n        catch (e) {\n          console.error('useAuthCommon::handleKeyPress', e)\n        }\n      }\n    }\n  }\n  useEffect(() => {\n    if (containerRef.current) {\n      try {\n        document.addEventListener('keypress', handleKeyPress, false)\n      }\n      catch (e) {\n        console.error('useAuthCommon::useEffect', e)\n      }\n      return () => document.removeEventListener('keypress', handleKeyPress, false)\n    }\n  }, [])\n\n  return containerRef\n}\n\nexport default useAuthCommon\n","import React from 'react'\nimport createSvgIcon from '@material-ui/icons/utils/createSvgIcon'\n\nexport default createSvgIcon(\n  <React.Fragment>\n    <path d='M13.685,2.797c-0.44,1.273 0.852,3.525 -1.082,4.966c-1.247,0.93 -2.133,2.247 -2.743,4.167c-3.78,-7.611 2.788,-8.409 3.682,-10.699c0.64,1.255 5.18,2.608 2.89,4.873c1.28,-2.034 -2.359,-1.862 -2.747,-3.307Z' />\n    <path d='M4.921,5.953c0.883,1.017 3.479,1.024 3.76,3.42c0.181,1.545 0.879,2.971 2.238,4.459c-8.482,-0.532 -5.889,-6.619 -7.425,-8.538c1.407,0.073 4.848,-3.183 5.665,-0.066c-1.121,-2.126 -2.792,1.111 -4.238,0.725Z' />\n    <path d='M3.236,15.092c1.323,-0.256 2.627,-2.5 4.842,-1.546c1.428,0.615 3.013,0.724 4.98,0.292c-4.701,7.079 -8.676,1.79 -11.106,2.161c0.766,-1.183 -0.332,-5.791 2.775,-4.94c-2.402,-0.091 -0.433,2.974 -1.491,4.033Z' />\n    <path d='M10.309,21.121c0.439,-1.274 -0.852,-3.525 1.081,-4.967c1.247,-0.929 2.133,-2.246 2.743,-4.167c3.781,7.611 -2.788,8.409 -3.681,10.699c-0.641,-1.255 -5.181,-2.607 -2.891,-4.873c-1.28,2.034 2.359,1.863 2.748,3.308Z' />\n    <path d='M19.066,18.01c-0.883,-1.017 -3.479,-1.024 -3.76,-3.42c-0.182,-1.544 -0.88,-2.971 -2.238,-4.459c8.482,0.532 5.889,6.619 7.425,8.538c-1.407,-0.072 -4.849,3.183 -5.665,0.067c1.121,2.125 2.792,-1.112 4.238,-0.726Z' />\n    <path d='M20.751,8.871c-1.323,0.256 -2.627,2.501 -4.842,1.546c-1.429,-0.615 -3.013,-0.723 -4.98,-0.291c4.701,-7.08 8.676,-1.791 11.106,-2.162c-0.767,1.183 0.332,5.791 -2.775,4.94c2.401,0.092 0.433,-2.974 1.491,-4.033Z' />\n\n  </React.Fragment>, 'AppLogo')\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport { makeStyles } from '@material-ui/core/styles'\n// import style from './auth.style'\nimport useAuthCommon from './useAuthCommon'\nimport AppLogo from '../../icons/AppLogo'\n\nimport { ThemeProvider } from '@material-ui/styles'\nimport themes from '../../themes'\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    height: '100%'\n  },\n  bgSwoosh: {\n    width: '100%',\n    height: '100%',\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    zIndex: 0\n  },\n  spacer: {\n    flex: '1 1 5%'\n  },\n  logo: {\n    flex: '1 1 40%',\n    width: '100%',\n    minHeight: 90\n  },\n  inner: {\n    margin: '0 auto',\n    width: '100%',\n    height: '100%',\n    minWidth: 200,\n    maxWidth: 300,\n    display: 'flex',\n    flexDirection: 'column',\n    textAlign: 'center'\n  }\n}))\n\nconst AuthContainer = ({ children }) => {\n  const containerRef = useAuthCommon()\n  const classes = useStyles()\n  return (\n    <ThemeProvider theme={themes.login}>\n      <div ref={containerRef} className={classes.root}>\n        <CssBaseline />\n        {/* Look for: LoginSwoosh.svg */}\n        {/* <svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 500 500' preserveAspectRatio='none' className={classes.bgSwoosh}>\n        <path className={classes.bgSwooshFill} d=' M 0 0 L 500 0 C 500 209.782 489.956 180 250 180 C 10.044 180 0 219.954 0 370 L 0 0 Z ' />\n      </svg> */}\n\n        <div className={classes.inner}>\n          {/* Look for: Logo.svg */}\n          <AppLogo className={classes.logo} />\n\n          <Typography variant='h5'>MorPhoto</Typography>\n          {children}\n          <div className={classes.spacer} />\n        </div>\n      </div>\n    </ThemeProvider>\n  )\n}\n\nAuthContainer.propTypes = {\n  children: PropTypes.any\n}\n\nexport default AuthContainer\n","import React from 'react'\nimport PropTypes from 'prop-types'\n// import MenuIcon from '@material-ui/core/Menu'\n// import { makeStyles } from '@material-ui/core/styles'\n// import style from './auth.style'\nimport AuthContainer from './AuthContainer'\nimport { Typography } from '@material-ui/core'\n\n// const useStyles = makeStyles(style)\n\nconst Loading = ({ message }) => {\n  // const classes = useStyles()\n  return (\n    <AuthContainer>\n      <Typography variant='h3'>Loading...</Typography>\n      {message && <Typography variant='overline'>{message}</Typography>}\n    </AuthContainer>\n  )\n}\n\nLoading.propTypes = {\n  message: PropTypes.string\n}\n\nexport default Loading\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\n/**\n * Note: this was one of the few components we didn't use hooks for\n * mostly because I couldn't find an easy way to do getDerivedStateFromError()\n *\n * We might revise this later\n */\nclass ErrorBoundary extends React.Component {\n  constructor (props) {\n    console.log('ErrorBoundary constructor')\n    super(props)\n    this.state = { hasError: false }\n  }\n\n  static getDerivedStateFromError (error) {\n    // Update state so the next render will show the fallback UI.\n    console.log('ErrorBoundary getDerivedStateFromError')\n    console.error(error)\n    return { hasError: true, error }\n  }\n\n  componentDidCatch (error, info) {\n    console.log('ErrorBoundary componentDidCatch')\n    console.error(error)\n    // You can also log the error to an error reporting service\n    // logErrorToMyService(error, info)\n  }\n\n  render () {\n    const { hasError, error } = this.state\n    const { fallback: FallbackUI } = this.props\n    if (hasError) {\n      console.log('ErrorBoundary hasError')\n      // You can render any custom fallback UI\n      return <FallbackUI error={error} />\n    }\n\n    return this.props.children\n  }\n}\nErrorBoundary.propTypes = {\n  children: PropTypes.any,\n  fallback: PropTypes.any\n}\n\nexport default ErrorBoundary\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport Button from '@material-ui/core/Button'\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport DialogContentText from '@material-ui/core/DialogContentText'\nimport TextField from '@material-ui/core/TextField'\nimport DialogActions from '@material-ui/core/DialogActions'\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport BugReportIcon from '@material-ui/icons/BugReport'\nimport ErrorIcon from '@material-ui/icons/Error'\nimport { makeStyles } from '@material-ui/core/styles'\n\nexport const SEND_STATES = {\n  UNSENT: 'UNSENT',\n  SENDING: 'SENDING',\n  SENT: 'SENT',\n  ERROR: 'ERROR'\n}\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    height: '100%',\n    overflow: 'hidden',\n    padding: theme.spacing(1),\n    display: 'flex',\n    flexDirection: 'column',\n    textAlign: 'center',\n    color: theme.palette.text.primary,\n    border: `20px solid ${theme.palette.text.secondary}`\n  },\n  button: {\n    // background: theme.palette.success.main,\n    // color: theme.palette.success.contrastText\n  },\n  icon: {\n    opacity: 0.5,\n    margin: 'auto',\n    flex: '0 1 10%',\n    // height: '50%',\n    width: '50%'\n  },\n  text: {\n  },\n  spacer: {\n    flexGrow: 1\n  },\n  stack: {\n    padding: theme.spacing(2),\n    marginBottom: theme.spacing(2),\n    fontSize: '8px',\n    flexGrow: 1,\n    textAlign: 'left',\n    whiteSpace: 'pre-wrap',\n    overflow: 'scroll',\n    color: theme.palette.error.main,\n    fontFamily: 'Consolas, monaco, monospace'\n  }\n}))\n\nconst ErrorScreen = ({ error, sendState, reportError }) => {\n  const classes = useStyles()\n  const [dlgOpen, setDialogOpen] = useState(false)\n  const [note, setNote] = useState('')\n\n  let stackEl = <div className={classes.spacer} />\n  try {\n    if (process.env.NODE_ENV === 'development') {\n      stackEl = (\n        <Typography className={classes.stack}>\n          {error.stack}\n        </Typography>\n      )\n    }\n  }\n  catch (e) {}\n\n  let buttonText = 'Report this bug'\n  let disabled = false\n  let color = 'primary'\n  switch (sendState) {\n    case SEND_STATES.UNSENT:\n      buttonText = 'Report this bug'\n      break\n    case SEND_STATES.SENDING:\n      disabled = true\n      color = 'default'\n      buttonText = 'Sending...'\n      break\n    case SEND_STATES.SENT:\n      color = 'default'\n      disabled = true\n      buttonText = 'Thank you for your feedback'\n      break\n    case SEND_STATES.ERROR:\n      color = 'secondary'\n      disabled = true\n      buttonText = 'ERROR SENDING BUG REPORT'\n      break\n    default:\n      break\n  }\n\n  return (\n    <div className={classes.root}>\n      <CssBaseline />\n      <ErrorIcon className={classes.icon} color='error' />\n      <Typography variant='subtitle1' className={classes.text} color='inherit'>\n        Something went wrong\n      </Typography>\n      {error && error.message && <Typography variant='body1' className={classes.text} color='inherit'>\n        {error.message}\n      </Typography>}\n      <Button\n        className={classes.button}\n        variant='contained'\n        disabled={disabled}\n        color={color}\n        onClick={() => setDialogOpen(true)}\n      >\n        <BugReportIcon />\n        {buttonText}\n      </Button>\n      {stackEl}\n      <Dialog open={dlgOpen} fullWidth onClose={() => setDialogOpen(false)} aria-labelledby='form-dialog-title'>\n        <DialogTitle id='form-dialog-title'>Report a bug</DialogTitle>\n        <DialogContent>\n          <DialogContentText>\n            What were you trying to do when the error happened?\n          </DialogContentText>\n          <TextField\n            autoFocus\n            margin='dense'\n            multiline\n            onChange={(e) => setNote(e.target.value)}\n            rowsMax='6'\n            id='note'\n            placeholder='I tried to X and then Y happened...'\n            label='Note'\n            fullWidth\n          />\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={() => setDialogOpen(false)} color='primary'>\n            Cancel\n          </Button>\n          <Button onClick={() => {\n            reportError(note)\n            setDialogOpen(false)\n          }} color='primary'>\n            Send\n          </Button>\n        </DialogActions>\n      </Dialog>\n    </div>\n  )\n}\n\nErrorScreen.propTypes = {\n  error: PropTypes.object,\n  sendState: PropTypes.string,\n  reportError: PropTypes.func.isRequired\n}\n\nexport default ErrorScreen\n","import gql from 'graphql-tag'\nimport { photoFragment, seriesFragment } from './fragments'\n\nexport const deletePhoto = gql`\nmutation deletePhoto($seriesId: ID!, $photoId: ID!) {\n  deletePhoto(seriesId: $seriesId, photoId: $photoId)\n}\n`\n\nexport const deleteSeries = gql`\nmutation deleteSeries($id: ID!) {\n  deleteSeries(id: $id)\n\n}\n`\n\nexport const updateSeries = gql`\nmutation updateSeries($series: UpdateSeriesInput!) {\n  updateSeries(series: $series){\n    ...seriesFragment\n  }\n}\n`\nexport const updateSeriesKeys = [\n  'id',\n  'access',\n  'name',\n  'note',\n  'coords',\n  'direction'\n]\n\nexport const updatePhoto = gql`\nmutation updatePhoto($photo: UpdatePhotoInput!) {\n  updatePhoto(photo: $photo){\n    ...photoFragment\n  }\n}\n`\nexport const updatePhotoKeys = [\n  'id',\n  'seriesId',\n  'takenOn',\n  'tags',\n  'note'\n]\n\nexport const createPhoto = gql`\nmutation createPhoto($photo: NewPhotoInput!, $ext: String!) {\n  createPhoto(photo: $photo, ext: $ext) {\n    photo {\n      ...photoFragment\n    }\n    preAuth\n    __typename\n  }\n}\n${photoFragment}\n`\nexport const newPhotoKeys = [\n  'seriesId',\n  'takenOn',\n  'meta',\n  'rawData',\n  'coords',\n  'tags',\n  'note',\n  'uploadToken'\n]\n\nexport const createSeries = gql`\nmutation createSeries($series: NewSeriesInput, $photo: NewPhotoInput!, $ext: String!) {\n  createSeries(series: $series, photo: $photo, ext: $ext) {\n    series {\n      ...seriesFragment\n      photos {\n        ...photoFragment\n      }\n    }\n    preAuth\n    __typename\n  }\n}\n${seriesFragment}\n${photoFragment}\n`\nexport const newSeriesKeys = [\n  'access',\n  'name',\n  'note',\n  'coords',\n  'direction',\n  'meta'\n]\n\nexport const watchSeries = gql`\nmutation watch($seriesId: ID) {\n  watchSeries(seriesId: $seriesId)\n}\n`\n\nexport const unWatchSeries = gql`\nmutation unWatch($seriesId: ID) {\n  unWatchSeries(seriesId: $seriesId)\n}\n`\n\nexport const reportBug = gql`\nmutation reportBug($reportJSON: String!) {\n  reportBug(reportJSON: $reportJSON)\n}\n`\n","import React, { useState } from 'react'\n// import PropTypes from 'prop-types'\nimport { graphql } from 'react-apollo'\nimport { connect } from 'react-redux'\nimport ErrorScreen, { SEND_STATES } from '../components/misc/ErrorScreen'\nimport { reportBug } from '../graphql/mutations'\n\nconst ErrorConnect = (props) => {\n  const [state, setState] = useState(SEND_STATES.UNSENT)\n  const Wrapped = withReportBugMutation(ErrorScreen)\n  return <Wrapped {...props} setState={setState} sendState={state} />\n}\n\nconst withReportBugMutation = graphql(reportBug, {\n  props: ({ mutate, ownProps: { reduxState, error, setState } }) => {\n    console.log('withReportBugMutation props', { mutate, reduxState, error })\n    if (mutate.error) setState(SEND_STATES.ERROR)\n    return {\n      reportError: (note) => {\n        setState(SEND_STATES.SENDING)\n        let reportJSON = ''\n        const errObj = { note, reduxState, error, env: process.env }\n        console.log('withReportBugMutation StartingError', errObj)\n        try {\n          reportJSON = JSON.stringify(errObj)\n        }\n        catch (e) {\n          reportJSON = error.toString()\n        }\n        console.log('withReportBugMutation got through it', reportJSON)\n        return mutate({\n          variables: { reportJSON },\n          update: (store, { data }) => {\n            console.log('withReportBugMutation update', data)\n            setState(SEND_STATES.SENT)\n          }\n        })\n      }\n    }\n  }\n})\n\n/**\n * Map our redux state and functions\n */\nconst mapStateToProps = (state, props) => {\n  const { map, home, uploader, ...other } = state\n  const newMap = map.slice(-5) // only the last 5 map states come through\n\n  return {\n    reduxState: {\n      ...other,\n      map: newMap,\n      home\n    }\n  }\n}\n\nexport default connect(\n  mapStateToProps\n)(ErrorConnect)\n","import Satellite from './Satellite.json'\n// import BasicMap from './BasicMap.json'\nimport TopoMap from './TopoMap.json'\n\nimport {\n  Satellite as SatIcon,\n  SatelliteOutlined,\n  // DirectionsCar,\n  // DirectionsCarOutlined,\n  Terrain,\n  TerrainOutlined\n} from '@material-ui/icons'\n\nexport default [\n  {\n    toolTip: 'Sat',\n    Icon: SatelliteOutlined,\n    ActiveIcon: SatIcon,\n    color: 'green',\n    style: Satellite\n  },\n  {\n    toolTip: 'Topo',\n    Icon: TerrainOutlined,\n    ActiveIcon: Terrain,\n    color: 'blue',\n    style: TopoMap\n  }\n]\n","import MapStyles from './mapStyles'\nimport {\n  green, blue, red\n} from '@material-ui/core/colors'\n\nexport const tagColors = [\n  '#418CF0', '#FCB441', '#E0400A', '#056492', '#BFBFBF', '#1A3B69', '#FFE382', '#129CDD', '#CA6B4B',\n  '#005CDB', '#F3D288', '#506381', '#F1B9A8', '#E0830A', '#7893BE'\n]\n\nexport const mapConfig = {\n  mapBoxToken: process.env.REACT_APP_MAPBOX_TOKEN,\n  styles: MapStyles\n}\n\nlet baseurl = process.env.REACT_APP_BASEURL\nlet basename = process.env.REACT_APP_BASENAME\nlet domain = process.env.REACT_APP_DOMAIN\nif (process.env.NODE_ENV && process.env.NODE_ENV === 'development') {\n  domain = 'localhost'\n  basename = ''\n}\nconsole.log('config: ', baseurl, basename)\n\nexport const home = {\n  Offline: {\n    seriesImgsToCache: ['thumb', 'large'],\n    highestOfflineTileZoom: 12,\n    maxMapTileArea: 25000 // km^2 allowed to download map tiles\n  },\n  AppStateTypes: {\n    FEED: 'feed', // Looking at the Home Feed\n    MAP: 'map', // Looking at the map\n    SEARCH: 'search', // looking at the search\n    PROFILE: 'profile', // Looking at user information\n    SERIES: 'series', // Looking at one particular series\n    QRCAPTURE: 'QRCapture', // Capture a QRCode\n    NEW_SERIES_CAMERA: 'new_series_camera', // Looking at one particular sereis\n    NEW_SERIES_LIBRARY: 'new_series_library', // Looking at one particular sereis\n    OFFLINE_DOWNLOAD: 'offline_download' // Looking at one particular sereis\n  },\n  SEARCH_TABS: {\n    TAG: 'tag',\n    LOCATION: 'location',\n    USER: 'user'\n  },\n  MapModeTypes: {\n    FREE: 'free', //\n    USER: 'user', // filtered to a given user\n    TAG: 'tag' // filtered to a given tag\n  }\n}\n\nexport const federated = {\n  // oauth_config: {\n\n  // },\n  // google_client_id: process.env.REACT_APP_GOOGLE_APP_ID\n}\n\nexport const endpoints = {\n  graphql: process.env.REACT_APP_GRAPHQL\n}\n\nexport const aws = {\n  Auth: {\n    // REQUIRED - Amazon Cognito Identity Pool ID\n    // identityPoolId: process.env.REACT_APP_COGNITO_IDPOOLID, // XX-XXXX-X:XXXXXXXX-XXXX-1234-abcd-1234567890ab\n    // REQUIRED - Amazon Cognito Region\n    region: process.env.REACT_APP_AWS_REGION,\n    // OPTIONAL - Amazon Cognito User Pool ID\n    userPoolId: process.env.REACT_APP_COGNITO_USER_POOL_ID,\n    // OPTIONAL - Amazon Cognito Web Client ID (26-char alphanumeric string)\n    userPoolWebClientId: process.env.REACT_APP_COGNITO_CLIENT_ID,\n    // OPTIONAL - Enforce user authentication prior to accessing AWS resources or not\n    mandatorySignIn: true,\n    // OPTIONAL - Configuration for cookie storage\n    cookieStorage: {\n      // REQUIRED - Cookie domain (only required if cookieStorage is provided)\n      domain: `${domain}`,\n      // OPTIONAL - Cookie path\n      // path: `/${basename}`,\n      // OPTIONAL - Cookie expiration in days\n      expires: 20,\n      // OPTIONAL - Cookie secure flag\n      secure: false\n    }\n\n  }\n\n}\n\nexport const ACCESS = {\n  OPEN: {\n    label: 'Open',\n    description: 'Anyone can see and contribute photos to this series.',\n    color: green\n  },\n  PRIVATE: {\n    label: 'Private',\n    description: 'Can only be seen by you.',\n    color: red\n  },\n  PUBLIC: {\n    label: 'Public',\n    description: 'Anyone can see this series. Only the owner can add photos.',\n    color: blue\n  }\n}\n","import { getWholeSeries, allSeries, userSeries, getMyFeed, getUser } from '../queries'\nimport { seriesKeys, seriesSummaryKeys, photoSummaryKeys } from '../fragments'\nimport _ from 'lodash'\n\n/**********************************************************\n *\n * NOTE:\n *\n * The methods in this file are for modifying the Apollo cache\n * store. This ensures interoperability between queries and\n * helps us rewind and replay mutations after an app reload\n *\n *\n **********************************************************/\n\n/**\n * Update a series in the cached getWholeSeries queries\n *\n * @param {*} store\n * @param {*} photo\n * @param {*} remove\n */\nexport const getWholeSeriesUpdate = (store, series) => {\n  const variables = { id: series.id }\n  const query = getWholeSeries\n  let newData = {\n    series: {}\n  }\n  try {\n    const qVal = store.readQuery({ query, variables })\n    newData = _.cloneDeep(qVal)\n  }\n  catch (e) {\n    console.error('ERROR: getWholeSeriesUpdate readQuery failed')\n  }\n  try {\n    newData.series = { ...newData.series, ...series }\n    store.writeQuery({ query, variables, data: newData })\n  }\n  catch (e) {\n    console.error('ERROR: getWholeSeriesUpdate writeQuery failed')\n  }\n}\n\n/**\n * Add or remove a photo a full getWholeSeries cached query\n *\n * @param {*} store\n * @param {*} photo\n * @param {*} remove\n */\nexport const getWholeSeriesPhotoUpdate = (store, photo, remove = false) => {\n  const variables = { id: photo.seriesId }\n  const query = getWholeSeries\n  try {\n    // This may or may not exist yet\n    const qVal = store.readQuery({ query, variables })\n    const newData = _.cloneDeep(qVal)\n    if (remove) {\n      newData.series.photos = newData.series.photos.filter(ph => ph.id === photo.id)\n    }\n    else {\n      const idx = newData.series.photos.findIndex(ph => ph.id === photo.id)\n      if (idx > -1) {\n        newData.series.photos = [...newData.series.photos]\n        newData.series.photos[idx] = photo\n      }\n      else {\n        newData.series.photos = [...newData.series.photos, photo]\n      }\n    }\n    store.writeQuery({ query, variables, data: newData })\n  }\n  catch (e) {\n    console.error('ERROR: allSeriesUpdate readQuery failed  ')\n  }\n}\n\n/**\n * HELPER Function. Help us add and remove one item from\n * any of the allSeries arrays in the cache\n *\n * @param {*} origArr\n * @param {*} series\n * @param {*} remove\n */\nfunction updateSeriesSummaries (origArr, series, remove = false) {\n  let newArr = []\n  if (remove) {\n    newArr = origArr.filter(s => s.id !== series.id)\n  }\n  else {\n    const newAllSeriesEntry = _.pick(series, seriesKeys)\n    newArr = [...origArr, {\n      ...newAllSeriesEntry, seriesStatus: null, __typename: 'SeriesSummary'\n    }]\n  }\n  return newArr\n}\n\n/**\n * HELPER Function. Help us add and remove one feedItem from the cached array\n *\n * @param {*} origArr\n * @param {*} series\n * @param {*} photo\n * @param {*} remove\n */\nfunction updateFeedList (origArr, series, photo, remove = false) {\n  let newArr = []\n  if (remove) {\n    // remove the item\n    newArr = origArr.filter(fItem => {\n      if (series && fItem.series.id === series.id) return false\n      else if (photo && fItem.photo.id === photo.id) return false\n      else return true\n    })\n  }\n  else {\n    // Maybe this is just an update\n    const idx = origArr.findIndex(fitem => fitem.series.id === photo.seriesId)\n\n    let newSeriesSummary = series ? _.pick(series, seriesSummaryKeys) : null\n    const newPhotoSummary = _.pick(photo, photoSummaryKeys)\n\n    // Update the item\n    if (idx > -1) {\n      newArr = [...origArr]\n      newArr[idx].photo = newPhotoSummary\n    }\n    // Insert a new item\n    else {\n      newArr = [...origArr, {\n        _id: newPhotoSummary.id,\n        series: { ...newSeriesSummary, __typename: 'SeriesSummary' },\n        photo: { ...newPhotoSummary, __typename: 'PhotoSummary' },\n        relation: 'OWNED',\n        __typename: 'SeriesSummary'\n      }]\n    }\n  }\n  return newArr\n}\n\n/**\n * Update a changed Series in the allSeries cache\n *\n * @param {*} store\n * @param {*} series\n * @param {*} remove\n */\nexport const allSeriesUpdate = (store, series, remove = false) => {\n  const variables = { limit: 100 }\n  const query = allSeries\n  let newData = {\n    allSeries: { seriesSummaries: [] },\n    nextToken: null,\n    __typename: 'PaginatedSeries'\n  }\n  try {\n    // This may or may not exist yet\n    const qVal = store.readQuery({ query, variables })\n    newData = _.cloneDeep(qVal)\n  }\n  catch (e) {\n    console.error('ERROR: allSeriesUpdate readQuery failed')\n  }\n\n  try {\n    newData.allSeries.seriesSummaries = updateSeriesSummaries(newData.allSeries.seriesSummaries, series, remove)\n    store.writeQuery({ query, variables, data: newData })\n  }\n  catch (e) {\n    console.error('ERROR: allSeriesUpdate writeQuery failed')\n  }\n}\n\n/**\n * Add or remove a photot to the allSeries cached query\n *\n * @param {*} store\n * @param {*} series\n * @param {*} photo\n * @param {*} remove\n */\nexport const allSeriesPhotoUpdate = (store, series, photo, remove = false) => {\n  const query = allSeries\n  try {\n    const qVal = store.readQuery({ query, variables: { limit: 100 } })\n    const newData = _.cloneDeep(qVal)\n\n    newData.allSeries.seriesSummaries = newData.allSeries.seriesSummaries.map(s => {\n      if (s.id !== photo.seriesId) return s\n      else {\n        const newS = _.cloneDeep(s)\n        if (remove && series) {\n          // set a new latest photo\n          if (newS.latest.id === photo.id) {\n            newS.latest = series.photos[series.photos.length - 1]\n          }\n          // set a new featured photo\n          if (newS.featured.id === photo.id) {\n            newS.featured = series.photos[series.photos.length - 1]\n          }\n        }\n        else {\n          // set a new latest photo\n          const photoSummary = _.pick(photo, photoSummaryKeys)\n          photoSummary.__typename = 'PhotoSummary'\n          newS.latest = photoSummary\n        }\n        return newS\n      }\n    })\n    store.writeQuery({ query, data: newData })\n  }\n  catch (e) {\n    console.error('createPhotoMutation:: allSeries ERROR')\n  }\n}\n\n/**\n * Add or remove a series to the user's listing\n *\n * @param {*} store\n * @param {*} series\n * @param {*} remove\n */\nexport const userSeriesUpdate = (store, series, remove = false) => {\n  const query = userSeries\n\n  let newData = {\n    userSeries: { seriesSummaries: [] },\n    nextToken: null,\n    __typename: 'PaginatedSeries'\n  }\n  try {\n    // This may or may not exist yet\n    const qVal = store.readQuery({ query })\n    newData = _.cloneDeep(qVal)\n  }\n  catch (e) {\n    console.error('ERROR: userSeriesUpdate readQuery failed')\n  }\n\n  try {\n    newData.userSeries.seriesSummaries = updateSeriesSummaries(newData.userSeries.seriesSummaries, series, remove)\n    store.writeQuery({ query, data: newData })\n  }\n  catch (e) {\n    console.error('ERROR: userSeriesUpdate writeQuery failed')\n  }\n}\n\n/**\n * Add or remove an item to the cached feed\n * This is really limited because we can't add anything we don't already have in the series cache\n *\n * @param {*} store\n * @param {*} series\n * @param {*} photo\n * @param {*} remove\n */\nexport const feedUpdate = (store, series, photo, remove = false) => {\n  const query = getMyFeed\n\n  let newData = {\n    myFeed: { feed: [] },\n    window: null,\n    __typename: 'PaginatedSeries'\n  }\n  try {\n    // This may or may not exist yet\n    const qVal = store.readQuery({ query })\n    newData = _.cloneDeep(qVal)\n  }\n  catch (e) {\n    console.error('ERROR: feedUpdate readQuery failed')\n  }\n\n  try {\n    newData.myFeed.feed = updateFeedList(newData.userSeries.seriesSummaries, series, photo, remove)\n    store.writeQuery({ query, data: newData })\n  }\n  catch (e) {\n    console.error('ERROR: feedUpdate writeQuery failed')\n  }\n}\n\n/**\n * Watch or unwatch the series in the cached getUser query\n * @param {*} store\n * @param {*} seriesId\n * @param {*} remove\n */\nexport const watchUpdate = (store, seriesId, remove = false) => {\n  const query = getUser\n  try {\n    const qVal = store.readQuery({ query })\n    const newData = _.cloneDeep(qVal)\n\n    if (remove) {\n      newData.user.watching = newData.user.watching.filter(sid => sid !== seriesId)\n    }\n    else {\n      newData.user.watching = [...new Set([...newData.user.watching || [], seriesId])]\n    }\n\n    store.writeQuery({ query, data: newData })\n  }\n  catch (e) {\n    console.error('ERROR: getUser readQuery failed')\n  }\n}\n","// import React, { useContext } from 'react'\n// import PropTypes from 'prop-types'\nimport { graphql } from 'react-apollo'\nimport { getWholeSeriesUpdate, allSeriesUpdate, feedUpdate } from './updateQueries'\nimport { createSeries, newSeriesKeys, newPhotoKeys } from '../mutations'\nimport { pushMutationPromise, popMutationPromise } from '../offline'\n\nimport _ from 'lodash'\n\nexport const withMutation = graphql(createSeries, {\n  props: ({ mutate, ownProps }) => {\n    return {\n      createSeriesMutation: (newSeries, newPhoto, ext) => {\n        const { id, gravatar, gravatarProfile, username } = ownProps.user\n        const meUserSummary = { id, gravatar, gravatarProfile, username, __typename: 'UserSummary' }\n        if (!newSeries.access) newSeries.access = 'PRIVATE'\n\n        const variables = {\n          series: _.pick(newSeries, newSeriesKeys),\n          photo: _.pick(newPhoto, newPhotoKeys),\n          ext\n        }\n        const optimisticResponse = createOptimisticResponse({ meUserSummary, newSeries, newPhoto, ext })\n        const mutationStackId = pushMutationPromise({ variables, optimisticResponse }, createSeries)\n        console.log('createSeriesMutation:: start', { newSeries, newPhoto, variables, optimisticResponse, ext })\n        return mutate({\n          variables,\n          // refetchQueries: [{ query: getWholeSeries, variables: { id: newSeries.id } }],\n          optimisticResponse,\n          update: updateThunk({}, ownProps.doneCreatingSeries)\n        }).then(data => {\n          // Here's where we take it out of the queue\n          console.log('createSeriesMutation:: done', data)\n          popMutationPromise(mutationStackId)\n          return data\n        })\n      }\n    }\n  }\n})\n\nconst updateThunk = (context, cb) => (store, { data }) => {\n  // We need to write this query from scratch\n  getWholeSeriesUpdate(store, data.createSeries.series)\n  allSeriesUpdate(store, data.createSeries.series)\n  feedUpdate(store, data.createSeries.series, data.createdSeries.series.photos[0])\n\n  if (cb) cb(data.createSeries.series.id)\n}\n\nconst createOptimisticResponse = ({ meUserSummary, newSeries, newPhoto, ext }) => ({\n  createSeries: {\n    series: {\n      id: newSeries.id,\n      name: newSeries.name,\n      note: newSeries.note || null,\n      access: newSeries.access,\n      meta: newSeries.meta || null,\n      featured: null,\n      latest: null,\n      coords: newSeries.coords || null,\n      direction: newSeries.direction || null,\n      photoCount: 1,\n      createdUser: meUserSummary,\n      updatedUser: meUserSummary,\n      createdBy: meUserSummary.id,\n      updatedBy: meUserSummary.id,\n      createdOn: Date.now().toString(),\n      updatedOn: Date.now().toString(),\n      watchers: 0,\n      photos: [{\n        id: newPhoto.id,\n        meta: newPhoto.meta || null,\n        seriesId: newSeries.id,\n        createdOn: Date.now().toString(),\n        createdUser: meUserSummary,\n        updatedUser: meUserSummary,\n        createdBy: meUserSummary.id,\n        updatedBy: meUserSummary.id,\n        uploadToken: newPhoto.uploadToken,\n        updatedOn: Date.now().toString(),\n        seriesCreatedBy: meUserSummary.id, // we can't answer this yet\n        takenOn: newPhoto.takenOn,\n        coords: newPhoto.coords || null,\n        tags: newPhoto.tags || [],\n        paths: {\n          base: null,\n          large: null,\n          orig: null,\n          thumb: null,\n          medium: null,\n          __typename: 'Paths'\n        },\n        __typename: 'Photo'\n      }],\n      __typename: 'Series'\n    },\n    preAuth: null,\n    __typename: 'NewSeries'\n  }\n})\n\nexport default {\n  withMutation,\n  updateThunk\n}\n","import localforage from 'localforage'\nimport createSeries from './mutations/createSeries'\nimport uuidv4 from 'uuid/v4'\n\nlocalforage.config({\n  storeName: 'MorPhoto', // Should be alphanumeric, with underscores.\n  description: 'image blobs'\n})\n\nexport const imgStore = localforage.createInstance({\n  name: 'imgStore'\n})\nexport const stateStore = localforage.createInstance({\n  name: 'stateStore'\n})\n\nconst OFFLINEMUTATIONS = 'offlineMutations'\n\n// Pull serialized mutations from localst orage\nfunction getPendingPromise () {\n  return stateStore.getItem(OFFLINEMUTATIONS)\n    .then(mutations => {\n      console.log('offline::getPendingPromise', mutations)\n      return JSON.parse(mutations) || []\n    })\n}\n\n// Store serialized mutations in stateStore\nfunction setPendingPromise (mutations) {\n  console.log('offline::setPendingPromise', mutations)\n  return stateStore.setItem(OFFLINEMUTATIONS, JSON.stringify(mutations))\n}\n\n/**\n * Push a mutation onto the stack\n * @param {*} params {variables, optimisticResponse etc}\n * @param {*} mutation\n * @param {*} context\n */\nexport function pushMutationPromise (params, mutation, context) {\n  const id = uuidv4()\n  return getPendingPromise()\n    .then(mutations => mutations.concat({ id, params, mutation, context }))\n    .then(data => {\n      console.log('offline::pushMutationPromise', data)\n      return data\n    })\n    .then(setPendingPromise)\n    .then(() => id)\n}\n\nexport function popMutationPromise (id) {\n  return getPendingPromise()\n    .then(mutations => mutations.filter(pm => pm.id !== id))\n    .then(data => {\n      console.log('offline::popMutationPromise', data)\n      return data\n    })\n    .then(setPendingPromise)\n}\n\n// Delegate incoming responses to the correct update function\nfunction updateHandler (resp, context) {\n  // IMPORTANT: You need one of these for every custom update function you use!\n  // There's no post-update step at this level so the thunk params are empty\n  console.log('offline::updateHandler', { resp, context })\n  if (resp.data.createSeries) return createSeries.updateThunk(context)\n  else return () => {}\n}\n\n// Return a dummy update function scoped to a request with a specific id\nfunction proxyUpdateForId (id, context) {\n  return (proxy, resp) => {\n    updateHandler(resp, context)(proxy, resp)\n    // If this is the real deal and we're online then clean it up\n    if (!resp.data.__optimistic) return popMutationPromise(id)\n    else return Promise.resolve()\n  }\n}\n\n// Restore pending requests\n// This should be called after a page refresh\nexport function restoreRequests (client) {\n  return getPendingPromise()\n    .then(mutations => mutations.forEach(pendingMutation => {\n      console.log('offline::restoreRequests', mutations, pendingMutation)\n      const { id, params, mutation, context } = pendingMutation\n      params.optimisticResponse.__optimistic = true\n      params.update = proxyUpdateForId(id, context)\n      params.mutation = mutation\n      client.mutate(params)\n    }))\n}\n","import { useState, useEffect } from 'react'\nimport { createHttpLink } from 'apollo-link-http'\nimport { setContext } from 'apollo-link-context'\nimport { RetryLink } from 'apollo-link-retry'\nimport Amplify, { Auth } from 'aws-amplify'\n// import PropTypes from 'prop-types'\nimport { endpoints, aws } from '../config'\nimport { ApolloLink } from 'apollo-link'\nimport { stateStore, restoreRequests } from './offline'\nimport { InMemoryCache, ApolloClient } from 'apollo-boost'\nimport { persistCache } from 'apollo-cache-persist'\n\nAmplify.configure(aws)\n\nconst LOCAL_STORAGE_TOKEN = 'apollo-token'\n\nexport const APOLLOSTATES = {\n  INITIALIZING: 'Initializing',\n  AUTHENTICATING: 'Authenticating',\n  LOADING: 'Loading State',\n  APPLY_MUTATIONS: 'Applying history',\n  ERROR: 'ERROR!',\n  DONE: 'DONE'\n}\n\nfunction useGraphQL () {\n  const [client, setClient] = useState(null)\n  const [done, setDone] = useState(false)\n  const [currState, setCurrState] = useState(APOLLOSTATES.INITIALIZING)\n\n  useEffect(() => {\n    createApolloClient((newClient, newState) => {\n      console.log('createApolloClient::', newState, newClient)\n      setClient(newClient)\n      setDone((client || newClient) && newState === APOLLOSTATES.DONE)\n      setCurrState(newState)\n    })\n  }, [])\n\n  return { client, done, currState }\n}\n\nexport default useGraphQL\n\n/**\n * Helper function to create our Apollo Client object\n * @param {*} tokenFunc\n */\nconst getCurrentToken = async () => {\n  try {\n    const currSession = await Auth.currentSession()\n    return currSession.accessToken.jwtToken\n  }\n  catch (e) {\n    return null\n  }\n}\n\nasync function createApolloClient (onChange) {\n  // Set up our headers for authentication through graphql\n  const cache = new InMemoryCache({\n    // dataIdFromObject: ({ __typename, id }) => __typename && id ? `${__typename}::${id}`\n  })\n\n  try {\n    // See above for additional options, including other storage providers.\n    onChange(null, APOLLOSTATES.LOADING)\n    await persistCache({\n      cache,\n      storage: stateStore\n    })\n  }\n  catch (error) {\n    console.error('Error restoring Apollo cache', error)\n    onChange(null, APOLLOSTATES.ERROR)\n    return\n  }\n\n  // The auth link is just used to decorate our HTTP headers with authentication data\n  const authLink = setContext(async (_, { headers }) => {\n    const token = await getCurrentToken()\n\n    const newHeaders = {\n      ...headers,\n      authorization: token ? `Bearer ${token}` : ''\n    }\n    // on Dev machines, allow us to fake a user. This will ONLY work with a complimentary\n    // Dev graphql endpoint and singin is still required.\n\n    // This was done so we can test what the App looks like from varying perspectives\n    if (token && process.env.NODE_ENV === 'development' && process.env.REACT_APP_FAKE_USER) {\n      newHeaders.auth_user = process.env.REACT_APP_FAKE_USER\n    }\n    return { headers: newHeaders }\n  })\n\n  // HTTP link creates the network connection to our graphql host\n  const httpLink = createHttpLink({ uri: endpoints.graphql })\n  const retry = new RetryLink({ attempts: { max: Infinity } })\n  console.log('Creating Apollo Client Client', endpoints.graphql)\n\n  const apolloClient = new ApolloClient({\n    link: ApolloLink.from([retry, authLink, httpLink]),\n    tokenName: LOCAL_STORAGE_TOKEN,\n    addTypename: true,\n    cache,\n    connectToDevTools: process.env.NODE_ENV === 'development'\n  })\n  // Now pause while we restore any mutations\n  onChange(null, APOLLOSTATES.APPLY_MUTATIONS)\n  await restoreRequests(apolloClient)\n  // Now put it all together\n  onChange(apolloClient, APOLLOSTATES.DONE)\n}\n\n// Note: this method comes from isntructions here:\n// https://www.apollographql.com/docs/react/recipes/authentication.html\n// export const withApollo = compose(\n//   lifecycle({\n//     shouldComponentUpdate (nextProps) {\n//       const { authStore: { jwtToken: oldToken } } = nextProps\n//       const { authStore: { jwtToken: newToken } } = this.props\n//       if (newToken === oldToken) {\n//         return true\n//       }\n//       return true\n//     }\n//   }),\n//   withWrapClient\n// )\n","export default theme => ({\n  root: {\n  },\n  spacer: {\n    flexGrow: 1\n  },\n  forgotPassword: {\n    width: '100%',\n    textAlign: 'right'\n  },\n  switch: {\n\n  },\n  switchButton: {\n    flexGrow: 1,\n    '&:last-child': {\n      borderRadius: 0\n    },\n    '&:first-child': {\n      borderRadius: 0\n    }\n  },\n  phoneNumInner: {\n    marginTop: theme.spacing(1),\n    display: 'flex'\n    // border: '1px solid red'\n  },\n  phoneNumDropdown: {\n    margin: theme.spacing(1),\n    minWidth: 120\n  },\n  warnText: {\n    marginTop: theme.spacing(2),\n    fontStyle: 'italic'\n  },\n  noSignin: {\n    margin: theme.spacing(2, 0),\n    padding: theme.spacing(1),\n    textAlign: 'left',\n    border: `1px solid #00000022`,\n    background: `#0000000F`\n  }\n})\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport TextField from '@material-ui/core/TextField'\nimport Button from '@material-ui/core/Button'\nimport Toolbar from '@material-ui/core/Toolbar'\n// import MenuIcon from '@material-ui/core/Menu'\n// import { FederatedButtons } from 'aws-amplify-react'\nimport { makeStyles } from '@material-ui/core/styles'\nimport style from './auth.style'\nimport AuthContainer from './AuthContainer'\nimport { Typography } from '@material-ui/core'\n\nconst useStyles = makeStyles(style)\n\nconst SignIn = ({ loading,\n  handleSignup,\n  federated,\n  handleForgotPassword,\n  handleInputChange,\n  handleBeAnonymous,\n  handleSignIn, ...props }) => {\n  const classes = useStyles()\n  return (\n    <AuthContainer>\n      {/* {props.federated && (\n        <FederatedButtons {...props} />\n      )} */}\n      <TextField\n        id='username'\n        fullWidth\n        key='username'\n        name='username'\n        label='Username'\n        color='inherit'\n        autoFocus\n        className={classes.textField}\n        margin='normal'\n        onChange={handleInputChange}\n      />\n      <TextField\n        fullWidth\n        id='password'\n        label='Password'\n        color='inherit'\n        key='password'\n        name='password'\n        type='password'\n        className={classes.textField}\n        autoComplete='current-password'\n        margin='normal'\n        onChange={handleInputChange}\n      />\n      <Toolbar disableGutters>\n\n        <Button component='button' color='secondary' variant='contained' disabled={loading} onClick={handleSignup}>\n          New Account\n        </Button>\n        <div className={classes.spacer} />\n        <Button\n          className='enterAction'\n          component='button'\n          color='primary'\n          variant='contained'\n          disabled={loading}\n          onClick={handleSignIn}\n        >\n          Sign In\n        </Button>\n      </Toolbar>\n      <Button color='primary' onClick={handleForgotPassword} size='small'>\n      Forgot Password\n      </Button>\n      <div className={classes.noSignin}>\n        <Button fullWidth size='small' variant={'outlined'} onClick={handleBeAnonymous} color='inherit'>\n          Continue without logging in\n        </Button>\n        <Typography variant='caption' className={classes.warnText} color='textSecondary' component='div'>\n          You will not be able to add content and many features will be unavailable.\n        </Typography>\n      </div>\n    </AuthContainer>\n  )\n}\n\nSignIn.propTypes = {\n  loading: PropTypes.bool,\n  federated: PropTypes.object,\n  handleSignup: PropTypes.func.isRequired,\n  handleForgotPassword: PropTypes.func.isRequired,\n  handleInputChange: PropTypes.func.isRequired,\n  handleBeAnonymous: PropTypes.func.isRequired,\n  handleSignIn: PropTypes.func.isRequired\n}\n\nexport default SignIn\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport TextField from '@material-ui/core/TextField'\nimport Button from '@material-ui/core/Button'\nimport Toolbar from '@material-ui/core/Toolbar'\n// import MenuIcon from '@material-ui/core/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nimport style from './auth.style'\nimport AuthContainer from './AuthContainer'\n\nconst useStyles = makeStyles(style)\n\nconst ConfirmSignIn = ({ handleInputChange, handleBack, handleConfirm }) => {\n  const classes = useStyles()\n  return (\n    <AuthContainer>\n      <TextField\n        id='mfaCode'\n        fullWidth\n        autoFocus\n        label='MFA Code'\n        name='code'\n        className={classes.textField}\n        margin='normal'\n        onChange={handleInputChange}\n      />\n\n      <Toolbar disableGutters>\n        <Button color='secondary' variant='contained' onClick={handleBack}>\n          Back\n        </Button>\n        <div className={classes.spacer} />\n        <Button\n          className='enterAction'\n          color='primary'\n          variant='contained'\n          onClick={handleConfirm}\n        >\n          Confirm\n        </Button>\n      </Toolbar>\n    </AuthContainer>\n  )\n}\n\nConfirmSignIn.propTypes = {\n  handleInputChange: PropTypes.func.isRequired,\n  handleBack: PropTypes.func.isRequired,\n  handleConfirm: PropTypes.func.isRequired\n}\n\nexport default ConfirmSignIn\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport TextField from '@material-ui/core/TextField'\nimport Button from '@material-ui/core/Button'\nimport Typography from '@material-ui/core/Typography'\nimport Toolbar from '@material-ui/core/Toolbar'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport style from './auth.style'\nimport AuthContainer from './AuthContainer'\n\nconst useStyles = makeStyles(style)\n\nconst RequireNewPassword = ({ change, requiredAttributes, placeholders, handleInputChange }) => {\n  const classes = useStyles()\n  return (\n    <AuthContainer>\n      <Typography>A new password is required</Typography>\n      <TextField\n        id='newassword'\n        fullWidth\n        autoFocus\n        label='New Password'\n        className={classes.textField}\n        type='password'\n        autoComplete='new-password'\n        margin='normal'\n        onChange={handleInputChange}\n      />\n      {requiredAttributes\n        .map((attribute, idx) => (\n          <TextField\n            fullWidth\n            key={attribute}\n            name={attribute}\n            className={classes.textField}\n            placeholder={placeholders[idx]}\n            type='text'\n            margin='normal'\n            onChange={handleInputChange}\n          />\n        ))}\n\n      <Toolbar disableGutters>\n\n        <Button color='secondary' variant='contained'>\n          Back\n        </Button>\n        <div className={classes.spacer} />\n        <Button\n          color='primary'\n          variant='contained'\n          onClick={change}\n          className='enterAction'\n        >\n          Change\n        </Button>\n      </Toolbar>\n    </AuthContainer>\n  )\n}\n\nRequireNewPassword.propTypes = {\n  change: PropTypes.func.isRequired,\n  handleInputChange: PropTypes.func.isRequired,\n  requiredAttributes: PropTypes.array,\n  placeholders: PropTypes.array\n}\n\nexport default RequireNewPassword\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\nimport TextField from '@material-ui/core/TextField'\nimport Button from '@material-ui/core/Button'\nimport Toolbar from '@material-ui/core/Toolbar'\nimport FormControl from '@material-ui/core/FormControl'\nimport InputLabel from '@material-ui/core/InputLabel'\nimport Select from '@material-ui/core/Select'\nimport AuthContainer from './AuthContainer'\n\n// import MenuIcon from '@material-ui/core/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nimport style from './auth.style'\n// import AuthPhoneNum from './AuthPhoneNum'\nconst useStyles = makeStyles(style)\n\nconst SignUp = ({ handleInputChange, signUpFields, signUpFieldLabels, signUpFieldPlaceholders,\n  handleSignup, handleBack, countryDialCodes, defaultDialCode }) => {\n  console.log('SIGNUPPROPS', { defaultDialCode, countryDialCodes, signUpFields, signUpFieldLabels, signUpFieldPlaceholders })\n  const [selectVal, setSelectVal] = useState(defaultDialCode)\n  const classes = useStyles()\n  const handleDialCodeChange = e => {\n    handleInputChange(e)\n    setSelectVal(e.target.value)\n  }\n  return (\n    <AuthContainer>\n      {\n        signUpFields.map((field, idx) => {\n          return field.key !== 'phone_number' ? (\n            <TextField\n              fullWidth\n              autoFocus={signUpFields.findIndex(f => f.key === field.key) === 0}\n              type={field.type}\n              name={field.key}\n              key={field.key}\n              placeholder={signUpFieldPlaceholders[idx]}\n              label={signUpFieldLabels[idx]}\n              className={classes.textField}\n              margin='normal'\n              onChange={handleInputChange}\n            />\n          ) : (\n            <FormControl\n              className={classes.phoneNumDropdown}\n              fullWidth\n              key='phonenum'\n            >\n              <InputLabel htmlFor='dial_code' shrink>\n                {signUpFieldLabels[idx]}\n                {field.required ? '*' : ''}\n              </InputLabel>\n              <div className={classes.phoneNumInner}>\n                <Select\n                  value={selectVal}\n                  onChange={handleDialCodeChange}\n                  inputProps={{\n                    name: 'dial_code',\n                    id: 'dial_code'\n                  }}\n                >\n                  {countryDialCodes.map(dialCode =>\n                    <option key={dialCode} value={dialCode}>\n                      {dialCode}\n                    </option>\n                  )}\n                </Select>\n                <TextField\n                  placeholder={signUpFieldPlaceholders[idx]}\n                  type='tel'\n                  fullWidth\n                  id='phone_line_number'\n                  key='phone_line_number'\n                  name='phone_line_number'\n                  onChange={handleInputChange}\n                />\n              </div>\n            </FormControl>\n          )\n        })\n      }\n      <Toolbar disableGutters>\n        <Button color='secondary' variant='outlined' onClick={handleBack}>\n          Back\n        </Button>\n        <div className={classes.spacer} />\n        <Button\n          className='enterAction'\n          component='button'\n          color='primary'\n          variant='contained'\n          onClick={handleSignup}\n        >\n          Create Account\n        </Button>\n      </Toolbar>\n    </AuthContainer>\n  )\n}\n\nSignUp.propTypes = {\n  handleInputChange: PropTypes.func.isRequired,\n  signUpFields: PropTypes.array.isRequired,\n  signUpFieldLabels: PropTypes.array.isRequired,\n  signUpFieldPlaceholders: PropTypes.array.isRequired,\n  countryDialCodes: PropTypes.array.isRequired,\n  defaultDialCode: PropTypes.string.isRequired,\n  handleSignup: PropTypes.func.isRequired,\n  handleBack: PropTypes.func.isRequired\n}\n\nexport default SignUp\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport TextField from '@material-ui/core/TextField'\nimport Button from '@material-ui/core/Button'\nimport Link from '@material-ui/core/Link'\nimport Toolbar from '@material-ui/core/Toolbar'\n// import MenuIcon from '@material-ui/core/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nimport style from './auth.style'\nimport AuthContainer from './AuthContainer'\n\nconst useStyles = makeStyles(style)\n\nconst ConfirmSignUp = ({ handleInputChange, handleBack, handleResend, handleConfirm }) => {\n  const classes = useStyles()\n  return (\n    <AuthContainer>\n      <TextField\n        id='username'\n        fullWidth\n        autoFocus\n        name='username'\n        label='Username'\n        className={classes.textField}\n        margin='normal'\n        onChange={handleInputChange}\n      />\n      <TextField\n        id='confirmationCode'\n        fullWidth\n        name='code'\n        label='Confirmation Code'\n        className={classes.textField}\n        margin='normal'\n        onChange={handleInputChange}\n\n      />\n      <Link component='button' variant='body2' className={classes.resendCode} onClick={handleResend}>\n          Resend Code\n      </Link>\n      <Toolbar disableGutters>\n\n        <Button color='secondary' variant='outlined' onClick={handleBack}>\n          Back\n        </Button>\n        <div className={classes.spacer} />\n        <Button\n          color='primary'\n          variant='contained'\n          className='enterAction'\n          onClick={handleConfirm}\n        >\n          Sign In\n        </Button>\n      </Toolbar>\n    </AuthContainer>\n  )\n}\n\nConfirmSignUp.propTypes = {\n  handleInputChange: PropTypes.func.isRequired,\n  handleBack: PropTypes.func.isRequired,\n  handleResend: PropTypes.func.isRequired,\n  handleConfirm: PropTypes.func.isRequired\n}\n\nexport default ConfirmSignUp\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\nimport Link from '@material-ui/core/Link'\nimport TextField from '@material-ui/core/TextField'\nimport Typography from '@material-ui/core/Typography'\nimport Button from '@material-ui/core/Button'\n\nimport Toolbar from '@material-ui/core/Toolbar'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport style from './auth.style'\nimport AuthContainer from './AuthContainer'\n\nconst useStyles = makeStyles(style)\n\nconst ForgotPassword = ({ handleSubmit, handleInputChange, handleSendCode, handleBack }) => {\n  const [sent, setSent] = useState(false)\n  const classes = useStyles()\n  return (\n    <AuthContainer>\n      <Typography>Forgot Password</Typography>\n      {!sent && (\n        <TextField\n          id='username'\n          autoFocus\n          fullWidth\n          label='Username'\n          name='username'\n          className={classes.textField}\n          margin='normal'\n          onChange={handleInputChange}\n        />\n      )}\n      {sent && (\n        <TextField\n          id='changecode'\n          fullWidth\n          autoFocus\n          label='Code'\n          name='code'\n          className={classes.textField}\n          margin='normal'\n          onChange={handleInputChange}\n        />\n      )}\n      {sent && (\n        <TextField\n          id='newpassword'\n          fullWidth\n          label='New Password'\n          className={classes.textField}\n          type='password'\n          name='password'\n          autoComplete='current-password'\n          margin='normal'\n          onChange={handleInputChange}\n        />\n      )}\n      {sent && (\n        <Link component='button' variant='body2' className={classes.resendCode} onClick={handleSendCode}>\n          Resend Code\n        </Link>\n\n      )}\n      <Toolbar disableGutters>\n        <Button\n          color='secondary'\n          variant='outlined'\n          onClick={() => {\n            sent ? setSent(false) : handleBack()\n          }}\n        >\n          Back\n        </Button>\n        <div className={classes.spacer} />\n        {!sent && (\n          <Button\n            color='primary'\n            variant='contained'\n            className='enterAction'\n            onClick={() => {\n              setSent(true)\n              handleSendCode()\n            }}\n          >\n          Send Code\n          </Button>\n        )}\n        {sent && (\n          <Button\n            className='enterAction'\n            color='primary'\n            variant='contained'\n            onClick={handleSubmit}\n          >\n          Submit\n          </Button>\n        )}\n      </Toolbar>\n    </AuthContainer>\n  )\n}\n\nForgotPassword.propTypes = {\n  handleSubmit: PropTypes.func.isRequired,\n  handleInputChange: PropTypes.func.isRequired,\n  handleSendCode: PropTypes.func.isRequired,\n  handleBack: PropTypes.func.isRequired\n}\n\nexport default ForgotPassword\n","import React, { useState } from 'react'\nimport Amplify, { Auth } from 'aws-amplify'\nimport { I18n } from '@aws-amplify/core' // ConsoleLogger as Logger\nimport countryDialCodes from 'aws-amplify-react/dist/Auth/common/country-dial-codes'\nimport {\n  Authenticator,\n  SignIn as SignInOrig,\n  SignUp as SignUpOrig,\n  ConfirmSignIn as ConfirmSignInOrig,\n  ConfirmSignUp as ConfirmSignUpOrig,\n  RequireNewPassword as RequireNewPasswordOrig,\n  Loading as LoadingOrig,\n  VerifyContact as VerifyContactOrig,\n  ForgotPassword as ForgotPasswordOrig\n} from 'aws-amplify-react'\n\nimport CompSignIn from '../components/auth/SignIn'\nimport CompConfirmSignIn from '../components/auth/ConfirmSignIn'\nimport CompRequireNewPassword from '../components/auth/RequireNewPassword'\nimport CompSignUp from '../components/auth/SignUp'\nimport CompLoading from '../components/auth/Loading'\nimport CompConfirmSignUp from '../components/auth/ConfirmSignUp'\n// import CompVerifyContact from '../components/auth/VerifyContact'\nimport CompForgotPassword from '../components/auth/ForgotPassword' // or 'aws-amplify-react-native';\nimport { aws } from '../config'\n\nAmplify.configure(aws)\n\nconst defaultAuthState = { authState: 'init', authData: {}, signedIn: null }\n\nconst useAuthentication = () => {\n  const [{ authState, authData, signedIn }, setAuth] = useState(defaultAuthState)\n\n  // Set up the trinary\n  // if (authState === 'signedIn') signedIn = true\n\n  const handleAuthStateChange = (state, data) => {\n    // console.log('handleAuthStateChange', { state, data })\n    setAuth({\n      authState: state,\n      authData: data,\n      // true = signedIn, false = beAnonymous, null = showLoginScreen\n      signedIn: !state || state.length === 0\n        ? null\n        : state === 'signedIn'\n          ? true\n          : signedIn\n    })\n  }\n\n  const getCurrentToken = async () => {\n    const currSession = await Auth.currentSession()\n    console.log('here', currSession.accessToken)\n    return currSession && currSession.accessToken ? currSession.accessToken : null\n  }\n\n  const signOut = () => Auth.signOut()\n    .then(data => console.log(data))\n    .catch(err => console.log(err))\n\n  const beAnonymous = () => {\n    setAuth({ authState, authData, signedIn: false })\n  }\n\n  const authScreen = signedIn ? null\n    : <Authenticator onStateChange={handleAuthStateChange} hideDefault>\n      <SignIn handleBeAnonymous={beAnonymous} />\n      <Loading message='Loggin in' />\n      <RequireNewPassword />\n      {/* <RequireNewPasswordOrig /> */}\n      <ConfirmSignIn />\n      <ConfirmSignUp />\n      {/* <VerifyContact /> NOT READY */}\n      <VerifyContactOrig />\n      <ForgotPassword />\n      <SignUp />\n      {/* <SignUpOrig /> */}\n    </Authenticator>\n\n  let isGod = false\n  try {\n    isGod = authData.signInUserSession.idToken.payload['cognito:groups'].indexOf('GodUsers') > -1\n  }\n  catch (e) {}\n\n  return {\n    authState,\n    authData,\n    isGod,\n    signOut,\n    getCurrentToken,\n    forceSignIn: () => setAuth(defaultAuthState),\n    signedIn,\n    authScreen\n  }\n}\n\nexport default useAuthentication\n\nclass SignIn extends SignInOrig {\n  showComponent () {\n    const { loading } = this.state\n    const newProps = {\n      ...this.props,\n      loading,\n      handleForgotPassword: () => this.changeState('forgotPassword'),\n      handleSignup: () => this.changeState('signUp'),\n      handleInputChange: this.handleInputChange,\n      handleSignIn: this.signIn\n    }\n    return <CompSignIn {...newProps} />\n  }\n}\n\nclass SignUp extends SignUpOrig {\n  showComponent () {\n    const { hide } = this.props\n    if (hide && hide.includes(SignUp)) {\n      return null\n    }\n    if (this.checkCustomSignUpFields()) {\n      this.signUpFields = this.props.signUpConfig.signUpFields\n    }\n    this.sortFields()\n\n    const newProps = {\n      ...this.props,\n      countryDialCodes,\n      defaultDialCode: this.getDefaultDialCode(),\n      handleInputChange: this.handleInputChange,\n      signUpFields: this.signUpFields,\n      signUpFieldLabels: this.signUpFields.map(field => I18n.get(field.label)),\n      signUpFieldPlaceholders: this.signUpFields.map(field => I18n.get(field.placeholder)),\n      handleSignup: this.signUp,\n      handleBack: () => this.changeState('signIn')\n    }\n    return <CompSignUp {...newProps} />\n  }\n}\n\nclass ConfirmSignIn extends ConfirmSignInOrig {\n  showComponent () {\n    const newProps = {\n      ...this.props,\n      handleBack: () => this.changeState('signIn'),\n      handleInputChange: this.handleInputChange,\n      handleConfirm: this.confirm\n    }\n    return <CompConfirmSignIn {...newProps} />\n  }\n}\n\nclass ConfirmSignUp extends ConfirmSignUpOrig {\n  showComponent () {\n    const newProps = {\n      ...this.props,\n      handleBack: () => this.changeState('signIn'),\n      handleInputChange: this.handleInputChange,\n      handleConfirm: this.confirm,\n      handleResend: this.resend\n    }\n    return <CompConfirmSignUp {...newProps} />\n  }\n}\n\nclass RequireNewPassword extends RequireNewPasswordOrig {\n  showComponent () {\n    const user = this.props.authData\n    const { requiredAttributes } = user.challengeParam\n    const placeholders = Array.isArray(requiredAttributes)\n      ? requiredAttributes.map(attribute => I18n.get(convertToPlaceholder(attribute)))\n      : []\n\n    const newProps = {\n      ...this.props,\n      handleInputChange: this.handleInputChange,\n      requiredAttributes,\n      placeholders,\n      change: this.change\n    }\n    return <CompRequireNewPassword {...newProps} />\n  }\n}\n\nclass Loading extends LoadingOrig {\n  showComponent () {\n    return <CompLoading {...this.props} />\n  }\n}\n// class VerifyContact extends VerifyContactOrig {\n//   showComponent () {\n//     const user = this.props.authData\n//     if (!user) {\n//       verifyLogger.debug('no user for verify')\n//       return null\n//     }\n//     const { unverified } = user\n//     if (!unverified) {\n//       verifyLogger.debug('no unverified on user')\n//       return null\n//     }\n//     const { email, phoneNumber } = unverified\n\n//     const { authData } = this.props\n//     const newProps = {\n//       ...this.props,\n//       handleInputChange: this.handleInputChange,\n//       handleSkip: () => this.changeState('signedIn', authData),\n//       handleVerify: this.verify,\n//       handleSubmit: this.submit\n//     }\n//     return <CompVerifyContact {...newProps} />\n//   }\n// }\nclass ForgotPassword extends ForgotPasswordOrig {\n  showComponent () {\n    const newProps = {\n      ...this.props,\n      handleBack: () => this.changeState('signIn'),\n      handleInputChange: this.handleInputChange,\n      handleConfirm: this.confirm,\n      handleResend: this.send,\n      handleSubmit: this.submit,\n      handleSendCode: this.send\n    }\n    return <CompForgotPassword {...newProps} />\n  }\n}\n\n// const verifyLogger = new Logger('VerifyContact')\n\nfunction convertToPlaceholder (str) {\n  return str.split('_').map(part => part.charAt(0).toUpperCase() + part.substr(1).toLowerCase()).join(' ')\n}\n\n// const eqSpacer = '==============================================================='\n","import { useState, useEffect, useRef } from 'react'\n\nexport const useGeolocation = () => {\n  const [state, setState] = useState({\n    accuracy: null,\n    altitude: null,\n    altitudeAccuracy: null,\n    heading: null,\n    latitude: null,\n    longitude: null,\n    speed: null,\n    timestamp: Date.now()\n  })\n  const mountedRef = useRef()\n  const watchIdRef = useRef()\n  mountedRef.current = true\n\n  const onEvent = event => {\n    if (mountedRef.current) {\n      setState({\n        accuracy: event.coords.accuracy,\n        altitude: event.coords.altitude,\n        altitudeAccuracy: event.coords.altitudeAccuracy,\n        heading: event.coords.heading,\n        latitude: event.coords.latitude,\n        longitude: event.coords.longitude,\n        speed: event.coords.speed,\n        timestamp: event.timestamp\n      })\n    }\n  }\n\n  useEffect(() => {\n    navigator.geolocation.getCurrentPosition(onEvent)\n    watchIdRef.current = navigator.geolocation.watchPosition(onEvent)\n\n    return () => {\n      mountedRef.current = false\n      navigator.geolocation.clearWatch(watchIdRef.current)\n    }\n  }, [navigator.geolocation])\n\n  return state\n}\n\nexport function useDeviceOrientation () {\n  const [deviceOrientation, setDeviceOrientation] = useState({ absolute: false, alpha: null, beta: null, gamma: null })\n\n  function handleDeviceOrientation (event) {\n    setDeviceOrientation({\n      absolute: event.absolute,\n      alpha: event.alpha,\n      beta: event.beta,\n      gamma: event.gamma\n    })\n  }\n\n  useEffect(() => {\n    window.addEventListener('deviceorientation', handleDeviceOrientation, true)\n\n    return () => {\n      window.removeEventListener('deviceorientation', handleDeviceOrientation)\n    }\n  }, [])\n\n  return deviceOrientation\n}\n\nexport function playClickAudio (clickSound) {\n  let audio = new Audio('data:audio/mp3;base64,' + clickSound.base64)\n  audio.play()\n}\n\n// Detects if device is on iOS\nexport const isIos = () => {\n  return /iphone|ipad|ipod/i.test(window.navigator.userAgent || navigator.vendor || window.opera || '')\n}\n\nexport const isPhone = () => {\n  const a = (window.navigator.userAgent || navigator.vendor || window.opera || '')\n  return /(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i\n    .test(a) ||\n  /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i\n    .test(a.substr(0, 4))\n}\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Snackbar from '@material-ui/core/Snackbar'\nimport Typography from '@material-ui/core/Typography'\nimport Paper from '@material-ui/core/Paper'\nimport AppLogo from '../../icons/AppLogo'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { Button } from '@material-ui/core'\nconst useStyles = makeStyles(theme => ({\n  root: {\n\n  },\n  content: {\n\n  },\n  messageWrapper: {\n    display: 'flex'\n  },\n  logo: {\n    height: 50,\n    width: 50\n  },\n  paper: {\n    background: theme.palette.text.primary,\n    color: theme.palette.primary.contrastText,\n    border: `2px solid ${theme.palette.primary.contrastText}`,\n    boxShadow: `0 0 0 0 ${theme.palette.primary.main}`,\n    animation: '$installPulse 2s infinite',\n    padding: theme.spacing(2, 3),\n    width: '100%'\n  },\n  '@keyframes installPulse': {\n    '0%': {\n      boxShadow: `0 0 0 0px ${theme.palette.primary.main}`\n    },\n    '50%': {\n      boxShadow: `0 0 0 0px ${theme.palette.primary.main}`\n    },\n    '100%': {\n      boxShadow: `0 0 0 20px transparent`\n    }\n  },\n  textWrapper: {\n    flexGrow: 1,\n    paddingLeft: theme.spacing(1)\n  },\n  buttons: {\n    display: 'flex'\n  },\n  spacer: {\n    flexGrow: 1\n  }\n}))\n\nconst InstallPrompt = ({ open, onClose, onInstall }) => {\n  const classes = useStyles()\n\n  return (\n    <Snackbar\n      anchorOrigin={{\n        vertical: 'bottom',\n        horizontal: 'center'\n      }}\n      open={open}\n      // autoHideDuration={6000}\n      onClose={onClose}\n    >\n      <Paper className={classes.paper} elevation={24}>\n        <div id='client-snackbar' className={classes.messageWrapper}>\n          <AppLogo className={classes.logo} />\n          <div className={classes.textWrapper}>\n            <Typography variant='body1' color='inherit'>Install MorPhoto</Typography>\n            <Typography variant='body2' color='inherit' paragraph>This app can be installed and used on your device natively and offline if you would like.</Typography>\n            <div className={classes.buttons}>\n              <Button color='secondary' variant='contained' onClick={onClose}>No thanks</Button>\n              <div className={classes.spacer} />\n              <Button color='primary' variant='contained' onClick={onInstall}>Install</Button>\n            </div>\n          </div>\n        </div>\n      </Paper>\n    </Snackbar>\n  )\n}\n\nInstallPrompt.propTypes = {\n  open: PropTypes.bool,\n  onClose: PropTypes.func.isRequired,\n  onInstall: PropTypes.func.isRequired\n}\n\nexport default InstallPrompt\n","import React, { useEffect, useState, useMemo } from 'react'\nimport { isIos } from './sensors'\nimport InstallPrompt from '../components/misc/InstallPrompt'\n/**\n * Everything below here is about the prompt for installing a PWA\n */\n\n// Detects if device is in standalone mode\nconst isInStandaloneMode = () => ('standalone' in window.navigator) && (window.navigator.standalone)\n\nconst useShowAddToHome = (showInstall, dismissInstall) => {\n  const [deferredPrompt, setPrompt] = useState(null)\n\n  const handleBeforePrompt = e => {\n    // Prevent Chrome 67 and earlier from automatically showing the prompt\n    e.preventDefault()\n    // Stash the event so it can be triggered later.\n    setPrompt(e)\n    // showAddToHomeScreen()\n  }\n\n  const installPrompt = useMemo(() => {\n    if (!showInstall || !deferredPrompt) return null\n    return <InstallPrompt open onClose={dismissInstall} onInstall={addToHomeScreen} />\n  }, [showInstall, deferredPrompt])\n\n  useEffect(() => {\n    // window.orientation [0,90,180, 270]\n    // screen\n    // Checks if should display install popup notification:\n    if (isIos() && !isInStandaloneMode()) {\n      console.log('I AM on IOS and I am NOT in standalone mode.')\n    // this.setState({ showInstallMessage: true })\n    }\n\n    window.addEventListener('beforeinstallprompt', handleBeforePrompt)\n    return () => {\n      window.removeEventListener('beforeinstallprompt', handleBeforePrompt)\n    }\n  }, [])\n\n  function addToHomeScreen () {\n    // Show the prompt\n    deferredPrompt.prompt()\n    // Wait for the user to respond to the prompt\n    deferredPrompt.userChoice\n      .then((choiceResult) => {\n        if (choiceResult.outcome === 'accepted') {\n          console.log('User accepted the A2HS prompt')\n          dismissInstall()\n        }\n        else {\n          console.log('User dismissed the A2HS prompt')\n          dismissInstall()\n        }\n        setPrompt(null)\n      })\n  }\n\n  // function showAddToHomeScreen () {\n  //   const a2hsBtn = document.querySelector('.ad2hs-prompt')\n  //   a2hsBtn.style.display = 'block'\n  //   a2hsBtn.addEventListener('click', addToHomeScreen)\n  // }\n\n  return {\n    installPrompt,\n    addToHomeScreen: installPrompt ? addToHomeScreen : null\n  }\n}\n\nexport default useShowAddToHome\n","import { useEffect, useState } from 'react'\n\nconst useOnline = () => {\n  const [state, setState] = useState(null)\n  console.log('DEBUG1', { state, window: window.navigator.onLine })\n\n  const onChange = (e) => {\n    if (window.navigator.onLine) {\n      console.log('ONLINE', e)\n      setState(null)\n    }\n    else {\n      console.log('OFFLINE', e)\n      const newDate = Date.now()\n      setState(newDate)\n    }\n  }\n\n  useEffect(() => {\n    console.log('DEBUG2', { state, window: window.navigator.onLine })\n    onChange()\n    window.addEventListener('online', onChange)\n    window.addEventListener('offline', onChange)\n\n    return () => {\n      window.removeEventListener('online', onChange)\n      window.removeEventListener('offline', onChange)\n    }\n  }, [])\n\n  return {\n    online: state === null,\n    offlineSince: state\n  }\n}\n\nexport default useOnline\n","import { useCallback, useState, useLayoutEffect } from 'react'\nimport { debounce } from './util'\nimport { isIos, isPhone } from './sensors'\n\nconst metaViewports = {\n  sm: 'width=device-width, initial-scale=0.5, maximum-scale=0.5, user-scalable=0, shrink-to-fit=no',\n  lg: 'width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no'\n}\n\nconst getState = (state) => {\n  const { orientation, innerWidth, innerHeight, screen: { width, height } } = window\n  const wOrient = [90, 270].indexOf(orientation) !== 0 ? 'portrait' : 'landscape'\n  const bIsIos = isIos()\n  const bIsPhone = isPhone()\n  const windowSize = { width: innerWidth, height: innerHeight }\n  const screenSize = { width, height }\n\n  // VirtualKeyboards are the worst because they don't tell you when they're open.\n  // as a result we put the lockheight attribute on inputs so that the window height doesn't change\n  if (state && window.document.activeElement.tagName.toLowerCase() === 'input') {\n    console.log('preserving height')\n    windowSize.height = state.windowSize.height\n  }\n  else {\n    // const minSize = Math.min(windowSize.width, windowSize.height)\n    // const viewport = window.document.querySelector('meta[name=viewport]')\n    // const contentDict = viewport.getAttribute('content').split(', ').reduce((acc, el) => {\n    //   const elsplit = el.split('=')\n    //   return { ...acc, [elsplit[0]]: elsplit[1] }\n    // }, {})\n    // if (minSize < 350 && contentDict['initial-scale'] === '1.0') {\n    //   console.log('ZOOM Making it Small')\n    //   viewport.setAttribute('content', metaViewports.sm)\n    // }\n    // else if (minSize >= 350 && contentDict['initial-scale'] === '0.5') {\n    //   console.log('ZOOM Making it Large')\n    //   viewport.setAttribute('content', metaViewports.lg)\n    // }\n  }\n\n  const returnState = {\n    isPhone: bIsPhone,\n    isIos: bIsIos,\n    orientation: wOrient,\n    windowSize,\n    screenSize\n    // This failed. the only way to handle this is to set it explicitly\n    // isVKeyBdOn: bIsPhone && windowSize.height < screenSize.height\n  }\n  return returnState\n}\n\nconst useResponsive = (mediaQueries) => {\n  const [state, setState] = useState(getState())\n\n  const handleResize = (e) => {\n    if (e) {\n      e.preventDefault()\n      e.stopPropagation()\n    }\n    const newState = getState(state)\n    console.log('handleResize', newState)\n    setState(newState)\n  }\n\n  // const handleFlip = (e) => {\n  //   e.preventDefault()\n  //   e.stopPropagation()\n  //   const newState = getState()\n  //   console.log('handleFlip', newState)\n  //   setState(newState)\n  // }\n\n  const handleResizeDebounced = useCallback(debounce(handleResize, 500), [])\n  // const handleFlipDebounced = useCallback(debounce(handleFlip, 500), [])\n\n  useLayoutEffect(() => {\n    handleResizeDebounced()\n    window.addEventListener('resize', handleResizeDebounced)\n    // window.addEventListener('orientationchange', handleFlipDebounced)\n\n    return () => {\n      window.removeEventListener('resize', handleResizeDebounced)\n      // window.removeEventListener('orientationchange', handleFlipDebounced)\n    }\n  },\n  [])\n\n  return state\n}\n\nexport default useResponsive\n","/**\n * We put our action types at the top to keep them straight\n *\n * This is just a handy enumeration we use everywhere to make sure we're\n * all talking about the same ations\n */\nexport const Actions = {\n\n  HOME_CHANGE_STATE: 'HOME_CHANGE_STATE',\n  HOME_CHANGE_ACTIVE_SERIES: 'HOME_CHANGE_ACTIVE_SERIES',\n  HOME_STATE_BACK: 'HOME_STATE_BACK',\n\n  MAP_HISTORY_POP: 'MAP_HISTORY_POP',\n  MAP_HISTORY_PUSH: 'MAP_HISTORY_PUSH',\n  MAP_HISTORY_CLEAR: 'MAP_HISTORY_CLEAR',\n\n  UPLOADER_START: 'UPLOADER_START',\n  UPLOADER_COMPLETE: 'UPLOADER_COMPLETE',\n  UPLOADER_UPDATE_PROGRESS: 'UPLOADER_UPDATE_PROGRESS',\n\n  OFFLINE_VIEWPORT_SAVE: 'OFFLINE_VIEWPORT_SAVE',\n  OFFLINE_SET_STATUS: 'OFFLINE_SET_STATUS',\n\n  SETFLAG: 'SETFLAG'\n}\n\n/**\n * Now here are the actual action functions we will be dispatching\n * The actions have arguments related to what they do but they action they\n * dispatch consists only of a type and data3\n */\nexport default {\n  setHomeState: (newDomain, params) => ({ type: Actions.HOME_CHANGE_STATE, data: { newDomain, params } }),\n  homeStateBack: () => ({ type: Actions.HOME_STATE_BACK }),\n  setActiveSeries: (seriesId, initialPhoto) => ({ type: Actions.HOME_CHANGE_ACTIVE_SERIES, data: { seriesId, initialPhoto } }),\n\n  setFlag: (flagName, flagVal) => ({ type: Actions.SETFLAG, data: { flagName, flagVal } }),\n\n  setOfflineViewport: (viewport) => ({ type: Actions.OFFLINE_VIEWPORT_SAVE, data: viewport }),\n  setOfflineCompleted: (bVal) => ({ type: Actions.OFFLINE_SET_STATUS, data: bVal }),\n\n  popMapHistory: () => ({ type: Actions.MAP_HISTORY_POP }),\n  pushMapHistory: (viewportSave) => ({ type: Actions.MAP_HISTORY_PUSH, data: viewportSave }),\n  clearMapHistory: () => ({ type: Actions.MAP_HISTORY_CLEAR }),\n\n  queueUpload: (uploadObj) => ({ type: Actions.UPLOADER_START, data: uploadObj }),\n  // startActiveUpload: () => ({ type: Actions.UPLOADER_START }),\n  completeActiveUpload: () => ({ type: Actions.UPLOADER_COMPLETE }),\n  updateUploadProgress: (newProgress) => ({ type: Actions.UPLOADER_UPDATE_PROGRESS, data: newProgress })\n\n}\n","import { Actions } from '../actions'\nimport { home } from '../../config'\nconst mapInit = [\n  {\n    mode: home.MapModeTypes.FREE,\n    // selectedItem: null\n    viewport: {\n      // 'latitude': 49.2707848, // vancouver\n      // 'longitude': -123.0714866,\n      latitude: 36.80191008366581, // Grand Canyon\n      longitude: -111.63999999999784,\n      zoom: 11\n    }\n  }\n]\n\nexport default (state = mapInit, action) => {\n  const { type, data } = action\n\n  switch (type) {\n    case Actions.MAP_HISTORY_CLEAR:\n      const newClearerHistory = state.length > 0 ? [[state.length - 1]] : []\n      return newClearerHistory\n\n    case Actions.MAP_HISTORY_POP:\n      return state.slice(0, -1)\n\n    case Actions.MAP_HISTORY_PUSH:\n      return [...state, data]\n    default:\n      return state\n  }\n}\n","import { Actions } from '../actions'\nimport { home } from '../../config'\n\nconst homeInit = {\n  history: [],\n  current: {\n    domain: home.AppStateTypes.FEED\n    // search: null // { tab, text }\n    // defaultSearchTab:\n    // defaultSearchText:\n    // activeSeries: 'fda17bae-0335-4f0d-9065-dc8d7aa23ed1',\n    // initialPhoto: 'someguid'\n  }\n}\n\nexport default (state = homeInit, action) => {\n  const { type, data } = action\n  const { history, current } = state\n\n  switch (type) {\n    case Actions.HOME_STATE_BACK:\n      const newStateHistory = [...history]\n      const newCurrentState = newStateHistory.length > 0 ? newStateHistory.pop() : homeInit.current\n      return {\n        ...state,\n        current: newCurrentState,\n        history: newStateHistory\n      }\n\n    case Actions.HOME_CHANGE_ACTIVE_SERIES:\n      const { activeSeries, initialPhoto } = current\n      return {\n        ...state,\n        history,\n        current: {\n          ...current,\n          activeSeries: activeSeries || null,\n          initialPhoto: activeSeries && initialPhoto ? initialPhoto : null\n        }\n      }\n\n    case Actions.HOME_CHANGE_STATE:\n      const { newDomain, params } = data\n      const newParams = params || {}\n\n      // We don't save certain states\n      const saveState = [\n        home.AppStateTypes.QRCAPTURE,\n        home.AppStateTypes.NEW_SERIES_CAMERA,\n        home.AppStateTypes.NEW_SERIES_LIBRARY\n      ].indexOf(current.domain) !== 0\n\n      const newHistory = saveState ? [...history, current] : history\n      return {\n        ...state,\n        history: newHistory,\n        current: {\n          ...current,\n          domain: newDomain,\n          ...newParams\n        }\n      }\n\n    default:\n      return state\n  }\n}\n","import { Actions } from '../actions'\n\nconst initState = {\n  store: [],\n  activeUpload: null\n}\n\nexport default (state = initState, action) => {\n  const { type, data } = action\n  const { store, activeUpload } = state\n\n  switch (type) {\n    case Actions.UPLOADER_START:\n      if (!activeUpload) {\n        return {\n          ...state,\n          activeUpload: data\n        }\n      }\n      else {\n        return {\n          ...state,\n          store: [...store, data]\n        }\n      }\n    case Actions.UPLOADER_COMPLETE:\n      if (store.length === 0) {\n        return {\n          ...state,\n          activeUpload: null\n        }\n      }\n      else {\n        const newStore = [...store]\n        const newActive = newStore.pop()\n        return {\n          ...state,\n          store: newStore,\n          activeUpload: newActive\n        }\n      }\n    case Actions.UPLOADER_UPDATE_PROGRESS:\n      return {\n        ...state,\n        activeUpload: { ...activeUpload, ...data }\n      }\n    default:\n      return state\n  }\n}\n","import { Actions } from '../actions'\nimport { isIos } from '../../lib/sensors'\n\nconst defaultFlags = {\n  iOSWarning: isIos(),\n  install: true,\n  useLoggedOut: false\n}\nexport default (state = defaultFlags, action) => {\n  const { type, data } = action\n\n  switch (type) {\n    case Actions.SETFLAG:\n      const { flagName, flagVal } = data\n      return { ...state, [flagName]: flagVal }\n\n    default:\n      return state\n  }\n}\n","import { Actions } from '../actions'\n\nconst offlineInit = {\n  completedDownload: false,\n  viewport: null\n}\n\nexport default (state = offlineInit, action) => {\n  const { type, data } = action\n\n  switch (type) {\n    case Actions.OFFLINE_VIEWPORT_SAVE:\n      return {\n        ...state,\n        viewport: data\n      }\n\n    case Actions.OFFLINE_SET_STATUS:\n      return {\n        ...state,\n        completedDownload: data\n      }\n\n    default:\n      return state\n  }\n}\n","import { combineReducers } from 'redux'\nimport map from './map'\nimport home from './home'\nimport uploader from './uploader'\nimport flags from './flags'\nimport offline from './offline'\n\nexport default combineReducers({ map, home, uploader, flags, offline })\n","import { createStore, applyMiddleware, compose } from 'redux'\nimport thunk from 'redux-thunk'\nimport rootReducer from './reducers'\nimport { persistStore, persistReducer } from 'redux-persist'\nimport { stateStore } from '../graphql/offline'\n// import storage from 'redux-persist/lib/storage' // defaults to localStorage for web\n\n// import api from '../middleware/api'\n// https://github.com/reduxjs/redux/blob/master/examples/real-world/src/middleware/api.js\n\nconst persistConfig = {\n  key: 'root',\n  storage: stateStore\n}\n\nconst persistedReducer = persistReducer(persistConfig, rootReducer)\n\n/**\n * On Dev we want our devTools available\n */\nconst configureStoreDev = preloadedState => {\n  const { devToolsEnhancer } = require('redux-devtools-extension')\n  const { createLogger } = require('redux-logger')\n  const store = createStore(\n    persistedReducer,\n    preloadedState,\n    compose(\n      devToolsEnhancer(),\n      applyMiddleware(\n        thunk,\n        createLogger()\n      )\n    )\n  )\n  if (module.hot) {\n    // Enable Webpack hot module replacement for reducers\n    module.hot.accept('./reducers', () => {\n      store.replaceReducer(rootReducer)\n    })\n  }\n  return store\n}\n\n/**\n * Production gets a simpler more performant store:\n */\nconst configureStoreProd = preloadedState => {\n  const store = createStore(\n    persistedReducer,\n    preloadedState,\n    compose(\n      applyMiddleware(\n        thunk\n      )\n    )\n  )\n  return store\n}\n\nexport default () => {\n  const store = process.env.NODE_ENV === 'production' ? configureStoreProd() : configureStoreDev()\n  return {\n    store,\n    persistor: persistStore(store)\n  }\n}\n","import React from 'react'\nimport { PersistGate } from 'redux-persist/integration/react'\nimport { Provider } from 'react-redux'\nimport storeConfig from './storeConfig'\nimport Loading from '../components/auth/Loading'\n/**\n * In this example, 'store' is the configured Redux store and\n *'persist' is a function that returns a Promise to rehydrate the\n * Redux store using redux-persist\n *\n * FROM: https://medium.com/hexient-labs/redux-store-provider-hoc-3495281905c\n */\nconst withReduxProvider = BaseComponent => (props) => {\n  const { store, persistor } = storeConfig()\n  // console.log('withReduxProvider', { props, store, persistor })\n  return (\n    <Provider store={store}>\n      <PersistGate loading={<Loading />} persistor={persistor}>\n        <BaseComponent {...props} />\n      </PersistGate>\n    </Provider>\n  )\n}\n\nexport default withReduxProvider\n","import React from 'react'\nimport classNames from 'classnames'\nimport PropTypes from 'prop-types'\nimport Paper from '@material-ui/core/Paper'\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport LinearProgress from '@material-ui/core/LinearProgress'\nimport Typography from '@material-ui/core/Typography'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n    background: 'black',\n    color: theme.palette.primary.contrastText,\n    padding: theme.spacing(1) * 2\n  },\n  message: {\n    // width: '100%'\n  },\n  msgText: {\n    display: 'flex'\n  },\n  spacer: {\n    flexGrow: 1\n  },\n  messageInner: {\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst UploadControlUnstyled = ({ className, text, progress }) => {\n  const classes = useStyles()\n  if (!text) return null\n  const message = `Uploading: ${text}`\n  return (\n    <div className={classNames(classes.root, className)}>\n      <div className={classes.messageInner}>\n        <div className={classes.msgText}>\n          <Typography color='inherit'>{message}</Typography>\n          <div className={classes.spacer} />\n          <Typography color='inherit'>{progress}%</Typography>\n        </div>\n        <LinearProgress color='secondary' variant='determinate' value={progress} />\n      </div>\n    </div>\n  )\n}\n\nUploadControlUnstyled.propTypes = {\n  className: PropTypes.string,\n  text: PropTypes.string,\n  progress: PropTypes.number\n}\n\nconst UploadControl = UploadControlUnstyled\nexport default UploadControl\n\nexport const UploadControlCOSMOSWrapper = ({ text, progress }) => {\n  // const [someStateItem, setSomeStateItem] = useState()\n  const classes = useWrapperStyles()\n  return (\n    <div className={classes.root}>\n      <CssBaseline /> {/* You only need this in a root element. Don't put it anywhere else in the dom */}\n      <Paper className={classes.paper}>\n        <Typography variant='h5'>\n          This is a dummy component.\n        </Typography>\n      </Paper>\n      <UploadControl text={text} progress={progress} />\n    </div>\n  )\n}\n\nUploadControlCOSMOSWrapper.propTypes = {\n  text: PropTypes.string,\n  progress: PropTypes.number\n}\nconst wrapperStyle = theme => ({\n  root: {\n    height: '100%',\n    display: 'flex',\n    flexDirection: 'column'\n  },\n  paper: {\n    flexGrow: 1\n  }\n})\n\nconst useWrapperStyles = makeStyles(wrapperStyle)\n\nUploadControlCOSMOSWrapper.displayName = UploadControl.displayName\nexport const UploadControlTest = UploadControlCOSMOSWrapper\n","import axios from 'axios'\nimport FormData from 'form-data'\nimport { imgStore } from '../graphql/offline'\n// import { getExtFromBlob } from '../lib/Photo'\n/**\n * DEbuggers for AXIOS\n */\naxios.interceptors.request.use(\n  request => {\n    console.log('AXIOS:::: Starting Request', request)\n    return request\n  },\n  err => {\n    console.log('AXIOS:::: Starting Request ERROR', err)\n    return Promise.reject(err)\n  }\n)\n\naxios.interceptors.response.use(\n  response => {\n    console.log('AXIOS:::: Response', response)\n    return response\n  },\n  err => {\n    console.log('AXIOS:::: Starting Response ERROR', err)\n    return Promise.reject(err)\n  }\n)\n\nexport default async function doUpload (activeUpload, updateUploadProgress, completeActiveUpload) {\n  console.log('doUpload:: upload start', activeUpload)\n\n  // Initialising the HTML POST form for posting to S3 directly\n  let formData = new FormData()\n  // Take the auth credentials that we got from the backend and add them to our S3 POST\n  Object.keys(activeUpload.preAuth.fields).forEach(fieldkey => {\n    console.log(`doUpload::append:: ${fieldkey}: ${activeUpload.preAuth.fields[fieldkey].substring(0, 50)}`)\n    formData.append(fieldkey, activeUpload.preAuth.fields[fieldkey])\n  })\n  const file = await imgStore.getItem(activeUpload.uploadToken)\n  formData.append('file', file)\n\n  const config = {\n    headers: {\n      'Content-Type': 'multipart/form-data'\n    },\n    onUploadProgress: progressEvent => {\n      const { loaded, total } = progressEvent\n      // Do something with the progress details\n      console.log('doUpload::PROGRESSEVENT', loaded, total, Math.floor(100 * loaded / total))\n      updateUploadProgress({ progress: Math.floor(100 * loaded / total) })\n    }\n  }\n\n  console.log('doUpload::FORMDATA', { formData, config })\n  // Upload file to S3\n  await axios.post(\n    activeUpload.preAuth.url,\n    formData,\n    config\n  ).catch(err => {\n    console.error('doUpload::ERROR')\n    console.error(err)\n    console.log(err.stack)\n  })\n  console.log('doUpload:: upload done. cleaning up imgStore', await imgStore.keys())\n  await imgStore.removeItem(activeUpload.uploadToken)\n  console.log('doUpload:: Cleaned up img store', await imgStore.keys())\n  completeActiveUpload()\n}\n\n// export function dataURLtoFile (dataurl, filename) {\n//   var arr = dataurl.split(','); var mime = arr[0].match(/:(.*?);/)[1]\n\n//   var bstr = atob(arr[1]); var n = bstr.length; var u8arr = new Uint8Array(n)\n//   while (n--) {\n//     u8arr[n] = bstr.charCodeAt(n)\n//   }\n//   return new File([u8arr], filename, { type: mime })\n// }\n","import React, { useRef, useEffect } from 'react'\nimport PropTypes from 'prop-types'\nimport { connect } from 'react-redux'\nimport actions from '../redux/actions'\nimport UploadControl from '../components/UploadControl'\nimport s3Upload from '../lib/s3upload'\n\nconst UploadConnect = ({\n  activeUpload,\n  completeActiveUpload,\n  updateUploadProgress,\n  ...props\n}) => {\n  const uploadingRef = useRef()\n  useEffect(() => {\n    uploadingRef.current = uploadingRef.current && !!activeUpload\n\n    if (activeUpload && !uploadingRef.current) {\n      s3Upload(activeUpload, updateUploadProgress, completeActiveUpload)\n    }\n  }, [Boolean(activeUpload)])\n\n  if (!activeUpload) return null\n  return <UploadControl text={'Uploading thing'} progress={activeUpload.progress || 0} {...props} />\n}\nUploadConnect.propTypes = {\n  // All from redux\n  activeUpload: PropTypes.object,\n  completeActiveUpload: PropTypes.func.isRequired,\n  updateUploadProgress: PropTypes.func.isRequired\n}\n\n/**\n * Map our redux state and functions\n */\nconst mapStateToProps = (state, props) => {\n  const { activeUpload } = state.uploader\n  return { activeUpload }\n}\n\nconst mapDispatchToProps = dispatch => ({\n  completeActiveUpload: () => {\n    dispatch(actions.completeActiveUpload())\n  },\n  updateUploadProgress: (newProgress) => {\n    dispatch(actions.updateUploadProgress(newProgress))\n  }\n})\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(UploadConnect)\n","/**\n * Valid Roles are: admin, user, nonuser\n *\n * Valid Resources are: series, series_public, series_open, photo\n *\n * For more see:\n * https://docs.google.com/spreadsheets/d/1oXsZrsuyOSFs_tufRluSjQiR6OSTObWiGsKDUKb5vLk/edit#gid=0\n *\n * RTFM:\n * https://onury.io/accesscontrol/?content=guide#resources-and-resource-attributes\n */\nexport default {\n  // Admin is god. Be careful who you give this to.\n  admin: {\n    series: {\n      'create:own': ['*'],\n      'read:any': ['*'],\n      'update:any': ['*'],\n      'delete:any': ['*']\n    },\n    photo: {\n      'create:any': ['*'],\n      'read:any': ['*'],\n      'update:any': ['*'],\n      'delete:any': ['*']\n    }\n  },\n  // Logged out users can see public stuff but nothing esle\n  nonuser: {\n    photo: {\n      'read:any': ['*'],\n      'update:any': ['*'],\n      'delete:any': ['*']\n    },\n    series_public: {\n      'read:any': ['*']\n    },\n    series_open: {\n      'read:any': ['*']\n    }\n  },\n  // Users are the key permissions role in V0\n  // Note: we could inherit from user but we keep it explicit for now\n  user: {\n    series: {\n      'create:own': ['*'],\n      'read:own': ['*'],\n      'update:own': ['*'],\n      'delete:own': ['*']\n    },\n    series_public: {\n      'read:any': ['*']\n    },\n    series_open: {\n      'read:any': ['*'],\n      'update:any': ['photos']\n    },\n    photo: {\n      'read:any': ['*'],\n      'create:own': ['*'],\n      'update:own': ['*'],\n      'delete:own': ['*']\n    }\n  }\n}\n","// import React, { useContext } from 'react'\n// import PropTypes from 'prop-types'\nimport { graphql } from 'react-apollo'\nimport { allSeriesUpdate, feedUpdate } from './updateQueries'\nimport { deleteSeries } from '../mutations'\nimport { pushMutationPromise, popMutationPromise } from '../offline'\n\nconst withMutation = graphql(deleteSeries, {\n  props: ({ mutate, ownProps }) => {\n    return {\n      deleteSeriesMutation: () => {\n        // When we're not creating a series the seriesId isn't passed in\n        // so we add it now\n        const variables = {\n          id: ownProps.activeSeries\n        }\n        const optimisticResponse = {\n          deleteSeries: ownProps.activeSeries\n        }\n        const mutationStackId = pushMutationPromise({ variables, optimisticResponse }, deleteSeries)\n\n        return mutate({\n          variables,\n          optimisticResponse,\n          update: updateThunk({}, ownProps.onAfterSeriesDelete)\n        }).then(data => {\n          // Here's where we take it out of the queue\n          console.log('deleteSeriesMutation:: done', data)\n          popMutationPromise(mutationStackId)\n          return data\n        })\n      }\n    }\n  }\n})\n\nconst updateThunk = (context, cb) => (store, { data }) => {\n  // We need to write this query from scratch\n  allSeriesUpdate(store, { id: data.deleteSeries }, true)\n  feedUpdate(store, { id: data.deleteSeries }, null, true)\n\n  if (cb) cb(data.createSeries.series.id)\n}\n\nexport default {\n  withMutation,\n  updateThunk\n}\n","// import React, { useContext } from 'react'\n// import PropTypes from 'prop-types'\nimport { graphql } from 'react-apollo'\nimport { getWholeSeriesUpdate, allSeriesUpdate, feedUpdate } from './updateQueries'\nimport { updateSeries, updateSeriesKeys } from '../mutations'\nimport { pushMutationPromise, popMutationPromise } from '../offline'\n\nimport _ from 'lodash'\n\nexport const withMutation = graphql(updateSeries, {\n  props: ({ mutate, ownProps }) => {\n    return {\n      updateSeriesMutation: (series, seriesDelta) => {\n        const { id, gravatar, gravatarProfile, username } = ownProps.user\n        const meUserSummary = { id, gravatar, gravatarProfile, username, __typename: 'UserSummary' }\n\n        const variables = {\n          series: _.pick(seriesDelta, updateSeriesKeys)\n        }\n        const optimisticResponse = createOptimisticResponse({ meUserSummary, series, seriesDelta })\n        const mutationStackId = pushMutationPromise({ variables, optimisticResponse }, updateSeries)\n\n        return mutate({\n          variables,\n          // refetchQueries: [{ query: getWholeSeries, variables: { id: newSeries.id } }],\n          optimisticResponse,\n          update: updateThunk()\n        }).then(data => {\n          // Here's where we take it out of the queue\n          console.log('updateSeriesMutation:: done', data)\n          popMutationPromise(mutationStackId)\n          return data\n        })\n      }\n    }\n  }\n})\n\nconst updateThunk = (context, cb) => (store, { data }) => {\n  // We need to write this query from scratch\n  getWholeSeriesUpdate(store, data.updateSeries)\n  allSeriesUpdate(store, data.updateSeries)\n  feedUpdate(store, data.createSeries.series, data.createdSeries.series.photos[0])\n}\n\nconst createOptimisticResponse = ({ meUserSummary, series, seriesDelta }) => ({\n  updateSeries: {\n    ...series,\n    ...seriesDelta,\n    updatedUser: meUserSummary,\n    updatedBy: meUserSummary.id,\n    __typename: 'Series'\n  }\n})\n\nexport default {\n  withMutation,\n  updateThunk\n}\n","// import React, { useContext } from 'react'\n// import PropTypes from 'prop-types'\nimport { graphql } from 'react-apollo'\nimport { allSeriesPhotoUpdate, feedUpdate } from './updateQueries'\nimport { deletePhoto } from '../mutations'\nimport { pushMutationPromise, popMutationPromise } from '../offline'\n\nconst withMutation = graphql(deletePhoto, {\n  props: ({ mutate, ownProps }) => {\n    return {\n      deletePhotoMutation: (photoId) => {\n        // When we're not creating a series the seriesId isn't passed in\n        // so we add it now\n        const variables = {\n          seriesId: ownProps.series.id,\n          photoId\n        }\n        const optimisticResponse = {\n          deletePhoto: photoId\n        }\n        const mutationStackId = pushMutationPromise({ variables, optimisticResponse }, deletePhoto)\n\n        return mutate({\n          variables,\n          optimisticResponse,\n          update: updateThunk({ seriesId: ownProps.series })\n        }).then(data => {\n          // Here's where we take it out of the queue\n          console.log('deletePhotoMutation:: done', data)\n          popMutationPromise(mutationStackId)\n          return data\n        })\n      }\n    }\n  }\n})\n\nconst updateThunk = (context, cb) => (store, { data }) => {\n  // We need to write this query from scratch\n  allSeriesPhotoUpdate(store, null, { id: data.deletePhoto }, true)\n  feedUpdate(store, context.series, { id: data.deletePhoto, seriesId: context.series.seriesId }, true)\n}\n\nexport default {\n  withMutation,\n  updateThunk\n}\n","// import React, { useContext } from 'react'\n// import PropTypes from 'prop-types'\nimport { graphql } from 'react-apollo'\nimport { getWholeSeriesPhotoUpdate, allSeriesPhotoUpdate, feedUpdate } from './updateQueries'\nimport { createPhoto, newPhotoKeys } from '../mutations'\nimport { pushMutationPromise, popMutationPromise } from '../offline'\n\nimport _ from 'lodash'\n\nconst withMutation = graphql(createPhoto, {\n  props: ({ mutate, ownProps }) => {\n    return {\n      createPhotoMutation: (series, newPhoto, ext) => {\n        // When we're not creating a series the seriesId isn't passed in\n        // so we add it now\n        const newPhotoInput = _.cloneDeep(newPhoto)\n        if (!newPhotoInput.seriesId && ownProps.activeSeries) {\n          newPhotoInput.seriesId = ownProps.activeSeries\n        }\n        const { id, gravatar, gravatarProfile, username } = ownProps.user\n        const meUserSummary = { id, gravatar, gravatarProfile, username, __typename: 'UserSummary' }\n        const variables = {\n          photo: _.pick(newPhotoInput, newPhotoKeys),\n          ext\n        }\n        const optimisticResponse = createOptimisticResponse({ meUserSummary, series, newPhoto, ext })\n        const mutationStackId = pushMutationPromise({ variables, optimisticResponse }, createPhoto)\n\n        return mutate({\n          variables,\n          optimisticResponse,\n          update: updateThunk()\n        }).then(data => {\n          // Here's where we take it out of the queue\n          console.log('createPhotoMutation:: done', data)\n          popMutationPromise(mutationStackId)\n          return data\n        })\n      }\n    }\n  }\n})\n\nconst updateThunk = (context, cb) => (store, { data }) => {\n  // We need to write this query from scratch\n  getWholeSeriesPhotoUpdate(store, data.createPhoto.photo)\n  allSeriesPhotoUpdate(store, context.series, data.createPhoto.photo)\n  feedUpdate(store, context.series, data.createPhoto.photo)\n}\n\nconst createOptimisticResponse = ({ meUserSummary, series, newPhoto, ext }) => ({\n  createPhoto: {\n    photo: {\n      id: newPhoto.id,\n      meta: newPhoto.meta || null,\n      seriesId: newPhoto.seriesId,\n      createdOn: Date.now().toString(),\n      createdUser: meUserSummary,\n      updatedUser: meUserSummary,\n      createdBy: meUserSummary.id,\n      updatedBy: meUserSummary.id,\n      uploadToken: newPhoto.uploadToken,\n      updatedOn: Date.now().toString(),\n      seriesCreatedBy: series.createdUser.id, // we can't answer this yet\n      takenOn: newPhoto.takenOn,\n      coords: newPhoto.coords || null,\n      tags: newPhoto.tags || [],\n      paths: {\n        base: null,\n        large: null,\n        orig: null,\n        thumb: null,\n        medium: null,\n        __typename: 'Paths'\n      },\n      __typename: 'Photo'\n    },\n    preAuth: null,\n    __typename: 'NewPhoto'\n  }\n})\n\nexport default {\n  withMutation,\n  updateThunk\n}\n","// import React, { useContext } from 'react'\n// import PropTypes from 'prop-types'\nimport { graphql } from 'react-apollo'\nimport { getWholeSeriesPhotoUpdate, allSeriesPhotoUpdate, feedUpdate } from './updateQueries'\nimport { updatePhoto, updatePhotoKeys } from '../mutations'\nimport { pushMutationPromise, popMutationPromise } from '../offline'\n\nimport _ from 'lodash'\n\nconst withMutation = graphql(updatePhoto, {\n  props: ({ mutate, ownProps }) => {\n    return {\n      updatePhotoMutation: (photo, photoDelta) => {\n        // When we're not creating a series the seriesId isn't passed in\n        // so we add it now\n        const newUpdatePhoto = _.pick(photoDelta, updatePhotoKeys)\n        if (newUpdatePhoto.tags && newUpdatePhoto.tags.length > 0) {\n          newUpdatePhoto.tags = newUpdatePhoto.tags.map(t => {\n            const newT = _.pick(t, [ 'label', 'typeId', 'coords' ])\n            if (newT.coords) newT.coords = _.pick(newT.coords, [ 'x', 'y' ])\n            return newT\n          })\n        }\n\n        const { id, gravatar, gravatarProfile, username } = ownProps.user\n        const meUserSummary = { id, gravatar, gravatarProfile, username, __typename: 'UserSummary' }\n        const variables = {\n          photo: newUpdatePhoto\n        }\n        const optimisticResponse = createOptimisticResponse({ meUserSummary, photo, photoDelta })\n        const mutationStackId = pushMutationPromise({ variables, optimisticResponse }, updatePhoto)\n\n        return mutate({\n          variables,\n          optimisticResponse,\n          update: updateThunk({ photo })\n        }).then(data => {\n          // Here's where we take it out of the queue\n          console.log('updatePhotoMutation:: done', data)\n          popMutationPromise(mutationStackId)\n          return data\n        })\n      }\n    }\n  }\n})\n\nconst updateThunk = (context, cb) => (store, { data }) => {\n  // We need to write this query from scratch\n  getWholeSeriesPhotoUpdate(store, { ...context.photo, ...data.updatePhoto })\n  allSeriesPhotoUpdate(store, null, { ...context.photo, ...data.updatePhoto })\n  feedUpdate(store, null, { ...context.photo, ...data.updatePhoto })\n\n  if (cb) cb(data.createSeries.series.id)\n}\n\nconst createOptimisticResponse = ({ meUserSummary, photo, photoDelta }) => ({\n  updatePhoto: {\n    ...photo,\n    ...photoDelta,\n    updatedUser: meUserSummary,\n    updatedBy: meUserSummary.id,\n    __typename: 'Photo'\n  }\n})\n\nexport default {\n  withMutation,\n  updateThunk\n}\n","// import React, { useContext } from 'react'\n// import PropTypes from 'prop-types'\nimport { graphql } from 'react-apollo'\nimport { watchUpdate } from './updateQueries'\nimport { watchSeries } from '../mutations'\nimport { pushMutationPromise, popMutationPromise } from '../offline'\n\nconst withMutation = graphql(watchSeries, {\n  props: ({ mutate, ownProps }) => {\n    return {\n      watchSeriesMutation: () => {\n        // When we're not creating a series the seriesId isn't passed in\n        // so we add it now\n        const variables = {\n          seriesId: ownProps.activeSeries\n        }\n        const optimisticResponse = {\n          watchSeries: ownProps.activeSeries\n        }\n        const mutationStackId = pushMutationPromise({ variables, optimisticResponse }, watchSeries)\n\n        return mutate({\n          variables,\n          optimisticResponse,\n          update: updateThunk()\n        }).then(data => {\n          // Here's where we take it out of the queue\n          console.log('watchSeriesMutation:: done', data)\n          popMutationPromise(mutationStackId)\n          return data\n        })\n      }\n    }\n  }\n})\n\nconst updateThunk = (context, cb) => (store, { data }) => {\n  // We need to write this query from scratch\n  watchUpdate(store, data.watchSeries)\n}\n\nexport default {\n  withMutation,\n  updateThunk\n}\n","// import React, { useContext } from 'react'\n// import PropTypes from 'prop-types'\nimport { graphql } from 'react-apollo'\nimport { watchUpdate } from './updateQueries'\nimport { unWatchSeries } from '../mutations'\nimport { pushMutationPromise, popMutationPromise } from '../offline'\n\nconst withMutation = graphql(unWatchSeries, {\n  props: ({ mutate, ownProps }) => {\n    return {\n      unWatchSeriesMutation: () => {\n        // When we're not creating a series the seriesId isn't passed in\n        // so we add it now\n        const variables = {\n          seriesId: ownProps.activeSeries\n        }\n        const optimisticResponse = {\n          unWatchSeries: ownProps.activeSeries\n        }\n        const mutationStackId = pushMutationPromise({ variables, optimisticResponse }, unWatchSeries)\n\n        return mutate({\n          variables,\n          optimisticResponse,\n          update: updateThunk()\n        }).then(data => {\n          // Here's where we take it out of the queue\n          console.log('unWatchSeriesMutation:: done', data)\n          popMutationPromise(mutationStackId)\n          return data\n        })\n      }\n    }\n  }\n})\n\nconst updateThunk = (context, cb) => (store, { data }) => {\n  // We need to write this query from scratch\n  watchUpdate(store, data.unWatchSeries, true)\n}\n\nexport default {\n  withMutation,\n  updateThunk\n}\n","import React from 'react'\n\nexport const SeriesContext = React.createContext({})\n","import React, { useState, useLayoutEffect, useContext } from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport Dialog from '@material-ui/core/Dialog'\n// import MenuIcon from '@material-ui/icons/Menu'\nimport QRCode from 'qrcode'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { Paper } from '@material-ui/core'\nimport { SeriesContext } from '../contexts'\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n  },\n  title: {\n    textAlign: 'center'\n  },\n  qrPaper: {\n    padding: theme.spacing(2)\n  },\n  qrCode: {\n    width: '100%',\n    height: 400\n  }\n}))\n\nconst QRDisplay = ({ onClose, open }) => {\n  const classes = useStyles()\n  const { series } = useContext(SeriesContext)\n  const [qrCodeEl, setQRCodeEl] = useState(null)\n  const obj = { type: 'series', id: series.id }\n  const encodedId = encodeURI(JSON.stringify(obj))\n  const url = `${process.env.PUBLIC_URL}/?fromqr=${encodedId}`\n\n  useLayoutEffect(() => {\n    QRCode.toString(url, (err, svgStr) => {\n      if (err) console.error(err)\n      else setQRCodeEl(svgStr)\n    })\n  }, [series])\n\n  return (\n    <Dialog\n      open={open}\n      fullWidth\n\n      onClose={onClose}\n      className={classes.root\n      }>\n      <Paper className={classes.qrPaper}>\n        <Typography variant='subtitle1' component='div' className={classes.title}>{series.name}</Typography>\n        <svg className={classes.qrCode} dangerouslySetInnerHTML={{ __html: qrCodeEl }} />\n        {series.coords && <Typography component='div' className={classes.title}>[ {series.coords[0]}, {series.coords[1]} ]</Typography>}\n      </Paper>\n    </Dialog>\n  )\n}\n\nQRDisplay.propTypes = {\n  onClose: PropTypes.func.isRequired,\n  open: PropTypes.bool\n}\n\nexport default QRDisplay\n","import React from 'react'\nimport createSvgIcon from '@material-ui/icons/utils/createSvgIcon'\n\nexport default createSvgIcon(\n  <React.Fragment>\n    <path d='M22,2l0,20l-20,0l0,-20l20,0Zm-2,2l-16,0l0,16l16,0l0,-16Z' />\n    <rect x='5' y='5' width='4' height='4' />\n    <rect x='15' y='5' width='4' height='4' />\n    <rect x='5' y='15' width='4' height='4' />\n    <rect x='10' y='10' width='1' height='5' />\n    <rect x='11' y='10' width='6' height='2' />\n    <rect x='11' y='12' width='2' height='2' />\n    <rect x='13' y='7' width='1' height='2' />\n    <rect x='14' y='9' width='1' height='1' />\n    <rect x='8' y='10' width='1' height='4' />\n    <rect x='7' y='11' width='1' height='3' />\n    <rect x='9' y='11' width='1' height='1' />\n    <rect x='10' y='6' width='2' height='3' />\n    <rect x='12' y='7' width='1' height='1' />\n    <rect x='15' y='14' width='2' height='4' />\n    <rect x='14' y='14' width='1' height='1' />\n    <rect x='17' y='15' width='2' height='2' />\n    <rect x='11' y='16' width='1' height='3' />\n    <rect x='12' y='15' width='2' height='2' />\n    <rect x='10' y='18' width='1' height='1' />\n  </React.Fragment>, 'QRCode')\n","import React, { useState, useRef, useEffect } from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport SpeedDial from '@material-ui/lab/SpeedDial'\nimport SpeedDialAction from '@material-ui/lab/SpeedDialAction'\nimport Fab from '@material-ui/core/Fab'\nimport { fade } from '@material-ui/core/styles/colorManipulator'\n\n// import useNewImageMenu from '../PhotoSeries/views/controls/useNewImageMenu'\nimport AddCameraIcon from '@material-ui/icons/AddAPhoto'\nimport PhotoLibraryIcon from '@material-ui/icons/PhotoLibrary'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst useStyles = makeStyles(theme => {\n  const pulseCol = fade(theme.palette.secondary.light, 0.4)\n  return {\n    root: {\n    },\n    speedDialFab: {\n      background: theme.palette.secondary.main,\n      color: theme.palette.secondary.contrastText,\n      '&::before': {\n        content: '\"  \"',\n        display: 'block',\n        position: 'absolute',\n        width: '100%',\n        height: '100%',\n        borderRadius: 'inherit',\n        boxShadow: `0 0 0 0 ${pulseCol}`,\n        animation: '$fabPulse 4s',\n        animationIterationCount: 5,\n        animationTimingFunction: 'linear'\n      }\n    },\n    '@keyframes fabPulse': {\n      '0%': {\n        boxShadow: `0 0 0 0px ${pulseCol}`\n      },\n      '90%': {\n        boxShadow: `0 0 0 0px ${pulseCol}`\n      },\n      '100%': {\n        boxShadow: `0 0 0 10px transparent`\n      }\n    },\n    directionUp: {\n    },\n    actionsClosed: {\n      display: 'none'\n    }\n  }\n})\n\nconst AddFab = ({ className, children, onCameraClick, onLibraryClick, isIos }) => {\n  const [open, setOpen] = useState(false)\n  const [down, setDown] = useState(false)\n  const timerRef = useRef()\n  const classes = useStyles()\n  // const theme = useTheme()\n  const downRef = useRef(down)\n  const elRef = useRef()\n  downRef.current = down\n\n  // Make sure to clean up the timer\n  useEffect(() => () => {\n    // clean up the timer if we no longer need it\n    timerRef.current = null\n    downRef.current = null\n  }, [])\n\n  const startTimer = (el) => {\n    if (!elRef.current) return\n\n    setDown(true)\n    if (!open && !timerRef.current) {\n      timerRef.current = setTimeout(() => {\n        if (downRef.current) setOpen(true)\n        timerRef.current = null\n      }, 300)\n    }\n  }\n\n  const onDown = (e) => {\n    // console.log('onDown', e.currentTarget)\n    // setSeries(series)\n    startTimer(e.currentTarget)\n  }\n\n  const block = (e) => {\n    if (e && e.stopPropagation) {\n      e.stopPropagation()\n      e.preventDefault()\n    }\n  }\n\n  const cameraAction = (e) => {\n    console.log('cameraclick')\n    setOpen(false)\n    setDown(false)\n    onCameraClick()\n    block(e)\n  }\n  const libraryAction = (e) => {\n    console.log('libraryClick')\n    setOpen(false)\n    setDown(false)\n    onLibraryClick()\n    block(e)\n  }\n\n  if (isIos) return <AddFabIos {...{ className, onLibraryClick, children }} />\n\n  return (\n    <div className={classNames(classes.rootContainer, className)} ref={elRef}>\n      <SpeedDial\n        ariaLabel='SpeedDial photo adder'\n        onBlur={(e) => {\n          setTimeout(() => setOpen(false), 250)\n        }}\n        ButtonProps={{\n          disableFocusRipple: true\n        }}\n        classes={{\n          directionUp: classes.directionUp,\n          actionsClosed: classes.actionsClosed,\n          root: classes.root,\n          fab: classNames(classes.speedDialFab, 'fabanimation')\n        }}\n        icon={children}\n        onClick={(e) => {\n          block(e)\n          setDown(false)\n          if (!open) {\n            console.log('cameraclick MAIN')\n            onCameraClick()\n          }\n        }}\n        onMouseDown={onDown}\n        // onMouseUp={onUp}\n        onTouchStart={onDown}\n        // onTouchEnd={onUp}\n\n        open={open}\n        direction='up'\n      >\n        <SpeedDialAction\n        // Bit of a hack here. This function isn't quite ready for primetime\n          icon={<AddCameraIcon className={classes.speedDialIcon} />}\n          tooltipPlacement='right'\n          tooltipTitle='From Camera'\n          tooltipOpen\n          ButtonProps={{\n            disableFocusRipple: true\n          }}\n          onClick={cameraAction}\n          onMouseDown={onDown}\n          onTouchStart={cameraAction}\n        />\n        <SpeedDialAction\n        // Bit of a hack here. This function isn't quite ready for primetime\n          icon={<PhotoLibraryIcon className={classes.speedDialIcon} />}\n          tooltipPlacement='right'\n          tooltipTitle='From Photo Library'\n          tooltipOpen\n          ButtonProps={{\n            disableFocusRipple: true\n          }}\n          onClick={libraryAction}\n          onMouseDown={onDown}\n          onTouchStart={libraryAction}\n        />\n      </SpeedDial>\n    </div>\n\n  )\n}\n\nAddFab.propTypes = {\n  className: PropTypes.string,\n  children: PropTypes.any,\n  isIos: PropTypes.bool,\n  onCameraClick: PropTypes.func.isRequired,\n  onLibraryClick: PropTypes.func.isRequired\n}\n\nexport default AddFab\n\nconst useIosStyles = makeStyles(theme => {\n  const pulseCol = fade(theme.palette.secondary.light, 0.4)\n  return {\n    root: {\n      background: theme.palette.secondary.main,\n      color: theme.palette.secondary.contrastText,\n      '&::before': {\n        content: '\"  \"',\n        display: 'block',\n        position: 'absolute',\n        width: '100%',\n        height: '100%',\n        borderRadius: 'inherit',\n        boxShadow: `0 0 0 0 ${pulseCol}`,\n        animation: '$fabPulse 4s',\n        animationIterationCount: 5,\n        animationTimingFunction: 'linear'\n      }\n    },\n    '@keyframes fabPulse': {\n      '0%': {\n        boxShadow: `0 0 0 0px ${pulseCol}`\n      },\n      '90%': {\n        boxShadow: `0 0 0 0px ${pulseCol}`\n      },\n      '100%': {\n        boxShadow: `0 0 0 10px transparent`\n      }\n    }\n  }\n})\n\nexport const AddFabIos = ({ className, children, onLibraryClick }) => {\n  const classes = useIosStyles()\n  return (\n    <Fab className={classNames(classes.root, className)} onClick={onLibraryClick} disableFocusRipple>\n      {children}\n    </Fab>\n  )\n}\n\nAddFabIos.propTypes = {\n  className: PropTypes.string,\n  children: PropTypes.any,\n  onLibraryClick: PropTypes.func.isRequired\n}\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Menu from '@material-ui/core/Menu'\nimport MenuItem from '@material-ui/core/MenuItem'\nimport ListItemIcon from '@material-ui/core/ListItemIcon'\nimport ListItemText from '@material-ui/core/ListItemText'\nimport Divider from '@material-ui/core/Divider'\n\n// import { Menu as MenuIcon } from '@material-ui/icons'\n\nconst ContextMenu = ({ anchorEl, onClose, menuItems }) => {\n  return (\n    <Menu\n      anchorEl={anchorEl}\n      open={!!anchorEl}\n      onClose={onClose}\n    >\n      {menuItems.map(({ icon, color, text, hide, disabled, action, divider }, idx) => {\n        const Icon = icon || null\n        if (hide) return null\n        if (divider) return <Divider key={`contextMenu-${idx}`} />\n        return (\n          <MenuItem\n            button\n            key={`contextMenu-${idx}`}\n            disabled={disabled}\n            onClick={() => {\n              onClose()\n              action()\n            }}>\n            {Icon && (\n              <ListItemIcon>\n                <Icon color={disabled ? 'disabled' : color} />\n              </ListItemIcon>\n            )}\n            <ListItemText primary={text} primaryTypographyProps={{ color }} />\n          </MenuItem>\n        )\n      })}\n    </Menu>\n  )\n}\n\nContextMenu.propTypes = {\n  anchorEl: PropTypes.object,\n  onClose: PropTypes.func,\n  menuItems: PropTypes.arrayOf(PropTypes.shape({\n    text: PropTypes.string,\n    icon: PropTypes.any,\n    divider: PropTypes.any,\n    hide: PropTypes.bool,\n    disabled: PropTypes.bool,\n    color: PropTypes.string,\n    action: PropTypes.func\n  }))\n}\n\nexport default ContextMenu\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Chip from '@material-ui/core/Chip'\nimport CancelIcon from '@material-ui/icons/Cancel'\nimport { makeStyles, useTheme } from '@material-ui/core/styles'\n\nexport const tagChips = {\n  height: 20\n}\n\nconst style = theme => ({\n  root: {\n    fontSize: '0.6em',\n    height: tagChips.height,\n    marginRight: theme.spacing(1) / 2,\n    marginTop: theme.spacing(1) / 2\n  },\n  deleteIcon: {\n    width: tagChips.height - 1,\n    height: tagChips.height - 1\n  },\n  chipAvatar: {\n    width: tagChips.height,\n    height: tagChips.height\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst TagChip = ({ edit, tag, color, onDelete, ...props }) => {\n  const classes = useStyles()\n  const theme = useTheme()\n  return (\n    <Chip\n      style={{\n        background: color || null,\n        color: color ? `${theme.palette.getContrastText(color)}` : null\n      }}\n      label={tag.label}\n      data={tag.id}\n      onDelete={edit ? () => onDelete(tag) : null}\n      deleteIcon={(\n        <CancelIcon\n          className={classes.deleteIcon}\n          onClick={e => {\n            console.log('this click')\n          }}\n          style={{\n            opacity: 0.5,\n            color: color ? `${theme.palette.getContrastText(color)}` : null\n          }}\n        />\n      )}\n      className={classes.root}\n      {...props}\n    />\n  )\n}\n\nTagChip.propTypes = {\n  color: PropTypes.string.isRequired,\n  edit: PropTypes.bool,\n  tag: PropTypes.object.isRequired,\n  onDelete: PropTypes.func\n}\n\nexport default TagChip\n","import React from 'react'\nimport classNames from 'classnames'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport FormLabel from '@material-ui/core/FormLabel'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n    position: 'relative',\n    display: 'block',\n    overflow: 'hidden',\n    whiteSpace: 'pre-line',\n    '&::before': {\n      content: '\"  \"',\n      display: 'block',\n      position: 'absolute',\n      bottom: 0,\n      width: '100%',\n      height: 100,\n      background: `linear-gradient(180deg, rgba(255,255,255,0) 0%, ${theme.palette.background.paper} 100%)`\n    }\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst ShortLongText = ({ label, text, height, onClick }) => {\n  const classes = useStyles()\n  return (\n    <div onClick={onClick}>\n      {label && (\n        <FormLabel className={classes.formLabel}>\n          {label}\n        </FormLabel>\n      )}\n      <Typography\n\n        variant='body1'\n        color='inherit'\n        style={{ height }}\n        className={classNames(classes.root)}\n      >\n        {text}\n      </Typography>\n    </div>\n  )\n}\n\nShortLongText.propTypes = {\n  label: PropTypes.string,\n  text: PropTypes.string,\n  height: PropTypes.number,\n  onClick: PropTypes.func\n}\nShortLongText.defaultProps = {\n  height: 100\n}\n\nexport default ShortLongText\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemText from '@material-ui/core/ListItemText'\nimport ListItemAvatar from '@material-ui/core/ListItemAvatar'\nimport Avatar from '@material-ui/core/Avatar'\n// import MenuIcon from '@material-ui/icons/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n  },\n  imgContainer: {\n    // flex: '0 0 50px',\n    // alignSelf: 'flex-start',\n    // height: '100%',\n  },\n  gravatarImg: {\n    objectFit: 'cover',\n    height: '100%',\n    width: '100%'\n  }\n}))\n\nconst UserListItem = ({ user, loading, onAvatarClick, secondary }) => {\n  const classes = useStyles()\n\n  if (loading || !user) return 'LOADING...'\n  // console.log('USER', user)\n\n  return (\n    <ListItem className={classes.root} button={!!onAvatarClick} onClick={onAvatarClick}>\n      <ListItemAvatar className={classes.imgContainer}>\n        <Avatar>\n          <img alt='profile' className={classes.gravatarImg} src={user.gravatar} />\n        </Avatar>\n      </ListItemAvatar>\n      <ListItemText\n        primary={user.username}\n        secondary={secondary}\n      />\n    </ListItem>\n  )\n}\n\nUserListItem.propTypes = {\n  user: PropTypes.object,\n  loading: PropTypes.bool,\n  secondary: PropTypes.string,\n  onAvatarClick: PropTypes.func\n}\n\nexport default UserListItem\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport Dialog from '@material-ui/core/Dialog'\nimport IconButton from '@material-ui/core/IconButton'\nimport DialogTitle from '@material-ui/core/DialogTitle'\n\nimport CloseIcon from '@material-ui/icons/Close'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n\n  },\n  body: {\n    overflow: 'hidden',\n    whiteSpace: 'pre-line',\n    paddingBottom: theme.spacing(1)\n  },\n  title: {\n    background: theme.palette.primary.main,\n    color: theme.palette.primary.contrastText,\n    alignSelf: 'flex-start',\n    width: '100%',\n    margin: 0,\n    display: 'flex',\n    padding: theme.spacing(2)\n  },\n  dlgTitle: {\n    flexGrow: 1\n  },\n  closeButton: {\n    padding: 0,\n    alignSelf: 'flex-start'\n    // color: theme.palette.grey[500]\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst BigText = ({ open, onClose, title, body }) => {\n  const classes = useStyles()\n  return (\n    <Dialog\n      scroll='paper'\n      open={open}\n      fullWidth\n      maxWidth='xl'\n      onClose={onClose}\n      aria-labelledby='simple-dialog-title'\n    >\n      <DialogTitle className={classes.title} disableTypography>\n        <Typography className={classes.dlgTitle}>{title}</Typography>\n        <IconButton color='inherit' className={classes.closeButton} onClick={onClose}>\n          <CloseIcon color='inherit' />\n        </IconButton>\n      </DialogTitle>\n      <DialogContent>\n        <Typography variant='body2' className={classes.body}>{body}</Typography>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nBigText.propTypes = {\n  open: PropTypes.bool,\n  onClose: PropTypes.func,\n  title: PropTypes.string,\n  body: PropTypes.string\n}\n\nexport default BigText\n","import React, { useState, useContext } from 'react'\n// import PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport Divider from '@material-ui/core/Divider'\nimport List from '@material-ui/core/List'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemText from '@material-ui/core/ListItemText'\nimport ListItemAvatar from '@material-ui/core/ListItemAvatar'\nimport Avatar from '@material-ui/core/Avatar'\nimport Typography from '@material-ui/core/Typography'\nimport FormLabel from '@material-ui/core/FormLabel'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport TagChip from '../tags/TagChip'\nimport style from './SeriesInfo.style'\n\nimport ShortLongText from '../controls/ShortLongText'\nimport UserListItem from '../controls/UserListItem'\nimport BigText from '../dialogs/BigText'\nimport { formatDate } from '../../../../lib/datelib'\nimport { ACCESS } from '../../../../config'\nimport SeriesConfigClass from '../../../../lib/SeriesConfig'\n\nimport { SeriesContext } from '../../contexts'\n\nconst DIALOGS = {\n  NOTEVIEW: 'NOTEVIEW'\n}\nconst useStyles = makeStyles(style)\n\nconst SeriesInfo = () => {\n  const classes = useStyles()\n  const { series, seriesConfig } = useContext(SeriesContext)\n  const seriesConfigInst = new SeriesConfigClass(seriesConfig)\n  const [activeDialog, setActiveDialog] = useState(null)\n\n  const newTags = series.photos.reduce((acc, { tags }) => {\n    tags.forEach(tag => {\n      if (!acc[tag.typeId]) {\n        acc[tag.typeId] = {\n          [tag.label]: { ...tag, count: 1 }\n        }\n      }\n      else if (acc[tag.typeId][tag.label]) {\n        const existing = acc[tag.typeId][tag.label]\n        acc[tag.typeId][tag.label] = { ...existing, count: existing.count + 1 }\n      }\n      else acc[tag.typeId][tag.label] = { ...tag, count: 1 }\n    })\n    return acc\n  }, {})\n\n  let metaKeys = []\n  try {\n    metaKeys = series.meta ? Object.keys(JSON.parse(series.meta)) : []\n  }\n  catch (e) {\n    console.error(e)\n  }\n\n  return (\n    <div className={classes.root}>\n      <div className={classes.field}>\n        <FormLabel className={classes.formLabel}>\n      Series Name\n        </FormLabel>\n        <Typography variant='body1' color='inherit'>\n          {series.name}\n        </Typography>\n      </div>\n      {series.note && (\n        <ShortLongText\n          label='Series Note'\n          text={series.note}\n          onClick={() => setActiveDialog(DIALOGS.NOTEVIEW)}\n        />\n      )}\n\n      <Typography className={classes.heading} variant='subtitle1'>Series Summary</Typography>\n      <Divider />\n      <List className={classes.list} dense>\n        <ListItem className={classNames(classes.access, classes[series.access])}>\n          <ListItemText\n            color='inherit'\n            primary={`Series is ${ACCESS[series.access].label}`}\n            secondary={ACCESS[series.access].description}\n          />\n        </ListItem>\n        {series.createdUser && (\n          <UserListItem\n            user={series.createdUser}\n            onAvatarClick={() => seriesConfig.onAvatarClick(series.createdUser.username)}\n            secondary='created this series'\n          />\n        )}\n        <ListItem>\n          <ListItemAvatar>\n            <Avatar className={classes.numPhotos}>\n              {series.photos.length}\n            </Avatar>\n          </ListItemAvatar>\n          <ListItemText\n            primary={series.photos.length > 1 ? 'Photos' : 'Photo'}\n            secondary={series.photos.length > 0 && (\n              <span>\n                {formatDate(series.photos[0].takenOn, 'LL')}\n                <span>&nbsp;&nbsp;</span>to<span>&nbsp;&nbsp;</span>\n                {formatDate(series.photos[series.photos.length - 1].takenOn, 'LL')}\n              </span>\n            )}\n          />\n        </ListItem>\n        <ListItem>\n          <ListItemAvatar>\n            <Avatar className={classes.watchers}>\n              {series.watchers}\n            </Avatar>\n          </ListItemAvatar>\n          <ListItemText primary='Users Watching' />\n        </ListItem>\n        <ListItem>\n          <ListItemText>\n            <FormLabel className={classes.formLabel}>\n              Tags in use (across all photos)\n            </FormLabel>\n            <Divider />\n            {Object.keys(newTags).length === 0 && (\n              <Typography variant='caption'>No photos in this series have tags</Typography>\n            )}\n            {Object.keys(newTags).map((tagKey, idtk) => (\n              <div key={`tagchipkey${idtk}`} className={classes.tagListItem}>\n                <Typography className={classes.subheading} variant='overline'>{seriesConfigInst.getTagType(tagKey).label}</Typography>\n                <Divider />\n                {Object.values(newTags[tagKey]).length > 0\n                  ? (\n                    Object.values(newTags[tagKey]).map((tag, idx) => (\n                      <TagChip\n                        key={`tagchip-${idtk}-${idx}`}\n                        tag={tag}\n                        color={seriesConfigInst.getTagType(tagKey).color}\n                      />\n                    ))\n                  )\n                  : (\n                    <Typography variant='caption'>No photos in this series have tags</Typography>\n                  )\n                }\n              </div>\n            ))}\n          </ListItemText>\n        </ListItem>\n\n      </List>\n\n      {metaKeys.length > 0 && Object.keys(seriesConfig.meta).length > 0 && (\n        <React.Fragment>\n          <FormLabel className={classes.formLabel}>\n            Metadata\n          </FormLabel>\n          <Divider />\n          <List className={classes.list}>\n            {metaKeys.map((key, idx) => seriesConfig.meta[key] ? (\n              <ListItem key={`metadata${idx}`}>\n                <ListItemText\n                  primary={seriesConfig.meta[key].label}\n                  secondary={seriesConfig.meta[key].render(series.meta[key])}\n                />\n              </ListItem>\n            ) : null\n            )}\n          </List>\n        </React.Fragment>\n      )}\n      {activeDialog === DIALOGS.NOTEVIEW && (\n        <BigText\n          open\n          multiline\n          onClose={() => setActiveDialog(null)}\n          title='Series Note'\n          body={series.note}\n        />\n      )}\n    </div>\n  )\n}\n\nSeriesInfo.propTypes = {\n}\n\nexport default SeriesInfo\n","import { ACCESS } from '../../../../config'\nexport default theme => ({\n  root: {\n    margin: theme.spacing(1),\n    backgroundColor: theme.palette.background.paper,\n    paddingBottom: 60 // a little extra room for the FAB\n\n  },\n  field: {\n    marginBottom: theme.spacing(1)\n  },\n  list: {\n    padding: theme.spacing(1)\n  },\n  heading: {\n    marginTop: theme.spacing(1)\n  },\n  watchers: {\n    // backgroundColor: theme.palette.primary.main,\n    // color: theme.palette.primary.contrastText\n  },\n  numPhotos: {\n    backgroundColor: theme.palette.primary.main,\n    color: theme.palette.primary.contrastText\n  },\n  tagListItem: {\n    marginTop: theme.spacing(1),\n    marginBottom: theme.spacing(2)\n  },\n  chip: {\n    margin: theme.spacing(0.5)\n  },\n  access: {\n    padding: theme.spacing(1),\n    borderRadius: theme.spacing(1)\n  },\n  ...Object.keys(ACCESS).reduce((acc, key) => ({\n    ...acc,\n    [key]: {\n      border: `1px solid ${ACCESS[key].color[500]}`,\n      background: `${ACCESS[key].color[700]}`,\n      color: theme.palette.getContrastText(ACCESS[key].color[700])\n    }\n  }), {})\n})\n","import { useCallback, useState, useLayoutEffect, useRef } from 'react'\nimport { debounce } from './util'\n\nconst getSize = (el, minSize, defaultSize) => {\n  if (!el) return defaultSize || minSize || { width: 0, height: 0 }\n\n  if (minSize) {\n    return {\n      width: Math.max(minSize.width, el.offsetWidth),\n      height: Math.max(minSize.height, el.offsetHeight)\n    }\n  }\n  else {\n    return {\n      width: el.offsetWidth,\n      height: el.offsetHeight\n    }\n  }\n}\n\nconst useComponentSize = (ref, minSize, defaultSize) => {\n  const resizeActiveRef = useRef()\n  const [resizeActive, setResizeActive] = useState(true)\n\n  resizeActiveRef.current = resizeActive\n  const [size, setComponentSize] = useState(\n    getSize(ref ? ref.current : null, minSize, defaultSize)\n  )\n\n  const handleResize = () => {\n    if (!resizeActiveRef.current || !ref.current) return\n    const newSize = getSize(ref.current, minSize, defaultSize)\n    if (newSize.height !== size.height || newSize.width !== size.width) {\n      // console.log('handleResize Called', { newSize, size })\n      setComponentSize(newSize)\n    }\n  }\n\n  const handleResizeDebounced = useCallback(\n    debounce(handleResize, 500),\n    []\n  )\n\n  useLayoutEffect(() => {\n    if (!ref.current) return\n    handleResize()\n\n    if (typeof ResizeObserver === 'function') {\n      let resizeObserver = new ResizeObserver(handleResizeDebounced)\n      resizeObserver.observe(ref.current)\n\n      return () => {\n        resizeObserver.disconnect(ref.current)\n        resizeObserver = null\n      }\n    }\n    else {\n      window.addEventListener('resize', handleResizeDebounced)\n\n      return () => {\n        window.removeEventListener('resize', handleResizeDebounced)\n      }\n    }\n  },\n  [ref.current])\n\n  return { size, setResizeActive }\n}\n\nexport default useComponentSize\n","const tagChips = {\n  height: 20\n}\n\nexport default theme => ({\n  xyTagChip: {\n    cursor: 'pointer',\n    color: 'white',\n    fontSize: '0.6em',\n    background: '#444444',\n    height: tagChips.height,\n    position: 'absolute',\n    left: -tagChips.height / 2,\n    top: -tagChips.height / 2\n  },\n  editing: {\n    // color: 'white',\n    // background: theme.palette.secondary.main\n  },\n  // The tag is flipped on the right side of the screen\n  reversedChip: {\n    flexDirection: 'row-reverse',\n    left: 'unset',\n    right: -tagChips.height / 2\n  },\n  deleteIcon: {\n    // color: 'white',\n    width: tagChips.height - 1,\n    height: tagChips.height - 1\n  },\n  chipAvatarIcon: {\n    color: 'white',\n    width: tagChips.height - 4,\n    height: tagChips.height - 4\n  },\n  chipAvatar: {\n    background: 'inherit',\n    width: tagChips.height,\n    height: tagChips.height\n  },\n  reversedDelete: {\n    margin: `0 -${tagChips.height / 8}px 0 ${tagChips.height / 8}px`\n  },\n  // The chip bucket is the container div for the chip and represents the\n  // Actual XY coordinates. The chip itself is offset to make the\n  chipBucket: {\n    width: 1,\n    height: 1,\n    display: 'flex',\n    flexDirection: 'row',\n    position: 'absolute'\n  },\n  reversedChipBucket: {\n    flexDirection: 'row-reverse'\n  }\n})\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport Draggable from 'react-draggable'\n\nimport Chip from '@material-ui/core/Chip'\nimport Avatar from '@material-ui/core/Avatar'\n\nimport CancelIcon from '@material-ui/icons/Cancel'\nimport MyLocation from '@material-ui/icons/MyLocation'\n\nimport { makeStyles, useTheme } from '@material-ui/core/styles'\nimport style from './XYTagChip.style'\n\nconst useStyles = makeStyles(style)\n\nconst XYTagChip = ({\n  color, edit, tag, newSize,\n  onTagDragOver, onTagDragStop, onNewTag, onTagDelete, ...props\n}) => {\n  const isReversed = tag.relCoords.x > newSize.newWidth / 2\n  const classes = useStyles()\n  const theme = useTheme()\n  const stopBadness = (e) => {\n    e.preventDefault()\n    e.stopPropagation()\n  }\n\n  const handleDrag = (e, data) => {\n    stopBadness(e)\n    onTagDragOver(data, tag)\n  }\n  const handleStopDrag = (e, data) => {\n    stopBadness(e)\n    onTagDragStop(data, tag)\n  }\n\n  // Draggable chip if it is editable\n  return (\n    <Draggable\n      disabled={!edit}\n      bounds={{ left: 10, top: 10, right: newSize.newWidth - 10, bottom: newSize.newHeight - 10 }}\n      position={{ x: tag.relCoords.x, y: tag.relCoords.y }}\n      onDrag={handleDrag}\n      onStop={handleStopDrag}\n      onClick={stopBadness}\n    >\n      <div className={classNames(classes.chipBucket, isReversed && classes.reversedChipBucket)}>\n        <Chip\n          style={{\n            background: color ? `${color}!important` : null,\n            color: color ? `${theme.palette.getContrastText(color)}!important` : null\n          }}\n          color={edit ? 'secondary' : 'default'}\n          label={tag.label}\n          data={tag.id}\n          onClick={stopBadness}\n          onDelete={edit ? onTagDelete(tag) : null}\n          deleteIcon={edit ? <CancelIcon className={classNames(classes.deleteIcon, isReversed && classes.reversedDelete)} /> : <div />}\n          className={classNames(\n            classes.xyTagChip,\n            isReversed && classes.reversedChip,\n            edit && classes.editing\n          )}\n          {...props}\n          avatar={<Avatar className={classNames(classes.chipAvatar, edit && classes.editing)}>\n            <MyLocation className={classNames(classes.chipAvatarIcon, edit && classes.editing)} />\n          </Avatar>}\n        />\n      </div>\n    </Draggable>\n  )\n}\n\nXYTagChip.propTypes = {\n  color: PropTypes.string,\n  edit: PropTypes.bool,\n  tag: PropTypes.object.isRequired,\n  newSize: PropTypes.object,\n  onTagDragOver: PropTypes.func,\n  onTagDragStop: PropTypes.func,\n  onNewTag: PropTypes.func,\n  onTagDelete: PropTypes.func\n}\n\nexport default XYTagChip\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\nimport Paper from '@material-ui/core/Paper'\nimport Typography from '@material-ui/core/Typography'\nimport TextField from '@material-ui/core/TextField'\nimport MenuItem from '@material-ui/core/MenuItem'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport Select from 'react-select'\nimport CreatableSelect from 'react-select/lib/Creatable'\nimport style from './XYTagSelect.style'\n\nconst useStyles = makeStyles(style)\n\nconst XYTagSelect = ({ tagConfig, onChange }) => {\n  const classes = useStyles()\n  const options = tagConfig.values.map(tc => ({ label: tc.label, value: tc.id }))\n  console.log('XYTagSelect', tagConfig)\n  return (\n    <div className={classes.root}>\n      {!tagConfig.allowAdditions && (\n        <Select\n          options={options}\n          classes={classes}\n          components={{\n            Control,\n            Menu,\n            NoOptionsMessage,\n            Option,\n            Placeholder,\n            ValueContainer\n          }}\n          value={null}\n          // onBlur={e => e.preventDefault()}\n          blurInputOnSelect\n          isClearable={false}\n          onChange={onChange}\n          placeholder={tagConfig.label}\n          isSearchable\n        />\n      ) }\n      { tagConfig.allowAdditions && (\n        <CreatableSelect\n          options={options}\n          classes={classes}\n          components={{\n            Control,\n            Menu,\n            NoOptionsMessage,\n            Option,\n            Placeholder,\n            ValueContainer\n          }}\n          value={null}\n          isClearable={false}\n          // onBlur={e => e.preventDefault()}\n          blurInputOnSelect\n          onChange={onChange}\n          placeholder={tagConfig.label}\n          isSearchable\n        />\n      )}\n    </div>\n  )\n}\nXYTagSelect.propTypes = {\n  tagConfig: PropTypes.object.isRequired,\n  onChange: PropTypes.func.isRequired\n}\n\nexport default XYTagSelect\n\nfunction Control (props) {\n  return (\n    <TextField\n      fullWidth\n      InputProps={{\n        inputComponent,\n        inputProps: {\n          className: props.selectProps.classes.input,\n          inputRef: props.innerRef,\n          children: props.children,\n          ...props.innerProps\n        }\n      }}\n      {...props.selectProps.textFieldProps}\n    />\n  )\n}\n\nconst NoOptionsMessage = ({ innerProps, selectProps, children }) => (\n  <Typography\n    color='textSecondary'\n    className={selectProps.classes.noOptionsMessage}\n    {...innerProps}\n  >\n    {children}\n  </Typography>\n)\n\nconst Menu = ({ selectProps, innerProps, children }) => (\n  <Paper square className={selectProps.classes.paper} {...innerProps}>\n    {children}\n  </Paper>\n)\n\nconst inputComponent = ({ inputRef, ...props }) => <div ref={inputRef} {...props} />\n\nconst Placeholder = (props) => (\n  <Typography\n    color='textSecondary'\n    className={props.selectProps.classes.placeholder}\n    {...props.innerProps}\n  >\n    {props.children}\n  </Typography>\n)\n\nconst Option = ({ innerRef, isFocused, isSelected, innerProps, children }) => (\n  <MenuItem\n    buttonRef={innerRef}\n    selected={isFocused}\n    component='div'\n    style={{ fontWeight: isSelected ? 500 : 400 }}\n    {...innerProps}\n  >\n    {children}\n  </MenuItem>\n)\n\nconst ValueContainer = ({ selectProps, children }) => (\n  <div className={selectProps.classes.valueContainer}>{children}</div>\n)\nValueContainer.propTypes = {\n  selectProps: PropTypes.object.isRequired,\n  children: PropTypes.any\n}\n","export default theme => ({\n  root: {\n    width: '100%'\n  },\n  noOptionsMessage: {\n    padding: `${theme.spacing(1)}px ${theme.spacing(1) * 2}px`\n  },\n  singleValue: {\n    fontSize: 16\n  },\n  placeholder: {\n    position: 'absolute',\n    left: 2,\n    fontSize: 16\n  },\n  input: {\n    display: 'flex',\n    padding: 0\n  },\n  valueContainer: {\n    display: 'flex',\n    flexWrap: 'wrap',\n    flex: 1,\n    alignItems: 'center',\n    overflow: 'hidden'\n  },\n  paper: {\n    position: 'absolute',\n    zIndex: 100,\n    marginTop: theme.spacing(1),\n    left: 0,\n    right: 0\n  }\n})\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport Typography from '@material-ui/core/Typography'\nimport IconButton from '@material-ui/core/IconButton'\n\nimport CloseIcon from '@material-ui/icons/Close'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport XYTagSelect from './XYTagSelect'\nimport style from './XYTagChooser.style'\n\nconst useStyles = makeStyles(style)\n\nconst XYTagChooser = ({ coords, open, seriesConfig, onNewTag, onClose }) => {\n  const classes = useStyles()\n  const xyTags = seriesConfig.tags.filter(t => t.allowXY)\n  if (!coords) return null\n  return (\n    <Dialog\n      open={open}\n      scroll='paper'\n      fullScreen\n      classes={{ paperScrollPaper: classes.root }}\n      onClose={() => onClose()}\n      aria-labelledby='simple-dialog-title'\n    >\n      <DialogTitle id='simple-dialog-title' className={classes.header}>\n      New Tag:\n        <IconButton className={classes.closeButton} onClick={onClose}>\n          <CloseIcon />\n        </IconButton>\n      </DialogTitle>\n      <div className={classes.dlgBody}>\n        {xyTags.length > 1 && (\n          <Typography variant='caption'>What kind of tag would you like to create?</Typography>\n        )}\n\n        {xyTags.map((tagType, idx) => (\n          <div className={classes.listItem} key={`tagSelect${idx}`}>\n            <XYTagSelect tagConfig={tagType} onChange={onNewTag(coords, tagType)} />\n          </div>\n        ))}\n      </div>\n    </Dialog>\n  )\n}\n\nXYTagChooser.propTypes = {\n  seriesConfig: PropTypes.object.isRequired,\n  open: PropTypes.bool.isRequired,\n  coords: PropTypes.object,\n  onClose: PropTypes.func.isRequired,\n  onNewTag: PropTypes.func.isRequired\n}\n\nexport default XYTagChooser\n","export default theme => ({\n  root: {\n    overflow: 'visible'\n  },\n  header: {\n    padding: theme.spacing(1) * 2\n  },\n  listItem: {\n    flexDirection: 'column'\n  },\n  dlgBody: {\n    paddingLeft: theme.spacing(1) * 2,\n    paddingRight: theme.spacing(1) * 2,\n    paddingBottom: theme.spacing(1) * 2\n  },\n  closeButton: {\n    position: 'absolute',\n    right: theme.spacing(1),\n    top: theme.spacing(1),\n    color: theme.palette.grey[500]\n  }\n})\n","import SeriesConfig from './SeriesConfig'\n\nclass Tags {\n  constructor (seriesConfig, tags) {\n    this.tags = tags\n    this.seriesConfig = new SeriesConfig(seriesConfig)\n  }\n\n  findTagById = (typeId, tagId) => {\n    return this.seriesConfig.getTagType(typeId).values\n      .find(tt => tt.id === tagId)\n  }\n\n  // Filter the list of tags to those that are XY tags\n  getXYTags = () => {\n    const xyTagIds = this.seriesConfig.getXYTagTypes().map(tt => tt.id)\n    return this.tags.filter(tag => xyTagIds.indexOf(tag.typeId) > -1 && tag.coords && tag.coords.x)\n  }\n\n  getNonXYTags = () => {\n    const NonXYTagIds = this.seriesConfig.getNonXYTagTypes().map(tt => tt.id)\n    return this.tags.filter(tag => NonXYTagIds.indexOf(tag.typeId) > -1)\n  }\n\n  createNewTagObj = (label, typeId) => (\n    { label, typeId }\n  )\n\n  createExistingTagObj = (id, typeId) => ({\n    ...this.findTagById(typeId, id),\n    typeId\n  })\n\n  createNewXYTagObj = (label, typeId, coords) => ({\n    label,\n    typeId,\n    coords\n  })\n\n  createExistingXYTagObj = (id, typeId, coords) => ({\n    ...this.findTagById(typeId, id),\n    typeId,\n    coords\n  })\n\n  // Get tags in a way that's easy to render them\n  // We augment these tags with relative positions\n  // and a group number for coloring.\n  getRelXYTags = (multiplier) => this.getXYTags().map(tag => ({\n    ...tag,\n    group: this.seriesConfig.getTagTypeIndex(tag.typeId),\n    relCoords: {\n      x: tag.coords.x * multiplier,\n      y: tag.coords.y * multiplier\n    }\n  }))\n}\n\nexport default Tags\n","import React, { useState, useContext } from 'react'\nimport { SeriesContext } from '../../contexts'\nimport XYTagChooser from './XYTagChooser'\nimport Tags from '../../../../lib/Tags'\n\nconst useXYTags = (photo, newSize, onChange, setResizeActive) => {\n  const { seriesConfig } = useContext(SeriesContext)\n\n  // we hold the tags in state so that every little drag motion\n  // doesn't cause an updated state until you let go\n  const [isDragging, setIsDragging] = useState(false)\n  const [newTagDialog, setNewTagDialog] = useState(null)\n\n  const tagClass = new Tags(seriesConfig, photo.tags)\n\n  const onNewTag = (coords, tagType) => ({ value, __isNew__: isNew }) => {\n    let addTag = isNew\n      ? tagClass.createNewXYTagObj(value, tagType.id, coords)\n      : tagClass.createExistingXYTagObj(value, tagType.id, coords)\n\n    setNewTagDialog(null)\n    onChange({ ...photo, tags: [...photo.tags, addTag] })\n  }\n\n  const onTagDelete = (tag) => () => {\n    const tags = photo.tags.filter(oldTag => oldTag.id !== tag.id)\n    onChange({\n      ...photo,\n      tags\n    })\n  }\n\n  // When the photo is tapped, send the x,y coords of that tap\n  // to a dialog we will open\n  const onAddTagTrigger = (e) => {\n    if (!newTagDialog) {\n      // Turn off resizing so mobile keyboards don't complete F us.\n      setResizeActive(false)\n      setNewTagDialog({\n        x: parseInt(e.pageX - (window.innerWidth - newSize.newWidth) / 2 * newSize.multiplier, 10),\n        y: parseInt(e.pageY - (window.innerHeight - newSize.newHeight) / 2 * newSize.multiplier, 10)\n      })\n    }\n  }\n\n  // This gets used by the drag AND the stop\n  const updateTagLocation = ({ x, y }, tag) => {\n    const newTags = photo.tags.map(oldTag => {\n      if (oldTag.id !== tag.id) return oldTag\n      else {\n        let newX = parseInt(x / newSize.multiplier, 10)\n        let newY = parseInt(y / newSize.multiplier, 10)\n\n        return {\n          ...oldTag,\n          coords: { x: newX, y: newY }\n        }\n      }\n    })\n    return newTags\n  }\n\n  const onTagDragStop = (coords, tag) => {\n    const tags = updateTagLocation(coords, tag)\n    setIsDragging(false)\n    onChange({\n      ...photo,\n      tags\n    })\n  }\n\n  const onTagDragOver = (coords, tag) => {\n    updateTagLocation(coords, tag)\n    setIsDragging(true)\n  }\n  const TagChooser = () => (\n    <XYTagChooser\n      open={!isDragging && Boolean(newTagDialog)}\n      coords={newTagDialog}\n      seriesConfig={seriesConfig}\n      onNewTag={onNewTag}\n      onClose={() => {\n        setNewTagDialog(null)\n        // Turn on resizing again.\n        setResizeActive(true)\n      }}\n    />\n  )\n\n  return {\n    onNewTag,\n    onTagDelete,\n    onAddTagTrigger,\n    onTagDragOver,\n    onTagDragStop,\n    TagChooser,\n    getRelXYTags: tagClass.getRelXYTags\n  }\n}\n\nexport default useXYTags\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport Typography from '@material-ui/core/Typography'\nimport CircularProgress from '@material-ui/core/CircularProgress'\nimport BrokenImageIcon from '@material-ui/icons/BrokenImage'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    height: '100%',\n    padding: theme.spacing(2),\n    display: 'flex',\n    flexDirection: 'column',\n    overflow: 'hidden',\n    opacity: 0.3,\n    textAlign: 'center',\n    color: theme.palette.getContrastText(theme.palette.text.primary),\n    background: theme.palette.text.primary\n  },\n  spacer: {\n    flexGrow: 1\n  },\n  icon: {\n    width: '100%',\n    flex: '1 1 40%',\n    opacity: 0.5\n  },\n  circularProgress: {\n    margin: '0 auto'\n  },\n  primary: {\n    textAlign: 'center',\n    width: '100%'\n  },\n  secondary: {\n    flex: '1 1 30%',\n    width: '100%'\n  }\n}))\n\nconst BrokenImg = ({ loading, className, ...props }) => {\n  const classes = useStyles()\n  return (\n    <div className={classNames(classes.root, className)} {...props}>\n      <div className={classes.spacer} />\n      {loading\n        ? <CircularProgress color='inherit' className={classes.circularProgress} />\n        : <BrokenImageIcon className={classes.icon} color='inherit' />\n      }\n      <Typography className={classes.primary} color='inherit'>\n        {loading ? 'Loading' : 'Photo not found' }\n      </Typography>\n      <div className={classes.spacer} />\n    </div>\n  )\n}\nBrokenImg.propTypes = {\n  loading: PropTypes.bool,\n  className: PropTypes.string\n}\n\nexport default BrokenImg\n","import React, { useState, useEffect } from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport { makeStyles } from '@material-ui/core/styles'\nimport BrokenImg from './BrokenImg'\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    position: 'relative',\n    display: 'block',\n    height: '100%',\n    width: '100%'\n  },\n  img: {\n    display: 'block',\n    height: '100%',\n    width: '100%'\n  },\n  imgBroken: {\n    display: 'none'\n  }\n}))\n\nexport const RawImage = ({ className, getPhotoUrls, sizePriority, dataUrl, photo, imgRef, cover, style, ...props }) => {\n  const classes = useStyles()\n  const [imgUrls, setImgUrls] = useState()\n\n  const [altIndex, setAltIndex] = useState(0)\n  const [broken, setBroken] = useState(false)\n\n  useEffect(() => {\n    if (!dataUrl && photo && getPhotoUrls) {\n      getPhotoUrls(photo, ['large', 'medium']).then(setImgUrls)\n        .catch(() => {\n          setBroken(true)\n        })\n    }\n  }, [photo])\n\n  // If nothing works then show a broken image component\n  const finalURl = dataUrl || (imgUrls && imgUrls[altIndex])\n  return (\n    <React.Fragment>\n      {(!dataUrl && (!imgUrls || broken)) && (\n        <BrokenImg className={className} loading={!broken} {...props} />\n      )}\n      {finalURl && (\n        <img ref={imgRef} className={classNames(className, broken ? classes.imgBroken : classes.img)}\n          alt={sizePriority[altIndex]}\n          style={{\n            ...style,\n            objectFit: cover ? 'cover' : 'contain'\n          }}\n          onError={() => {\n            if (!dataUrl && imgUrls[altIndex + 1]) {\n              console.error('RawImage::Setting Alternate image', altIndex)\n              // Now that uploading works properly retries are dead\n              setAltIndex(altIndex + 1)\n            }\n            else {\n              setBroken(true)\n            }\n          }}\n          // onLoad={onLoad}\n          src={finalURl}\n          {...props}\n        />\n      )}\n    </React.Fragment>\n  )\n}\n\nRawImage.propTypes = {\n  className: PropTypes.string,\n  sizePriority: PropTypes.arrayOf(PropTypes.string),\n  imgRef: PropTypes.any,\n  getPhotoUrls: PropTypes.func,\n  cover: PropTypes.bool,\n  dataUrl: PropTypes.string,\n  // onLoad: PropTypes.func,\n  photo: PropTypes.object,\n  style: PropTypes.object\n}\n\nexport default RawImage\n","import React, { useState, useRef, useContext, useLayoutEffect } from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport useComponentSize from '../../../../lib/useComponentSize'\n\nimport { SeriesContext } from '../../contexts'\nimport XYTagChip from '../tags/XYTagChip'\nimport useXYTags from '../tags/useXYTags'\nimport RawImage from './RawImage'\nimport style from './Photo.style'\n\nconst useStyles = makeStyles(style)\n\nconst Photo = ({ photo, opacity, edit, showTags, dataUrl, transition, onChange, className }) => {\n  const classes = useStyles()\n  const refImgWrap = useRef()\n  const imgRef = useRef()\n  const [newSize, setNewSize] = useState({ multiplier: 1 })\n  const { seriesConfig } = useContext(SeriesContext)\n\n  const { size: { height, width }, setResizeActive } = useComponentSize(refImgWrap)\n\n  // All tag-related info is put in its own hook\n  const { onAddTagTrigger, TagChooser, getRelXYTags, onTagDragOver, onTagDragStop, onTagDelete } = useXYTags(photo, { height, width }, onChange, setResizeActive)\n\n  const handleNewSize = () => {\n    console.log('handleImageLoaded')\n    const { naturalHeight, naturalWidth } = imgRef.current\n    // 4 different cases of orientation:\n    const multiplier = Math.min(\n      height / naturalHeight,\n      width / naturalWidth\n    )\n\n    const newWidth = multiplier * naturalWidth\n    const newHeight = multiplier * naturalHeight\n    setNewSize({ newWidth, newHeight, naturalWidth, naturalHeight, multiplier })\n  }\n  useLayoutEffect(() => {\n    if (imgRef.current) handleNewSize()\n  }, [width, height])\n\n  return (\n    <div className={classNames(classes.root, className)}\n      style={{ opacity: opacity !== null ? opacity : 1 }}\n      ref={refImgWrap}\n    >\n      <div className={classes.inner}\n        style={{\n          height: newSize ? newSize.newHeight : 1,\n          width: newSize ? newSize.newWidth : 1\n        }}\n        onClick={onAddTagTrigger}\n      >\n        { showTags || edit\n          ? (\n            <div className={className}>\n              { getRelXYTags(newSize.multiplier).map((tag, idx) => (\n                <XYTagChip\n                  key={`xytag-${idx}`}\n                  color={tag.color}\n                  {...{ edit, newSize, tag, onTagDragOver, onTagDragStop, onTagDelete }} />\n              ))}\n            </div>\n          ) : null\n        }\n        <RawImage\n          className={classes.rawImage}\n          sizePriority={['large', 'medium', 'thumb']}\n          photo={photo}\n          imgRef={imgRef}\n          dataUrl={dataUrl}\n          getPhotoUrls={seriesConfig.getPhotoUrls}\n          style={{ height: newSize.newHeight, width: newSize.newWidth }}\n        />\n\n      </div>\n      {edit && <TagChooser />}\n    </div>\n  )\n}\n\nPhoto.propTypes = {\n  className: PropTypes.string,\n  opacity: PropTypes.number,\n  photo: PropTypes.object.isRequired,\n  dataUrl: PropTypes.string,\n  edit: PropTypes.bool,\n  showTags: PropTypes.bool,\n  transition: PropTypes.string,\n  onChange: PropTypes.func\n}\n\nexport default Photo\n","// import { fade } from '@material-ui/core/styles/colorManipulator'\nexport default theme => ({\n  root: {\n    // maxWidth: 400,\n    display: 'block',\n    position: 'relative',\n    width: '100%',\n    height: '100%',\n    background: 'black',\n    overflow: 'hidden'\n  },\n  inner: {\n    width: '100%',\n    height: '100%'\n    // position: 'absolute',\n    // top: '50%',\n    // left: '50%',\n    // transform: 'translateY(-50%) translateX(-50%)'\n    // // overflow: 'hidden'\n  },\n  xyTags: {\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    // opacity: 0.8,\n    // border: '4px solid red',\n    height: '100%',\n    width: '100%'\n    // background: 'rgba(150, 150, 150, 0.5)'\n  },\n  img: {\n    display: 'block'\n  },\n  brokenImg: {\n    display: 'none'\n  },\n  formControl: {\n    width: '100%'\n  }\n})\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\n\nimport MobileStepper from '@material-ui/core/MobileStepper'\nimport IconButton from '@material-ui/core/IconButton'\nimport GridListTileBar from '@material-ui/core/GridListTileBar'\nimport Badge from '@material-ui/core/Badge'\n\nimport LabelIcon from '@material-ui/icons/Label'\n// import RemoveRedEye from '@material-ui/icons/RemoveRedEye'\nimport KeyboardArrowLeft from '@material-ui/icons/KeyboardArrowLeft'\nimport KeyboardArrowRight from '@material-ui/icons/KeyboardArrowRight'\n\nimport SwipeableViews from 'react-swipeable-views'\nimport Photo from './Photo'\nimport { formatDate } from '../../../../lib/datelib'\nimport { makeStyles, useTheme } from '@material-ui/core/styles'\nimport style from './SwipeShow.style'\n\nconst useStyles = makeStyles(style)\n\nconst SwipeShow = ({ photos, initialPhoto, onImageSelect }) => {\n  const classes = useStyles()\n  const theme = useTheme()\n  const initPhotoIndex = initialPhoto ? photos.findIndex(p => p.id === initialPhoto) || 0 : 0\n  const [activePhoto, setActivePhoto] = useState(initPhotoIndex >= 0 ? initPhotoIndex : 0)\n  const [showTags, setShowTags] = useState(false)\n  const singular = photos.length < 2\n\n  const sortedPhotos = [...photos]\n  sortedPhotos.sort((a, b) => parseInt(b.takenOn, 10) - parseInt(a.takenOn, 10))\n\n  const handleForward = () => setActivePhoto(activePhoto >= sortedPhotos.length ? 0 : activePhoto + 1)\n  const handleBack = () => setActivePhoto(activePhoto <= 0 ? sortedPhotos.length - 1 : activePhoto - 1)\n\n  return (\n    <div className={classes.root}>\n      <div className={classes.inner}>\n        <SwipeableViews\n          axis={theme.direction === 'rtl' ? 'x-reverse' : 'x'}\n          index={activePhoto}\n          onChangeIndex={(val) => setActivePhoto(val)}\n          enableMouseEvents\n        >\n          {sortedPhotos.map((photo, idx) => (\n            <div className={classes.photoWrapper} key={`swipeshowpic-${idx}`} onClick={() => onImageSelect(sortedPhotos[activePhoto].id)}>\n              <Photo photo={photo} className={classes.photo} showTags={showTags} />\n            </div>\n          ))}\n        </SwipeableViews>\n        <IconButton size='small' className={classes.manualBack} onClick={handleBack} color='inherit' disabled={activePhoto === 0}>\n          {theme.direction === 'rtl' ? <KeyboardArrowRight /> : <KeyboardArrowLeft />}\n        </IconButton>\n        <IconButton size='small' className={classes.manualForward} onClick={handleForward} color='inherit' disabled={activePhoto === photos.length - 1}>\n          {theme.direction === 'rtl' ? <KeyboardArrowLeft /> : <KeyboardArrowRight />}\n        </IconButton>\n        <GridListTileBar\n          title={singular ? 'Photo' : `Photo (${activePhoto + 1}/${sortedPhotos.length})`}\n          subtitle={sortedPhotos.length > 0 && (\n            <span>{formatDate(sortedPhotos[activePhoto].takenOn)}</span>\n          )}\n          actionIcon={\n            <React.Fragment>\n              <IconButton className={classes.tagButton} onClick={() => setShowTags(!showTags)}>\n                <Badge color={showTags ? 'primary' : 'secondary'} badgeContent={sortedPhotos[activePhoto].tags ? sortedPhotos[activePhoto].tags.filter(tag => tag.coords).length : null}>\n                  <LabelIcon />\n                </Badge>\n              </IconButton>\n            </React.Fragment>\n          }\n        />\n      </div>\n      {!singular &&\n      <MobileStepper\n        steps={sortedPhotos.length}\n        position='static'\n        activeStep={activePhoto}\n        classes={{\n          root: classes.mobileStepper,\n          dots: classes.dots\n        }}\n      />\n      }\n    </div>\n  )\n}\n\nSwipeShow.propTypes = {\n  // This is just the basic shape of the photo object\n  initialPhoto: PropTypes.string,\n  photos: PropTypes.arrayOf(PropTypes.shape({\n    img: PropTypes.string,\n    tags: PropTypes.array,\n    date: PropTypes.date\n  })),\n  transition: PropTypes.number,\n  onImageSelect: PropTypes.func.isRequired\n}\n\nSwipeShow.defaultProps = {\n  transition: 5000,\n  isFullScreen: false,\n  slides: []\n}\n\nexport default SwipeShow\n","export default theme => ({\n  root: {\n    position: 'relative'\n  },\n  inner: {\n    position: 'relative'\n  },\n  photoWrapper: {\n    minHeight: 250,\n    height: 250\n  },\n  dateCaption: {\n    padding: theme.spacing(1),\n    background: theme.palette.primary.dark,\n    color: theme.palette.primary.contrastText,\n    textAlign: 'center'\n  },\n  mobileStepper: {\n    // position: 'absolute',\n    // bottom: theme.spacing(1),\n    // right: theme.spacing(1)\n  },\n  manualBack: {\n    color: 'white',\n    zIndex: 10,\n    position: 'absolute',\n    transform: 'translateY(-50%)',\n    left: 0,\n    top: '50%'\n  },\n  manualForward: {\n    color: 'white',\n    zIndex: 10,\n    position: 'absolute',\n    transform: 'translateY(-50%)',\n    right: 0,\n    top: '50%'\n  },\n  tagButton: {\n    color: 'rgba(255, 255, 255, 0.54)'\n  },\n  slideshowButton: {\n    color: 'rgba(255, 255, 255, 0.54)'\n  },\n  dots: {\n    margin: '0 auto'\n  }\n})\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport Button from '@material-ui/core/Button'\nimport Typography from '@material-ui/core/Typography'\nimport DialogActions from '@material-ui/core/DialogActions'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n\n})\nconst useStyles = makeStyles(style)\n\nconst DeleteDialog = ({ title, message, onConfirm, open }) => {\n  const classes = useStyles()\n  return (\n    <Dialog\n      className={classes.root}\n      disableBackdropClick\n      open={open}\n      disableEscapeKeyDown\n      fullWidth\n      maxWidth='xl'\n      aria-labelledby='confirmation-dialog-title'\n    >\n      <DialogTitle id='confirmation-dialog-title'>{title}</DialogTitle>\n      <DialogContent>\n        <Typography>\n          {message}\n        </Typography>\n\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={() => onConfirm(false)} color='primary'>\n      No\n        </Button>\n        <Button onClick={() => onConfirm(true)} color='primary'>\n      Yes\n        </Button>\n      </DialogActions>\n    </Dialog>\n  )\n}\n\nDeleteDialog.propTypes = {\n  open: PropTypes.bool,\n  title: PropTypes.string.isRequired,\n  message: PropTypes.string.isRequired,\n  onConfirm: PropTypes.func.isRequired\n}\n\nexport default DeleteDialog\n","import React, { useState, useContext, useEffect } from 'react'\nimport classNames from 'classnames'\nimport PropTypes from 'prop-types'\n\nimport GridList from '@material-ui/core/GridList'\nimport GridListTile from '@material-ui/core/GridListTile'\nimport GridListTileBar from '@material-ui/core/GridListTileBar'\nimport Snackbar from '@material-ui/core/Snackbar'\nimport Button from '@material-ui/core/Button'\nimport Fab from '@material-ui/core/Fab'\n\nimport AddIcon from '@material-ui/icons/Add'\nimport RemoveIcon from '@material-ui/icons/Remove'\n\nimport { SeriesContext } from '../../contexts'\nimport RawImage from './RawImage'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport style from './PhotoGrid.style'\nimport DeleteDialog from '../dialogs/DeleteDialog'\nimport { formatDate } from '../../../../lib/datelib'\n\nconst useStyles = makeStyles(style)\n\nconst PhotoGrid = ({ photos, columns, multiSelect, onDelete, onTileClick }) => {\n  const [selectMode, setSelectMode] = useState(false)\n  const classes = useStyles()\n  const [selectedItems, setSelectedItems] = useState([])\n  const [urls, setUrls] = useState({})\n  const [deleteConfirm, setDeleteConfirm] = useState(false)\n\n  const { seriesConfig, ac } = useContext(SeriesContext)\n\n  const handleAddToSelection = (e, id) => {\n    e.preventDefault()\n    e.stopPropagation()\n\n    setSelectMode(true)\n    toggleListItem(id)\n  }\n\n  const handleCancelSelection = () => {\n    setSelectMode(false)\n    setSelectedItems([])\n  }\n\n  const onDeleteConfirm = (confirmation) => {\n    setDeleteConfirm(false)\n    if (confirmation === true && selectedItems.length < photos.length) onDelete(selectedItems)\n    handleCancelSelection()\n  }\n\n  const toggleListItem = (id) => {\n    const index = selectedItems.indexOf(id)\n    if (index < 0) setSelectedItems([...selectedItems, id])\n    else {\n      const remaining = selectedItems.filter(arrId => arrId !== id)\n      if (remaining.length === 0) handleCancelSelection()\n      setSelectedItems(remaining)\n    }\n  }\n\n  useEffect(() => {\n    photos.forEach(async ph => {\n      setUrls({ ...urls, [ph.id]: await seriesConfig.getPhotoUrls(ph, 'thumb') })\n    })\n  }, [photos])\n\n  const handlePhotoTap = (e, photo) => {\n    e.preventDefault()\n    e.stopPropagation()\n    // Select / deselect the item in edit mode\n    if (selectMode) toggleListItem(photo.id)\n    // navigate if tileClick selected\n    else onTileClick(photo.id)\n  }\n\n  const sortedPhotos = [...photos]\n  sortedPhotos.sort((a, b) => parseInt(b.takenOn, 10) - parseInt(a.takenOn, 10))\n\n  return (\n    <div>\n      <GridList cols={columns} cellHeight={200} className={classes.root}>\n        {sortedPhotos.map((photo, idx) => {\n          const selected = selectedItems.indexOf(photo.id) > -1\n\n          const canDelete = ac.canUser('delete', photo, 'photo')\n\n          return (\n            <GridListTile\n              key={`gridTile${idx}`}\n              onClick={(e) => canDelete && handlePhotoTap(e, photo)}\n              className={classNames(\n                classes.tile,\n                selectMode && !canDelete && classes.notDeleteable,\n                selectMode && canDelete && !selected && classes.unSelectedTile,\n                selectMode && selected && classes.selectedTile\n              )}\n            >\n              <RawImage\n                photo={photo}\n                sizePriority={['medium', 'thumb', 'large']}\n                cover\n                getPhotoUrls={seriesConfig.getPhotoUrls}\n                className={classes.img}\n              />\n\n              {canDelete && multiSelect && (\n                <Fab size='small' aria-label='Add' className={classes.addFab} onClick={(e) => handleAddToSelection(e, photo.id)}>\n                  {!selectMode || !selected ? <AddIcon /> : <RemoveIcon />}\n                </Fab>\n              )}\n              <GridListTileBar\n                title={<span>{formatDate(photo.takenOn)}</span>}\n              />\n            </GridListTile>\n          )\n        })}\n      </GridList>\n      <Snackbar\n        open={selectMode}\n        autoHideDuration={null}\n        ContentProps={{\n          'aria-describedby': 'snackbar-fab-message-id',\n          className: classes.snackbarContent\n        }}\n        message={<span id='snackbar-fab-message-id'>\n          {selectedItems.length >= photos.length ? 'You can\\'t delete all the photos. delete the series instead.' : `${selectedItems.length} Photos selected`}\n        </span>}\n        action={<div>\n          <Button color='inherit' disabled={selectedItems.length >= photos.length} size='small' onClick={() => setDeleteConfirm(true)}>\n                Delete\n          </Button>\n          <Button color='inherit' size='small' onClick={() => handleCancelSelection()}>\n                Cancel\n          </Button>\n        </div>\n        }\n        className={classes.snackbar}\n      />\n\n      <DeleteDialog\n        open={deleteConfirm}\n        onConfirm={onDeleteConfirm}\n        title={`Delete ${selectedItems.length} Photos`}\n        message='Are you sure you want to delete these photos?'\n      />\n    </div>\n\n  )\n}\n\nPhotoGrid.propTypes = {\n  photos: PropTypes.array.isRequired,\n  columns: PropTypes.number,\n\n  multiSelect: PropTypes.bool,\n  onDelete: PropTypes.func,\n  onTileClick: PropTypes.func.isRequired\n}\nPhotoGrid.defaultProps = {\n  multiSelect: true,\n  columns: 2\n}\n\nexport default PhotoGrid\n","import { red } from '@material-ui/core/colors'\nexport default theme => ({\n  root: {\n\n  },\n  tile: {\n\n  },\n  addFab: {\n    position: 'absolute',\n    zIndex: 10,\n    top: theme.spacing(1),\n    left: theme.spacing(1),\n    opacity: 0.3\n  },\n  notDeleteable: {\n    background: theme.palette.primary.dark,\n    opacity: 0.1\n    // '& img': {\n    // }\n  },\n  unSelectedTile: {\n    '& img': {\n      opacity: 0.7\n    }\n  },\n  selectedTile: {\n    padding: `${theme.spacing(2)}px!important`,\n    '& img': {\n      opacity: 1\n    }\n  },\n  img: {\n\n  },\n  snackbarContent: {\n    backgroundColor: red[700]\n  },\n  snackbar: {\n  }\n})\n","export default theme => ({\n  root: {\n    display: 'flex',\n    height: '100%',\n    flexDirection: 'column',\n    overflow: 'hidden'\n  },\n  appBar: {\n    flexGrow: 0\n  },\n  inner: {\n    position: 'relative',\n    flexGrow: 1,\n    overflowY: 'scroll',\n    '-webkit-overflow-scrolling': 'touch'\n  },\n  tabMenu: {\n    marginTop: theme.spacing(7)\n  },\n  mapWrap: {\n    position: 'absolute',\n    height: '100%',\n    width: '100%',\n    top: 0,\n    left: 0\n  },\n  toolbarTitle: {\n    flexGrow: 1,\n    textOverflow: 'ellipsis',\n    whiteSpace: 'nowrap',\n    overflow: 'hidden'\n  },\n  AddFab: {\n    position: 'absolute',\n    bottom: theme.spacing(2),\n    right: theme.spacing(2),\n    // left: '50%',\n    // transformOrigin: '0% 50%',\n    // transform: 'translateY(-25%) translateX(-50%)',\n    zIndex: 500\n  },\n  grow: {\n    flexGrow: 1\n  },\n  gridList: {\n    flexWrap: 'nowrap',\n    // Promote the list into his own layer on Chrome. This cost memory but helps keeping high FPS.\n    transform: 'translateZ(0)'\n  },\n  titleBar: {\n    display: 'flex',\n    padding: theme.spacing(1)\n  },\n  menuButton: {\n    // marginLeft: -12,\n    // marginRight: 20\n  },\n  placeholderInner: {\n    position: 'relative',\n    flexGrow: 1,\n    overflow: 'hidden',\n    textAlign: 'center',\n    display: 'flex',\n    height: '100%',\n    flexDirection: 'column'\n  },\n  progressWrapper: {\n    textAlign: 'center',\n    marginBottom: theme.spacing(4)\n  },\n  placeholderText: {\n    opacity: 0.4\n  },\n  placeholder: {\n\n  },\n  progress: {\n    color: theme.palette.grey[300]\n  }\n})\n","import React, { useState, useContext } from 'react'\nimport PropTypes from 'prop-types'\n\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport AppBar from '@material-ui/core/AppBar'\nimport Toolbar from '@material-ui/core/Toolbar'\nimport IconButton from '@material-ui/core/IconButton'\nimport Typography from '@material-ui/core/Typography'\nimport Tabs from '@material-ui/core/Tabs'\nimport Tab from '@material-ui/core/Tab'\n\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack'\n\nimport AddCameraIcon from '@material-ui/icons/AddAPhoto'\nimport MoreIcon from '@material-ui/icons/MoreVert'\n\nimport AddAlertIcon from '@material-ui/icons/AddAlert'\nimport SlideshowIcon from '@material-ui/icons/Slideshow'\nimport EditIcon from '@material-ui/icons/Edit'\n// import PhotoLibraryIcon from '@material-ui/icons/PhotoLibrary'\n// import CameraIcon from '@material-ui/icons/Camera'\nimport DeleteIcon from '@material-ui/icons/Delete'\nimport PlaceIcon from '@material-ui/icons/Place'\nimport QRDisplay from './QRDisplay'\nimport QRCodeIcon from '../../../icons/QRCode'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\n// import MapDot from '../../maps/MapDot'\nimport AddFab from './controls/AddFab'\n\nimport ContextMenu from './controls/ContextMenu'\n\nimport SeriesInfo from './subViews/SeriesInfo'\nimport SwipeShow from './subViews/SwipeShow'\nimport PhotoGrid from './subViews/PhotoGrid'\n\nimport DeleteDialog from './dialogs/DeleteDialog'\n\nimport { SeriesContext } from '../contexts'\n\nimport style from './SeriesView.style'\nconst useStyles = makeStyles(style)\n\nconst SeriesView = ({\n  onSlideshowStart, onChange,\n  onEditSeries, onDeletePhotos, onCameraAdd,\n  onDeleteSeries, onLibraryAdd, onTileClick, onMenuBack,\n  onWatch, onUnWatch, initialPhoto, onFindOnMap,\n  watching, owned\n}) => {\n  const classes = useStyles()\n  const [contextEl, setContextEl] = useState()\n  const [showQR, setShowQR] = useState(false)\n  const [deleteConfirm, setDeleteConfirm] = useState(false)\n  const [listTypeTab, setListTypeTab] = useState(0)\n  const { series, ac } = useContext(SeriesContext)\n\n  const onDeleteConfirm = (confirmation) => {\n    setDeleteConfirm(false)\n    if (confirmation === true) onDeleteSeries(series.id)\n  }\n\n  const viewport = { zoom: 16 }\n  if (series && series.coords && series.coords.length === 2) {\n    viewport.longitude = series.coords[0]\n    viewport.latitude = series.coords[1]\n  }\n\n  const can = {\n    update: ac.canUser('update', series, 'series', '*'),\n    delete: ac.canUser('delete', series, 'series', '*'),\n    contribute: ac.canUser('update', series, 'series', ['photos'])\n  }\n  const dialogOpen = deleteConfirm || showQR\n\n  return (\n    <div className={classes.root}>\n      <CssBaseline />\n      <AppBar position='static' className={classes.appBar}>\n        <Toolbar disableGutters>\n          <IconButton className={classes.menuButton} color='inherit' onClick={onMenuBack} aria-label='Menu'>\n            <ArrowBackIcon />\n          </IconButton>\n          <Typography variant='subtitle1' color='inherit' className={classes.toolbarTitle}>\n            {series.name || 'Series'}\n          </Typography>\n\n          {/* <IconButton className={classes.menuButton} color='inherit' onClick={onSlideshowStart} aria-label='Menu'>\n            <SlideshowIcon />\n          </IconButton> */}\n          <IconButton\n            aria-haspopup='true'\n            color='inherit'\n            onClick={event => setContextEl(event.currentTarget)}\n          >\n            <MoreIcon />\n          </IconButton>\n\n          <ContextMenu anchorEl={contextEl} onClose={() => setContextEl(null)} menuItems={[\n            {\n              text: 'Find on map',\n              icon: PlaceIcon,\n              hide: !onFindOnMap,\n              action: onFindOnMap\n            },\n            {\n              text: 'Watch Series',\n              icon: AddAlertIcon,\n              hide: !onWatch || owned || watching,\n              action: onWatch\n            },\n            {\n              text: 'Unwatch Series',\n              icon: AddAlertIcon,\n              hide: !onUnWatch || owned || !watching,\n              action: onUnWatch\n            },\n            {\n              text: 'Series QR Code',\n              icon: QRCodeIcon,\n              action: () => setShowQR(true)\n            },\n            {\n              text: 'Start Slideshow',\n              icon: SlideshowIcon,\n              hide: !onSlideshowStart,\n              action: onSlideshowStart\n            },\n            { divider: true },\n            {\n              text: 'Edit Series',\n              icon: EditIcon,\n              hide: !onEditSeries || !can.update,\n              action: onEditSeries\n            },\n            {\n              text: 'Delete Series',\n              icon: DeleteIcon,\n              hide: !setDeleteConfirm || !can.delete,\n              color: 'error',\n              action: () => setDeleteConfirm(true)\n            }\n          ]} />\n        </Toolbar>\n        <Tabs variant='fullWidth'\n          value={listTypeTab}\n          onChange={(e, value) => setListTypeTab(value)}\n        >\n          <Tab label='Series' />\n          {/* <Tab label='Map' /> */}\n          <Tab label='Photos' />\n        </Tabs>\n      </AppBar>\n\n      <div className={classes.inner}>\n        {listTypeTab === 0 && (\n          <React.Fragment>\n            {series.photos && series.photos.length > 0 && (\n              <SwipeShow\n                photos={series.photos}\n                initialPhoto={initialPhoto}\n                onImageSelect={onTileClick}\n              />\n            )}\n            <SeriesInfo onChange={onChange} />\n          </React.Fragment>\n        )}\n        {series.photos && listTypeTab === 1 && (\n          <PhotoGrid\n            photos={series.photos}\n            onTileClick={onTileClick}\n            onDelete={onDeletePhotos}\n          />\n        )}\n      </div>\n\n      {/* {listTypeTab === 1 && (\n        <MapDot\n          showMe\n          longitude={series.longitude}\n          latitude={series.latitude}\n          viewport={viewport}\n          direction={series.direction}\n        />\n      )} */}\n\n      {listTypeTab === 0 && can.contribute && (\n        <AddFab\n          className={classes.AddFab}\n          disabled={!dialogOpen}\n          onCameraClick={onCameraAdd}\n          onLibraryClick={onLibraryAdd}\n        >\n          <AddCameraIcon />\n        </AddFab>\n      )}\n      <QRDisplay open={showQR} onClose={() => setShowQR(false)} />\n      <DeleteDialog\n        open={deleteConfirm}\n        onConfirm={onDeleteConfirm}\n        title='Delete Series'\n        message='Are you sure you want to delete this series? The record and all images associated with it will be gone forever.'\n      />\n    </div>\n  )\n}\n\nSeriesView.propTypes = {\n  initialPhoto: PropTypes.string,\n  watching: PropTypes.bool,\n  owned: PropTypes.bool,\n  // Action functions\n  onSlideshowStart: PropTypes.func.isRequired,\n  onChange: PropTypes.func.isRequired,\n  onFindOnMap: PropTypes.func.isRequired,\n  onDeletePhotos: PropTypes.func.isRequired,\n  onDeleteSeries: PropTypes.func.isRequired,\n  onCameraAdd: PropTypes.func.isRequired,\n  onEditSeries: PropTypes.func.isRequired,\n  onLibraryAdd: PropTypes.func.isRequired,\n  onTileClick: PropTypes.func.isRequired,\n  onMenuBack: PropTypes.func.isRequired,\n  onWatch: PropTypes.func,\n  onUnWatch: PropTypes.func\n}\n\nexport default SeriesView\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n    width: 1,\n    height: 1,\n    zIndex: 1\n  },\n  svgDot: {\n    width: 20,\n    height: 20,\n    position: 'absolute',\n    top: '50%',\n    left: '50%',\n    textAlign: 'center',\n    transformOrigin: '50% 50%',\n    transform: 'translateY(-50%) translateX(-50%)'\n  },\n  svgAccuracyDot: {\n    position: 'absolute',\n    top: '50%',\n    left: '50%',\n    textAlign: 'center',\n    transformOrigin: '50% 50%',\n    transform: 'translateY(-50%) translateX(-50%)'\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst MyLocation = ({ position, projection }) => {\n  const classes = useStyles()\n  const accuracy = 20 // assume 20m to start\n  // metersPerPixel [12, 12, 12]\n  // pixelsPerMeter [0: 0.08029229250399847, 1: -0.08029229250399847, 2: 0.08029229250399847]\n  // console.log('POSITION', { position, projection })\n  const accHeight = projection.pixelsPerMeter[0] * (accuracy)\n  const accWidth = projection.pixelsPerMeter[1] * (accuracy)\n  return (\n    <div className={classes.root}>\n      {/* This is the accuracy radius */}\n      <svg\n        style={{ height: accHeight, width: accWidth }}\n        className={classes.svgAccuracyDot}\n        version='1.1'\n        viewBox='0, 0, 100, 100'\n      >\n        <circle cx='50' cy='50' r={49}\n          stroke='#8888FF'\n          fillOpacity='0.4'\n          strokeWidth='1'\n          fill='#AAAAFF'\n        />\n      </svg>\n      {/* This is the dot */}\n      <svg className={classes.svgDot} version='1.1' viewBox='0, 0, 10, 10'>\n        <circle cx='5' cy='5' r='4'\n          stroke='#FFFFFF'\n          strokeWidth='1'\n          fill='#4444FF'\n        />\n      </svg>\n    </div>\n  )\n}\n\nMyLocation.propTypes = {\n  position: PropTypes.object,\n  projection: PropTypes.object\n}\n\nexport default MyLocation\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\nimport SpeedDial from '@material-ui/lab/SpeedDial'\nimport SpeedDialAction from '@material-ui/lab/SpeedDialAction'\n// import MapLayersIcon from '@material-ui/icons/Layers'\nimport { makeStyles, useTheme } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n    zIndex: 10,\n    position: 'absolute'\n  },\n  speedDialFab: {\n    border: '2px solid',\n    background: theme.palette.text.primary,\n    color: theme.palette.primary.contrastText,\n    width: 40,\n    height: 40\n  },\n  speedDialAction: {\n    border: '2px solid',\n    background: theme.palette.primary.main,\n    color: theme.palette.primary.contrastText,\n    marginTop: 0,\n    marginBottom: 0\n  },\n  speedDialIcon: {\n    // border: '1px solid red'\n  },\n  speedDialLabel: {\n    background: 'black',\n    color: 'white'\n  },\n  actionsClosed: {\n    display: 'none'\n  }\n})\n\nconst useStyles = makeStyles(style)\n\nconst StyleButtons = ({ controlPadding, currStyle, mapStyles, setCurrStyle }) => {\n  const [open, setOpen] = useState(false)\n  const classes = useStyles()\n  const theme = useTheme()\n  const noEventSetOpen = (e, state) => {\n    console.log('noEventSetOpen', e, state)\n    e.preventDefault()\n    e.stopPropagation()\n    setOpen(state)\n  }\n\n  if (!mapStyles || !Array.isArray(mapStyles) || mapStyles.length < 2 || !mapStyles[currStyle]) return null\n\n  const currStyleObj = mapStyles[currStyle]\n  const ActiveIcon = currStyleObj.ActiveIcon\n\n  return (\n    <div className={classes.root} style={{\n      top: controlPadding.top ? controlPadding.top : theme.spacing(2),\n      right: controlPadding.right ? controlPadding.right : theme.spacing(2)\n    }}>\n      {mapStyles.length > 1 && (\n        <SpeedDial\n          ariaLabel='SpeedDial example'\n          className={classes.speedDial}\n          classes={{\n            fab: classes.speedDialFab,\n            actionsClosed: classes.actionsClosed\n          }}\n          icon={<ActiveIcon className={classes.icon} />}\n          // onBlur={(e) => noEventSetOpen(e, false)}\n          onClick={(e) => noEventSetOpen(e, !open)}\n          onClose={(e) => noEventSetOpen(e, false)}\n          // onFocus={(e) => noEventSetOpen(e, true)}\n          // onMouseEnter={(e) => noEventSetOpen(e, true)}\n          // onMouseLeave={(e) => noEventSetOpen(e, false)}\n          open={open}\n          direction='left'\n        >\n\n          {mapStyles.map(({ Icon, ActiveIcon, toolTip }, idx) => (\n            <SpeedDialAction\n              key={`stylebutton${idx}`}\n              // Bit of a hack here. This function isn't quite ready for primetime\n              icon={<Icon className={classes.speedDialIcon} />}\n              tooltipPlacement='bottom'\n              ButtonProps={{\n                classes: {\n                  root: classes.speedDialAction\n                }\n              }}\n              TooltipClasses={{\n                tooltip: classes.speedDialLabel\n              }}\n              tooltipTitle={toolTip}\n              tooltipOpen\n              onClick={() => {\n                setCurrStyle(idx)\n                setOpen(false)\n              }}\n            />\n          ))}\n\n        </SpeedDial>\n      ) }\n    </div>\n  )\n}\n\nStyleButtons.propTypes = {\n  // controlPadding: {top, right, bottom, left}\n  controlPadding: PropTypes.object,\n  currStyle: PropTypes.number,\n  mapStyles: PropTypes.array,\n  setCurrStyle: PropTypes.func\n}\nStyleButtons.defaultProps = {\n  controlPadding: {}\n}\n\nexport default StyleButtons\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Fab from '@material-ui/core/Fab'\nimport MyLocationIcon from '@material-ui/icons/MyLocation'\n\nimport { makeStyles, useTheme } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n    border: '1px solid',\n    background: theme.palette.grey[100],\n    color: 'black',\n    width: 40,\n    height: 40,\n    zIndex: 10,\n    position: 'absolute'\n    // margin: theme.spacing(0.5),\n    // padding: theme.spacing(0.5),\n    // border: '2px solid',\n    // borderRadius: theme.spacing(1),\n    // background: theme.palette.common.white,\n    // fontSize: 20,\n    // position: 'absolute',\n    // bottom: theme.spacing(10),\n    // right: theme.spacing(2)\n  }\n})\n\nconst useStyles = makeStyles(style)\n\nconst MyLocationButton = ({ onClick, controlPadding, disabled }) => {\n  const classes = useStyles()\n  const theme = useTheme()\n  return (\n    <Fab\n      disabled={disabled}\n      style={{\n        top: 56 + (controlPadding.top ? controlPadding.top : theme.spacing(2)),\n        right: controlPadding.right ? controlPadding.right : theme.spacing(2)\n      }}\n      aria-label='myLocation'\n      className={classes.root}\n      onClick={onClick}\n    >\n      <MyLocationIcon />\n    </Fab>\n  )\n}\n\nMyLocationButton.propTypes = {\n  controlPadding: PropTypes.object,\n  onClick: PropTypes.func.isRequired,\n  disabled: PropTypes.bool\n}\n\nexport default MyLocationButton\n","import React, { useState, useRef, useMemo, useEffect } from 'react'\nimport ReactMapGL, { NavigationControl, Marker, FlyToInterpolator } from 'react-map-gl'\nimport PropTypes from 'prop-types'\nimport { easeCubic } from 'd3-ease'\nimport WebMercatorViewport, { getDistanceScales } from 'viewport-mercator-project'\nimport useComponentSize from '../../lib/useComponentSize'\nimport MyLocation from './markers/MyLocation'\nimport { useGeolocation } from '../../lib/sensors'\n// import { debounce } from '../../lib/util'\nimport StyleButtons from './controls/StyleButtons'\nimport MyLocationButton from './controls/MyLocationButton'\nimport { mapConfig } from '../../config'\nimport classNames from 'classnames'\nimport 'mapbox-gl/dist/mapbox-gl.css'\nimport './BaseMap.css'\n\n/**\n * Note that this component technically has state but it is designed to be functionally stateless\n */\nconst BaseMap = (props) => {\n  // pull what we need out of the props\n  const {\n    showMe,\n    children,\n    mapStyles,\n    controlPadding,\n    viewport: initViewport,\n    bounds,\n    lockToBounds,\n    lockPan,\n    initStyle,\n    onViewportChange: incomingOnViewportChange,\n    onTransitionStart: incomingOnTransitionStart,\n    onTransitionEnd: incomingOnTransitionEnd,\n    transitions,\n    onMapDataEvent,\n    stylechooser,\n    ...passthroughProps\n  } = props\n\n  const mapContainerRef = useRef(null)\n  const mapBoxRef = useRef(null)\n  const innerTransitionsRef = useRef(null)\n\n  const { size } = useComponentSize(mapContainerRef)\n\n  const [currStyle, setCurrStyle] = useState(initStyle)\n\n  // This is the truth of the viewport!!\n  const [viewport, setViewport] = useState({ ...defaultViewVals, ...initViewport })\n  const [isTransitioning, setIsTransitioning] = useState(false)\n  const [projection, setProjection] = useState(null)\n\n  let myPosition = {}\n  myPosition = useGeolocation()\n\n  const geoMarker = (myPosition.latitude && myPosition.longitude)\n    ? (\n      <Marker\n        key='myPos'\n        className='myPosMarker'\n        captureDrag={false}\n        latitude={myPosition.latitude}\n        longitude={myPosition.longitude}\n        style={{ zIndex: 1 }}>\n        <MyLocation position={myPosition} projection={projection} />\n      </Marker>\n    ) : null\n\n  // Recalculate the projection if we need to but only when zoom changes\n  useMemo(() => {\n    if (!size || size.width < 10 || size.height < 10) return\n    if (mapStyles.length <= currStyle) setCurrStyle(initStyle)\n    try {\n      const projection = getDistanceScales(viewport)\n      // console.log('recalcProjection', { projection, size })\n      setProjection(projection)\n    }\n    catch (e) {\n      console.log('ERROR', viewport)\n      console.error(e)\n    }\n  }, [viewport.zoom, size])\n\n  const flyToMe = () => {\n    if (!myPosition.latitude || !myPosition.longitude) return\n    const transitionTime = 2000\n    innerTransitionsRef.current = {\n      transitionDuration: transitionTime,\n      transitionInterpolator: new FlyToInterpolator(),\n      transitionEasing: easeCubic\n    }\n    // You get `transitionTime` ms to figure this out. then we just jump\n    setTimeout(() => {\n      if (innerTransitionsRef.current) innerTransitionsRef.current = null\n    }, transitionTime)\n    setViewport({\n      ...viewport,\n      latitude: myPosition.latitude,\n      longitude: myPosition.longitude,\n      zoom: viewport.zoom > 10 ? viewport.zoom : 12\n    })\n  }\n\n  /**\n   * Callback fired when the user changes the viewport object\n   * @param {*} viewport\n   */\n  const onViewportChange = (viewportChange) => {\n    const newViewport = { ...viewportChange }\n    // Here we set/reset the bounds\n    if (bounds && lockToBounds) {\n      if (newViewport.longitude < bounds[0]) newViewport.longitude = bounds[0]\n      else if (newViewport.longitude > bounds[2]) newViewport.longitude = bounds[2]\n\n      if (newViewport.latitude < bounds[1]) newViewport.latitude = bounds[1]\n      else if (newViewport.latitude > bounds[3]) newViewport.latitude = bounds[3]\n    }\n    if (lockPan) {\n      newViewport.latitude = viewport.latitude\n      newViewport.longitude = viewport.longitude\n    }\n\n    // console.log('onViewportChange', newViewport)\n    // Fire the external callback so parent components can track viewport if they need to\n    if (!isTransitioning && typeof incomingOnViewportChange === 'function') {\n      incomingOnViewportChange({\n        viewport: newViewport,\n        size,\n        projection,\n        map: mapBoxRef.current && mapBoxRef.current.getMap()\n      })\n    }\n    setViewport(newViewport)\n  }\n\n  const recalcZoomBounds = () => {\n    // console.log('Should I recalc viewbounds?')\n    if (!bounds || !size || size.width < 10 || size.height < 10 || isTransitioning) return\n    // On the first run we're going to try to center the bounds.\n    const [minlng, minlat, maxlng, maxlat] = bounds\n    try {\n      // console.log('recalcZoomBounds')\n      const { longitude, latitude, zoom } = new WebMercatorViewport({ ...size, ...viewport }).fitBounds(\n        [ [minlng, minlat], [maxlng, maxlat] ],\n        { padding: 40, offset: [0, 0] }\n      )\n      // console.log('Changing Zoom ', bounds, viewport.zoom, zoom, viewport)\n\n      // console.log('recalcZoomBounds')\n      setViewport({ ...viewport, longitude, latitude, zoom })\n    }\n    catch (e) {\n      // Sometimes we don't have a valid bound. Don't make a big deal out of it.\n      console.error(e)\n    }\n  }\n\n  const handleTransitionStart = () => {\n    // console.log('handleTransitionStart (internal)')\n    setIsTransitioning(true)\n    if (typeof incomingOnTransitionStart === 'function') incomingOnTransitionStart()\n  }\n\n  const handleTransitionEnd = () => {\n    // console.log('handleTransitionEnd (internal)')\n    setIsTransitioning(false)\n    innerTransitionsRef.current = null\n    if (incomingOnTransitionEnd) incomingOnTransitionEnd()\n    if (typeof incomingOnViewportChange === 'function') {\n      incomingOnViewportChange({\n        viewport,\n        size,\n        projection,\n        map: mapBoxRef.current && mapBoxRef.current.getMap()\n      })\n    }\n  }\n\n  // RecalcZoombounds should only be done sparingly\n  useMemo(recalcZoomBounds, [size, bounds])\n\n  useEffect(() => {\n    setViewport({ ...viewport, ...initViewport })\n  }\n  , [initViewport])\n\n  return (\n    <div className={classNames('mapContainer', props.className)} ref={mapContainerRef}>\n      {size.height > 0 && size.width > 0 && (\n        <ReactMapGL\n          {...viewport}\n          {...(innerTransitionsRef.current || transitions)}\n          ref={map => {\n            mapBoxRef.current = map\n          }}\n          height={size.height}\n          width={size.width}\n          mapStyle={currStyle < mapStyles.length ? mapStyles[currStyle].style : mapStyles[0].style}\n          onData={onMapDataEvent}\n          onTransitionStart={handleTransitionStart}\n          onTransitionEnd={handleTransitionEnd}\n          dragPan={!lockPan}\n          onViewportChange={onViewportChange}\n          mapboxApiAccessToken={mapConfig.mapBoxToken}\n          {...passthroughProps}\n        >\n          {\n            children && Array.isArray(children)\n              ? children.map((c, idx) => c ? React.cloneElement(\n                handleChild(c, viewport, size.height, size.width, projection),\n                { key: `mapChild-${idx}` }\n              ) : null)\n              : handleChild(children, viewport, size.height, size.width, projection)\n          }\n          {/* Make sure the controls are above everything else */}\n          { stylechooser && (\n            <StyleButtons\n              controlPadding={controlPadding}\n              currStyle={currStyle}\n              mapStyles={mapStyles}\n              setCurrStyle={setCurrStyle}\n            />\n          )}\n          {/* Augment children with some props they need to survive in this harsh world */}\n          { !props.hideNavControls && (\n            <NavigationControl\n              onViewportChange={viewport => onViewportChange({ ...viewport, ...size })}\n              showZoom={!props.touchZoom === false && !props.scrollZoom === false}\n              showCompass={!props.touchRotate === false && !props.dragRotate === false}\n            />\n          )}\n          {showMe && !lockPan && (\n            <React.Fragment>\n              {geoMarker}\n              <MyLocationButton disabled={!myPosition || !myPosition.latitude} controlPadding={controlPadding} onClick={flyToMe} />\n            </React.Fragment>\n          )}\n        </ReactMapGL>\n      )}\n    </div>\n  )\n}\n\nBaseMap.propTypes = {\n  // Anything else we want to add to the map\n  children: PropTypes.any,\n  data: PropTypes.array,\n  // Maybe we want map controls to be padded\n  controlPadding: PropTypes.object,\n\n  showMe: PropTypes.bool,\n\n  // Separate transitions from viewport so we can set them independently\n  transitions: PropTypes.object,\n  initStyle: PropTypes.number,\n\n  // Some switches to make things easier\n  stylechooser: PropTypes.bool,\n  lockPan: PropTypes.bool,\n  lockRotation: PropTypes.bool,\n  lockZoom: PropTypes.bool,\n  lockToBounds: PropTypes.bool,\n  hideNavControls: PropTypes.bool,\n\n  // bounds of the map. may be locked or not [minlng, minlat], [maxlng, maxlat]\n  bounds: PropTypes.array,\n\n  // List of valid styles that will get picker buttons\n  mapStyles: PropTypes.array,\n\n  onMapDataEvent: PropTypes.func,\n  onViewportChange: PropTypes.func\n}\n\nBaseMap.defaultProps = {\n  controlPadding: {},\n  stylechooser: true,\n  initStyle: 0,\n  mapStyles: mapConfig.styles,\n  lockToBounds: false\n}\n\nexport default BaseMap\n\nconst defaultViewVals = {\n  latitude: 49.3050394,\n  longitude: -123.1398254,\n  bearing: 0,\n  pitch: 0,\n  zoom: 12\n}\n\nfunction handleChild (child, viewport, height, width, projection) {\n  return typeof child === 'function'\n    ? child(viewport, height, width, projection)\n    : child\n}\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n    color: theme.palette.primary.main,\n    position: 'absolute',\n    top: '50%',\n    left: '50%',\n    textAlign: 'center',\n    transformOrigin: '50% 50%',\n    transform: 'translateY(-50%) translateX(-50%)',\n    zIndex: 1\n  },\n  rootActive: {\n    zIndex: 60\n  },\n  svgDot: {\n    zIndex: 61,\n    width: 20,\n    height: 20,\n    position: 'absolute',\n    top: '50%',\n    left: '50%',\n    textAlign: 'center',\n    transformOrigin: '50% 50%',\n    transform: 'translateY(-50%) translateX(-50%)'\n  },\n  dot: {\n    stroke: theme.palette.secondary.contrastText,\n    strokeWidth: '1',\n    fill: theme.palette.secondary.main\n  },\n  directionIndicator: {\n    position: 'absolute',\n    left: '50%',\n    // transformOrigin: '50% 50%',\n    // transform: 'translateY(-50%) translateX(-50%)',\n    zIndex: 59\n  },\n  name: {\n    color: 'white',\n    fontWeight: 'bold',\n    textShadow: `\n        0px 0px 4px #000000, \n        0px 0px 4px #000000 \n    `,\n    zIndex: 60,\n    position: 'relative'\n    // textStroke: '1px white'\n  },\n  nameActive: {\n    color: theme.palette.secondary.dark,\n    textShadow: `\n    0px 0px 2px #FFFFFF, \n    0px 0px 2px #FFFFFF,\n    0px 0px 4px #FFFFFF \n`\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst Single = ({ direction }) => {\n  const classes = useStyles()\n  return (\n    <div className={classes.root}>\n      <svg className={classes.svgDot} version='1.1' viewBox='0, 0, 10, 10' >\n        <circle cx='5' cy='5' r='4' className={classes.dot} />\n      </svg>\n      {direction && direction >= 0 ? (\n        <div className={classes.directionIndicator}>\n          <svg className={classes.svgArc}\n            version='1.1'\n            width='100'\n            height='100'\n            viewBox='0, 0, 100, 100'\n            style={{ transform: `translateY(-50%) translateX(-50%) rotateZ(${direction}deg)` }}>\n            <path d='M50,0 C60.946,0.151 72.136,3.514 80.675,10.56 L50,50 L19.325,10.56 C27.938,3.461 39,0.278 50,0 z'\n              fill='#009DC1'\n              fillOpacity='0.444'\n              strokeWidth='0.5'\n              strokeOpacity='0.6'\n              stroke='#FFFFFF'\n            />\n          </svg>\n        </div>\n      ) : null}\n    </div>\n  )\n}\n\nSingle.propTypes = {\n  direction: PropTypes.number\n}\n\nexport default Single\n","import React, { useState, useRef, useMemo } from 'react'\nimport { StaticMap } from 'react-map-gl'\nimport PropTypes from 'prop-types'\nimport { getDistanceScales } from 'viewport-mercator-project'\nimport useComponentSize from '../../lib/useComponentSize'\nimport StyleButtons from './controls/StyleButtons'\nimport { mapConfig } from '../../config'\nimport classNames from 'classnames'\nimport 'mapbox-gl/dist/mapbox-gl.css'\nimport './BaseMap.css'\n\n/**\n * Note that this component technically has state but it is designed to be functionally stateless\n */\nconst BaseStaticMap = (props) => {\n  const {\n    controlPadding,\n    viewport,\n    children,\n    mapStyles,\n    onMapDataEvent,\n    ...passthroughProps\n  } = props\n\n  const mapRef = useRef(null)\n  const mapBoxRef = useRef()\n  const { size } = useComponentSize(mapRef, { width: 100, height: 50 })\n\n  const [currStyle, setCurrStyle] = useState(0)\n  const [projection, setProjection] = useState(null)\n\n  const recalcProjection = () => {\n    if (!size || size.width < 10 || size.height < 10) return\n    try {\n      const projection = getDistanceScales(viewport)\n      // console.log('recalcProjection', { projection, size })\n      setProjection(projection)\n    }\n    catch (e) {\n      // Sometimes we don't have a valid bound. Don't make a big deal out of it.\n      console.error(e)\n    }\n  }\n\n  if (!projection) recalcProjection()\n  useMemo(recalcProjection, [size])\n\n  return (\n    <div className={classNames('BaseMap', props.className)} ref={mapRef} style={{ height: '100%', width: '100%' }}>\n      <StaticMap\n        {...viewport}\n        height={size.height}\n        width={size.width}\n        mapStyle={mapStyles[currStyle].style}\n        onData={onMapDataEvent}\n        mapboxApiAccessToken={mapConfig.mapBoxToken}\n        {...passthroughProps}\n        ref={map => {\n          mapBoxRef.current = map\n        }}\n      >\n        { mapStyles && mapStyles.length > 1 ? (\n          <StyleButtons\n            controlPadding={controlPadding}\n            currStyle={currStyle}\n            mapStyles={mapStyles}\n            setCurrStyle={setCurrStyle}\n          />\n        ) : null }\n        {\n          children && Array.isArray(children)\n            ? children.map(c => handleChild(c, mapBoxRef, size.height, size.width, projection))\n            : handleChild(children, mapBoxRef, size.height, size.width, projection)\n        }\n      </StaticMap>\n    </div>\n  )\n}\n\nfunction handleChild (child, mapBoxRef, height, width, projection) {\n  if (mapBoxRef.current) {\n    console.log('MAPSTATE', mapBoxRef.current.getMap())\n  }\n  const viewport = {}\n  return typeof child === 'function'\n    ? child(viewport, height, width, projection)\n    : child\n}\n\nBaseStaticMap.propTypes = {\n  // Anything else we want to add to the map\n  children: PropTypes.any,\n  deckelements: PropTypes.array,\n  data: PropTypes.array,\n  // Maybe we want map controls to be padded\n  controlPadding: PropTypes.object,\n\n  minPitch: PropTypes.number,\n  maxPitch: PropTypes.number,\n  pitch: PropTypes.number,\n\n  // Lock the bounds of a map to a rectangle [minlng, minlat], [maxlng, maxlat]\n  bounds: PropTypes.array,\n  // Lock the possible zoom levels to a range: [minZoom, maxZoom]\n  zoomBounds: PropTypes.array,\n  // InitialBounds of the map.\n  InnerBounds: PropTypes.array,\n\n  // List of valid styles that will get picker buttons\n  mapStyles: PropTypes.array,\n\n  // Just some default props we probably won't set.\n  latitude: PropTypes.number,\n  longitude: PropTypes.number,\n  zoom: PropTypes.number,\n\n  onMapDataEvent: PropTypes.func\n}\nBaseStaticMap.defaultProps = {\n  controlPadding: {},\n  stylechooser: true,\n  // viewport: {\n  //   zoom: 12,\n  //   latitude: 49.3050394,\n  //   longitude: -123.1398254\n  // },\n  initStyle: 0,\n  mapStyles: mapConfig.styles\n}\n\nexport default BaseStaticMap\n","import React from 'react'\nimport PropTypes from 'prop-types'\n// import { makeStyles } from '@material-ui/core/styles'\nimport { Marker } from 'react-map-gl'\nimport BaseMap from './BaseMap'\nimport Dot from './markers/Dot'\nimport BaseStaticMap from './BaseStaticMap'\n// import style from './MapDot.style'\n\n// const useStyles = makeStyles(style)\n\nconst MapDot = ({ staticMap, editable, latitude, longitude, onChange, direction, ...props }) => {\n  const Map = staticMap ? BaseStaticMap : BaseMap\n  // const classes = useStyles()\n  const mapProps = staticMap ? {} : {\n    touchRotate: false,\n    dragRotate: false,\n    showMe: editable,\n    lockPan: !editable,\n    onViewportChange: onChange\n  }\n\n  return (\n    <Map\n      {...mapProps}\n      {...props}\n    >\n      {latitude && longitude ? (\n        <Marker\n          className={'singleMarker'}\n          latitude={latitude}\n          longitude={longitude}\n        >\n          <Dot direction={direction} />\n        </Marker>\n      )\n        : <Dot direction={direction} />\n      }\n\n    </Map>\n  )\n}\n\nMapDot.propTypes = {\n  direction: PropTypes.number,\n  latitude: PropTypes.number,\n  longitude: PropTypes.number,\n  editable: PropTypes.bool,\n  staticMap: PropTypes.bool,\n  onChange: PropTypes.func\n}\n\nexport default MapDot\n","import React, { useState, useMemo } from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogActions from '@material-ui/core/DialogActions'\nimport Button from '@material-ui/core/Button'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport FormLabel from '@material-ui/core/FormLabel'\nimport Slider from '@material-ui/lab/Slider'\n\nimport MapDot from '../../../maps/MapDot'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n\n  },\n  dlgContent: {\n    display: 'flex',\n    flexDirection: 'column',\n    padding: 0\n  },\n  mapWrapper: {\n    flexGrow: 1\n  },\n  sliderWrapper: {\n    padding: '20px'\n  },\n  slider: {\n\n  },\n  sliderRoot: {\n\n  },\n  body: {\n    overflow: 'hidden',\n    whiteSpace: 'pre-line',\n    paddingBottom: theme.spacing(1)\n  },\n  title: {\n    background: theme.palette.primary.main,\n    color: theme.palette.primary.contrastText,\n    margin: 0,\n    padding: theme.spacing(2)\n  },\n  closeButton: {\n    position: 'absolute',\n    right: theme.spacing(1),\n    top: theme.spacing(1),\n    color: theme.palette.grey[500]\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst MapDirPicker = ({ open, onOk, onCancel, title, latitude: initLat, longitude: initLong, direction: initDir }) => {\n  const classes = useStyles()\n  const [{ longitude, latitude }, setCoords] = useState({ longitude: initLong, latitude: initLat })\n  const [direction, setRotation] = useState(initDir)\n\n  const initViewport = useMemo(() => ({\n    zoom: 18,\n    latitude: initLat,\n    longitude: initLong\n  }), [initLat, initLong])\n\n  const mapChange = ({ viewport: { longitude, latitude } }) => setCoords({ longitude, latitude })\n\n  return (\n    <Dialog\n      scroll='paper'\n      open={open}\n      fullWidth\n      fullScreen\n      onClose={onCancel}\n    >\n      <DialogTitle className={classes.title} disableTypography>\n        <Typography color='inherit'>{title}</Typography>\n      </DialogTitle>\n      <DialogContent className={classes.dlgContent}>\n        <div className={classes.mapWrapper}>\n          <MapDot\n            editable\n            className={classes.map}\n            direction={direction > 0 ? direction : null}\n            viewport={initViewport}\n            onChange={mapChange}\n          />\n        </div>\n        <div className={classes.sliderWrapper}>\n          <FormLabel className={classes.mapFormLabel}>Direction {direction > -1 ? '' : '(off)'}</FormLabel>\n          <Slider\n            classes={{\n              root: classes.sliderRoot\n            }}\n            value={direction || -1}\n            min={-1}\n            max={360}\n            step={1}\n            onChange={(e, value) => setRotation(value)}\n          />\n        </div>\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={onCancel}>Cancel</Button>\n        <div style={{ flexGrow: 1 }} />\n        <Button onClick={() => onOk({ longitude, latitude, direction })}>Ok</Button>\n      </DialogActions>\n    </Dialog>\n  )\n}\n\nMapDirPicker.propTypes = {\n  open: PropTypes.bool,\n  latitude: PropTypes.number,\n  longitude: PropTypes.number,\n  direction: PropTypes.number,\n  onOk: PropTypes.func,\n  onCancel: PropTypes.func,\n  title: PropTypes.string\n}\n\nexport default MapDirPicker\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\n// import Typography from '@material-ui/core/Typography'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogActions from '@material-ui/core/DialogActions'\nimport TextField from '@material-ui/core/TextField'\nimport Button from '@material-ui/core/Button'\nimport DialogTitle from '@material-ui/core/DialogTitle'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n\n  },\n  body: {\n    // height: '100%',\n    // overflow: 'hidden'\n  },\n  textArea: {\n    whiteSpace: 'pre-line',\n    padding: theme.spacing(1),\n    border: `1px solid ${theme.palette.grey[200]}`,\n    background: theme.palette.grey[100]\n  },\n  dlgContent: {\n    overflow: 'hidden'\n  },\n  title: {\n    background: theme.palette.primary.main,\n    color: theme.palette.primary.contrastText,\n    alignSelf: 'flex-start',\n    width: '100%',\n    margin: 0,\n    display: 'flex',\n    padding: theme.spacing(2)\n  },\n  closeButton: {\n    padding: 0,\n    alignSelf: 'flex-start'\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst BigTextEdit = ({ open, onOk, title, body, multiline }) => {\n  const classes = useStyles()\n  const [value, setValue] = useState(body || '')\n  return (\n    <Dialog\n      scroll='paper'\n      open={open}\n      fullWidth\n      maxWidth='xl'\n      onClose={() => onOk(value)}\n    >\n      <DialogTitle className={classes.title}>\n        {title}\n      </DialogTitle>\n      <DialogContent className={classes.dlgContent}>\n        <TextField\n          className={classes.body}\n          multiline={multiline}\n          inputProps={{\n            className: classes.textArea\n          }}\n          autoFocus\n          fullWidth\n          rows={6}\n          rowsMax={6}\n          onChange={e => setValue(e.target.value)}\n          defaultValue={body}\n        />\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={() => onOk(body)}>Cancel</Button>\n        <div style={{ flexGrow: 1 }} />\n        <Button onClick={() => onOk(value)}>Ok</Button>\n      </DialogActions>\n    </Dialog>\n  )\n}\n\nBigTextEdit.propTypes = {\n  open: PropTypes.bool,\n  multiline: PropTypes.bool,\n  onOk: PropTypes.func,\n  title: PropTypes.string,\n  body: PropTypes.string\n}\n\nexport default BigTextEdit\n","\nimport React, { useState } from 'react'\nimport PropTypes from 'prop-types'\n\nimport TextField from '@material-ui/core/TextField'\nimport FormLabel from '@material-ui/core/FormLabel'\nimport Typography from '@material-ui/core/Typography'\nimport FormControlLabel from '@material-ui/core/FormControlLabel'\nimport Switch from '@material-ui/core/Switch'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport MapDot from '../../../maps/MapDot'\n\nimport MapDirPicker from '../dialogs/MapDirPicker'\nimport BigTextEdit from '../dialogs/BigTextEdit'\n\nimport style from './SeriesEditInner.style'\nimport { ACCESS } from '../../../../config'\nimport ShortLongText from '../controls/ShortLongText'\n\nconst DIALOGS = {\n  MAPPICK: 'mapPicker',\n  NOTEEDIT: 'noteEdit'\n}\n\nconst useStyles = makeStyles(style)\n\n/**\n * SeriesEdit appears in two places so we need this to be a bit reusable\n */\nconst SeriesEditInner = ({ series, delta, onChange }) => {\n  const classes = useStyles()\n  const [activeDialog, setActiveDialog] = useState(null)\n\n  const viewport = { zoom: 18 }\n  if ((delta.latitude || series.coords[1]) && (delta.longitude || series.coords[0])) {\n    viewport.longitude = delta.longitude || series.coords[0]\n    viewport.latitude = delta.latitude || series.coords[1]\n  }\n\n  const access = delta.access || series.access || 'PRIVATE'\n  // console.log('ACESS', access)\n  return (\n    <div>\n      <TextField\n        label='Series Name'\n        fullWidth\n        placeholder='New Series'\n        className={classes.field}\n        value={delta.name || series.name || ''}\n        onChange={e => onChange({ ...delta, name: e.target.value })}\n      />\n      <div className={classes.mapWrapper} onClick={() => setActiveDialog(DIALOGS.MAPPICK)}>\n        <FormLabel className={classes.mapFormLabel}>Location</FormLabel>\n        <div className={classes.mapInnerWrap}>\n          <MapDot\n            staticMap\n            className={classes.map}\n            direction={delta.direction || series.direction}\n            viewport={viewport}\n          />\n        </div>\n      </div>\n      <div className={classes.field}>\n        <FormLabel>Series Access</FormLabel>\n        <div className={classes.access}>\n          <FormControlLabel\n            className={classes.accessRadio}\n            control={\n              <Switch\n                checked={['OPEN', 'PUBLIC'].indexOf(access) > -1}\n                onChange={(e) => {\n                  onChange({ ...delta, access: e.target.checked ? 'PUBLIC' : 'PRIVATE' })\n                }}\n                value={'PUBLIC'}\n              />\n            }\n            label={<div>\n              <Typography variant='body2' component='div'>{ACCESS.PUBLIC.label}</Typography>\n              <Typography variant='caption' color='textSecondary' component='div'>{ACCESS.PUBLIC.description}</Typography>\n            </div>}\n\n          />\n          <FormControlLabel\n            className={classes.accessRadio}\n            disabled={['PRIVATE'].indexOf(access) > -1}\n            control={\n              <Switch\n                checked={['OPEN'].indexOf(access) > -1}\n                onChange={(e) => onChange({ ...delta, access: e.target.checked ? 'OPEN' : 'PUBLIC' })}\n                value={'OPEN'}\n              />\n            }\n            label={<div>\n              <Typography variant='body2' component='div'>{ACCESS.OPEN.label}</Typography>\n              <Typography variant='caption' color='textSecondary' component='div'>{ACCESS.OPEN.description}</Typography>\n            </div>}\n          />\n        </div>\n      </div>\n\n      <ShortLongText\n        onClick={() => setActiveDialog(DIALOGS.NOTEEDIT)}\n        className={classes.field}\n        label='Series Note'\n        text={delta.note || series.note}\n      />\n      {activeDialog === DIALOGS.MAPPICK && (\n        <MapDirPicker\n          open\n          title='Series Location & Direction'\n          latitude={delta.latitude || series.coords[1]}\n          longitude={delta.longitude || series.coords[0]}\n          direction={delta.direction || series.direction}\n          onOk={(data) => {\n            onChange({ ...delta, ...data })\n            setActiveDialog(null)\n          }}\n          onCancel={() => setActiveDialog(null)}\n        />\n      )}\n      {activeDialog === DIALOGS.NOTEEDIT && (\n        <BigTextEdit\n          open\n          title='Series Note'\n          body={delta.note || series.note}\n          multiline\n          onOk={(newNote) => {\n            onChange({ ...delta, note: newNote })\n            setActiveDialog(null)\n          }}\n          onCancel={() => setActiveDialog(null)}\n        />\n      )}\n    </div>\n  )\n}\n\nSeriesEditInner.propTypes = {\n  // now some functions\n  series: PropTypes.object.isRequired,\n  delta: PropTypes.object.isRequired,\n  onChange: PropTypes.func.isRequired\n}\n\nexport default SeriesEditInner\n","export default theme => ({\n  root: {\n\n  },\n  inner: {\n    display: 'flex',\n    flexDirection: 'column'\n    // padding: theme.spacing(1)\n  },\n  dlgTitle: {\n    background: theme.palette.primary.main,\n    color: theme.palette.primary.contrastText\n  },\n  access: {\n    display: 'flex',\n    flexDirection: 'column'\n  },\n  accessRadio: {\n    margin: theme.spacing(2, 1)\n    // flex: '1 1 50%'\n  },\n  grow: {\n    flexGrow: 1\n  },\n  field: {\n    flexGrow: 0,\n    marginBottom: theme.spacing(1) * 2\n  },\n  slider: {\n    paddingLeft: theme.spacing(1),\n    paddingRight: theme.spacing(1)\n  },\n  textField: {\n    marginLeft: theme.spacing(1),\n    marginRight: theme.spacing(1),\n    width: '100%'\n  },\n  formLabel: {\n    display: 'block',\n    marginTop: theme.spacing(1),\n    marginBottom: theme.spacing(1)\n  },\n  mapFormLabel: {\n    display: 'block',\n    marginTop: theme.spacing(1),\n    marginBottom: theme.spacing(1)\n  },\n  mapInnerWrap: {\n    flexGrow: 1,\n    height: '200px',\n    minHeight: '200px'\n  },\n  mapWrapper: {\n    flexGrow: 1,\n    display: 'flex',\n    flexDirection: 'column',\n    paddingBottom: theme.spacing(1) * 2\n  },\n  formControl: {\n    margin: theme.spacing(1),\n    minWidth: 120\n  },\n  chips: {\n    display: 'flex',\n    flexWrap: 'wrap'\n  }\n})\n","\nimport React, { useState, useContext } from 'react'\nimport PropTypes from 'prop-types'\n\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport DialogActions from '@material-ui/core/DialogActions'\nimport Button from '@material-ui/core/Button'\nimport Typography from '@material-ui/core/Typography'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport { SeriesContext } from '../contexts'\n\nimport style from './SeriesEdit.style'\nimport SeriesEditInner from './subViews/SeriesEditInner'\n\nconst useStyles = makeStyles(style)\n\nconst SeriesEdit = ({ onOk, onCancel }) => {\n  const classes = useStyles()\n  const { series } = useContext(SeriesContext)\n  const [delta, setDelta] = useState({})\n\n  return (\n    <Dialog\n      scroll='paper'\n      className={classes.root}\n      fullScreen\n      open\n      onClose={onCancel}\n    >\n      <CssBaseline />\n      <DialogTitle disableTypography className={classes.dlgTitle}>\n        <Typography variant='subtitle1' color='inherit' className={classes.grow}>\n           Edit Series Details\n        </Typography>\n      </DialogTitle>\n      <DialogContent className={classes.inner}>\n        <SeriesEditInner\n          series={series}\n          delta={delta}\n          onChange={setDelta}\n        />\n      </DialogContent>\n      <DialogActions>\n        <Button className={classes.menuButton} color='inherit' onClick={() => setDelta({})} aria-label='Menu'>\n            Reset\n        </Button>\n        <Button className={classes.menuButton} color='inherit' onClick={onCancel} aria-label='Menu'>\n            Cancel\n        </Button>\n        <Button className={classes.menuButton} color='inherit' onClick={() => onOk({ id: series.id, ...delta })} aria-label='Menu'>\n            Ok\n        </Button>\n      </DialogActions>\n    </Dialog>\n  )\n}\n\nSeriesEdit.propTypes = {\n  // now some functions\n  onOk: PropTypes.func.isRequired,\n  onCancel: PropTypes.func.isRequired\n}\n\nexport default SeriesEdit\n","export default theme => ({\n  root: {\n\n  },\n  inner: {\n    display: 'flex',\n    flexDirection: 'column'\n    // padding: theme.spacing(1)\n  },\n  dlgTitle: {\n    background: theme.palette.primary.main,\n    color: theme.palette.primary.contrastText\n  },\n  grow: {\n    flexGrow: 1\n  },\n  field: {\n    flexGrow: 0,\n    marginBottom: theme.spacing(2)\n  },\n  slider: {\n    paddingLeft: theme.spacing(1),\n    paddingRight: theme.spacing(1)\n  },\n  textField: {\n    marginLeft: theme.spacing(1),\n    marginRight: theme.spacing(1),\n    width: '100%'\n  },\n  formLabel: {\n    display: 'block',\n    marginTop: theme.spacing(1),\n    marginBottom: theme.spacing(1)\n  },\n  mapFormLabel: {\n    display: 'block',\n    marginTop: theme.spacing(1),\n    marginBottom: theme.spacing(1)\n  },\n  mapInnerWrap: {\n    flexGrow: 1\n  },\n  mapWrapper: {\n    flexGrow: 1,\n    display: 'flex',\n    flexDirection: 'column',\n    paddingBottom: theme.spacing(2)\n  },\n  formControl: {\n    margin: theme.spacing(1),\n    minWidth: 120\n  },\n  chips: {\n    display: 'flex',\n    flexWrap: 'wrap'\n  }\n})\n","import React, { useState, useEffect, useRef } from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\n\nimport Badge from '@material-ui/core/Badge'\nimport Typography from '@material-ui/core/Typography'\nimport IconButton from '@material-ui/core/IconButton'\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport GridListTile from '@material-ui/core/GridListTile'\nimport GridListTileBar from '@material-ui/core/GridListTileBar'\nimport MobileStepper from '@material-ui/core/MobileStepper'\nimport Button from '@material-ui/core/Button'\n\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack'\nimport LabelIcon from '@material-ui/icons/Label'\nimport PauseIcon from '@material-ui/icons/PauseCircleFilled'\nimport PlayIcon from '@material-ui/icons/PlayCircleFilled'\nimport KeyboardArrowLeft from '@material-ui/icons/KeyboardArrowLeft'\nimport KeyboardArrowRight from '@material-ui/icons/KeyboardArrowRight'\n\nimport { makeStyles, useTheme } from '@material-ui/core/styles'\n\nimport Photo from './subViews/Photo'\nimport { formatDate } from '../../../lib/datelib'\nimport useComponentSize from '../../../lib/useComponentSize'\n\nimport style from './Slideshow.style'\n\nconst useStyles = makeStyles(style)\n\nconst Slideshow = ({ onCancel, photos, transition }) => {\n  const classes = useStyles()\n  const theme = useTheme()\n  const { activeStep, lastStep, handleForward, handleBack, paused, pause, play } = useStepper(photos.length, transition)\n  const [showXYTags, setShowXYTags] = useState(false)\n\n  const refImgWrap = useRef(null)\n  const { size: { height, width } } = useComponentSize(refImgWrap)\n\n  return (\n    <div className={classes.root}>\n      <CssBaseline />\n      <div ref={refImgWrap} className={classes.slideContainer}>\n        {photos.map((slide, idx) => (\n          <GridListTile\n            key={`slide-${idx}`}\n            className={classNames(\n              classes.slide,\n              activeStep === idx && classes.active,\n              lastStep === idx && classes.last\n            )}\n            onClick={() => setShowXYTags(!showXYTags)}\n            style={{\n              height,\n              width,\n              transition: theme.transitions.create(['opacity'], { duration: 1 / 4 * transition })\n            }}\n          >\n            <Photo photo={slide} className={classes.photo} showTags={showXYTags} />\n            <Typography className={classes.labelBadge} >\n            Tags: {showXYTags ? 'On ' : 'Off '}\n              <Badge color='secondary' badgeContent={photos[activeStep].tags.filter(tag => tag.coords).length}>\n                <LabelIcon color='inherit' />\n              </Badge>\n            </Typography>\n\n            <GridListTileBar\n              className={classes.titleBar}\n              titlePosition='top'\n              title={(\n                <Typography color='inherit' variant='caption'>\n                  <IconButton className={classes.iconButton} onClick={(e) => onCancel()}>\n                    <ArrowBackIcon />\n                  </IconButton>\n                  {formatDate(slide.takenOn)}\n                </Typography>\n              )}\n              subtitle={<em>{paused ? 'Paused' : '    '}</em>}\n              actionIcon={paused ? (\n                <IconButton className={classes.iconButton} onClick={(e) => {\n                  e.preventDefault()\n                  e.stopPropagation()\n                  play()\n                }}>\n                  <PlayIcon />\n                </IconButton>\n              ) : (\n                <IconButton className={classes.iconButton} onClick={(e) => {\n                  e.preventDefault()\n                  e.stopPropagation()\n                  pause()\n                }}>\n                  <PauseIcon />\n                </IconButton>\n              )}\n            />\n          </GridListTile>\n        ))}\n        <IconButton size='small' className={classes.manualBack} onClick={handleBack} color='inherit'>\n          {theme.direction === 'rtl' ? <KeyboardArrowRight /> : <KeyboardArrowLeft />}\n        </IconButton>\n        <IconButton size='small' className={classes.manualForward} onClick={handleForward} color='inherit'>\n          {theme.direction === 'rtl' ? <KeyboardArrowLeft /> : <KeyboardArrowRight />}\n        </IconButton>\n      </div>\n\n      <MobileStepper\n        steps={photos.length}\n        position='static'\n        activeStep={activeStep}\n        classes={{\n          root: classes.mobileStepper,\n          dotActive: classes.dotActive\n        }}\n        nextButton={\n          <Button color='inherit' size='small' onClick={handleForward} disabled={activeStep === photos.length - 1}>\n            Next\n            {theme.direction === 'rtl' ? <KeyboardArrowLeft /> : <KeyboardArrowRight />}\n          </Button>\n        }\n        backButton={\n          <Button color='inherit' size='small' onClick={handleBack} disabled={activeStep === 0}>\n            {theme.direction === 'rtl' ? <KeyboardArrowRight /> : <KeyboardArrowLeft />}\n            Back\n          </Button>\n        }\n      />\n    </div>\n  )\n}\n\nSlideshow.propTypes = {\n  // We might want to go full screen\n  isFullScreen: PropTypes.bool,\n  // This is just the basic shape of the photo object\n  photos: PropTypes.array,\n  transition: PropTypes.number,\n  onCancel: PropTypes.func.isRequired\n}\n\nSlideshow.defaultProps = {\n  transition: 5000,\n  isFullScreen: false,\n  slides: []\n}\n\nexport default Slideshow\n\n/**\n * Custom React Hook for all our timer handling\n */\nconst useStepper = (num, interval) => {\n  const [activeStep, setActiveStep] = useState(0)\n  const [paused, setPaused] = useState(false)\n  const [lastStep, setLastStep] = useState(0)\n  const timerRef = useRef()\n\n  const handleForward = () => {\n    setLastStep(activeStep)\n    if (activeStep + 1 >= num) setActiveStep(0)\n    else setActiveStep(activeStep + 1)\n    if (!paused) {\n      destroyTimer()\n      createTimer()\n    }\n  }\n  const handleBack = () => {\n    setLastStep(activeStep)\n    if (activeStep - 1 < 0) setActiveStep(num - 1)\n    else setActiveStep(activeStep - 1)\n    if (!paused) {\n      destroyTimer()\n      createTimer()\n    }\n  }\n\n  const pause = () => {\n    destroyTimer()\n    setPaused(true)\n  }\n  const play = () => {\n    setPaused(false)\n    destroyTimer()\n    createTimer()\n  }\n\n  const createTimer = () => {\n    timerRef.current = window.setInterval(\n      // We need to use the alternate notation for the useState function\n      // because setInterval will only have access to the activeStep it was\n      // initialized with\n      () => setActiveStep(oldStep => {\n        setLastStep(oldStep)\n        return (oldStep + 1 >= num) ? 0 : oldStep + 1\n      })\n      , interval\n    )\n  }\n  const destroyTimer = () => {\n    if (timerRef.current) window.clearInterval(timerRef.current)\n  }\n\n  useEffect(() => {\n    createTimer()\n    return () => {\n      destroyTimer()\n    }\n  }, []) // Pass in empty array to run useEffect only on mount.\n\n  return { activeStep, lastStep, handleForward, handleBack, setActiveStep, paused, pause, play }\n}\n","export default theme => ({\n  root: {\n    // maxWidth: 400,\n    height: '100%',\n    display: 'flex',\n    flexDirection: 'column'\n  },\n  swipeAble: {\n    height: '100%'\n  },\n  slideContainer: {\n    flexGrow: 1\n  },\n  titleBar: {\n    padding: theme.spacing(0, 1),\n    height: '35px!important'\n  },\n  mobileStepper: {\n    flexGrow: 0,\n    background: theme.palette.grey[800],\n    color: theme.palette.getContrastText(theme.palette.grey[800])\n  },\n  slide: {\n    top: 0,\n    zIndex: 0,\n    opacity: 0,\n    position: 'absolute',\n    display: 'block',\n    overflow: 'hidden',\n    width: '100%',\n    height: '100%',\n    minHeight: 300\n  },\n  dotActive: {\n    background: 'white'\n  },\n  iconButton: {\n    color: 'white'\n  },\n  active: {\n    zIndex: 5,\n    opacity: 1\n  },\n  last: {\n    opacity: 1,\n    zIndex: 4\n  },\n  tagContainer: {\n\n  },\n  labelBadge: {\n    color: 'white',\n    zIndex: 10,\n    position: 'absolute',\n    right: theme.spacing(2),\n    bottom: theme.spacing(1),\n    opacity: 0.8\n  },\n  tagChip: {\n    // height: theme.spacing(3),\n    marginRight: theme.spacing(1),\n    fontSize: 10,\n    height: theme.spacing(2),\n    padding: theme.spacing(0.5)\n  },\n  xyTagChip: {\n    position: 'absolute',\n    fontSize: theme.spacing(1),\n    height: theme.spacing(2)\n  },\n  manualBack: {\n    color: 'white',\n    zIndex: 10,\n    position: 'absolute',\n    transform: 'translateY(-50%)',\n    left: 0,\n    top: '50%'\n  },\n  manualForward: {\n    color: 'white',\n    zIndex: 10,\n    position: 'absolute',\n    transform: 'translateY(-50%)',\n    right: 0,\n    top: '50%'\n  }\n})\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport Button from '@material-ui/core/Button'\nimport Typography from '@material-ui/core/Typography'\nimport DialogActions from '@material-ui/core/DialogActions'\n\n// import MenuIcon from '@material-ui/icons/MenuIcon'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n\n})\n\nconst useStyles = makeStyles(style)\n\nconst CancelConfirm = ({ title, message, onConfirm, open }) => {\n  const classes = useStyles()\n  return (\n    <Dialog\n      className={classes.root}\n      disableBackdropClick\n      fullWidth\n      open={open}\n      disableEscapeKeyDown\n      maxWidth='xl'\n      aria-labelledby='confirmation-dialog-title'\n    >\n      <DialogTitle id='confirmation-dialog-title'>{title}</DialogTitle>\n      <DialogContent>\n        <Typography>\n          {message}\n        </Typography>\n\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={() => onConfirm(false)} color='primary'>\n      No\n        </Button>\n        <Button onClick={() => onConfirm(true)} color='secondary'>\n      Yes\n        </Button>\n      </DialogActions>\n    </Dialog>\n  )\n}\n\nCancelConfirm.propTypes = {\n  open: PropTypes.bool,\n  title: PropTypes.string.isRequired,\n  message: PropTypes.string.isRequired,\n  onConfirm: PropTypes.func.isRequired\n}\n\nexport default CancelConfirm\n","export default theme => ({\n  root: {\n    width: '100%'\n  },\n  tagContainer: {\n  },\n  formControl: {\n\n  },\n  actionButtons: {\n    textAlign: 'right'\n  },\n  noOptionsMessage: {\n    padding: theme.spacing(1, 2)\n  },\n  singleValue: {\n    fontSize: 16\n  },\n  placeholder: {\n    position: 'absolute',\n    left: 2,\n    fontSize: 16\n  },\n  input: {\n    display: 'flex',\n    padding: 0\n  },\n  valueContainer: {\n    display: 'flex',\n    flexWrap: 'wrap',\n    flex: 1,\n    alignItems: 'center',\n    overflow: 'hidden'\n  },\n  paper: {\n    position: 'absolute',\n    zIndex: 1,\n    marginTop: theme.spacing(1),\n    left: 0,\n    right: 0\n  }\n\n})\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport Typography from '@material-ui/core/Typography'\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport TagChip from '../tags/TagChip'\nimport style from './TagControl.style'\n\nconst useStyles = makeStyles(style)\n/**\n * Just to be clear: the state here is being stored as []\n */\nconst TagControl = ({ tags, label, tagConfig, className }) => {\n  const classes = useStyles()\n  // Filter to just this tag type\n  const tagValues = tags.filter(tag => tag.typeId === tagConfig.id && !tag.coords)\n\n  return (\n    <div className={classNames(classes.root, className)}>\n      <Typography variant='overline' className={classes.fieldTitle}>\n        {tagConfig.label}\n      </Typography>\n      <div className={classes.tagContainer}>\n        {tagValues.map((tag, idx) => (\n          <TagChip tag={tag} key={`tagchip${idx}`} color={tagConfig.color} />\n        ))}\n      </div>\n\n    </div>\n  )\n}\n\nTagControl.propTypes = {\n  className: PropTypes.string,\n  label: PropTypes.string,\n  tags: PropTypes.array,\n  tagConfig: PropTypes.object\n}\n\nexport default TagControl\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport {\n  TextField,\n  Typography\n} from '@material-ui/core'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { timestampToHTML5Input, HTML5InputToTimestamp } from '../../../../lib/datelib'\n\nconst style = theme => ({\n  root: {\n  },\n  rootEdit: {\n  },\n  formControl: {\n    width: '100%'\n  },\n  textBody: {\n    whiteSpace: 'pre-line'\n  },\n  actionButtons: {\n    textAlign: 'right'\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst DateControl = ({\n  label,\n  value,\n  hint,\n  onChange,\n  className\n}) => {\n  const classes = useStyles()\n  return (\n    <div className={classNames(classes.root, className)}>\n      <Typography variant='overline' className={classes.fieldTitle}>\n        {label}\n      </Typography>\n      <TextField\n        type='datetime-local'\n        fullWidth\n        value={timestampToHTML5Input(value)}\n        className={classes.textField}\n        onChange={(e) => onChange(HTML5InputToTimestamp(e.target.value))}\n      />\n      {hint && <Typography variant='caption' className={classes.hint}>{hint}</Typography>}\n    </div>\n  )\n}\n\nDateControl.propTypes = {\n  className: PropTypes.string,\n  label: PropTypes.string.isRequired,\n  hint: PropTypes.string,\n  value: PropTypes.string, // all timestamps come in as integerstrings\n  onChange: PropTypes.func.isRequired\n}\n\nexport default DateControl\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport Paper from '@material-ui/core/Paper'\nimport TextField from '@material-ui/core/TextField'\nimport Typography from '@material-ui/core/Typography'\nimport MenuItem from '@material-ui/core/MenuItem'\n\nimport Select from 'react-select'\nimport CreatableSelect from 'react-select/lib/Creatable'\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport TagChip from '../tags/TagChip'\nimport style from './TagControl.style'\nconst useStyles = makeStyles(style)\n\n/**\n * Just to be clear: the state here is being stored as []\n */\nconst TagControl = ({\n  tags, onChange,\n  hint, tagConfig, className\n}) => {\n  const classes = useStyles()\n  // console.log('TagControl Rnder', { tags, tagConfig })\n  const onSelectChange = (inputValue, { action, removedValue, option }) => {\n    // If this was the last tag then close the menu\n    switch (action) {\n      case 'clear':\n        onChange([])\n        break\n      case 'remove-value':\n        // Remember we need to potentially remove it from the old AND the new\n        onChange(tags.filter(val => val.id !== removedValue.value))\n        break\n      case 'select-option':\n        const newVal = {\n          ...tagConfig.values.find(tcv => tcv.id === option.value),\n          typeId: tagConfig.id\n        }\n        onChange([...tags, newVal])\n        break\n      case 'create-option':\n        const newLabel = inputValue.find(v => v.__isNew__).value\n        const newCreateVal = {\n          label: newLabel,\n          typeId: tagConfig.id\n        }\n        onChange([...tags, newCreateVal])\n        break\n      default:\n        break\n    }\n  }\n\n  const SingleValue = ({ removeProps, innerProps, data, ...props }) => {\n    // console.log('SingleValue PROPS', { removeProps, innerProps, data, props })\n    return (\n      <TagChip tag={data} onDelete={(e) => {\n        // console.log('EVENT', e)\n        removeProps.onClick()\n      }} color={tagConfig.color} edit />\n    )\n  }\n  SingleValue.propTypes = {\n    removeProps: PropTypes.any,\n    innerProps: PropTypes.any,\n    data: PropTypes.any\n  }\n\n  const MultiValue = ({ removeProps, innerProps, data, ...props }) => {\n    // console.log('MultiValue PROPS', { removeProps, innerProps, data, props })\n    return (\n      <TagChip tag={data} onDelete={(e) => {\n        // console.log('EVENT', e)\n        removeProps.onClick()\n      }} color={tagConfig.color} edit />\n    )\n  }\n  MultiValue.propTypes = {\n    removeProps: PropTypes.any,\n    innerProps: PropTypes.any,\n    data: PropTypes.any\n  }\n\n  // Filter to just this tag type\n  const tagValues = tags.filter(tag => tag.typeId === tagConfig.id && !tag.coords)\n  // Now format it as {label, value: id} for react-select\n  const selectOptions = tagValues.map(val => ({ label: val.label, value: val.id }))\n\n  // Filter out things we haven't chosen yet\n  // Also transform the options into a label/value pair for react-select\n  const remainingTags = tagConfig.values\n    .filter(val => tagValues.map(t => t.id).indexOf(val.id) === -1)\n    .map(val => ({ label: val.label, value: val.id }))\n\n  // console.log('TAG DEBUG', { value, tagValues, tagConfig })\n\n  return (\n    <div className={classNames(classes.root, className)}>\n      <Typography variant='overline' className={classes.fieldTitle}>\n        {tagConfig.label}\n      </Typography>\n      {!tagConfig.allowAdditions && (\n        <Select\n          options={remainingTags}\n          classes={classes}\n          isFocused\n          components={{\n            Control,\n            Menu,\n            //   MultiValue,\n            NoOptionsMessage,\n            Option,\n            Placeholder,\n            //   SingleValue,\n            ValueContainer\n          }}\n          deleteRemoves\n          value={selectOptions}\n          isClearable={false}\n          onChange={onSelectChange}\n          placeholder='Select Tags'\n          isMulti\n          isSearchable\n        />\n      ) }\n      { tagConfig.allowAdditions && (\n        <CreatableSelect\n          options={remainingTags}\n          classes={classes}\n          isFocused\n          deleteRemoves\n          components={{\n            Control,\n            Menu,\n            //   MultiValue,\n            NoOptionsMessage,\n            Option,\n            Placeholder,\n            //   SingleValue,\n            ValueContainer\n          }}\n          value={selectOptions}\n          isClearable={false}\n          onChange={onSelectChange}\n          placeholder='Select Tags'\n          isMulti\n          isSearchable\n        />\n      )}\n      {hint && <Typography variant='caption' className={classes.hint}>{hint}</Typography>}\n    </div>\n  )\n}\n\nTagControl.propTypes = {\n  className: PropTypes.string,\n  hint: PropTypes.string,\n  tags: PropTypes.array,\n  onChange: PropTypes.func.isRequired,\n  tagConfig: PropTypes.object\n}\n\nexport default TagControl\n\nfunction Control (props) {\n  // console.log('CONTROL PROPS', props)\n  return (\n    <TextField\n      fullWidth\n      InputProps={{\n        inputComponent,\n        inputProps: {\n          className: props.selectProps.classes.input,\n          inputRef: props.innerRef,\n          children: props.children,\n          // innerProps: {\n          onMouseDown: (e) => {\n            props.innerProps.onMouseDown(e)\n          },\n          onTouchEnd: (e) => {\n            props.innerProps.onTouchEnd(e)\n          }\n          // }\n          // ...props.innerProps\n        }\n      }}\n      {...props.selectProps.textFieldProps}\n    />\n  )\n}\n\nconst NoOptionsMessage = ({ innerProps, selectProps, children }) => (\n  <Typography\n    color='textSecondary'\n    className={selectProps.classes.noOptionsMessage}\n    {...innerProps}\n  >\n    {children}\n  </Typography>\n)\n\nconst Menu = ({ selectProps, innerProps, children }) => (\n  <Paper square className={selectProps.classes.paper} {...innerProps}>\n    {children}\n    {/* {console.log('MENU PROPS', { selectProps, innerProps, children })} */}\n  </Paper>\n)\n\nconst inputComponent = ({ inputRef, ...props }) => <div ref={inputRef} {...props} />\n\nconst Placeholder = (props) => (\n  <Typography\n    color='textSecondary'\n    className={props.selectProps.classes.placeholder}\n    {...props.innerProps}\n  >\n    {props.children}\n  </Typography>\n)\n\nconst Option = ({ innerRef, isFocused, isSelected, innerProps, children }) => (\n  <MenuItem\n    buttonRef={innerRef}\n    selected={isFocused}\n    component='div'\n    style={{ fontWeight: isSelected ? 500 : 400 }}\n    {...innerProps}\n  >\n    {children}\n  </MenuItem>\n)\n\nconst ValueContainer = ({ selectProps, children }) => (\n  <div className={selectProps.classes.valueContainer}>{children}</div>\n)\nValueContainer.propTypes = {\n  selectProps: PropTypes.any,\n  children: PropTypes.any\n}\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\n// import Typography from '@material-ui/core/Typography'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport Typography from '@material-ui/core/Typography'\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogActions from '@material-ui/core/DialogActions'\nimport Button from '@material-ui/core/Button'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport IconButton from '@material-ui/core/IconButton'\n\nimport CloseIcon from '@material-ui/icons/Close'\nimport TagControl from '../controls/TagControl'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n  },\n  dlgContent: {\n    // position: 'relative',\n    // maxWidth: '200px',\n    overflowY: 'visible!important',\n    paddingBottom: 300\n    // overflowX: 'hidden'\n  },\n  title: {\n    width: '100%',\n    margin: 0,\n    display: 'flex',\n    padding: theme.spacing(2)\n  },\n  dlgTitle: {\n    flexGrow: 1\n  },\n  closeButton: {\n    color: theme.palette.grey[500]\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst TagEdit = ({ open, title, onOk, onCancel, tags, tagConfig }) => {\n  const classes = useStyles()\n  const [value, setValue] = useState(tags)\n  return (\n    <Dialog\n      className={classes.root}\n      scroll='body'\n      fullScreen\n      open={open}\n      onClose={() => onOk(value)}\n    >\n      <DialogTitle className={classes.title} disableTypography>\n        <Typography className={classes.dlgTitle}>{title}</Typography>\n        <IconButton className={classes.closeButton} onClick={onCancel}>\n          <CloseIcon />\n        </IconButton>\n      </DialogTitle>\n      <DialogContent className={classes.dlgContent}>\n        <TagControl\n          className={classes.field}\n          tags={value}\n          tagConfig={tagConfig}\n          onChange={setValue}\n        />\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={onCancel}>Cancel</Button>\n        <div style={{ flexGrow: 1 }} />\n        <Button onClick={() => setValue(tags)}>Reset</Button>\n        <Button onClick={() => onOk(value)}>Ok</Button>\n      </DialogActions>\n    </Dialog>\n  )\n}\n\nTagEdit.propTypes = {\n  open: PropTypes.bool,\n  title: PropTypes.string,\n  onOk: PropTypes.func,\n  onCancel: PropTypes.func,\n  tags: PropTypes.array.isRequired,\n  tagConfig: PropTypes.object.isRequired\n}\n\nexport default TagEdit\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport Typography from '@material-ui/core/Typography'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { formatDate } from '../../../../lib/datelib'\n\nconst style = theme => ({\n  root: { },\n  rootEdit: { },\n  formControl: {\n    width: '100%'\n  },\n  textBody: {\n    whiteSpace: 'pre-line'\n  },\n  actionButtons: {\n    textAlign: 'right'\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst DateView = ({\n  label,\n  value,\n  className\n}) => {\n  const classes = useStyles()\n  return (\n    <div className={classNames(classes.root, className)}>\n      <Typography variant='overline' className={classes.fieldTitle}>\n        {label}\n      </Typography>\n      <Typography variant='body1' className={classes.hint}>{value ? formatDate(value) : ''}</Typography>\n    </div>\n  )\n}\n\nDateView.propTypes = {\n  className: PropTypes.string,\n  label: PropTypes.string.isRequired,\n  value: PropTypes.string\n}\n\nexport default DateView\n","import React, { useContext, useState } from 'react'\nimport PropTypes from 'prop-types'\n\nimport Typography from '@material-ui/core/Typography'\nimport Divider from '@material-ui/core/Divider'\nimport List from '@material-ui/core/List'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemText from '@material-ui/core/ListItemText'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport TagView from '../controls/TagView'\nimport ShortLongText from '../controls/ShortLongText'\nimport DateControl from '../controls/DateControl'\nimport UserListItem from '../controls/UserListItem'\nimport TagClass from '../../../../lib/Tags'\nimport BigTextEdit from '../dialogs/BigTextEdit'\nimport BigText from '../dialogs/BigText'\nimport TagEdit from '../dialogs/TagEdit'\n\nimport { SeriesContext } from '../../contexts'\nimport DateView from '../controls/DateView'\n\nconst style = theme => ({\n  root: {\n    height: '90%',\n    width: '85%'\n  },\n  dlgTitleContainer: {\n    display: 'flex',\n    padding: 0\n  },\n  catTagTitle: {\n    marginTop: theme.spacing(2)\n  },\n  dlgTitle: {\n    flexGrow: 1,\n    paddingTop: theme.spacing(2),\n    paddingBottom: theme.spacing(1),\n    paddingLeft: theme.spacing(3)\n  },\n  field: {\n    marginBottom: theme.spacing(2)\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst DIALOGS = {\n  NOTEEDIT: 'noteEdit',\n  NOTEVIEW: 'noteView',\n  PHOTOTAKEN: 'taken',\n  TAGEDIT: 'tag',\n  CANCEL: 'cancel'\n}\n\nconst PhotoInfo = ({ canEdit, photo, delta, onChange }) => {\n  const classes = useStyles()\n  const { seriesConfig } = useContext(SeriesContext)\n  const [{ activeDialog, activeDialogContext }, setActiveDialog] = useState({})\n\n  const tagInst = new TagClass(seriesConfig, delta.tags || photo.tags)\n\n  let metaKeys = []\n  try {\n    metaKeys = photo.meta ? Object.keys(JSON.parse(photo.meta)) : []\n  }\n  catch (e) {\n    console.error(e)\n  }\n  return (\n    <div>\n      {photo.createdUser && (\n        <React.Fragment>\n          <UserListItem\n            user={photo.createdUser}\n            onAvatarClick={() => seriesConfig.onAvatarClick(photo.createdUser.username)}\n            secondary='uploaded this photo'\n          />\n          <Divider />\n        </React.Fragment>\n      )}\n      {canEdit ? (\n        <DateControl\n          className={classes.field}\n          label='Photo taken on'\n          value={delta.takenOn || photo.takenOn}\n          onChange={takenOn => onChange({ takenOn })}\n          canEdit={canEdit}\n        />\n      )\n        : (\n          <DateView\n            label='Photo taken on'\n            value={delta.takenOn || photo.takenOn}\n          />\n        )}\n\n      {(canEdit || photo.note) && (\n        <ShortLongText\n          label='Photo Note'\n          text={delta.note || photo.note}\n          onClick={() => {\n            if (canEdit) setActiveDialog({ activeDialog: DIALOGS.NOTEEDIT })\n            else setActiveDialog({ activeDialog: DIALOGS.NOTEVIEW })\n          }}\n        />\n      )}\n      <Typography variant='subtitle1' className={classes.catTagTitle}>Category tags</Typography>\n      <Divider />\n      {tagInst.seriesConfig.getNonXYTagTypes().map((tt, idx) => (\n        <div\n          key={`tagtype-${idx}`}\n          onClick={() => canEdit ? setActiveDialog({ activeDialog: DIALOGS.TAGEDIT, activeDialogContext: tt }) : null}\n        >\n          <TagView\n            className={classes.field}\n            label={tt.label}\n            tags={delta.tags || photo.tags}\n            tagConfig={tt}\n          />\n        </div>\n      ))}\n\n      {metaKeys.length > 0 && Object.keys(seriesConfig.meta).length > 0 && (\n        <React.Fragment>\n          <Typography className={classes.heading}>Metadata</Typography>\n          <Divider />\n          <List className={classes.list}>\n            {metaKeys.map((key, idx) => seriesConfig.meta[key] ? (\n              <ListItem key={`metadata${idx}`}>\n                <ListItemText\n                  primary={seriesConfig.meta[key].label}\n                  secondary={seriesConfig.meta[key].render(photo.meta[key])}\n                />\n              </ListItem>\n            ) : null\n            )}\n          </List>\n        </React.Fragment>\n      )}\n      {activeDialog && activeDialog === DIALOGS.NOTEEDIT && (\n        <BigTextEdit\n          open\n          multiline\n          onOk={note => {\n            onChange({ note })\n            setActiveDialog({})\n          }}\n          title='Edit Photo Note'\n          body={delta.note || photo.note}\n        />\n      )}\n      {activeDialog && activeDialog === DIALOGS.NOTEVIEW && (\n        <BigText\n          open\n          multiline\n          onClose={() => setActiveDialog({})}\n          title='Photo Note'\n          body={delta.note || photo.note}\n        />\n      )}\n      {activeDialog && activeDialog === DIALOGS.TAGEDIT && (\n        <TagEdit\n          open\n          title={`Edit Tags: ${activeDialogContext.label}`}\n          onOk={tags => {\n            setActiveDialog({})\n            onChange({ tags })\n          }}\n          onCancel={() => setActiveDialog({})}\n          tags={delta.tags || photo.tags}\n          tagConfig={activeDialogContext}\n        />\n      )}\n    </div>\n  )\n}\n\nPhotoInfo.propTypes = {\n  canEdit: PropTypes.bool,\n  onChange: PropTypes.func.isRequired,\n  photo: PropTypes.object.isRequired,\n  delta: PropTypes.object.isRequired\n}\n\nexport default PhotoInfo\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\n\nimport Button from '@material-ui/core/Button'\nimport Dialog from '@material-ui/core/Dialog'\nimport IconButton from '@material-ui/core/IconButton'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport Typography from '@material-ui/core/Typography'\nimport DialogActions from '@material-ui/core/DialogActions'\n\nimport CloseIcon from '@material-ui/icons/Close'\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport CancelConfirm from '../dialogs/CancelConfirm'\n\nimport PhotoInfoInner from './PhotoInfoInner'\n\nconst style = theme => ({\n  root: {\n    height: '90%',\n    width: '85%'\n  },\n  dlgTitleContainer: {\n    display: 'flex',\n    padding: 0\n  },\n  dlgTitle: {\n    flexGrow: 1,\n    paddingTop: theme.spacing(2),\n    paddingBottom: theme.spacing(1),\n    paddingLeft: theme.spacing(3)\n  },\n  field: {\n    marginBottom: theme.spacing(2)\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst DIALOGS = {\n  NOTEEDIT: 'noteEdit',\n  NOTEVIEW: 'noteView',\n  PHOTOTAKEN: 'taken',\n  TAGEDIT: 'tag',\n  CANCEL: 'cancel'\n}\n\nconst PhotoInfo = ({ canEdit, photo, onCancel, onOk, open }) => {\n  const classes = useStyles()\n  const [activeDialog, setActiveDialog] = useState(null)\n  const [delta, setDelta] = useState({})\n\n  const dirty = delta && Object.keys(delta).length > 0\n\n  return (\n    <Dialog\n      fullScreen\n      onClose={() => {\n        if (dirty) setActiveDialog(DIALOGS.CANCEL)\n        else onCancel()\n      }}\n      aria-labelledby='customized-dialog-title'\n      open={open}\n    >\n      <DialogTitle disableTypography className={classes.dlgTitleContainer}>\n        <Typography variant='h5' className={classes.dlgTitle}>\n          Photo Properties\n        </Typography>\n        <IconButton onClick={onCancel}>\n          <CloseIcon />\n        </IconButton>\n      </DialogTitle>\n      <DialogContent>\n        <PhotoInfoInner\n          photo={photo}\n          delta={delta}\n          onChange={newDelta => setDelta({ ...delta, ...newDelta })}\n          canEdit={canEdit}\n        />\n      </DialogContent>\n\n      <DialogActions>\n        {!canEdit && (\n          <Button onClick={onCancel} color='primary'>\n            Ok\n          </Button>\n        )}\n        {canEdit && !dirty && (\n          <Button onClick={onCancel} color='primary'>\n            Back\n          </Button>\n        )}\n        {canEdit && dirty && (\n          <React.Fragment>\n            <Button onClick={() => setActiveDialog(DIALOGS.CANCEL)} color='primary'>\n              Cancel\n            </Button>\n            <Button onClick={() => setDelta({})} color='primary'>\n              Reset\n            </Button>\n            <Button onClick={() => onOk(delta)} color='primary'>\n              Ok\n            </Button>\n          </React.Fragment>\n        )}\n      </DialogActions>\n      {activeDialog && activeDialog === DIALOGS.CANCEL && (\n        <CancelConfirm\n          open\n          title='Lose unsaved changes?'\n          message='You will lose any changes you made to this form'\n          onConfirm={confirm => {\n            setActiveDialog(null)\n            if (confirm) onCancel()\n          }}\n        />\n      )}\n    </Dialog>\n  )\n}\n\nPhotoInfo.propTypes = {\n  canEdit: PropTypes.bool,\n  onCancel: PropTypes.func.isRequired,\n  onOk: PropTypes.func.isRequired,\n  open: PropTypes.bool,\n  photo: PropTypes.object.isRequired\n}\n\nexport default PhotoInfo\n","import React, { useState, useContext } from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\n\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport Button from '@material-ui/core/Button'\nimport MobileStepper from '@material-ui/core/MobileStepper'\nimport Typography from '@material-ui/core/Typography'\nimport AppBar from '@material-ui/core/AppBar'\nimport Toolbar from '@material-ui/core/Toolbar'\nimport IconButton from '@material-ui/core/IconButton'\nimport Badge from '@material-ui/core/Badge'\nimport Chip from '@material-ui/core/Chip'\n\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack'\nimport InfoIcon from '@material-ui/icons/Info'\nimport LabelIcon from '@material-ui/icons/Label'\n\nimport { makeStyles, useTheme } from '@material-ui/core/styles'\n\nimport PhotoInfo from './subViews/PhotoInfo'\nimport Photo from './subViews/Photo'\n\nimport { formatDate } from '../../../lib/datelib'\nimport Tags from '../../../lib/Tags'\nimport SwipeableViews from 'react-swipeable-views'\nimport { SeriesContext } from '../contexts'\n\nimport style from './PhotoViewTool.style'\nconst useStyles = makeStyles(style)\n\nconst STATES = {\n  VIEWPIC: 0,\n  SHOWINFO: 1,\n  SHOWTAGS: 2,\n  EDITTAGS: 3,\n  FIRSTAGEDIT: 4\n}\n\nconst PhotoViewTool = ({ photos, initPhotoId, onMenuBack, onUpdatePhoto, newPhoto }) => {\n  const classes = useStyles()\n  const theme = useTheme()\n  const { series, seriesConfig, ac } = useContext(SeriesContext)\n  const sortedPhotos = [...photos]\n  sortedPhotos.sort((a, b) => parseInt(b.takenOn, 10) - parseInt(a.takenOn, 10))\n  const [activePhoto, setActivePhoto] = useState(initPhotoId ? sortedPhotos.findIndex(p => p.id === initPhotoId) : 0)\n  // This is a special copy of the photo so we can play around with the XY tags and undo\n  // if we need to\n  const photo = photos[activePhoto]\n  const [delta, setDelta] = useState(newPhoto ? photo : {})\n  const [mode, setMode] = useState({\n    current: newPhoto ? STATES.FIRSTAGEDIT : STATES.VIEWPIC,\n    last: null\n  })\n\n  const tagsClass = new Tags(seriesConfig, delta.tags || photo.tags)\n\n  const changeMode = (desired) => {\n    setMode({ current: desired, last: mode.current })\n  }\n\n  const onCommitTags = () => {\n    changeMode(STATES.SHOWTAGS)\n    onUpdatePhoto(photo, { id: photo.id, ...delta })\n  }\n\n  const onCommitTagsFirst = () => {\n    onUpdatePhoto(photo, { id: photo.id, ...delta })\n    onMenuBack()\n  }\n\n  const onCancelTagEdit = () => {\n    changeMode(STATES.SHOWTAGS)\n    setDelta(photo)\n  }\n\n  const photoClick = (e) => {\n    if (mode.current === STATES.VIEWPIC) {\n      e.preventDefault()\n      e.stopPropagation()\n      changeMode(STATES.SHOWINFO)\n    }\n  }\n\n  const can = {\n    update: ac.canUser('update', series, 'series') ||\n            ac.canUser('update', photo, 'photo')\n  }\n\n  return (\n    <div className={classes.root}>\n      <CssBaseline /> {/* You only need this in a root element. Don't put it anywhere else in the dom */}\n      <AppBar position='static' className={classNames(classes.appBar, mode.current !== STATES.VIEWPIC ? classes.appBarEdit : null)}>\n        <Toolbar disableGutters>\n          {mode.current !== STATES.FIRSTAGEDIT && (\n            <IconButton\n              className={classes.menuButton}\n              color='inherit'\n              aria-label='Menu'\n              onClick={() => onMenuBack()}\n            >\n              <ArrowBackIcon />\n            </IconButton>\n          )}\n          <div className={classes.grow}>\n            <Typography variant='subtitle2' color='inherit' >\n              {newPhoto ? 'Add Tags' : `Photo View (${activePhoto + 1}/${photos.length})`}\n            </Typography>\n            <Typography variant='subtitle2' color='inherit'>\n              {formatDate(photo.takenOn, 'lll')}\n            </Typography>\n          </div>\n\n          { mode.current === STATES.EDITTAGS &&\n          <Button color='inherit' onClick={onCancelTagEdit}>\n            Cancel\n          </Button>\n          }\n\n          { mode.current === STATES.EDITTAGS &&\n          <Button color='inherit' onClick={onCommitTags}>\n            Save\n          </Button>\n          }\n          { mode.current === STATES.FIRSTAGEDIT &&\n          <Button color='inherit' onClick={onCommitTagsFirst}>\n            Next\n          </Button>\n          }\n\n          { can.update && mode.current === STATES.SHOWTAGS &&\n          <Button color='inherit' onClick={() => changeMode(STATES.EDITTAGS)}>\n            Edit\n          </Button>\n          }\n\n          { (mode.current !== STATES.EDITTAGS && mode.current !== STATES.FIRSTAGEDIT) &&\n          <IconButton color='inherit'\n            className={classNames(classes.tagButton, mode.current === STATES.SHOWTAGS && classes.activeButton)}\n            onClick={() => changeMode(mode.current === STATES.SHOWTAGS ? STATES.VIEWPIC : STATES.SHOWTAGS)}\n          >\n            <Badge className={classes.margin} badgeContent={tagsClass.getXYTags().length} color='primary'>\n              <LabelIcon color='inherit' />\n            </Badge>\n          </IconButton>\n          }\n\n          { (mode.current !== STATES.EDITTAGS && mode.current !== STATES.FIRSTAGEDIT) &&\n          <IconButton color='inherit'\n            className={classNames(classes.infoButton, mode.current === STATES.SHOWINFO && classes.activeButton)}\n            onClick={() => changeMode(mode.current === STATES.SHOWINFO ? STATES.VIEWPIC : STATES.SHOWINFO)}\n          >\n            <InfoIcon />\n          </IconButton>\n          }\n\n        </Toolbar>\n      </AppBar>\n      <div className={classes.inner} onClick={photoClick}>\n        <SwipeableViews\n          axis={theme.direction === 'rtl' ? 'x-reverse' : 'x'}\n          index={activePhoto}\n          containerStyle={{ height: '100%' }}\n          style={{ height: '100%' }}\n          disabled={mode.current !== STATES.VIEWPIC}\n          onChangeIndex={(val) => setActivePhoto(val)}\n          enableMouseEvents\n        >\n          {sortedPhotos.map((photoidx, idx) => (\n            <div className={classes.photoWrapper} key={`swipeshowpic-${idx}`}>\n              <Photo\n                showTags={mode.current === STATES.SHOWTAGS}\n                photo={{ ...photoidx, ...delta }}\n                edit={can.update && (mode.current === STATES.EDITTAGS || mode.current === STATES.FIRSTAGEDIT)}\n                onChange={setDelta}\n                onCommitTags={onCommitTags}\n              />\n            </div>\n          ))}\n        </SwipeableViews>\n\n        {mode.current === STATES.VIEWPIC && (\n          <MobileStepper\n            steps={sortedPhotos.length}\n            position='bottom'\n            activeStep={activePhoto}\n            classes={{\n              root: classes.mobileStepper,\n              dots: classes.dots,\n              dot: classes.dot,\n              dotActive: classes.dotActive\n            }}\n          />\n        )}\n      </div>\n      <PhotoInfo\n        open={mode.current === STATES.SHOWINFO}\n        photo={photo}\n        canEdit={can.update}\n        onOk={(newDelta) => {\n          onUpdatePhoto(photo, { id: photo.id, ...newDelta })\n          changeMode(mode.last)\n        }}\n        onCancel={() => changeMode(mode.last)}\n      />\n      { (mode.current === STATES.EDITTAGS || mode.current === STATES.FIRSTAGEDIT) && (\n        <Chip\n          label='Tap to tag features...'\n          onClick={() => {}}\n          className={classes.tipChip}\n        />\n      )}\n    </div>\n  )\n}\n\nPhotoViewTool.propTypes = {\n  photos: PropTypes.array.isRequired,\n  initPhotoId: PropTypes.string,\n  newPhoto: PropTypes.bool,\n  // Now some action functions\n  onMenuBack: PropTypes.func.isRequired,\n  onUpdatePhoto: PropTypes.func.isRequired\n}\n\nexport default PhotoViewTool\n","export default theme => ({\n  root: {\n    display: 'flex',\n    height: '100%',\n    flexDirection: 'column',\n    overflow: 'hidden'\n  },\n  appBar: {\n    flexGrow: 0\n  },\n  appBarEdit: {\n    color: theme.palette.secondary.contrastText,\n    background: theme.palette.secondary.main\n  },\n  grow: {\n    flexGrow: 1\n  },\n  photoWrapper: {\n    height: '100%'\n  },\n  inner: {\n    flex: '1 1',\n    position: 'relative'\n  },\n  tabMenu: {\n    marginTop: theme.spacing(7)\n  },\n  tipChip: {\n    position: 'absolute',\n    zIndex: 11,\n    bottom: 20,\n    left: '50%',\n    opacity: 0.6,\n    transform: 'translateX(-50%)'\n  },\n  mobileStepper: {\n    background: 'none'\n  },\n  dots: {\n    margin: '0 auto'\n  },\n  dot: {\n    border: '1px solid #FFFFFF77'\n  },\n  dotActive: {\n    background: theme.palette.secondary.main\n  },\n  // tagButton: {\n  //   zIndex: 10,\n  //   color: 'white',\n  //   position: 'absolute',\n  //   fontSize: '2.5rem',\n  //   top: 10,\n  //   left: 10,\n  //   opacity: 0.8\n  // },\n  // infoButton: {\n  //   zIndex: 10,\n  //   color: 'white',\n  //   position: 'absolute',\n  //   top: 10,\n  //   right: 10,\n  //   opacity: 0.8\n  // },\n  activeButton: {\n    color: theme.palette.primary.main,\n    opacity: 1\n  }\n})\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport Slider from '@material-ui/lab/Slider'\n// import { Menu as MenuIcon } from '@material-ui/icons'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n    color: 'white',\n    zIndex: 10,\n    display: 'flex',\n    flexDirection: 'column',\n    position: 'absolute',\n    height: '50%',\n    top: '45%',\n    left: '0',\n    transform: 'translateY(-50%)'\n  },\n  sliderLabel: {\n    display: 'block',\n    flexGrow: 1,\n    textAlign: 'center',\n    padding: theme.spacing(3, 0, 3, 0),\n    textShadow: '0 0 5px black, 0 0 5px black'\n  },\n  vertical: {\n    padding: '0px 31px!important',\n    width: '4px!important'\n  },\n  rail: {\n    width: `4px!important`,\n    background: theme.palette.primary.dark,\n    boxShadow: '0 0 10px 5px black'\n  },\n  track: {\n    width: `4px!important`,\n    background: theme.palette.primary.main\n  },\n  thumb: {\n    // transform: 'translate(50%, -50%)',\n    background: theme.palette.primary.main,\n    border: `1px solid ${theme.palette.primary.dark}`,\n    marginLeft: '-8px !important',\n    width: 20,\n    height: 20\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst PhotoFadeSlider = ({ defaultValue, onChange }) => {\n  const classes = useStyles()\n  // we control the state internally so we get a smooth experience\n  const [slider, setSlider] = useState(defaultValue)\n\n  const onSliderMove = (event, value) => {\n    setSlider(value)\n    // send it back if we need to\n    onChange(value)\n  }\n\n  return (\n    <div className={classes.root}>\n      <Typography className={classes.sliderLabel} color='inherit' variant='caption'>New</Typography>\n      <Slider\n        classes={{\n          vertical: classes.vertical,\n          rail: classes.rail,\n          track: classes.track,\n          thumb: classes.thumb\n        }}\n        value={slider}\n        aria-labelledby='label'\n        onChange={onSliderMove}\n        orientation='vertical'\n      />\n      <Typography className={classes.sliderLabel} color='inherit' variant='caption'>Reference</Typography>\n    </div>\n  )\n}\n\nPhotoFadeSlider.propTypes = {\n  defaultValue: PropTypes.number,\n  onChange: PropTypes.func\n}\n\nPhotoFadeSlider.defaultProps = {\n  defaultValue: 100,\n  onChange: () => {}\n}\n\nexport default PhotoFadeSlider\n","import React, { useState, useContext } from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\n\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport Snackbar from '@material-ui/core/Snackbar'\nimport Button from '@material-ui/core/Button'\nimport Fab from '@material-ui/core/Fab'\nimport SwipeableDrawer from '@material-ui/core/SwipeableDrawer'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport RawImage from './subViews/RawImage'\nimport PhotoGrid from './subViews/PhotoGrid'\nimport PhotoFadeSlider from './controls/PhotoFadeSlider'\nimport style from './PhotoReviewTool.style'\n\nimport PhotoLibraryIcon from '@material-ui/icons/PhotoLibrary'\n\nimport { SeriesContext } from '../contexts'\nconst useStyles = makeStyles(style)\n\nconst PhotoReviewTool = ({\n  captured, defaultRefPhotoId,\n  onConfirm, onCancel, onRetry, dataUrl\n}) => {\n  const { series, seriesConfig } = useContext(SeriesContext)\n  const photos = series && series.photos ? series.photos : null\n  const classes = useStyles()\n\n  const newRefPhoto = defaultRefPhotoId\n    ? photos.find(p => p.id === defaultRefPhotoId)\n    : photos && photos.length > 0 ? photos[0] : null\n\n  const [refPhoto, setRefPhoto] = useState(newRefPhoto)\n  const [drawerOpen, setDrawerOpen] = useState(false)\n  const [slider, setSlider] = useState(100)\n\n  const handleTileClick = (id) => {\n    setRefPhoto(series.photos.find(p => p.id === id))\n    setDrawerOpen(false)\n  }\n\n  if (!captured) return 'Loading...'\n\n  return (\n    <div className={classes.root}>\n      <CssBaseline />\n      { Boolean(refPhoto) && (\n        <PhotoFadeSlider defaultValue={100} onChange={setSlider} />\n      )}\n\n      <div className={classes.captured}>\n        <RawImage\n          sizePriority={['large', 'medium', 'thumb']}\n          style={{ opacity: slider / 100 }}\n          dataUrl={dataUrl}\n          photo={captured}\n        />\n      </div>\n      { Boolean(refPhoto) && (\n        <div className={classes.reference} >\n          <RawImage\n            sizePriority={['large', 'medium', 'thumb']}\n            getPhotoUrls={seriesConfig.getPhotoUrls}\n            photo={refPhoto}\n          />\n        </div>\n      )}\n      <Snackbar\n        open\n        autoHideDuration={null}\n        ContentProps={{\n          'aria-describedby': 'snackbar-fab-message-id',\n          className: classes.snackbarContent\n        }}\n        message={<span id='snackbar-fab-message-id'>Keep this photo?</span>}\n        action={<div>\n          <Button color='inherit' size='small' onClick={onCancel}>\n                Cancel\n          </Button>\n          {Boolean(onRetry) && (\n            <Button color='inherit' size='small' onClick={onRetry}>\n          Retry\n            </Button>\n          )}\n\n          <Button color='inherit' size='small' onClick={onConfirm}>\n                Keep\n          </Button>\n        </div>\n        }\n        className={classes.snackbar}\n      />\n\n      {series && series.photos && (\n        <Fab\n          aria-label='library'\n          className={classNames(classes.libraryFab, classes.buttonFab)}\n          classes={{\n            disabled: classes.disabledFab\n          }}\n          disabled={!series || !series.photos || series.photos.length === 0}\n          onClick={() => setDrawerOpen(true)}\n        >\n          <PhotoLibraryIcon className={classes.libraryIcon} />\n        </Fab>\n      )}\n\n      {series && series.photos && (\n        <SwipeableDrawer\n          anchor='left'\n          open={drawerOpen}\n          classes={{\n            paperAnchorLeft: classes.swipeDrawer\n          }}\n          onClose={() => setDrawerOpen(false)}\n          onOpen={() => setDrawerOpen(true)}\n        >\n          <div\n            tabIndex={0}\n            className={classes.swipeDrawerContainer}\n            role='button'\n            onClick={() => setDrawerOpen(false)}\n            onKeyDown={() => setDrawerOpen(false)}\n          >\n            <PhotoGrid\n              multiSelect={false}\n              columns={1}\n              photos={series.photos}\n              onTileClick={handleTileClick}\n            />\n          </div>\n        </SwipeableDrawer>\n      )}\n    </div>\n  )\n}\n\nPhotoReviewTool.propTypes = {\n  defaultRefPhotoId: PropTypes.string,\n  captured: PropTypes.object,\n  dataUrl: PropTypes.string.isRequired,\n  // Now some functions\n  onConfirm: PropTypes.func.isRequired,\n  onCancel: PropTypes.func.isRequired,\n  onRetry: PropTypes.func // only for camera\n\n}\n\nexport default PhotoReviewTool\n","export default theme => ({\n  root: {\n    background: 'rgb(150,150, 150)',\n    // border: '5px solid red',\n    height: '100%',\n    width: '100%'\n  },\n  captured: {\n    zIndex: 3,\n    position: 'absolute',\n    height: '100%',\n    width: '100%'\n  },\n  reference: {\n    zIndex: 2,\n    position: 'absolute',\n    height: '100%',\n    width: '100%'\n  },\n  libraryFab: {\n    position: 'absolute',\n    zIndex: 10,\n    '@media (orientation: landscape)': {\n      left: '15px',\n      top: '15px',\n      height: '15vh',\n      width: '15vh'\n    },\n    '@media (orientation: portrait)': {\n      left: '15px',\n      top: '15px',\n      height: '15vw',\n      width: '15vw'\n    }\n  },\n\n  swipeDrawer: {\n    width: '50%'\n  },\n  referenceTextContainer: {\n    width: '100%',\n    display: 'flex',\n    color: 'white',\n    background: 'rgba(0,0,0,0.5)',\n    padding: theme.spacing(3),\n    position: 'absolute',\n    zIndex: 4,\n    top: 0\n  },\n  newText: {\n    flexGrow: 1,\n    color: 'white',\n    textShadow: '1 1 1 black',\n    textAlign: 'right'\n  },\n  refText: {\n    flexGrow: 1,\n    color: 'white',\n    textShadow: '1 1 1 black'\n  }\n})\n","import { useState, useEffect, useRef } from 'react'\n\nexport const useCamera = (onCapture, width, height) => {\n  const [cameraError, setCameraError] = useState(false)\n  const [cameraOnline, setCameraOnline] = useState(false)\n  const camRef = useRef()\n\n  useEffect(() => {\n    camRef.current = new Webcam(\n      document.getElementById('webcam'),\n      document.createElement('canvas')\n    )\n    camRef.current.setup(\n      height || window.innerWidth, // width\n      width || window.innerHeight // height\n    )\n      .then((data) => {\n        setCameraOnline(true)\n      })\n      .catch((e) => {\n        console.error(e)\n        setCameraError(true)\n      })\n  }, [])\n\n  useEffect(() => {\n    if (camRef.current) {\n      camRef.current.setup(width, height)\n        .then((data) => {\n          setCameraOnline(true)\n        })\n        .catch((e) => {\n          console.error(e)\n          setCameraError(true)\n        })\n    }\n  }, [width, height])\n\n  // Remember to destroy the camera object or the little light stays on\n  // and people get freaked out.\n  useEffect(() => () => {\n    if (camRef.current) {\n      camRef.current.destroy()\n      camRef.current = null\n    }\n  }, [])\n\n  const captureImage = () => {\n    if (camRef.current && cameraOnline) {\n      const capturedData = camRef.current.takeDataURLPhoto({ type: 'jpeg', quality: 1 })\n      onCapture({ ...capturedData, name: 'upload.jpg', ext: 'jpg' })\n    }\n  }\n\n  const captureRawData = () => {\n    if (camRef.current && cameraOnline) {\n      const capturedData = camRef.current.takeImageData()\n      onCapture(capturedData)\n    }\n  }\n\n  return { cameraError, captureImage, cameraOnline, captureRawData }\n}\n\nclass Webcam {\n  constructor (webcamElement, canvasElement) {\n    this.webcamElement = webcamElement\n    this.canvasElement = canvasElement\n\n    if (window.location.protocol !== 'https:' && window.location.hostname !== 'localhost') {\n      console.warn('getUserMedia() must be run from a secure origin: https or localhost.\\nChanging protocol to https.')\n    }\n\n    if (!navigator.mediaDevices && !navigator.getUserMedia) {\n      console.warn(`Your browser doesn't support navigator.mediaDevices.getUserMedia and navigator.getUserMedia.`)\n    }\n  }\n\n  adjustVideoSize (width, height) {\n    const aspectRatio = width / height\n    if (width >= height) {\n      this.webcamElement.width = aspectRatio * this.webcamElement.height\n    }\n    else if (width < height) {\n      this.webcamElement.height = this.webcamElement.width / aspectRatio\n    }\n  }\n\n  async destroy () {\n    try {\n      this.webcamElement.srcObject.getTracks()[0].stop()\n      // this.webcamElement = null\n      this.canvasElement = null\n    }\n    catch (e) {\n      console.error(e)\n    }\n  }\n\n  async setup (width, height) {\n    return new Promise((resolve, reject) => {\n      if (navigator.mediaDevices.getUserMedia !== undefined) {\n        if (this.webcamElement.srcObject) {\n          this.webcamElement.srcObject.getTracks()[0].stop()\n          this.webcamElement.srcObject = null\n        }\n        navigator.mediaDevices.getUserMedia({ audio: false, video: { facingMode: 'environment', width, height } })\n          .then((mediaStream) => {\n            if ('srcObject' in this.webcamElement) {\n              this.webcamElement.srcObject = mediaStream\n            }\n            else {\n              // For older browsers withouth the srcObject.\n              this.webcamElement.src = window.URL.createObjectURL(mediaStream)\n            }\n            this.webcamElement.onloadedmetadata = (e) => {\n              this.webcamElement.play()\n            }\n            this.webcamElement.onplaying = (e) => {\n              resolve()\n            }\n          })\n          .catch(err => reject(err))\n      }\n      else {\n        reject(new Error('Error accessing camera'))\n      }\n    })\n  }\n\n  _drawImage () {\n    const imageWidth = this.webcamElement.videoWidth\n    const imageHeight = this.webcamElement.videoHeight\n\n    const context = this.canvasElement.getContext('2d')\n    this.canvasElement.width = imageWidth\n    this.canvasElement.height = imageHeight\n\n    context.drawImage(this.webcamElement, 0, 0, imageWidth, imageHeight)\n\n    return { imageHeight, imageWidth }\n  }\n\n  takeImageData () {\n    const { imageHeight, imageWidth } = this._drawImage()\n    const data = { data: null, imageHeight, imageWidth }\n    try {\n      data.data = this.canvasElement\n        .getContext('2d')\n        .getImageData(\n          0,\n          0,\n          imageWidth,\n          imageHeight\n        ).data\n    }\n    catch (e) {}\n\n    return data\n  }\n\n  takeBlobPhoto () {\n    const { imageWidth, imageHeight } = this._drawImage()\n    return new Promise((resolve, reject) => {\n      this.canvasElement.toBlob((fileBlob) => {\n        resolve({ fileBlob, imageHeight, imageWidth })\n      })\n    })\n  }\n\n  takeDataURLPhoto ({ type, quality } = { type: 'jpeg', quality: 1 }) {\n    const { imageHeight, imageWidth } = this._drawImage()\n    const dataUrl = this.canvasElement.toDataURL('image/' + type, quality)\n    return { dataUrl, imageHeight, imageWidth, type: 'image/' + type }\n  }\n}\n","import React, { useState, useContext, useLayoutEffect } from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\n\nimport Fab from '@material-ui/core/Fab'\nimport SwipeableDrawer from '@material-ui/core/SwipeableDrawer'\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport Typography from '@material-ui/core/Typography'\n\nimport CameraIcon from '@material-ui/icons/Camera'\nimport CancelIcon from '@material-ui/icons/Cancel'\nimport PhotoLibraryIcon from '@material-ui/icons/PhotoLibrary'\n\nimport PhotoFadeSlider from './controls/PhotoFadeSlider'\nimport PhotoGrid from './subViews/PhotoGrid'\nimport RawImage from './subViews/RawImage'\n\nimport { SeriesContext } from '../contexts'\nimport { makeStyles } from '@material-ui/core/styles'\nimport style from './CameraTool.style'\nimport { useCamera } from '../../../lib/useCamera'\n\nconst useStyles = makeStyles(style)\n\n// https://googlechrome.github.io/samples/image-capture/grab-frame-take-photo.html\nconst CameraTool = ({ onCancel, onShutter, defaultRefPhotoId }) => {\n  const classes = useStyles()\n  const [slider, setSlider] = useState(50)\n  const [size, setSize] = useState([null, null])\n\n  const { series, seriesConfig } = useContext(SeriesContext)\n\n  const newRefPhoto = defaultRefPhotoId\n    ? series.photos.find(p => p.id === defaultRefPhotoId)\n    : series && series.photos && series.photos.length > 0 ? series.photos[0] : null\n\n  const [refPhoto, setRefPhoto] = useState(newRefPhoto)\n  const [drawerOpen, setDrawerOpen] = useState(false)\n  const { cameraError, captureImage, cameraOnline } = useCamera(\n    (data) => onShutter(data, refPhoto ? refPhoto.id : null),\n    size[0],\n    size[1]\n  )\n\n  const handleTileClick = (id) => {\n    setRefPhoto(series.photos.find(p => p.id === id))\n    setDrawerOpen(false)\n  }\n\n  const handleResize = () => {\n    setSize([window.innerWidth, window.innerHeight])\n  }\n\n  useLayoutEffect(() => {\n    handleResize()\n    window.addEventListener('resize', handleResize)\n    return () => {\n      window.removeEventListener('resize', handleResize)\n    }\n  }, [])\n\n  return (\n    <div className={classes.root}>\n      <CssBaseline />\n      { !cameraError && Boolean(refPhoto) && (\n        <PhotoFadeSlider defaultValue={slider} onChange={setSlider} />\n      )}\n\n      { cameraError && (\n        <div className={classes.cameraErrorText}>\n          <Typography variant='subtitle1' color='inherit'>No Camera Access</Typography>\n          <Typography variant='body2' color='inherit'>Please enabled access in your settings.</Typography>\n        </div>\n      )}\n\n      { Boolean(refPhoto) && (\n        <div className={classes.reference} >\n          <RawImage\n            sizePriority={['large', 'medium', 'thumb']}\n            getPhotoUrls={seriesConfig.getPhotoUrls}\n            style={{ opacity: slider / 100 }}\n            photo={refPhoto}\n          />\n        </div>\n      )}\n      { !cameraError && (\n        <video\n          autoPlay\n          playsInline\n          muted\n          id='webcam'\n          width={window.innerWidth}\n          height={window.innerHeight}\n          className={classes.video}\n        />\n      )}\n\n      <Fab\n        color='primary'\n        aria-label='Take Photo'\n        classes={{\n          disabled: classes.disabledFab\n        }}\n        disabled={cameraError || !cameraOnline}\n        className={classNames(classes.cameraFab, classes.buttonFab)}\n        onClick={captureImage}\n      >\n        <CameraIcon className={classes.cameraIcon} />\n      </Fab>\n\n      <Fab\n        color='secondary'\n        aria-label='cancel'\n        onClick={onCancel}\n        classes={{\n          disabled: classes.disabledFab\n        }}\n        className={classNames(classes.cancelFab, classes.buttonFab)}\n      >\n        <CancelIcon className={classes.cancelIcon} />\n      </Fab>\n\n      {series && series.photos && (\n        <Fab\n          aria-label='library'\n          className={classNames(classes.libraryFab, classes.buttonFab)}\n          classes={{\n            disabled: classes.disabledFab\n          }}\n          disabled={!series || !series.photos || series.photos.length === 0}\n          onClick={() => setDrawerOpen(true)}\n        >\n          <PhotoLibraryIcon className={classes.libraryIcon} />\n        </Fab>\n      )}\n\n      {series && series.photos && (\n        <SwipeableDrawer\n          anchor='left'\n          open={drawerOpen}\n          classes={{\n            paperAnchorLeft: classes.swipeDrawer\n          }}\n          onClose={() => setDrawerOpen(false)}\n          onOpen={() => setDrawerOpen(true)}\n        >\n          <div\n            tabIndex={0}\n            className={classes.swipeDrawerContainer}\n            role='button'\n            onClick={() => setDrawerOpen(false)}\n            onKeyDown={() => setDrawerOpen(false)}\n          >\n            <PhotoGrid\n              multiSelect={false}\n              columns={1}\n              photos={series.photos}\n              onTileClick={handleTileClick}\n            />\n          </div>\n        </SwipeableDrawer>\n      )}\n\n    </div>\n  )\n}\n\nCameraTool.propTypes = {\n  defaultRefPhotoId: PropTypes.string, // id of the reference photo\n  onCancel: PropTypes.func.isRequired,\n  onShutter: PropTypes.func.isRequired\n}\n\nexport default CameraTool\n","export default theme => ({\n  root: {\n    background: 'black',\n    // border: '5px solid red',\n    height: '100%',\n    width: '100%'\n  },\n  cameraErrorText: {\n    color: 'white',\n    position: 'absolute',\n    top: '50%',\n    left: '50%',\n    width: '90%',\n    transform: 'translateY(-50%) translateX(-50%)',\n    textAlign: 'center'\n  },\n  disabledFab: {\n    color: '#AAAAA!important',\n    background: '#DDDDDD!important',\n    opacity: 0.2\n  },\n  cameraFab: {\n    position: 'absolute',\n    zIndex: 10,\n    '@media (orientation: landscape)': {\n      right: '20px',\n      top: '50%',\n      transform: 'translateY(-50%)',\n      height: '25vh',\n      width: '25vh'\n    },\n    '@media (orientation: portrait)': {\n      bottom: '20px',\n      left: '50%',\n      transform: 'translateX(-50%)',\n      height: '25vw',\n      width: '25vw'\n    }\n  },\n  cameraIcon: {\n    height: '100%',\n    width: '100%'\n  },\n  cancelFab: {\n    position: 'absolute',\n    zIndex: 10,\n    '@media (orientation: landscape)': {\n      right: '15px',\n      top: '15px',\n      height: '15vh',\n      width: '15vh'\n    },\n    '@media (orientation: portrait)': {\n      right: '15px',\n      bottom: '15px',\n      height: '15vw',\n      width: '15vw'\n    }\n  },\n  cancelIcon: {\n    height: '100%',\n    width: '100%'\n  },\n\n  swipeDrawer: {\n    width: '50%'\n  },\n\n  libraryFab: {\n    position: 'absolute',\n    zIndex: 10,\n    '@media (orientation: landscape)': {\n      left: '15px',\n      top: '15px',\n      height: '15vh',\n      width: '15vh'\n    },\n    '@media (orientation: portrait)': {\n      left: '15px',\n      top: '15px',\n      height: '15vw',\n      width: '15vw'\n    }\n  },\n\n  myLocationFab: {\n    position: 'absolute',\n    zIndex: 10,\n    '@media (orientation: landscape)': {\n      right: '15px',\n      bottom: '15px',\n      height: '15vh',\n      width: '15vh'\n    },\n    '@media (orientation: portrait)': {\n      left: '15px',\n      bottom: '15px',\n      height: '15vw',\n      width: '15vw'\n    }\n  },\n  myLocationIcon: {\n    height: '80%',\n    width: '80%'\n  },\n\n  captured: {\n\n  },\n  reference: {\n    position: 'absolute',\n    zIndex: 2,\n    top: 0,\n    left: 0,\n    height: '100%',\n    width: '100%'\n  },\n  video: {\n    position: 'absolute',\n    zIndex: 1,\n    top: 0,\n    left: 0,\n    height: '100%',\n    width: '100%'\n    // '@media (orientation: portrait)': {\n    //   transform: 'rotate(90)'\n    // }\n  }\n})\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport Typography from '@material-ui/core/Typography'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport DialogActions from '@material-ui/core/DialogActions'\nimport Button from '@material-ui/core/Button'\n\nimport SeriesEditInner from './subViews/SeriesEditInner'\n\n// import { SeriesContext } from '../contexts'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport style from './NewPhotoInfo.style'\nimport PhotoInfoInner from './subViews/PhotoInfoInner'\n\nconst useStyles = makeStyles(style)\n\nconst NewPhotoInfo = ({ photo, newSeries, onCancel, onSave }) => {\n  const classes = useStyles()\n  // const { series } = useContext(SeriesContext)\n  const [seriesDelta, setSeriesDelta] = useState(newSeries || {})\n  const [photoDelta, setPhotoDelta] = useState(photo)\n\n  return (\n    <div className={classes.root}>\n      <CssBaseline /> {/* You only need this in a root element. Don't put it anywhere else in the dom */}\n      <Dialog\n        fullScreen\n        scroll='paper'\n        disableBackdropClick\n        disableEscapeKeyDown\n        onClose={onCancel}\n        aria-labelledby='customized-dialog-title'\n        open\n      >\n        <DialogTitle disableTypography className={classes.dlgTitleContainer}>\n          <Typography variant='h5' className={classes.dlgTitle}>\n          New Photo Properties\n          </Typography>\n        </DialogTitle>\n        <DialogContent>\n\n          {!!newSeries && (\n            <SeriesEditInner\n              series={newSeries}\n              delta={seriesDelta}\n              onChange={setSeriesDelta}\n            />\n          )}\n\n          <PhotoInfoInner\n            photo={photo}\n            canEdit\n            delta={photoDelta}\n            onChange={(newAttr) => setPhotoDelta({ ...photoDelta, ...newAttr })}\n          />\n\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={onCancel} color='primary'>\n            Cancel\n          </Button>\n          <Button onClick={() => onSave(seriesDelta, photoDelta)} color='primary'>\n            Next\n          </Button>\n        </DialogActions>\n      </Dialog>\n    </div>\n  )\n}\n\nNewPhotoInfo.propTypes = {\n  photo: PropTypes.object.isRequired,\n  newSeries: PropTypes.object,\n  // Standard functions\n  onCancel: PropTypes.func.isRequired,\n  onSave: PropTypes.func\n}\n\nexport default NewPhotoInfo\n","export default theme => ({\n  root: {\n\n  },\n  formLabel: {\n    color: theme.palette.text.secondary\n  },\n  mapFormLabel: {\n    marginTop: theme.spacing(2),\n    marginBottom: theme.spacing(1),\n    color: theme.palette.text.secondary\n  },\n  map: {\n    marginBottom: theme.spacing(2)\n  },\n  mapWrapper: {\n    marginBottom: theme.spacing(2)\n  },\n  field: {\n    marginBottom: theme.spacing(2)\n  }\n})\n","import React, { useEffect, useRef } from 'react'\n\n// https://developers.google.com/web/fundamentals/media/capturing-images/\nconst useFileInput = (onChange = () => {}, preferCamera, initialClick = true, anyFile = false) => {\n  const inputRef = useRef()\n  const clickRef = useRef()\n\n  const element = (\n    <input style={{ display: 'none' }} ref={inputRef} type='file' accept={!anyFile ? 'image/*' : null} capture={preferCamera} />\n  )\n\n  const forceClick = () => {\n    if (inputRef.current) inputRef.current.click()\n  }\n\n  useEffect(() => {\n    const handleChange = evt => {\n      const [file] = [...inputRef.current.files]\n      if (file) {\n        console.log('file', file)\n        const reader = new FileReader()\n        reader.onloadend = () => {\n          const { type, name, size } = file\n          onChange({ dataUrl: reader.result, type, name, size, ext: getExtFromFile(file) })\n        }\n        reader.readAsDataURL(file)\n      }\n      inputRef.current.value = null\n    }\n\n    if (inputRef.current) {\n      inputRef.current.addEventListener('change', handleChange)\n      if (!clickRef.current) {\n        if (initialClick) inputRef.current.click()\n        clickRef.current = true\n      }\n    }\n    return () => {\n      if (inputRef.current) {\n        inputRef.current.removeEventListener('change', handleChange)\n      }\n    }\n  }, [inputRef.current])\n\n  return { fileClickEl: element, forceClick, inputRef }\n}\n\nexport default useFileInput\n\nconst getExtFromFile = (fileBlob) => {\n  switch (fileBlob.type) {\n    case 'image/jpeg':\n      return 'jpeg'\n    case 'image/jpg':\n      return 'jpeg'\n    case 'image/png':\n      return 'png'\n    default:\n      return 'jpg'\n  }\n}\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport PhotoLibraryIcon from '@material-ui/icons/PhotoLibrary'\nimport CameraAltIcon from '@material-ui/icons/CameraAlt'\nimport { makeStyles } from '@material-ui/core/styles'\nimport useFileInput from '../../../../lib/useFileInput'\nimport { Button } from '@material-ui/core'\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    height: '100%',\n    display: 'flex',\n    flexDirection: 'column',\n    textAlign: 'center',\n    color: theme.palette.grey[600],\n    border: `20px solid ${theme.palette.grey[400]}`\n  },\n  icon: {\n    color: theme.palette.grey[600],\n    margin: 'auto',\n    flex: '1 1 50%',\n    height: '70%',\n    width: '70%'\n  },\n  button: {\n    margin: theme.spacing(2)\n  }\n}))\n\nconst LibraryFilePicker = ({ onLibraryAdd, onCancel, cameraPicker }) => {\n  const classes = useStyles()\n  const { fileClickEl, forceClick } = useFileInput(onLibraryAdd, cameraPicker)\n  let cameraWords = 'Library'\n  let PlaceIcon = PhotoLibraryIcon\n\n  if (cameraPicker) {\n    cameraWords = 'Camera'\n    PlaceIcon = CameraAltIcon\n  }\n\n  return (\n    <div className={classes.root}>\n      {fileClickEl}\n      <PlaceIcon className={classes.icon}color='inherit' onClick={forceClick} />\n      <Button variant='contained' className={classes.button} color='primary' onClick={forceClick}>\n        Import from {cameraWords}\n      </Button>\n      <Button variant='outlined' className={classes.button} color='secondary' onClick={onCancel}>\n        Cancel\n      </Button>\n    </div>\n  )\n}\n\nLibraryFilePicker.propTypes = {\n  onLibraryAdd: PropTypes.func.isRequired,\n  cameraPicker: PropTypes.bool,\n  onCancel: PropTypes.func.isRequired\n}\n\nexport default LibraryFilePicker\n","import SeriesConfig from './SeriesConfig'\nimport uuidv4 from 'uuid/v4'\n\nclass Series {\n  constructor (seriesConfig, series) {\n    this.config = new SeriesConfig(seriesConfig)\n    if (series) this.series = series\n    else {\n      this.series = this.newSeries()\n    }\n  }\n\n  setMeta = () => {\n    this.meta = JSON.stringify(this.config.getSeriesMeta())\n  }\n\n  newSeries = () => ({\n    id: `L-${uuidv4()}`,\n    meta: JSON.stringify(this.config.getSeriesMeta()),\n    photos: []\n  })\n}\n\nexport default Series\n","import React, { useState, useContext } from 'react'\nimport PropTypes from 'prop-types'\n\nimport PhotoReviewTool from './PhotoReviewTool'\nimport CameraTool from './CameraTool'\nimport NewPhotoInfo from './NewPhotoInfo'\nimport LibraryFilePicker from './controls/LibraryFilePicker'\n\nimport PhotoClass, { getExif } from '../../../lib/Photo'\nimport SeriesClass from '../../../lib/Series'\nimport { useDeviceOrientation, useGeolocation } from '../../../lib/sensors'\n\nimport { SeriesContext } from '../contexts'\n\nexport const MODES = {\n  CAMERA: 'camera',\n  LEGACY_CAMERA: 'legacyCamera',\n  FILEPICKER: 'library',\n  PHOTOREVIEW: 'photoreview',\n  PHOTOINFOEDIT: 'photoinfoedit'\n}\n\nconst NewPhoto = ({ inputMethod, onCreate, onCancel, isNewSeries }) => {\n  const { seriesConfig, series } = useContext(SeriesContext)\n\n  // This will hold our urlData base64-encoded image\n  const [newPhotoData, setNewPhotoData] = useState(null)\n\n  // Instantiate common-sense empty objects.\n  const [newSeries, setNewSeries] = useState(isNewSeries ? new SeriesClass(seriesConfig).series : series)\n  const [newPhoto, setNewPhoto] = useState(new PhotoClass(seriesConfig).photo)\n\n  const [photoRefId, setPhotoRefId] = useState(null)\n  const [mode, _changeMode] = useState({ current: inputMethod, history: [] })\n  const orientation = useDeviceOrientation()\n  const geo = useGeolocation()\n\n  const photos = !isNewSeries && series && series.photos ? series.photos : []\n\n  const changeMode = (newModeName) => {\n    console.log('NEWPHOTO changeMode', mode, newModeName)\n    _changeMode({\n      current: newModeName,\n      history: [...mode.history, mode.current]\n    })\n  }\n  const lastMode = () => {\n    if (mode.history.length > 0) {\n      const oldHistory = [...mode.history]\n      const oldMode = oldHistory.pop()\n      _changeMode({\n        current: oldMode,\n        history: oldHistory\n      })\n    }\n    else {\n      onCancel()\n    }\n  }\n\n  const onLibraryAdd = (data) => {\n    console.log('onLibraryAdd Debug GOT DATA', { data, isNewSeries })\n    setNewPhotoData(data)\n    // Ok, now try to get the datetime off the EXIF\n    const { exif, exifDateTime, exifGPS } = getExif(data.dataUrl)\n    let coords = exifGPS\n    const date = exifDateTime || String(Date.now())\n    if (!coords) {\n      if (geo && geo.latitude && geo.longitude) {\n        const { latitude, longitude } = geo\n        coords = [longitude, latitude]\n      }\n      else {\n        // Stanley park as a fallback if we can't get the geo or exif data\n        coords = [-123.1398254, 49.3050394]\n      }\n    }\n\n    if (isNewSeries) setNewSeries({ ...newSeries, coords })\n\n    console.log('LATLONG FOR LIB PICK', { coords, exifGPS, geo })\n\n    const _newPhoto = {\n      ...newPhoto,\n      takenOn: date,\n      rawData: JSON.stringify({\n        exif,\n        sensors: {\n          orientation,\n          geo\n        }\n      })\n    }\n    setNewPhoto(_newPhoto)\n    console.log('onLibraryAdd', _newPhoto)\n    changeMode(MODES.PHOTOREVIEW)\n    console.log('onLibraryAdd FINISHED', _newPhoto)\n  }\n\n  const onShutter = (data, refId) => {\n    setNewPhotoData(data)\n    console.log('onShutter Debug GOT DATA', { data })\n    const { exif, exifGPS } = getExif(data.dataUrl)\n\n    const date = String(Date.now())\n    // with the camera we prioritize the geoLocation over EXIF gps data\n    let coords = geo\n    if (!coords) {\n      if (geo && exifGPS) {\n        coords = exifGPS\n      }\n      else {\n        // Stanley park as a fallback if we can't get the geo or exif data\n        coords = [-123.1398254, 49.3050394]\n      }\n    }\n\n    if (isNewSeries) setNewSeries({ ...newSeries, coords })\n\n    const _newPhoto = {\n      ...newPhoto,\n      takenOn: date,\n      rawData: JSON.stringify({\n        exif,\n        sensors: {\n          orientation,\n          geo\n        }\n      })\n    }\n    setNewPhoto(_newPhoto)\n    console.log('onShutter', _newPhoto)\n    setPhotoRefId(refId)\n    changeMode(MODES.PHOTOREVIEW)\n  }\n\n  const onFinalCreate = (seriesDelta, photoDelta) => onCreate(seriesDelta, photoDelta, newPhotoData)\n\n  let component = null\n  switch (mode.current) {\n    case MODES.CAMERA:\n      component = (\n        <CameraTool\n          photos={photos}\n          onShutter={onShutter}\n          onCancel={onCancel}\n        />\n      )\n      break\n    case MODES.LEGACY_CAMERA:\n      component = (\n        component = <LibraryFilePicker\n          onCancel={onCancel}\n          cameraPicker\n          onLibraryAdd={onLibraryAdd}\n        />\n      )\n      break\n    case MODES.FILEPICKER:\n      component = <LibraryFilePicker\n        onCancel={onCancel}\n        onLibraryAdd={onLibraryAdd}\n      />\n      // fileClick() // move this to useEffect to help with click handling\n      break\n    case MODES.PHOTOREVIEW:\n      component = (\n        <PhotoReviewTool\n          defaultRefPhotoId={photoRefId}\n          photos={photos}\n          captured={newPhoto}\n          dataUrl={newPhotoData.dataUrl}\n          onConfirm={() => changeMode(MODES.PHOTOINFOEDIT)}\n          onCancel={onCancel}\n          onRetry={lastMode}\n        />\n      )\n      break\n    case MODES.PHOTOINFOEDIT:\n      component = (\n        <NewPhotoInfo\n          photo={newPhoto}\n          newSeries={newSeries}\n          onSave={onFinalCreate}\n          onCancel={onCancel}\n        />\n      )\n      break\n    default:\n      console.log('NEWPHOTO: default state. you should NEVER see this', mode)\n      onCancel()\n  }\n\n  return component\n}\n\nNewPhoto.propTypes = {\n  inputMethod: PropTypes.oneOf(['camera', 'library']),\n  onCreate: PropTypes.func.isRequired,\n  onCancel: PropTypes.func.isRequired,\n  isNewSeries: PropTypes.bool,\n  seriesConfig: PropTypes.object,\n  // This might be a new series so we might have\n  // actions to work on that\n  // This will be provided EITHER photos or onSeriesCreate\n  photos: PropTypes.array\n}\n\nexport default NewPhoto\n","import AccessControl from 'accesscontrol'\n\nclass AccessHelper {\n  constructor (userSub, role, permissionObj) {\n    this.userSub = userSub\n    this.role = role\n    this.permissionObj = permissionObj\n    this.ac = new AccessControl(permissionObj)\n  }\n\n  // Return the string 'Own' or the string 'Any'\n  ownOrAny = (obj) => {\n    if (!obj || !obj.createdUser || !obj.createdUser.id) throw new Error(`No Created user found`)\n    try {\n      return obj.createdUser.id === this.userSub ? 'Own' : 'Any'\n    }\n    catch (e) {\n      return 'Any'\n    }\n  }\n\n  isOwner = (obj) => {\n    if (!obj || !obj.createdUser || !obj.createdUser.id) throw new Error(`No Created user found`)\n    try {\n      return obj.createdUser.id === this.userSub\n    }\n    catch (e) {\n      return false\n    }\n  }\n\n  toString () {\n    console.log('AccessHelper:', { sub: this.userSub, role: this.role })\n  }\n\n  canUser = (action, obj, type, attrs) => {\n    if (['series', 'photo'].indexOf(type) < 0) throw new Error(`canUser: type not supported ${type}`)\n\n    try {\n      const ownAny = this.ownOrAny(obj)\n\n      const perm = this.ac.can(this.role)[`${action}${ownAny}`](type)\n      let otherPerm = null\n      if (type === 'series') {\n        if (obj.access === 'PUBLIC') otherPerm = this.ac.can(this.role)[`${action}${ownAny}`]('series_public')\n        else if (obj.access === 'OPEN') otherPerm = this.ac.can(this.role)[`${action}${ownAny}`]('series_open')\n      }\n\n      // Trying to recreate the form `can(role).readAny`\n      if (attrs) {\n        if (otherPerm) {\n          return !!perm.attributes.find(p => p === '*' || attrs.indexOf(p) > -1) ||\n           !!otherPerm.attributes.find(p => p === '*' || attrs.indexOf(p) > -1)\n        }\n        else return !!perm.attributes.find(p => p === '*' || attrs.indexOf(p) > -1)\n      }\n      else {\n        if (otherPerm) return perm.granted || otherPerm.granted\n        else return perm.granted\n      }\n    }\n    catch (e) {\n      console.error(e)\n      return false\n    }\n  }\n}\n\nexport default AccessHelper\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport AppBar from '@material-ui/core/AppBar'\nimport Toolbar from '@material-ui/core/Toolbar'\nimport IconButton from '@material-ui/core/IconButton'\nimport Typography from '@material-ui/core/Typography'\n\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport style from './SeriesView.style'\nconst useStyles = makeStyles(style)\n\nconst SeriesNotFound = ({ onMenuBack }) => {\n  const classes = useStyles()\n\n  return (\n    <div className={classes.root}>\n      <CssBaseline />\n      <AppBar position='static' className={classes.appBar}>\n        <Toolbar disableGutters>\n          <IconButton className={classes.menuButton} color='inherit' onClick={onMenuBack} aria-label='Menu'>\n            <ArrowBackIcon />\n          </IconButton>\n          <Typography variant='subtitle1' color='inherit' className={classes.toolbarTitle}>\n            Series\n          </Typography>\n        </Toolbar>\n      </AppBar>\n\n      <div className={classes.placeholderInner}>\n        <div className={classes.grow} />\n        <Typography className={classes.placeholderText} variant='h3'>\n            Series not found\n        </Typography>\n        <div className={classes.grow} />\n      </div>\n    </div>\n  )\n}\n\nSeriesNotFound.propTypes = {\n  // Action functions\n  onMenuBack: PropTypes.func.isRequired\n}\n\nexport default SeriesNotFound\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport AppBar from '@material-ui/core/AppBar'\nimport Toolbar from '@material-ui/core/Toolbar'\nimport IconButton from '@material-ui/core/IconButton'\nimport Typography from '@material-ui/core/Typography'\nimport CircularProgress from '@material-ui/core/CircularProgress'\n\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport style from './SeriesView.style'\nconst useStyles = makeStyles(style)\n\nconst SeriesLoading = ({ onMenuBack }) => {\n  const classes = useStyles()\n\n  return (\n    <div className={classes.root}>\n      <CssBaseline />\n      <AppBar position='static' className={classes.appBar}>\n        <Toolbar disableGutters>\n          <IconButton className={classes.menuButton} color='inherit' onClick={onMenuBack} aria-label='Menu'>\n            <ArrowBackIcon />\n          </IconButton>\n          <Typography variant='subtitle1' color='inherit' className={classes.toolbarTitle}>\n            Series\n          </Typography>\n        </Toolbar>\n      </AppBar>\n\n      <div className={classes.placeholderInner}>\n        <div className={classes.grow} />\n        <div className={classes.progressWrapper}>\n          <CircularProgress className={classes.progress} color='inherit' size={150} thickness={5} />\n        </div>\n        <Typography className={classes.placeholderText} variant='h4'>\n            Loading...\n        </Typography>\n        <div className={classes.grow} />\n      </div>\n    </div>\n  )\n}\n\nSeriesLoading.propTypes = {\n  // Action functions\n  onMenuBack: PropTypes.func.isRequired\n}\n\nexport default SeriesLoading\n","import React, { useState, useEffect } from 'react'\nimport PropTypes from 'prop-types'\n\nimport SeriesView from './views/SeriesView'\nimport SeriesEdit from './views/SeriesEdit'\nimport Slideshow from './views/Slideshow'\nimport PhotoViewTool from './views/PhotoViewTool'\nimport NewPhoto from './views/NewPhoto'\nimport AccesHelper from '../../lib/AccessHelper'\n\nimport { SeriesContext } from './contexts'\nimport SeriesNotFound from './views/SeriesNotFound'\nimport SeriesLoading from './views/SeriesLoading'\n\nexport const MODES = {\n  SERIES_VIEW: 'series',\n  SERIES_EDIT: 'editseries',\n  NEWPHOTO: 'newphoto',\n  NEWSERIES: 'newseries',\n  REVIEW: 'review',\n  PHOTO_VIEW: 'photoviewer',\n  PHOTO_VIEW_NEW: 'newphotoviewer',\n  SLIDESHOW: 'slideshow'\n}\nconst VIEW_ONLY_MODES = [MODES.SERIES_VIEW, MODES.PHOTO_VIEW, MODES.SLIDESHOW]\nconst VALID_STARTMODES = [MODES.SERIES_VIEW, MODES.NEWPHOTO, MODES.NEWSERIES, MODES.PHOTO_REVIEW, MODES.PHOTO_VIEW]\n\n/**\n * This component ties all the Repeat Photo components together\n */\nconst RepeatablePhotos = ({\n  modeName, series, seriesConfig, inputMethod: inputMethodINIT,\n  currentUserId, currentUserRole, accessControl, initialPhoto,\n  onChange, onClose, onDelete, onNewSeries, onChangePhoto,\n  onNewPhoto, onDeletePhoto, loading, onFindOnMap,\n  onWatch, onUnWatch, watching, owned\n}) => {\n  // Manage view modes separately\n  // This is a pretty normal pattern for context\n  const [seriesState, setState] = useState({\n    series,\n    seriesConfig,\n    ac: accessControl ? new AccesHelper(currentUserId, currentUserRole, accessControl) : null\n  })\n\n  const [mode, setMode] = useState({\n    current: {\n      name: modeName || MODES.SERIES_VIEW,\n      pid: initialPhoto,\n      inputMethod: inputMethodINIT\n    },\n    history: []\n  })\n\n  useEffect(() => {\n    setState({ ...seriesState, series })\n    setMode({\n      current: {\n        name: modeName || MODES.SERIES_VIEW,\n        pid: initialPhoto,\n        inputMethod: inputMethodINIT\n      },\n      history: []\n    })\n  }, [series])\n\n  // When anything changes about a photo\n  const onUpdatePhoto = (photo, photoDelta) => {\n    const newSeries = { ...seriesState.series }\n    newSeries.photos = newSeries.photos.map(ph => ph.id === photoDelta.id ? { ...ph, ...photoDelta } : ph)\n    onChangePhoto(photo, { ...photoDelta, seriesId: newSeries.id })\n  }\n\n  const onApprovePhoto = async (newSeries, newPhoto, newPhotoData) => {\n    // Pass this all back so that graphQl can handle it\n    console.log('RepeatablePhotos: waiting for photo ID', { newSeries, newPhoto, newPhotoData })\n    await onNewPhoto(newPhoto, newPhotoData)\n\n    setState({\n      ...seriesState,\n      series: {\n        ...series,\n        photos: [...series.photos, newPhoto]\n      }\n    })\n    changeMode(MODES.PHOTO_VIEW_NEW, newPhoto.id)\n  }\n\n  // const onCreateSeries = async (newSeries, newPhoto, newPhotoData) => {\n  //   console.log('RepeatablePhotos: waiting for series ID', { newSeries, newPhoto, newPhotoData })\n\n  //   await onNewSeries(newSeries, newPhoto, newPhotoData)\n  //   console.log('RepeatablePhotos done. showing the series')\n  //   changeMode(MODES.SERIES_VIEW)\n  // }\n\n  // When a photo is removed\n  const onDeletePhotos = (photoIdArr) => {\n    series.photos.filter(sp => photoIdArr.indexOf(sp.id) > -1).forEach(p => onDeletePhoto(p))\n  }\n\n  // Here's our modeChanger. My guess it will get a lot more complicated\n  // once the reducers get in and working\n  const changeMode = (newModeName, newPid, newInputMethod) => {\n    const canUpdate = seriesState.ac.canUser('update', series, 'series')\n    if (seriesState === null) onClose()\n    if (!canUpdate && VIEW_ONLY_MODES.indexOf(newModeName) < 0) {\n      console.error('ILLEGAL MODE CHANGE!!!!!', { from: mode.current, to: newModeName, canUpdate })\n    }\n    else {\n      // console.log('CHANGING MODE TO', newModeName)\n      setMode({\n        current: {\n          name: newModeName,\n          pid: newPid,\n          inputMethod: newInputMethod\n        },\n        history: [...mode.history, mode.current]\n      })\n    }\n  }\n  const lastMode = () => {\n    // console.log('REPEATABLEPHOTOS lastMode', mode)\n    if (mode.history.length > 0) {\n      const oldHistory = [...mode.history]\n      const oldMode = oldHistory.pop()\n      setMode({\n        current: oldMode,\n        history: oldHistory\n      })\n    }\n    else {\n      onClose()\n    }\n  }\n\n  // The action to initiate the photo viewer\n  const viewPhoto = (pid) => {\n    // console.log('DEBUG', mode, series.photos.find(p => p.id === pid))\n    changeMode(MODES.PHOTO_VIEW, pid)\n  }\n\n  let component = null\n\n  if (loading) return <SeriesLoading onMenuBack={onClose} />\n  else if (!seriesState.series && mode.current.name !== MODES.NEWSERIES) return <SeriesNotFound onMenuBack={onClose} />\n\n  switch (mode.current.name) {\n    case MODES.SERIES_VIEW:\n      component = (\n        <SeriesView\n          // This one has lots of functionsgit add\n          onSlideshowStart={() => changeMode(MODES.SLIDESHOW)}\n          onChange={() => {\n            console.log('onChange NOT IMPLEMENTED')\n          }}\n          watching={watching}\n          owned={owned}\n          initialPhoto={initialPhoto}\n          onDeletePhotos={onDeletePhotos}\n          onDeleteSeries={onDelete}\n          onFindOnMap={onFindOnMap}\n          onCameraAdd={() => changeMode(MODES.NEWPHOTO, null, 'camera')}\n          onEditSeries={() => changeMode(MODES.SERIES_EDIT)}\n          onLibraryAdd={() => changeMode(MODES.NEWPHOTO, null, 'library')}\n          onTileClick={viewPhoto}\n          onMenuBack={onClose}\n          onWatch={onWatch}\n          onUnWatch={onUnWatch}\n        />\n      )\n      break\n    case MODES.SERIES_EDIT:\n      component = (\n        <SeriesEdit\n          onCancel={() => changeMode(MODES.SERIES_VIEW)}\n          onOk={(seriesDelta) => {\n            onChange(series, { ...seriesDelta, id: series.id })\n            changeMode(MODES.SERIES_VIEW)\n          }}\n        />\n      )\n      break\n    case MODES.PHOTO_VIEW:\n      component = (\n        <PhotoViewTool\n          photos={seriesState.series.photos}\n          initPhotoId={mode.current.pid}\n          onMenuBack={lastMode}\n          onUpdatePhoto={onUpdatePhoto}\n        />\n      )\n      break\n    case MODES.PHOTO_VIEW_NEW:\n      component = (\n        <PhotoViewTool\n          photos={seriesState.series.photos}\n          initPhotoId={mode.current.pid}\n          newPhoto\n          onMenuBack={() => changeMode(MODES.SERIES_VIEW)}\n          onUpdatePhoto={onUpdatePhoto}\n        />\n      )\n      break\n    case MODES.SLIDESHOW:\n      component = (\n        <Slideshow photos={seriesState.series.photos} onCancel={lastMode} />\n      )\n      break\n    case MODES.NEWPHOTO:\n      component = (\n        <NewPhoto\n          inputMethod={mode.current.inputMethod}\n          photos={series ? series.photos : null}\n          onCreate={onApprovePhoto}\n          onCancel={lastMode}\n        />\n      )\n      break\n    case MODES.NEWSERIES:\n      component = (\n        <NewPhoto\n          inputMethod={mode.current.inputMethod}\n          isNewSeries\n          onCreate={onNewSeries}\n          onCancel={lastMode}\n        />\n      )\n      break\n    default:\n      console.log('REPEATABLEPHOTO: default state. you should NEVER see this', seriesState)\n      component = null\n  }\n\n  return (\n    <SeriesContext.Provider value={seriesState}>\n      {component}\n    </SeriesContext.Provider>\n  )\n}\n\nRepeatablePhotos.propTypes = {\n  modeName: PropTypes.oneOf(VALID_STARTMODES),\n  seriesConfig: PropTypes.object.isRequired,\n  watching: PropTypes.bool,\n  owned: PropTypes.bool,\n\n  currentUserId: PropTypes.string,\n  currentUserRole: PropTypes.string,\n  accessControl: PropTypes.object,\n\n  inputMethod: PropTypes.oneOf(['camera', 'library']),\n  series: PropTypes.object,\n  initialPhoto: PropTypes.string,\n  loading: PropTypes.bool,\n\n  // Now some functions to handle actions we might take\n  onChange: PropTypes.func.isRequired,\n  onFindOnMap: PropTypes.func.isRequired,\n  onChangePhoto: PropTypes.func.isRequired,\n  onDeletePhoto: PropTypes.func.isRequired,\n  onNewPhoto: PropTypes.func.isRequired,\n  onNewSeries: PropTypes.func.isRequired,\n  onDelete: PropTypes.func.isRequired,\n  onClose: PropTypes.func.isRequired,\n  onWatch: PropTypes.func,\n  onUnWatch: PropTypes.func\n\n}\nRepeatablePhotos.defaultProps = {\n  mode: MODES.SERIES_VIEW\n}\n\nexport default RepeatablePhotos\n","import React, { useContext } from 'react'\nimport PropTypes from 'prop-types'\nimport { home, tagColors } from '../config'\nimport permissions from '../permissions'\nimport { graphql, compose } from 'react-apollo'\nimport { connect } from 'react-redux'\nimport actions from '../redux/actions'\nimport { getWholeSeries } from '../graphql/queries'\nimport createSeries from '../graphql/mutations/createSeries'\nimport deleteSeries from '../graphql/mutations/deleteSeries'\nimport updateSeries from '../graphql/mutations/updateSeries'\nimport deletePhoto from '../graphql/mutations/deletePhoto'\nimport createPhoto from '../graphql/mutations/createPhoto'\nimport updatePhoto from '../graphql/mutations/updatePhoto'\nimport watch from '../graphql/mutations/watch'\nimport unwatch from '../graphql/mutations/unwatch'\nimport RepeatablePhotos, { MODES } from '../components/PhotoSeries'\nimport { AppContext } from '../contexts'\nimport { imgStore } from '../graphql/offline'\n// import { getExtFromBlob } from '../lib/Photo'\n\nimport { ThemeProvider } from '@material-ui/styles'\nimport themes from '../themes'\nimport { MODES as INPUT_MODES } from '../components/PhotoSeries/views/NewPhoto'\n\nconst SeriesConnect = ({\n  series, loading, domain, activeSeries, initialPhoto,\n  onAfterSeriesDelete, onBack, queueUpload,\n  createSeriesMutation, createPhotoMutation,\n  updateSeriesMutation, updatePhotoMutation,\n  deleteSeriesMutation, deletePhotoMutation,\n  watchSeriesMutation, unWatchSeriesMutation,\n  onFindOnMap\n}) => {\n  const { role, currentUser, user, signedIn, isIos, onAvatarClick, getPhotoUrls } = useContext(AppContext)\n  let inputMethod = 'camera'\n  // Hack until we can get good loading object sorted\n  if (domain === home.AppStateTypes.NEW_SERIES_CAMERA) {\n    if (isIos) inputMethod = INPUT_MODES.LEGACY_CAMERA\n    else inputMethod = INPUT_MODES.CAMERA\n  }\n  else if (domain === home.AppStateTypes.NEW_SERIES_LIBRARY) inputMethod = INPUT_MODES.FILEPICKER\n\n  // console.log('SeriesConnect', { series, loading, currentState, activeSeries, role, currentUser })\n  let modeName = MODES.SERIES_VIEW\n  if (domain !== home.AppStateTypes.SERIES) modeName = MODES.NEWSERIES\n\n  // Series config is the object that series needs to know how to process things outside itself (like lookup urls etc.)\n  const seriesConfig = {\n    meta: {},\n    tags: [\n      {\n        isIos,\n        id: 'freeBothType',\n        label: null,\n        color: tagColors[0],\n        allowXY: true,\n        allowNonXY: true,\n        allowAdditions: true,\n        // This one returns a promise\n        getValues: () => Promise.resolve(['a', 'b', 'c']),\n        imgStore,\n        values: []\n      }\n    ],\n    onAvatarClick,\n    getPhotoUrls\n  }\n\n  let owned = false\n  try {\n    owned = user.id === series.createdUser.id\n  }\n  catch (e) {}\n  console.log('[SERIESCONNECT]', { activeSeries, series, loading, owned, user })\n\n  return (\n    <ThemeProvider theme={themes.series}>\n      <RepeatablePhotos\n        modeName={modeName}\n        inputMethod={inputMethod}\n\n        owned={owned}\n        watching={signedIn && user && user.watching && user.watching.indexOf(activeSeries) > -1}\n\n        // Everything we need to determine access\n        currentUserId={signedIn ? currentUser.attributes.sub : null}\n        currentUserRole={role}\n        accessControl={permissions}\n        loading={loading}\n        series={series}\n        initialPhoto={initialPhoto}\n        seriesConfig={seriesConfig}\n\n        // Now some functions to handle actions we might take\n        onNewPhoto={async (newPhoto, newPhotoData) => {\n          console.log('onNewPhoto::', { newPhoto, newPhotoData })\n          // Write this blob to the imgStore so we can use it later\n          await imgStore.setItem(newPhoto.uploadToken, newPhotoData)\n          return createPhotoMutation(series, newPhoto, newPhotoData.ext)\n            .then(({ data }) => {\n              // Now we can add this photo to the upload queue\n              const photo = data.createPhoto.photo\n              if (data.createPhoto.preAuth) {\n                const preAuth = JSON.parse(data.createPhoto.preAuth)\n\n                queueUpload({\n                  id: photo.id,\n                  uploadToken: photo.uploadToken,\n                  seriesId: photo.seriesId,\n                  preAuth\n                })\n              }\n            })\n            .catch(err => {\n              console.log('onNewPhoto:: Graphql Error', err.stack)\n              console.error(err)\n            })\n        }}\n        onChangePhoto={(photo, photoDelta) => updatePhotoMutation(photo, photoDelta)\n          .catch(err => {\n            console.log('onChangePhoto:: Graphql Error', err.stack)\n            console.error(err)\n          })\n        }\n        onDeletePhoto={(photo) => deletePhotoMutation(photo.id)\n          .then((...data) => {\n            console.log('onDeletePhoto:: photo deleted', data)\n          })\n          .catch(err => {\n            console.log('onDeletePhoto:: Graphql Error', err.stack)\n            console.error(err)\n          })\n        }\n        onChange={(series, seriesDelta) => updateSeriesMutation(series, seriesDelta)\n          .catch(err => {\n            console.log('onChange:: Graphql Error', err.stack)\n            console.error(err)\n          })\n        }\n        onNewSeries={async (newSeries, newPhoto, newPhotoData) => {\n          console.log('Series.connect:: onNewSeries starting', { newSeries, newPhoto, newPhotoData })\n          await imgStore.setItem(newPhoto.uploadToken, newPhotoData)\n          return createSeriesMutation(newSeries, newPhoto, newPhotoData.ext)\n            .then(async ({ data }) => {\n              if (data.createSeries.preAuth) {\n                // Now we can add this photo to the upload queue\n                const photo = data.createSeries.series.photos[0]\n                const preAuth = JSON.parse(data.createSeries.preAuth)\n\n                queueUpload({\n                  id: photo.id,\n                  uploadToken: photo.uploadToken,\n                  seriesId: photo.seriesId,\n                  preAuth\n                })\n              }\n            })\n            .catch(err => {\n              console.log('onNewSeries:: Graphql Error', err.stack)\n              console.error(err)\n            })\n        }}\n        onDelete={() => deleteSeriesMutation()\n          .catch(err => {\n            console.log('onDelete:: Graphql Error', err.stack)\n            console.error(err)\n          })\n        }\n        onClose={onBack}\n        onFindOnMap={onFindOnMap}\n        onWatch={signedIn ? watchSeriesMutation : null}\n        onUnWatch={signedIn ? unWatchSeriesMutation : null}\n      />\n    </ThemeProvider>\n  )\n}\nSeriesConnect.propTypes = {\n  domain: PropTypes.string,\n  activeSeries: PropTypes.string,\n  initialPhoto: PropTypes.string,\n\n  // From Redux\n  onAfterSeriesDelete: PropTypes.func,\n  queueUpload: PropTypes.func,\n  onBack: PropTypes.func,\n\n  // Data from apollo\n  series: PropTypes.object,\n\n  // Functions From Apollo\n  loading: PropTypes.bool,\n  updateSeriesMutation: PropTypes.func,\n  updatePhotoMutation: PropTypes.func,\n  deleteSeriesMutation: PropTypes.func,\n  deletePhotoMutation: PropTypes.func,\n  createSeriesMutation: PropTypes.func,\n  createPhotoMutation: PropTypes.func,\n  watchSeriesMutation: PropTypes.func,\n  unWatchSeriesMutation: PropTypes.func,\n  onFindOnMap: PropTypes.func\n}\n\n/**\n * Here's the graphql HOC that gets an individual series\n */\nconst withGetSelectedQuery = graphql(getWholeSeries, {\n  props: ({ data }) => {\n    if (data.error) console.error(data.error)\n    console.log('getWholeSeries:: ', { data })\n    let series = null\n    try {\n      if (!data.loading && !data.error) series = data.series\n    }\n    catch (e) {\n      console.log('getWholeSeries:: error', { data, e })\n      console.error(e)\n    }\n    return {\n      data,\n      loading: data.loading,\n      series\n    }\n  },\n  skip: ({ activeSeries, isNewSeries }) => !activeSeries || isNewSeries,\n  options: ({ activeSeries }) => ({\n    variables: {\n      id: activeSeries\n    }\n  })\n})\n\n/**\n * Compose all our queries together\n */\nconst connectedWithApollo = compose(\n  withGetSelectedQuery,\n  createSeries.withMutation,\n  createPhoto.withMutation,\n  updateSeries.withMutation,\n  updatePhoto.withMutation,\n  deleteSeries.withMutation,\n  deletePhoto.withMutation,\n  watch.withMutation,\n  unwatch.withMutation\n)(SeriesConnect)\n\n/**\n * Map our redux state and functions\n */\nconst mapStateToProps = (state, props) => {\n  const { current: { activeSeries, initialPhoto, domain } } = state.home\n  return { activeSeries, initialPhoto, domain }\n}\n\nconst mapDispatchToProps = dispatch => ({\n  onBack: () => {\n    dispatch(actions.homeStateBack())\n  },\n  onAfterSeriesDelete: (key, newProgress) => {\n    dispatch(actions.setHomeState(home.AppStateTypes.FEED))\n  },\n  queueUpload: (uploadObj) => {\n    dispatch(actions.queueUpload(uploadObj))\n  },\n  doneCreatingSeries: (activeSeries) => {\n    console.log('DONECREATINGSERIES', activeSeries)\n    dispatch(actions.setHomeState(home.AppStateTypes.SERIES, { activeSeries }))\n  },\n  onFindOnMap: () => {\n    dispatch(actions.setHomeState(home.AppStateTypes.MAP))\n  }\n})\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(connectedWithApollo)\n\n/**\n * We need to filter out null values and params we don't desire\n */\nfunction sanitizeUpdateParams (inputObj, desiredParams) {\n  const newDesiredParams = [...desiredParams, '__typename']\n  const remainder = Object.keys(inputObj).filter(key => newDesiredParams.indexOf(key) > -1)\n  console.log('sanitizeUpdateParams', { orig: Object.keys(inputObj), remainder })\n  return remainder.reduce((acc, key) => ({ ...acc, [key]: inputObj[key] }), {})\n}\n","import { useState, useEffect, useCallback } from 'react'\nimport uuid from 'uuid/v4'\nimport WebMercatorViewport from 'viewport-mercator-project'\nimport rbush from 'rbush'\nimport { point, centroid, featureCollection } from '@turf/turf'\nimport { debounce } from './util'\n\nconst useClusteredData = (data, filterBounds, currentZoom, viewport, sizeScale, queryVersion, isTransitioning) => {\n  const [clusteredData, setClusteredData] = useState([])\n  const [filteredData, setFilteredData] = useState({ single: [], cluster: [] })\n  const [version, setVersion] = useState(0)\n\n  // We promisify and debounce the expensive stuff so it runs outside our render loop\n  const updateDataDebounce = useCallback(debounce(async (...innerArgs) => {\n    const updatedData = await updateData(...innerArgs)\n    setClusteredData(updatedData)\n    // setClusteredData(updatedData)\n    setVersion(version + 1)\n  }, 1000), [])\n\n  const filterDataDebounce = useCallback(debounce(async (...innerArgs) => {\n    const filtered = await filterData(...innerArgs)\n    setFilteredData(filtered)\n  }, 300), [])\n\n  // Here's the really expensive call. Make sure this only runs when the data changes\n  useEffect(() => {\n    updateDataDebounce(data, sizeScale, viewport)\n  }, [data.length, queryVersion])\n\n  useEffect(() => {\n    if (!isTransitioning) filterDataDebounce(clusteredData, filterBounds, currentZoom)\n  }, [clusteredData, currentZoom, filterBounds, version, isTransitioning])\n\n  return { filteredClusteredData: filteredData }\n}\n\nexport default useClusteredData\n\n// Compute icon clusters\n// We use the projected positions instead of longitude and latitude to build\n// the spatial index, because this particular dataset is distributed all over\n// the world, we can't use some fixed deltaLon and deltaLat\nconst updateData = (data, sizeScale, viewport) => {\n  // console.log('----------------------------------UPDATE CLUSTER----------------------------------', { data, sizeScale, viewport })\n\n  if (!data) {\n    return []\n  }\n  const tree = rbush(9, ['.x', '.y', '.x', '.y'])\n\n  const transform = new WebMercatorViewport({\n    ...viewport,\n    zoom: 0\n  })\n\n  // console.log('DATA', data)\n  // The root of this is GeoJSON so that's what we have to build\n  const newData = data.map(p => {\n    // Create some GeoJSON that we can render as a dot\n    let screenCoords = [0, 0]\n    try {\n      screenCoords = transform.project(p.coords)\n    }\n    catch (e) {\n      console.error(e)\n    }\n    const { longitude, latitude, ...properties } = p\n    return {\n      x: screenCoords[0],\n      y: screenCoords[1],\n      photoCount: properties.photoCount,\n      zoomLevels: [],\n      geoJSON: p.coords ? point(p.coords, { ...properties }) : null\n    }\n  })\n\n  tree.clear()\n  tree.load(newData)\n\n  for (let z = 0; z <= 20; z++) {\n    const radius = sizeScale / Math.sqrt(2) / Math.pow(2, z)\n    // const radius = 60 / Math.sqrt(2) / Math.pow(2, z)\n\n    newData.forEach(p => {\n      if (p.zoomLevels[z] === undefined) {\n        // this point does not belong to a cluster\n        const { x, y } = p\n\n        // find all points within radius that do not belong to a cluster\n        const neighbors = tree\n          .search({\n            minX: x - radius,\n            minY: y - radius,\n            maxX: x + radius,\n            maxY: y + radius\n          })\n          .filter(neighbor => neighbor.zoomLevels[z] === undefined)\n\n        // only show the center point at this zoom level\n        neighbors.forEach(neighbor => {\n          if (neighbor === p) {\n            const newGeoJSON = neighbors.length === 1\n              ? p.geoJSON\n              : centroid(featureCollection(neighbors.map(n => n.geoJSON)))\n\n            newGeoJSON.properties = {\n              ...newGeoJSON.properties,\n              id: newGeoJSON.properties.id || uuid(),\n              count: neighbors.length,\n              reducedPhotoCount: neighbors.reduce((acc, { photoCount }) => photoCount ? acc + photoCount : acc, 0),\n              points: neighbors.map(n => n.geoJSON)\n            }\n            p.zoomLevels[z] = newGeoJSON\n          }\n          else {\n            neighbor.zoomLevels[z] = null\n          }\n        })\n      }\n    })\n  }\n\n  // console.log('----------------------------------UPDATE CLUSTER DONE----------------------------------')\n  return newData.map(({ zoomLevels }) => zoomLevels)\n}\n\nfunction filterData (clusteredData, filterBounds, newZ) {\n  // console.log('----------------------------------FILTER CLUSTER----------------------------------', { clusteredData, filterBounds, newZ })\n\n  return clusteredData\n    // Filter out anything not relevant to this zoom level\n    .filter(d => !!d[newZ])\n    // Restructure the object to be a little more JSON-friendly\n    .reduce((acc, zoomLevels) => {\n      const geoJSON = zoomLevels[newZ]\n      const coords = geoJSON.geometry.coordinates\n      const { count } = geoJSON.properties\n\n      if (!filterBounds || filterBounds.length < 4 || (\n        filterBounds[0] < coords[0] && filterBounds[1] < coords[1] &&\n        filterBounds[2] > coords[0] && filterBounds[3] > coords[1]\n      )) {\n        if (count > 1) acc.cluster.push(geoJSON)\n        else acc.single.push(geoJSON)\n      }\n      return acc\n    }, {\n      single: [],\n      cluster: []\n    })\n}\n","export default theme => ({\n  root: {\n    position: 'relative',\n    height: '100%',\n    '& .myPosMarker': {\n      zIndex: 1\n    },\n    '& .singleMarker': {\n      zIndex: 3\n    },\n    '& .clusterMarker': {\n      zIndex: 2\n    }\n  },\n  fab: {\n    background: theme.palette.secondary.main,\n    color: theme.palette.secondary.contrastText\n  },\n  topBar: {\n    position: 'absolute',\n    zIndex: 100,\n    top: 0\n  },\n  loadingWrapper: {\n    position: 'absolute',\n    color: theme.palette.text.primary,\n    opacity: 0.5,\n    zIndex: 90,\n    textAlign: 'center',\n    top: '50%',\n    left: '50%',\n    transform: 'translateY(-50%) translateX(-50%)'\n  },\n  zoomOutFab: {\n    margin: theme.spacing(0.5),\n    padding: theme.spacing(0.5),\n    border: '2px solid',\n    borderRadius: theme.spacing(1),\n    background: theme.palette.common.white,\n    fontSize: 20,\n    position: 'absolute',\n    zIndex: 80,\n    bottom: theme.spacing(2),\n    right: theme.spacing(10)\n  },\n  selectedPopup: {\n    // padding: theme.spacing(0, 1, 0, 1),\n    width: '90%',\n    maxWidth: 400,\n    zIndex: 100,\n    position: 'absolute',\n    bottom: theme.spacing(1),\n    left: '50%',\n    transformOrigin: '0% 50%',\n    transform: 'translateY(0%) translateX(-50%)'\n  }\n})\n","import React from 'react'\nimport createSvgIcon from '@material-ui/icons/utils/createSvgIcon'\n\nexport default createSvgIcon(\n  <React.Fragment>\n    <path d='M16.432,6.104c-2.671,-1.06 -6.842,4.123 -6.572,5.826c-3.78,-7.611 2.788,-8.409 3.682,-10.699c0.64,1.255 5.18,2.608 2.89,4.873Z' />\n    <path d='M9.159,5.228c-2.254,1.782 0.149,7.986 1.76,8.604c-8.482,-0.532 -5.889,-6.619 -7.425,-8.538c1.407,0.073 4.848,-3.183 5.665,-0.066Z' />\n    <path d='M4.727,11.059c0.417,2.844 6.991,3.864 8.331,2.779c-4.701,7.079 -8.676,1.79 -11.106,2.161c0.766,-1.183 -0.332,-5.791 2.775,-4.94Z' />\n    <path d='M7.561,17.813c2.671,1.061 6.842,-4.122 6.572,-5.826c3.781,7.611 -2.788,8.409 -3.681,10.699c-0.641,-1.255 -5.181,-2.607 -2.891,-4.873Z' />\n    <path d='M14.828,18.736c2.254,-1.783 -0.149,-7.987 -1.76,-8.605c8.482,0.532 5.889,6.619 7.425,8.538c-1.407,-0.072 -4.849,3.183 -5.665,0.067Z' />\n    <path d='M19.26,12.904c-0.417,-2.843 -6.991,-3.864 -8.331,-2.778c4.701,-7.08 8.676,-1.791 11.106,-2.162c-0.767,1.183 0.332,5.791 -2.775,4.94Z' />\n  </React.Fragment>, 'AppLogoSimple')\n","// https://commons.wikimedia.org/wiki/File:Apple_logo_black.svg\n\nimport React from 'react'\nimport createSvgIcon from '@material-ui/icons/utils/createSvgIcon'\n\nexport default createSvgIcon(\n  <React.Fragment>\n    <path d='M21.229,18.388c-0.346,0.799 -0.756,1.535 -1.23,2.211c-0.647,0.922 -1.176,1.56 -1.584,1.914c-0.632,0.582 -1.31,0.88 -2.036,0.897c-0.521,0 -1.149,-0.148 -1.88,-0.449c-0.734,-0.299 -1.408,-0.448 -2.025,-0.448c-0.646,0 -1.34,0.149 -2.081,0.448c-0.743,0.301 -1.342,0.457 -1.799,0.473c-0.696,0.03 -1.39,-0.277 -2.082,-0.921c-0.442,-0.385 -0.995,-1.046 -1.657,-1.982c-0.71,-0.999 -1.294,-2.158 -1.752,-3.48c-0.49,-1.427 -0.735,-2.809 -0.735,-4.147c0,-1.533 0.331,-2.855 0.994,-3.963c0.521,-0.89 1.215,-1.591 2.083,-2.107c0.868,-0.515 1.806,-0.778 2.816,-0.794c0.553,0 1.278,0.17 2.179,0.506c0.898,0.338 1.474,0.509 1.727,0.509c0.189,0 0.83,-0.2 1.916,-0.599c1.027,-0.369 1.894,-0.522 2.604,-0.462c1.924,0.155 3.37,0.914 4.331,2.28c-1.721,1.043 -2.572,2.503 -2.555,4.377c0.016,1.459 0.545,2.674 1.585,3.638c0.472,0.447 0.999,0.793 1.584,1.039c-0.127,0.368 -0.261,0.721 -0.403,1.06Zm-4.413,-17.366c0,1.144 -0.418,2.212 -1.251,3.2c-1.005,1.176 -2.221,1.855 -3.54,1.748c-0.017,-0.138 -0.026,-0.282 -0.026,-0.434c0,-1.098 0.478,-2.273 1.327,-3.234c0.423,-0.486 0.962,-0.891 1.616,-1.214c0.652,-0.318 1.269,-0.493 1.85,-0.523c0.016,0.152 0.024,0.305 0.024,0.457l0,0Z' />\n  </React.Fragment>, 'Apple')\n","\nimport React from 'react'\nimport PropTypes from 'prop-types'\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport Button from '@material-ui/core/Button'\nimport Typography from '@material-ui/core/Typography'\nimport DialogActions from '@material-ui/core/DialogActions'\n\nimport AppleIcon from '../../icons/Apple'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n\n  },\n  icon: {\n    height: 50,\n    width: '100%',\n    margin: '0 auto',\n    color: theme.palette.error.main\n  },\n  title: {\n\n  }\n})\n\nconst useStyles = makeStyles(style)\n\nconst FeatureDisabled = ({ title, message, onClose, open, icon }) => {\n  const classes = useStyles()\n  const IconComp = icon || AppleIcon\n  return (\n    <Dialog\n      className={classes.root}\n      disableBackdropClick\n      fullWidth\n      open={open}\n      PaperProps={{ style: { maxWidth: 'none' } }}\n      disableEscapeKeyDown\n      maxWidth='xl'\n      aria-labelledby='confirmation-dialog-title'\n    >\n      <DialogTitle id='confirmation-dialog-title' className={classes.title}>{title}</DialogTitle>\n      <DialogContent>\n        <IconComp className={classes.icon} />\n        <Typography component='div'>\n          {message}\n        </Typography>\n\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={onClose} color='primary'>\n      Ok\n        </Button>\n      </DialogActions>\n    </Dialog>\n  )\n}\n\nFeatureDisabled.propTypes = {\n  open: PropTypes.bool,\n  title: PropTypes.string.isRequired,\n  icon: PropTypes.any,\n  message: PropTypes.string.isRequired,\n  onClose: PropTypes.func.isRequired\n}\n\nexport default FeatureDisabled\n","import React, { useContext } from 'react'\nimport PropTypes from 'prop-types'\nimport { makeStyles } from '@material-ui/core/styles'\nimport SwipeableDrawer from '@material-ui/core/SwipeableDrawer'\nimport Avatar from '@material-ui/core/Avatar'\n\nimport List from '@material-ui/core/List'\nimport Divider from '@material-ui/core/Divider'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemIcon from '@material-ui/core/ListItemIcon'\nimport ListItemText from '@material-ui/core/ListItemText'\nimport CloudDownload from '@material-ui/icons/CloudDownload'\nimport MobileScreenShare from '@material-ui/icons/MobileScreenShare'\nimport { AppContext } from '../contexts'\n\nimport ExitToAppIcon from '@material-ui/icons/ExitToApp'\n\nimport QRCodeIcon from '../icons/QRCode'\nimport AccountCircleIcon from '@material-ui/icons/AccountCircle'\n\nconst useStyles = makeStyles(theme => ({\n  drawerInner: {\n    width: 250,\n    display: 'flex',\n    flexDirection: 'column',\n    height: '100%'\n  },\n  disableListItem: {\n    color: 'rgba(0, 0, 0, 0.26)'\n  },\n  avatar: {\n    height: theme.spacing(7),\n    width: theme.spacing(7),\n    border: `3px solid ${theme.palette.primary.main}`,\n    margin: theme.spacing(0, 1)\n  },\n  gravatarImg: {\n    width: '100%'\n  },\n  spacer: {\n    flexGrow: 1\n  },\n  fullList: {\n    width: 'auto'\n  }\n}))\n\nconst SideDrawer = ({ open, onOpen, onClose, onDisabledClick }) => {\n  const classes = useStyles()\n  const { signOut, signedIn, forceSignIn, user, onQRClick, addToHomeScreen, onOfflineMenuClick, isIos } = useContext(AppContext)\n  return (\n    <SwipeableDrawer\n      open={open}\n      onClose={onClose}\n      onOpen={onOpen}\n    >\n      <div\n        className={classes.drawerInner}\n        role='presentation'\n        onClick={onClose}\n        onKeyDown={onClose}\n      >\n        {user && user.username && (\n          <List>\n            <ListItem className={classes.root} onClick={() => {}} disableGutters>\n              <Avatar className={classes.avatar}>\n                {signedIn && user\n                  ? <img alt='profile' className={classes.gravatarImg} src={user.gravatar} />\n                  : <AccountCircleIcon color='inherit' className={classes.loginButton} />\n                }\n              </Avatar>\n            </ListItem>\n            <ListItem className={classes.root} onClick={() => {}}>\n              <ListItemText\n                primary={user.username}\n              />\n            </ListItem>\n          </List>\n\n        )}\n        <Divider />\n        <List>\n          <ListItem\n            className={isIos ? classes.disableListItem : null}\n            button\n            onClick={isIos ? onDisabledClick : onQRClick}\n          >\n            <ListItemIcon>\n              <QRCodeIcon />\n            </ListItemIcon>\n            <ListItemText primary={'Scan QR Code'} />\n          </ListItem>\n          {addToHomeScreen && (\n            <ListItem button onClick={addToHomeScreen}>\n              <ListItemIcon>\n                <MobileScreenShare />\n              </ListItemIcon>\n              <ListItemText primary={'Install this app'} secondary={'It works better!'} />\n            </ListItem>\n          )}\n          <ListItem button onClick={onOfflineMenuClick} >\n            <ListItemIcon>\n              <CloudDownload />\n            </ListItemIcon>\n            <ListItemText primary={'Offline Download'} />\n          </ListItem>\n        </List>\n        <div className={classes.spacer} />\n        <Divider />\n        <List>\n          {signedIn\n            ? (\n              <ListItem button onClick={signOut}>\n                <ListItemIcon>\n                  <ExitToAppIcon />\n                </ListItemIcon>\n                <ListItemText primary={'Sign Out'} />\n              </ListItem>\n            )\n            : (\n              <ListItem button onClick={forceSignIn}>\n                <ListItemIcon>\n                  <AccountCircleIcon />\n                </ListItemIcon>\n                <ListItemText primary={'Sign In'} />\n              </ListItem>\n            )}\n\n        </List>\n      </div>\n    </SwipeableDrawer>\n  )\n}\n\nSideDrawer.propTypes = {\n  open: PropTypes.bool,\n  onOpen: PropTypes.func,\n  onClose: PropTypes.func,\n  onDisabledClick: PropTypes.func\n}\n\nexport default SideDrawer\n","import React, { useState, useContext } from 'react'\nimport classNames from 'classnames'\nimport PropTypes from 'prop-types'\n\nimport Toolbar from '@material-ui/core/Toolbar'\nimport AppBar from '@material-ui/core/AppBar'\nimport IconButton from '@material-ui/core/IconButton'\nimport AppLogoSimple from '../icons/AppLogoSimple'\nimport FeatureDisabled from './misc/FeatureDisabled'\nimport { AppContext } from '../contexts'\n\nimport QRCodeIcon from '../icons/QRCode'\nimport SideDrawer from './SideDrawer'\n\n// import MenuIcon from '@material-ui/core/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { ThemeProvider } from '@material-ui/styles'\nimport themes from '../themes'\nimport { Typography } from '@material-ui/core'\n\nconst style = theme => ({\n  root: {\n    display: 'flex',\n    alignItems: 'center',\n    width: '100%',\n    padding: theme.spacing(0, 1),\n    backgroundColor: theme.palette.primary.main,\n    color: theme.palette.primary.contrastText,\n    borderBottom: `2px solid ${theme.palette.primary}`,\n    background: `linear-gradient(90deg, ${theme.palette.secondary.main} 0%, ${theme.palette.primary.main} 100%)`\n  },\n  searchIcon: {\n    opacity: 0.3,\n    marginRight: theme.spacing(1)\n  },\n  transparent: {\n    backgroundColor: 'transparent',\n    background: 'none',\n    color: theme.palette.text.primary\n    // borderBottom: `2px transparent`\n  },\n  iOsIcon: {\n    color: 'rgba(0, 0, 0, 0.26)'\n  },\n  logo: {\n    padding: theme.spacing(0, 0),\n    height: 40,\n    width: 40\n  },\n  transparentLogo: {\n    background: `linear-gradient(90deg, ${theme.palette.secondary.main} 0%, ${theme.palette.primary.main} 100%)`,\n    padding: theme.spacing(0.5, 0.5)\n  },\n  transparentLogoIcon: {\n    color: 'white',\n    height: 35,\n    width: 35\n  },\n  children: {\n    flexGrow: 1,\n    padding: theme.spacing(0, 1)\n  },\n  qrButton: {\n    padding: theme.spacing(0, 0)\n  },\n  qrButtonTransparent: {\n    background: 'white',\n    padding: theme.spacing(0.5, 0.5)\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst TopBar = ({ className, children, isTransparent, menuItems, hideLogo }) => {\n  const classes = useStyles()\n  const [appleDlg, setAppleDlg] = useState(false)\n  const [drawerOpen, setDrawerOpen] = useState(false)\n  const { onQRClick, isIos } = useContext(AppContext)\n\n  return (\n    <React.Fragment>\n      <AppBar position='static'>\n        <Toolbar className={classNames(classes.root, className, isTransparent ? classes.transparent : null)} disableGutters>\n          {!hideLogo && (\n            <IconButton\n              className={isTransparent ? classes.transparentLogo : classes.logo}\n              color='inherit'\n              onClick={() => setDrawerOpen(true)}\n            >\n              <AppLogoSimple className={isTransparent ? classes.transparentLogoIcon : classes.logo} />\n            </IconButton>\n          )}\n          <div className={classes.children}>\n            {children}\n          </div>\n          <IconButton\n            color='inherit'\n            className={classNames(\n              isIos ? classes.iOsIcon : null,\n              isTransparent ? classes.qrButtonTransparent : classes.qrButton\n            )}\n            aria-label='Menu'\n            onClick={isIos ? () => setAppleDlg(true) : onQRClick}\n          >\n            <QRCodeIcon color='inherit' />\n          </IconButton>\n        </Toolbar>\n      </AppBar>\n      <SideDrawer\n        open={drawerOpen}\n        onClose={() => setDrawerOpen(false)}\n        onOpen={() => setDrawerOpen(true)}\n        onDisabledClick={() => setAppleDlg(true)}\n      />\n      {isIos && (\n        <FeatureDisabled\n          open={appleDlg}\n          title='iOS Feature Disabled'\n          message={<Typography variant='body2' component='div'>\n            <p>This feature cannot function due to a bug in iOS 12 that prevents <strong>direct\n            camera access from progressive web apps</strong>.</p>\n            <p>There is good evidence iOS 13 has things sorted. ETA from Apple is mid-September 2019.</p>\n          </Typography>}\n          onClose={() => setAppleDlg(false)}\n        />\n      )}\n    </React.Fragment>\n  )\n}\n\nTopBar.propTypes = {\n  className: PropTypes.string,\n  children: PropTypes.any,\n  isTransparent: PropTypes.bool,\n  hideLogo: PropTypes.bool,\n  menuItems: PropTypes.arrayOf(PropTypes.shape({\n    callback: PropTypes.func,\n    text: PropTypes.string,\n    icon: PropTypes.any,\n    color: PropTypes.string\n  }))\n}\n\nexport default (props) => <ThemeProvider theme={themes.topbar}><TopBar {...props} /></ThemeProvider>\n","import React, { useRef, useLayoutEffect, useCallback } from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport { fade } from '@material-ui/core/styles/colorManipulator'\nimport InputBase from '@material-ui/core/InputBase'\n\nimport SearchIcon from '@material-ui/icons/Search'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { debounce } from '../../lib/util'\n\nconst useSearchBarStyles = makeStyles(theme => ({\n  root: {\n    position: 'relative',\n    borderRadius: theme.shape.borderRadius,\n    backgroundColor: fade(theme.palette.common.white, 0.3),\n    '&:hover': {\n      backgroundColor: fade(theme.palette.common.white, 0.5)\n    },\n    marginRight: theme.spacing(2),\n    marginLeft: 0,\n    width: '100%',\n    [theme.breakpoints.up('sm')]: {\n      marginLeft: theme.spacing(3),\n      width: 'auto'\n    }\n  },\n  transparent: {\n    backgroundColor: fade(theme.palette.common.white, 0.7),\n    '&:hover': {\n      backgroundColor: fade(theme.palette.common.white, 0.9)\n    }\n  },\n  inputRoot: {\n    color: 'inherit',\n    width: '100%'\n  },\n  inputInput: {\n    padding: theme.spacing(1, 1, 1, 4),\n    transition: theme.transitions.create('width'),\n    width: '100%',\n    [theme.breakpoints.up('md')]: {\n      width: 200\n    }\n  },\n  searchIcon: {\n    width: theme.spacing(4),\n    height: '100%',\n    position: 'absolute',\n    pointerEvents: 'none',\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center'\n  }\n}))\n\n/**\n *\n */\nexport const SearchInput = ({ autoFocus, disabled, onChange, onClick, defaultValue, isTransparent }) => {\n  const inputRef = useRef()\n  const classes = useSearchBarStyles()\n\n  const debounceSearchText = useCallback(\n    debounce(onChange, 500),\n    [onChange]\n  )\n\n  useLayoutEffect(() => {\n    if (inputRef.current && !autoFocus) {\n      console.log('Setting blur')\n      inputRef.current.blur()\n    }\n  }, [autoFocus])\n  return (\n    <div className={classNames(classes.root, isTransparent ? classes.transparent : null)} onClick={onClick}>\n      <div className={classes.searchIcon}>\n        <SearchIcon />\n      </div>\n      <InputBase\n        autoFocus={!disabled && autoFocus}\n        inputProps={{\n          onBlur: () => {\n            // console.log('onBlur')\n            // inputRef.current.focus()\n          }\n        }}\n        onChange={(e) => {\n          // console.log('onChange', e.target.value)\n          debounceSearchText(e.target.value)\n        }}\n        placeholder='Search…'\n        disabled={disabled}\n        defaultValue={defaultValue}\n\n        inputRef={inputRef}\n        classes={{\n          root: classes.inputRoot,\n          input: classes.inputInput\n        }}\n      />\n    </div>\n  )\n}\n\nSearchInput.propTypes = {\n  autoFocus: PropTypes.bool,\n  isTransparent: PropTypes.bool,\n  disabled: PropTypes.bool,\n  onChange: PropTypes.func,\n  defaultValue: PropTypes.string,\n  onClick: PropTypes.func\n}\n\nexport default SearchInput\n","import React, { useContext } from 'react'\nimport PropTypes from 'prop-types'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemText from '@material-ui/core/ListItemText'\nimport List from '@material-ui/core/List'\nimport classNames from 'classnames'\nimport Typography from '@material-ui/core/Typography'\nimport RawImage from '../PhotoSeries/views/subViews/RawImage'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { formatDate } from '../../lib/datelib'\n\nimport { ACCESS } from '../../config'\nimport { AppContext } from '../../contexts'\n\nconst style = theme => ({\n  root: {\n    margin: 0,\n    padding: theme.spacing(1)\n  },\n  chipContainer: {\n    display: 'flex',\n    width: '100%'\n  },\n  grow: { flexGrow: 1 },\n  accessLabel: {\n    padding: theme.spacing(0.5, 0.5)\n  },\n  accessPUBLIC: {\n    color: 'white',\n    background: ACCESS.PUBLIC.color[900]\n  },\n  accessPRIVATE: {\n    color: 'white',\n    background: ACCESS.PRIVATE.color[900]\n  },\n  accessOPEN: {\n    color: 'white',\n    background: ACCESS.OPEN.color[900]\n  },\n  img: {\n    verticalAlign: 'top',\n    objectFit: 'cover',\n    height: '100%',\n    width: '100%'\n  },\n  text: {\n    height: '115px',\n    margin: 0,\n    padding: theme.spacing(0, 1),\n    alignSelf: 'flex-start',\n    display: 'flex',\n    flexDirection: 'column'\n  },\n  textSm: {\n    height: '75px',\n    margin: 0,\n    padding: theme.spacing(0, 1),\n    alignSelf: 'flex-start',\n    display: 'flex',\n    flexDirection: 'column'\n  },\n  titleText: {\n    textOverflow: 'ellipsis',\n    whiteSpace: 'nowrap',\n    overflow: 'hidden'\n  },\n  dateContainer: {\n    display: 'flex'\n  },\n  dateLabel: {\n    fontWeight: 'bold',\n    flex: '1 1 50px'\n  },\n  dateText: {\n\n  },\n  imgFiller: {\n    flexGrow: 1,\n    background: theme.palette.text.primary,\n    overflow: 'hidden'\n  },\n  imgContainer: {\n    flex: '0 0 115px',\n    alignSelf: 'flex-start',\n    height: 115,\n    overflow: 'hidden',\n    display: 'flex',\n    flexDirection: 'column'\n  },\n  imgContainerSm: {\n    flex: '0 0 75px',\n    alignSelf: 'flex-start',\n    height: 75,\n    overflow: 'hidden',\n    display: 'flex',\n    flexDirection: 'column'\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst SeriesListItem = ({ series, loading, onClick, children, showCreatedOn, showLastPhoto, small }) => {\n  const classes = useStyles()\n  if (loading || !series) return 'LOADING...'\n  const { getPhotoUrls } = useContext(AppContext)\n\n  let accessLabel = ACCESS.PRIVATE.label\n  accessLabel = series.access ? ACCESS[series.access].label : ACCESS.PRIVATE.label\n\n  return (\n    <ListItem className={classes.root} button component='div' disableGutters>\n      <div className={small ? classes.imgContainerSm : classes.imgContainer} onClick={onClick}>\n        <div className={classes.imgFiller}>\n          <RawImage\n            photo={series.featured}\n            sizePriority={['thumb', 'medium', 'large']}\n            getPhotoUrls={getPhotoUrls}\n            className={classes.img}\n          />\n        </div>\n        {series.access && (\n          <Typography className={classNames(classes.accessLabel, classes[`access${series.access}`])}\n            variant='caption'\n            component='div'\n          >\n            {`${series.photoCount || 0} Photos`}\n            {!small && <em>({accessLabel})</em>}\n          </Typography>\n        )}\n      </div>\n      <ListItemText className={small ? classes.textSm : classes.text} disableTypography onClick={onClick}>\n        <Typography variant='body1' component='div' className={classes.titleText}>\n          {series.name || loading}\n        </Typography>\n        <Typography variant='body2' component='div'>\n          <strong>Created by:</strong> {series.createdUser.username}\n        </Typography>\n        <div className={classes.grow} />\n        {showCreatedOn && <div className={classes.dateContainer}>\n          <Typography variant='caption' className={classes.dateLabel}>Created:</Typography>\n          <Typography variant='caption' className={classes.dateText}>{formatDate(series.createdOn, 'lll')}</Typography>\n        </div>}\n        {showLastPhoto && <div className={classes.dateContainer}>\n          <Typography variant='caption' className={classes.dateLabel}>Last Photo:</Typography>\n          <Typography variant='caption' className={classes.dateText}>{formatDate(series.latest.takenOn, 'lll')}</Typography>\n        </div>}\n      </ListItemText>\n      {/*  <TinyChip label='Watching' color='secondary' /> */}\n      {children}\n    </ListItem>\n  )\n}\n\nSeriesListItem.propTypes = {\n  series: PropTypes.object,\n  loading: PropTypes.bool,\n  small: PropTypes.bool,\n  showCreatedOn: PropTypes.bool,\n  showLastPhoto: PropTypes.bool,\n  onClick: PropTypes.func,\n  children: PropTypes.array\n}\n\nexport default SeriesListItem\n\n// const useCosmosStyles = makeStyles(theme => ({\n//   root: {\n\n//   }\n// }))\n\nexport const SeriesListItemCosmos = (props) => {\n  // const classes = useCosmosStyles()\n  return (\n    <List disablePadding dense>\n      <SeriesListItem {...props} />\n    </List>\n  )\n}\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemText from '@material-ui/core/ListItemText'\nimport Typography from '@material-ui/core/Typography'\nimport IconButton from '@material-ui/core/IconButton'\nimport List from '@material-ui/core/List'\n\nimport ZoomOutMapIcon from '@material-ui/icons/ZoomOutMap'\nimport ViewListIcon from '@material-ui/icons/ViewList'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport ListItemIcon from '@material-ui/core/ListItemIcon'\n\nconst style = theme => ({\n  root: {\n\n  },\n  listItemText: {\n    textAlign: 'center'\n  },\n  iconButton: {\n    background: theme.palette.grey[200]\n  },\n  compoundButton: {\n    textAlign: 'center'\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst ClusterSelected = ({ seriesCount, reducedPhotoCount, onZoomTo, onViewList, onClose }) => {\n  const classes = useStyles()\n  console.log('cluster selected', { seriesCount, reducedPhotoCount })\n  return (\n    <List>\n      <ListItem className={classes.root}>\n        <ListItemIcon>\n          <div className={classes.compoundButton}>\n            <IconButton onClick={onZoomTo} className={classes.iconButton}>\n              <ZoomOutMapIcon />\n            </IconButton>\n            <Typography variant='caption' component='div' >Zoom In</Typography>\n          </div>\n        </ListItemIcon>\n        <ListItemText\n          className={classes.listItemText}\n          onClick={onZoomTo}\n          primary={`${seriesCount} Photo series`}\n          secondary={`containing ${reducedPhotoCount} individual photo${reducedPhotoCount === 1 ? '' : 's'}`}\n        />\n        <ListItemIcon>\n          <div className={classes.compoundButton}>\n            <IconButton onClick={onViewList} className={classes.iconButton} >\n              <ViewListIcon />\n            </IconButton>\n            <Typography variant='caption' component='div' >List</Typography>\n          </div>\n        </ListItemIcon>\n      </ListItem>\n    </List>\n  )\n}\n\nClusterSelected.propTypes = {\n  seriesCount: PropTypes.number.isRequired,\n  reducedPhotoCount: PropTypes.number.isRequired,\n  onZoomTo: PropTypes.func.isRequired,\n  onViewList: PropTypes.func.isRequired,\n  onClose: PropTypes.func.isRequired\n}\n\nexport default ClusterSelected\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Dialog from '@material-ui/core/Dialog'\nimport Typography from '@material-ui/core/Typography'\nimport IconButton from '@material-ui/core/IconButton'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport SeriesListItem from './SeriesListItem'\n\nimport CloseIcon from '@material-ui/icons/Close'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { List } from '@material-ui/core'\n\nconst style = theme => ({\n  root: {\n\n  },\n  title: {\n    background: theme.palette.primary.main,\n    color: theme.palette.primary.contrastText,\n    alignSelf: 'flex-start',\n    width: '100%',\n    margin: 0,\n    display: 'flex',\n    padding: theme.spacing(2)\n  },\n  dlgTitle: {\n    flexGrow: 1\n  },\n  closeButton: {\n    padding: 0,\n    alignSelf: 'flex-start'\n    // color: theme.palette.grey[500]\n  },\n  list: {\n    overflowX: 'hidden',\n    overflowY: 'scroll'\n  }\n})\n\nconst useStyles = makeStyles(style)\n\nconst ViewListDialog = ({ title, seriesList, onSelect, onClose, open }) => {\n  const classes = useStyles()\n  return (\n    <Dialog\n      className={classes.root}\n      fullWidth\n      open={open}\n      onClose={onClose}\n      maxWidth='xl'\n      aria-labelledby='confirmation-dialog-title'\n    >\n      <DialogTitle className={classes.title} disableTypography>\n        <Typography className={classes.dlgTitle}>{title}</Typography>\n        <IconButton color='inherit' className={classes.closeButton} onClick={onClose}>\n          <CloseIcon color='inherit' />\n        </IconButton>\n      </DialogTitle>\n      <List className={classes.list} dense disablePadding>\n        {seriesList.map(series => (\n          <SeriesListItem\n            key={`series${series.id}`}\n            series={series}\n            small\n            onClick={() => onSelect(series.id)}\n          />\n        ))}\n      </List>\n    </Dialog>\n  )\n}\n\nViewListDialog.propTypes = {\n  open: PropTypes.bool,\n  title: PropTypes.string.isRequired,\n  seriesList: PropTypes.array.isRequired,\n  onSelect: PropTypes.func.isRequired,\n  onClose: PropTypes.func.isRequired\n}\n\nexport default ViewListDialog\n","import React from 'react'\nimport classNames from 'classnames'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport Badge from '@material-ui/core/Badge'\nimport Avatar from '@material-ui/core/Avatar'\nimport Camera from '@material-ui/icons/Camera'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { ACCESS } from '../../../config'\n\nconst style = theme => ({\n  root: {\n    color: theme.palette.primary.main,\n    width: 150,\n    position: 'absolute',\n    top: '50%',\n    left: '50%',\n    textAlign: 'center',\n    transformOrigin: '50% 50%',\n    transform: 'translateY(-50%) translateX(-50%)'\n  },\n  rootActive: {\n    zIndex: 60\n  },\n  icon: {\n    // height: 16,\n    // width: 16\n  },\n  avatar: {\n    position: 'relative',\n    margin: '0 auto',\n    background: 'green',\n    color: 'white',\n    border: '2px solid white',\n    height: 40,\n    width: 40,\n    zIndex: 61,\n    '&.PUBLIC': { background: ACCESS.PUBLIC.color },\n    '&.PRIVATE': { background: ACCESS.PRIVATE.color },\n    '&.OPEN': { background: ACCESS.OPEN.color }\n  },\n  avatarActive: {\n    background: '#FFFF00',\n    color: 'black',\n    border: `2px solid black`,\n    '&.PUBLIC': { background: '#FFFF00' },\n    '&.PRIVATE': { background: '#FFFF00' },\n    '&.OPEN': { background: '#FFFF00' }\n  },\n  badge: {\n    zIndex: 62,\n    color: theme.palette.secondary.contrastText,\n    background: theme.palette.secondary.main,\n    transform: 'scale(1) translate(30%, -30%)'\n  },\n  badgeActive: {\n    color: theme.palette.primary.contrastText,\n    background: theme.palette.primary.main\n  },\n  directionIndicator: {\n    position: 'absolute',\n    top: 20,\n    left: '50%',\n    // transformOrigin: '50% 50%',\n    // transform: 'translateY(-50%) translateX(-50%)',\n    zIndex: 59\n  },\n  name: {\n    color: 'white',\n    fontWeight: 'bold',\n    textShadow: `\n        0px 0px 4px #000000, \n        0px 0px 4px #000000 \n    `,\n    zIndex: 60,\n    position: 'relative'\n    // textStroke: '1px white'\n  },\n  nameActive: {\n    color: 'black',\n    textShadow: `\n    0px 0px 2px #FFFFFF, \n    0px 0px 2px #FFFFFF,\n    0px 0px 4px #FFFFFF \n`\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst Single = ({ name, access, onClick, active, photoCount, direction }) => {\n  const classes = useStyles()\n  return (\n    <div className={classNames(classes.root, active ? classes.rootActive : null, access)}>\n      <Badge classes={{ badge: classNames(classes.badge, active ? classes.badgeActive : null, access) }} badgeContent={photoCount}>\n        <Avatar className={classNames(classes.avatar, active ? classes.avatarActive : null, access)} onClick={onClick}>\n          <Camera className={classes.icon} color='inherit' />\n        </Avatar>\n      </Badge>\n      {direction && direction >= 0 ? (\n        <div className={classes.directionIndicator}>\n          <svg className={classes.svgArc}\n            version='1.1'\n            width='100'\n            height='100'\n            viewBox='0, 0, 100, 100'\n            style={{ transform: `translateY(-50%) translateX(-50%) rotateZ(${direction}deg)` }}>\n            <path d='M50,0 C60.946,0.151 72.136,3.514 80.675,10.56 L50,50 L19.325,10.56 C27.938,3.461 39,0.278 50,0 z'\n              fill='#009DC1'\n              fillOpacity='0.444'\n              strokeWidth='1'\n              strokeOpacity='0.6'\n              stroke='#FFFFFF'\n            />\n          </svg>\n        </div>\n      ) : null}\n      <Typography variant='body1' className={classNames(classes.name, active ? classes.nameActive : null)}>\n        {name}\n      </Typography>\n    </div>\n  )\n}\n\nSingle.propTypes = {\n  access: PropTypes.string,\n  name: PropTypes.string,\n  photoCount: PropTypes.number,\n  onClick: PropTypes.func.isRequired,\n  direction: PropTypes.number,\n  active: PropTypes.bool\n}\n\nexport default Single\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport Avatar from '@material-ui/core/Avatar'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport numeral from 'numeral'\n\nconst style = theme => ({\n  avatar: {\n    background: theme.palette.grey[900],\n    border: `2px solid ${theme.palette.grey[100]}`,\n    color: theme.palette.grey[100]\n  },\n  avatarActive: {\n    background: '#FFFF00',\n    border: `2px solid black`,\n    color: 'black',\n    zIndex: 50\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst Cluster = ({ seriesCount, active, onClick }) => {\n  const classes = useStyles()\n  return (\n    <Avatar onClick={onClick} className={classNames(classes.avatar, active ? classes.avatarActive : null)}>\n      {numeral(seriesCount).format('0,0')}\n    </Avatar>\n  )\n}\n\nCluster.propTypes = {\n  seriesCount: PropTypes.number,\n  onClick: PropTypes.func.isRequired,\n  active: PropTypes.bool\n}\n\nexport default Cluster\n","\nimport React, { useState, useMemo, useRef, useEffect } from 'react'\nimport PropTypes from 'prop-types'\nimport Paper from '@material-ui/core/Paper'\n// import Typography from '@material-ui/core/Typography'\nimport { FlyToInterpolator, LinearInterpolator, Marker } from 'react-map-gl'\nimport { easeCubic } from 'd3-ease'\nimport { CircularProgress } from '@material-ui/core'\nimport MapStyles from '../../mapStyles'\n\nimport BaseMap from './BaseMap'\nimport useClusteredData from '../../lib/useClusteredData'\nimport { bbox, featureCollection, buffer, point } from '@turf/turf'\nimport { makeStyles } from '@material-ui/core/styles'\n// import { debounce } from '../../lib/util'\nimport style from './HomeMap.style'\n\nimport TopBar from '../TopBar'\nimport SearchInput from '../Search/SearchInput'\nimport SeriesListItem from '../misc/SeriesListItem'\nimport ClusterSelected from '../misc/ClusterSelected'\nimport ViewListDialog from '../misc/ViewListDialog'\n\nimport SingleMarker from './markers/Single'\nimport ClusterMarker from './markers/Cluster'\n\nconst useStyles = makeStyles(style)\n\nconst defaultView = {\n  zoom: 4,\n  latitude: 44.629701,\n  longitude: -120.333379\n}\n\nconst SIZESCALE = 80\n\nconst HomeMap = ({\n  seriesList, initViewport, loading, activeSeries, queryVersion,\n  onSeriesNavigate, onSeriesMapSelect, onSearchClick,\n  popMapHistory, pushMapHistory, clearMapHistory\n}) => {\n  const [mapViewObj, setMapViewObj] = useState({\n    viewport: { ...defaultView, ...initViewport.viewport },\n    bounds: initViewport.bounds,\n    filterBounds: null\n  })\n\n  const classes = useStyles()\n  const mapViewRef = useRef()\n  const [isTransitioning, setIsTransitioning] = useState(false)\n  const homeMapContainerRef = useRef()\n\n  const [currentZoom, setCurrentZoom] = useState(0)\n  const [showViewList, setShowViewList] = useState(false)\n  const [transitions, setTransitions] = useState(null)\n  const [selectedItem, setSelectedItem] = useState()\n\n  // This custom hook is heavily debounced\n  const { filteredClusteredData } = useClusteredData(\n    seriesList || [],\n    mapViewObj.filterBounds,\n    currentZoom,\n    mapViewObj.viewport,\n    SIZESCALE,\n    queryVersion,\n    isTransitioning\n  )\n\n  // If we're coming back to the map with something aleady selected then we need to\n  // reselect the series we had before\n  useEffect(() => {\n    if (!activeSeries || !seriesList || selectedItem) return\n    try {\n      const selected = seriesList.find(s => s.id === activeSeries)\n      if (selected && selected.coords) {\n        const bufferPts = buffer(point(selected.coords), 10, { units: 'meters' })\n        const bounds = bbox(bufferPts)\n        setMapViewObj({ ...mapViewObj, bounds })\n      }\n    }\n    catch (e) {\n      console.error(e)\n    }\n  }, [seriesList])\n\n  // When we load data, we should reselect the activeSeries if we need to\n  // Once we have the zoom in place we might need to select an initial series\n  useEffect(() => {\n    if (!activeSeries || !filteredClusteredData.single || selectedItem) return\n    try {\n      const selected = filteredClusteredData.single.find(s => s.properties.id === activeSeries)\n      if (selected && homeMapContainerRef.current) setSelectedItem(selected)\n    }\n    catch (e) {\n      console.error(e)\n    }\n  }, [filteredClusteredData.single])\n\n  const saveMap = (delay) => {\n    const {\n      transitionDuration,\n      transitionInterpolator,\n      transitionInterruption,\n      maxZoom,\n      minZoom,\n      maxPitch,\n      minPitch,\n      ...newView\n    } = mapViewRef.current ? mapViewRef.current : mapViewObj.viewport\n    const saveObj = { viewport: newView }\n    if (!delay) pushMapHistory(saveObj)\n    else {\n      setTimeout(() => pushMapHistory(saveObj), delay)\n    }\n  }\n\n  const updateSelectedItem = (item) => {\n    // regardless, set the map selected Item\n    setSelectedItem(item)\n    // update the global active series if this is a single and not a cluster\n    if (item && item.properties.count === 1) onSeriesMapSelect(item.properties.id)\n    else onSeriesMapSelect()\n    saveMap()\n  }\n\n  const onZoomTo = (object) => {\n    try {\n      const pts = featureCollection(object.properties.points)\n      let bounds = bbox(pts)\n      // If all points have the same BBOX this won't work\n      if (bounds[0] === bounds[2] && bounds[1] === bounds[3]) {\n        const paddedPoint = buffer(point([bounds[0], bounds[1]]), 10, { units: 'meters' })\n        bounds = bbox(paddedPoint)\n      }\n      // buffer a further 10%\n      const lngBuff = (bounds[2] - bounds[0]) * 0.2\n      const latBuff = (bounds[3] - bounds[1]) * 0.2\n      const buffBounds = [\n        bounds[0] - lngBuff,\n        bounds[1] - latBuff,\n        bounds[2] + lngBuff,\n        bounds[3] + latBuff\n      ]\n\n      setTransitions({\n        transitionDuration: 2000,\n        transitionInterpolator: new FlyToInterpolator(),\n        transitionEasing: easeCubic\n      })\n      setMapViewObj({ ...mapViewObj, bounds: buffBounds })\n      if (object.properties.count > 1) setTimeout(() => updateSelectedItem(null), 2000)\n    }\n    catch (e) {\n      console.error(e)\n    }\n  }\n\n  const onViewportChange = ({ viewport, map }) => {\n    mapViewRef.current = viewport\n    // mapViewObj\n    // {\n    //   \"_sw\": {\n    //     \"lng\": -120.40788003760076,\n    //     \"lat\": 44.609051464438835\n    //   },\n    //   \"_ne\": {\n    //     \"lng\": -120.25887796240545,\n    //     \"lat\": 44.65034319161438\n    //   }\n    // minX, minY, maxX, maxY\n    // [W-122.87948116236043, S26.15346805640254, E-82.00799782432676, N47.3795453070757]\n    const viewZoom = Math.floor(viewport.zoom)\n    if (!isTransitioning && map && map.getBounds) {\n      const { _sw: { lng: minLng, lat: minLat }, _ne: { lng: maxLng, lat: maxLat } } = map.getBounds()\n      const [oldMinLng, oldMinLat, oldMaxLng, oldMaxLat] = mapViewObj.filterBounds || [minLng, minLat, maxLng, maxLat]\n      if (viewZoom !== currentZoom ||\n        oldMinLng >= minLng || oldMinLat >= minLat ||\n        oldMaxLng <= maxLng || oldMaxLat <= maxLat\n      ) {\n        const filterBounds = [\n          minLng - (maxLng - minLng) / 2,\n          minLat - (maxLat - minLat) / 2,\n          maxLng + (maxLng - minLng) / 2,\n          maxLat + (maxLat - minLat) / 2\n        ]\n        setMapViewObj({ ...mapViewObj, filterBounds })\n      }\n    }\n    if (viewZoom !== currentZoom) {\n      setCurrentZoom(viewZoom)\n    }\n  }\n  // Debounce this to improve performance\n  // const onViewportChangeDebounced = useCallback(debounce(onViewportChange, 300), [])\n\n  const lock = {}\n\n  const onMarkerClick = (obj) => {\n    // Second click zooms\n    if (selectedItem && selectedItem.properties.id === obj.properties.id) {\n      onZoomTo(selectedItem)\n    }\n    else {\n      setTransitions({\n        transitionDuration: 500,\n        transitionInterpolator: new LinearInterpolator(),\n        transitionEasing: easeCubic\n      })\n      setMapViewObj({\n        viewport: {\n          longitude: obj.geometry.coordinates[0],\n          latitude: obj.geometry.coordinates[1]\n        }\n      })\n    }\n    updateSelectedItem(obj)\n  }\n\n  // This one should be debounced by filteredClusteredData\n  const markersRendered = useMemo(() => ([\n    ...filteredClusteredData.single\n      .filter(obj => !isTransitioning || (selectedItem && selectedItem.properties.id === obj.properties.id))\n      .map(obj => (\n        <Marker\n          className={'singleMarker'}\n          key={`single-${obj.properties.id}`}\n          latitude={obj.geometry.coordinates[1]}\n          longitude={obj.geometry.coordinates[0]}\n          offsetLeft={0}\n          offsetTop={-20}\n        >\n          <SingleMarker name={obj.properties.name}\n            access={obj.properties.access}\n            photoCount={obj.properties.photoCount}\n            onClick={() => onMarkerClick(obj)}\n            direction={currentZoom > 10 && obj.properties.direction ? obj.properties.direction : null}\n            active={selectedItem && selectedItem.properties.id === obj.properties.id}\n          />\n        </Marker>\n      )),\n    ...filteredClusteredData.cluster\n      .filter(obj => !isTransitioning || (\n        selectedItem &&\n      selectedItem.properties.id === obj.properties.id &&\n      selectedItem.properties.count === obj.properties.count\n      ))\n      .map(obj => (\n        <Marker\n          className='clusterMarker'\n          key={`cluster-${obj.properties.id}`}\n          latitude={obj.geometry.coordinates[1]}\n          longitude={obj.geometry.coordinates[0]}\n          offsetLeft={-20}\n          offsetTop={-20}\n        >\n          <ClusterMarker\n            seriesCount={obj.properties.count}\n            photoCount={obj.properties.reducedPhotoCount}\n            onClick={() => onMarkerClick(obj)}\n            active={\n              selectedItem &&\n            selectedItem.properties.id === obj.properties.id &&\n            selectedItem.properties.count === obj.properties.count\n            }\n          />\n        </Marker>\n      ))\n  ]), [filteredClusteredData, selectedItem, isTransitioning])\n\n  const selectedItemRender = useMemo(() => !!selectedItem && (\n    <Paper className={classes.selectedPopup}>\n      {selectedItem.properties.count === 1\n        ? <SeriesListItem\n          series={selectedItem.properties}\n          showCreatedOn\n          showLastPhoto\n          onClick={() => onSeriesNavigate(selectedItem.properties.id)}\n        />\n        : <ClusterSelected\n          seriesCount={selectedItem.properties.count}\n          reducedPhotoCount={selectedItem.properties.reducedPhotoCount}\n          onViewList={() => setShowViewList(true)}\n          onClose={() => updateSelectedItem(null)}\n          onZoomTo={() => onZoomTo(selectedItem)}\n        />\n      }\n    </Paper>\n  ), [selectedItem])\n\n  return (\n    <div className={classes.root} ref={homeMapContainerRef}>\n      <TopBar isTransparent className={classes.topBar}>\n        <SearchInput\n          isTransparent\n          onClick={onSearchClick}\n          defaultValue={''}\n        />\n      </TopBar>\n      {loading && (\n        <div className={classes.loadingWrapper}>\n          <CircularProgress size={80} thickness={7} color='inherit' />\n          {/* <Typography variant='h3' color='inherit'>Loading...</Typography> */}\n        </div>\n      )}\n\n      <BaseMap\n        showMe\n        // This should only change on INIT or transition events\n        viewport={mapViewObj.viewport}\n        transitions={transitions}\n        mapStyles={MapStyles}\n        controlPadding={{ top: 56 }}\n        initStyle={MapStyles.length > 1 ? 1 : 0}\n        {...lock}\n        onTransitionStart={() => {\n          setIsTransitioning(true)\n        }}\n        onTransitionEnd={() => {\n          setIsTransitioning(false)\n          setTransitions(null)\n        }}\n        bounds={mapViewObj.bounds}\n        maxZoom={20}\n        minZoom={1}\n        onViewportChange={onViewportChange}\n        onNativeClick={() => {\n          if (selectedItem) updateSelectedItem(null)\n        }}\n      >\n        {markersRendered}\n      </BaseMap>\n      {selectedItem && selectedItem.properties.count > 1 && (\n        <ViewListDialog\n          open={showViewList}\n          title={`${selectedItem.properties.count} Series`}\n          onClose={() => setShowViewList(false)}\n          onSelect={onSeriesNavigate}\n          seriesList={selectedItem.properties.points.map(p => p.properties)}\n        />\n      )}\n      {selectedItemRender}\n    </div>\n  )\n}\n\nHomeMap.propTypes = {\n  seriesList: PropTypes.array,\n  queryVersion: PropTypes.number,\n  activeSeries: PropTypes.string,\n  initViewport: PropTypes.object,\n  loading: PropTypes.bool,\n  // These all get loaded up through mapFuncs in HomeMap.connect\n  onSearchClick: PropTypes.func,\n  onSeriesNavigate: PropTypes.func,\n  onSeriesMapSelect: PropTypes.func,\n  popMapHistory: PropTypes.func,\n  pushMapHistory: PropTypes.func,\n  clearMapHistory: PropTypes.func\n}\n\nexport default HomeMap\n\n// function getInitialState (initViewport) {\n//   return {\n//     viewport: { ...defaultView, ...initViewport.viewport },\n//     bounds: initViewport.bounds,\n//     filterBounds: null\n//   }\n// }\n","import React, { useEffect, useState, useRef, useMemo } from 'react'\nimport PropTypes from 'prop-types'\nimport { connect } from 'react-redux'\nimport { graphql } from 'react-apollo'\nimport { allSeries, pollQuery } from '../graphql/queries'\nimport actions from '../redux/actions'\nimport { home } from '../config'\nimport HomeMap from '../components/maps/HomeMap'\n\nconst POLL_INTERVAL = 20 // (seconds)\n\n/**\n * The outer component handles the lastCheck variable which, when changed will\n * cause the poll event\n */\nconst HomeMapConnector = ({ initViewport, activeSeries, mapFuncs }) => {\n  const [seriesProps, setSeriesProps] = useState()\n  const [queryVersion, setVersion] = useState(0)\n  const updateIncrement = () => setVersion(queryVersion + 1)\n  const timerRef = useRef()\n  const [lastCheck, setLastCheck] = useState(null)\n  timerRef.current = lastCheck\n\n  // These are expensive queries so we render them memoized to prevent erroneous re-renders\n  const allSeriesQUERY = useMemo(() => <AllSeriesConnect setSeriesProps={setSeriesProps} />, [])\n  const pollSeriesQUERY = useMemo(() => <PollQueryConnect lastCheck={lastCheck} seriesProps={seriesProps} updateIncrement={updateIncrement} />, [lastCheck])\n\n  // Initiate the polling process. We simply update the timestamp every N seconds\n  useEffect(() => {\n    if (!seriesProps) return\n    function ping () {\n      if (timerRef.current) setLastCheck(String(Date.now() - POLL_INTERVAL * 1000))\n    }\n    if (!timerRef.current && seriesProps.readyForPolling) timerRef.current = setInterval(ping, POLL_INTERVAL * 1000)\n    return () => {\n      if (timerRef.current) {\n        console.log('clear poll timer')\n        clearInterval(timerRef.current)\n        timerRef.current = null\n      }\n    }\n  }, [seriesProps])\n\n  return (\n    <React.Fragment>\n      {allSeriesQUERY}\n      {pollSeriesQUERY}\n      <HomeMap\n        queryVersion={queryVersion}\n        seriesList={seriesProps && seriesProps.allSeries ? seriesProps.allSeries.seriesSummaries : []}\n        activeSeries={activeSeries}\n        initViewport={initViewport}\n        loading={seriesProps && seriesProps.loading}\n        {...mapFuncs}\n      />\n    </React.Fragment>\n  )\n}\nHomeMapConnector.propTypes = {\n  activeSeries: PropTypes.string, // from redux\n  initViewport: PropTypes.object, // from redux\n  mapFuncs: PropTypes.object // from redux passed straight through to the map\n\n}\n\nconst withAllSeries = graphql(allSeries, {\n  props: ({ data, ownProps }) => {\n    // If there's more data to load we should go get another batch\n    if (!data.loading && !data.error && data.allSeries && data.allSeries.seriesSummaries.length > 0 && data.allSeries.nextToken) {\n      data.fetchMore({\n        variables: { ...data.variables, nextToken: data.allSeries.nextToken },\n        // How do we mush the new query with the old one\n        updateQuery: (prev, { fetchMoreResult }) => {\n          return {\n            allSeries: {\n              ...fetchMoreResult.allSeries,\n              seriesSummaries: [ ...prev.allSeries.seriesSummaries, ...fetchMoreResult.allSeries.seriesSummaries ]\n            }\n          }\n        }\n      })\n    }\n    else if (data.loading || data.error) {\n      ownProps.setSeriesProps(data)\n    }\n    else {\n      ownProps.setSeriesProps({ ...data, readyForPolling: true })\n    }\n    return null\n  },\n  options: {\n    variables: { limit: 100 }\n  }\n})\n\n/**\n * Here's the graphql HOC that gets an individual series\n */\nconst withPollQuery = graphql(pollQuery, {\n  skip: ({ lastCheck, online }) => !lastCheck || !online,\n  props: ({ data, ownProps: { seriesProps, updateIncrement } }) => {\n    if (data.error) {\n      console.log('POLL FAIL', data.error, data)\n      console.error(data.error)\n    }\n    if (!data.loading && data.changedSeries && data.changedSeries.seriesSummaries) {\n      // console.log('POLLING', { data, seriesProps })\n      const newData = data.changedSeries.seriesSummaries\n      const oldList = seriesProps.allSeries.seriesSummaries\n      // console.log('DEBUG', seriesProps)\n      // If the polling has begun and we have some good polling data back then\n      // Process it and decide if we need to incorporate it\n      if (data.changedSeries) {\n        let newSeriesSummaries = seriesProps.allSeries.seriesSummaries\n        newData.forEach(({ seriesStatus, ...polledSeries }) => {\n          if (seriesStatus === 'deleted') {\n            console.log('Polling found a series to delete: ', polledSeries.id)\n            newSeriesSummaries = oldList.filter(s => s.id !== polledSeries.id)\n          }\n          else {\n            const idx = oldList.findIndex(ds => ds.id === polledSeries.id)\n            if (idx >= 0) {\n              console.log('Polling found a series to Update: ', polledSeries.id)\n              newSeriesSummaries = oldList.map((oldSeries, oldId) => oldId === idx ? polledSeries : oldSeries)\n            }\n            else {\n              console.log('Polling found a series to add: ', polledSeries.id)\n              newSeriesSummaries = [...oldList, polledSeries]\n            }\n          }\n          seriesProps.updateQuery((data, options) => {\n            try {\n              const newData = { ...data }\n              newData.allSeries.seriesSummaries = newSeriesSummaries\n              updateIncrement()\n              return data\n            }\n            catch (e) {\n              console.error(e)\n              return data\n            }\n          })\n        })\n      }\n    }\n    return null\n  },\n  options: ({ lastCheck }) => ({\n    variables: {\n      limit: 100,\n      lastCheck\n    }\n  })\n})\n\n// We're using graphql() HOC because it's convenient but it doesn't need to render anything\nconst AllSeriesConnect = withAllSeries(() => null)\nconst PollQueryConnect = withPollQuery(() => null)\n\n// The only part of the state the main view caes about is teh window\nconst mapStateToProps = (state, props) => {\n  const { current: { activeSeries } } = state.home\n  const initViewport = state.map.slice(-1).pop()\n  return { activeSeries, initViewport }\n}\n\n// There are a few presentational actions the main window can use\nconst mapDispatchToProps = dispatch => ({\n  mapFuncs: {\n    onSeriesNavigate: (activeSeries) => {\n      dispatch(actions.setHomeState(home.AppStateTypes.SERIES, { activeSeries }))\n    },\n    onSeriesMapSelect: (activeSeries) => {\n      dispatch(actions.setActiveSeries(activeSeries))\n    },\n    onSearchClick: () => {\n      dispatch(actions.setHomeState(home.AppStateTypes.SEARCH, { search: { tab: home.SEARCH_TABS.LOCATION, text: '' } }))\n    },\n    popMapHistory: () => {\n      dispatch(actions.popMapHistory())\n    },\n    pushMapHistory: (viewportSave) => {\n      dispatch(actions.pushMapHistory(viewportSave))\n    },\n    clearMapHistory: () => {\n      dispatch(actions.clearMapHistory())\n    }\n  }\n})\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(HomeMapConnector)\n","import React from 'react'\nimport classNames from 'classnames'\nimport PropTypes from 'prop-types'\nimport List from '@material-ui/core/List'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemAvatar from '@material-ui/core/ListItemAvatar'\nimport ListItemText from '@material-ui/core/ListItemText'\nimport ListItemIcon from '@material-ui/core/ListItemIcon'\nimport IconButton from '@material-ui/core/IconButton'\nimport Avatar from '@material-ui/core/Avatar'\n\nimport PlaceIcon from '@material-ui/icons/Place'\nimport PersonIcon from '@material-ui/icons/Person'\nimport LabelIcon from '@material-ui/icons/Label'\nimport CancelIcon from '@material-ui/icons/Cancel'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport { Typography } from '@material-ui/core'\nconst useStyles = makeStyles(theme => ({\n  root: {\n\n  },\n  chosenItem: {\n    color: theme.palette.primary.contrastText,\n    background: theme.palette.primary.dark\n  },\n  avatar: {\n    background: theme.palette.primary.main\n  },\n  closeIcon: {\n    color: theme.palette.primary.contrastText,\n    paddingRight: 0\n  },\n  avatarImg: {\n    height: '100%',\n    width: '100%',\n    objectFit: 'cover'\n  }\n}))\n\nconst SearchContextItem = ({ className, variant, name, description, gravatar, onClick, onCancel }) => {\n  const classes = useStyles()\n  let TheIcon = PlaceIcon\n\n  const getAvatar = (src) => () => (\n    <Avatar className={classes.avatar}>\n      <img className={classes.avatarImg} alt='profile' src={src} />\n    </Avatar>\n  )\n\n  switch (variant) {\n    case 'tag':\n      TheIcon = LabelIcon\n      break\n    case 'location':\n      TheIcon = PlaceIcon\n      break\n    case 'user':\n      TheIcon = gravatar ? getAvatar(gravatar) : PersonIcon\n      break\n    default:\n      break\n  }\n  return (\n    <ListItem\n      className={classNames(className, classes.root, onCancel ? classes.chosenItem : null)}\n      button={!!onClick}\n      onClick={onClick}\n    >\n      <ListItemAvatar>\n        <Avatar className={classes.avatar}>\n          <TheIcon color='inherit' />\n        </Avatar>\n      </ListItemAvatar>\n      <ListItemText disableTypography>\n        <Typography variant='body1' color='inherit'>{name}</Typography>\n        <Typography variant='body2' color='inherit'>{description}</Typography>\n      </ListItemText>\n      {onCancel && (\n        <ListItemIcon>\n          <IconButton onClick={onCancel} className={classes.closeIcon}>\n            <CancelIcon color='inherit' />\n          </IconButton>\n        </ListItemIcon>\n      )}\n    </ListItem>\n  )\n}\n\nSearchContextItem.propTypes = {\n  variant: PropTypes.oneOf(['tag', 'location', 'user']),\n  onClick: PropTypes.func,\n  gravatar: PropTypes.string,\n  className: PropTypes.string,\n  name: PropTypes.string.isRequired,\n  description: PropTypes.string,\n  onCancel: PropTypes.func\n}\n\nexport default SearchContextItem\n\nexport const SearchContexItemCosmos = () => {\n  return (\n    <List>\n      <SearchContextItem variant='tag' name='SomeTag' description='Some description of what I am' />\n      <SearchContextItem variant='location' name='Some Location' description='Some description of what I am' />\n      <SearchContextItem variant='user' name='User McUserSon' description='Some description of what I am' />\n    </List>\n  )\n}\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport List from '@material-ui/core/List'\nimport Typography from '@material-ui/core/Typography'\n\nimport SearchContextItem from './SearchContextItem'\n// import MenuIcon from '@material-ui/icons/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    height: '100%',\n    backgroundColor: theme.palette.background.paper,\n    position: 'relative',\n    overflowX: 'hidden',\n    overflowY: 'scroll',\n    flexGrow: 1\n  },\n  listSection: {\n    backgroundColor: 'inherit'\n  },\n  placeholderText: {\n    textAlign: 'center',\n    padding: theme.spacing(3, 1),\n    color: theme.palette.grey[400]\n  },\n  ul: {\n    backgroundColor: 'inherit',\n    padding: 0\n  }\n}))\n\nconst SearchContextResults = ({ variant, loading, contextResults, setContextChoice }) => {\n  const classes = useStyles()\n  if (loading) {\n    return <Typography className={classes.placeholderText} variant='h3'>Searching...</Typography>\n  }\n  else if (!contextResults || contextResults.length === 0) {\n    return <Typography className={classes.placeholderText} variant='h4'>No {variant} results</Typography>\n  }\n\n  return (\n    <List className={classes.root}>\n      {contextResults.map((cr, idx) => (\n        <SearchContextItem\n          key={`scr-${idx}`}\n          variant={variant}\n          onClick={() => setContextChoice(cr)}\n          {...cr}\n        />\n      ))}\n    </List>\n  )\n}\n\nSearchContextResults.propTypes = {\n  variant: PropTypes.oneOf(['tag', 'location', 'user']),\n  loading: PropTypes.bool,\n  contextResults: PropTypes.array.isRequired,\n  setContextChoice: PropTypes.func.isRequired\n}\n\nexport default SearchContextResults\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\n// import MenuIcon from '@material-ui/icons/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nconst useStyles = makeStyles(theme => ({\n  root: {\n    textAlign: 'center',\n    fontStyle: 'italic',\n    padding: theme.spacing(2, 1)\n  }\n}))\n\nconst SearchEnder = ({ style, icon, text }) => {\n  const classes = useStyles()\n  return (\n    <Typography className={classes.root} variant='subtitle1' color='textSecondary' component='div' style={style}>\n      {icon}\n      {text}\n    </Typography>\n  )\n}\n\nSearchEnder.propTypes = {\n  style: PropTypes.object,\n  icon: PropTypes.any,\n  text: PropTypes.string\n}\n\nexport default SearchEnder\n","import React, { useRef, useEffect } from 'react'\nimport PropTypes from 'prop-types'\nimport List from '@material-ui/core/List'\nimport Typography from '@material-ui/core/Typography'\n\nimport SearchContextItem from './SearchContextItem'\nimport SearchEnder from './SearchEnder'\n// import MenuIcon from '@material-ui/icons/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nimport SeriesListItem from '../misc/SeriesListItem'\nimport { debounce } from '../../lib/util'\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    height: '100%',\n    flexGrow: 1,\n    display: 'flex',\n    flexDirection: 'column',\n    overflow: 'hidden'\n  },\n  ctxItem: {\n    flexGrow: 0\n  },\n  list: {\n    flexGrow: 1,\n    backgroundColor: theme.palette.background.paper,\n    position: 'relative',\n    overflowX: 'hidden',\n    overflowY: 'scroll'\n  },\n  placeholderText: {\n    textAlign: 'center',\n    padding: theme.spacing(3, 1),\n    color: theme.palette.grey[400]\n  },\n  listSection: {\n    backgroundColor: 'inherit'\n  },\n  ul: {\n    backgroundColor: 'inherit',\n    padding: 0\n  }\n}))\n\nconst SearchResults = ({ variant, loading, seriesList, contextChoice, onCancel, onResultClick, fetchMore }) => {\n  const classes = useStyles()\n  const listRef = useRef()\n  const enderRef = useRef()\n\n  const handleScroll = debounce(() => {\n    if (!loading && fetchMore && enderRef.current && listRef.current) {\n      const { offsetTop } = enderRef.current\n      const { scrollTop, offsetHeight } = listRef.current\n      const scrollBottom = offsetHeight + scrollTop\n      if (offsetTop < scrollBottom * 2) {\n        console.log('SCROLL', { offsetHeight, scrollTop, offsetTop })\n        fetchMore()\n      }\n    }\n  }, 500)\n\n  useEffect(handleScroll, [seriesList])\n\n  let content = null\n  if (loading) {\n    content = (\n      <Typography className={classes.placeholderText} variant='h3'>Searching...</Typography>\n    )\n  }\n  else if (seriesList && seriesList.length > 0) {\n    content = seriesList.map((series, idx) => (\n      <SeriesListItem\n        key={`series-${idx}`}\n        series={series}\n        onClick={() => onResultClick(series.id)}\n        showCreatedOn\n        showLastPhoto\n      />\n    ))\n    content.push(\n      <div key='ender' ref={enderRef}>\n        <SearchEnder text={fetchMore ? 'Loading...' : 'No More Results'} />\n      </div>\n    )\n  }\n  else {\n    content = (\n      <Typography className={classes.placeholderText} variant='h4'>No series found</Typography>\n    )\n  }\n\n  return (\n    <div className={classes.root}>\n      <SearchContextItem className={classes.ctxItem} {...contextChoice} variant={variant} onCancel={onCancel} />\n      <List className={classes.list} subheader={<li />} onScroll={handleScroll} innerRef={listRef}>\n        {content}\n      </List>\n    </div>\n  )\n}\n\nSearchResults.propTypes = {\n  variant: PropTypes.oneOf(['tag', 'location', 'user']),\n  seriesList: PropTypes.array.isRequired,\n  loading: PropTypes.bool,\n  contextChoice: PropTypes.object.isRequired,\n  onResultClick: PropTypes.func.isRequired,\n  onCancel: PropTypes.func.isRequired,\n  fetchMore: PropTypes.func\n}\n\nexport default SearchResults\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\nimport Typography from '@material-ui/core/Typography'\n// import MenuIcon from '@material-ui/icons/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nconst useStyles = makeStyles(theme => ({\n  root: {\n    flexGrow: 1,\n    padding: '10%',\n    display: 'flex',\n    flexDirection: 'column',\n    opacity: 0.3,\n    textAlign: 'center'\n  },\n  icon: {\n    width: '100%',\n    flex: '1 1 40%',\n    color: theme.palette.primary.light,\n    opacity: 0.5\n  },\n  primary: {\n    flex: '1 1 30%',\n    width: '100%'\n  },\n  secondary: {\n    flex: '1 1 30%',\n    width: '100%'\n  }\n}))\n\nconst SearchPlaceholder = ({ icon, primary, secondary }) => {\n  const classes = useStyles()\n  const PlaceholderIcon = icon\n  return (\n    <div className={classes.root}>\n      <PlaceholderIcon className={classes.icon} />\n      {primary && (\n        <Typography className={classes.primary} variant='h3'>\n          {primary}\n        </Typography>\n      )}\n      {secondary && (\n        <Typography className={classes.secondary} variant='h4'>\n          {secondary}\n        </Typography>\n      )}\n    </div>\n  )\n}\n\nSearchPlaceholder.propTypes = {\n  icon: PropTypes.object,\n  primary: PropTypes.string,\n  secondary: PropTypes.string\n}\n\nexport default SearchPlaceholder\n","import React, { useEffect } from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport Tabs from '@material-ui/core/Tabs'\nimport Tab from '@material-ui/core/Tab'\n\nimport SearchContextResults from './SearchContextResults'\nimport SearchResults from './SearchResults'\nimport SearchPlaceholder from './SearchPlaceholder'\nimport TopBar from '../TopBar'\nimport SearchInput from './SearchInput'\nimport useOnline from '../../lib/useOnline'\nimport { home } from '../../config'\nimport PortableWifiOffIcon from '@material-ui/icons/PortableWifiOff'\nimport LabelIcon from '@material-ui/icons/Label'\nimport PlaceIcon from '@material-ui/icons/Place'\nimport PersonIcon from '@material-ui/icons/Person'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst TABS = home.SEARCH_TABS\n\nconst style = theme => ({\n  root: {\n    height: '100%',\n    display: 'flex',\n    overflow: 'hidden',\n    flexDirection: 'column'\n  },\n  tabs: {\n    // backgroundColor: theme.palette.primary.main,\n    // color: theme.palette.primary.contrastText,\n    // background: `linear-gradient(90deg, ${theme.palette.primary.dark} 0%, ${theme.palette.secondary.dark} 100%)`\n\n  },\n  ListWrapper: {\n    flexGrow: 1,\n    overflow: 'hidden',\n    display: 'flex',\n    flexDirection: 'column'\n  },\n  tab: {\n    flexGrow: 1\n  },\n  grow: {\n    flexGrow: 1\n  }\n})\n\nconst useStyles = makeStyles(style)\n\nconst Search = ({\n  onMenuBack, currentTab, setCurrentTab, defaultText, searchText,\n  setSearchText, contextResults, searchResults, contextChoice,\n  loading, setContextChoice, onMapClick, onResultClick, fetchMore\n}) => {\n  const classes = useStyles()\n\n  const { online } = useOnline()\n\n  // If there's only one thing then use it\n  useEffect(() => {\n    if (contextResults && !searchResults && contextResults.length === 1) {\n      setContextChoice(contextResults[0])\n    }\n  }, [contextResults])\n\n  let placeholder = {}\n  switch (currentTab) {\n    case TABS.TAG:\n      placeholder = { primary: 'Tag search', secondary: 'example: \\'beaver...\\'', icon: LabelIcon }\n      break\n    case TABS.USER:\n      placeholder = { primary: 'User search', secondary: 'example: \\'SuperGreg123...\\'', icon: PersonIcon }\n      break\n    case TABS.LOCATION:\n      placeholder = { primary: 'Location Search', secondary: 'example: \\'Vancouver...\\'', icon: PlaceIcon }\n      break\n\n    default:\n      break\n  }\n\n  let content = null\n  if (!online) {\n    content = (\n      <SearchPlaceholder\n        primary='Search Disabled'\n        secondary='(Offline)'\n        icon={PortableWifiOffIcon}\n      />\n    )\n  }\n  else if (contextChoice && searchResults) {\n    content = (\n      <SearchResults\n        variant={currentTab}\n        loading={loading}\n        onResultClick={onResultClick}\n        fetchMore={fetchMore}\n        seriesList={searchResults}\n        contextChoice={contextChoice}\n        onCancel={() => setContextChoice(null)}\n      />\n    )\n  }\n  else if (contextResults) {\n    content = (\n      <SearchContextResults\n        loading={loading}\n        variant={currentTab}\n        contextResults={contextResults}\n        setContextChoice={currentTab === TABS.LOCATION ? onMapClick : setContextChoice}\n      />\n    )\n  }\n  else if (defaultText.length > 0) {\n    content = (\n      <Typography>Searching for {`'${searchText}'` || '...'}</Typography>\n    )\n  }\n  else {\n    content = <SearchPlaceholder {...placeholder} />\n  }\n\n  return (\n    <div className={classes.root}>\n      <TopBar>\n        <SearchInput\n          disabled={!online}\n          // autoFocus\n          onChange={setSearchText}\n          defaultValue={searchText}\n        />\n      </TopBar>\n      {online && (\n        <Tabs\n          value={currentTab}\n          disabled={!online}\n          onChange={(e, val) => setCurrentTab(val)}\n          indicatorColor='primary'\n          classes={{ flexContainer: classes.tabs }}\n          centered\n        >\n          <Tab className={classes.tab} value={TABS.TAG} label='Tags' />\n          <Tab className={classes.tab} value={TABS.LOCATION} label='Places' />\n          <Tab className={classes.tab} value={TABS.USER} label='Users' />\n        </Tabs>\n      )}\n      <div className={classes.ListWrapper} >\n        {content}\n      </div>\n    </div>\n  )\n}\n\nSearch.propTypes = {\n  onMenuBack: PropTypes.func.isRequired,\n  loading: PropTypes.bool,\n  currentTab: PropTypes.string.isRequired,\n  setCurrentTab: PropTypes.func.isRequired,\n  searchText: PropTypes.string.isRequired,\n  setSearchText: PropTypes.func.isRequired,\n  fetchMore: PropTypes.func,\n  contextResults: PropTypes.array,\n  searchResults: PropTypes.array,\n  contextChoice: PropTypes.object,\n  setContextChoice: PropTypes.func.isRequired,\n  onMapClick: PropTypes.func.isRequired,\n  onResultClick: PropTypes.func.isRequired\n}\nSearch.defaultProps = {\n  currentTab: TABS.TAGS,\n  defaultText: ''\n}\n\nexport default Search\n","import React, { useState, useMemo } from 'react'\nimport PropTypes from 'prop-types'\nimport { home } from '../config'\n// import { smallestHash } from 'geotilehash'\nimport { graphql, compose } from 'react-apollo'\nimport { point, bbox as bboxFunc, buffer } from '@turf/turf'\n\nimport { connect } from 'react-redux'\nimport actions from '../redux/actions'\nimport { tagSearch, seriesWithTag, userSearch, userSeries, geocode } from '../graphql/queries'\nimport Search from '../components/Search/Search'\n// import { AppContext } from '../contexts'\n// import { debounce } from '../lib/util'\nimport { formatDatAgo } from '../lib/datelib'\n\nconst SearchConnect = ({\n  jumpToMap, jumpToSeries, defaultTab, defaultText, fetchMore\n}) => {\n  // const { role, user } = useContext(AppContext)\n\n  const [currentTab, setCurrentTab] = useState(defaultTab || home.SEARCH_TABS.TAG)\n  // We separate these because one of them needs to be immediate and the\n  const [searchText, setSearchText] = useState(defaultText || '')\n  const [contextChoice, setContextChoice] = useState(null)\n\n  const handleTabChange = (newTab) => {\n    setContextChoice(null)\n    setCurrentTab(newTab)\n  }\n  const handleContextChoiceChange = (newContextChoice) => {\n    setContextChoice(newContextChoice)\n  }\n  const handleSearchTextChange = (text) => {\n    setSearchText(text)\n    setContextChoice(null)\n  }\n\n  let withContextQuery = null\n  let withSearchQuery = null\n\n  switch (currentTab) {\n    case home.SEARCH_TABS.TAG:\n      withContextQuery = withTagSearch\n      withSearchQuery = withTagSeries\n      break\n    case home.SEARCH_TABS.LOCATION:\n      withContextQuery = withGeoCode\n      // withSearchQuery = withGeoSearch\n      break\n    case home.SEARCH_TABS.USER:\n      withContextQuery = withUserSearch\n      withSearchQuery = withUserSeries\n      break\n    default:\n      break\n  }\n\n  const ComposedSearch = useMemo(() => withSearchQuery\n    ? compose(\n      withContextQuery,\n      withSearchQuery\n    )(Search)\n    : withContextQuery(Search), [withContextQuery, withSearchQuery])\n\n  return <ComposedSearch {...{ currentTab, searchText, contextChoice }}\n    onMenuBack={() => {}}\n    onMapClick={jumpToMap}\n    onResultClick={jumpToSeries}\n    setContextChoice={handleContextChoiceChange}\n    fetchMore={fetchMore}\n    setCurrentTab={handleTabChange}\n    setSearchText={handleSearchTextChange}\n  />\n}\nSearchConnect.propTypes = {\n  searchResults: PropTypes.array,\n  contextResults: PropTypes.array,\n  loading: PropTypes.bool,\n  jumpToMap: PropTypes.func,\n  jumpToSeries: PropTypes.func,\n  fetchMore: PropTypes.func\n}\n/*****************************************************************\n *  PART 1: SEARCH QUERIES\n *****************************************************************/\n\n/**\n * Here's the graphql HOC that gets an individual series\n */\nconst withTagSearch = graphql(tagSearch, {\n  props: ({ data }) => {\n    if (data.error) console.error(data.error)\n    // console.log('withTagSearch', data)\n    let series = null\n    try {\n      if (!data.loading && !data.error) series = data.series\n    }\n    catch (e) {\n      console.error(data)\n      console.error(e)\n    }\n    const contextResults = data.tags ? data.tags.map(({ name, count }) => ({\n      name,\n      description: `~ ${count < 10 ? count : Math.ceil(count / 10) * 10} Photo series tagged`\n    })) : []\n\n    return {\n      contextResults,\n      loading: data.loading,\n      series\n    }\n  },\n  // skip: ({ searchText }) => !searchText || searchText.length < 3,\n  options: ({ searchText }) => ({\n    variables: {\n      tag: !searchText || searchText.length < 3 ? '' : searchText,\n      limit: 10\n    }\n  })\n})\n\nconst withUserSearch = graphql(userSearch, {\n  props: ({ data }) => {\n    if (data.error) console.error(data.error)\n    // console.log('withUserSearch', data)\n    let series = null\n    try {\n      if (!data.loading && !data.error) series = data.series\n    }\n    catch (e) {\n      console.error(data)\n      console.error(e)\n    }\n\n    const contextResults = data.userSearch ? data.userSearch.map(({ username, gravatar, createdOn, id }) => ({\n      name: username,\n      id,\n      description: `Joined ${formatDatAgo(createdOn)}`,\n      gravatar\n    })) : []\n\n    return {\n      contextResults,\n      loading: data.loading,\n      series\n    }\n  },\n  skip: ({ searchText }) => !searchText || searchText.length < 3,\n  options: ({ searchText }) => ({\n    variables: {\n      searchStr: searchText,\n      limit: 10\n    }\n  })\n})\n\nconst withGeoCode = graphql(geocode, {\n  props: ({ data }) => {\n    if (data.error) console.error(data.error)\n    // console.log('withGeoCode', data)\n    let series = null\n    try {\n      if (!data.loading && !data.error) series = data.series\n    }\n    catch (e) {\n      console.error(data)\n      console.error(e)\n    }\n\n    const contextResults = data.geocoder ? data.geocoder.map(({ relevance, text, placeName, bbox, center }) => ({\n      name: text,\n      description: placeName,\n      bbox,\n      center,\n      relevance\n    })) : []\n\n    return {\n      contextResults,\n      loading: data.loading,\n      series\n    }\n  },\n  skip: ({ searchText }) => !searchText || searchText.length < 3,\n  options: ({ searchText }) => ({\n    variables: {\n      search: searchText\n      // limit: 10\n    }\n  })\n})\n\n/*****************************************************************\n * PART 2: SERIES SEARCH QUERIES\n *****************************************************************/\n\nconst withTagSeries = graphql(seriesWithTag, {\n  props: ({ data }) => {\n    if (data.error) console.error(data.error)\n    // console.log('withTagSeries', data)\n    let series = null\n    try {\n      if (!data.loading && !data.error) series = data.series\n    }\n    catch (e) {\n      console.error(data)\n      console.error(e)\n    }\n\n    // A second Thunk function designed to get more elements in the feed history\n    const fetchMore = data.loading || !data.tagSeries || !data.tagSeries.nextToken ? null : () => {\n      console.log('fetchMore', data)\n      data.fetchMore({\n        variables: { ...data.variables, nextToken: data.tagSeries.nextToken },\n        // How do we mush the new query with the old one\n        updateQuery: (prev, { fetchMoreResult }) => {\n          return {\n            tagSeries: {\n              ...fetchMoreResult.tagSeries,\n              seriesSummaries: [ ...prev.tagSeries.seriesSummaries, ...fetchMoreResult.tagSeries.seriesSummaries ]\n            }\n          }\n        }\n      })\n    }\n\n    const searchResults = data.tagSeries && data.tagSeries.seriesSummaries\n      ? data.tagSeries.seriesSummaries\n      : []\n\n    return {\n      searchResults,\n      fetchMore,\n      loading: data.loading,\n      series\n    }\n  },\n  skip: ({ contextChoice }) => !contextChoice,\n  options: ({ contextChoice }) => ({\n    variables: {\n      tag: contextChoice.name,\n      limit: 10\n    }\n  })\n})\n\nconst withUserSeries = graphql(userSeries, {\n  props: ({ data }) => {\n    if (data.error) console.error(data.error)\n    // console.log('withUserSeries', data)\n    let series = null\n    try {\n      if (!data.loading && !data.error) series = data.series\n    }\n    catch (e) {\n      console.error(data)\n      console.error(e)\n    }\n\n    // A second Thunk function designed to get more elements in the feed history\n    const fetchMore = data.loading || !data.userSeries || !data.userSeries.nextToken ? null : () => {\n      console.log('fetchMore', data)\n      data.fetchMore({\n        variables: { ...data.variables, nextToken: data.userSeries.nextToken },\n        // How do we mush the new query with the old one\n        updateQuery: (prev, { fetchMoreResult }) => {\n          return {\n            userSeries: {\n              ...fetchMoreResult.userSeries,\n              seriesSummaries: [ ...prev.userSeries.seriesSummaries, ...fetchMoreResult.userSeries.seriesSummaries ]\n            }\n          }\n        }\n      })\n    }\n\n    const searchResults = data.userSeries && data.userSeries.seriesSummaries\n      ? data.userSeries.seriesSummaries\n      : []\n\n    return {\n      searchResults,\n      fetchMore,\n      loading: data.loading,\n      series\n    }\n  },\n  skip: ({ contextChoice }) => !contextChoice,\n  options: ({ contextChoice }) => ({\n    variables: {\n      createdBy: contextChoice.id,\n      limit: 10\n    }\n  })\n})\n\n// const withGeoSearch = graphql(geoSeries, {\n//   props: ({ data }) => {\n//     if (data.error) console.error(data.error)\n//     // console.log('HERE', data)\n//     let series = null\n//     try {\n//       if (!data.loading && !data.error) series = data.series\n//     }\n//     catch (e) {\n//       console.error(data)\n//       console.error(e)\n//     }\n//     return {\n//       data,\n//       loading: data.loading,\n//       series\n//     }\n//   },\n//   skip: ({ contextChoice }) => !contextChoice,\n//   options: ({ contextChoice }) => ({\n//     variables: {\n//       bounds: contextChoice.bbox\n//       // limit: 10\n//       // nextToken\n//     }\n//   })\n// })\n\n/**\n * Map our redux state and functions\n */\nconst mapStateToProps = (state, props) => {\n  const { current: { search, activeSeries, domain } } = state.home\n  return {\n    defaultTab: search ? search.tab : null,\n    defaultText: search ? search.text : null,\n    activeSeries,\n    domain\n  }\n}\n\nconst mapDispatchToProps = dispatch => ({\n  onBack: () => {\n    dispatch(actions.homeStateBack())\n  },\n  queueUpload: (uploadObj) => {\n    dispatch(actions.queueUpload(uploadObj))\n  },\n  jumpToSeries: (seriesId) => {\n    dispatch(actions.setHomeState(home.AppStateTypes.SERIES, { activeSeries: seriesId }))\n  },\n\n  jumpToMap: ({ bbox, center }) => {\n    let bounds = bbox\n    if (!bounds && center) {\n      const bufferPts = buffer(point(center), 500, { units: 'meters' })\n      bounds = bboxFunc(bufferPts)\n    }\n\n    if (bounds) {\n      dispatch(actions.pushMapHistory({\n        mode: home.MapModeTypes.FREE,\n        bounds: bounds\n      }))\n      dispatch(actions.setHomeState(home.AppStateTypes.MAP, { activeSeries: null, initialPhoto: null }))\n    }\n  }\n})\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(SearchConnect)\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemText from '@material-ui/core/ListItemText'\nimport ListItemIcon from '@material-ui/core/ListItemIcon'\n// import MenuIcon from '@material-ui/icons/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { formatDate } from '../../lib/datelib'\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n  },\n  imgContainer: {\n    flex: '0 0 100px',\n    // alignSelf: 'flex-start',\n    // height: '100%',\n    margin: theme.spacing(1, 1, 0, 2)\n  },\n  gravatarImg: {\n    verticalAlign: 'top'\n    // objectFit: 'cover',\n    // height: '100%',\n    // width: '100%'\n  }\n}))\n\nconst MeCard = ({ user, loading, onAvatarClick }) => {\n  const classes = useStyles()\n\n  if (loading || !user) return 'LOADING...'\n  // console.log('USER', user)\n\n  return (\n    <ListItem className={classes.root} onClick={onAvatarClick} disableGutters>\n      <ListItemIcon className={classes.imgContainer}>\n        <img alt='profile' className={classes.gravatarImg} src={user.gravatar} />\n      </ListItemIcon>\n      <ListItemText\n        primary={user.username}\n        secondary={`Member since: ${formatDate(user.createdOn, 'LL')}`}\n      />\n    </ListItem>\n  )\n}\n\nMeCard.propTypes = {\n  user: PropTypes.object,\n  loading: PropTypes.bool,\n  onAvatarClick: PropTypes.func\n}\n\nexport default MeCard\n","import React, { useState, useContext } from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport Divider from '@material-ui/core/Divider'\nimport Tabs from '@material-ui/core/Tabs'\nimport Tab from '@material-ui/core/Tab'\n\nimport SeriesListItem from '../misc/SeriesListItem'\nimport { makeStyles } from '@material-ui/core/styles'\nimport TopBar from '../TopBar'\nimport MeCard from './MeCard'\nimport { Button } from '@material-ui/core'\n\nimport { AppContext } from '../../contexts'\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    background: theme.palette.background.paper,\n    display: 'flex',\n    flexDirection: 'column',\n    height: '100%'\n  },\n  filterContainer: {\n    color: theme.palette.primary.secondary,\n    background: theme.palette.background.default,\n    textAlign: 'center',\n    padding: theme.spacing(1, 1)\n  },\n  filterChip: {\n\n  },\n  seriesListItemWrap: {\n    margin: theme.spacing(1, 0.5)\n  },\n  seriesList: {\n    height: '100%',\n    overflowX: 'hidden',\n    overflowY: 'scroll'\n  },\n  tabs: {\n    // background: theme.palette.background.default\n  },\n  noneFound: {\n    color: theme.palette.text.secondary,\n    textAlign: 'center',\n    padding: theme.spacing(2)\n  }\n}))\n\nconst SORT = {\n  ACTIVITY: 'Last Photo',\n  CREATED: 'Created',\n  NAME: 'Name'\n}\n\nconst MyProfile = ({ mySeries, watchingSeries, loading, jumpToSeries, jumpToMap }) => {\n  const classes = useStyles()\n  const [currentTab, setCurrentTab] = useState(0)\n  const [sortVal, setSort] = useState(SORT.ACTIVITY)\n  const [sortAsc, setSortAsc] = useState(false)\n\n  const { user } = useContext(AppContext)\n\n  const sortSetter = (newSort) => {\n    if (newSort === sortVal) setSortAsc(!sortAsc)\n    else setSort(newSort)\n  }\n\n  let tabFeed = currentTab === 0 ? mySeries : watchingSeries\n  if (!tabFeed) tabFeed = []\n\n  switch (sortVal) {\n    case SORT.ACTIVITY:\n      if (sortAsc) tabFeed.sort((a, b) => a.latest.takenOn - b.latest.takenOn)\n      else tabFeed.sort((a, b) => b.latest.takenOn - a.latest.takenOn)\n      break\n    case SORT.CREATED:\n      if (sortAsc) tabFeed.sort((a, b) => a.createdOn - b.createdOn)\n      else tabFeed.sort((a, b) => b.createdOn - a.createdOn)\n      break\n    case SORT.NAME:\n      if (sortAsc) {\n        tabFeed.sort((a, b) => {\n          if (a.name < b.name) {\n            return -1\n          }\n          if (a.name > b.firstname) {\n            return 1\n          }\n          return 0\n        })\n      }\n      else {\n        tabFeed.sort((a, b) => {\n          if (b.name < a.name) {\n            return -1\n          }\n          if (b.name > a.name) {\n            return 1\n          }\n          return 0\n        })\n      }\n      break\n    default:\n      break\n  }\n\n  return (\n    <div className={classes.root}>\n      <TopBar>\n        <Typography>My Profile</Typography>\n      </TopBar>\n      <MeCard user={user} />\n      {/* <Divider /> */}\n      <Tabs\n        value={currentTab}\n        onChange={(e, val) => setCurrentTab(val)}\n        indicatorColor='primary'\n        centered\n        classes={{ flexContainer: classes.tabs }}\n      >\n        <Tab className={classes.tab} value={0} label='My Series' />\n        <Tab className={classes.tab} value={1} label='Watching' />\n      </Tabs>\n      <Divider />\n      <div className={classes.filterContainer}>\n        <FilterSortItem asc={sortAsc} active={sortVal === SORT.NAME} onClick={() => sortSetter(SORT.NAME)} label={SORT.NAME} />\n        |\n        <FilterSortItem asc={sortAsc} active={sortVal === SORT.ACTIVITY} onClick={() => sortSetter(SORT.ACTIVITY)} label={SORT.ACTIVITY} />\n        |\n        <FilterSortItem asc={sortAsc} active={sortVal === SORT.CREATED} onClick={() => sortSetter(SORT.CREATED)} label={SORT.CREATED} />\n      </div>\n      <Divider />\n      <div className={classes.seriesList}>\n        {!loading && (!tabFeed || tabFeed.length === 0) && (\n          <Typography className={classes.noneFound} component='div'>No Series Found</Typography>\n        )}\n        {loading && (\n          <Typography className={classes.noneFound} component='div'>Loading...</Typography>\n        )}\n        {tabFeed.map((series, idx) => (\n          <SeriesListItem\n            key={`seriesListItem${idx}`}\n            series={series}\n            showCreatedOn\n            showLastPhoto\n            onClick={() => jumpToSeries(series.id)}\n          />\n        ))}\n      </div>\n    </div>\n  )\n}\n\nMyProfile.propTypes = {\n  loading: PropTypes.bool,\n  mySeries: PropTypes.array.isRequired,\n  watchingSeries: PropTypes.array.isRequired,\n  jumpToSeries: PropTypes.func.isRequired,\n  jumpToMap: PropTypes.func.isRequired\n}\n\nexport default MyProfile\n\nconst useFilterStyles = makeStyles(theme => ({\n  root: {\n    margin: theme.spacing(0, 1, 0, 1)\n  }\n}))\n\nconst FilterSortItem = ({ active, asc, onClick, label }) => {\n  const classes = useFilterStyles()\n\n  const arrow = asc === true ? '▲' : '▼'\n\n  return (\n    <Button\n      size='small'\n      className={classes.root}\n      onClick={onClick}\n      // variant='caption'\n      color={active ? 'secondary' : 'inherit'}\n    >\n      {label}\n      <span style={{ opacity: active ? 1 : 0 }}>\n        {arrow}\n      </span>\n    </Button>\n  )\n}\n\nFilterSortItem.propTypes = {\n  active: PropTypes.bool,\n  asc: PropTypes.bool,\n  onClick: PropTypes.func.isRequired,\n  label: PropTypes.string.isRequired\n}\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport { graphql, compose } from 'react-apollo'\nimport actions from '../redux/actions'\nimport { connect } from 'react-redux'\nimport { home } from '../config'\n\nimport { userSeries, seriesFromList } from '../graphql/queries'\nimport MyProfile from '../components/MyProfile/MyProfile'\n\nconst ProfileConnect = ({ data, jumpToSeries, jumpToMap }) => {\n  const { seriesQ, watchedSeriesQ } = data\n\n  const mySeries = seriesQ && seriesQ.userSeries && seriesQ.userSeries.seriesSummaries ? seriesQ.userSeries.seriesSummaries : []\n  const watchingSeries = watchedSeriesQ && watchedSeriesQ.arraySeries ? watchedSeriesQ.arraySeries : []\n  // console.log('ProfileConnect', { mySeries, watchedSeriesQ, watchingSeries })\n\n  const loading = Boolean(\n    (seriesQ && seriesQ.loading) ||\n    (watchedSeriesQ && watchedSeriesQ.loading)\n  )\n\n  return <MyProfile {...{ loading, mySeries, watchingSeries, jumpToSeries, jumpToMap }} />\n}\n\nProfileConnect.propTypes = {\n  data: PropTypes.object, // from graphql\n  jumpToSeries: PropTypes.func, // from redux\n  jumpToMap: PropTypes.func // from redux\n}\n\nconst withuserSeriesQuery = graphql(userSeries, {\n  props: ({ data, ownProps }) => {\n    // console.log('ProfileConnect withuserSeriesQuery', { data, ownProps })\n    return { data: { ...ownProps.data, seriesQ: data } }\n  }\n})\n\nconst withMyWatchedSeriesQuery = graphql(seriesFromList, {\n  props: ({ data, ownProps }) => {\n    // console.log('ProfileConnect withMyWatchedSeriesQuery', { data, ownProps })\n    return { data: { ...ownProps.data, watchedSeriesQ: data } }\n  },\n  skip: ({ data, user }) => {\n    try {\n      return user.watching.length < 1\n    }\n    catch (e) {\n      return true\n    }\n  },\n  options: ({ data, user }) => {\n    return {\n      variables: { seriesList: user.watching }\n    }\n  }\n})\n\n/**\n * Compose all our queries together\n */\nconst queryWrapped = compose(\n  withuserSeriesQuery,\n  // withMyPhotosQuery,\n  withMyWatchedSeriesQuery\n)(ProfileConnect)\n\n/**\n * Map our redux state and functions\n */\nconst mapStateToProps = (state, props) => {\n  return { }\n}\n\nconst mapDispatchToProps = dispatch => ({\n  jumpToSeries: (seriesId) => {\n    dispatch(actions.setHomeState(home.AppStateTypes.SERIES, { activeSeries: seriesId }))\n  },\n  jumpToMap: (seriesId) => {\n    dispatch(actions.setHomeState(home.AppStateTypes.MAP, { activeSeries: seriesId }))\n  }\n})\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(queryWrapped)\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\n// import MenuIcon from '@material-ui/icons/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nconst useStyles = makeStyles(theme => ({\n  root: {\n    display: 'flex',\n    alignItems: 'center'\n  },\n  grow: { flexGrow: 1 },\n  text: {\n    textAlign: 'center',\n    fontStyle: 'italic',\n    padding: theme.spacing(2, 1)\n  }\n}))\n\nconst FeedEnder = ({ style, icon, text }) => {\n  const classes = useStyles()\n  return (\n    <div className={classes.root}>\n      <div className={classes.grow} />\n      {icon}\n      <Typography className={classes.text} variant='subtitle1' color='textSecondary' component='div' style={style}>\n        {text}\n      </Typography>\n      <div className={classes.grow} />\n    </div>\n  )\n}\n\nFeedEnder.propTypes = {\n  style: PropTypes.object,\n  icon: PropTypes.any,\n  text: PropTypes.string\n}\n\nexport default FeedEnder\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Avatar from '@material-ui/core/Avatar'\nimport IconButton from '@material-ui/core/IconButton'\n\nimport PlaceIcon from '@material-ui/icons/Place'\nimport { makeStyles } from '@material-ui/core/styles'\nconst useStyles = makeStyles(theme => ({\n  root: {\n    textAlign: 'center'\n  },\n  placeAvatar: {\n    color: theme.palette.primary.contrastText,\n    border: `2px solid ${theme.palette.primary.contrastText}`,\n    background: theme.palette.text.primary,\n    margin: 'auto'\n  },\n  placeIcon: {\n  }\n}))\n\nconst FindOnMapButton = ({ onClick }) => {\n  const classes = useStyles()\n  return (\n    <div className={classes.root}>\n      <Avatar className={classes.placeAvatar}>\n        <IconButton color='inherit' onClick={e => {\n          e.preventDefault()\n          e.stopPropagation()\n          onClick()\n        }}>\n          <PlaceIcon color='inherit' />\n        </IconButton>\n      </Avatar>\n      {/* <Typography variant='caption' component='div'>MAP</Typography> */}\n    </div>\n  )\n}\n\nFindOnMapButton.propTypes = {\n  onClick: PropTypes.func.isRequired\n}\n\nexport default FindOnMapButton\n","import React, { useContext } from 'react'\nimport PropTypes from 'prop-types'\nimport Paper from '@material-ui/core/Paper'\nimport Typography from '@material-ui/core/Typography'\n// import MenuIcon from '@material-ui/icons/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nimport FindOnMapButton from '../misc/FindOnMapButton'\nimport RawImage from '../PhotoSeries/views/subViews/RawImage'\n// import StarIcon from '@material-ui/icons/Star'\n// import StarBorderIcon from '@material-ui/icons/StarBorder'\nimport { Avatar } from '@material-ui/core'\nimport { AppContext } from '../../contexts'\nimport { formatDate } from '../../lib/datelib'\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    height: '100%',\n    // borderTop: `4px solid ${theme.palette.grey[700]}`\n    padding: theme.spacing(0.5, 1)\n  },\n  imgContainer: {\n    overflow: 'hidden',\n    height: '100%',\n    position: 'relative'\n  },\n  findOnMapButtonContainer: {\n    position: 'absolute',\n    opacity: 0.8,\n    bottom: theme.spacing(1),\n    right: theme.spacing(1)\n  },\n  titleContainer: {\n    background: '#444444AA',\n    textShadow: '1px 1px 10px black',\n    color: 'white',\n    position: 'absolute',\n    alignItems: 'center',\n    display: 'flex',\n    top: 0,\n    width: '100%',\n    paddingRight: theme.spacing(1)\n  },\n  avatar: {\n    border: '1px solid white',\n    margin: theme.spacing(0, 1)\n  },\n  title: {\n    flex: '1 1 50%',\n    overflow: 'hidden'\n  },\n  seriesName: {\n    textOverflow: 'ellipsis',\n    whiteSpace: 'nowrap',\n    overflow: 'hidden'\n  },\n  img: {\n\n  },\n  gravatarImg: {\n    width: '100%'\n  }\n}))\n\nconst EVENT_VERBS = {\n  DELETE: 'Deleted',\n  ADD: 'Added'\n}\n\nconst FeedItem = ({ event, onMapClick, onImageClick, onProfileClick, onSeriesClick }) => {\n  const { series, photo } = event\n  // console.log('EVENT', { series, relation, photo })\n  const classes = useStyles()\n  const { getPhotoUrls } = useContext(AppContext)\n  return (\n    <div className={classes.root}>\n      <Paper className={classes.imgContainer}>\n        <RawImage\n          photo={photo}\n          sizePriority={['medium', 'large', 'thumb']}\n          cover\n          className={classes.img}\n          onClick={() => onImageClick(series.id, photo.id)}\n          getPhotoUrls={getPhotoUrls}\n        />\n        <div className={classes.titleContainer}>\n          <Avatar onClick={() => onProfileClick(photo.createdUser.username)} className={classes.avatar}>\n            <img alt='profile' className={classes.gravatarImg} src={photo.createdUser.gravatar} />\n          </Avatar>\n          <div className={classes.title}>\n            <Typography className={classes.seriesName} variant='body1' color='inherit'>{series.name}</Typography>\n            <Typography variant='body2' color='inherit'>{photo.createdUser.username} {EVENT_VERBS.ADD} a photo</Typography>\n            <Typography variant='caption' color='inherit'>{formatDate(photo.updatedOn)}</Typography>\n          </div>\n          <FindOnMapButton onClick={() => onMapClick(series.id, photo.id)} />\n        </div>\n      </Paper>\n    </div>\n  )\n}\n\nFeedItem.propTypes = {\n  // TODO: THIS IS NOT THE SHAPE WE WANT. NEED TO HASH THIS OUT\n  event: PropTypes.object.isRequired,\n  onSeriesClick: PropTypes.func.isRequired,\n  onImageClick: PropTypes.func.isRequired,\n  onProfileClick: PropTypes.func.isRequired,\n  onMapClick: PropTypes.func.isRequired\n}\n\nexport default FeedItem\n\nexport const FeedItemCosmos = (props) => {\n  return (\n    <div>\n      <FeedItem {...props} />\n      <FeedItem {...props} />\n      <FeedItem {...props} />\n      <FeedItem {...props} />\n      <FeedItem {...props} />\n      <FeedItem {...props} />\n      <FeedItem {...props} />\n      <FeedItem {...props} />\n      <FeedItem {...props} />\n      <FeedItem {...props} />\n      <FeedItem {...props} />\n    </div>\n  )\n}\nFeedItemCosmos.propTypes = {\n  // TODO: THIS IS NOT THE SHAPE WE WANT. NEED TO HASH THIS OUT\n  event: PropTypes.object.isRequired\n}\n","import React, { useRef } from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\n\nimport { List } from 'react-virtualized' // InfiniteLoader\nimport useOnline from '../../lib/useOnline'\nimport FeedEnder from './FeedEnder'\n\nimport ErrorIcon from '@material-ui/icons/Error'\nimport { makeStyles } from '@material-ui/core/styles'\nimport FeedItem from './FeedItem'\n\nimport TopBar from '../TopBar'\n\nimport useComponentSize from '../../lib/useComponentSize'\nimport { CircularProgress } from '@material-ui/core'\n\nconst ROWHEIGHT = 300\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    display: 'flex',\n    flexDirection: 'column',\n    height: '100%'\n  },\n  listContainer: {\n    flexGrow: 1,\n    overflow: 'hidden'\n  },\n  vList: {\n    height: '100%',\n    width: '100%'\n  },\n  feedContainer: {\n    flexGrow: 1,\n    // Promote the list into his own layer on Chrome. This cost memory but helps keeping high FPS.\n    transform: 'translateZ(0)'\n  },\n  grow: {\n    flexGrow: 1\n  }\n}))\n\nconst MyFeed = ({\n  events, loading, onMapClick, onImageClick, onProfileClick,\n  onSeriesClick, fetchNewest, fetchMore, window\n}) => {\n  const classes = useStyles()\n  const listRef = useRef()\n  const { size } = useComponentSize(listRef)\n  const { online } = useOnline()\n\n  const rowRenderer = ({\n    index, // Index of row\n    isScrolling, // The List is currently being scrolled\n    isVisible, // This row is visible within the List (eg it is not an overscanned row)\n    key, // Unique key within array of rendered rows\n    parent, // Reference to the parent List (instance)\n    style // Style object to be applied to row (to position it);\n    // This must be passed through to the rendered row element.\n  }) => {\n    const row = events[index]\n    let content\n    if (index < events.length && row) {\n      content = <FeedItem\n        event={events[index]}\n        onSeriesClick={onSeriesClick}\n        onImageClick={onImageClick}\n        onProfileClick={onProfileClick}\n        onMapClick={onMapClick}\n      />\n    }\n    else if (index === events.length) {\n      // content = <div className={classes.placeholder} style={{ width: row.size }} />\n      const wEnd = window && window[0] === 0\n      content = <FeedEnder icon={<CircularProgress size={30} thickness={2} color='inherit' />} text='Loading...' />\n\n      const almostAtEnd = ROWHEIGHT * 4 + parent.state.scrollTop > style.top\n\n      if (!online) {\n        content = <FeedEnder icon={<ErrorIcon />} text='Cannot Refresh Offline' />\n      }\n      else if (wEnd) {\n        content = <FeedEnder text='End of feed' />\n      }\n      // Only if we're online, not loading and visible\n      else if (!loading && almostAtEnd) {\n        fetchMore()\n      }\n    }\n\n    return (\n      <div className={classes.row} key={key} style={style}>\n        {content}\n      </div>\n    )\n  }\n  rowRenderer.propTypes = {\n    index: PropTypes.any,\n    key: PropTypes.any,\n    style: PropTypes.any,\n    isScrolling: PropTypes.any,\n    isVisible: PropTypes.any,\n    parent: PropTypes.any\n  }\n\n  // console.log('DEBUGLIST', size)\n\n  return (\n    <div className={classes.root}>\n      <TopBar>\n        <Typography className={classes.grow}>Home Feed</Typography>\n      </TopBar>\n      <div className={classes.listContainer} ref={listRef}>\n        <List\n          height={size.height}\n          width={size.width}\n          className={classes.vList}\n          rowCount={events.length + 1}\n          rowHeight={ROWHEIGHT}\n          rowRenderer={rowRenderer}\n        />\n      </div>\n    </div>\n  )\n}\n\nMyFeed.propTypes = {\n  events: PropTypes.array.isRequired,\n  loading: PropTypes.bool,\n  window: PropTypes.arrayOf(PropTypes.number),\n  onSeriesClick: PropTypes.func.isRequired,\n  onImageClick: PropTypes.func.isRequired,\n  onProfileClick: PropTypes.func.isRequired,\n  onMapClick: PropTypes.func.isRequired,\n  fetchNewest: PropTypes.func.isRequired,\n  fetchMore: PropTypes.func.isRequired\n}\n\nexport default MyFeed\n","import React, { useRef, useState, useEffect } from 'react'\nimport PropTypes from 'prop-types'\nimport { graphql } from 'react-apollo'\nimport { home } from '../config'\nimport actions from '../redux/actions'\nimport { connect } from 'react-redux'\nimport { getMyFeed } from '../graphql/queries'\nimport MyFeed from '../components/MyFeed/MyFeed'\n\nconst POLL_INTERVAL = 20 // (seconds)\nconst FEED_LIMIT = 5 // (items to load)\n\nconst FeedConnect = ({\n  data, loading, fetchMore, fetchNewest,\n  loadingNewest,\n  online,\n  loadingMore,\n  jumpToSeries,\n  jumpToMap,\n  jumpToUser\n}) => {\n  const timerRef = useRef()\n  const [lastCheck, setLastCheck] = useState(null)\n  timerRef.current = lastCheck\n\n  // Initiate the polling process. We simply update the timestamp every N seconds\n  useEffect(() => {\n    function ping () {\n      if (!loading && online) fetchNewest()\n      if (timerRef.current) setLastCheck(String(Date.now() - POLL_INTERVAL * 1000))\n    }\n    if (!timerRef.current) timerRef.current = setInterval(ping, POLL_INTERVAL * 1000)\n    return () => {\n      if (timerRef.current) {\n        console.log('clear poll timer')\n        clearInterval(timerRef.current)\n        timerRef.current = null\n      }\n    }\n  }, [])\n\n  const events = data.myFeed ? data.myFeed.feed || [] : []\n  const window = data.myFeed ? data.myFeed.window.map(v => parseInt(v, 10)) || [null, null] : [null, null]\n\n  return (\n    <MyFeed {...{ events, loading, window, fetchMore, fetchNewest, jumpToSeries }}\n      onSeriesClick={() => {}}\n      onImageClick={jumpToSeries}\n      onProfileClick={jumpToUser}\n      onMapClick={jumpToMap}\n    />\n  )\n}\n\nFeedConnect.propTypes = {\n  data: PropTypes.object, // from graphql\n  loading: PropTypes.bool, // from graphql\n  loadingNewest: PropTypes.bool, // from graphql\n  loadingMore: PropTypes.bool, // from graphql\n  fetchMore: PropTypes.func,\n  fetchNewest: PropTypes.func,\n  jumpToSeries: PropTypes.func,\n  jumpToMap: PropTypes.func,\n  jumpToUser: PropTypes.func\n}\n\nconst withFeedQuery = graphql(getMyFeed, {\n  props: ({ data }) => {\n    if (data.error) console.error(data.error)\n\n    // TODO: Not sure this will propagate correctly. Test it.\n    let loadingNewest = false\n    let loadingMore = false\n\n    // console.log('withFeedQuery', data)\n\n    // One Thunk function designed for getting everything since the last check\n    const fetchNewest = () => {\n      loadingNewest = true\n      console.log('fetchNewest', data)\n      if (data.myFeed) {\n        data.fetchMore({\n          variables: { ...data.variables, start: data.myFeed.window[1] },\n          // How do we mush the new query with the old one\n          updateQuery: (prev, { fetchMoreResult }) => {\n            loadingNewest = false\n            return {\n              myFeed: {\n                ...fetchMoreResult.myFeed,\n                // put the newest stuff first\n                feed: [ ...fetchMoreResult.myFeed.feed, ...prev.myFeed.feed ],\n                window: [prev.myFeed.window[0], fetchMoreResult.myFeed.window[1]]\n              }\n            }\n          }\n        })\n      }\n    }\n\n    // A second Thunk function designed to get more elements in the feed history\n    const fetchMore = () => {\n      loadingMore = true\n      console.log('fetchMore', data)\n      if (data.myFeed) {\n        data.fetchMore({\n          variables: { ...data.variables, end: data.myFeed.window[0] },\n          // How do we mush the new query with the old one\n          updateQuery: (prev, { fetchMoreResult }) => {\n            loadingMore = false\n            return {\n              myFeed: {\n                ...fetchMoreResult.myFeed,\n                feed: [ ...prev.myFeed.feed, ...fetchMoreResult.myFeed.feed ],\n                window: [fetchMoreResult.myFeed.window[0], prev.myFeed.window[1]]\n              }\n            }\n          }\n        })\n      }\n    }\n\n    return {\n      data,\n      loadingNewest,\n      loadingMore,\n      fetchNewest, // This is the poll we do every n seconds\n      fetchMore, // This is when we scroll to the bottom of the list\n      loading: data.loading\n    }\n  },\n  // skip: ({ activeSeries, isNewSeries }) => !activeSeries || isNewSeries,\n  options: ({ activeSeries }) => ({\n    variables: {\n      limit: FEED_LIMIT\n    }\n  })\n})\n\n/**\n * Map our redux state and functions\n */\nconst mapStateToProps = (state, props) => {\n  return { }\n}\n\n// We're using graphql() HOC because it's convenient but it doesn't need to render anything\n// const FeedQueryConnect = withFeedQuery(() => null)\nconst mapDispatchToProps = dispatch => ({\n  jumpToSeries: (seriesId, photoId) => {\n    dispatch(actions.setHomeState(home.AppStateTypes.SERIES, { activeSeries: seriesId, initialPhoto: photoId }))\n  },\n  jumpToUser: (username) => {\n    dispatch(actions.setHomeState(home.AppStateTypes.SEARCH, { search: { tab: home.SEARCH_TABS.USER, text: username } }))\n  },\n  jumpToMap: (seriesId, photoId) => {\n    dispatch(actions.pushMapHistory({\n      mode: home.MapModeTypes.FREE\n    }))\n    dispatch(actions.setHomeState(home.AppStateTypes.MAP, { activeSeries: seriesId, initialPhoto: photoId }))\n  }\n})\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(\n  withFeedQuery(FeedConnect)\n)\n","import { makeStyles } from '@material-ui/core/styles'\n\nexport default makeStyles(theme => ({\n  root: {\n    height: '100%',\n    display: 'flex',\n    overflow: 'hidden',\n    flexDirection: 'column'\n  },\n  rectContents: {\n    color: theme.palette.common.white,\n    textShadow: `5px 6px 6px ${theme.palette.common.black}`,\n    position: 'absolute',\n    padding: theme.spacing(2),\n    top: '50%',\n    left: '50%',\n    textAlign: 'center',\n    // transformOrigin: '50% 50%'\n    transform: 'translateY(-50%) translateX(-50%)'\n  },\n  areaLabel: {\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    width: '100%',\n    transform: 'translateY(-110%)'\n  },\n  rectContentsDownloading: {\n    textShadow: 'none',\n    color: theme.palette.primary.contrastText\n  },\n  rectIcon: {\n    position: 'absolute',\n    opacity: 0.4,\n    width: '50%',\n    height: '50%',\n    top: '50%',\n    left: '50%',\n    // transformOrigin: '50% 50%'\n    transform: 'translateY(-50%) translateX(-50%)'\n  },\n  tooBig: {\n    color: theme.palette.error.contrastText\n  },\n  tickText: {\n    // position: 'absolute',\n    // textAlign: 'center',\n    // top: '50%',\n    // left: '50%',\n    // // transformOrigin: '50% 50%'\n    // transform: 'translateY(-50%) translateX(-50%)'\n  },\n  svgRect: {\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    zIndex: -1,\n    height: '100%',\n    width: '100%'\n  },\n  svgCutout: {\n    stroke: 'none',\n    fill: '#00000099'\n  },\n  svgBorder: {\n    fill: 'none',\n    stroke: 'none'\n  },\n  svgBorderNavigating: {\n    stroke: '#44444499'\n  },\n  svgBorderLocked: {\n    fill: '#66666666',\n    stroke: '#44444499'\n  },\n  svgBorderTooBig: {\n    opacity: 0.5,\n    fill: theme.palette.error.main,\n    stroke: theme.palette.error.dark\n  },\n  svgBorderDownloading: {\n    opacity: 0.7,\n    fill: theme.palette.primary.main,\n    stroke: '#44444499'\n  },\n  downloadingProgress: {\n\n  },\n  downloadingProgressCircle: {\n    margin: theme.spacing(2)\n  },\n  snackError: {\n    background: theme.palette.primary.main,\n    color: theme.palette.primary.contrastText\n  },\n  mapWrapper: {\n    flex: '1 1',\n    overflow: 'hidden',\n    position: 'relative'\n  }\n}))\n","import React, { useRef, useState, useCallback } from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport Typography from '@material-ui/core/Typography'\nimport Snackbar from '@material-ui/core/Snackbar'\nimport SnackbarContent from '@material-ui/core/SnackbarContent'\nimport AppBar from '@material-ui/core/AppBar'\nimport CircularProgress from '@material-ui/core/CircularProgress'\nimport IconButton from '@material-ui/core/IconButton'\nimport numeral from 'numeral'\n\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack'\nimport CheckCircleOutlineIcon from '@material-ui/icons/CheckCircleOutline'\nimport ErrorIcon from '@material-ui/icons/Error'\nimport LockIcon from '@material-ui/icons/Lock'\nimport SignalWifiOffIcon from '@material-ui/icons/SignalWifiOff'\nimport Toolbar from '@material-ui/core/Toolbar'\nimport { home } from '../../config'\nimport { debounce } from '../../lib/util'\nimport BaseMap from './BaseMap'\n\n// import MenuIcon from '@material-ui/icons/Menu'\nimport useStyles from './OfflineMap.style'\nimport { Button } from '@material-ui/core'\n\nexport const STATES = {\n  LOCKED: 'Locked',\n  OFFLINE: 'Offline',\n  NAVIGATING: 'Navigating',\n  ERROR: 'Error',\n  DOWNLOADING: 'Downloading',\n  CANCELED: 'Canceled'\n}\n\nconst OfflineMap = ({ onMenuBack, initViewport, progress, toolState,\n  onStartDownload, onCancel, onUnlock, onCancelComplete }) => {\n  const classes = useStyles()\n  const mapWrapperRef = useRef()\n  const [bounds, setBounds] = useState(null)\n  const [viewState, setViewport] = useState(null)\n  const [area, setArea] = useState(null)\n\n  const tooBig = area > home.Offline.maxMapTileArea\n  const classWithState = (name) => {\n    if (!toolState) return classes[name]\n    else return classNames(classes[name], classes[`${name}${toolState}`], tooBig ? classes[`${name}TooBig`] : null)\n  }\n\n  const setGeoState = useCallback(debounce((newViewport, projection, rectSide) => {\n    // console.time('setGeoState')\n    const { longitude, latitude } = newViewport\n    const newArea = projection\n      ? Math.abs((projection.metersPerPixel[0] * rectSide * projection.metersPerPixel[1] * rectSide) / (1000 * 1000))\n      : 0\n\n    const dx = (rectSide / 2) * projection.degreesPerPixel[0]\n    const dy = (rectSide / 2) * projection.degreesPerPixel[1]\n    const newBounds = [\n      longitude - dx,\n      latitude - dy,\n      longitude + dx,\n      latitude + dy\n    ]\n    if (newArea !== area) setArea(newArea)\n    if (newBounds !== bounds) setBounds(newBounds)\n    setViewport(newViewport)\n  }, 500), [])\n\n  let snack = null\n  let onSnackClose = () => {}\n  let snackTimeout = null\n\n  switch (toolState) {\n    case STATES.NAVIGATING:\n      snack = tooBig ? null : <SnackbarContent\n        className={classes.snack}\n        aria-describedby='client-snackbar'\n        message={'Place the square around the area you wish to download for later use'}\n        action={[\n          <Button\n            key='action1'\n            color='inherit'\n            disabled={area > home.Offline.maxMapTileArea}\n            onClick={() => onStartDownload(bounds, viewState)}\n          >\n             Start Download\n          </Button>\n        ]}\n      />\n      break\n    case STATES.DOWNLOADING:\n      snack = <SnackbarContent\n        className={classes.snack}\n        aria-describedby='client-snackbar'\n        message={'Downloading...'}\n        action={[\n          <Button key='action1' color='inherit' onClick={onCancel}>Cancel</Button>\n        ]}\n      />\n      break\n    case STATES.LOCKED:\n      snack = <SnackbarContent\n        className={classes.snack}\n        aria-describedby='client-snackbar'\n        message={'This is the area you downloaded last'}\n        action={[\n          <Button key='action1' color='secondary' onClick={onUnlock}>Download a new Area</Button>\n        ]}\n      />\n      break\n    case STATES.OFFLINE:\n      snack = <SnackbarContent\n        className={classes.snack}\n        aria-describedby='client-snackbar'\n        message={'You cannot download content when you are offline.'}\n      />\n      break\n    case STATES.CANCELED:\n      snack = <SnackbarContent\n        className={classes.snackError}\n        aria-describedby='client-snackbar'\n        message={'Cancelling...'}\n      />\n      onSnackClose = onCancelComplete\n      snackTimeout = 2000\n      break\n    default:\n      break\n  }\n\n  const unlocked = toolState === STATES.NAVIGATING\n\n  return (\n    <div className={classes.root}>\n      <CssBaseline /> {/* You only need this in a root element. Don't put it anywhere else in the dom */}\n      <AppBar position='static' className={classes.appBar}>\n        <Toolbar disableGutters>\n          <IconButton className={classes.menuButton} color='inherit' onClick={onMenuBack} aria-label='Menu'>\n            <ArrowBackIcon />\n          </IconButton>\n          <Typography variant='subtitle1' color='inherit' className={classes.toolbarTitle}>\n            Offline data manager\n          </Typography>\n        </Toolbar>\n      </AppBar>\n      <div className={classes.mapWrapper} ref={mapWrapperRef}>\n        <BaseMap\n          hideNavControls\n          showMe={unlocked}\n          dragPan={unlocked}\n          dragRotate={false}\n          scrollZoom={unlocked}\n          doubleClickZoom={false}\n          touchZoom={unlocked}\n          touchRotate={false}\n          viewport={initViewport}\n        >\n          {(viewport, height, width, projection) => {\n            const rectSide = Math.min(height, width) * 0.6\n            const rectStyle = { height: rectSide, width: rectSide }\n            const boxCorners = {\n              x: (width / 2) - (rectSide / 2),\n              y: (height / 2) - (rectSide / 2)\n            }\n\n            const totalProgress = progress.tileTick && progress.seriesTick && progress.seriesPhotoTick\n              ? [\n                progress.tileTick[0] + progress.seriesTick[0] + progress.seriesPhotoTick[0],\n                progress.tileTick[1] + progress.seriesTick[1] + progress.seriesPhotoTick[1]\n              ] : [0, 1]\n            // divide by zero check\n            if (totalProgress[1] === 0) totalProgress[1] = 1\n            setGeoState(viewport, projection, rectSide)\n\n            return (\n              <div style={{ height, width }}>\n                <div className={classWithState('rectContents')} style={rectStyle}>\n                  {toolState !== STATES.DOWNLOADING && (\n                    <Typography className={classNames(classes.areaLabel, tooBig ? classes.tooBig : null)} color='inherit' variant='h5' component='div'>\n                      {numeral(area).format('0,0')} km²\n                    </Typography>\n                  )}\n                  { toolState === STATES.NAVIGATING && !tooBig && (\n                    <CheckCircleOutlineIcon className={classes.rectIcon} color='inherit' onClick={() => onStartDownload(bounds, viewState)} />\n                  )}\n                  {toolState === STATES.NAVIGATING && tooBig\n                    ? <div>\n                      <Typography color='inherit' variant='body1' component='div'>\n                          > {home.Offline.maxMapTileArea} km²\n                      </Typography>\n                      <ErrorIcon className={classes.rectIcon} color='inherit' />\n                      <Typography color='inherit' variant='body2' component='div'>\n                      Window too big. Try zooming in.\n                      </Typography>\n                    </div>\n                    : null\n                  }\n                  {toolState === STATES.DOWNLOADING && (\n                    <div className={classes.downloadingProgress}>\n                      <Typography className='areaLabel' color='inherit' variant='h5'>\n                      Downloading...\n                      </Typography>\n                      <CircularProgress\n                        className={classes.downloadingProgressCircle}\n                        variant='determinate'\n                        size={rectSide * 0.4}\n                        thickness={rectSide * 0.013}\n                        value={Math.floor(100 * totalProgress[0] / totalProgress[1])}\n                        color='inherit'\n                      />\n                      {progress.tileTick && <Typography color='inherit' variant='body1' component='div'>\n                        Map Tiles: {progress.tileTick[0]} of {progress.tileTick[1]}\n                      </Typography>}\n                      {progress.seriesTick && <Typography color='inherit' variant='body1' component='div'>\n                        Series: {progress.seriesTick[0]} of {progress.seriesTick[1]}\n                      </Typography>}\n                      {progress.seriesPhotoTick && <Typography color='inherit' variant='body1' component='div'>\n                        Series Photos: {progress.seriesPhotoTick[0]} of {progress.seriesPhotoTick[1]}\n                      </Typography>}\n                    </div>\n                  )}\n                  {toolState === STATES.LOCKED && (\n                    <div>\n                      <LockIcon className={classes.rectIcon} color='inherit' />\n                    </div>\n                  )}\n                  {toolState === STATES.OFFLINE && (\n                    <div>\n                      <SignalWifiOffIcon className={classes.rectIcon} color='inherit' />\n                    </div>\n                  )}\n                </div>\n                <svg xmlns='http://www.w3.org/2000/svg' style={{ height, width }}>\n                  <defs>\n                    <path id='Triangle' d='M 16,0 L -8,9 v-18 z' fill='black' stroke='none' />\n                  </defs>\n                  <g fillRule='evenodd' className={classWithState('svgCutout')} >\n                    <path d={`\n                            M 0 0 L ${width} ${0} L ${width} ${height}  L ${0} ${height} Z\n                             M ${boxCorners.x} ${boxCorners.y} \n                             L ${width - boxCorners.x} ${boxCorners.y}\n                             L ${width - boxCorners.x} ${height - boxCorners.y} \n                             L ${boxCorners.x} ${height - boxCorners.y} Z\n                             `} />\n                  </g>\n                  <g fillRule='evenodd' className={classWithState('svgBorder')} >\n                    <path d={`\n                             M ${boxCorners.x} ${boxCorners.y} \n                             L ${width - boxCorners.x} ${boxCorners.y}\n                             L ${width - boxCorners.x} ${height - boxCorners.y} \n                             L ${boxCorners.x} ${height - boxCorners.y} Z\n                             `} />\n                  </g>\n                </svg>\n              </div>\n            )\n          }}\n        </BaseMap>\n        {snack && (\n          <Snackbar\n            anchorOrigin={{ vertical: 'bottom', horizontal: 'center' }}\n            open\n            onClose={onSnackClose}\n            autoHideDuration={snackTimeout}\n          >\n            {snack}\n          </Snackbar>\n        )}\n      </div>\n    </div>\n  )\n}\n\nOfflineMap.propTypes = {\n  toolState: PropTypes.oneOf(Object.values(STATES)),\n  onMenuBack: PropTypes.func.isRequired,\n  initViewport: PropTypes.object,\n  progress: PropTypes.shape({\n    tileTick: PropTypes.array,\n    seriesTick: PropTypes.array,\n    seriesPhotoTick: PropTypes.array\n  }),\n  onStartDownload: PropTypes.func.isRequired,\n  onCancel: PropTypes.func.isRequired,\n  onCancelComplete: PropTypes.func.isRequired,\n  onUnlock: PropTypes.func.isRequired\n}\n\nexport default OfflineMap\n","import React, { useState, useContext, useMemo, useRef, useEffect } from 'react'\nimport PropTypes from 'prop-types'\nimport { connect } from 'react-redux'\nimport actions from '../redux/actions'\nimport Bottleneck from 'bottleneck'\nimport { AppContext } from '../contexts'\nimport { home } from '../config'\nimport { graphql } from 'react-apollo'\nimport { getWholeSeries, geoSeriesIdOnly } from '../graphql/queries'\nimport { long2tile, lat2tile } from 'geotilehash'\nimport OfflineMap, { STATES } from '../components/maps/OfflineMap'\n\nconst OfflineMapConnect = ({\n  onMenuBack,\n  lastMapViewport, completedDownload, viewport, setOfflineCompleted, setOfflineViewport\n}) => {\n  const [toolState, setToolState] = useState(viewport && completedDownload ? STATES.LOCKED : STATES.NAVIGATING)\n  const limiterRef = useRef()\n  const { online } = useContext(AppContext)\n\n  // Setting the bounds is what kicks off the whole process\n  const [bounds, setBounds] = useState(null)\n  // Series ids only get set when the geoQuery finishes\n  const [seriesIds, setSeriesIds] = useState(null)\n  // This is the current Series object we are putting through the query\n  const [activeSeriesId, setActiveSeriesId] = useState(null)\n  const [seriesPhotos, setSeriesPhotos] = useState([])\n\n  const [tileTick, setTileTick] = useState([0, 0])\n  const [seriesTick, setSeriesTick] = useState([0, 0])\n  const [seriesPhotoTick, setSeriesPhotoTick] = useState([0, 0])\n\n  // We're dealing in asynchronous so we need a ref to make sure we're usign the current values\n  const tileTickRef = useRef()\n  tileTickRef.current = { tileTick, seriesTick, seriesPhotoTick, seriesIds, seriesPhotos }\n\n  const onTileTick = () => setTileTick([tileTickRef.current.tileTick[0] + 1, tileTickRef.current.tileTick[1]])\n  const onTileAdd = (num) => setTileTick([tileTickRef.current.tileTick[0], tileTickRef.current.tileTick[1] + num])\n  const onSeriesPhotoTick = () => {\n    setSeriesPhotoTick([tileTickRef.current.seriesPhotoTick[0] + 1, tileTickRef.current.seriesPhotoTick[1]])\n  }\n  const onSeriesPhotoAdd = (num) => setSeriesPhotoTick([tileTickRef.current.seriesPhotoTick[0], tileTickRef.current.seriesPhotoTick[1] + num])\n\n  const onSeriesTick = (urls) => {\n    const theTick = tileTickRef.current.seriesTick\n    const theIds = tileTickRef.current.seriesIds.ids\n    const thePhotos = tileTickRef.current.seriesPhotos\n    if (urls) {\n      let addCount = 0\n      urls.map(url => {\n        if (thePhotos.indexOf(url) === -1) {\n          addCount++\n          setSeriesPhotos([...thePhotos, url])\n          limiterRef.current.schedule(() => makeRequest('GET', url))\n            .then(onSeriesPhotoTick)\n          // Maybe we should do something different on errors (but what?)\n            .catch(onSeriesPhotoTick)\n        }\n      })\n      onSeriesPhotoAdd(addCount)\n    }\n    // now kick off the next series\n    if (theTick && theIds[theTick[0]]) {\n      setActiveSeriesId(theIds[theTick[0] + 1])\n      setSeriesTick([theTick[0] + 1, theTick[1]])\n    }\n    else {\n      // We are done the series\n    }\n  }\n\n  const finalState = useMemo(() => online ? toolState : STATES.OFFLINE, [online, toolState])\n\n  const geoSeriesQuery = useMemo(() => <GeoQuery bounds={bounds} setSeriesIds={setSeriesIds} />, [bounds])\n  const wholeSeriesQuery = useMemo(() => <WholeSeriesConnect id={activeSeriesId} onDone={onSeriesTick} />, [activeSeriesId])\n\n  const onStart = (bounds, viewport) => {\n    setToolState(STATES.DOWNLOADING)\n    setBounds(bounds)\n    setOfflineViewport(viewport)\n  }\n\n  const onDone = () => {\n    setToolState(STATES.LOCKED)\n    setOfflineCompleted(true)\n  }\n\n  const onCancel = () => {\n    setToolState(STATES.CANCELED)\n    setBounds(null)\n    setSeriesIds(null)\n    setTileTick([0, 0])\n    setSeriesTick([0, 0])\n    setSeriesPhotoTick([0, 0])\n    setSeriesPhotos([])\n    limiterRef.current.stop({ dropWaitingJobs: true })\n    limiterRef.current = null\n    limiterRef.current = new Bottleneck({ maxConcurrent: 5 })\n  }\n\n  // Initialize the bottleNeck\n  useEffect(() => {\n    limiterRef.current = new Bottleneck({ maxConcurrent: 5 })\n  }, [])\n\n  // This is a little taxing so we keep it async\n  useEffect(() => {\n    if (bounds) {\n      const tiles = getTiles(bounds, [0, home.Offline.highestOfflineTileZoom])\n      const length = tiles.length\n      if (length === 0) return\n      onTileAdd(length)\n      tiles.forEach(tile => {\n        limiterRef.current.schedule(() => makeRequest('GET', tile))\n          .then(onTileTick)\n          // Maybe we should do something different on errors (but what?)\n          .catch(onTileTick)\n      })\n    }\n  }, [bounds])\n\n  // If we see series then kick off that cascade\n  useEffect(() => {\n    // console.log('OfflineMap:: kicking off the series loading', { seriesTick, seriesIds })\n    if (seriesIds && seriesIds.ids) {\n      // Kick off the series loading\n      if (seriesIds.ids.length > 0) setActiveSeriesId(seriesIds.ids[0])\n      setSeriesTick([0, seriesIds.ids.length])\n      setSeriesPhotoTick([0, 0])\n    }\n  }, [seriesIds])\n\n  useEffect(() => {\n    const newTotal = [tileTick[0] + seriesTick[0] + seriesPhotoTick[0], tileTick[1] + seriesTick[1] + seriesPhotoTick[1]]\n    if (newTotal[1] > 0 && newTotal[0] === newTotal[1]) onDone()\n  }, [tileTick, seriesTick, seriesPhotoTick])\n\n  return (\n    <React.Fragment>\n      {wholeSeriesQuery}\n      {geoSeriesQuery}\n      <OfflineMap\n        onMenuBack={() => {\n          onCancel()\n          onMenuBack()\n        }}\n        onStartDownload={onStart}\n        onCancel={onCancel}\n        initViewport={viewport || lastMapViewport}\n        progress={{ tileTick, seriesTick, seriesPhotoTick }}\n        toolState={finalState}\n\n        onCancelComplete={() => {\n          setToolState(STATES.NAVIGATING)\n        }}\n        onUnlock={() => {\n          setToolState(STATES.NAVIGATING)\n          setOfflineCompleted(false)\n        }}\n      />\n    </React.Fragment>\n  )\n}\nOfflineMapConnect.propTypes = {\n  // All from redux\n  onMenuBack: PropTypes.func.isRequired,\n  lastMapViewport: PropTypes.object,\n  completedDownload: PropTypes.bool,\n  viewport: PropTypes.object,\n  setOfflineCompleted: PropTypes.func.isRequired,\n  setOfflineViewport: PropTypes.func.isRequired\n}\n\nconst withGeoSearch = graphql(geoSeriesIdOnly, {\n  props: ({ data, ownProps }) => {\n    if (data.error) console.error(data.error)\n    console.log('OfflineMap::withGeoSearch:: ', { data, ownProps })\n    try {\n      // Fetch until we have everything\n      if (!data.loading && !data.error && data.seriesInGeoBounds && data.seriesInGeoBounds.seriesSummaries.length > 0 && data.seriesInGeoBounds.nextToken) {\n        ownProps.setSeriesIds({ ids: [], loading: true })\n        // console.log('OfflineMap::withGeoSearch::fetchMore', { ...data.variables, nextToken: data.seriesInGeoBounds.nextToken })\n        data.fetchMore({\n          variables: { ...data.variables, nextToken: data.seriesInGeoBounds.nextToken },\n          // How do we mush the new query with the old one\n          updateQuery: (prev, { fetchMoreResult }) => {\n            // console.log('OfflineMap::withGeoSearch::updateQuery', { prev, fetchMoreResult })\n            return {\n              seriesInGeoBounds: {\n                ...fetchMoreResult.seriesInGeoBounds,\n                seriesSummaries: [ ...prev.seriesInGeoBounds.seriesSummaries, ...fetchMoreResult.seriesInGeoBounds.seriesSummaries ]\n              }\n            }\n          }\n        })\n      }\n      else if (data.loading || data.error) {\n        // console.log('OfflineMap::withGeoSearch::loading or errir')\n        ownProps.setSeriesIds({ ids: [], loading: true })\n      }\n      else {\n        console.log('OfflineMap::withGeoSearch::DONE')\n        if (data && data.seriesInGeoBounds) {\n          ownProps.setSeriesIds({ ids: data.seriesInGeoBounds.seriesSummaries.map(s => s.id), loading: false })\n        }\n      }\n    }\n    catch (e) {\n      console.error(data)\n      console.error(e)\n    }\n    return {\n      data,\n      loading: data.loading\n    }\n  },\n  skip: ({ bounds }) => !bounds,\n  options: ({ bounds }) => ({\n    variables: {\n      bounds,\n      limit: 100\n      // nextToken\n    }\n  })\n})\n\n/**\n * Here's the graphql HOC that gets an individual series\n */\nconst withGetSelectedQuery = graphql(getWholeSeries, {\n  skip: ({ id }) => !id,\n  props: ({ data, ownProps }) => {\n    if (data.error) console.error(data.error)\n    // console.log('OfflineMap::withGetSelectedQuery:: ', { data })\n    let series = null\n    try {\n      if (!data.loading && !data.error) {\n        series = data.series\n        // console.log('OfflineMap::withGetSelectedQuery::series', series)\n        const urls = []\n        urls.push(series.createdUser.gravatar)\n        urls.push(series.updatedUser.gravatar)\n        series.photos.forEach(ph => {\n          urls.push(ph.createdUser.gravatar)\n          urls.push(ph.updatedUser.gravatar)\n          // Skip medium for size sake\n          home.Offline.seriesImgsToCache\n            .map(size => urls.push(`${ph.paths.base}${ph.paths[size]}`))\n        })\n        // Remove duplicates and send it back\n        ownProps.onDone([...new Set(urls)])\n      }\n    }\n    catch (e) {\n      console.log('OfflineMap::withGetSelectedQuery:: error', { data, e })\n      console.error(e)\n    }\n    return {\n      data,\n      loading: data.loading,\n      series\n    }\n  },\n  options: ({ id }) => ({\n    variables: {\n      id\n    }\n  })\n})\n// We're using graphql() HOC because it's convenient but it doesn't need to render anything\nconst WholeSeriesConnect = withGetSelectedQuery(() => null)\nconst GeoQuery = withGeoSearch(() => null)\n\n/**\n * Map our redux state and functions\n */\nconst mapStateToProps = (state, props) => {\n  const lastMapViewport = state.map.slice(-1).pop()\n  const { completedDownload, viewport } = state.offline\n  return { lastMapViewport, completedDownload, viewport }\n}\n\nconst mapDispatchToProps = dispatch => ({\n  onMenuBack: () => {\n    dispatch(actions.homeStateBack())\n  },\n  setOfflineCompleted: (bVal) => {\n    dispatch(actions.setOfflineCompleted(bVal))\n  },\n  setOfflineViewport: (viewport) => {\n    dispatch(actions.setOfflineViewport(viewport))\n  }\n})\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(OfflineMapConnect)\n\n/**\n * Promisify our XMLHttpRequests\n * @param {*} method\n * @param {*} url\n */\nfunction makeRequest (method, url) {\n  return new Promise((resolve, reject) => {\n    var xhr = new XMLHttpRequest()\n    xhr.open(method, url)\n    xhr.onload = () => {\n      if (xhr.status >= 200 && xhr.status < 300) resolve(xhr.response)\n      else reject(new Error(xhr.statusText))\n    }\n    xhr.onerror = () => {\n      reject(new Error(xhr.statusText))\n    }\n    xhr.send()\n  })\n}\n\nexport const getTileURL = (url, zoom, x, y) => {\n  const newUrl = url + `?access_token=${process.env.REACT_APP_MAPBOX_TOKEN}`\n  return newUrl.replace('{z}/{x}/{y}', `${zoom}/${x}/${y}`)\n}\n\n/**\n * Loop over all the tiles and zoom levels and build\n * us an array of URLs\n * @param {*} bounds\n * @param {*} right\n */\nexport function getTiles (bounds, zoomRange) {\n  const tiles = []\n\n  for (let zoom = zoomRange[0]; zoom <= zoomRange[1]; zoom++) {\n    const xtileLeft = long2tile(bounds[0], zoom)\n    const xtileRight = long2tile(bounds[2], zoom)\n\n    const ytileTop = lat2tile(bounds[1], zoom)\n    const ytileBottom = lat2tile(bounds[3], zoom)\n\n    for (let x = xtileLeft; x <= xtileRight; x++) {\n      for (let y = ytileTop; y <= ytileBottom; y++) {\n        // Push both tiles\n        tiles.push(getTileURL(process.env.REACT_APP_TILEURL_SAT, zoom, x, y))\n        tiles.push(getTileURL(process.env.REACT_APP_TILEURL_TOPO, zoom, x, y))\n      }\n    }\n  }\n  return tiles\n  // console.log('Starting Coords', { tiles, top, left, bottom, right })\n}\n","import React, { useState, useEffect, useCallback } from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport AppBar from '@material-ui/core/AppBar'\nimport Toolbar from '@material-ui/core/Toolbar'\nimport Snackbar from '@material-ui/core/Snackbar'\nimport SnackbarContent from '@material-ui/core/SnackbarContent'\nimport IconButton from '@material-ui/core/IconButton'\nimport Typography from '@material-ui/core/Typography'\n\n// import RawImg from './subViews/RawImage'\nimport QRcodeIcon from '../../../icons/QRCode'\nimport jsQR from 'jsqr'\nimport { debounce } from '../../../lib/util'\n// import useFileInput from '../../../lib/useFileInput'\nimport {\n  green, red\n} from '@material-ui/core/colors'\n\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack'\nimport Paper from '@material-ui/core/Paper'\n// import MenuIcon from '@material-ui/icons/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { useCamera } from '../../../lib/useCamera'\n\nconst CAMERAWIDTH = 400\nconst CAMERAHEIGHT = 400\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    display: 'flex',\n    height: '100%',\n    flexDirection: 'column'\n  },\n  qrIcon: {\n    border: '5px solid red',\n    padding: theme.spacing(2),\n    position: 'absolute',\n    color: 'white',\n    opacity: 0.4,\n    zIndex: 2,\n    width: '70%',\n    height: '70%',\n    top: '50%',\n    left: '50%',\n    transformOrigin: '50% 50%',\n    transform: 'translateY(-50%) translateX(-50%)'\n  },\n  backupText: {\n    position: 'absolute',\n    color: 'white',\n    textAlign: 'center',\n    zIndex: 2,\n    width: '70%',\n    height: '70%',\n    top: '50%',\n    left: '50%',\n    transformOrigin: '50% 50%',\n    transform: 'translateY(-50%) translateX(-50%)'\n  },\n  manualImg: {\n    position: 'absolute',\n    zIndex: 1\n  },\n  appBar: {\n\n  },\n  inner: {\n    padding: theme.spacing(2),\n    height: '100%',\n    flexGrow: 1,\n    overflow: 'hidden'\n  },\n  tipPaper: {\n    padding: theme.spacing(2),\n    margin: theme.spacing(2)\n  },\n  docContainer: {\n    flexGrow: 1,\n    padding: theme.spacing(2)\n  },\n  cameraContainer: {\n    width: '80%',\n    margin: '0 auto',\n    position: 'relative',\n    // this is a CSS trick: https://spin.atomicobject.com/2015/07/14/css-responsive-square/\n    '&::before': {\n      content: ' ',\n      display: 'block',\n      paddingTop: '100%'\n    }\n  },\n  cameraContainerError: {\n    background: 'black'\n  },\n  snackErr: {\n    background: red[500],\n    color: 'white'\n  },\n  snackSuccess: {\n    background: green[500],\n    color: 'white'\n  },\n  snackMsg: {\n\n  },\n  video: {\n    height: '100%',\n    width: '100%',\n    verticalAlign: 'top'\n    // display: 'none'\n    // position: 'absolute'\n    // top: 0,\n    // left: 0,\n    // zIndex: 1\n    // '@media (orientation: portrait)': {\n    //   transform: 'rotate(90)'\n    // }\n  }\n}))\n\nconst QRReader = ({ onMenuBack, onCapture, isIos }) => {\n  const classes = useStyles()\n  const [capturedBlob, setCapturedBlob] = useState()\n\n  // This is only used for legacy capture\n  const [err, setErr] = useState(null)\n  const [code, setCode] = useState(null)\n  const { cameraError, captureRawData, cameraOnline } = useCamera(setCapturedBlob, CAMERAWIDTH, CAMERAHEIGHT)\n\n  // limit to 10 frames per second\n  const captureFunc = useCallback(debounce(captureRawData, 100), [cameraOnline, cameraError])\n\n  useEffect(() => {\n    const scan = async () => {\n      let scannedCode = null\n      try {\n        scannedCode = await jsQRFromBlob(capturedBlob)\n      }\n      catch (e) {\n        console.error(e)\n      }\n      try {\n        // If we're capturing images manually then we do this every time\n        if (cameraError && !scannedCode) throw new Error('Captured Image does not have a QR code')\n        if (scannedCode) {\n          console.log('DEBUG', scannedCode)\n          const find = '?fromqr='\n          const foundIdx = scannedCode.data.indexOf(find) + find.length\n          const newData = scannedCode.data.slice(foundIdx)\n          const decodedUrl = JSON.parse(decodeURI(newData))\n          if (!decodedUrl.type || !decodedUrl.id) throw new Error('Type or ID missing from QR Code')\n          setCode(decodedUrl)\n          setErr(null)\n          console.log('QRCODE', scannedCode)\n        }\n      }\n      catch (e) {\n        setErr('Not a valid QR Code')\n        console.error(e)\n      }\n    }\n    if (cameraOnline && !cameraError && !err && !code) {\n      if (!capturedBlob || !capturedBlob.data) captureFunc()\n      else {\n        scan()\n        captureFunc()\n      }\n    }\n  }, [cameraOnline, capturedBlob, err, code])\n\n  // console.log(capturedImg)\n  return (\n    <div className={classes.root}>\n      {/* Render the file picker if there is an error */}\n\n      <CssBaseline /> {/* You only need this in a root element. Don't put it anywhere else in the dom */}\n      <AppBar position='static' className={classes.appBar}>\n        <Toolbar disableGutters>\n          <IconButton className={classes.menuButton} color='inherit' onClick={onMenuBack} aria-label='Menu'>\n            <ArrowBackIcon />\n          </IconButton>\n          <Typography variant='subtitle1' color='inherit' className={classes.toolbarTitle}>\n            Capture QR Code\n          </Typography>\n        </Toolbar>\n      </AppBar>\n      <div className={classes.inner}>\n        <Paper\n          className={classNames(classes.cameraContainer, cameraError ? classes.cameraContainerError : null)}\n        >\n          <QRcodeIcon className={classes.qrIcon} />\n          {/* {cameraError && <Typography className={classes.backupText}>Click to capture</Typography>} */}\n          {/* {cameraError && capturedBlob && (\n            <RawImg\n              dataUrl={capturedBlob}\n              className={classes.manualImg}\n              // style={{ maxHeight: 'inherit', objectFit: 'contain' }}\n            />\n          )} */}\n          <video\n            autoPlay\n            playsInline\n            muted\n            id='webcam'\n            className={classes.video}\n          />\n        </Paper>\n        <Paper className={classes.tipPaper}>\n          <Typography>TIP: You can find the QR code for a series in the SHARE tab of that series</Typography>\n        </Paper>\n      </div>\n      <Snackbar\n        anchorOrigin={{ vertical: 'bottom', horizontal: 'center' }}\n        open={!!err}\n        autoHideDuration={2000}\n        onClose={() => {\n          setErr(null)\n          setCapturedBlob(null)\n        }}\n      >\n        <SnackbarContent\n          className={classes.snackErr}\n          message={<span className={classes.snackMsg}>{err}</span>}\n        />\n      </Snackbar>\n      {!isIos && (\n        <Snackbar\n          anchorOrigin={{ vertical: 'bottom', horizontal: 'center' }}\n          open={cameraError}\n        >\n          <SnackbarContent\n            className={classes.snackErr}\n            message={<span className={classes.snackMsg}>Camera Error. Check your device's permissions</span>}\n          />\n        </Snackbar>\n      )}\n      <Snackbar\n        anchorOrigin={{ vertical: 'bottom', horizontal: 'center' }}\n        open={!!code}\n        autoHideDuration={500}\n        onClose={() => onCapture(code.type, code.id)}\n      >\n        <SnackbarContent\n          className={classes.snackSuccess}\n          message={<span className={classes.snackMsg}>Valid QR Code found!</span>}\n        />\n      </Snackbar>\n\n    </div>\n  )\n}\n\nQRReader.propTypes = {\n  onMenuBack: PropTypes.func.isRequired,\n  isIos: PropTypes.bool,\n  onCapture: PropTypes.func.isRequired\n}\n\nexport default QRReader\n\nconst jsQRFromBlob = ({ data, imageHeight, imageWidth }) => {\n  return new Promise((resolve, reject) => {\n    try {\n      const qrCode = jsQR(data, imageWidth, imageHeight)\n      resolve(qrCode)\n    }\n    catch (e) {\n      reject(e)\n    }\n  })\n}\n","import React, { useRef, useEffect, useState, useContext } from 'react'\nimport Typography from '@material-ui/core/Typography'\n// import MenuIcon from '@material-ui/icons/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nimport moment from 'moment'\nimport { AppContext } from '../../contexts'\n\nconst CHECKINTERVAL = 5000\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    background: 'black',\n    color: 'white',\n    textAlign: 'center'\n  }\n}))\n\nconst OfflineBar = () => {\n  const classes = useStyles()\n  const { online, offlineSince } = useContext(AppContext)\n  const [sinceStr, setSinceStr] = useState()\n  const timerRef = useRef()\n\n  const calcSinceStr = () => {\n    const newText = moment(offlineSince, 'x').fromNow()\n    // console.log('OFFLINE SINCE', since, newText)\n    setSinceStr(newText)\n  }\n  const clearTimer = () => {\n    if (timerRef.current) {\n      clearInterval(timerRef.current)\n      timerRef.current = null\n    }\n  }\n\n  useEffect(() => {\n    if (offlineSince && !timerRef.current) {\n      calcSinceStr()\n      timerRef.current = setInterval(calcSinceStr, CHECKINTERVAL)\n    }\n    else if (!offlineSince)clearTimer()\n    return () => {\n      clearTimer()\n    }\n  }, [offlineSince])\n\n  if (online) return null\n  return (\n    <Typography className={classes.root} variant='caption' component='div'>\n      Offline ({sinceStr})\n    </Typography>\n  )\n}\n\nexport default OfflineBar\n","import React, { useContext } from 'react'\nimport classNames from 'classnames'\nimport PropTypes from 'prop-types'\n\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport AppBar from '@material-ui/core/AppBar'\nimport Paper from '@material-ui/core/Paper'\nimport Typography from '@material-ui/core/Typography'\nimport Toolbar from '@material-ui/core/Toolbar'\nimport Button from '@material-ui/core/Button'\n// import Fab from '@material-ui/core/Fab'\n\nimport HomeIcon from '@material-ui/icons/HomeOutlined'\nimport MapIcon from '@material-ui/icons/MapOutlined'\nimport SearchIcon from '@material-ui/icons/SearchOutlined'\nimport AddIcon from '@material-ui/icons/Add'\nimport PersonOutline from '@material-ui/icons/PersonOutline'\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport AddFab from '../components/PhotoSeries/views/controls/AddFab'\nimport OfflineBar from './misc/OfflineBar'\n\nimport { AppContext } from '../contexts'\n\nimport { home as homeConfig } from '../config'\n\nconst STATES = homeConfig.AppStateTypes\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    borderTop: `2px solid ${theme.palette.secondary.main}`\n  },\n  text: {\n    padding: theme.spacing(2, 2, 0)\n  },\n  paper: {\n    paddingBottom: 50\n  },\n  list: {\n    marginBottom: theme.spacing(2)\n  },\n  subheader: {\n    backgroundColor: theme.palette.background.paper\n  },\n  grow: {\n    flexGrow: 1\n  },\n  addFab: {\n    position: 'absolute',\n    bottom: 0,\n    left: '50%',\n    transformOrigin: '0% 100%',\n    // Promote the list into his own layer on Chrome. This cost memory but helps keeping high FPS.\n    transform: 'translateY(-25%) translateX(-50%) translateZ(0)',\n    zIndex: 200\n  },\n  spacer: {\n    width: 40,\n    flexGrow: 1\n  }\n}))\n\nconst BottomBar = ({ className, domain, signedIn, onHomeClick, onMapClick, onSearchClick, onProfileClick, onCameraClick, onLibraryClick }) => {\n  const classes = useStyles()\n  const { isIos } = useContext(AppContext)\n  return (\n    <AppBar position='static' className={classNames(classes.root, className)}>\n      <Toolbar>\n        {signedIn && (\n          <Button\n            edge='start'\n            className={classes.grow}\n            color={domain === STATES.FEED ? 'secondary' : 'inherit'}\n            onClick={onHomeClick}\n          >\n            <HomeIcon />\n          </Button>\n        )}\n        <Button\n          edge='start'\n          className={classes.grow}\n          color={domain === STATES.MAP ? 'secondary' : 'inherit'}\n          onClick={onMapClick}\n        >\n          <MapIcon />\n        </Button>\n        {signedIn && (\n          <AddFab\n            isIos={isIos}\n            className={classes.addFab}\n            onCameraClick={onCameraClick}\n            onLibraryClick={onLibraryClick}\n          >\n            <AddIcon />\n          </AddFab>\n        )}\n        <div className={classes.spacer} />\n        <Button\n          color={domain === STATES.SEARCH ? 'secondary' : 'inherit'}\n          className={classes.grow}\n          onClick={onSearchClick}\n        >\n          <SearchIcon />\n        </Button>\n        {signedIn && (\n          <Button\n            edge='end'\n            color={domain === STATES.PROFILE ? 'secondary' : 'inherit'}\n            className={classes.grow}\n            onClick={onProfileClick}\n          >\n            <PersonOutline />\n          </Button>\n        )}\n      </Toolbar>\n    </AppBar>\n  )\n}\n\nBottomBar.propTypes = {\n  className: PropTypes.string,\n  domain: PropTypes.string,\n  signedIn: PropTypes.bool,\n  // Here are our button handlers\n  onHomeClick: PropTypes.func.isRequired,\n  onMapClick: PropTypes.func.isRequired,\n  onSearchClick: PropTypes.func.isRequired,\n  onProfileClick: PropTypes.func.isRequired,\n  onCameraClick: PropTypes.func.isRequired,\n  onLibraryClick: PropTypes.func.isRequired\n}\n\nexport default BottomBar\n\nexport const BottomBarCosmosWrapper = (props) => {\n  // const [someStateItem, setSomeStateItem] = useState()\n  const classes = useWrapperStyles()\n  return (\n    <div className={classes.root}>\n      <OfflineBar />\n      <CssBaseline /> {/* You only need this in a root element. Don't put it anywhere else in the dom */}\n      <Paper className={classes.paper}>\n        <Typography variant='h5'>\n          This is a dummy component.\n        </Typography>\n      </Paper>\n      <BottomBar {...props} />\n    </div>\n  )\n}\n\nconst wrapperStyle = theme => ({\n  root: {\n    height: '100%',\n    display: 'flex',\n    flexDirection: 'column'\n  },\n  paper: {\n    flexGrow: 1\n  }\n})\n\nconst useWrapperStyles = makeStyles(wrapperStyle)\n","import React, { useContext, useEffect } from 'react'\nimport PropTypes from 'prop-types'\n\nimport CssBaseline from '@material-ui/core/CssBaseline'\n\nimport UploaderConnect from '../containers/Uploader.connect'\nimport SeriesConnect from '../containers/Series.connect'\nimport MapConnect from '../containers/Map.connect'\nimport SearchConnect from '../containers/Search.connect'\nimport ProfileConnect from '../containers/Profile.connect'\nimport FeedConnect from '../containers/Feed.connect'\nimport OfflineMap from '../containers/OfflineMap.connect'\n\nimport QRReader from './PhotoSeries/views/QRReader'\nimport OfflineBar from './misc/OfflineBar'\nimport BottomBar from './BottomBar'\nimport { AppContext } from '../contexts'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport { home as homeConfig } from '../config'\n\nimport { ThemeProvider } from '@material-ui/styles'\nimport themes from '../themes'\n// import { DesktopWindowsTwoTone } from '@material-ui/icons'\n\nconst STATES = homeConfig.AppStateTypes\n\nconst useStyles = makeStyles(theme => ({\n  outerRoot: {\n    height: '100%',\n    overflow: 'hidden'\n  },\n  root: {\n    height: '100%',\n    overflow: 'hidden',\n    display: 'flex',\n    flexDirection: 'column'\n  },\n  offlineBar: {\n    flex: '0 0'\n  },\n  activeWrapper: {\n    overflow: 'hidden',\n    flexGrow: 1,\n    flexShrink: 1,\n    height: '100%'\n  },\n  uploaderContainer: {\n    zIndex: 100,\n    flex: '0 0'\n  }\n}))\n\n/**\n * This is the over-arching wrapper for the app. It combines all the\n * same place. Time will tell if that's a good strategy.\n */\nconst App = ({ domain, onQRCapture, onMenuBack, setHomeState, onCameraClick, onLibraryClick, children }) => {\n  const classes = useStyles()\n  const { signedIn, user, windowSize, online } = useContext(AppContext)\n\n  useEffect(() => {\n    // Anonymous Users are only allowed home and search\n    if (!signedIn && [STATES.MAP, STATES.SEARCH, STATES.SERIES, STATES.QRCAPTURE].indexOf(domain) < 0) setHomeState(STATES.MAP)\n  }, [domain])\n\n  let showBottomBar = true\n  let activeProps = {}\n  let ActiveComponent = FeedConnect\n  switch (domain) {\n    case STATES.FEED:\n      activeProps = { online }\n      ActiveComponent = FeedConnect\n      break\n    case STATES.MAP:\n      activeProps = { online }\n      ActiveComponent = MapConnect\n      break\n    case STATES.PROFILE:\n      ActiveComponent = ProfileConnect\n      activeProps = { user }\n      break\n    case STATES.SEARCH:\n      ActiveComponent = SearchConnect\n      break\n    case STATES.SERIES:\n      ActiveComponent = SeriesConnect\n      activeProps = { user }\n      showBottomBar = false\n      break\n    case STATES.NEW_SERIES_CAMERA:\n      activeProps = { user }\n      ActiveComponent = SeriesConnect\n      showBottomBar = false\n      break\n    case STATES.OFFLINE_DOWNLOAD:\n      ActiveComponent = OfflineMap\n      showBottomBar = false\n      break\n    case STATES.NEW_SERIES_LIBRARY:\n      activeProps = { user }\n      ActiveComponent = SeriesConnect\n      showBottomBar = false\n      break\n    case STATES.QRCAPTURE:\n      ActiveComponent = QRReader\n      showBottomBar = false\n      activeProps = { onCapture: onQRCapture, onMenuBack }\n      break\n    default:\n      break\n  }\n\n  return (\n    <div className={classes.outerRoot}>\n      <div className={classes.root} style={{ width: windowSize.width, height: windowSize.height }}>\n        <CssBaseline /> {/* You only need this in a root element. Don't put it anywhere else in the dom */}\n        <OfflineBar className={classes.offlineBar} />\n        <div className={classes.activeWrapper}>\n          <ActiveComponent {...activeProps} />\n        </div>\n        { showBottomBar && (\n          <ThemeProvider theme={themes.bottombar}>\n            <BottomBar\n              signedIn={signedIn}\n              domain={domain}\n              onHomeClick={() => setHomeState(STATES.FEED)}\n              onMapClick={() => setHomeState(STATES.MAP)}\n              onSearchClick={() => setHomeState(STATES.SEARCH, { search: null })}\n              onProfileClick={() => setHomeState(STATES.PROFILE)}\n              onCameraClick={onCameraClick}\n              onLibraryClick={onLibraryClick}\n            />\n          </ThemeProvider>\n        )}\n        {/* Uploader is persistent across all views */}\n        <UploaderConnect className={classes.uploaderContainer} />\n        {children}\n      </div>\n    </div>\n  )\n}\n\nApp.propTypes = {\n  // All of this comes in from From Redux\n  domain: PropTypes.string.isRequired,\n  children: PropTypes.any,\n  setHomeState: PropTypes.func.isRequired,\n  onCameraClick: PropTypes.func.isRequired,\n  onLibraryClick: PropTypes.func.isRequired,\n  onQRCapture: PropTypes.func.isRequired,\n  onMenuBack: PropTypes.func.isRequired\n}\n\nexport default App\n","import React, { useEffect } from 'react'\nimport { Query, ApolloProvider, compose } from 'react-apollo'\nimport { IntlWrapper } from '../translations'\nimport { getUser } from '../graphql/queries'\nimport themes from '../themes'\nimport { AppContext } from '../contexts'\nimport Loading from '../components/auth/Loading'\nimport ErrorBoundary from '../lib/ErrorBoundary'\nimport ErrorConnect from './Error.connect'\nimport useGraphQL, { APOLLOSTATES } from '../graphql/useGraphQL'\nimport useAuthentication from '../lib/useAuthentication'\nimport useShowAddToHome from '../lib/useShowAddToHome'\nimport useOnline from '../lib/useOnline'\nimport useResponsive from '../lib/useResponsive'\nimport withReduxProvider from '../redux/withReduxProvider'\nimport { connect } from 'react-redux'\nimport actions from '../redux/actions'\nimport { imgStore } from '../graphql/offline'\nimport { home as homeConfig } from '../config'\n\nimport App from '../components/App'\nimport { ThemeProvider } from '@material-ui/styles'\n\n/**\n * HOC for AppContext and ApolloProvider\n */\nexport const withApolloAuthProvider = Wrapped => ({\n  onQRClick, onAvatarClick, setUseOffline, onOfflineMenuClick, dismissInstall, flags, ...props\n}) => {\n  // console.log('withApolloAuthProvider', props)\n  const { isGod, signedIn, authData, signOut, authScreen, forceSignIn } = useAuthentication(flags.useLoggedOut, setUseOffline)\n\n  const { client: apolloClient, done: apolloDone, currState: apolloState } = useGraphQL()\n\n  // This triggers all the PWA Goodness\n  const { online, offlineSince } = useOnline()\n  const { installPrompt, addToHomeScreen } = useShowAddToHome(flags.install, dismissInstall)\n  const responsive = useResponsive()\n\n  // If the user hasn't decided to be anonymous or sign in yet show them the login screen\n  // console.log('Rendering AppConnect', { flags, responsive, props, signedIn, isGod, authData })\n  useEffect(() => {\n    if (signedIn === true && flags.useLoggedOut) setUseOffline(false)\n    else if (signedIn === false && !flags.useLoggedOut) setUseOffline(true)\n  }, [signedIn])\n\n  if (!apolloDone) return <Loading message={APOLLOSTATES[apolloState]} />\n\n  if (signedIn === null && !flags.useLoggedOut) return authScreen\n\n  // These are the things the rest of the app needs to find:\n  const appContext = {\n    signOut,\n    forceSignIn: () => {\n      setUseOffline(false)\n      forceSignIn()\n    },\n    onOfflineMenuClick,\n    getPhotoUrls: async (photo, sizePriority) => {\n      // console.log('getPhotoUrls::', { photo, size })\n      try {\n        if (photo.uploadToken) {\n          const dbKeys = await imgStore.keys()\n          if (dbKeys.indexOf(photo.uploadToken) > -1) {\n            const data = await imgStore.getItem(photo.uploadToken)\n            // console.log('getPhotoUrls:: Found DB Entry. using dataUrl', data)\n            return [data.dataUrl]\n          }\n        }\n        return sizePriority.map(sp => `${photo.paths.base}${photo.paths[sp]}`)\n      }\n      catch (e) {\n        return null\n      }\n    },\n    onAvatarClick,\n    online,\n    offlineSince,\n    ...responsive,\n    signedIn: Boolean(signedIn),\n    role: !signedIn\n      ? 'nonuser'\n      : isGod\n        ? 'admin'\n        : 'user',\n    currentUser: authData, // TODO: Need this supported by a graphql query\n    onQRClick,\n    addToHomeScreen\n  }\n  console.log('DEBUG', online, offlineSince)\n  return (\n  // We wrap the outside in an error handler\n    <ThemeProvider theme={themes.home}>\n      <ApolloProvider client={apolloClient}>\n        <Query query={getUser} skip={!signedIn}>\n          {({ loading, error, data }) => {\n            if (loading) return <Loading message='UserData' />\n            if (error) {\n              console.error(error)\n            }\n            if (signedIn) appContext.user = data.user\n            return (\n              <AppContext.Provider value={appContext}>\n                <IntlWrapper>\n                  <Wrapped {...props}>\n                    {installPrompt}\n                  </Wrapped>\n                </IntlWrapper>\n              </AppContext.Provider>\n            )\n          }}\n        </Query>\n      </ApolloProvider>\n    </ThemeProvider>\n  )\n}\n\n/**\n * Map our redux state and functions\n */\nconst mapStateToProps = (state, props) => {\n  const { domain } = state.home.current\n  return { domain, flags: state.flags }\n}\n\nconst mapDispatchToProps = dispatch => ({\n  setHomeState: (newDomain, newParams) => {\n    dispatch(actions.setHomeState(newDomain, newParams))\n  },\n  onCameraClick: () => {\n    dispatch(actions.setHomeState(homeConfig.AppStateTypes.NEW_SERIES_CAMERA))\n  },\n  onLibraryClick: () => {\n    dispatch(actions.setHomeState(homeConfig.AppStateTypes.NEW_SERIES_LIBRARY))\n  },\n  onOfflineMenuClick: () => {\n    dispatch(actions.setHomeState(homeConfig.AppStateTypes.OFFLINE_DOWNLOAD))\n  },\n  dismissInstall: () => {\n    dispatch(actions.setFlag('install', false))\n  },\n  setUseOffline: (bVal) => {\n    dispatch(actions.setFlag('useLoggedOut', bVal))\n  },\n  onQRClick: () => {\n    dispatch(actions.setHomeState(homeConfig.AppStateTypes.QRCAPTURE))\n  },\n  onMenuBack: () => {\n    dispatch(actions.homeStateBack())\n  },\n  onAvatarClick: (username) => {\n    dispatch(actions.setHomeState(homeConfig.AppStateTypes.SEARCH, {\n      search: { tab: homeConfig.SEARCH_TABS.USER, text: username }\n    }))\n  },\n  onQRCapture: (type, activeSeries) => {\n    switch (type) {\n      case 'series':\n        dispatch(actions.setHomeState(homeConfig.AppStateTypes.SERIES, { activeSeries }))\n        break\n      default:\n        break\n    }\n  }\n})\n\nconst withErrorBoundary = (Wrapped) => (props) => (\n  <ErrorBoundary fallback={ErrorConnect}>\n    <Wrapped {...props} />\n  </ErrorBoundary>\n)\n\n/**\n * Nearly everything we do depends on who you are as a user so we commit this to state\n */\n\n// The order we compose things here matters a lot\nexport default compose(\n  // ORDER IS CRITICAL HERE\n  withReduxProvider,\n  connect(\n    mapStateToProps,\n    mapDispatchToProps\n  ),\n  withApolloAuthProvider,\n  withErrorBoundary\n)(App)\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n)\n\nexport function register (config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href)\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config)\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\n          )\n        })\n      }\n      else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config)\n      }\n    })\n  }\n}\n\nfunction registerValidSW (swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing\n        if (installingWorker == null) {\n          return\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n              )\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration)\n              }\n            }\n            else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.')\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration)\n              }\n            }\n          }\n        }\n      }\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error)\n    })\n}\n\nfunction checkValidServiceWorker (swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type')\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload()\n          })\n        })\n      }\n      else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config)\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      )\n    })\n}\n\nexport function unregister () {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister()\n    })\n  }\n}\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport AppConnect from './containers/App.connect'\nimport * as serviceWorker from './serviceWorker'\n// Here's our global overrides css\nimport './index.css'\n// This is the font we need\nrequire('typeface-roboto')\n\nconsole.log('Rendering Main App')\nReactDOM.render(<AppConnect />, document.getElementById('root'))\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.register()\n\n// This is our image worker to offline cache maptiles AND series photos\nnavigator.serviceWorker.register('imgCacheWorker.js')\n"],"sourceRoot":""}