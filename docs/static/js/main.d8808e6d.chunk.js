(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{147:function(e,t,a){"use strict";var n=a(63),r=a(9),o=a(51),i="SERIES",l="PHOTO";t.a=function e(t){var a=this;if(Object(o.a)(this,e),this.getTagType=function(e){return a.config.tags.find(function(t){return t.id===e})},this.getTagTypeIndex=function(e){return a.config.tags.findIndex(function(t){return t.id===e})},this.getXYTagTypes=function(){return a.config.tags.filter(function(e){return e.allowXY})},this.getNonXYTagTypes=function(){return a.config.tags.filter(function(e){return e.allowNonXY})},this.getSeriesMeta=function(){return Object.keys(a.config.meta).filter(function(e){return a.config.meta[e].type===i}).reduce(function(e,t){return Object(r.a)({},e,Object(n.a)({},t,a.config.meta[t].default))},{})},this.getPhotoMeta=function(){return Object.keys(a.config.meta).filter(function(e){return a.config.meta[e].type===l}).reduce(function(e,t){return Object(r.a)({},e,Object(n.a)({},t,a.config.meta[t].default))},{})},!t)throw new Error("No seriesConfig object provided to SeriesConfig class");this.config=t}},176:function(e,t,a){"use strict";(function(e){a.d(t,"c",function(){return g}),a.d(t,"b",function(){return h});var n=a(29),r=a.n(n),o=a(50),i=a(51),l=a(49),c=a(147),s=a(143),u=a.n(s),p=a(454),d=a.n(p),m=a(71);t.a=function e(t,a){var n=this;Object(i.a)(this,e),this.setMeta=function(){n.meta=JSON.stringify(n.config.getPhotoMeta())},this.newPhoto=function(){return{id:"__LOCAL_PHOTO::".concat(u()()),uploadToken:u()(),takenOn:Object(l.b)(new Date),meta:JSON.stringify(n.config.getPhotoMeta()),tags:[]}},this.config=new c.a(t),this.photo=a||this.newPhoto()};var g=function(){var e=Object(o.a)(r.a.mark(function e(t,a){var n,o;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.getItem(a);case 3:if(n=e.sent,!(o=window.URL.createObjectURL(n))||0!==o.indexOf("data:image")){e.next=7;break}return e.abrupt("return",o);case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.error(e.t0);case 12:return e.abrupt("return",null);case 13:case"end":return e.stop()}},e,null,[[0,9]])}));return function(t,a){return e.apply(this,arguments)}}(),h=function(t){console.log("onLibraryAdd Buffered");var a=null,n=null,r=null;try{var o=t.indexOf("base64,")+"base64,".length,i=t.slice(o);a=d.a.create(e.from(i,"base64")).parse(),console.log("got EXIF",a)}catch(l){console.error("EXIF ERROR",l)}if(a&&a.tags){try{a.tags&&a.tags.DateTimeOriginal&&String(a.tags.DateTimeOriginal)&&(n=String(a.tags.DateTimeOriginal))}catch(l){console.log("EXIF",a),console.error("ERROR GETTING TIMESTAMP",l)}try{a.tags.GPSLatitude&&Object(m.b)(a.tags.GPSLatitude)&&a.tags.GPSLongitude&&Object(m.b)(a.tags.GPSLongitude)&&(r=[a.tags.GPSLongitude,a.tags.GPSLatitude])}catch(c){console.error("GPS Longitude and Latitude could not be determined")}}return{exif:a,exifDateTime:n,exifGPS:r}}}).call(this,a(36).Buffer)},260:function(e,t){},404:function(e,t,a){},438:function(e,t){},444:function(e){e.exports={version:8,name:"TheProductMapboxGL",glyphs:"mapbox://fonts/raychaser/{fontstack}/{range}.pbf",metadata:{"mapbox:autocomposite":!0,"mapbox:type":"default"},sources:{MapBaseLayer:{url:"mapbox://mapbox.satellite",type:"raster",tileSize:256}},layers:[{id:"background",type:"background",paint:{"background-color":"rgb(0,0,0)"},interactive:!1},{id:"MapBaseLayer",type:"raster",source:"MapBaseLayer","source-layer":"MapBaseLayer",interactive:!1,paint:{"raster-opacity":1}}]}},445:function(e){e.exports={version:8,name:"Outdoors",metadata:{"mapbox:autocomposite":!0,"mapbox:type":"default","mapbox:groups":{1444934828655.3389:{name:"Aeroways",collapsed:!0},1444933322393.2852:{name:"POI labels  (scalerank 1)",collapsed:!0},1444934749452.0452:{name:"Wetlands",collapsed:!0},1444855786460.0557:{name:"Roads",collapsed:!0},1444933575858.6992:{name:"Highway shields",collapsed:!0},1444934295202.7542:{name:"Admin boundaries",collapsed:!0},1444856151690.9143:{name:"State labels",collapsed:!0},1444933721429.3076:{name:"Road labels",collapsed:!0},1444933358918.2366:{name:"POI labels (scalerank 2)",collapsed:!0},1444933808272.805:{name:"Water labels",collapsed:!0},1444855815295.714:{name:"Hillshading",collapsed:!0},1444855831248.8289:{name:"Landcover",collapsed:!0},1444933372896.5967:{name:"POI labels (scalerank 3)",collapsed:!0},1444855799204.86:{name:"Bridges",collapsed:!0},1444856087950.3635:{name:"Marine labels",collapsed:!0},1444862510685.128:{name:"City labels",collapsed:!0},1444855769305.6016:{name:"Tunnels",collapsed:!0},1444856144497.7825:{name:"Country labels",collapsed:!0},1444933456003.5437:{name:"POI labels (scalerank 4)",collapsed:!0},1444933837268.9458:{name:"Contour lines",collapsed:!0}},"mapbox:trackposition":!0},sources:{composite:{url:"mapbox://mapbox.mapbox-terrain-v2,mapbox.mapbox-streets-v7",type:"vector"}},sprite:"mapbox://sprites/pipbailey/cj66v6i8c4hnc2so16ngtlovn",glyphs:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",layers:[{id:"background",type:"background",layout:{},paint:{"background-color":{base:1,stops:[[11,"hsl(35, 32%, 91%)"],[13,"hsl(35, 12%, 89%)"]]}},interactive:!0},{id:"landcover_crop",type:"fill",metadata:{"mapbox:group":"1444855831248.8289"},source:"composite","source-layer":"landcover",maxzoom:12,filter:["==","class","crop"],layout:{},paint:{"fill-color":"hsl(75, 62%, 81%)","fill-opacity":{base:1.5,stops:[[2,.3],[12,0]]},"fill-antialias":!1},interactive:!0},{id:"landcover_grass",type:"fill",metadata:{"mapbox:group":"1444855831248.8289"},source:"composite","source-layer":"landcover",maxzoom:12,filter:["==","class","grass"],layout:{},paint:{"fill-color":"hsl(75, 62%, 81%)","fill-opacity":{base:1.5,stops:[[2,.3],[12,0]]},"fill-antialias":!1},interactive:!0},{id:"landcover_scrub",type:"fill",metadata:{"mapbox:group":"1444855831248.8289"},source:"composite","source-layer":"landcover",maxzoom:12,filter:["==","class","scrub"],layout:{},paint:{"fill-color":"hsl(75, 62%, 81%)","fill-opacity":{base:1.5,stops:[[2,.3],[12,0]]},"fill-antialias":!1},interactive:!0},{id:"landcover_wood",type:"fill",metadata:{"mapbox:group":"1444855831248.8289"},source:"composite","source-layer":"landcover",maxzoom:12,filter:["==","class","wood"],layout:{},paint:{"fill-color":"hsl(75, 62%, 81%)","fill-opacity":{base:1.5,stops:[[2,.3],[12,0]]},"fill-antialias":!1},interactive:!0},{id:"landcover_snow",type:"fill",metadata:{"mapbox:group":"1444855831248.8289"},source:"composite","source-layer":"landcover",filter:["==","class","snow"],layout:{},paint:{"fill-color":"hsl(0, 0%, 100%)","fill-opacity":.2,"fill-antialias":!1},interactive:!0},{id:"national_park",type:"fill",source:"composite","source-layer":"landuse_overlay",filter:["==","class","national_park"],layout:{},paint:{"fill-color":"hsl(100, 59%, 76%)","fill-opacity":{base:1,stops:[[5,0],[5.5,.75],[9,.75],[10,.35]]}},interactive:!0},{id:"scrub",type:"fill",source:"composite","source-layer":"landuse",minzoom:9,filter:["==","class","scrub"],layout:{},paint:{"fill-color":"hsl(75, 41%, 74%)","fill-opacity":{base:1,stops:[[9,0],[15,.2]]}},interactive:!0},{id:"grass",type:"fill",source:"composite","source-layer":"landuse",minzoom:9,filter:["==","class","grass"],layout:{},paint:{"fill-color":"hsl(75, 41%, 74%)","fill-opacity":{base:1,stops:[[9,0],[15,.4]]}},interactive:!0},{id:"wood",type:"fill",source:"composite","source-layer":"landuse",minzoom:6,filter:["==","class","wood"],layout:{},paint:{"fill-color":"hsl(75, 41%, 74%)","fill-opacity":{base:1,stops:[[7,0],[15,.5]]}},interactive:!0},{id:"agriculture",type:"fill",source:"composite","source-layer":"landuse",minzoom:11,filter:["==","class","agriculture"],layout:{},paint:{"fill-opacity":{base:1,stops:[[11,0],[14,.75]]},"fill-color":"hsl(75, 37%, 81%)","fill-outline-color":"hsl(75, 32%, 68%)"},interactive:!0},{id:"national_park-tint-band",type:"line",source:"composite","source-layer":"landuse_overlay",minzoom:9,filter:["==","class","national_park"],layout:{"line-cap":"round"},paint:{"line-color":"hsl(100, 62%, 74%)","line-width":{base:1.4,stops:[[9,1],[14,8]]},"line-offset":{base:1.4,stops:[[9,0],[14,-2.5]]},"line-opacity":{base:1,stops:[[9,0],[10,.75]]},"line-blur":3},interactive:!0},{id:"national_park-outline",type:"line",source:"composite","source-layer":"landuse_overlay",minzoom:9,filter:["==","class","national_park"],layout:{},paint:{"line-color":{base:1,stops:[[12,"hsl(100, 49%, 71%)"],[14,"hsl(100, 40%, 67%)"]]},"line-width":{base:1,stops:[[9,.75],[12,1]]},"line-offset":0,"line-opacity":{base:1,stops:[[9,0],[10,1]]}},interactive:!0},{id:"park",type:"fill",source:"composite","source-layer":"landuse",filter:["all",["!in","type","garden","golf_course","playground","zoo"],["==","class","park"]],layout:{},paint:{"fill-color":"hsl(100, 59%, 76%)","fill-opacity":{base:1,stops:[[5,0],[6,1]]}},interactive:!0},{id:"other-green-areas",type:"fill",source:"composite","source-layer":"landuse",filter:["all",["==","class","park"],["in","type","garden","golf_course","playground","zoo"]],layout:{},paint:{"fill-color":"hsl(100, 59%, 81%)","fill-opacity":{base:1,stops:[[5,0],[6,1]]}},interactive:!0},{id:"glacier",type:"fill",source:"composite","source-layer":"landuse",minzoom:9,filter:["==","class","glacier"],layout:{},paint:{"fill-color":"hsl(196, 71%, 93%)","fill-opacity":{base:1,stops:[[9,0],[10,.5]]}},interactive:!0},{id:"pitch",type:"fill",source:"composite","source-layer":"landuse",filter:["==","class","pitch"],layout:{},paint:{"fill-color":"hsl(100, 57%, 72%)"},interactive:!0},{id:"pitch-line",type:"line",source:"composite","source-layer":"landuse",minzoom:15,filter:["==","class","pitch"],layout:{"line-join":"miter"},paint:{"line-color":"hsl(75, 57%, 84%)"},interactive:!0},{id:"sand",type:"fill",source:"composite","source-layer":"landuse",filter:["==","class","sand"],layout:{},paint:{"fill-color":"hsl(60, 46%, 87%)"},interactive:!0},{id:"contour-line",type:"line",metadata:{"mapbox:group":"1444933837268.9458"},source:"composite","source-layer":"contour",minzoom:11,filter:["!in","index",10,5],layout:{},paint:{"line-opacity":{base:1,stops:[[11,.15],[12,.3]]},"line-color":"hsl(100, 100%, 20%)","line-width":{base:1,stops:[[13,.5],[16,.8]]},"line-offset":{base:1,stops:[[13,1],[16,1.6]]}},interactive:!0},{id:"contour-line-index",type:"line",metadata:{"mapbox:group":"1444933837268.9458"},source:"composite","source-layer":"contour",minzoom:11,filter:["in","index",10,5],layout:{},paint:{"line-opacity":{base:1,stops:[[11,.25],[12,.5]]},"line-color":"hsl(100, 100%, 20%)","line-width":{base:1,stops:[[13,.6],[16,1.2]]},"line-offset":{base:1,stops:[[13,.6],[16,1.2]]}},interactive:!0},{id:"hillshade_highlight_bright",type:"fill",metadata:{"mapbox:group":"1444855815295.714"},source:"composite","source-layer":"hillshade",maxzoom:18,filter:["==","level",94],layout:{},paint:{"fill-color":"hsl(0, 0%, 100%)","fill-opacity":{stops:[[15,.15],[18,0]]},"fill-antialias":!1},interactive:!0},{id:"hillshade_highlight_med",type:"fill",metadata:{"mapbox:group":"1444855815295.714"},source:"composite","source-layer":"hillshade",filter:["==","level",90],layout:{},paint:{"fill-color":"hsl(0, 0%, 100%)","fill-opacity":{stops:[[15,.15],[18,0]]},"fill-antialias":!1},interactive:!0},{id:"hillshade_shadow_faint",type:"fill",metadata:{"mapbox:group":"1444855815295.714"},source:"composite","source-layer":"hillshade",maxzoom:17,filter:["==","level",89],layout:{},paint:{"fill-color":"hsl(56, 59%, 22%)","fill-opacity":{stops:[[15,.07],[17,0]]},"fill-antialias":!1},interactive:!0},{id:"hillshade_shadow_med",type:"fill",metadata:{"mapbox:group":"1444855815295.714"},source:"composite","source-layer":"hillshade",filter:["==","level",78],layout:{},paint:{"fill-color":"hsl(56, 59%, 22%)","fill-opacity":{stops:[[15,.07],[17,0]]},"fill-antialias":!1},interactive:!0},{id:"hillshade_shadow_dark",type:"fill",metadata:{"mapbox:group":"1444855815295.714"},source:"composite","source-layer":"hillshade",filter:["==","level",67],layout:{},paint:{"fill-color":"hsl(56, 59%, 22%)","fill-opacity":{stops:[[15,.08],[17,0]]},"fill-antialias":!1},interactive:!0},{id:"hillshade_shadow_extreme",type:"fill",metadata:{"mapbox:group":"1444855815295.714"},source:"composite","source-layer":"hillshade",maxzoom:17,filter:["==","level",56],layout:{},paint:{"fill-color":"hsl(56, 59%, 22%)","fill-opacity":{stops:[[15,.08],[17,0]]},"fill-antialias":!1},interactive:!0},{id:"waterway-river-canal-shadow",type:"line",source:"composite","source-layer":"waterway",minzoom:8,filter:["in","class","canal","river"],layout:{"line-cap":{base:1,stops:[[0,"butt"],[11,"round"]]},"line-join":"round"},paint:{"line-color":"hsl(215, 84%, 69%)","line-width":{base:1.3,stops:[[8.5,.4],[20,8]]},"line-opacity":{base:1,stops:[[8,0],[8.5,1]]},"line-translate":{base:1.2,stops:[[7,[0,0]],[16,[-1,-1]]]},"line-translate-anchor":"viewport"},interactive:!0},{id:"waterway-river-canal",type:"line",source:"composite","source-layer":"waterway",minzoom:8,filter:["in","class","canal","river"],layout:{"line-cap":{base:1,stops:[[0,"butt"],[11,"round"]]},"line-join":"round"},paint:{"line-color":"hsl(205, 87%, 76%)","line-width":{base:1.3,stops:[[8.5,.4],[20,8]]},"line-opacity":{base:1,stops:[[8,0],[8.5,1]]}},interactive:!0},{id:"waterway-small",type:"line",source:"composite","source-layer":"waterway",minzoom:13,filter:["!in","class","canal","river"],layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"hsl(205, 87%, 76%)","line-width":{base:1.35,stops:[[13.5,.4],[20,3]]},"line-opacity":{base:1,stops:[[13,0],[13.5,1]]}},interactive:!0},{id:"water-shadow",type:"fill",source:"composite","source-layer":"water",layout:{},paint:{"fill-color":"hsl(215, 84%, 69%)","fill-translate":{base:1.2,stops:[[7,[0,0]],[16,[-1,-1]]]},"fill-translate-anchor":"viewport","fill-opacity":1},interactive:!0},{id:"water",type:"fill",source:"composite","source-layer":"water",layout:{},paint:{"fill-color":"hsl(196, 80%, 70%)"},interactive:!0},{id:"wetlands",type:"fill",metadata:{"mapbox:group":"1444934749452.0452"},source:"composite","source-layer":"landuse_overlay",filter:["in","class","wetland","wetland_noveg"],layout:{},paint:{"fill-color":"hsl(185, 43%, 74%)","fill-opacity":{base:1,stops:[[10,.25],[10.5,.15]]}},interactive:!0},{id:"wetlands-pattern",type:"fill",metadata:{"mapbox:group":"1444934749452.0452"},source:"composite","source-layer":"landuse_overlay",filter:["in","class","wetland","wetland_noveg"],layout:{},paint:{"fill-color":"hsl(185, 43%, 74%)","fill-opacity":{base:1,stops:[[10,0],[10.5,1]]},"fill-pattern":"wetland","fill-translate-anchor":"viewport"},interactive:!0},{id:"barrier_line-land-polygon",type:"fill",source:"composite","source-layer":"barrier_line",filter:["all",["==","$type","Polygon"],["==","class","land"]],layout:{},paint:{"fill-color":"hsl(35, 12%, 89%)"},interactive:!0},{id:"barrier_line-land-line",type:"line",source:"composite","source-layer":"barrier_line",filter:["all",["==","$type","LineString"],["==","class","land"]],layout:{"line-cap":"round"},paint:{"line-width":{base:1.99,stops:[[14,.75],[20,40]]},"line-color":"hsl(35, 12%, 89%)"},interactive:!0},{id:"tunnel-street-low",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",minzoom:11,filter:["all",["==","$type","LineString"],["all",["==","class","street"],["==","structure","tunnel"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12.5,.5],[14,2],[18,18]]},"line-color":"hsl(0, 0%, 100%)","line-opacity":{stops:[[11.5,0],[12,1],[14,1],[14.01,0]]}},interactive:!0},{id:"tunnel-street_limited-low",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",minzoom:11,filter:["all",["==","$type","LineString"],["all",["==","class","street_limited"],["==","structure","tunnel"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12.5,.5],[14,2],[18,18]]},"line-color":"hsl(0, 0%, 100%)","line-opacity":{stops:[[11.5,0],[12,1],[14,1],[14.01,0]]}},interactive:!0},{id:"tunnel-track-case",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["==","class","track"],["==","structure","tunnel"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12,.75],[20,2]]},"line-color":"hsl(50, 100%, 40%)","line-gap-width":{base:1.5,stops:[[15,1],[18,12]]},"line-dasharray":[3,3]},interactive:!0},{id:"tunnel-service-link-case",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",minzoom:14,filter:["all",["==","$type","LineString"],["all",["!=","type","trunk_link"],["==","structure","tunnel"],["in","class","link","service"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12,.75],[20,2]]},"line-color":"hsl(230, 19%, 75%)","line-gap-width":{base:1.5,stops:[[14,.5],[18,12]]},"line-dasharray":[3,3]},interactive:!0},{id:"tunnel-street_limited-case",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",minzoom:11,filter:["all",["==","$type","LineString"],["all",["==","class","street_limited"],["==","structure","tunnel"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12,.75],[20,2]]},"line-color":"hsl(230, 19%, 75%)","line-gap-width":{base:1.5,stops:[[13,0],[14,2],[18,18]]},"line-dasharray":[3,3],"line-opacity":{base:1,stops:[[13.99,0],[14,1]]}},interactive:!0},{id:"tunnel-street-case",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",minzoom:11,filter:["all",["==","$type","LineString"],["all",["==","class","street"],["==","structure","tunnel"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12,.75],[20,2]]},"line-color":"hsl(230, 19%, 75%)","line-gap-width":{base:1.5,stops:[[13,0],[14,2],[18,18]]},"line-dasharray":[3,3],"line-opacity":{base:1,stops:[[13.99,0],[14,1]]}},interactive:!0},{id:"tunnel-secondary-tertiary-case",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["==","structure","tunnel"],["in","class","secondary","tertiary"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.2,stops:[[10,.75],[18,2]]},"line-dasharray":[3,3],"line-gap-width":{base:1.5,stops:[[8.5,.5],[10,.75],[18,26]]},"line-color":"hsl(230, 19%, 75%)"},interactive:!0},{id:"tunnel-primary-case",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["==","class","primary"],["==","structure","tunnel"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[5,.75],[16,2]]},"line-dasharray":[3,3],"line-gap-width":{base:1.5,stops:[[5,.75],[18,32]]},"line-color":"hsl(230, 19%, 75%)"},interactive:!0},{id:"tunnel-trunk_link-case",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==","$type","LineString"],["all",["==","structure","tunnel"],["==","type","trunk_link"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12,.75],[20,2]]},"line-color":"hsl(0, 0%, 100%)","line-gap-width":{base:1.5,stops:[[12,.5],[14,2],[18,18]]},"line-dasharray":[3,3]},interactive:!0},{id:"tunnel-motorway_link-case",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==","$type","LineString"],["all",["==","class","motorway_link"],["==","structure","tunnel"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12,.75],[20,2]]},"line-color":"hsl(0, 0%, 100%)","line-gap-width":{base:1.5,stops:[[12,.5],[14,2],[18,18]]},"line-dasharray":[3,3]},interactive:!0},{id:"tunnel-trunk-case",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["==","structure","tunnel"],["==","type","trunk"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[5,.75],[16,2]]},"line-color":"hsl(0, 0%, 100%)","line-gap-width":{base:1.5,stops:[[5,.75],[18,32]]},"line-opacity":1,"line-dasharray":[3,3]},interactive:!0},{id:"tunnel-motorway-case",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["==","class","motorway"],["==","structure","tunnel"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[5,.75],[16,2]]},"line-color":"hsl(0, 0%, 100%)","line-gap-width":{base:1.5,stops:[[5,.75],[18,32]]},"line-opacity":1,"line-dasharray":[3,3]},interactive:!0},{id:"tunnel-construction",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",minzoom:14,filter:["all",["==","$type","LineString"],["all",["==","class","construction"],["==","structure","tunnel"]]],layout:{"line-join":"miter"},paint:{"line-width":{base:1.5,stops:[[12.5,.5],[14,2],[18,18]]},"line-color":"hsl(230, 24%, 87%)","line-opacity":{base:1,stops:[[13.99,0],[14,1]]},"line-dasharray":{base:1,stops:[[14,[.4,.8]],[15,[.3,.6]],[16,[.2,.3]],[17,[.2,.25]],[18,[.15,.15]]]}},interactive:!0},{id:"tunnel-path",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["!in","type","cycleway","piste","steps"],["==","class","path"],["==","structure","tunnel"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[15,1],[18,4]]},"line-dasharray":{base:1,stops:[[14,[4,.4]],[15,[3,.4]],[16,[3,.35]],[17,[3,.35]]]},"line-color":"hsl(35, 26%, 95%)","line-opacity":{base:1,stops:[[13,0],[13.25,1]]}},interactive:!0},{id:"tunnel-cycleway-piste",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["==","class","path"],["==","structure","tunnel"],["in","type","cycleway","piste"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[15,1],[18,4]]},"line-dasharray":{base:1,stops:[[14,[4,.4]],[15,[3,.4]],[16,[3,.35]],[17,[3,.35]]]},"line-color":"hsl(35, 26%, 95%)","line-opacity":{base:1,stops:[[13,0],[13.25,1]]}},interactive:!0},{id:"tunnel-steps",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["==","structure","tunnel"],["==","type","steps"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[15,1],[16,1.6],[18,6]]},"line-color":"hsl(35, 26%, 95%)","line-dasharray":{base:1,stops:[[14,[4,.4]],[15,[1.75,.4]],[16,[.75,.4]],[17,[.3,.3]]]},"line-opacity":{base:1,stops:[[13,0],[13.25,1]]}},interactive:!0},{id:"tunnel-trunk_link",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==","$type","LineString"],["all",["==","structure","tunnel"],["==","type","trunk_link"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12,.5],[14,2],[18,18]]},"line-color":"hsl(46, 77%, 78%)","line-opacity":1,"line-dasharray":[1,0]},interactive:!0},{id:"tunnel-motorway_link",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==","$type","LineString"],["all",["==","class","motorway_link"],["==","structure","tunnel"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12,.5],[14,2],[18,18]]},"line-color":"hsl(26, 74%, 81%)","line-opacity":1,"line-dasharray":[1,0]},interactive:!0},{id:"tunnel-pedestrian",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==","$type","LineString"],["all",["==","class","pedestrian"],["==","structure","tunnel"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[14,.5],[18,12]]},"line-color":"hsl(0, 0%, 100%)","line-opacity":1,"line-dasharray":{base:1,stops:[[14,[1,0]],[15,[1.5,.4]],[16,[1,.2]]]}},interactive:!0},{id:"tunnel-track",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["==","class","track"],["==","structure","tunnel"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[15,1],[18,12]]},"line-color":"hsl(0, 0%, 100%)"},interactive:!0},{id:"tunnel-service-link",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",minzoom:14,filter:["all",["==","$type","LineString"],["all",["!=","type","trunk_link"],["==","structure","tunnel"],["in","class","link","service"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[14,.5],[18,12]]},"line-color":"hsl(0, 0%, 100%)","line-dasharray":[1,0]},interactive:!0},{id:"tunnel-street_limited",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",minzoom:11,filter:["all",["==","$type","LineString"],["all",["==","class","street_limited"],["==","structure","tunnel"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12.5,.5],[14,2],[18,18]]},"line-color":"hsl(35, 14%, 93%)","line-opacity":{base:1,stops:[[13.99,0],[14,1]]}},interactive:!0},{id:"tunnel-street",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",minzoom:11,filter:["all",["==","$type","LineString"],["all",["==","class","street"],["==","structure","tunnel"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12.5,.5],[14,2],[18,18]]},"line-color":"hsl(0, 0%, 100%)","line-opacity":{base:1,stops:[[13.99,0],[14,1]]}},interactive:!0},{id:"tunnel-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["==","structure","tunnel"],["in","class","secondary","tertiary"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[8.5,.5],[10,.75],[18,26]]},"line-color":"hsl(0, 0%, 100%)","line-opacity":1,"line-dasharray":[1,0],"line-blur":0},interactive:!0},{id:"tunnel-primary",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["==","class","primary"],["==","structure","tunnel"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[5,.75],[18,32]]},"line-color":"hsl(0, 0%, 100%)","line-opacity":1,"line-dasharray":[1,0],"line-blur":0},interactive:!0},{id:"tunnel-oneway-arrows-blue-minor",type:"symbol",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",minzoom:16,filter:["all",["==","$type","LineString"],["all",["!=","type","trunk_link"],["==","oneway","true"],["==","structure","tunnel"],["in","class","link","path","pedestrian","service","track"]]],layout:{"symbol-placement":"line","icon-image":{base:1,stops:[[17,"oneway-small"],[18,"oneway-large"]]},"symbol-spacing":200,"icon-padding":2},paint:{},interactive:!0},{id:"tunnel-oneway-arrows-blue-major",type:"symbol",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",minzoom:15,filter:["all",["==","$type","LineString"],["all",["!=","type","trunk_link"],["==","oneway","true"],["==","structure","tunnel"],["in","class","primary","secondary","street","street_limited","tertiary"]]],layout:{"symbol-placement":"line","icon-image":{base:1,stops:[[16,"oneway-small"],[17,"oneway-large"]]},"symbol-spacing":200,"icon-padding":2},paint:{},interactive:!0},{id:"tunnel-trunk",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["==","class","trunk"],["==","structure","tunnel"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[5,.75],[18,32]]},"line-color":"hsl(46, 77%, 78%)"},interactive:!0},{id:"tunnel-motorway",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["==","class","motorway"],["==","structure","tunnel"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[5,.75],[18,32]]},"line-dasharray":[1,0],"line-opacity":1,"line-color":"hsl(26, 74%, 81%)","line-blur":0},interactive:!0},{id:"tunnel-oneway-arrows-white",type:"symbol",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",minzoom:16,filter:["all",["==","$type","LineString"],["all",["!in","type","primary_link","secondary_link","tertiary_link"],["==","oneway","true"],["==","structure","tunnel"],["in","class","link","trunk"]]],layout:{"symbol-placement":"line","icon-image":{base:1,stops:[[16,"oneway-white-small"],[17,"oneway-white-large"]]},"symbol-spacing":200,"icon-padding":2},paint:{"icon-opacity":.5},interactive:!0},{id:"cliffs",type:"line",source:"composite","source-layer":"barrier_line",minzoom:15,filter:["==","class","cliff"],layout:{"line-cap":"round","line-join":"round"},paint:{"line-opacity":{base:1,stops:[[15,0],[15.25,1]]},"line-width":10,"line-pattern":"cliff"},interactive:!0},{id:"ferry",type:"line",source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["==","type","ferry"]],layout:{"line-join":"round"},paint:{"line-color":{base:1,stops:[[15,"hsl(205, 73%, 63%)"],[17,"hsl(230, 73%, 63%)"]]},"line-opacity":1,"line-width":{base:1.5,stops:[[14,.5],[20,1]]},"line-dasharray":{base:1,stops:[[12,[1,0]],[13,[12,4]]]}},interactive:!0},{id:"ferry-auto",type:"line",source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["==","type","ferry_auto"]],layout:{"line-join":"round"},paint:{"line-color":{base:1,stops:[[15,"hsl(205, 73%, 63%)"],[17,"hsl(230, 73%, 63%)"]]},"line-opacity":1,"line-width":{base:1.5,stops:[[14,.5],[20,1]]}},interactive:!0},{id:"road-path-bg",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["!in","structure","bridge","tunnel"],["!in","type","corridor","crossing","piste","sidewalk","steps"],["==","class","path"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[15,2.5],[18,8]]},"line-opacity":{base:1,stops:[[13,0],[13.25,1]]},"line-color":"hsl(50, 100%, 40%)","line-blur":{base:1,stops:[[14,0],[17,1]]}},interactive:!0},{id:"road-piste-bg",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["!in","structure","bridge","tunnel"],["==","class","path"],["==","type","piste"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[15,2],[18,7]]},"line-opacity":{base:1,stops:[[13,0],[13.25,1]]},"line-color":"hsl(230, 85%, 67%)","line-blur":0},interactive:!0},{id:"road-sidewalk-corridor-bg",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:16,filter:["all",["==","$type","LineString"],["all",["!in","structure","bridge","tunnel"],["in","type","corridor","crossing","sidewalk"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[15,2],[18,7]]},"line-dasharray":[1,0],"line-color":"hsl(230, 17%, 82%)","line-blur":0,"line-opacity":{base:1,stops:[[16,0],[16.25,.25]]}},interactive:!0},{id:"road-steps-bg",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["!in","structure","bridge","tunnel"],["==","type","steps"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[15,2.5],[18,8]]},"line-color":"hsl(50, 100%, 40%)","line-blur":{base:1,stops:[[14,0],[17,1]]},"line-opacity":{base:1,stops:[[13,0],[13.25,.25]]}},interactive:!0},{id:"road-pedestrian-case",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:12,filter:["all",["==","$type","LineString"],["all",["==","class","pedestrian"],["==","structure","none"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[14,2],[18,14.5]]},"line-color":"hsl(230, 24%, 87%)","line-gap-width":0,"line-opacity":{base:1,stops:[[13.99,0],[14,1]]}},interactive:!0},{id:"road-street-low",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:11,filter:["all",["==","$type","LineString"],["all",["==","class","street"],["==","structure","none"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12.5,.5],[14,2],[18,18]]},"line-color":"hsl(0, 0%, 100%)","line-opacity":{stops:[[11,0],[11.25,1],[14,1],[14.01,0]]}},interactive:!0},{id:"road-street_limited-low",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:11,filter:["all",["==","$type","LineString"],["all",["==","class","street_limited"],["==","structure","none"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12.5,.5],[14,2],[18,18]]},"line-color":"hsl(0, 0%, 100%)","line-opacity":{stops:[[11,0],[11.25,1],[14,1],[14.01,0]]}},interactive:!0},{id:"road-track-case",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["!in","structure","bridge","tunnel"],["==","class","track"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12,.75],[20,2]]},"line-color":"hsl(50, 100%, 40%)","line-gap-width":{base:1.5,stops:[[15,1],[18,12]]}},interactive:!0},{id:"road-service-link-case",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:14,filter:["all",["==","$type","LineString"],["all",["!=","type","trunk_link"],["!in","structure","bridge","tunnel"],["in","class","link","service"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12,.75],[20,2]]},"line-color":"hsl(230, 24%, 87%)","line-gap-width":{base:1.5,stops:[[14,.5],[18,12]]}},interactive:!0},{id:"road-street_limited-case",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:11,filter:["all",["==","$type","LineString"],["all",["==","class","street_limited"],["==","structure","none"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12,.75],[20,2]]},"line-color":"hsl(230, 24%, 87%)","line-gap-width":{base:1.5,stops:[[13,0],[14,2],[18,18]]},"line-opacity":{base:1,stops:[[13.99,0],[14,1]]}},interactive:!0},{id:"road-street-case",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:11,filter:["all",["==","$type","LineString"],["all",["==","class","street"],["==","structure","none"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12,.75],[20,2]]},"line-color":"hsl(230, 24%, 87%)","line-gap-width":{base:1.5,stops:[[13,0],[14,2],[18,18]]},"line-opacity":{base:1,stops:[[13.99,0],[14,1]]}},interactive:!0},{id:"road-secondary-tertiary-case",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["!in","structure","bridge","tunnel"],["in","class","secondary","tertiary"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.2,stops:[[10,.75],[18,2]]},"line-color":"hsl(230, 24%, 87%)","line-gap-width":{base:1.5,stops:[[8.5,.5],[10,.75],[18,26]]},"line-opacity":{base:1,stops:[[9.99,0],[10,1]]}},interactive:!0},{id:"road-primary-case",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["!in","structure","bridge","tunnel"],["==","class","primary"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[5,.75],[16,2]]},"line-color":"hsl(230, 24%, 87%)","line-gap-width":{base:1.5,stops:[[5,.75],[18,32]]},"line-opacity":{base:1,stops:[[9.99,0],[10,1]]}},interactive:!0},{id:"road-motorway_link-case",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:10,filter:["all",["==","$type","LineString"],["all",["!in","structure","bridge","tunnel"],["==","class","motorway_link"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12,.75],[20,2]]},"line-color":"hsl(0, 0%, 100%)","line-gap-width":{base:1.5,stops:[[12,.5],[14,2],[18,18]]},"line-opacity":{base:1,stops:[[10.99,0],[11,1]]}},interactive:!0},{id:"road-trunk_link-case",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:11,filter:["all",["==","$type","LineString"],["all",["!in","structure","bridge","tunnel"],["==","type","trunk_link"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12,.75],[20,2]]},"line-color":"hsl(0, 0%, 100%)","line-gap-width":{base:1.5,stops:[[12,.5],[14,2],[18,18]]},"line-opacity":{base:1,stops:[[10.99,0],[11,1]]}},interactive:!0},{id:"road-trunk-case",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["!in","structure","bridge","tunnel"],["==","class","trunk"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[10,1],[16,2]]},"line-color":"hsl(0, 0%, 100%)","line-gap-width":{base:1.5,stops:[[5,.75],[18,32]]},"line-opacity":{base:1,stops:[[6,0],[6.1,1]]}},interactive:!0},{id:"road-motorway-case",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["!in","structure","bridge","tunnel"],["==","class","motorway"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[10,1],[16,2]]},"line-color":"hsl(0, 0%, 100%)","line-gap-width":{base:1.5,stops:[[5,.75],[18,32]]}},interactive:!0},{id:"road-construction",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:14,filter:["all",["==","$type","LineString"],["all",["==","class","construction"],["==","structure","none"]]],layout:{"line-join":"miter"},paint:{"line-width":{base:1.5,stops:[[12.5,.5],[14,2],[18,18]]},"line-color":"hsl(230, 24%, 87%)","line-opacity":{base:1,stops:[[13.99,0],[14,1]]},"line-dasharray":{base:1,stops:[[14,[.4,.8]],[15,[.3,.6]],[16,[.2,.3]],[17,[.2,.25]],[18,[.15,.15]]]}},interactive:!0},{id:"road-sidewalk-corridor",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:16,filter:["all",["==","$type","LineString"],["all",["!in","structure","bridge","tunnel"],["in","type","corridor","crossing","sidewalk"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[15,1],[18,4]]},"line-color":"hsl(0, 0%, 100%)","line-dasharray":{base:1,stops:[[14,[4,.4]],[15,[3,.4]],[16,[3,.35]],[17,[3,.35]]]},"line-opacity":{base:1,stops:[[16,0],[16.25,1]]}},interactive:!0},{id:"road-path-smooth",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["!in","structure","bridge","tunnel"],["==","class","path"],["in","type","bridleway","footway","path"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[15,1],[18,4]]},"line-color":"hsl(0, 0%, 100%)","line-dasharray":{base:1,stops:[[14,[4,.4]],[15,[3,.4]],[16,[3,.35]],[17,[3,.35]]]},"line-opacity":{base:1,stops:[[13,0],[13.25,1]]}},interactive:!0},{id:"road-path-rough",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["!in","structure","bridge","tunnel"],["==","class","path"],["in","type","hiking","mountain_bike","trail"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[15,1],[18,4]]},"line-color":"hsl(0, 0%, 100%)","line-dasharray":{base:1,stops:[[14,[4,.4]],[15,[1.75,.4]],[16,[1,.4]],[17,[1,.35]]]},"line-opacity":{base:1,stops:[[13,0],[13.25,1]]}},interactive:!0},{id:"road-cycleway-piste",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["!in","structure","bridge","tunnel"],["==","class","path"],["in","type","cycleway","piste"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[15,1],[18,4]]},"line-color":"hsl(0, 0%, 100%)","line-opacity":{base:1,stops:[[13,0],[13.25,1]]}},interactive:!0},{id:"road-steps",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["!in","structure","bridge","tunnel"],["==","type","steps"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[15,1],[16,1.6],[18,6]]},"line-color":"hsl(0, 0%, 100%)","line-dasharray":{base:1,stops:[[14,[4,.4]],[15,[1.75,.4]],[16,[.75,.4]],[17,[.3,.3]]]},"line-opacity":{base:1,stops:[[13,0],[13.25,1]]}},interactive:!0},{id:"road-trunk_link",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:11,filter:["all",["==","$type","LineString"],["all",["!in","structure","bridge","tunnel"],["==","type","trunk_link"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12,.5],[14,2],[18,18]]},"line-color":"hsl(46, 69%, 68%)","line-opacity":1},interactive:!0},{id:"road-motorway_link",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:10,filter:["all",["==","$type","LineString"],["all",["!in","structure","bridge","tunnel"],["==","class","motorway_link"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12,.5],[14,2],[18,18]]},"line-color":"hsl(26, 67%, 70%)","line-opacity":1},interactive:!0},{id:"road-pedestrian",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:12,filter:["all",["==","$type","LineString"],["all",["==","class","pedestrian"],["==","structure","none"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[14,.5],[18,12]]},"line-color":"hsl(0, 0%, 100%)","line-opacity":1,"line-dasharray":{base:1,stops:[[14,[1,0]],[15,[1.5,.4]],[16,[1,.2]]]}},interactive:!0},{id:"road-pedestrian-polygon-fill",type:"fill",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:12,filter:["all",["==","$type","Polygon"],["all",["==","structure","none"],["in","class","path","pedestrian"]]],layout:{},paint:{"fill-color":{base:1,stops:[[16,"hsl(230, 16%, 94%)"],[16.25,"hsl(230, 50%, 98%)"]]},"fill-outline-color":"hsl(230, 26%, 88%)","fill-opacity":1},interactive:!0},{id:"road-pedestrian-polygon-pattern",type:"fill",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:12,filter:["all",["==","$type","Polygon"],["all",["==","structure","none"],["in","class","path","pedestrian"]]],layout:{},paint:{"fill-color":"hsl(0, 0%, 100%)","fill-outline-color":"hsl(35, 10%, 83%)","fill-pattern":"pedestrian-polygon","fill-opacity":{base:1,stops:[[16,0],[16.25,1]]}},interactive:!0},{id:"road-polygon",type:"fill",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:12,filter:["all",["==","$type","Polygon"],["all",["!in","class","motorway","path","pedestrian","trunk"],["!in","structure","bridge","tunnel"]]],layout:{},paint:{"fill-color":"hsl(0, 0%, 100%)","fill-outline-color":"hsl(0, 0%, 100%)"},interactive:!0},{id:"road-track",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["!in","structure","bridge","tunnel"],["==","class","track"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[15,1],[18,12]]},"line-color":"hsl(0, 0%, 100%)"},interactive:!0},{id:"road-service-link",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:14,filter:["all",["==","$type","LineString"],["all",["!=","type","trunk_link"],["!in","structure","bridge","tunnel"],["in","class","link","service"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[14,.5],[18,12]]},"line-color":"hsl(0, 0%, 100%)"},interactive:!0},{id:"road-street_limited",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:11,filter:["all",["==","$type","LineString"],["all",["==","class","street_limited"],["==","structure","none"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12.5,.5],[14,2],[18,18]]},"line-color":"hsl(35, 14%, 93%)","line-opacity":{base:1,stops:[[13.99,0],[14,1]]}},interactive:!0},{id:"road-street",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:11,filter:["all",["==","$type","LineString"],["all",["==","class","street"],["==","structure","none"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12.5,.5],[14,2],[18,18]]},"line-color":"hsl(0, 0%, 100%)","line-opacity":{base:1,stops:[[13.99,0],[14,1]]}},interactive:!0},{id:"road-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["!in","structure","bridge","tunnel"],["in","class","secondary","tertiary"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[8.5,.5],[10,.75],[18,26]]},"line-color":{base:1,stops:[[5,"hsl(35, 32%, 91%)"],[8,"hsl(0, 0%, 100%)"]]},"line-opacity":{base:1.2,stops:[[5,0],[5.5,1]]}},interactive:!0},{id:"road-primary",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["!in","structure","bridge","tunnel"],["==","class","primary"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[5,.75],[18,32]]},"line-color":{base:1,stops:[[5,"hsl(35, 32%, 91%)"],[8,"hsl(0, 0%, 100%)"]]},"line-opacity":{base:1.2,stops:[[5,0],[5.5,1]]}},interactive:!0},{id:"road-oneway-arrows-blue-minor",type:"symbol",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:16,filter:["all",["==","$type","LineString"],["all",["!=","type","trunk_link"],["!in","structure","bridge","tunnel"],["==","oneway","true"],["in","class","link","path","pedestrian","service","track"]]],layout:{"symbol-placement":"line","icon-image":{base:1,stops:[[17,"oneway-small"],[18,"oneway-large"]]},"icon-rotation-alignment":"map","icon-padding":2,"symbol-spacing":200},paint:{},interactive:!0},{id:"road-oneway-arrows-blue-major",type:"symbol",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:15,filter:["all",["==","$type","LineString"],["all",["!=","type","trunk_link"],["!in","structure","bridge","tunnel"],["==","oneway","true"],["in","class","primary","secondary","street","street_limited","tertiary"]]],layout:{"symbol-placement":"line","icon-image":{base:1,stops:[[16,"oneway-small"],[17,"oneway-large"]]},"icon-rotation-alignment":"map","icon-padding":2,"symbol-spacing":200},paint:{},interactive:!0},{id:"road-trunk",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["!in","structure","bridge","tunnel"],["==","class","trunk"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[5,.75],[18,32]]},"line-color":{base:1,stops:[[6,"hsl(0, 0%, 100%)"],[6.1,"hsl(46, 80%, 60%)"],[9,"hsl(46, 69%, 68%)"]]}},interactive:!0},{id:"road-motorway",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["!in","structure","bridge","tunnel"],["==","class","motorway"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[5,.75],[18,32]]},"line-color":{base:1,stops:[[8,"hsl(26, 87%, 62%)"],[9,"hsl(26, 67%, 70%)"]]}},interactive:!0},{id:"road-rail",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==","$type","LineString"],["all",["!in","structure","bridge","tunnel"],["in","class","major_rail","minor_rail"]]],layout:{"line-join":"round"},paint:{"line-color":{stops:[[13,"hsl(50, 17%, 82%)"],[16,"hsl(230, 10%, 74%)"]]},"line-width":{base:1.5,stops:[[14,.5],[20,1]]}},interactive:!0},{id:"road-rail-tracks",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==","$type","LineString"],["all",["!in","structure","bridge","tunnel"],["in","class","major_rail","minor_rail"]]],layout:{"line-join":"round"},paint:{"line-color":{stops:[[13,"hsl(50, 17%, 82%)"],[16,"hsl(230, 10%, 74%)"]]},"line-width":{base:1.5,stops:[[14,4],[20,8]]},"line-dasharray":[.1,15],"line-opacity":{base:1,stops:[[13.75,0],[14,1]]}},interactive:!0},{id:"level-crossing",type:"symbol",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:16,filter:["all",["==","$type","Point"],["==","class","level_crossing"]],layout:{"icon-allow-overlap":!0,"icon-size":1,"icon-image":"level-crossing"},paint:{"icon-opacity":1},interactive:!0},{id:"road-oneway-arrows-white",type:"symbol",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:16,filter:["all",["==","$type","LineString"],["all",["!in","structure","bridge","tunnel"],["!in","type","primary_link","secondary_link","tertiary_link"],["==","oneway","true"],["in","class","link","trunk"]]],layout:{"symbol-placement":"line","icon-image":{base:1,stops:[[16,"oneway-white-small"],[17,"oneway-white-large"]]},"icon-padding":2,"symbol-spacing":200},paint:{"icon-opacity":.5},interactive:!0},{id:"hedges",type:"line",source:"composite","source-layer":"barrier_line",minzoom:16,filter:["==","class","hedge"],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"hsl(100, 59%, 70%)","line-width":{base:1,stops:[[16,1],[20,3]]},"line-opacity":1,"line-dasharray":[1,2,5,2,1,2]},interactive:!0},{id:"fences",type:"line",source:"composite","source-layer":"barrier_line",minzoom:16,filter:["==","class","fence"],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"hsl(46, 17%, 76%)","line-width":{base:1,stops:[[16,1],[20,3]]},"line-opacity":1,"line-dasharray":[1,2,5,2,1,2]},interactive:!0},{id:"gates",type:"line",source:"composite","source-layer":"barrier_line",minzoom:17,filter:["==","class","gate"],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"hsl(46, 17%, 76%)","line-width":{base:1,stops:[[16,1],[20,3]]},"line-opacity":.5,"line-dasharray":[1,2,5,2,1,2]},interactive:!0},{id:"bridge-path-bg",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["!in","type","piste","steps"],["==","class","path"],["==","structure","bridge"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[15,2.5],[18,8]]},"line-opacity":{base:1,stops:[[13,0],[13.25,1]]},"line-color":"hsl(50, 100%, 40%)","line-blur":{base:1,stops:[[14,0],[17,1]]}},interactive:!0},{id:"bridge-piste-bg",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["==","class","path"],["==","structure","bridge"],["==","type","piste"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[15,2],[18,7]]},"line-dasharray":[1,0],"line-color":"hsl(205, 63%, 60%)","line-blur":0,"line-opacity":{base:1,stops:[[13,0],[13.25,1]]}},interactive:!0},{id:"bridge-steps-bg",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["==","structure","bridge"],["==","type","steps"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[15,2.5],[18,8]]},"line-color":"hsl(50, 100%, 40%)","line-opacity":{base:1,stops:[[13,0],[13.25,1]]},"line-blur":{base:1,stops:[[14,0],[17,1]]}},interactive:!0},{id:"bridge-pedestrian-case",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==","$type","LineString"],["all",["==","class","pedestrian"],["==","structure","bridge"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[14,2],[18,14.5]]},"line-color":"hsl(230, 24%, 87%)","line-gap-width":0,"line-opacity":{base:1,stops:[[13.99,0],[14,1]]}},interactive:!0},{id:"bridge-street-low",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:11,filter:["all",["==","$type","LineString"],["all",["==","class","street"],["==","structure","bridge"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12.5,.5],[14,2],[18,18]]},"line-color":"hsl(0, 0%, 100%)","line-opacity":{stops:[[11.5,0],[12,1],[14,1],[14.01,0]]}},interactive:!0},{id:"bridge-street_limited-low",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:11,filter:["all",["==","$type","LineString"],["all",["==","class","street_limited"],["==","structure","bridge"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12.5,.5],[14,2],[18,18]]},"line-color":"hsl(0, 0%, 100%)","line-opacity":{stops:[[11.5,0],[12,1],[14,1],[14.01,0]]}},interactive:!0},{id:"bridge-track-case",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["==","class","track"],["==","structure","bridge"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12,.75],[20,2]]},"line-color":"hsl(50, 100%, 40%)","line-gap-width":{base:1.5,stops:[[15,1],[18,12]]}},interactive:!0},{id:"bridge-service-link-case",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:14,filter:["all",["==","$type","LineString"],["all",["!=","type","trunk_link"],["==","structure","bridge"],["in","class","link","service"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12,.75],[20,2]]},"line-color":"hsl(230, 24%, 87%)","line-gap-width":{base:1.5,stops:[[14,.5],[18,12]]}},interactive:!0},{id:"bridge-street_limited-case",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:11,filter:["all",["==","$type","LineString"],["all",["==","class","street_limited"],["==","structure","bridge"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12,.75],[20,2]]},"line-color":"hsl(230, 24%, 87%)","line-gap-width":{base:1.5,stops:[[13,0],[14,2],[18,18]]}},interactive:!0},{id:"bridge-street-case",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:11,filter:["all",["==","$type","LineString"],["all",["==","class","street"],["==","structure","bridge"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12,.75],[20,2]]},"line-color":"hsl(230, 24%, 87%)","line-opacity":{base:1,stops:[[13.99,0],[14,1]]},"line-gap-width":{base:1.5,stops:[[13,0],[14,2],[18,18]]}},interactive:!0},{id:"bridge-secondary-tertiary-case",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["==","structure","bridge"],["in","class","secondary","tertiary"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.2,stops:[[10,.75],[18,2]]},"line-color":"hsl(230, 24%, 87%)","line-gap-width":{base:1.5,stops:[[8.5,.5],[10,.75],[18,26]]},"line-translate":[0,0]},interactive:!0},{id:"bridge-primary-case",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["==","class","primary"],["==","structure","bridge"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[5,.75],[16,2]]},"line-color":"hsl(230, 24%, 87%)","line-gap-width":{base:1.5,stops:[[5,.75],[18,32]]},"line-translate":[0,0]},interactive:!0},{id:"bridge-trunk_link-case",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==","$type","LineString"],["all",["!in","layer",2,3,4,5],["==","structure","bridge"],["==","type","trunk_link"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12,.75],[20,2]]},"line-color":"hsl(0, 0%, 100%)","line-gap-width":{base:1.5,stops:[[12,.5],[14,2],[18,18]]},"line-opacity":{base:1,stops:[[10.99,0],[11,1]]}},interactive:!0},{id:"bridge-motorway_link-case",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==","$type","LineString"],["all",["!in","layer",2,3,4,5],["==","class","motorway_link"],["==","structure","bridge"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12,.75],[20,2]]},"line-color":"hsl(0, 0%, 100%)","line-gap-width":{base:1.5,stops:[[12,.5],[14,2],[18,18]]},"line-opacity":1},interactive:!0},{id:"bridge-trunk-case",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["!in","layer",2,3,4,5],["==","class","trunk"],["==","structure","bridge"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[5,.75],[16,2]]},"line-color":"hsl(0, 0%, 100%)","line-gap-width":{base:1.5,stops:[[5,.75],[18,32]]}},interactive:!0},{id:"bridge-motorway-case",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["!in","layer",2,3,4,5],["==","class","motorway"],["==","structure","bridge"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[5,.75],[16,2]]},"line-color":"hsl(0, 0%, 100%)","line-gap-width":{base:1.5,stops:[[5,.75],[18,32]]}},interactive:!0},{id:"bridge-construction",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:14,filter:["all",["==","$type","LineString"],["all",["==","class","construction"],["==","structure","bridge"]]],layout:{"line-join":"miter"},paint:{"line-width":{base:1.5,stops:[[12.5,.5],[14,2],[18,18]]},"line-color":"hsl(230, 24%, 87%)","line-opacity":{base:1,stops:[[13.99,0],[14,1]]},"line-dasharray":{base:1,stops:[[14,[.4,.8]],[15,[.3,.6]],[16,[.2,.3]],[17,[.2,.25]],[18,[.15,.15]]]}},interactive:!0},{id:"bridge-path",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["!in","type","cycleway","piste","steps"],["==","class","path"],["==","structure","bridge"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[15,1],[18,4]]},"line-color":"hsl(0, 0%, 100%)","line-dasharray":{base:1,stops:[[14,[4,.4]],[15,[3,.4]],[16,[3,.35]],[17,[3,.35]]]},"line-opacity":{base:1,stops:[[13,0],[13.25,1]]}},interactive:!0},{id:"bridge-cycleway-piste",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["==","class","path"],["==","structure","bridge"],["in","type","cycleway","piste"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[15,1],[18,4]]},"line-color":"hsl(0, 0%, 100%)","line-opacity":{base:1,stops:[[13,0],[13.25,1]]}},interactive:!0},{id:"bridge-steps",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["==","structure","bridge"],["==","type","steps"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[15,1],[16,1.6],[18,6]]},"line-color":"hsl(0, 0%, 100%)","line-dasharray":{base:1,stops:[[14,[4,.4]],[15,[1.75,.4]],[16,[.75,.4]],[17,[.3,.3]]]},"line-opacity":{base:1,stops:[[13,0],[13.25,1]]}},interactive:!0},{id:"bridge-trunk_link",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==","$type","LineString"],["all",["!in","layer",2,3,4,5],["==","structure","bridge"],["==","type","trunk_link"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12,.5],[14,2],[18,18]]},"line-color":"hsl(46, 69%, 68%)"},interactive:!0},{id:"bridge-motorway_link",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==","$type","LineString"],["all",["!in","layer",2,3,4,5],["==","class","motorway_link"],["==","structure","bridge"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12,.5],[14,2],[18,18]]},"line-color":"hsl(26, 67%, 70%)"},interactive:!0},{id:"bridge-pedestrian",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==","$type","LineString"],["all",["==","class","pedestrian"],["==","structure","bridge"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[14,.5],[18,12]]},"line-color":"hsl(0, 0%, 100%)","line-opacity":1,"line-dasharray":{base:1,stops:[[14,[1,0]],[15,[1.5,.4]],[16,[1,.2]]]}},interactive:!0},{id:"bridge-track",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["==","class","track"],["==","structure","bridge"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[15,1],[18,12]]},"line-color":"hsl(0, 0%, 100%)"},interactive:!0},{id:"bridge-service-link",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:14,filter:["all",["==","$type","LineString"],["all",["!=","type","trunk_link"],["==","structure","bridge"],["in","class","link","service","track"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[14,.5],[18,12]]},"line-color":"hsl(0, 0%, 100%)"},interactive:!0},{id:"bridge-street_limited",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:11,filter:["all",["==","$type","LineString"],["all",["==","class","street_limited"],["==","structure","bridge"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12.5,.5],[14,2],[18,18]]},"line-color":"hsl(35, 14%, 93%)","line-opacity":{base:1,stops:[[13.99,0],[14,1]]}},interactive:!0},{id:"bridge-street",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:11,filter:["all",["==","$type","LineString"],["all",["==","class","street"],["==","structure","bridge"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12.5,.5],[14,2],[18,18]]},"line-color":"hsl(0, 0%, 100%)","line-opacity":{base:1,stops:[[13.99,0],[14,1]]}},interactive:!0},{id:"bridge-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["==","structure","bridge"],["in","type","secondary","tertiary"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[8.5,.5],[10,.75],[18,26]]},"line-color":"hsl(0, 0%, 100%)","line-opacity":{base:1.2,stops:[[5,0],[5.5,1]]}},interactive:!0},{id:"bridge-primary",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["==","structure","bridge"],["==","type","primary"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[5,.75],[18,32]]},"line-color":"hsl(0, 0%, 100%)","line-opacity":{base:1.2,stops:[[5,0],[5.5,1]]}},interactive:!0},{id:"bridge-oneway-arrows-blue-minor",type:"symbol",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:16,filter:["all",["==","$type","LineString"],["all",["==","oneway","true"],["==","structure","bridge"],["in","class","link","path","pedestrian","service","track"]]],layout:{"symbol-placement":"line","icon-image":{base:1,stops:[[17,"oneway-small"],[18,"oneway-large"]]},"symbol-spacing":200,"icon-rotation-alignment":"map","icon-padding":2},paint:{},interactive:!0},{id:"bridge-oneway-arrows-blue-major",type:"symbol",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:15,filter:["all",["==","$type","LineString"],["all",["==","oneway","true"],["==","structure","bridge"],["in","class","primary","secondary","street","street_limited","tertiary"]]],layout:{"symbol-placement":"line","icon-image":{base:1,stops:[[16,"oneway-small"],[17,"oneway-large"]]},"symbol-spacing":200,"icon-rotation-alignment":"map","icon-padding":2},paint:{},interactive:!0},{id:"bridge-trunk",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["!in","layer",2,3,4,5],["==","class","trunk"],["==","structure","bridge"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[5,.75],[18,32]]},"line-color":"hsl(46, 69%, 68%)"},interactive:!0},{id:"bridge-motorway",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["!in","layer",2,3,4,5],["==","class","motorway"],["==","structure","bridge"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[5,.75],[18,32]]},"line-color":"hsl(26, 67%, 70%)"},interactive:!0},{id:"bridge-rail",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==","$type","LineString"],["all",["==","structure","bridge"],["in","class","major_rail","minor_rail"]]],layout:{"line-join":"round"},paint:{"line-color":{stops:[[13,"hsl(50, 17%, 82%)"],[16,"hsl(230, 10%, 74%)"]]},"line-width":{base:1.5,stops:[[14,.5],[20,1]]}},interactive:!0},{id:"bridge-rail-tracks",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==","$type","LineString"],["all",["==","structure","bridge"],["in","class","major_rail","minor_rail"]]],layout:{"line-join":"round"},paint:{"line-color":{stops:[[13,"hsl(50, 17%, 82%)"],[16,"hsl(230, 10%, 74%)"]]},"line-width":{base:1.5,stops:[[14,4],[20,8]]},"line-dasharray":[.1,15],"line-opacity":{base:1,stops:[[13.75,0],[20,1]]}},interactive:!0},{id:"bridge-trunk_link-2-case",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==","$type","LineString"],["all",["==","structure","bridge"],["==","type","trunk_link"],[">=","layer",2]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12,.75],[20,2]]},"line-color":"hsl(0, 0%, 100%)","line-gap-width":{base:1.5,stops:[[12,.5],[14,2],[18,18]]},"line-opacity":{base:1,stops:[[10.99,0],[11,1]]}},interactive:!0},{id:"bridge-motorway_link-2-case",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==","$type","LineString"],["all",["==","class","motorway_link"],["==","structure","bridge"],[">=","layer",2]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12,.75],[20,2]]},"line-color":"hsl(0, 0%, 100%)","line-gap-width":{base:1.5,stops:[[12,.5],[14,2],[18,18]]},"line-opacity":1},interactive:!0},{id:"bridge-trunk-2-case",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["==","class","trunk"],["==","structure","bridge"],[">=","layer",2]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[10,1],[16,2]]},"line-color":"hsl(0, 0%, 100%)","line-gap-width":{base:1.5,stops:[[5,.75],[18,32]]}},interactive:!0},{id:"bridge-motorway-2-case",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["==","class","motorway"],["==","structure","bridge"],[">=","layer",2]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[10,1],[16,2]]},"line-color":"hsl(0, 0%, 100%)","line-gap-width":{base:1.5,stops:[[5,.75],[18,32]]}},interactive:!0},{id:"bridge-trunk_link-2",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==","$type","LineString"],["all",["==","structure","bridge"],["==","type","trunk_link"],[">=","layer",2]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12,.5],[14,2],[18,18]]},"line-color":"hsl(46, 69%, 68%)"},interactive:!0},{id:"bridge-motorway_link-2",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==","$type","LineString"],["all",["==","class","motorway_link"],["==","structure","bridge"],[">=","layer",2]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12,.5],[14,2],[18,18]]},"line-color":"hsl(26, 67%, 70%)"},interactive:!0},{id:"bridge-trunk-2",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["==","class","trunk"],["==","structure","bridge"],[">=","layer",2]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[5,.75],[18,32]]},"line-color":"hsl(46, 69%, 68%)"},interactive:!0},{id:"bridge-motorway-2",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["==","class","motorway"],["==","structure","bridge"],[">=","layer",2]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[5,.75],[18,32]]},"line-color":"hsl(26, 67%, 70%)"},interactive:!0},{id:"bridge-oneway-arrows-white",type:"symbol",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:16,filter:["all",["==","$type","LineString"],["all",["!in","type","primary_link","secondary_link","tertiary_link"],["==","oneway","true"],["==","structure","bridge"],["in","class","link","trunk"]]],layout:{"symbol-placement":"line","icon-image":{base:1,stops:[[16,"oneway-white-small"],[17,"oneway-white-large"]]},"symbol-spacing":200,"icon-padding":2},paint:{"icon-opacity":.5},interactive:!0},{id:"aerialway-bg",type:"line",source:"composite","source-layer":"road",minzoom:13,filter:["all",["==","$type","LineString"],["==","class","aerialway"]],layout:{"line-join":"round"},paint:{"line-color":"hsl(0, 0%, 100%)","line-width":{base:1.5,stops:[[14,2.5],[20,3]]},"line-blur":.5},interactive:!0},{id:"aerialway",type:"line",source:"composite","source-layer":"road",minzoom:13,filter:["all",["==","$type","LineString"],["==","class","aerialway"]],layout:{"line-join":"round"},paint:{"line-color":"hsl(230, 4%, 29%)","line-width":{base:1.5,stops:[[14,.5],[20,1]]}},interactive:!0},{id:"admin-3-4-boundaries-bg",type:"line",metadata:{"mapbox:group":"1444934295202.7542"},source:"composite","source-layer":"admin",filter:["all",["==","maritime",0],[">=","admin_level",3]],layout:{"line-join":"bevel"},paint:{"line-color":{base:1,stops:[[8,"hsl(35, 12%, 89%)"],[16,"hsl(230, 49%, 90%)"]]},"line-width":{base:1,stops:[[7,3.75],[12,5.5]]},"line-opacity":{base:1,stops:[[7,0],[8,.75]]},"line-dasharray":[1,0],"line-translate":[0,0],"line-blur":{base:1,stops:[[3,0],[8,3]]}},interactive:!0},{id:"admin-2-boundaries-bg",type:"line",metadata:{"mapbox:group":"1444934295202.7542"},source:"composite","source-layer":"admin",minzoom:1,filter:["all",["==","admin_level",2],["==","maritime",0]],layout:{"line-join":"miter"},paint:{"line-width":{base:1,stops:[[3,3.5],[10,8]]},"line-color":{base:1,stops:[[6,"hsl(35, 12%, 89%)"],[8,"hsl(230, 49%, 90%)"]]},"line-opacity":{base:1,stops:[[3,0],[4,.5]]},"line-translate":[0,0],"line-blur":{base:1,stops:[[3,0],[10,2]]}},interactive:!0},{id:"admin-3-4-boundaries",type:"line",metadata:{"mapbox:group":"1444934295202.7542"},source:"composite","source-layer":"admin",filter:["all",["==","maritime",0],[">=","admin_level",3]],layout:{"line-join":"round","line-cap":"round"},paint:{"line-dasharray":{base:1,stops:[[6,[2,0]],[7,[2,2,6,2]]]},"line-width":{base:1,stops:[[7,.75],[12,1.5]]},"line-opacity":{base:1,stops:[[2,0],[3,1]]},"line-color":{base:1,stops:[[3,"hsl(230, 14%, 77%)"],[7,"hsl(230, 8%, 62%)"]]}},interactive:!0},{id:"admin-2-boundaries",type:"line",metadata:{"mapbox:group":"1444934295202.7542"},source:"composite","source-layer":"admin",minzoom:1,filter:["all",["==","admin_level",2],["==","disputed",0],["==","maritime",0]],layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"hsl(230, 8%, 51%)","line-width":{base:1,stops:[[3,.5],[10,2]]}},interactive:!0},{id:"admin-2-boundaries-dispute",type:"line",metadata:{"mapbox:group":"1444934295202.7542"},source:"composite","source-layer":"admin",minzoom:1,filter:["all",["==","admin_level",2],["==","disputed",1],["==","maritime",0]],layout:{"line-join":"round"},paint:{"line-dasharray":[1.5,1.5],"line-color":"hsl(230, 8%, 51%)","line-width":{base:1,stops:[[3,.5],[10,2]]}},interactive:!0},{id:"contour-label",type:"symbol",source:"composite","source-layer":"contour",minzoom:11,filter:["in","index",10,5],layout:{"text-field":"{ele} m","symbol-placement":"line","text-max-angle":25,"text-padding":5,"text-font":["DIN Offc Pro Medium","Arial Unicode MS Regular"],"text-size":{base:1,stops:[[15,9.5],[20,12]]}},paint:{"text-color":"hsl(100, 60%, 28%)","text-halo-width":1,"text-halo-blur":0,"text-halo-color":"hsla(0, 0%, 100%, 0.5)"},interactive:!0},{id:"waterway-label",type:"symbol",source:"composite","source-layer":"waterway_label",minzoom:12,filter:["in","class","canal","river"],layout:{"text-field":"{name_en}","text-font":["DIN Offc Pro Italic","Arial Unicode MS Regular"],"symbol-placement":"line","text-max-angle":30,"text-size":{base:1,stops:[[13,12],[18,16]]}},paint:{"text-halo-width":.5,"text-halo-color":"hsl(196, 80%, 70%)","text-color":"hsl(230, 48%, 44%)","text-halo-blur":.5},interactive:!0},{id:"poi-parks_scalerank4",type:"symbol",metadata:{"mapbox:group":"1444933456003.5437"},source:"composite","source-layer":"poi_label",minzoom:15,filter:["all",["==","scalerank",4],["in","maki","campsite","cemetery","dog-park","garden","golf","park","picnic-site","playground","zoo"]],layout:{"text-line-height":1.1,"text-size":{base:1,stops:[[16,11],[20,13]]},"icon-image":"{maki}-11","text-max-angle":38,"symbol-spacing":250,"text-font":["DIN Offc Pro Medium","Arial Unicode MS Regular"],"text-padding":1,"text-offset":[0,.65],"text-rotation-alignment":"viewport","text-anchor":"top","text-field":"{name_en}","text-letter-spacing":.01,"text-max-width":8},paint:{"text-color":"hsl(100, 100%, 20%)","text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":.5,"text-halo-blur":.5},interactive:!0},{id:"poi-scalerank3",type:"symbol",metadata:{"mapbox:group":"1444933372896.5967"},source:"composite","source-layer":"poi_label",filter:["all",["!in","maki","campsite","cemetery","dog-park","garden","golf","park","picnic-site","playground","zoo"],["==","scalerank",3]],layout:{"text-line-height":1.1,"text-size":{base:1,stops:[[16,11],[20,13]]},"icon-image":"{maki}-11","text-max-angle":38,"symbol-spacing":250,"text-font":["DIN Offc Pro Medium","Arial Unicode MS Regular"],"text-padding":1,"text-offset":[0,.65],"text-rotation-alignment":"viewport","text-anchor":"top","text-field":"{name_en}","text-letter-spacing":.01,"text-max-width":8},paint:{"text-color":"hsl(25, 25%, 32%)","text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":.5,"text-halo-blur":.5},interactive:!0},{id:"poi-parks-scalerank3",type:"symbol",metadata:{"mapbox:group":"1444933372896.5967"},source:"composite","source-layer":"poi_label",filter:["all",["==","scalerank",3],["in","maki","campsite","cemetery","dog-park","garden","golf","park","picnic-site","playground","zoo"]],layout:{"text-line-height":1.1,"text-size":{base:1,stops:[[16,11],[20,13]]},"icon-image":"{maki}-11","text-max-angle":38,"symbol-spacing":250,"text-font":["DIN Offc Pro Medium","Arial Unicode MS Regular"],"text-padding":2,"text-offset":[0,.65],"text-rotation-alignment":"viewport","text-anchor":"top","text-field":"{name_en}","text-letter-spacing":.01,"text-max-width":8},paint:{"text-color":"hsl(100, 100%, 20%)","text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":.5,"text-halo-blur":.5},interactive:!0},{id:"road-label-small",type:"symbol",metadata:{"mapbox:group":"1444933721429.3076"},source:"composite","source-layer":"road_label",minzoom:15,filter:["all",["!in","class","aerialway","link","motorway","path","pedestrian","primary","secondary","street","street_limited","tertiary","trunk"],["==","$type","LineString"]],layout:{"text-size":{base:1,stops:[[15,10],[20,13]]},"text-max-angle":30,"symbol-spacing":250,"text-font":["DIN Offc Pro Regular","Arial Unicode MS Regular"],"symbol-placement":"line","text-padding":1,"text-rotation-alignment":"map","text-field":"{name_en}","text-letter-spacing":.01},paint:{"text-color":"hsl(0, 0%, 0%)","text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":1.25,"text-halo-blur":1},interactive:!0},{id:"road-label-medium",type:"symbol",metadata:{"mapbox:group":"1444933721429.3076"},source:"composite","source-layer":"road_label",minzoom:11,filter:["all",["==","$type","LineString"],["in","class","aerialway","link","path","pedestrian","street","street_limited"]],layout:{"text-size":{base:1,stops:[[11,10],[20,14]]},"text-max-angle":30,"symbol-spacing":250,"text-font":["DIN Offc Pro Regular","Arial Unicode MS Regular"],"symbol-placement":"line","text-padding":1,"text-rotation-alignment":"map","text-field":"{name_en}","text-letter-spacing":.01},paint:{"text-color":"hsl(0, 0%, 0%)","text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":1},interactive:!0},{id:"road-label-large",type:"symbol",metadata:{"mapbox:group":"1444933721429.3076"},source:"composite","source-layer":"road_label",filter:["in","class","motorway","primary","secondary","tertiary","trunk"],layout:{"text-size":{base:1,stops:[[9,10],[20,16]]},"text-max-angle":30,"symbol-spacing":250,"text-font":["DIN Offc Pro Regular","Arial Unicode MS Regular"],"symbol-placement":"line","text-padding":1,"text-rotation-alignment":"map","text-field":"{name_en}","text-letter-spacing":.01},paint:{"text-color":"hsl(0, 0%, 0%)","text-halo-color":"rgba(255,255,255, 0.75)","text-halo-width":1,"text-halo-blur":1},interactive:!0},{id:"road-shields-black",type:"symbol",metadata:{"mapbox:group":"1444933575858.6992"},source:"composite","source-layer":"road_label",filter:["all",["!in","shield","at-expressway","at-motorway","at-state-b","bg-motorway","bg-national","ch-main","ch-motorway","cz-motorway","cz-road","de-motorway","e-road","fi-main","gr-motorway","gr-national","hr-motorway","hr-state","hu-main","hu-motorway","nz-state","pl-expressway","pl-motorway","pl-national","ro-county","ro-motorway","ro-national","rs-motorway","rs-state-1b","se-main","si-expressway","si-motorway","sk-highway","sk-road","us-interstate","us-interstate-business","us-interstate-duplex","us-interstate-truck","za-metropolitan","za-national","za-provincial","za-regional"],["<=","reflen",6]],layout:{"text-size":9,"icon-image":"{shield}-{reflen}","icon-rotation-alignment":"viewport","text-max-angle":38,"symbol-spacing":{base:1,stops:[[11,150],[14,200]]},"text-font":["DIN Offc Pro Bold","Arial Unicode MS Bold"],"symbol-placement":{base:1,stops:[[10,"point"],[11,"line"]]},"text-padding":2,"text-rotation-alignment":"viewport","text-field":"{ref}","text-letter-spacing":.05,"icon-padding":2},paint:{"text-color":"hsl(230, 21%, 37%)","icon-halo-color":"rgba(0, 0, 0, 1)","icon-halo-width":1,"text-opacity":1,"icon-color":"white","text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":0},interactive:!0},{id:"road-shields-white",type:"symbol",metadata:{"mapbox:group":"1444933575858.6992"},source:"composite","source-layer":"road_label",filter:["all",["<=","reflen",6],["in","shield","at-expressway","at-motorway","at-state-b","bg-motorway","bg-national","ch-main","ch-motorway","cz-motorway","cz-road","de-motorway","e-road","fi-main","gr-motorway","gr-national","hr-motorway","hr-state","hu-main","hu-motorway","nz-state","pl-expressway","pl-motorway","pl-national","ro-county","ro-motorway","ro-national","rs-motorway","rs-state-1b","se-main","si-expressway","si-motorway","sk-highway","sk-road","us-interstate","us-interstate-business","us-interstate-duplex","us-interstate-truck","za-metropolitan","za-national","za-provincial","za-regional"]],layout:{"text-size":9,"icon-image":"{shield}-{reflen}","icon-rotation-alignment":"viewport","text-max-angle":38,"symbol-spacing":{base:1,stops:[[11,150],[14,200]]},"text-font":["DIN Offc Pro Bold","Arial Unicode MS Bold"],"symbol-placement":{base:1,stops:[[10,"point"],[11,"line"]]},"text-padding":2,"text-rotation-alignment":"viewport","text-field":"{ref}","text-letter-spacing":.05,"icon-padding":2},paint:{"text-color":"hsl(0, 0%, 100%)","icon-halo-color":"rgba(0, 0, 0, 1)","icon-halo-width":1,"text-opacity":1,"icon-color":"white","text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":0},interactive:!0},{id:"mountain-peak-label",type:"symbol",source:"composite","source-layer":"mountain_peak_label",layout:{"text-line-height":1.1,"text-size":{base:1,stops:[[10,11],[18,14]]},"icon-image":"{maki}-15","text-font":["DIN Offc Pro Medium","Arial Unicode MS Regular"],"text-offset":[0,.65],"text-anchor":"top","text-field":"{name_en}","text-letter-spacing":.01,"text-max-width":8},paint:{"text-color":"hsl(100, 100%, 20%)","text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":.5,"text-halo-blur":.5},interactive:!0},{id:"mountain-peak-label-with-elevation",type:"symbol",source:"composite","source-layer":"mountain_peak_label",filter:[">","elevation_m",0],layout:{"text-line-height":1.1,"text-size":{base:1,stops:[[10,11],[18,14]]},"icon-image":"{maki}-15","text-font":["DIN Offc Pro Medium","Arial Unicode MS Regular"],"text-offset":[0,.65],"text-anchor":"top","text-field":"{name_en}, {elevation_m}m","text-letter-spacing":.01,"text-max-width":8},paint:{"text-color":"hsl(100, 100%, 20%)","text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":.5,"text-halo-blur":.5},interactive:!0},{id:"poi-scalerank2",type:"symbol",metadata:{"mapbox:group":"1444933358918.2366"},source:"composite","source-layer":"poi_label",filter:["all",["!in","maki","campsite","cemetery","dog-park","garden","golf","park","picnic-site","playground","zoo"],["==","scalerank",2]],layout:{"text-line-height":1.1,"text-size":{base:1,stops:[[14,11],[20,14]]},"icon-image":{stops:[[14,"{maki}-11"],[15,"{maki}-15"]]},"text-max-angle":38,"symbol-spacing":250,"text-font":["DIN Offc Pro Medium","Arial Unicode MS Regular"],"text-padding":2,"text-offset":[0,.65],"text-rotation-alignment":"viewport","text-anchor":"top","text-field":"{name_en}","text-letter-spacing":.01,"text-max-width":8},paint:{"text-color":"hsl(25, 25%, 32%)","text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":.5,"text-halo-blur":.5},interactive:!0},{id:"poi-parks-scalerank2",type:"symbol",metadata:{"mapbox:group":"1444933358918.2366"},source:"composite","source-layer":"poi_label",filter:["all",["==","scalerank",2],["in","maki","campsite","cemetery","dog-park","garden","golf","park","picnic-site","playground","zoo"]],layout:{"text-line-height":1.1,"text-size":{base:1,stops:[[14,11],[20,14]]},"icon-image":{stops:[[14,"{maki}-11"],[15,"{maki}-15"]]},"text-max-angle":38,"symbol-spacing":250,"text-font":["DIN Offc Pro Medium","Arial Unicode MS Regular"],"text-padding":2,"text-offset":[0,.65],"text-rotation-alignment":"viewport","text-anchor":"top","text-field":"{name_en}","text-letter-spacing":.01,"text-max-width":8},paint:{"text-color":"hsl(100, 100%, 20%)","text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":.5,"text-halo-blur":.5},interactive:!0},{id:"water-label-sm",type:"symbol",metadata:{"mapbox:group":"1444933808272.805"},source:"composite","source-layer":"water_label",minzoom:15,filter:["<=","area",1e4],layout:{"text-field":"{name_en}","text-font":["DIN Offc Pro Italic","Arial Unicode MS Regular"],"text-max-width":7,"text-size":{base:1,stops:[[16,13],[20,16]]}},paint:{"text-color":"hsl(230, 48%, 44%)"},interactive:!0},{id:"water-label",type:"symbol",metadata:{"mapbox:group":"1444933808272.805"},source:"composite","source-layer":"water_label",minzoom:5,filter:[">","area",1e4],layout:{"text-field":"{name_en}","text-font":["DIN Offc Pro Italic","Arial Unicode MS Regular"],"text-max-width":7,"text-size":{base:1,stops:[[13,13],[18,18]]}},paint:{"text-color":"hsl(230, 48%, 44%)"},interactive:!0},{id:"poi-parks-scalerank1",type:"symbol",metadata:{"mapbox:group":"1444933322393.2852"},source:"composite","source-layer":"poi_label",filter:["all",["<=","scalerank",1],["in","maki","campsite","cemetery","dog-park","garden","golf","park","picnic-site","playground","zoo"]],layout:{"text-line-height":1.1,"text-size":{base:1,stops:[[10,11],[18,14]]},"icon-image":{stops:[[13,"{maki}-11"],[14,"{maki}-15"]]},"text-max-angle":38,"symbol-spacing":250,"text-font":["DIN Offc Pro Medium","Arial Unicode MS Regular"],"text-padding":2,"text-offset":[0,.65],"text-rotation-alignment":"viewport","text-anchor":"top","text-field":"{name_en}","text-letter-spacing":.01,"text-max-width":8},paint:{"text-color":"hsl(100, 100%, 20%)","text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":.5,"text-halo-blur":.5},interactive:!0},{id:"poi-scalerank1",type:"symbol",metadata:{"mapbox:group":"1444933322393.2852"},source:"composite","source-layer":"poi_label",filter:["all",["!in","maki","campsite","cemetery","dog-park","garden","golf","park","picnic-site","playground","zoo"],["<=","scalerank",1]],layout:{"text-line-height":1.1,"text-size":{base:1,stops:[[10,11],[18,14]]},"icon-image":{stops:[[13,"{maki}-11"],[14,"{maki}-15"]]},"text-max-angle":38,"symbol-spacing":250,"text-font":["DIN Offc Pro Medium","Arial Unicode MS Regular"],"text-padding":2,"text-offset":[0,.65],"text-rotation-alignment":"viewport","text-anchor":"top","text-field":"{name_en}","text-letter-spacing":.01,"text-max-width":8},paint:{"text-color":"hsl(25, 25%, 32%)","text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":.5,"text-halo-blur":.5},interactive:!0},{id:"place-islet-archipelago-aboriginal",type:"symbol",source:"composite","source-layer":"place_label",maxzoom:16,filter:["in","type","aboriginal_lands","archipelago","islet"],layout:{"text-line-height":1.2,"text-size":{base:1,stops:[[10,11],[18,16]]},"text-max-angle":38,"symbol-spacing":250,"text-font":["DIN Offc Pro Regular","Arial Unicode MS Regular"],"text-padding":2,"text-offset":[0,0],"text-rotation-alignment":"viewport","text-field":"{name_en}","text-letter-spacing":.01,"text-max-width":8},paint:{"text-color":"hsl(230, 29%, 35%)","text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":1},interactive:!0},{id:"place-hamlet",type:"symbol",source:"composite","source-layer":"place_label",minzoom:10,maxzoom:16,filter:["==","type","hamlet"],layout:{"text-field":"{name_en}","text-font":["DIN Offc Pro Regular","Arial Unicode MS Regular"],"text-size":{base:1,stops:[[12,11.5],[15,16]]}},paint:{"text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":1.25,"text-color":"hsl(0, 0%, 0%)"},interactive:!0},{id:"place-village",type:"symbol",source:"composite","source-layer":"place_label",minzoom:8,maxzoom:15,filter:["==","type","village"],layout:{"text-field":"{name_en}","text-font":["DIN Offc Pro Regular","Arial Unicode MS Regular"],"text-max-width":7,"text-size":{base:1,stops:[[10,11.5],[16,18]]}},paint:{"text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":1.25,"text-color":"hsl(0, 0%, 0%)"},interactive:!0},{id:"place-town",type:"symbol",source:"composite","source-layer":"place_label",minzoom:6,maxzoom:15,filter:["==","type","town"],layout:{"icon-image":"dot-9","text-font":{base:1,stops:[[11,["DIN Offc Pro Regular","Arial Unicode MS Regular"]],[12,["DIN Offc Pro Medium","Arial Unicode MS Regular"]]]},"text-offset":{base:1,stops:[[7,[0,-.15]],[8,[0,0]]]},"text-anchor":{base:1,stops:[[7,"bottom"],[8,"center"]]},"text-field":"{name_en}","text-max-width":7,"text-size":{base:1,stops:[[7,11.5],[15,20]]}},paint:{"text-color":"hsl(0, 0%, 0%)","text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":1.25,"icon-opacity":{base:1,stops:[[7.99,1],[8,0]]}},interactive:!0},{id:"place-island",type:"symbol",source:"composite","source-layer":"place_label",maxzoom:16,filter:["==","type","island"],layout:{"text-line-height":1.2,"text-size":{base:1,stops:[[10,11],[18,16]]},"text-max-angle":38,"symbol-spacing":250,"text-font":["DIN Offc Pro Regular","Arial Unicode MS Regular"],"text-padding":2,"text-offset":[0,0],"text-rotation-alignment":"viewport","text-field":"{name_en}","text-letter-spacing":.01,"text-max-width":7},paint:{"text-color":"hsl(230, 29%, 35%)","text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":1},interactive:!0},{id:"place-city-sm",type:"symbol",metadata:{"mapbox:group":"1444862510685.128"},source:"composite","source-layer":"place_label",maxzoom:14,filter:["all",["!in","scalerank",0,1,2,3,4,5],["==","type","city"]],layout:{"text-size":{base:1,stops:[[6,12],[14,22]]},"icon-image":"dot-9","text-font":{base:1,stops:[[7,["DIN Offc Pro Regular","Arial Unicode MS Regular"]],[8,["DIN Offc Pro Medium","Arial Unicode MS Regular"]]]},"text-offset":{base:1,stops:[[7.99,[0,-.2]],[8,[0,0]]]},"text-anchor":{base:1,stops:[[7,"bottom"],[8,"center"]]},"text-field":"{name_en}","text-max-width":7},paint:{"text-color":"hsl(0, 0%, 0%)","text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":1.25,"icon-opacity":{base:1,stops:[[7.99,1],[8,0]]}},interactive:!0},{id:"place-city-md-s",type:"symbol",metadata:{"mapbox:group":"1444862510685.128"},source:"composite","source-layer":"place_label",maxzoom:14,filter:["all",["==","type","city"],["in","ldir","E","S","SE","SW"],["in","scalerank",3,4,5]],layout:{"text-field":"{name_en}","icon-image":"dot-10","text-anchor":{base:1,stops:[[7,"top"],[8,"center"]]},"text-offset":{base:1,stops:[[7.99,[0,.1]],[8,[0,0]]]},"text-font":{base:1,stops:[[7,["DIN Offc Pro Regular","Arial Unicode MS Regular"]],[8,["DIN Offc Pro Medium","Arial Unicode MS Regular"]]]},"text-size":{base:.9,stops:[[5,12],[12,22]]}},paint:{"text-halo-width":1,"text-halo-color":"hsl(0, 0%, 100%)","text-color":"hsl(0, 0%, 0%)","text-halo-blur":1,"icon-opacity":{base:1,stops:[[7.99,1],[8,0]]}},interactive:!0},{id:"place-city-md-n",type:"symbol",metadata:{"mapbox:group":"1444862510685.128"},source:"composite","source-layer":"place_label",maxzoom:14,filter:["all",["==","type","city"],["in","ldir","N","NE","NW","W"],["in","scalerank",3,4,5]],layout:{"icon-image":"dot-10","text-font":{base:1,stops:[[7,["DIN Offc Pro Regular","Arial Unicode MS Regular"]],[8,["DIN Offc Pro Medium","Arial Unicode MS Regular"]]]},"text-offset":{base:1,stops:[[7.99,[0,-.25]],[8,[0,0]]]},"text-anchor":{base:1,stops:[[7,"bottom"],[8,"center"]]},"text-field":"{name_en}","text-max-width":7,"text-size":{base:.9,stops:[[5,12],[12,22]]}},paint:{"text-color":"hsl(0, 0%, 0%)","text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":1,"icon-opacity":{base:1,stops:[[7.99,1],[8,0]]},"text-halo-blur":1},interactive:!0},{id:"place-city-lg-s",type:"symbol",metadata:{"mapbox:group":"1444862510685.128"},source:"composite","source-layer":"place_label",minzoom:1,maxzoom:14,filter:["all",["<=","scalerank",2],["==","type","city"],["in","ldir","E","S","SE","SW"]],layout:{"icon-image":"dot-11","text-font":{base:1,stops:[[7,["DIN Offc Pro Regular","Arial Unicode MS Regular"]],[8,["DIN Offc Pro Medium","Arial Unicode MS Regular"]]]},"text-offset":{base:1,stops:[[7.99,[0,.15]],[8,[0,0]]]},"text-anchor":{base:1,stops:[[7,"top"],[8,"center"]]},"text-field":"{name_en}","text-max-width":7,"text-size":{base:.9,stops:[[4,12],[10,22]]}},paint:{"text-color":"hsl(0, 0%, 0%)","text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":1,"icon-opacity":{base:1,stops:[[7.99,1],[8,0]]},"text-halo-blur":1},interactive:!0},{id:"place-city-lg-n",type:"symbol",metadata:{"mapbox:group":"1444862510685.128"},source:"composite","source-layer":"place_label",minzoom:1,maxzoom:14,filter:["all",["<=","scalerank",2],["==","type","city"],["in","ldir","N","NE","NW","W"]],layout:{"icon-image":"dot-11","text-font":{base:1,stops:[[7,["DIN Offc Pro Regular","Arial Unicode MS Regular"]],[8,["DIN Offc Pro Medium","Arial Unicode MS Regular"]]]},"text-offset":{base:1,stops:[[7.99,[0,-.25]],[8,[0,0]]]},"text-anchor":{base:1,stops:[[7,"bottom"],[8,"center"]]},"text-field":"{name_en}","text-max-width":7,"text-size":{base:.9,stops:[[4,12],[10,22]]}},paint:{"text-color":"hsl(0, 0%, 0%)","text-opacity":1,"text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":1,"icon-opacity":{base:1,stops:[[7.99,1],[8,0]]},"text-halo-blur":1},interactive:!0},{id:"marine-label-sm-ln",type:"symbol",metadata:{"mapbox:group":"1444856087950.3635"},source:"composite","source-layer":"marine_label",minzoom:3,maxzoom:10,filter:["all",["==","$type","LineString"],[">=","labelrank",4]],layout:{"text-line-height":1.1,"text-size":{base:1,stops:[[3,12],[6,16]]},"symbol-spacing":{base:1,stops:[[4,100],[6,400]]},"text-font":["DIN Offc Pro Italic","Arial Unicode MS Regular"],"symbol-placement":"line","text-field":"{name_en}","text-letter-spacing":.1,"text-max-width":5},paint:{"text-color":"hsl(205, 83%, 88%)"},interactive:!0},{id:"marine-label-sm-pt",type:"symbol",metadata:{"mapbox:group":"1444856087950.3635"},source:"composite","source-layer":"marine_label",minzoom:3,maxzoom:10,filter:["all",["==","$type","Point"],[">=","labelrank",4]],layout:{"text-field":"{name_en}","text-max-width":5,"text-letter-spacing":.1,"text-line-height":1.5,"text-font":["DIN Offc Pro Italic","Arial Unicode MS Regular"],"text-size":{base:1,stops:[[3,12],[6,16]]}},paint:{"text-color":"hsl(205, 83%, 88%)"},interactive:!0},{id:"marine-label-md-ln",type:"symbol",metadata:{"mapbox:group":"1444856087950.3635"},source:"composite","source-layer":"marine_label",minzoom:2,maxzoom:8,filter:["all",["==","$type","LineString"],["in","labelrank",2,3]],layout:{"text-line-height":1.1,"text-size":{base:1.1,stops:[[2,12],[5,20]]},"symbol-spacing":250,"text-font":["DIN Offc Pro Italic","Arial Unicode MS Regular"],"symbol-placement":"line","text-field":"{name_en}","text-letter-spacing":.15,"text-max-width":5},paint:{"text-color":"hsl(205, 83%, 88%)"},interactive:!0},{id:"marine-label-md-pt",type:"symbol",metadata:{"mapbox:group":"1444856087950.3635"},source:"composite","source-layer":"marine_label",minzoom:2,maxzoom:8,filter:["all",["==","$type","Point"],["in","labelrank",2,3]],layout:{"text-field":"{name_en}","text-max-width":5,"text-letter-spacing":.15,"text-line-height":1.5,"text-font":["DIN Offc Pro Italic","Arial Unicode MS Regular"],"text-size":{base:1.1,stops:[[2,14],[5,20]]}},paint:{"text-color":"hsl(205, 83%, 88%)"},interactive:!0},{id:"marine-label-lg-ln",type:"symbol",metadata:{"mapbox:group":"1444856087950.3635"},source:"composite","source-layer":"marine_label",minzoom:1,maxzoom:4,filter:["all",["==","$type","LineString"],["==","labelrank",1]],layout:{"text-field":"{name_en}","text-max-width":4,"text-letter-spacing":.25,"text-line-height":1.1,"symbol-placement":"line","text-font":["DIN Offc Pro Italic","Arial Unicode MS Regular"],"text-size":{base:1,stops:[[1,14],[4,30]]}},paint:{"text-color":"hsl(205, 83%, 88%)"},interactive:!0},{id:"marine-label-lg-pt",type:"symbol",metadata:{"mapbox:group":"1444856087950.3635"},source:"composite","source-layer":"marine_label",minzoom:1,maxzoom:4,filter:["all",["==","$type","Point"],["==","labelrank",1]],layout:{"text-field":"{name_en}","text-max-width":4,"text-letter-spacing":.25,"text-line-height":1.5,"text-font":["DIN Offc Pro Italic","Arial Unicode MS Regular"],"text-size":{base:1,stops:[[1,14],[4,30]]}},paint:{"text-color":"hsl(205, 83%, 88%)"},interactive:!0},{id:"state-label-sm",type:"symbol",metadata:{"mapbox:group":"1444856151690.9143"},source:"composite","source-layer":"state_label",minzoom:3,maxzoom:9,filter:["<","area",2e4],layout:{"text-size":{base:1,stops:[[6,10],[9,14]]},"text-transform":"uppercase","text-font":["DIN Offc Pro Bold","Arial Unicode MS Bold"],"text-field":{base:1,stops:[[0,"{abbr}"],[6,"{name_en}"]]},"text-letter-spacing":.15,"text-max-width":5},paint:{"text-opacity":1,"text-color":"hsl(0, 0%, 0%)","text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":1},interactive:!0},{id:"state-label-md",type:"symbol",metadata:{"mapbox:group":"1444856151690.9143"},source:"composite","source-layer":"state_label",minzoom:3,maxzoom:8,filter:["all",["<","area",8e4],[">=","area",2e4]],layout:{"text-size":{base:1,stops:[[5,10],[8,16]]},"text-transform":"uppercase","text-font":["DIN Offc Pro Bold","Arial Unicode MS Bold"],"text-field":{base:1,stops:[[0,"{abbr}"],[5,"{name_en}"]]},"text-letter-spacing":.15,"text-max-width":6},paint:{"text-opacity":1,"text-color":"hsl(0, 0%, 0%)","text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":1},interactive:!0},{id:"state-label-lg",type:"symbol",metadata:{"mapbox:group":"1444856151690.9143"},source:"composite","source-layer":"state_label",minzoom:3,maxzoom:7,filter:[">=","area",8e4],layout:{"text-size":{base:1,stops:[[4,10],[7,18]]},"text-transform":"uppercase","text-font":["DIN Offc Pro Bold","Arial Unicode MS Bold"],"text-padding":1,"text-field":{base:1,stops:[[0,"{abbr}"],[4,"{name_en}"]]},"text-letter-spacing":.15,"text-max-width":6},paint:{"text-opacity":1,"text-color":"hsl(0, 0%, 0%)","text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":1},interactive:!0},{id:"country-label-sm",type:"symbol",metadata:{"mapbox:group":"1444856144497.7825"},source:"composite","source-layer":"country_label",minzoom:1,maxzoom:10,filter:[">=","scalerank",5],layout:{"text-field":"{name_en}","text-max-width":6,"text-font":["DIN Offc Pro Medium","Arial Unicode MS Regular"],"text-size":{base:.9,stops:[[5,14],[9,22]]}},paint:{"text-color":"hsl(0, 0%, 0%)","text-halo-color":{base:1,stops:[[2,"rgba(255,255,255,0.75)"],[3,"hsl(0, 0%, 100%)"]]},"text-halo-width":1.25},interactive:!0},{id:"country-label-md",type:"symbol",metadata:{"mapbox:group":"1444856144497.7825"},source:"composite","source-layer":"country_label",minzoom:1,maxzoom:8,filter:["in","scalerank",3,4],layout:{"text-field":{base:1,stops:[[0,"{code}"],[2,"{name_en}"]]},"text-max-width":6,"text-font":["DIN Offc Pro Medium","Arial Unicode MS Regular"],"text-size":{base:1,stops:[[3,10],[8,24]]}},paint:{"text-color":"hsl(0, 0%, 0%)","text-halo-color":{base:1,stops:[[2,"rgba(255,255,255,0.75)"],[3,"hsl(0, 0%, 100%)"]]},"text-halo-width":1.25},interactive:!0},{id:"country-label-lg",type:"symbol",metadata:{"mapbox:group":"1444856144497.7825"},source:"composite","source-layer":"country_label",minzoom:1,maxzoom:7,filter:["in","scalerank",1,2],layout:{"text-field":"{name_en}","text-max-width":{base:1,stops:[[0,5],[3,6]]},"text-font":["DIN Offc Pro Medium","Arial Unicode MS Regular"],"text-size":{base:1,stops:[[1,10],[6,24]]}},paint:{"text-color":"hsl(0, 0%, 0%)","text-halo-color":{base:1,stops:[[2,"rgba(255,255,255,0.75)"],[3,"hsl(0, 0%, 100%)"]]},"text-halo-width":1.25},interactive:!0}],created:"2017-08-10T19:56:21.137Z",id:"cj66v6i8c4hnc2so16ngtlovn",modified:"2017-08-10T19:56:21.137Z",owner:"pipbailey",visibility:"private",draft:!1}},49:function(e,t,a){"use strict";a.d(t,"d",function(){return o}),a.d(t,"c",function(){return i}),a.d(t,"b",function(){return l}),a.d(t,"e",function(){return c}),a.d(t,"a",function(){return s});var n=a(130),r=a.n(n),o=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"LLLL";return r()(e,"x").format(t)},i=function(e){return r()(e,"x").fromNow()},l=function(e){return r.a.utc(e).format("x")};function c(e){return r()(e,"x").format("YYYY-MM-DDTkk:mm")}function s(e){return r()(new Date(e),"YYYY-MM-DDTkk:mm").format("x")}},504:function(e,t,a){e.exports=a(887)},516:function(e,t){},522:function(e,t){},71:function(e,t,a){"use strict";(function(e){a.d(t,"b",function(){return n}),a.d(t,"a",function(){return r});a(232);var n=function(e){try{return!isNaN(parseFloat(e))&&isFinite(e)}catch(t){return!1}};function r(e,t,a){var n=this,r=null;return function(){for(var o=arguments.length,i=new Array(o),l=0;l<o;l++)i[l]=arguments[l];var c=n,s=a&&!r;clearTimeout(r),r=setTimeout(function(){r=null,a||e.apply(c,i)},t),s&&e.apply(c,i)}}}).call(this,a(36).Buffer)},883:function(e,t,a){},887:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(22),i=a.n(o),l=a(9),c=a(48),s=a(39),u=a(307),p=a(439),d=a.n(p);Object(u.b)(d.a);r.a.createContext({});var m=function(e){var t=e.children;return r.a.createElement(u.a,{locale:"en"},t)},g=a(42),h=a(43),b=a.n(h);function f(){var e=Object(g.a)(["\nfragment userFragment on User {\n  id\n  username\n  gravatar\n  watching\n  gravatarProfile\n  meta\n  createdOn\n  updatedOn\n}\n"]);return f=function(){return e},e}function y(){var e=Object(g.a)(["\nfragment photoFragment on Photo {\n  id\n  meta\n  createdOn\n  takenOn\n  updatedOn\n  coords\n  seriesId\n  seriesCreatedBy\n  createdBy\n  updatedBy\n  uploadToken\n  createdUser {\n    ...userSummaryFragment\n  }\n  updatedUser {\n    ...userSummaryFragment\n  }\n  tags {\n    label\n    typeId\n    coords {\n      x\n      y\n    }\n  }\n  paths {\n    base\n    large\n    thumb\n    medium\n  }\n}\n","\n"]);return y=function(){return e},e}function v(){var e=Object(g.a)(["\nfragment seriesFragment on Series {\n  id\n  name\n  access\n  note\n  meta\n  watchers\n  createdOn\n  updatedOn\n  createdUser {\n    ...userSummaryFragment\n  }\n  updatedUser {\n    ...userSummaryFragment\n  }\n  coords\n  direction\n  photoCount\n  featured {\n    ...photoSummaryFragment\n  }\n  latest {\n    ...photoSummaryFragment\n  }\n}\n","\n","\n"]);return v=function(){return e},e}function x(){var e=Object(g.a)(["\nfragment seriesSummaryFragment on SeriesSummary {\n  id\n  name\n  access\n  createdUser {\n    ...userSummaryFragment\n  }\n  seriesStatus\n  updatedOn\n  createdOn\n  photoCount\n  coords\n  direction\n  watchers\n  featured {\n    ...photoSummaryFragment\n  }\n  latest {\n    ...photoSummaryFragment\n  }\n}\n","\n","\n"]);return x=function(){return e},e}function w(){var e=Object(g.a)(["\nfragment userSummaryFragment on UserSummary {\n  id\n  gravatar\n  gravatarProfile\n  username\n}\n"]);return w=function(){return e},e}function E(){var e=Object(g.a)(["\nfragment photoSummaryFragment on PhotoSummary {\n  id\n  takenOn\n  seriesCreatedBy\n  updatedOn\n  createdOn\n  seriesId\n  createdUser {\n    ...userSummaryFragment\n  }\n  paths {\n    base\n    thumb\n    medium\n    large\n  }\n}\n"]);return E=function(){return e},e}var O=b()(E()),k=b()(w()),S=b()(x(),O,k),j=b()(v(),O,k),C=b()(y(),k),N=b()(f());function I(){var e=Object(g.a)(["\nquery getWholeSeries($id: ID!) {\n  series(id: $id) {\n    ...seriesFragment\n    photos {\n      ...photoFragment\n    }\n  }\n}\n","\n","\n"]);return I=function(){return e},e}function P(){var e=Object(g.a)(["\nquery userSearch($searchStr: String!, $limit: Int) {\n  userSearch(searchStr: $searchStr, limit: $limit ){\n    ...userFragment\n  }\n}\n","\n"]);return P=function(){return e},e}function T(){var e=Object(g.a)(['\nquery myFeed($start: String, $end: String, $limit: Int) {\n  myFeed(start: $start, end: $end, limit: $limit) @connection(key: "myFeed"){\n    feed {\n      _id\n      series {\n        ...seriesSummaryFragment\n      }\n      photo {\n        ...photoSummaryFragment\n      }\n      relation\n    }\n    window\n  }\n}\n',"\n","\n"]);return T=function(){return e},e}function A(){var e=Object(g.a)(["\nquery geocode($search: String!) {\n  geocoder(search: $search) {\n    relevance\n    text\n    placeName\n    bbox\n    center\n    # geoType\n    # context\n  }\n}\n"]);return A=function(){return e},e}function R(){var e=Object(g.a)(["\nquery getUser($userId: ID) {\n  user(id: $userId){\n    ...userFragment\n  }\n}\n","\n"]);return R=function(){return e},e}function _(){var e=Object(g.a)(["\nquery seriesInGeoBounds($bounds: [Float], $limit: Int, $nextToken: String) {\n  seriesInGeoBounds(bounds: $bounds, limit: $limit, nextToken: $nextToken) {\n    seriesSummaries {\n      ...seriesSummaryFragment\n    }\n    nextToken\n  }\n}\n","\n"]);return _=function(){return e},e}function L(){var e=Object(g.a)(["\nquery tagSearch($limit: Int, $tag: String) {\n  tags(limit: $limit, tag: $tag ){\n    _id\n    name\n    count\n  }\n}\n"]);return L=function(){return e},e}function z(){var e=Object(g.a)(["\nquery seriesWithTag($tag: String!, $limit: Int, $nextToken: String) {\n  tagSeries(tag: $tag, limit: $limit, nextToken: $nextToken) {\n    seriesSummaries{\n      ...seriesSummaryFragment\n    }\n    nextToken\n  }\n}\n","\n"]);return z=function(){return e},e}function M(){var e=Object(g.a)(["\nquery seriesFromList($seriesList: [ID]) {\n  arraySeries(seriesIds: $seriesList) {\n    ...seriesFragment\n    photos {\n      ...photoFragment\n    }\n  }\n}\n","\n","\n"]);return M=function(){return e},e}function D(){var e=Object(g.a)(["\nquery seriesFromList($seriesList: [ID]) {\n  arraySeries(seriesIds: $seriesList) {\n    ...seriesSummaryFragment\n  }\n}\n","\n"]);return D=function(){return e},e}function F(){var e=Object(g.a)(["\nquery userSeries($createdBy: ID) {\n  userSeries(createdBy: $createdBy ) {\n    seriesSummaries {\n      ...seriesSummaryFragment\n    }\n    nextToken\n  }\n}\n","\n"]);return F=function(){return e},e}function B(){var e=Object(g.a)(['\nquery pollQuery($lastCheck: String!, $limit: Int, $nextToken: String) {\n  changedSeries(lastCheck: $lastCheck, limit: $limit, nextToken: $nextToken) @connection(key: "changedSeries"){\n    seriesSummaries {\n      ...seriesSummaryFragment\n    }\n  }\n}\n',"\n"]);return B=function(){return e},e}function U(){var e=Object(g.a)(['\nquery allSeries($limit: Int, $nextToken: String) {\n  allSeries(limit: $limit, nextToken: $nextToken) @connection(key: "allSeries"){\n    seriesSummaries {\n      ...seriesSummaryFragment\n    }\n    nextToken\n  }\n}\n',"\n"]);return U=function(){return e},e}var $=b()(U(),S),W=b()(B(),S),G=b()(F(),S),q=(b()(D(),S),b()(M(),j,C)),H=b()(z(),S),Y=b()(L()),V=(b()(_(),S),b()(R(),N)),Q=b()(A()),X=b()(T(),S,O),Z=b()(P(),N),J=b()(I(),j,C),K=a(889),ee=a(91),te={useNextVariants:!0},ae="#3a3335",ne="#d81e5b",re="#f0544f",oe="#FDF0D5",ie={palette:{primary:{main:re},secondary:{main:ne},text:{primary:ae,secondary:Object(ee.fade)(ae,.7)}},typography:te},le={palette:{primary:{main:Object(ee.lighten)(ae,.1)},secondary:{main:ne},text:{primary:ae,secondary:Object(ee.fade)(ae,.7)}},typography:te},ce={palette:{primary:{main:re},secondary:{main:ne}},typography:te},se={palette:{primary:{main:oe},secondary:{main:re}},typography:te},ue={palette:{primary:{main:re},secondary:{main:ne},text:{primary:oe,secondary:Object(ee.fade)(oe,.7)},background:{default:ae,paper:ae}},typography:te},pe={home:Object(K.a)(ie),login:Object(K.a)(ue),series:Object(K.a)(le),topbar:Object(K.a)(ce),bottombar:Object(K.a)(se)},de=r.a.createContext({}),me=a(924),ge=a(923),he=a(921),be=function(){var e=Object(n.useRef)(),t=function(t){if("Enter"===t.key&&e.current)try{var a=e.current.getElementsByClassName("enterAction");a&&a[0]&&a[0].click()}catch(n){console.error("useAuthCommon::handleKeyPress",n)}};return Object(n.useEffect)(function(){if(e.current){try{document.addEventListener("keypress",t,!1)}catch(a){console.error("useAuthCommon::useEffect",a)}return function(){return document.removeEventListener("keypress",t,!1)}}},[]),e},fe=a(30),ye=a.n(fe),ve=ye()(r.a.createElement(r.a.Fragment,null,r.a.createElement("path",{d:"M13.685,2.797c-0.44,1.273 0.852,3.525 -1.082,4.966c-1.247,0.93 -2.133,2.247 -2.743,4.167c-3.78,-7.611 2.788,-8.409 3.682,-10.699c0.64,1.255 5.18,2.608 2.89,4.873c1.28,-2.034 -2.359,-1.862 -2.747,-3.307Z"}),r.a.createElement("path",{d:"M4.921,5.953c0.883,1.017 3.479,1.024 3.76,3.42c0.181,1.545 0.879,2.971 2.238,4.459c-8.482,-0.532 -5.889,-6.619 -7.425,-8.538c1.407,0.073 4.848,-3.183 5.665,-0.066c-1.121,-2.126 -2.792,1.111 -4.238,0.725Z"}),r.a.createElement("path",{d:"M3.236,15.092c1.323,-0.256 2.627,-2.5 4.842,-1.546c1.428,0.615 3.013,0.724 4.98,0.292c-4.701,7.079 -8.676,1.79 -11.106,2.161c0.766,-1.183 -0.332,-5.791 2.775,-4.94c-2.402,-0.091 -0.433,2.974 -1.491,4.033Z"}),r.a.createElement("path",{d:"M10.309,21.121c0.439,-1.274 -0.852,-3.525 1.081,-4.967c1.247,-0.929 2.133,-2.246 2.743,-4.167c3.781,7.611 -2.788,8.409 -3.681,10.699c-0.641,-1.255 -5.181,-2.607 -2.891,-4.873c-1.28,2.034 2.359,1.863 2.748,3.308Z"}),r.a.createElement("path",{d:"M19.066,18.01c-0.883,-1.017 -3.479,-1.024 -3.76,-3.42c-0.182,-1.544 -0.88,-2.971 -2.238,-4.459c8.482,0.532 5.889,6.619 7.425,8.538c-1.407,-0.072 -4.849,3.183 -5.665,0.067c1.121,2.125 2.792,-1.112 4.238,-0.726Z"}),r.a.createElement("path",{d:"M20.751,8.871c-1.323,0.256 -2.627,2.501 -4.842,1.546c-1.429,-0.615 -3.013,-0.723 -4.98,-0.291c4.701,-7.08 8.676,-1.791 11.106,-2.162c-0.767,1.183 0.332,5.791 -2.775,4.94c2.401,0.092 0.433,-2.974 1.491,-4.033Z"})),"AppLogo"),xe=a(922),we=Object(he.a)(function(e){return{root:{height:"100%"},bgSwoosh:{width:"100%",height:"100%",position:"absolute",top:0,left:0,zIndex:0},spacer:{flex:"1 1 5%"},logo:{flex:"1 1 40%",width:"100%",minHeight:90},inner:{margin:"0 auto",width:"100%",height:"100%",minWidth:200,maxWidth:300,display:"flex",flexDirection:"column",textAlign:"center"}}}),Ee=function(e){var t=e.children,a=be(),n=we();return r.a.createElement(xe.a,{theme:pe.login},r.a.createElement("div",{ref:a,className:n.root},r.a.createElement(ge.a,null),r.a.createElement("div",{className:n.inner},r.a.createElement(ve,{className:n.logo}),r.a.createElement(me.a,{variant:"h5"},"MorPhoto"),t,r.a.createElement("div",{className:n.spacer}))))},Oe=function(e){var t=e.message;return r.a.createElement(Ee,null,r.a.createElement(me.a,{variant:"h3"},"Loading..."),t&&r.a.createElement(me.a,{variant:"overline"},t))},ke=a(51),Se=a(84),je=a(119),Ce=a(117),Ne=a(120),Ie=function(e){function t(e){var a;return Object(ke.a)(this,t),console.log("ErrorBoundary constructor"),(a=Object(je.a)(this,Object(Ce.a)(t).call(this,e))).state={hasError:!1},a}return Object(Ne.a)(t,e),Object(Se.a)(t,[{key:"componentDidCatch",value:function(e,t){console.log("ErrorBoundary componentDidCatch"),console.error(e)}},{key:"render",value:function(){var e=this.state,t=e.hasError,a=e.error,n=this.props.fallback;return t?(console.log("ErrorBoundary hasError"),r.a.createElement(n,{error:a})):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return console.log("ErrorBoundary getDerivedStateFromError"),console.error(e),{hasError:!0,error:e}}}]),t}(r.a.Component),Pe=a(7),Te=a(62),Ae=a(925),Re=a(927),_e=a(932),Le=a(933),ze=a(934),Me=a(974),De=a(941),Fe=a(442),Be=a.n(Fe),Ue=a(228),$e=a.n(Ue),We="UNSENT",Ge="SENDING",qe="SENT",He="ERROR",Ye=Object(he.a)(function(e){return{root:{height:"100%",overflow:"hidden",padding:e.spacing(1),display:"flex",flexDirection:"column",textAlign:"center",color:e.palette.text.primary,border:"20px solid ".concat(e.palette.text.secondary)},button:{},icon:{opacity:.5,margin:"auto",flex:"0 1 10%",width:"50%"},text:{},spacer:{flexGrow:1},stack:{padding:e.spacing(2),marginBottom:e.spacing(2),fontSize:"8px",flexGrow:1,textAlign:"left",whiteSpace:"pre-wrap",overflow:"scroll",color:e.palette.error.main,fontFamily:"Consolas, monaco, monospace"}}}),Ve=function(e){var t=e.error,a=e.sendState,o=e.reportError,i=Ye(),l=Object(n.useState)(!1),c=Object(Pe.a)(l,2),s=c[0],u=c[1],p=Object(n.useState)(""),d=Object(Pe.a)(p,2),m=d[0],g=d[1],h=r.a.createElement("div",{className:i.spacer});var b="Report this bug",f=!1,y="primary";switch(a){case We:b="Report this bug";break;case Ge:f=!0,y="default",b="Sending...";break;case qe:y="default",f=!0,b="Thank you for your feedback";break;case He:y="secondary",f=!0,b="ERROR SENDING BUG REPORT"}return r.a.createElement("div",{className:i.root},r.a.createElement(ge.a,null),r.a.createElement($e.a,{className:i.icon,color:"error"}),r.a.createElement(me.a,{variant:"subtitle1",className:i.text,color:"inherit"},"Something went wrong"),t&&t.message&&r.a.createElement(me.a,{variant:"body1",className:i.text,color:"inherit"},t.message),r.a.createElement(Ae.a,{className:i.button,variant:"contained",disabled:f,color:y,onClick:function(){return u(!0)}},r.a.createElement(Be.a,null),b),h,r.a.createElement(Re.a,{open:s,onClose:function(){return u(!1)},"aria-labelledby":"form-dialog-title"},r.a.createElement(_e.a,{id:"form-dialog-title"},"Report a bug"),r.a.createElement(Le.a,null,r.a.createElement(ze.a,null,"What were you trying to do when the error happened?"),r.a.createElement(Me.a,{autoFocus:!0,margin:"dense",multiline:!0,onChange:function(e){return g(e.target.value)},rowsMax:"6",id:"note",placeholder:"I tried to X and then Y happened...",label:"Note",fullWidth:!0})),r.a.createElement(De.a,null,r.a.createElement(Ae.a,{onClick:function(){return u(!1)},color:"primary"},"Cancel"),r.a.createElement(Ae.a,{onClick:function(){o(m),u(!1)},color:"primary"},"Send"))))};function Qe(){var e=Object(g.a)(["\nmutation reportBug($reportJSON: String!) {\n  reportBug(reportJSON: $reportJSON)\n}\n"]);return Qe=function(){return e},e}function Xe(){var e=Object(g.a)(["\nmutation unWatch($seriesId: ID) {\n  unWatchSeries(seriesId: $seriesId)\n}\n"]);return Xe=function(){return e},e}function Ze(){var e=Object(g.a)(["\nmutation watch($seriesId: ID) {\n  watchSeries(seriesId: $seriesId)\n}\n"]);return Ze=function(){return e},e}function Je(){var e=Object(g.a)(["\nmutation createSeries($series: NewSeriesInput, $photo: NewPhotoInput!, $ext: String!) {\n  createSeries(series: $series, photo: $photo, ext: $ext) {\n    series {\n      ...seriesFragment\n      photos {\n        ...photoFragment\n      }\n    }\n    preAuth\n  }\n}\n","\n","\n"]);return Je=function(){return e},e}function Ke(){var e=Object(g.a)(["\nmutation createPhoto($photo: NewPhotoInput!, $ext: String!) {\n  createPhoto(photo: $photo, ext: $ext) {\n    photo {\n      ...photoFragment\n      uploadToken\n    }\n    preAuth\n  }\n}\n","\n"]);return Ke=function(){return e},e}function et(){var e=Object(g.a)(["\nmutation updatePhoto($photo: UpdatePhotoInput!) {\n  updatePhoto(photo: $photo){\n    ...photoFragment\n    uploadToken\n  }\n}\n"]);return et=function(){return e},e}function tt(){var e=Object(g.a)(["\nmutation updateSeries($series: UpdateSeriesInput!) {\n  updateSeries(series: $series){\n    ...seriesFragment\n  }\n}\n"]);return tt=function(){return e},e}function at(){var e=Object(g.a)(["\nmutation deleteSeries($id: ID!) {\n  deleteSeries(id: $id)\n}\n"]);return at=function(){return e},e}function nt(){var e=Object(g.a)(["\nmutation deletePhoto($seriesId: ID!, $photoId: ID!) {\n  deletePhoto(seriesId: $seriesId, photoId: $photoId)\n}\n"]);return nt=function(){return e},e}var rt=b()(nt()),ot=b()(at()),it=b()(tt()),lt=b()(et()),ct=b()(Ke(),C),st=b()(Je(),j,C),ut=b()(Ze()),pt=b()(Xe()),dt=b()(Qe()),mt=Object(s.d)(dt,{props:function(e){var t=e.mutate,a=e.ownProps,n=a.reduxState,r=a.error,o=a.setState;return console.log("withReportBugMutation props",{mutate:t,reduxState:n,error:r}),t.error&&o(He),{reportError:function(e){o(Ge);var a="",i={note:e,reduxState:n,error:r,env:Object({NODE_ENV:"production",PUBLIC_URL:"/photomon_v0",REACT_APP_MAPBOX_TOKEN:"pk.eyJ1IjoicmF5Y2hhc2VyIiwiYSI6IlFHWHVMSW8ifQ.emd44Ibp4cmT9YXitY1ziw",REACT_APP_GRAPHQL:"https://11w2bia702.execute-api.us-west-2.amazonaws.com/prod/api",REACT_APP_AWS_REGION:"us-west-2",REACT_APP_COGNITO_IDPOOLID:"us-west-2:ab544d6d-6ea9-430d-8c8f-d895ce172d0f",REACT_APP_COGNITO_USER_POOL_ID:"us-west-2_ninoe7B9g",REACT_APP_COGNITO_CLIENT_ID:"ndtqsua64n6qqp9hef5fh4560",REACT_APP_DOMAIN:"northarrowresearchlabs.github.io",REACT_APP_BASENAME:"photomon_v0"})};console.log("withReportBugMutation StartingError",i);try{a=JSON.stringify(i)}catch(l){a=r.toString()}return console.log("withReportBugMutation got through it",a),t({variables:{reportJSON:a},update:function(e,t){var a=t.data;console.log("withReportBugMutation update",a),o(qe)}})}}}}),gt=Object(Te.b)(function(e,t){var a=e.map,n=e.home,r=(e.uploader,Object(c.a)(e,["map","home","uploader"])),o=a.slice(-5);return{reduxState:Object(l.a)({},r,{map:o,home:n})}})(function(e){var t=Object(n.useState)(We),a=Object(Pe.a)(t,2),o=a[0],i=a[1],l=mt(Ve);return r.a.createElement(l,Object.assign({},e,{setState:i,sendState:o}))}),ht=a(29),bt=a.n(ht),ft=a(50),yt=a(486),vt=a(447),xt=a(162),wt=a.n(xt),Et=a(444),Ot=a(445),kt=a(942),St=a(943),jt=a(944),Ct=a(945),Nt=[{toolTip:"Sat",Icon:kt.a,ActiveIcon:St.a,color:"green",style:Et},{toolTip:"Topo",Icon:jt.a,ActiveIcon:Ct.a,color:"blue",style:Ot}],It=a(946),Pt=a(440),Tt=a(947),At=["#418CF0","#FCB441","#E0400A","#056492","#BFBFBF","#1A3B69","#FFE382","#129CDD","#CA6B4B","#005CDB","#F3D288","#506381","#F1B9A8","#E0830A","#7893BE"],Rt={mapBoxToken:"pk.eyJ1IjoicmF5Y2hhc2VyIiwiYSI6IlFHWHVMSW8ifQ.emd44Ibp4cmT9YXitY1ziw",styles:Nt},_t=Object({NODE_ENV:"production",PUBLIC_URL:"/photomon_v0",REACT_APP_MAPBOX_TOKEN:"pk.eyJ1IjoicmF5Y2hhc2VyIiwiYSI6IlFHWHVMSW8ifQ.emd44Ibp4cmT9YXitY1ziw",REACT_APP_GRAPHQL:"https://11w2bia702.execute-api.us-west-2.amazonaws.com/prod/api",REACT_APP_AWS_REGION:"us-west-2",REACT_APP_COGNITO_IDPOOLID:"us-west-2:ab544d6d-6ea9-430d-8c8f-d895ce172d0f",REACT_APP_COGNITO_USER_POOL_ID:"us-west-2_ninoe7B9g",REACT_APP_COGNITO_CLIENT_ID:"ndtqsua64n6qqp9hef5fh4560",REACT_APP_DOMAIN:"northarrowresearchlabs.github.io",REACT_APP_BASENAME:"photomon_v0"}).REACT_APP_BASEURL;console.log("config: ",_t,"photomon_v0");var Lt={FEED:"feed",MAP:"map",SEARCH:"search",PROFILE:"profile",SERIES:"series",QRCAPTURE:"QRCapture",NEW_SERIES_CAMERA:"new_series_camera",NEW_SERIES_LIBRARY:"new_series_library"},zt={TAG:"tag",LOCATION:"location",USER:"user"},Mt={FREE:"free",USER:"user",TAG:"tag"},Dt={graphql:"https://11w2bia702.execute-api.us-west-2.amazonaws.com/prod/api"},Ft={Auth:{region:"us-west-2",userPoolId:"us-west-2_ninoe7B9g",userPoolWebClientId:"ndtqsua64n6qqp9hef5fh4560",mandatorySignIn:!0,cookieStorage:{domain:"".concat("northarrowresearchlabs.github.io"),expires:20,secure:!1}}},Bt={OPEN:{label:"Open",description:"Anyone can see and contribute photos to this series.",color:It.a},PRIVATE:{label:"Private",description:"Can only be seen by you.",color:Pt.a},PUBLIC:{label:"Public",description:"Anyone can see this series. Only the owner can add photos.",color:Tt.a}},Ut=a(61),$t=a(200),Wt=a.n($t);Wt.a.config({storeName:"MorPhoto",description:"image blobs"});var Gt=Wt.a.createInstance({name:"imgStore"}),qt=Wt.a.createInstance({name:"apolloStore"}),Ht=Wt.a.createInstance({name:"reduxStore"}),Yt=a(982),Vt=a(892),Qt=a(446);wt.a.configure(Ft);var Xt="apollo-token";var Zt=function(){var e=Object(n.useState)(null),t=Object(Pe.a)(e,2),a=t[0],r=t[1],o=Object(n.useState)(!1),i=Object(Pe.a)(o,2),l=i[0],c=i[1];return Object(n.useEffect)(function(){!function(e){Kt.apply(this,arguments)}(function(e,t){r(e),c(t)})},[]),{client:a,loaded:l}},Jt=function(){var e=Object(ft.a)(bt.a.mark(function e(){var t;return bt.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,xt.Auth.currentSession();case 3:return t=e.sent,e.abrupt("return",t.accessToken.jwtToken);case 7:return e.prev=7,e.t0=e.catch(0),e.abrupt("return",null);case 10:case"end":return e.stop()}},e,null,[[0,7]])}));return function(){return e.apply(this,arguments)}}();function Kt(){return(Kt=Object(ft.a)(bt.a.mark(function e(t){var a,n,r,o;return bt.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=new Yt.a({}),e.prev=1,e.next=4,Object(Qt.persistCache)({cache:a,storage:qt});case 4:e.next=11;break;case 6:return e.prev=6,e.t0=e.catch(1),console.error("Error restoring Apollo cache",e.t0),t(null,!1),e.abrupt("return");case 11:n=Object(vt.a)(function(){var e=Object(ft.a)(bt.a.mark(function e(t,a){var n,r,o;return bt.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.headers,e.next=3,Jt();case 3:return r=e.sent,o=Object(l.a)({},n,{authorization:r?"Bearer ".concat(r):""}),e.abrupt("return",{headers:o});case 7:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}()),r=Object(yt.a)({uri:Dt.graphql}),console.log("Creating Apollo Client Client",Dt.graphql),o=new Vt.a({link:Ut.a.from([n,r]),tokenName:Xt,cache:a,connectToDevTools:!1}),t(o,!0);case 16:case"end":return e.stop()}},e,null,[[1,6]])}))).apply(this,arguments)}var ea=a(12),ta=a(298),aa=a.n(ta),na=a(121),ra=a(948),oa=function(e){return{root:{},spacer:{flexGrow:1},forgotPassword:{width:"100%",textAlign:"right"},switch:{},switchButton:{flexGrow:1,"&:last-child":{borderRadius:0},"&:first-child":{borderRadius:0}},phoneNumInner:{marginTop:e.spacing(1),display:"flex"},phoneNumDropdown:{margin:e.spacing(1),minWidth:120},warnText:{marginTop:e.spacing(2),fontStyle:"italic"},noSignin:{margin:e.spacing(2,0),padding:e.spacing(1),textAlign:"left",border:"1px solid #00000022",background:"#0000000F"}}},ia=Object(he.a)(oa),la=function(e){var t=e.loading,a=e.handleSignup,n=(e.federated,e.handleForgotPassword),o=e.handleInputChange,i=e.handleBeAnonymous,l=e.handleSignIn,s=(Object(c.a)(e,["loading","handleSignup","federated","handleForgotPassword","handleInputChange","handleBeAnonymous","handleSignIn"]),ia());return r.a.createElement(Ee,null,r.a.createElement(Me.a,{id:"username",fullWidth:!0,key:"username",name:"username",label:"Username",color:"inherit",autoFocus:!0,className:s.textField,margin:"normal",onChange:o}),r.a.createElement(Me.a,{fullWidth:!0,id:"password",label:"Password",color:"inherit",key:"password",name:"password",type:"password",className:s.textField,autoComplete:"current-password",margin:"normal",onChange:o}),r.a.createElement(ra.a,{disableGutters:!0},r.a.createElement(Ae.a,{component:"button",color:"secondary",variant:"contained",disabled:t,onClick:a},"New Account"),r.a.createElement("div",{className:s.spacer}),r.a.createElement(Ae.a,{className:"enterAction",component:"button",color:"primary",variant:"contained",disabled:t,onClick:l},"Sign In")),r.a.createElement(Ae.a,{color:"primary",onClick:n,size:"small"},"Forgot Password"),r.a.createElement("div",{className:s.noSignin},r.a.createElement(Ae.a,{fullWidth:!0,size:"small",variant:"outlined",onClick:i,color:"inherit"},"Continue without logging in"),r.a.createElement(me.a,{variant:"caption",className:s.warnText,color:"textSecondary",component:"div"},"You will not be able to add content and many features will be unavailable.")))},ca=Object(he.a)(oa),sa=function(e){var t=e.handleInputChange,a=e.handleBack,n=e.handleConfirm,o=ca();return r.a.createElement(Ee,null,r.a.createElement(Me.a,{id:"mfaCode",fullWidth:!0,autoFocus:!0,label:"MFA Code",name:"code",className:o.textField,margin:"normal",onChange:t}),r.a.createElement(ra.a,{disableGutters:!0},r.a.createElement(Ae.a,{color:"secondary",variant:"contained",onClick:a},"Back"),r.a.createElement("div",{className:o.spacer}),r.a.createElement(Ae.a,{className:"enterAction",color:"primary",variant:"contained",onClick:n},"Confirm")))},ua=Object(he.a)(oa),pa=function(e){var t=e.change,a=e.requiredAttributes,n=e.placeholders,o=e.handleInputChange,i=ua();return r.a.createElement(Ee,null,r.a.createElement(me.a,null,"A new password is required"),r.a.createElement(Me.a,{id:"newassword",fullWidth:!0,autoFocus:!0,label:"New Password",className:i.textField,type:"password",autoComplete:"new-password",margin:"normal",onChange:o}),a.map(function(e,t){return r.a.createElement(Me.a,{fullWidth:!0,key:e,name:e,className:i.textField,placeholder:n[t],type:"text",margin:"normal",onChange:o})}),r.a.createElement(ra.a,{disableGutters:!0},r.a.createElement(Ae.a,{color:"secondary",variant:"contained"},"Back"),r.a.createElement("div",{className:i.spacer}),r.a.createElement(Ae.a,{color:"primary",variant:"contained",onClick:t,className:"enterAction"},"Change")))},da=a(936),ma=a(937),ga=a(973),ha=Object(he.a)(oa),ba=function(e){var t=e.handleInputChange,a=e.signUpFields,o=e.signUpFieldLabels,i=e.signUpFieldPlaceholders,l=e.handleSignup,c=e.handleBack,s=e.countryDialCodes,u=e.defaultDialCode;console.log("SIGNUPPROPS",{defaultDialCode:u,countryDialCodes:s,signUpFields:a,signUpFieldLabels:o,signUpFieldPlaceholders:i});var p=Object(n.useState)(u),d=Object(Pe.a)(p,2),m=d[0],g=d[1],h=ha(),b=function(e){t(e),g(e.target.value)};return r.a.createElement(Ee,null,a.map(function(e,n){return"phone_number"!==e.key?r.a.createElement(Me.a,{fullWidth:!0,autoFocus:0===a.findIndex(function(t){return t.key===e.key}),type:e.type,name:e.key,key:e.key,placeholder:i[n],label:o[n],className:h.textField,margin:"normal",onChange:t}):r.a.createElement(da.a,{className:h.phoneNumDropdown,fullWidth:!0,key:"phonenum"},r.a.createElement(ma.a,{htmlFor:"dial_code",shrink:!0},o[n],e.required?"*":""),r.a.createElement("div",{className:h.phoneNumInner},r.a.createElement(ga.a,{value:m,onChange:b,inputProps:{name:"dial_code",id:"dial_code"}},s.map(function(e){return r.a.createElement("option",{key:e,value:e},e)})),r.a.createElement(Me.a,{placeholder:i[n],type:"tel",fullWidth:!0,id:"phone_line_number",key:"phone_line_number",name:"phone_line_number",onChange:t})))}),r.a.createElement(ra.a,{disableGutters:!0},r.a.createElement(Ae.a,{color:"secondary",variant:"outlined",onClick:c},"Back"),r.a.createElement("div",{className:h.spacer}),r.a.createElement(Ae.a,{className:"enterAction",component:"button",color:"primary",variant:"contained",onClick:l},"Create Account")))},fa=a(949),ya=Object(he.a)(oa),va=function(e){var t=e.handleInputChange,a=e.handleBack,n=e.handleResend,o=e.handleConfirm,i=ya();return r.a.createElement(Ee,null,r.a.createElement(Me.a,{id:"username",fullWidth:!0,autoFocus:!0,name:"username",label:"Username",className:i.textField,margin:"normal",onChange:t}),r.a.createElement(Me.a,{id:"confirmationCode",fullWidth:!0,name:"code",label:"Confirmation Code",className:i.textField,margin:"normal",onChange:t}),r.a.createElement(fa.a,{component:"button",variant:"body2",className:i.resendCode,onClick:n},"Resend Code"),r.a.createElement(ra.a,{disableGutters:!0},r.a.createElement(Ae.a,{color:"secondary",variant:"outlined",onClick:a},"Back"),r.a.createElement("div",{className:i.spacer}),r.a.createElement(Ae.a,{color:"primary",variant:"contained",className:"enterAction",onClick:o},"Sign In")))},xa=Object(he.a)(oa),wa=function(e){var t=e.handleSubmit,a=e.handleInputChange,o=e.handleSendCode,i=e.handleBack,l=Object(n.useState)(!1),c=Object(Pe.a)(l,2),s=c[0],u=c[1],p=xa();return r.a.createElement(Ee,null,r.a.createElement(me.a,null,"Forgot Password"),!s&&r.a.createElement(Me.a,{id:"username",autoFocus:!0,fullWidth:!0,label:"Username",name:"username",className:p.textField,margin:"normal",onChange:a}),s&&r.a.createElement(Me.a,{id:"changecode",fullWidth:!0,autoFocus:!0,label:"Code",name:"code",className:p.textField,margin:"normal",onChange:a}),s&&r.a.createElement(Me.a,{id:"newpassword",fullWidth:!0,label:"New Password",className:p.textField,type:"password",name:"password",autoComplete:"current-password",margin:"normal",onChange:a}),s&&r.a.createElement(fa.a,{component:"button",variant:"body2",className:p.resendCode,onClick:o},"Resend Code"),r.a.createElement(ra.a,{disableGutters:!0},r.a.createElement(Ae.a,{color:"secondary",variant:"outlined",onClick:function(){s?u(!1):i()}},"Back"),r.a.createElement("div",{className:p.spacer}),!s&&r.a.createElement(Ae.a,{color:"primary",variant:"contained",className:"enterAction",onClick:function(){u(!0),o()}},"Send Code"),s&&r.a.createElement(Ae.a,{className:"enterAction",color:"primary",variant:"contained",onClick:t},"Submit")))};wt.a.configure(Ft);var Ea={authState:"init",authData:{},signedIn:null},Oa=function(){var e=Object(n.useState)(Ea),t=Object(Pe.a)(e,2),a=t[0],o=a.authState,i=a.authData,l=a.signedIn,c=t[1],s=function(){var e=Object(ft.a)(bt.a.mark(function e(){var t;return bt.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,xt.Auth.currentSession();case 2:return t=e.sent,console.log("here",t.accessToken),e.abrupt("return",t&&t.accessToken?t.accessToken:null);case 5:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),u=l?null:r.a.createElement(na.Authenticator,{onStateChange:function(e,t){c({authState:e,authData:t,signedIn:e&&0!==e.length?"signedIn"===e||l:null})},hideDefault:!0},r.a.createElement(ka,{handleBeAnonymous:function(){c({authState:o,authData:i,signedIn:!1})}}),r.a.createElement(Ia,{message:"Loggin in"}),r.a.createElement(Na,null),r.a.createElement(ja,null),r.a.createElement(Ca,null),r.a.createElement(na.VerifyContact,null),r.a.createElement(Pa,null),r.a.createElement(Sa,null)),p=!1;try{p=i.signInUserSession.idToken.payload["cognito:groups"].indexOf("GodUsers")>-1}catch(d){}return{authState:o,authData:i,isGod:p,signOut:function(){return xt.Auth.signOut().then(function(e){return console.log(e)}).catch(function(e){return console.log(e)})},getCurrentToken:s,forceSignIn:function(){return c(Ea)},signedIn:l,authScreen:u}},ka=function(e){function t(){return Object(ke.a)(this,t),Object(je.a)(this,Object(Ce.a)(t).apply(this,arguments))}return Object(Ne.a)(t,e),Object(Se.a)(t,[{key:"showComponent",value:function(){var e=this,t=this.state.loading,a=Object(l.a)({},this.props,{loading:t,handleForgotPassword:function(){return e.changeState("forgotPassword")},handleSignup:function(){return e.changeState("signUp")},handleInputChange:this.handleInputChange,handleSignIn:this.signIn});return r.a.createElement(la,a)}}]),t}(na.SignIn),Sa=function(e){function t(){return Object(ke.a)(this,t),Object(je.a)(this,Object(Ce.a)(t).apply(this,arguments))}return Object(Ne.a)(t,e),Object(Se.a)(t,[{key:"showComponent",value:function(){var e=this,a=this.props.hide;if(a&&a.includes(t))return null;this.checkCustomSignUpFields()&&(this.signUpFields=this.props.signUpConfig.signUpFields),this.sortFields();var n=Object(l.a)({},this.props,{countryDialCodes:aa.a,defaultDialCode:this.getDefaultDialCode(),handleInputChange:this.handleInputChange,signUpFields:this.signUpFields,signUpFieldLabels:this.signUpFields.map(function(e){return ea.I18n.get(e.label)}),signUpFieldPlaceholders:this.signUpFields.map(function(e){return ea.I18n.get(e.placeholder)}),handleSignup:this.signUp,handleBack:function(){return e.changeState("signIn")}});return r.a.createElement(ba,n)}}]),t}(na.SignUp),ja=function(e){function t(){return Object(ke.a)(this,t),Object(je.a)(this,Object(Ce.a)(t).apply(this,arguments))}return Object(Ne.a)(t,e),Object(Se.a)(t,[{key:"showComponent",value:function(){var e=this,t=Object(l.a)({},this.props,{handleBack:function(){return e.changeState("signIn")},handleInputChange:this.handleInputChange,handleConfirm:this.confirm});return r.a.createElement(sa,t)}}]),t}(na.ConfirmSignIn),Ca=function(e){function t(){return Object(ke.a)(this,t),Object(je.a)(this,Object(Ce.a)(t).apply(this,arguments))}return Object(Ne.a)(t,e),Object(Se.a)(t,[{key:"showComponent",value:function(){var e=this,t=Object(l.a)({},this.props,{handleBack:function(){return e.changeState("signIn")},handleInputChange:this.handleInputChange,handleConfirm:this.confirm,handleResend:this.resend});return r.a.createElement(va,t)}}]),t}(na.ConfirmSignUp),Na=function(e){function t(){return Object(ke.a)(this,t),Object(je.a)(this,Object(Ce.a)(t).apply(this,arguments))}return Object(Ne.a)(t,e),Object(Se.a)(t,[{key:"showComponent",value:function(){var e=this.props.authData.challengeParam.requiredAttributes,t=Array.isArray(e)?e.map(function(e){return ea.I18n.get(e.split("_").map(function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}).join(" "))}):[],a=Object(l.a)({},this.props,{handleInputChange:this.handleInputChange,requiredAttributes:e,placeholders:t,change:this.change});return r.a.createElement(pa,a)}}]),t}(na.RequireNewPassword),Ia=function(e){function t(){return Object(ke.a)(this,t),Object(je.a)(this,Object(Ce.a)(t).apply(this,arguments))}return Object(Ne.a)(t,e),Object(Se.a)(t,[{key:"showComponent",value:function(){return r.a.createElement(Oe,this.props)}}]),t}(na.Loading),Pa=function(e){function t(){return Object(ke.a)(this,t),Object(je.a)(this,Object(Ce.a)(t).apply(this,arguments))}return Object(Ne.a)(t,e),Object(Se.a)(t,[{key:"showComponent",value:function(){var e=this,t=Object(l.a)({},this.props,{handleBack:function(){return e.changeState("signIn")},handleInputChange:this.handleInputChange,handleConfirm:this.confirm,handleResend:this.send,handleSubmit:this.submit,handleSendCode:this.send});return r.a.createElement(wa,t)}}]),t}(na.ForgotPassword);var Ta=function(){var e=Object(n.useState)({accuracy:null,altitude:null,altitudeAccuracy:null,heading:null,latitude:null,longitude:null,speed:null,timestamp:Date.now()}),t=Object(Pe.a)(e,2),a=t[0],r=t[1],o=Object(n.useRef)(),i=Object(n.useRef)();o.current=!0;var l=function(e){o.current&&r({accuracy:e.coords.accuracy,altitude:e.coords.altitude,altitudeAccuracy:e.coords.altitudeAccuracy,heading:e.coords.heading,latitude:e.coords.latitude,longitude:e.coords.longitude,speed:e.coords.speed,timestamp:e.timestamp})};return Object(n.useEffect)(function(){return navigator.geolocation.getCurrentPosition(l),i.current=navigator.geolocation.watchPosition(l),function(){o.current=!1,navigator.geolocation.clearWatch(i.current)}},[navigator.geolocation]),a};var Aa=function(){return/iphone|ipad|ipod/i.test(window.navigator.userAgent||navigator.vendor||window.opera||"")},Ra=a(985),_a=a(928),La=Object(he.a)(function(e){return{root:{},content:{},messageWrapper:{display:"flex"},logo:{height:50,width:50},paper:{background:e.palette.text.primary,color:e.palette.primary.contrastText,border:"2px solid ".concat(e.palette.primary.contrastText),boxShadow:"0 0 0 0 ".concat(e.palette.primary.main),animation:"$installPulse 2s infinite",padding:e.spacing(2,3),width:"100%"},"@keyframes installPulse":{"0%":{boxShadow:"0 0 0 0px ".concat(e.palette.primary.main)},"50%":{boxShadow:"0 0 0 0px ".concat(e.palette.primary.main)},"100%":{boxShadow:"0 0 0 20px transparent"}},textWrapper:{flexGrow:1,paddingLeft:e.spacing(1)},buttons:{display:"flex"},spacer:{flexGrow:1}}}),za=function(e){var t=e.open,a=e.onClose,n=e.onInstall,o=La();return r.a.createElement(Ra.a,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:t,onClose:a},r.a.createElement(_a.a,{className:o.paper,elevation:24},r.a.createElement("div",{id:"client-snackbar",className:o.messageWrapper},r.a.createElement(ve,{className:o.logo}),r.a.createElement("div",{className:o.textWrapper},r.a.createElement(me.a,{variant:"body1",color:"inherit"},"Install MorPhoto"),r.a.createElement(me.a,{variant:"body2",color:"inherit",paragraph:!0},"This app can be installed and used on your device natively and offline if you would like."),r.a.createElement("div",{className:o.buttons},r.a.createElement(Ae.a,{color:"secondary",variant:"contained",onClick:a},"No thanks"),r.a.createElement("div",{className:o.spacer}),r.a.createElement(Ae.a,{color:"primary",variant:"contained",onClick:n},"Install"))))))},Ma=function(e,t){var a=Object(n.useState)(null),o=Object(Pe.a)(a,2),i=o[0],l=o[1],c=function(e){e.preventDefault(),l(e)},s=Object(n.useMemo)(function(){return e&&i?r.a.createElement(za,{open:!0,onClose:t,onInstall:u}):null},[e,i]);function u(){i.prompt(),i.userChoice.then(function(e){"accepted"===e.outcome?(console.log("User accepted the A2HS prompt"),t()):(console.log("User dismissed the A2HS prompt"),t()),l(null)})}return Object(n.useEffect)(function(){return!Aa()||"standalone"in window.navigator&&window.navigator.standalone||console.log("I AM on IOS and I am NOT in standalone mode."),window.addEventListener("beforeinstallprompt",c),function(){window.removeEventListener("beforeinstallprompt",c)}},[]),{installPrompt:s,addToHomeScreen:s?u:null}},Da=function(){var e=Object(n.useState)(null),t=Object(Pe.a)(e,2),a=t[0],r=t[1],o=function(){console.log("ONLINE"),r(null)},i=function(){console.log("OFFLINE");var e=Date.now();r(e)};return Object(n.useEffect)(function(){return window.addEventListener("online",o),window.addEventListener("offline",i),function(){window.removeEventListener("online",o),window.removeEventListener("offline",i)}},[]),{online:null===a,offlineSince:a}},Fa=a(63),Ba=a(71),Ua="width=device-width, initial-scale=0.5, maximum-scale=0.5, user-scalable=0, shrink-to-fit=no",$a="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no",Wa=function(e){var t=window,a=t.orientation,n=t.innerWidth,r=t.innerHeight,o=t.screen,i=o.width,c=o.height,s=0!==[90,270].indexOf(a)?"portrait":"landscape",u=Aa(),p=function(){var e=window.navigator.userAgent||navigator.vendor||window.opera||"";return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(e.substr(0,4))}(),d={width:n,height:r},m={width:i,height:c};if(e&&"input"===window.document.activeElement.tagName.toLowerCase())console.log("preserving height"),d.height=e.windowSize.height;else{var g=Math.min(d.width,d.height),h=window.document.querySelector("meta[name=viewport]"),b=h.getAttribute("content").split(", ").reduce(function(e,t){var a=t.split("=");return Object(l.a)({},e,Object(Fa.a)({},a[0],a[1]))},{});g<350&&"1.0"===b["initial-scale"]?(console.log("ZOOM Making it Small"),h.setAttribute("content",Ua)):g>=350&&"0.5"===b["initial-scale"]&&(console.log("ZOOM Making it Large"),h.setAttribute("content",$a))}return{isPhone:p,isIos:u,orientation:s,windowSize:d,screenSize:m}},Ga=function(e){var t=Object(n.useState)(Wa()),a=Object(Pe.a)(t,2),r=a[0],o=a[1],i=Object(n.useCallback)(Object(Ba.a)(function(e){e&&(e.preventDefault(),e.stopPropagation());var t=Wa(r);console.log("handleResize",t),o(t)},500),[]);return Object(n.useLayoutEffect)(function(){return i(),window.addEventListener("resize",i),function(){window.removeEventListener("resize",i)}},[]),r},qa=a(448),Ha=a(73),Ya=a(303),Va=a(24),Qa="HOME_CHANGE_STATE",Xa="HOME_CHANGE_ACTIVE_SERIES",Za="HOME_STATE_BACK",Ja="MAP_HISTORY_POP",Ka="MAP_HISTORY_PUSH",en="MAP_HISTORY_CLEAR",tn="UPLOADER_START",an="UPLOADER_COMPLETE",nn="UPLOADER_UPDATE_PROGRESS",rn="SETFLAG",on=function(e,t){return{type:Qa,data:{newDomain:e,params:t}}},ln=function(){return{type:Za}},cn=function(e,t){return{type:rn,data:{flagName:e,flagVal:t}}},sn=function(){return{type:Ja}},un=function(e){return{type:Ka,data:e}},pn=function(){return{type:en}},dn=function(e){return{type:tn,data:e}},mn=function(){return{type:an}},gn=function(e){return{type:nn,data:e}},hn=[{mode:Mt.FREE,viewport:{latitude:36.80191008366581,longitude:-111.63999999999784,zoom:11}}],bn={history:[],current:{domain:Lt.FEED}},fn={store:[],activeUpload:null},yn={iOSWarning:Aa(),install:!0,useLoggedOut:!1},vn=Object(Ha.combineReducers)({map:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:hn,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.data;switch(a){case en:return e.length>0?[[e.length-1]]:[];case Ja:return e.slice(0,-1);case Ka:return[].concat(Object(Va.a)(e),[n]);default:return e}},home:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:bn,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.data,r=e.history,o=e.current;switch(a){case Za:var i=Object(Va.a)(r),c=i.length>0?i.pop():bn.current;return Object(l.a)({},e,{current:c,history:i});case Xa:var s=o.activeSeries,u=o.initialPhoto;return Object(l.a)({},e,{history:r,current:Object(l.a)({},o,{activeSeries:s||null,initialPhoto:s&&u?u:null})});case Qa:var p=n.newDomain,d=n.params||{},m=[].concat(Object(Va.a)(r),[o]);return Object(l.a)({},e,{history:m,current:Object(l.a)({},o,{domain:p},d)});default:return e}},uploader:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:fn,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.data,r=e.store,o=e.activeUpload;switch(a){case tn:return o?Object(l.a)({},e,{store:[].concat(Object(Va.a)(r),[n])}):Object(l.a)({},e,{activeUpload:n});case an:if(0===r.length)return Object(l.a)({},e,{activeUpload:null});var i=Object(Va.a)(r),c=i.pop();return Object(l.a)({},e,{store:i,activeUpload:c});case nn:return Object(l.a)({},e,{activeUpload:Object(l.a)({},o,n)});default:return e}},flags:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:yn,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.data;switch(a){case rn:var r=n.flagName,o=n.flagVal;return Object(l.a)({},e,Object(Fa.a)({},r,o));default:return e}}}),xn=a(306),wn={key:"root",storage:Ht},En=Object(xn.a)(wn,vn),On=function(){var e,t=Object(Ha.createStore)(En,e,Object(Ha.compose)(Object(Ha.applyMiddleware)(Ya.a)));return{store:t,persistor:Object(xn.b)(t)}},kn=function(e){return function(t){var a=On(),n=a.store,o=a.persistor;return r.a.createElement(Te.a,{store:n},r.a.createElement(qa.a,{loading:r.a.createElement(Oe,null),persistor:o},r.a.createElement(e,t)))}},Sn=a(14),jn=a.n(Sn),Cn=a(951),Nn=Object(he.a)(function(e){return{root:{background:"black",color:e.palette.primary.contrastText,padding:2*e.spacing(1)},message:{},msgText:{display:"flex"},spacer:{flexGrow:1},messageInner:{}}}),In=function(e){var t=e.className,a=e.text,n=e.progress,o=Nn();if(!a)return null;var i="Uploading: ".concat(a);return r.a.createElement("div",{className:jn()(o.root,t)},r.a.createElement("div",{className:o.messageInner},r.a.createElement("div",{className:o.msgText},r.a.createElement(me.a,{color:"inherit"},i),r.a.createElement("div",{className:o.spacer}),r.a.createElement(me.a,{color:"inherit"},n,"%")),r.a.createElement(Cn.a,{color:"secondary",variant:"determinate",value:n})))},Pn=In,Tn=function(e){var t=e.text,a=e.progress,n=An();return r.a.createElement("div",{className:n.root},r.a.createElement(ge.a,null)," ",r.a.createElement(_a.a,{className:n.paper},r.a.createElement(me.a,{variant:"h5"},"This is a dummy component.")),r.a.createElement(In,{text:t,progress:a}))},An=Object(he.a)(function(e){return{root:{height:"100%",display:"flex",flexDirection:"column"},paper:{flexGrow:1}}});Tn.displayName=In.displayName;var Rn=a(196),_n=a.n(Rn),Ln=a(449),zn=a.n(Ln);function Mn(){return(Mn=Object(ft.a)(bt.a.mark(function e(t,a,n){var r,o,i;return bt.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("UploadConntect: upload start",t),r=new zn.a,Object.keys(t.preAuth.fields).forEach(function(e){console.log("APPEND",e,t.preAuth.fields[e]),r.append(e,t.preAuth.fields[e])}),o=Gt.getItem(t.uploadToken),r.append("file",o),i={headers:{"Content-Type":"multipart/form-data"},onUploadProgress:function(e){var t=e.loaded,n=e.total;console.log("PROGRESSEVENT",t,n,Math.floor(100*t/n)),a({progress:Math.floor(100*t/n)})}},console.log("FORMDATA",r),e.next=9,_n.a.post(t.preAuth.url,r,i).catch(function(e){console.error(e),console.log(e.stack)});case 9:console.log("UploadConntect: upload done"),n();case 11:case"end":return e.stop()}},e)}))).apply(this,arguments)}_n.a.interceptors.request.use(function(e){return console.log("AXIOS:::: Starting Request",e),e},function(e){return console.log("AXIOS:::: Starting Request ERROR",e),Promise.reject(e)}),_n.a.interceptors.response.use(function(e){return console.log("AXIOS:::: Response",e),e},function(e){return console.log("AXIOS:::: Starting Response ERROR",e),Promise.reject(e)});var Dn=Object(Te.b)(function(e,t){return{activeUpload:e.uploader.activeUpload}},function(e){return{completeActiveUpload:function(){e(mn())},updateUploadProgress:function(t){e(gn(t))}}})(function(e){var t=e.activeUpload,a=e.completeActiveUpload,o=e.updateUploadProgress,i=Object(c.a)(e,["activeUpload","completeActiveUpload","updateUploadProgress"]),l=Object(n.useRef)();return Object(n.useEffect)(function(){l.current=l.current&&!!t,t&&!l.current&&function(e,t,a){Mn.apply(this,arguments)}(t,o,a)},[Boolean(t)]),t?r.a.createElement(Pn,Object.assign({text:"Uploading thing",progress:t.progress||0},i)):null}),Fn={admin:{series:{"create:own":["*"],"read:any":["*"],"update:any":["*"],"delete:any":["*"]},photo:{"create:any":["*"],"read:any":["*"],"update:any":["*"],"delete:any":["*"]}},nonuser:{photo:{"read:any":["*"],"update:any":["*"],"delete:any":["*"]},series_public:{"read:any":["*"]},series_open:{"read:any":["*"]}},user:{series:{"create:own":["*"],"read:own":["*"],"update:own":["*"],"delete:own":["*"]},series_public:{"read:any":["*"]},series_open:{"read:any":["*"],"update:any":["photos"]},photo:{"read:any":["*"],"create:own":["*"],"update:own":["*"],"delete:own":["*"]}}},Bn=a(966),Un=a(960),$n=a(971),Wn=a(967),Gn=a(102),qn=a.n(Gn),Hn=a(234),Yn=a.n(Hn),Vn=a(459),Qn=a.n(Vn),Xn=a(304),Zn=a.n(Xn),Jn=a(460),Kn=a.n(Jn),er=a(461),tr=a.n(er),ar=a(462),nr=a.n(ar),rr=a(450),or=a.n(rr),ir=r.a.createContext({}),lr=Object(he.a)(function(e){return{root:{},title:{textAlign:"center"},qrPaper:{padding:e.spacing(2)},qrCode:{width:"100%",height:400}}}),cr=function(e){var t=e.onClose,a=e.open,o=lr(),i=Object(n.useContext)(ir).series,l=Object(n.useState)(null),c=Object(Pe.a)(l,2),s=c[0],u=c[1],p={type:"series",id:i.id},d=encodeURI(JSON.stringify(p)),m="".concat("/photomon_v0","/?fromqr=").concat(d);return Object(n.useLayoutEffect)(function(){or.a.toString(m,function(e,t){e?console.error(e):u(t)})},[i]),r.a.createElement(Re.a,{open:a,onClose:t,className:o.root},r.a.createElement(_a.a,{className:o.qrPaper},r.a.createElement(me.a,{variant:"subtitle1",component:"div",className:o.title},i.name),r.a.createElement("svg",{className:o.qrCode,dangerouslySetInnerHTML:{__html:s}}),i.coords&&r.a.createElement(me.a,{component:"div",className:o.title},"[ ",i.coords[0],", ",i.coords[1]," ]")))},sr=ye()(r.a.createElement(r.a.Fragment,null,r.a.createElement("path",{d:"M22,2l0,20l-20,0l0,-20l20,0Zm-2,2l-16,0l0,16l16,0l0,-16Z"}),r.a.createElement("rect",{x:"5",y:"5",width:"4",height:"4"}),r.a.createElement("rect",{x:"15",y:"5",width:"4",height:"4"}),r.a.createElement("rect",{x:"5",y:"15",width:"4",height:"4"}),r.a.createElement("rect",{x:"10",y:"10",width:"1",height:"5"}),r.a.createElement("rect",{x:"11",y:"10",width:"6",height:"2"}),r.a.createElement("rect",{x:"11",y:"12",width:"2",height:"2"}),r.a.createElement("rect",{x:"13",y:"7",width:"1",height:"2"}),r.a.createElement("rect",{x:"14",y:"9",width:"1",height:"1"}),r.a.createElement("rect",{x:"8",y:"10",width:"1",height:"4"}),r.a.createElement("rect",{x:"7",y:"11",width:"1",height:"3"}),r.a.createElement("rect",{x:"9",y:"11",width:"1",height:"1"}),r.a.createElement("rect",{x:"10",y:"6",width:"2",height:"3"}),r.a.createElement("rect",{x:"12",y:"7",width:"1",height:"1"}),r.a.createElement("rect",{x:"15",y:"14",width:"2",height:"4"}),r.a.createElement("rect",{x:"14",y:"14",width:"1",height:"1"}),r.a.createElement("rect",{x:"17",y:"15",width:"2",height:"2"}),r.a.createElement("rect",{x:"11",y:"16",width:"1",height:"3"}),r.a.createElement("rect",{x:"12",y:"15",width:"2",height:"2"}),r.a.createElement("rect",{x:"10",y:"18",width:"1",height:"1"})),"QRCode"),ur=a(85),pr=a(198),dr=a(194),mr=a(891),gr=function(e,t,a){return e?t?{width:Math.max(t.width,e.offsetWidth),height:Math.max(t.height,e.offsetHeight)}:{width:e.offsetWidth,height:e.offsetHeight}:a||t||{width:0,height:0}},hr=function(e,t,a){var r=Object(n.useRef)(),o=Object(n.useState)(!0),i=Object(Pe.a)(o,2),l=i[0],c=i[1];r.current=l;var s=Object(n.useState)(gr(e?e.current:null,t,a)),u=Object(Pe.a)(s,2),p=u[0],d=u[1],m=function(){if(r.current&&e.current){var n=gr(e.current,t,a);n.height===p.height&&n.width===p.width||d(n)}},g=Object(n.useCallback)(Object(Ba.a)(m,500),[]);return Object(n.useLayoutEffect)(function(){if(e.current){if(m(),"function"===typeof ResizeObserver){var t=new ResizeObserver(g);return t.observe(e.current),function(){t.disconnect(e.current),t=null}}return window.addEventListener("resize",g),function(){window.removeEventListener("resize",g)}}},[e.current]),{size:p,setResizeActive:c}},br=Object(he.a)(function(e){return{root:{width:1,height:1,zIndex:1},svgDot:{width:20,height:20,position:"absolute",top:"50%",left:"50%",textAlign:"center",transformOrigin:"50% 50%",transform:"translateY(-50%) translateX(-50%)"},svgAccuracyDot:{position:"absolute",top:"50%",left:"50%",textAlign:"center",transformOrigin:"50% 50%",transform:"translateY(-50%) translateX(-50%)"}}}),fr=function(e){e.position;var t=e.projection,a=br(),n=20*t.pixelsPerMeter[0],o=20*t.pixelsPerMeter[1];return r.a.createElement("div",{className:a.root},r.a.createElement("svg",{style:{height:n,width:o},className:a.svgAccuracyDot,version:"1.1",viewBox:"0, 0, 100, 100"},r.a.createElement("circle",{cx:"50",cy:"50",r:49,stroke:"#8888FF",fillOpacity:"0.4",strokeWidth:"1",fill:"#AAAAFF"})),r.a.createElement("svg",{className:a.svgDot,version:"1.1",viewBox:"0, 0, 10, 10"},r.a.createElement("circle",{cx:"5",cy:"5",r:"4",stroke:"#FFFFFF",strokeWidth:"1",fill:"#4444FF"})))},yr=a(978),vr=a(977),xr=a(952),wr=Object(he.a)(function(e){return{root:{zIndex:10,position:"absolute"},speedDialFab:{border:"2px solid",background:e.palette.text.primary,color:e.palette.primary.contrastText,width:40,height:40},speedDialAction:{border:"2px solid",background:e.palette.primary.main,color:e.palette.primary.contrastText,marginTop:0,marginBottom:0},speedDialIcon:{},speedDialLabel:{background:"black",color:"white"},actionsClosed:{display:"none"}}}),Er=function(e){var t=e.controlPadding,a=e.currStyle,o=e.mapStyles,i=e.setCurrStyle,l=Object(n.useState)(!1),c=Object(Pe.a)(l,2),s=c[0],u=c[1],p=wr(),d=Object(xr.a)(),m=function(e,t){console.log("noEventSetOpen",e,t),e.preventDefault(),e.stopPropagation(),u(t)};if(!o||!Array.isArray(o)||o.length<2||!o[a])return null;var g=o[a].ActiveIcon;return r.a.createElement("div",{className:p.root,style:{top:t.top?t.top:d.spacing(2),right:t.right?t.right:d.spacing(2)}},o.length>1&&r.a.createElement(yr.a,{ariaLabel:"SpeedDial example",className:p.speedDial,classes:{fab:p.speedDialFab,actionsClosed:p.actionsClosed},icon:r.a.createElement(g,{className:p.icon}),onClick:function(e){return m(e,!s)},onClose:function(e){return m(e,!1)},open:s,direction:"left"},o.map(function(e,t){var a=e.Icon,n=(e.ActiveIcon,e.toolTip);return r.a.createElement(vr.a,{key:"stylebutton".concat(t),icon:r.a.createElement(a,{className:p.speedDialIcon}),tooltipPlacement:"bottom",ButtonProps:{classes:{root:p.speedDialAction}},TooltipClasses:{tooltip:p.speedDialLabel},tooltipTitle:n,tooltipOpen:!0,onClick:function(){console.log("SET",t),i(t),u(!1)}})})))};Er.defaultProps={controlPadding:{}};var Or=Er,kr=a(953),Sr=a(233),jr=a.n(Sr),Cr=Object(he.a)(function(e){return{root:{border:"1px solid",background:e.palette.grey[100],color:"black",width:40,height:40,zIndex:10,position:"absolute"}}}),Nr=function(e){var t=e.onClick,a=e.controlPadding,n=e.disabled,o=Cr(),i=Object(xr.a)();return r.a.createElement(kr.a,{disabled:n,style:{top:56+(a.top?a.top:i.spacing(2)),right:a.right?a.right:i.spacing(2)},"aria-label":"myLocation",className:o.root,onClick:t},r.a.createElement(jr.a,null))},Ir=(a(403),a(404),function(e){var t=e.showMe,a=e.children,o=e.mapStyles,i=e.controlPadding,s=e.viewport,u=e.bounds,p=e.lockToBounds,d=e.lockPan,m=e.initStyle,g=e.onViewportChange,h=e.onTransitionStart,b=e.onTransitionEnd,f=e.transitions,y=e.onMapDataEvent,v=e.stylechooser,x=Object(c.a)(e,["showMe","children","mapStyles","controlPadding","viewport","bounds","lockToBounds","lockPan","initStyle","onViewportChange","onTransitionStart","onTransitionEnd","transitions","onMapDataEvent","stylechooser"]),w=Object(n.useRef)(null),E=Object(n.useRef)(null),O=Object(n.useRef)(null),k=hr(w).size,S=Object(n.useState)(m),j=Object(Pe.a)(S,2),C=j[0],N=j[1],I=Object(n.useState)(Object(l.a)({},Tr,s)),P=Object(Pe.a)(I,2),T=P[0],A=P[1],R=Object(n.useState)(!1),_=Object(Pe.a)(R,2),L=_[0],z=_[1],M=Object(n.useState)(null),D=Object(Pe.a)(M,2),F=D[0],B=D[1],U={};t&&(U=Ta());var $=U.latitude&&U.longitude?r.a.createElement(ur.c,{key:"myPos",className:"myPosMarker",latitude:U.latitude,longitude:U.longitude,style:{zIndex:1}},r.a.createElement(fr,{position:U,projection:F})):null;Object(n.useMemo)(function(){if(!(!k||k.width<10||k.height<10)){o.length<=C&&N(m);try{var e=Object(dr.a)(T);B(e)}catch(t){console.log("ERROR",T),console.error(t)}}},[T.zoom,k]);var W=function(e){var t=Object(l.a)({},e);u&&p&&(t.longitude<u[0]?t.longitude=u[0]:t.longitude>u[2]&&(t.longitude=u[2]),t.latitude<u[1]?t.latitude=u[1]:t.latitude>u[3]&&(t.latitude=u[3])),d&&(t.latitude=T.latitude,t.longitude=T.longitude),L||"function"!==typeof g||g({viewport:t,size:k,projection:F,map:E.current&&E.current.getMap()}),A(t)};return Object(n.useMemo)(function(){if(!(!u||!k||k.width<10||k.height<10||L)){var e=Object(Pe.a)(u,4),t=e[0],a=e[1],n=e[2],r=e[3];try{console.log("recalcZoomBounds");var o=new mr.a(Object(l.a)({},k,T)).fitBounds([[t,a],[n,r]],{padding:40,offset:[0,0]}),i=o.longitude,c=o.latitude,s=o.zoom;console.log("Changing Zoom ",u,T.zoom,s,T),A(Object(l.a)({},T,{longitude:i,latitude:c,zoom:s}))}catch(p){console.error(p)}}},[k,u]),Object(n.useEffect)(function(){A(Object(l.a)({},T,s))},[s]),r.a.createElement("div",{className:jn()("mapContainer",e.className),ref:w},k.height>0&&k.width>0&&r.a.createElement(ur.f,Object.assign({},T,O.current||f,{ref:function(e){E.current=e},height:k.height,width:k.width,mapStyle:C<o.length?o[C].style:o[0].style,onData:y,onTransitionStart:function(){console.log("handleTransitionStart (internal)"),z(!0),"function"===typeof h&&h()},onTransitionEnd:function(){console.log("handleTransitionEnd (internal)"),z(!1),O.current=null,b&&b(),"function"===typeof g&&g({viewport:T,size:k,projection:F,map:E.current&&E.current.getMap()})},dragPan:!d,onViewportChange:W,mapboxApiAccessToken:Rt.mapBoxToken},x),a&&Array.isArray(a)?a.map(function(e,t){return e?r.a.cloneElement(Ar(e,T,k.height,k.width,F),{key:"mapChild-".concat(t)}):null}):Ar(a,T,k.height,k.width,F),v&&r.a.createElement(Or,{controlPadding:i,currStyle:C,mapStyles:o,setCurrStyle:N}),!e.hideNavControls&&r.a.createElement(ur.d,{onViewportChange:function(e){return W(Object(l.a)({},e,k))},showZoom:!1===!e.touchZoom&&!1===!e.scrollZoom,showCompass:!1===!e.touchRotate&&!1===!e.dragRotate}),t&&!d&&r.a.createElement(r.a.Fragment,null,$,r.a.createElement(Nr,{disabled:!U||!U.latitude,controlPadding:i,onClick:function(){U.latitude&&U.longitude&&(O.current={transitionDuration:2e3,transitionInterpolator:new ur.a,transitionEasing:pr.a},setTimeout(function(){O.current&&(O.current=null)},2e3),A(Object(l.a)({},T,{latitude:U.latitude,longitude:U.longitude,zoom:T.zoom>10?T.zoom:12})))}}))))});Ir.defaultProps={controlPadding:{},stylechooser:!0,initStyle:0,mapStyles:Rt.styles,lockToBounds:!1};var Pr=Ir,Tr={latitude:49.3050394,longitude:-123.1398254,bearing:0,pitch:0,zoom:12};function Ar(e,t,a,n,r){return"function"===typeof e?e(t,a,n,r):e}var Rr=Object(he.a)(function(e){return{root:{color:e.palette.primary.main,position:"absolute",top:"50%",left:"50%",textAlign:"center",transformOrigin:"50% 50%",transform:"translateY(-50%) translateX(-50%)",zIndex:1},rootActive:{zIndex:1e3},svgDot:{zIndex:102,width:20,height:20,position:"absolute",top:"50%",left:"50%",textAlign:"center",transformOrigin:"50% 50%",transform:"translateY(-50%) translateX(-50%)"},dot:{stroke:e.palette.secondary.contrastText,strokeWidth:"1",fill:e.palette.secondary.main},directionIndicator:{position:"absolute",left:"50%",zIndex:100},name:{color:"white",fontWeight:"bold",textShadow:"\n        0px 0px 4px #000000, \n        0px 0px 4px #000000 \n    ",zIndex:122,position:"relative"},nameActive:{color:e.palette.secondary.dark,textShadow:"\n    0px 0px 2px #FFFFFF, \n    0px 0px 2px #FFFFFF,\n    0px 0px 4px #FFFFFF \n"}}}),_r=function(e){var t=e.direction,a=Rr();return r.a.createElement("div",{className:a.root},r.a.createElement("svg",{className:a.svgDot,version:"1.1",viewBox:"0, 0, 10, 10"},r.a.createElement("circle",{cx:"5",cy:"5",r:"4",className:a.dot})),t&&t>=0?r.a.createElement("div",{className:a.directionIndicator},r.a.createElement("svg",{className:a.svgArc,version:"1.1",width:"100",height:"100",viewBox:"0, 0, 100, 100",style:{transform:"translateY(-50%) translateX(-50%) rotateZ(".concat(t,"deg)")}},r.a.createElement("path",{d:"M50,0 C60.946,0.151 72.136,3.514 80.675,10.56 L50,50 L19.325,10.56 C27.938,3.461 39,0.278 50,0 z",fill:"#009DC1",fillOpacity:"0.444",strokeWidth:"0.5",strokeOpacity:"0.6",stroke:"#FFFFFF"}))):null)},Lr=function(e){var t=e.controlPadding,a=e.viewport,o=e.children,i=e.mapStyles,l=e.onMapDataEvent,s=Object(c.a)(e,["controlPadding","viewport","children","mapStyles","onMapDataEvent"]),u=Object(n.useRef)(null),p=hr(u,{width:100,height:50}).size,d=Object(n.useState)(0),m=Object(Pe.a)(d,2),g=m[0],h=m[1],b=Object(n.useState)(null),f=Object(Pe.a)(b,2),y=f[0],v=f[1],x=function(){if(!(!p||p.width<10||p.height<10))try{var e=Object(dr.a)(a);v(e)}catch(t){console.error(t)}};return y||x(),Object(n.useMemo)(x,[p]),r.a.createElement("div",{className:jn()("BaseMap",e.className),ref:u,style:{height:"100%",width:"100%"}},r.a.createElement(ur.e,Object.assign({},a,{height:p.height,width:p.width,mapStyle:i[g].style,onData:l,mapboxApiAccessToken:Rt.mapBoxToken},s),i&&i.length>1?r.a.createElement(Or,{controlPadding:t,currStyle:g,mapStyles:i,setCurrStyle:h}):null,o&&Array.isArray(o)?o.map(function(e){return zr(e,a,p.height,p.width,y)}):zr(o,a,p.height,p.width,y)))};function zr(e,t,a,n,r){return"function"===typeof e?e(t,a,n,r):e}Lr.defaultProps={controlPadding:{},stylechooser:!0,initStyle:0,mapStyles:Rt.styles};var Mr=Lr,Dr=function(e){var t=e.staticMap,a=e.editable,n=e.latitude,o=e.longitude,i=e.onChange,l=e.direction,s=Object(c.a)(e,["staticMap","editable","latitude","longitude","onChange","direction"]),u=t?Mr:Pr,p=t?{}:{touchRotate:!1,dragRotate:!1,showMe:a,lockPan:!a,onViewportChange:i};return r.a.createElement(u,Object.assign({},p,s),n&&o?r.a.createElement(ur.c,{className:"singleMarker",latitude:n,longitude:o},r.a.createElement(_r,{direction:l})):r.a.createElement(_r,{direction:l}))},Fr=a(172),Br=a.n(Fr),Ur=Object(he.a)(function(e){var t=Object(ee.fade)(e.palette.secondary.light,.4);return{root:{},speedDialFab:{background:e.palette.secondary.main,color:e.palette.secondary.contrastText,"&::before":{content:'"  "',display:"block",position:"absolute",width:"100%",height:"100%",borderRadius:"inherit",boxShadow:"0 0 0 0 ".concat(t),animation:"$fabPulse 4s",animationIterationCount:5,animationTimingFunction:"linear"}},"@keyframes fabPulse":{"0%":{boxShadow:"0 0 0 0px ".concat(t)},"90%":{boxShadow:"0 0 0 0px ".concat(t)},"100%":{boxShadow:"0 0 0 10px transparent"}},directionUp:{},actionsClosed:{display:"none"}}}),$r=function(e){var t=e.className,a=e.children,o=e.onCameraClick,i=e.onLibraryClick,l=e.isIos,c=Object(n.useState)(!1),s=Object(Pe.a)(c,2),u=s[0],p=s[1],d=Object(n.useState)(!1),m=Object(Pe.a)(d,2),g=m[0],h=m[1],b=Object(n.useRef)(),f=Ur(),y=Object(n.useRef)(g);y.current=g,Object(n.useEffect)(function(){return function(){b.current&&(b.current=null)}});var v=function(e){e.currentTarget,h(!0),u||b.current||(b.current=setTimeout(function(){y.current&&p(!0),b.current=null},300))},x=function(e){e&&e.stopPropagation&&(e.stopPropagation(),e.preventDefault())},w=function(e){console.log("cameraclick"),p(!1),h(!1),o(),x(e)},E=function(e){console.log("libraryClick"),p(!1),h(!1),i(),x(e)};return l?r.a.createElement(Gr,{className:t,onLibraryClick:i,children:a}):r.a.createElement("div",{className:jn()(f.rootContainer,t)},r.a.createElement(yr.a,{ariaLabel:"SpeedDial photo adder",onBlur:function(e){setTimeout(function(){return p(!1)},250)},ButtonProps:{disableFocusRipple:!0},classes:{directionUp:f.directionUp,actionsClosed:f.actionsClosed,root:f.root,fab:jn()(f.speedDialFab,"fabanimation")},icon:a,onClick:function(e){x(e),h(!1),u||(console.log("cameraclick MAIN"),o())},onMouseDown:v,onTouchStart:v,open:u,direction:"up"},r.a.createElement(vr.a,{icon:r.a.createElement(Yn.a,{className:f.speedDialIcon}),tooltipPlacement:"right",tooltipTitle:"From Camera",tooltipOpen:!0,ButtonProps:{disableFocusRipple:!0},onClick:w,onMouseDown:v,onTouchStart:w}),r.a.createElement(vr.a,{icon:r.a.createElement(Br.a,{className:f.speedDialIcon}),tooltipPlacement:"right",tooltipTitle:"From Photo Library",tooltipOpen:!0,ButtonProps:{disableFocusRipple:!0},onClick:E,onMouseDown:v,onTouchStart:E})))},Wr=Object(he.a)(function(e){var t=Object(ee.fade)(e.palette.secondary.light,.4);return{root:{background:e.palette.secondary.main,color:e.palette.secondary.contrastText,"&::before":{content:'"  "',display:"block",position:"absolute",width:"100%",height:"100%",borderRadius:"inherit",boxShadow:"0 0 0 0 ".concat(t),animation:"$fabPulse 4s",animationIterationCount:5,animationTimingFunction:"linear"}},"@keyframes fabPulse":{"0%":{boxShadow:"0 0 0 0px ".concat(t)},"90%":{boxShadow:"0 0 0 0px ".concat(t)},"100%":{boxShadow:"0 0 0 10px transparent"}}}}),Gr=function(e){var t=e.className,a=e.children,n=e.onLibraryClick,o=Wr();return r.a.createElement(kr.a,{className:jn()(o.root,t),onClick:n,disableFocusRipple:!0},a)},qr=a(890),Hr=a(955),Yr=a(957),Vr=a(958),Qr=a(954),Xr=function(e){var t=e.anchorEl,a=e.onClose,n=e.menuItems;return r.a.createElement(qr.a,{anchorEl:t,open:!!t,onClose:a},n.map(function(e,t){var n=e.icon,o=e.color,i=e.text,l=e.hide,c=e.disabled,s=e.action,u=e.divider,p=n||null;return l?null:u?r.a.createElement(Qr.a,{key:"contextMenu-".concat(t)}):r.a.createElement(Hr.a,{key:"contextMenu-".concat(t),disabled:c,onClick:function(){a(),s()}},p&&r.a.createElement(Yr.a,null,r.a.createElement(p,{color:c?"disabled":o})),r.a.createElement(Vr.a,{primary:i,primaryTypographyProps:{color:o}}))}))},Zr=a(940),Jr=a(956),Kr=a(959),eo=a(762),to=a(938),ao=a(981),no=a(145),ro=a.n(no),oo=20,io=Object(he.a)(function(e){return{root:{fontSize:"0.6em",height:oo,marginRight:e.spacing(1)/2,marginTop:e.spacing(1)/2},deleteIcon:{width:oo-1,height:oo-1},chipAvatar:{width:oo,height:oo}}}),lo=function(e){var t=e.edit,a=e.tag,n=e.color,o=e.onDelete,i=Object(c.a)(e,["edit","tag","color","onDelete"]),l=io(),s=Object(xr.a)();return r.a.createElement(ao.a,Object.assign({style:{background:n||null,color:n?"".concat(s.palette.getContrastText(n)):null},label:a.label,data:a.id,onDelete:t?function(){return o(a)}:null,deleteIcon:r.a.createElement(ro.a,{className:l.deleteIcon,onClick:function(e){console.log("this click")},style:{opacity:.5,color:n?"".concat(s.palette.getContrastText(n)):null}}),className:l.root},i))},co=Object(he.a)(function(e){return{root:{position:"relative",display:"block",overflow:"hidden",whiteSpace:"pre-line","&::before":{content:'"  "',display:"block",position:"absolute",bottom:0,width:"100%",height:100,background:"linear-gradient(180deg, rgba(255,255,255,0) 0%, ".concat(e.palette.background.paper," 100%)")}}}}),so=function(e){var t=e.label,a=e.text,n=e.height,o=e.onClick,i=co();return r.a.createElement("div",{onClick:o},t&&r.a.createElement(to.a,{className:i.formLabel},t),r.a.createElement(me.a,{variant:"body1",color:"inherit",style:{height:n},className:jn()(i.root)},a))};so.defaultProps={height:100};var uo=so,po=Object(he.a)(function(e){return{root:{},imgContainer:{},gravatarImg:{objectFit:"cover",height:"100%",width:"100%"}}}),mo=function(e){var t=e.user,a=e.loading,n=e.onAvatarClick,o=e.secondary,i=po();return a||!t?"LOADING...":r.a.createElement(Jr.a,{className:i.root,button:!!n,onClick:n},r.a.createElement(Kr.a,{className:i.imgContainer},r.a.createElement(eo.a,null,r.a.createElement("img",{alt:"profile",className:i.gravatarImg,src:t.gravatar}))),r.a.createElement(Vr.a,{primary:t.username,secondary:o}))},go=a(146),ho=a.n(go),bo=Object(he.a)(function(e){return{root:{},body:{overflow:"hidden",whiteSpace:"pre-line",paddingBottom:e.spacing(1)},title:{alignSelf:"flex-start",width:"100%",margin:0,display:"flex",padding:e.spacing(2)},dlgTitle:{flexGrow:1},closeButton:{alignSelf:"flex-start",color:e.palette.grey[500]}}}),fo=function(e){var t=e.open,a=e.onClose,n=e.title,o=e.body,i=bo();return r.a.createElement(Re.a,{scroll:"paper",open:t,fullWidth:!0,maxWidth:"xl",onClose:a,"aria-labelledby":"simple-dialog-title"},r.a.createElement(_e.a,{className:i.title,disableTypography:!0},r.a.createElement(me.a,{className:i.dlgTitle},n),r.a.createElement(Un.a,{className:i.closeButton,onClick:a},r.a.createElement(ho.a,null))),r.a.createElement(Le.a,null,r.a.createElement(me.a,{variant:"body2",className:i.body},o)))},yo=a(49),vo=a(147),xo="NOTEVIEW",wo=Object(he.a)(function(e){return Object(l.a)({root:{margin:e.spacing(1),backgroundColor:e.palette.background.paper,paddingBottom:60},field:{marginBottom:e.spacing(1)},list:{padding:e.spacing(1)},heading:{marginTop:e.spacing(1)},watchers:{},numPhotos:{backgroundColor:e.palette.primary.main,color:e.palette.primary.contrastText},tagListItem:{marginTop:e.spacing(1),marginBottom:e.spacing(2)},chip:{margin:e.spacing(.5)},access:{padding:e.spacing(1),borderRadius:e.spacing(1)}},Object.keys(Bt).reduce(function(t,a){return Object(l.a)({},t,Object(Fa.a)({},a,{border:"1px solid ".concat(Bt[a].color[500]),background:"".concat(Bt[a].color[700]),color:e.palette.getContrastText(Bt[a].color[700])}))},{}))}),Eo=function(){var e=wo(),t=Object(n.useContext)(ir),a=t.series,o=t.seriesConfig,i=new vo.a(o),c=Object(n.useState)(null),s=Object(Pe.a)(c,2),u=s[0],p=s[1],d=a.photos.reduce(function(e,t){return t.tags.forEach(function(t){if(e[t.typeId])if(e[t.typeId][t.label]){var a=e[t.typeId][t.label];e[t.typeId][t.label]=Object(l.a)({},a,{count:a.count+1})}else e[t.typeId][t.label]=Object(l.a)({},t,{count:1});else e[t.typeId]=Object(Fa.a)({},t.label,Object(l.a)({},t,{count:1}))}),e},{}),m=[];try{m=a.meta?Object.keys(JSON.parse(a.meta)):[]}catch(g){console.error(g)}return r.a.createElement("div",{className:e.root},r.a.createElement("div",{className:e.field},r.a.createElement(to.a,{className:e.formLabel},"Series Name"),r.a.createElement(me.a,{variant:"body1",color:"inherit"},a.name)),a.note&&r.a.createElement(uo,{label:"Series Note",text:a.note,onClick:function(){return p(xo)}}),r.a.createElement(me.a,{className:e.heading,variant:"subtitle1"},"Series Summary"),r.a.createElement(Qr.a,null),r.a.createElement(Zr.a,{className:e.list,dense:!0},r.a.createElement(Jr.a,{className:jn()(e.access,e[a.access])},r.a.createElement(Vr.a,{color:"inherit",primary:"Series is ".concat(Bt[a.access].label),secondary:Bt[a.access].description})),a.createdUser&&r.a.createElement(mo,{user:a.createdUser,onAvatarClick:function(){return o.onAvatarClick(a.createdUser.username)},secondary:"created this series"}),r.a.createElement(Jr.a,null,r.a.createElement(Kr.a,null,r.a.createElement(eo.a,{className:e.numPhotos},a.photos.length)),r.a.createElement(Vr.a,{primary:a.photos.length>1?"Photos":"Photo",secondary:a.photos.length>0&&r.a.createElement("span",null,Object(yo.d)(a.photos[0].takenOn,"LL"),r.a.createElement("span",null,"\xa0\xa0"),"to",r.a.createElement("span",null,"\xa0\xa0"),Object(yo.d)(a.photos[a.photos.length-1].takenOn,"LL"))})),r.a.createElement(Jr.a,null,r.a.createElement(Kr.a,null,r.a.createElement(eo.a,{className:e.watchers},a.watchers)),r.a.createElement(Vr.a,{primary:"Users Watching"})),r.a.createElement(Jr.a,null,r.a.createElement(Vr.a,null,r.a.createElement(to.a,{className:e.formLabel},"Tags in use (across all photos)"),r.a.createElement(Qr.a,null),0===Object.keys(d).length&&r.a.createElement(me.a,{variant:"caption"},"No photos in this series have tags"),Object.keys(d).map(function(t,a){return r.a.createElement("div",{key:"tagchipkey".concat(a),className:e.tagListItem},r.a.createElement(me.a,{className:e.subheading,variant:"overline"},i.getTagType(t).label),r.a.createElement(Qr.a,null),Object.values(d[t]).length>0?Object.values(d[t]).map(function(e,n){return r.a.createElement(lo,{key:"tagchip-".concat(a,"-").concat(n),tag:e,color:i.getTagType(t).color})}):r.a.createElement(me.a,{variant:"caption"},"No photos in this series have tags"))})))),m.length>0&&Object.keys(o.meta).length>0&&r.a.createElement(r.a.Fragment,null,r.a.createElement(to.a,{className:e.formLabel},"Metadata"),r.a.createElement(Qr.a,null),r.a.createElement(Zr.a,{className:e.list},m.map(function(e,t){return o.meta[e]?r.a.createElement(Jr.a,{key:"metadata".concat(t)},r.a.createElement(Vr.a,{primary:o.meta[e].label,secondary:o.meta[e].render(a.meta[e])})):null}))),u===xo&&r.a.createElement(fo,{open:!0,multiline:!0,onClose:function(){return p(null)},title:"Series Note",body:a.note}))},Oo=a(963),ko=a(961),So=a(962),jo=a(115),Co=a.n(jo),No=a(150),Io=a.n(No),Po=a(149),To=a.n(Po),Ao=a(235),Ro=a.n(Ao),_o=a(176),Lo=a(455),zo=a.n(Lo),Mo=20,Do=Object(he.a)(function(e){return{xyTagChip:{cursor:"pointer",color:"white",fontSize:"0.6em",background:"#444444",height:Mo,position:"absolute",left:-Mo/2,top:-Mo/2},editing:{},reversedChip:{flexDirection:"row-reverse",left:"unset",right:-Mo/2},deleteIcon:{width:Mo-1,height:Mo-1},chipAvatarIcon:{color:"white",width:Mo-4,height:Mo-4},chipAvatar:{background:"inherit",width:Mo,height:Mo},reversedDelete:{margin:"0 -".concat(Mo/8,"px 0 ").concat(Mo/8,"px")},chipBucket:{width:1,height:1,display:"flex",flexDirection:"row",position:"absolute"},reversedChipBucket:{flexDirection:"row-reverse"}}}),Fo=function(e){var t=e.color,a=e.edit,n=e.tag,o=e.newSize,i=e.onTagDragOver,l=e.onTagDragStop,s=(e.onNewTag,e.onTagDelete),u=Object(c.a)(e,["color","edit","tag","newSize","onTagDragOver","onTagDragStop","onNewTag","onTagDelete"]),p=n.relCoords.x>o.newWidth/2,d=Do(),m=Object(xr.a)(),g=function(e){e.preventDefault(),e.stopPropagation()};return r.a.createElement(zo.a,{disabled:!a,bounds:{left:10,top:10,right:o.newWidth-10,bottom:o.newHeight-10},position:{x:n.relCoords.x,y:n.relCoords.y},onDrag:function(e,t){g(e),i(t,n)},onStop:function(e,t){g(e),l(t,n)},onClick:g},r.a.createElement("div",{className:jn()(d.chipBucket,p&&d.reversedChipBucket)},r.a.createElement(ao.a,Object.assign({style:{background:t?"".concat(t,"!important"):null,color:t?"".concat(m.palette.getContrastText(t),"!important"):null},color:a?"secondary":"default",label:n.label,data:n.id,onClick:g,onDelete:a?s(n):null,deleteIcon:a?r.a.createElement(ro.a,{className:jn()(d.deleteIcon,p&&d.reversedDelete)}):r.a.createElement("div",null),className:jn()(d.xyTagChip,p&&d.reversedChip,a&&d.editing)},u,{avatar:r.a.createElement(eo.a,{className:jn()(d.chipAvatar,a&&d.editing)},r.a.createElement(jr.a,{className:jn()(d.chipAvatarIcon,a&&d.editing)}))}))))},Bo=a(236),Uo=a(238),$o=a.n(Uo),Wo=Object(he.a)(function(e){return{root:{width:"100%"},noOptionsMessage:{padding:"".concat(e.spacing(1),"px ").concat(2*e.spacing(1),"px")},singleValue:{fontSize:16},placeholder:{position:"absolute",left:2,fontSize:16},input:{display:"flex",padding:0},valueContainer:{display:"flex",flexWrap:"wrap",flex:1,alignItems:"center",overflow:"hidden"},paper:{position:"absolute",zIndex:100,marginTop:e.spacing(1),left:0,right:0}}}),Go=function(e){var t=e.tagConfig,a=e.onChange,n=Wo(),o=t.values.map(function(e){return{label:e.label,value:e.id}});return console.log("XYTagSelect",t),r.a.createElement("div",{className:n.root},!t.allowAdditions&&r.a.createElement(Bo.a,{options:o,classes:n,components:{Control:qo,Menu:Yo,NoOptionsMessage:Ho,Option:Xo,Placeholder:Qo,ValueContainer:Zo},value:null,blurInputOnSelect:!0,isClearable:!1,onChange:a,placeholder:t.label,isSearchable:!0}),t.allowAdditions&&r.a.createElement($o.a,{options:o,classes:n,components:{Control:qo,Menu:Yo,NoOptionsMessage:Ho,Option:Xo,Placeholder:Qo,ValueContainer:Zo},value:null,isClearable:!1,blurInputOnSelect:!0,onChange:a,placeholder:t.label,isSearchable:!0}))};function qo(e){return r.a.createElement(Me.a,Object.assign({fullWidth:!0,InputProps:{inputComponent:Vo,inputProps:Object(l.a)({className:e.selectProps.classes.input,inputRef:e.innerRef,children:e.children},e.innerProps)}},e.selectProps.textFieldProps))}var Ho=function(e){var t=e.innerProps,a=e.selectProps,n=e.children;return r.a.createElement(me.a,Object.assign({color:"textSecondary",className:a.classes.noOptionsMessage},t),n)},Yo=function(e){var t=e.selectProps,a=e.innerProps,n=e.children;return r.a.createElement(_a.a,Object.assign({square:!0,className:t.classes.paper},a),n)},Vo=function(e){var t=e.inputRef,a=Object(c.a)(e,["inputRef"]);return r.a.createElement("div",Object.assign({ref:t},a))},Qo=function(e){return r.a.createElement(me.a,Object.assign({color:"textSecondary",className:e.selectProps.classes.placeholder},e.innerProps),e.children)},Xo=function(e){var t=e.innerRef,a=e.isFocused,n=e.isSelected,o=e.innerProps,i=e.children;return r.a.createElement(Hr.a,Object.assign({buttonRef:t,selected:a,component:"div",style:{fontWeight:n?500:400}},o),i)},Zo=function(e){var t=e.selectProps,a=e.children;return r.a.createElement("div",{className:t.classes.valueContainer},a)},Jo=Object(he.a)(function(e){return{root:{overflow:"visible"},header:{padding:2*e.spacing(1)},listItem:{flexDirection:"column"},dlgBody:{paddingLeft:2*e.spacing(1),paddingRight:2*e.spacing(1),paddingBottom:2*e.spacing(1)},closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]}}}),Ko=function(e){var t=e.coords,a=e.open,n=e.seriesConfig,o=e.onNewTag,i=e.onClose,l=Jo(),c=n.tags.filter(function(e){return e.allowXY});return t?r.a.createElement(Re.a,{open:a,scroll:"paper",fullScreen:!0,classes:{paperScrollPaper:l.root},onClose:function(){return i()},"aria-labelledby":"simple-dialog-title"},r.a.createElement(_e.a,{id:"simple-dialog-title",className:l.header},"New Tag:",r.a.createElement(Un.a,{className:l.closeButton,onClick:i},r.a.createElement(ho.a,null))),r.a.createElement("div",{className:l.dlgBody},c.length>1&&r.a.createElement(me.a,{variant:"caption"},"What kind of tag would you like to create?"),c.map(function(e,a){return r.a.createElement("div",{className:l.listItem,key:"tagSelect".concat(a)},r.a.createElement(Go,{tagConfig:e,onChange:o(t,e)}))}))):null},ei=function e(t,a){var n=this;Object(ke.a)(this,e),this.findTagById=function(e,t){return n.seriesConfig.getTagType(e).values.find(function(e){return e.id===t})},this.getXYTags=function(){var e=n.seriesConfig.getXYTagTypes().map(function(e){return e.id});return n.tags.filter(function(t){return e.indexOf(t.typeId)>-1&&t.coords&&t.coords.x})},this.getNonXYTags=function(){var e=n.seriesConfig.getNonXYTagTypes().map(function(e){return e.id});return n.tags.filter(function(t){return e.indexOf(t.typeId)>-1})},this.createNewTagObj=function(e,t){return{label:e,typeId:t}},this.createExistingTagObj=function(e,t){return Object(l.a)({},n.findTagById(t,e),{typeId:t})},this.createNewXYTagObj=function(e,t,a){return{label:e,typeId:t,coords:a}},this.createExistingXYTagObj=function(e,t,a){return Object(l.a)({},n.findTagById(t,e),{typeId:t,coords:a})},this.getRelXYTags=function(e){return n.getXYTags().map(function(t){return Object(l.a)({},t,{group:n.seriesConfig.getTagTypeIndex(t.typeId),relCoords:{x:t.coords.x*e,y:t.coords.y*e}})})},this.tags=a,this.seriesConfig=new vo.a(t)},ti=function(e,t,a,o){var i=Object(n.useContext)(ir).seriesConfig,c=Object(n.useState)(!1),s=Object(Pe.a)(c,2),u=s[0],p=s[1],d=Object(n.useState)(null),m=Object(Pe.a)(d,2),g=m[0],h=m[1],b=new ei(i,e.tags),f=function(t,n){return function(r){var o=r.value,i=r.__isNew__?b.createNewXYTagObj(o,n.id,t):b.createExistingXYTagObj(o,n.id,t);h(null),a(Object(l.a)({},e,{tags:[].concat(Object(Va.a)(e.tags),[i])}))}},y=function(a,n){var r=a.x,o=a.y;return e.tags.map(function(e){if(e.id!==n.id)return e;var a=parseInt(r/t.multiplier,10),i=parseInt(o/t.multiplier,10);return Object(l.a)({},e,{coords:{x:a,y:i}})})};return{onNewTag:f,onTagDelete:function(t){return function(){var n=e.tags.filter(function(e){return e.id!==t.id});a(Object(l.a)({},e,{tags:n}))}},onAddTagTrigger:function(e){g||(o(!1),h({x:parseInt(e.pageX-(window.innerWidth-t.newWidth)/2*t.multiplier,10),y:parseInt(e.pageY-(window.innerHeight-t.newHeight)/2*t.multiplier,10)}))},onTagDragOver:function(e,t){y(e,t),p(!0)},onTagDragStop:function(t,n){var r=y(t,n);p(!1),a(Object(l.a)({},e,{tags:r}))},TagChooser:function(){return r.a.createElement(Ko,{open:!u&&Boolean(g),coords:g,seriesConfig:i,onNewTag:f,onClose:function(){h(null),o(!0)}})},getRelXYTags:b.getRelXYTags}},ai=a(457),ni=a.n(ai),ri=Object(he.a)(function(e){return{root:{flexGrow:1,padding:"10%",display:"flex",flexDirection:"column",opacity:.3,textAlign:"center",color:e.palette.grey[100]},icon:{width:"100%",flex:"1 1 40%",color:e.palette.grey[100],opacity:.5},primary:{color:e.palette.grey[100],textAlign:"center",flex:"1 1 30%",width:"100%"},secondary:{flex:"1 1 30%",width:"100%"}}}),oi=function(){var e=ri();return r.a.createElement("div",{className:e.root},r.a.createElement(ni.a,{className:e.icon}),r.a.createElement(me.a,{className:e.primary},"Img not found"))},ii=Object(he.a)(function(e){return{root:{display:"block",position:"relative",width:"100%",height:"100%",background:"black",overflow:"hidden"},inner:{position:"absolute",top:"50%",left:"50%",transform:"translateY(-50%) translateX(-50%)",overflow:"hidden"},xyTags:{position:"absolute",top:0,left:0,height:"100%",width:"100%"},img:{display:"block"},brokenImg:{display:"none"},formControl:{width:"100%"}}}),li=function(e){var t=e.photo,a=e.opacity,o=e.edit,i=e.showTags,l=e.dataUrl,c=(e.transition,e.onChange),s=e.className,u=ii(),p=Object(n.useRef)(null),d=Object(n.useState)({multiplier:1}),m=Object(Pe.a)(d,2),g=m[0],h=m[1],b=Object(n.useState)(null),f=Object(Pe.a)(b,2),y=f[0],v=f[1],x=Object(n.useState)(!1),w=Object(Pe.a)(x,2),E=w[0],O=w[1],k=Object(n.useState)(0),S=Object(Pe.a)(k,2),j=S[0],C=S[1],N=Object(n.useContext)(ir).seriesConfig;Object(n.useEffect)(function(){function e(){return(e=Object(ft.a)(bt.a.mark(function e(){var a,n;return bt.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!l){e.next=4;break}v(l),e.next=13;break;case 4:if(0!==t.id.indexOf("__LOCAL_")){e.next=11;break}return e.next=7,Object(_o.c)(t.id);case 7:(a=e.sent)&&0===a.indexOf("data:image")?v(a):t.blob&&0===t.blob.indexOf("data:image")&&v(t.blob),e.next=13;break;case 11:n=N.getPhotoUrl(t,"large"),p.current&&v(n);case 13:case"end":return e.stop()}},e)}))).apply(this,arguments)}!function(){e.apply(this,arguments)}()},[t]);var I=hr(p),P=I.size,T=P.height,A=P.width,R=I.setResizeActive,_=j>0?"".concat(y,"?retry=").concat(j):y,L=ti(t,{height:T,width:A},c,R),z=L.onAddTagTrigger,M=L.TagChooser,D=L.getRelXYTags,F=L.onTagDragOver,B=L.onTagDragStop,U=L.onTagDelete;return r.a.createElement("div",{className:jn()(u.root,s),style:{opacity:null!==a?a:1},ref:p},r.a.createElement("div",{className:u.inner,style:{height:g?g.newHeight:1,width:g?g.newWidth:1},onClick:z},i||o?r.a.createElement("div",{className:s},D(g.multiplier).map(function(e,t){return r.a.createElement(Fo,Object.assign({key:"xytag-".concat(t),color:e.color},{edit:o,newSize:g,tag:e,onTagDragOver:F,onTagDragStop:B,onTagDelete:U}))})):null,E&&r.a.createElement(oi,null),r.a.createElement("img",{className:jn()(E?u.brokenImg:u.img),alt:_,onError:function(e){j<10&&(O(!0),console.log("Image Retry",j),console.error(e),setTimeout(function(){p.current&&C(j+1)},4e3))},src:_,onLoad:function(e){if(p.current){O(!1);var t=e.target,a=t.naturalHeight,n=t.naturalWidth,r=Math.min(T/a,A/n);h({newWidth:r*n,newHeight:r*a,naturalWidth:n,naturalHeight:a,multiplier:r})}},style:{height:g.newHeight,width:g.newWidth}})),o&&r.a.createElement(M,null))},ci=Object(he.a)(function(e){return{root:{position:"relative"},inner:{position:"relative"},photoWrapper:{minHeight:250,height:250},dateCaption:{padding:e.spacing(1),background:e.palette.primary.dark,color:e.palette.primary.contrastText,textAlign:"center"},mobileStepper:{},manualBack:{color:"white",zIndex:10,position:"absolute",transform:"translateY(-50%)",left:0,top:"50%"},manualForward:{color:"white",zIndex:10,position:"absolute",transform:"translateY(-50%)",right:0,top:"50%"},tagButton:{color:"rgba(255, 255, 255, 0.54)"},slideshowButton:{color:"rgba(255, 255, 255, 0.54)"},dots:{margin:"0 auto"}}}),si=function(e){var t=e.photos,a=e.initialPhoto,o=e.onImageSelect,i=ci(),l=Object(xr.a)(),c=a&&t.findIndex(function(e){return e.id===a})||0,s=Object(n.useState)(c>=0?c:0),u=Object(Pe.a)(s,2),p=u[0],d=u[1],m=Object(n.useState)(!1),g=Object(Pe.a)(m,2),h=g[0],b=g[1],f=t.length<2,y=Object(Va.a)(t);y.sort(function(e,t){return parseInt(t.takenOn,10)-parseInt(e.takenOn,10)});return r.a.createElement("div",{className:i.root},r.a.createElement("div",{className:i.inner},r.a.createElement(Ro.a,{axis:"rtl"===l.direction?"x-reverse":"x",index:p,onChangeIndex:function(e){return d(e)},enableMouseEvents:!0},y.map(function(e,t){return r.a.createElement("div",{className:i.photoWrapper,key:"swipeshowpic-".concat(t),onClick:function(){return o(y[p].id)}},r.a.createElement(li,{photo:e,className:i.photo,showTags:h}))})),r.a.createElement(Un.a,{size:"small",className:i.manualBack,onClick:function(){return d(p<=0?y.length-1:p-1)},color:"inherit",disabled:0===p},"rtl"===l.direction?r.a.createElement(To.a,null):r.a.createElement(Io.a,null)),r.a.createElement(Un.a,{size:"small",className:i.manualForward,onClick:function(){return d(p>=y.length?0:p+1)},color:"inherit",disabled:p===t.length-1},"rtl"===l.direction?r.a.createElement(Io.a,null):r.a.createElement(To.a,null)),r.a.createElement(ko.a,{title:f?"Photo":"Photo (".concat(p+1,"/").concat(y.length,")"),subtitle:y.length>0&&r.a.createElement("span",null,Object(yo.d)(y[p].takenOn)),actionIcon:r.a.createElement(r.a.Fragment,null,r.a.createElement(Un.a,{className:i.tagButton,onClick:function(){return b(!h)}},r.a.createElement(So.a,{color:h?"primary":"secondary",badgeContent:y[p].tags?y[p].tags.filter(function(e){return e.coords}).length:null},r.a.createElement(Co.a,null))))})),!f&&r.a.createElement(Oo.a,{steps:y.length,position:"static",activeStep:p,classes:{root:i.mobileStepper,dots:i.dots}}))};si.defaultProps={transition:5e3,isFullScreen:!1,slides:[]};var ui=si,pi=a(964),di=a(965),mi=a(239),gi=a.n(mi),hi=a(458),bi=a.n(hi),fi=Object(he.a)(function(e){return{}}),yi=function(e){var t=e.title,a=e.message,n=e.onConfirm,o=e.open,i=fi();return r.a.createElement(Re.a,{className:i.root,disableBackdropClick:!0,open:o,disableEscapeKeyDown:!0,maxWidth:"xl","aria-labelledby":"confirmation-dialog-title"},r.a.createElement(_e.a,{id:"confirmation-dialog-title"},t),r.a.createElement(Le.a,null,r.a.createElement(me.a,null,a)),r.a.createElement(De.a,null,r.a.createElement(Ae.a,{onClick:function(){return n(!1)},color:"primary"},"No"),r.a.createElement(Ae.a,{onClick:function(){return n(!0)},color:"primary"},"Yes")))},vi=Object(he.a)(function(e){return{root:{},tile:{},addFab:{position:"absolute",zIndex:10,top:e.spacing(1),left:e.spacing(1),opacity:.3},notDeleteable:{background:e.palette.primary.dark,opacity:.1},unSelectedTile:{"& img":{opacity:.7}},selectedTile:{padding:"".concat(e.spacing(2),"px!important"),"& img":{opacity:1}},img:{},snackbarContent:{backgroundColor:Pt.a[700]},snackbar:{}}}),xi=function(e){var t=e.photos,a=e.columns,o=e.multiSelect,i=e.onDelete,l=e.onTileClick,c=Object(n.useState)(!1),s=Object(Pe.a)(c,2),u=s[0],p=s[1],d=vi(),m=Object(n.useState)([]),g=Object(Pe.a)(m,2),h=g[0],b=g[1],f=Object(n.useState)(!1),y=Object(Pe.a)(f,2),v=y[0],x=y[1],w=Object(n.useContext)(ir),E=w.seriesConfig,O=w.ac,k=function(){p(!1),b([])},S=function(e){if(h.indexOf(e)<0)b([].concat(Object(Va.a)(h),[e]));else{var t=h.filter(function(t){return t!==e});0===t.length&&k(),b(t)}},j=Object(Va.a)(t);return j.sort(function(e,t){return parseInt(t.takenOn,10)-parseInt(e.takenOn,10)}),r.a.createElement("div",null,r.a.createElement(pi.a,{cols:a,cellHeight:200,className:d.root},j.map(function(e,t){var a=h.indexOf(e.id)>-1,n=O.canUser("delete",e,"photo"),i=E.getPhotoUrl(e,"thumb")||e.base64;return r.a.createElement(di.a,{key:"gridTile".concat(t),onClick:function(t){return n&&function(e,t){e.preventDefault(),e.stopPropagation(),u?S(t.id):l(t.id)}(t,e)},className:jn()(d.tile,u&&!n&&d.notDeleteable,u&&n&&!a&&d.unSelectedTile,u&&a&&d.selectedTile)},r.a.createElement("img",{src:i,alt:i,className:d.img}),n&&o&&r.a.createElement(kr.a,{size:"small","aria-label":"Add",className:d.addFab,onClick:function(t){return function(e,t){e.preventDefault(),e.stopPropagation(),p(!0),S(t)}(t,e.id)}},u&&a?r.a.createElement(bi.a,null):r.a.createElement(gi.a,null)),r.a.createElement(ko.a,{title:r.a.createElement("span",null,Object(yo.d)(e.takenOn))}))})),r.a.createElement(Ra.a,{open:u,autoHideDuration:null,ContentProps:{"aria-describedby":"snackbar-fab-message-id",className:d.snackbarContent},message:r.a.createElement("span",{id:"snackbar-fab-message-id"},h.length>=t.length?"You can't delete all the photos. delete the series instead.":"".concat(h.length," Photos selected")),action:r.a.createElement("div",null,r.a.createElement(Ae.a,{color:"inherit",disabled:h.length>=t.length,size:"small",onClick:function(){return x(!0)}},"Delete"),r.a.createElement(Ae.a,{color:"inherit",size:"small",onClick:function(){return k()}},"Cancel")),className:d.snackbar}),r.a.createElement(yi,{open:v,onConfirm:function(e){x(!1),!0===e&&h.length<t.length&&i(h),k()},title:"Delete ".concat(h.length," Photos"),message:"Are you sure you want to delete these photos?"}))};xi.defaultProps={multiSelect:!0,columns:2};var wi=xi,Ei=function(e){return{root:{display:"flex",height:"100%",flexDirection:"column",overflow:"hidden"},appBar:{flexGrow:0},inner:{position:"relative",flexGrow:1,overflowY:"scroll","-webkit-overflow-scrolling":"touch"},tabMenu:{marginTop:e.spacing(7)},mapWrap:{position:"absolute",height:"100%",width:"100%",top:0,left:0},toolbarTitle:{flexGrow:1,textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"},AddFab:{position:"absolute",bottom:e.spacing(2),right:e.spacing(2),zIndex:3e3},grow:{flexGrow:1},gridList:{flexWrap:"nowrap",transform:"translateZ(0)"},titleBar:{display:"flex",padding:e.spacing(1)},menuButton:{},placeholderInner:{position:"relative",flexGrow:1,overflow:"hidden",textAlign:"center",display:"flex",height:"100%",flexDirection:"column"},progressWrapper:{textAlign:"center",marginBottom:e.spacing(4)},placeholderText:{opacity:.4},placeholder:{},progress:{color:e.palette.grey[300]}}},Oi=Object(he.a)(Ei),ki=function(e){var t=e.onSlideshowStart,a=e.onChange,o=e.onEditSeries,i=e.onDeletePhotos,l=e.onCameraAdd,c=e.onDeleteSeries,s=e.onLibraryAdd,u=e.onTileClick,p=e.onMenuBack,d=e.onWatch,m=e.onUnWatch,g=e.initialPhoto,h=e.watching,b=e.owned,f=Oi(),y=Object(n.useState)(),v=Object(Pe.a)(y,2),x=v[0],w=v[1],E=Object(n.useState)(!1),O=Object(Pe.a)(E,2),k=O[0],S=O[1],j=Object(n.useState)(!1),C=Object(Pe.a)(j,2),N=C[0],I=C[1],P=Object(n.useContext)(ir),T=P.series,A=P.seriesConfig,R=P.ac,_={zoom:16};T&&T.coords&&2===T.coords.length&&(_.longitude=T.coords[0],_.latitude=T.coords[1]);var L={update:R.canUser("update",T,"series","*"),delete:R.canUser("delete",T,"series","*"),contribute:R.canUser("update",T,"series",["photos"])},z=Object(n.useState)(0),M=Object(Pe.a)(z,2),D=M[0],F=M[1];return r.a.createElement("div",{className:f.root},r.a.createElement(ge.a,null),r.a.createElement(Bn.a,{position:"static",className:f.appBar},r.a.createElement(ra.a,{disableGutters:!0},r.a.createElement(Un.a,{className:f.menuButton,color:"inherit",onClick:p,"aria-label":"Menu"},r.a.createElement(qn.a,null)),r.a.createElement(me.a,{variant:"subtitle1",color:"inherit",className:f.toolbarTitle},T.name||"Series"),r.a.createElement(Un.a,{"aria-haspopup":"true",color:"inherit",onClick:function(e){return w(e.currentTarget)}},r.a.createElement(Qn.a,null)),r.a.createElement(Xr,{anchorEl:x,onClose:function(){return w(null)},menuItems:[{text:"Watch Series",icon:Zn.a,hide:!d||b||h,action:d},{text:"Unwatch Series",icon:Zn.a,hide:!m||b||!h,action:m},{text:"Series QR Code",icon:sr,action:function(){return S(!0)}},{text:"Start Slideshow",icon:Kn.a,hide:!t,action:t},{divider:!0},{text:"Edit Series",icon:tr.a,hide:!o||!L.update,action:o},{text:"Delete Series",icon:nr.a,hide:!I||!L.delete,color:"error",action:function(){return I(!0)}}]})),r.a.createElement($n.a,{variant:"fullWidth",value:D,onChange:function(e,t){return F(t)}},r.a.createElement(Wn.a,{label:"Info"}),r.a.createElement(Wn.a,{label:"Map"}),r.a.createElement(Wn.a,{label:"Photos"}))),r.a.createElement("div",{className:f.inner},0===D&&r.a.createElement(r.a.Fragment,null,T.photos&&T.photos.length>0&&r.a.createElement(ui,{photos:T.photos,initialPhoto:g,onImageSelect:u}),r.a.createElement(Eo,{onChange:a})),T.photos&&2===D&&r.a.createElement(wi,{photos:T.photos,onTileClick:u,onDelete:i})),1===D&&r.a.createElement(Dr,{showMe:!0,longitude:T.longitude,latitude:T.latitude,viewport:_,direction:T.direction}),0===D&&L.contribute&&r.a.createElement($r,{isIos:A.isIos,className:f.AddFab,onCameraClick:l,onLibraryClick:s},r.a.createElement(Yn.a,null)),r.a.createElement(cr,{open:k,onClose:function(){return S(!1)}}),r.a.createElement(yi,{open:N,onConfirm:function(e){I(!1),!0===e&&c(T.id)},title:"Delete Series",message:"Are you sure you want to delete this series? The record and all images associated with it will be gone forever."}))},Si=a(968),ji=a(980),Ci=a(984),Ni=Object(he.a)(function(e){return{root:{},dlgContent:{display:"flex",flexDirection:"column",padding:0},mapWrapper:{flexGrow:1},sliderWrapper:{padding:"20px"},slider:{},sliderRoot:{},body:{overflow:"hidden",whiteSpace:"pre-line",paddingBottom:e.spacing(1)},title:{background:e.palette.primary.main,color:e.palette.primary.contrastText,margin:0,padding:e.spacing(2)},closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]}}}),Ii=function(e){var t=e.open,a=e.onOk,o=e.onCancel,i=e.title,l=e.latitude,c=e.longitude,s=e.direction,u=Ni(),p=Object(n.useState)({longitude:c,latitude:l}),d=Object(Pe.a)(p,2),m=d[0],g=m.longitude,h=m.latitude,b=d[1],f=Object(n.useState)(s),y=Object(Pe.a)(f,2),v=y[0],x=y[1],w=Object(n.useMemo)(function(){return{zoom:18,latitude:l,longitude:c}},[l,c]);return r.a.createElement(Re.a,{scroll:"paper",open:t,fullWidth:!0,fullScreen:!0,onClose:o},r.a.createElement(_e.a,{className:u.title,disableTypography:!0},r.a.createElement(me.a,{color:"inherit"},i)),r.a.createElement(Le.a,{className:u.dlgContent},r.a.createElement("div",{className:u.mapWrapper},r.a.createElement(Dr,{editable:!0,className:u.map,direction:v>0?v:null,viewport:w,onChange:function(e){var t=e.viewport,a=t.longitude,n=t.latitude;return b({longitude:a,latitude:n})}})),r.a.createElement("div",{className:u.sliderWrapper},r.a.createElement(to.a,{className:u.mapFormLabel},"Direction ",v>-1?"":"(off)"),r.a.createElement(Ci.a,{classes:{root:u.sliderRoot},value:v||-1,min:-1,max:360,step:1,onChange:function(e,t){return x(t)}}))),r.a.createElement(De.a,null,r.a.createElement(Ae.a,{onClick:o},"Cancel"),r.a.createElement("div",{style:{flexGrow:1}}),r.a.createElement(Ae.a,{onClick:function(){return a({longitude:g,latitude:h,direction:v})}},"Ok")))},Pi=Object(he.a)(function(e){return{root:{},body:{overflow:"hidden",whiteSpace:"pre-line",paddingBottom:e.spacing(1)},title:{margin:0,padding:e.spacing(2)},closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]}}}),Ti=function(e){var t=e.open,a=e.onOk,o=e.title,i=e.body,l=e.multiline,c=Pi(),s=Object(n.useState)(i||""),u=Object(Pe.a)(s,2),p=u[0],d=u[1];return r.a.createElement(Re.a,{scroll:"paper",open:t,fullWidth:!0,onClose:function(){return a(p)}},r.a.createElement(_e.a,{className:c.title},o),r.a.createElement(Le.a,null,r.a.createElement(Me.a,{className:c.body,multiline:l,fullWidth:!0,rows:6,rowsMax:20,onChange:function(e){return d(e.target.value)},defaultValue:i})),r.a.createElement(De.a,null,r.a.createElement(Ae.a,{onClick:function(){return a(i)}},"Cancel"),r.a.createElement("div",{style:{flexGrow:1}}),r.a.createElement(Ae.a,{onClick:function(){return a(p)}},"Ok")))},Ai="mapPicker",Ri="noteEdit",_i=Object(he.a)(function(e){return{root:{},inner:{display:"flex",flexDirection:"column"},dlgTitle:{background:e.palette.primary.main,color:e.palette.primary.contrastText},access:{display:"flex",flexDirection:"column"},accessRadio:{margin:e.spacing(2,1)},grow:{flexGrow:1},field:{flexGrow:0,marginBottom:2*e.spacing(1)},slider:{paddingLeft:e.spacing(1),paddingRight:e.spacing(1)},textField:{marginLeft:e.spacing(1),marginRight:e.spacing(1),width:"100%"},formLabel:{display:"block",marginTop:e.spacing(1),marginBottom:e.spacing(1)},mapFormLabel:{display:"block",marginTop:e.spacing(1),marginBottom:e.spacing(1)},mapInnerWrap:{flexGrow:1,height:"200px",minHeight:"200px"},mapWrapper:{flexGrow:1,display:"flex",flexDirection:"column",paddingBottom:2*e.spacing(1)},formControl:{margin:e.spacing(1),minWidth:120},chips:{display:"flex",flexWrap:"wrap"}}}),Li=function(e){var t=e.series,a=e.delta,o=e.onChange,i=_i(),c=Object(n.useState)(null),s=Object(Pe.a)(c,2),u=s[0],p=s[1],d={zoom:18};(a.latitude||t.coords[1])&&(a.longitude||t.coords[0])&&(d.longitude=a.longitude||t.coords[0],d.latitude=a.latitude||t.coords[1]);var m=a.access||t.access||"PRIVATE";return r.a.createElement("div",null,r.a.createElement(Me.a,{label:"Series Name",fullWidth:!0,placeholder:"New Series",className:i.field,value:a.name||t.name||"",onChange:function(e){return o(Object(l.a)({},a,{name:e.target.value}))}}),r.a.createElement("div",{className:i.mapWrapper,onClick:function(){return p(Ai)}},r.a.createElement(to.a,{className:i.mapFormLabel},"Location"),r.a.createElement("div",{className:i.mapInnerWrap},r.a.createElement(Dr,{staticMap:!0,className:i.map,direction:a.direction||t.direction,viewport:d}))),r.a.createElement("div",{className:i.field},r.a.createElement(to.a,null,"Series Access"),r.a.createElement("div",{className:i.access},r.a.createElement(Si.a,{className:i.accessRadio,control:r.a.createElement(ji.a,{checked:["OPEN","PUBLIC"].indexOf(m)>-1,onChange:function(e){o(Object(l.a)({},a,{access:e.target.checked?"PUBLIC":"PRIVATE"}))},value:"PUBLIC"}),label:r.a.createElement("div",null,r.a.createElement(me.a,{variant:"body2",component:"div"},Bt.PUBLIC.label),r.a.createElement(me.a,{variant:"caption",color:"textSecondary",component:"div"},Bt.PUBLIC.description))}),r.a.createElement(Si.a,{className:i.accessRadio,disabled:["PRIVATE"].indexOf(m)>-1,control:r.a.createElement(ji.a,{checked:["OPEN"].indexOf(m)>-1,onChange:function(e){return o(Object(l.a)({},a,{access:e.target.checked?"OPEN":"PUBLIC"}))},value:"OPEN"}),label:r.a.createElement("div",null,r.a.createElement(me.a,{variant:"body2",component:"div"},Bt.OPEN.label),r.a.createElement(me.a,{variant:"caption",color:"textSecondary",component:"div"},Bt.OPEN.description))}))),r.a.createElement(uo,{onClick:function(){return p(Ri)},className:i.field,label:"Series Note",text:a.note||t.note}),u===Ai&&r.a.createElement(Ii,{open:!0,title:"Series Location & Direction",latitude:a.latitude||t.coords[1],longitude:a.longitude||t.coords[0],direction:a.direction||t.direction,onOk:function(e){o(Object(l.a)({},a,e)),p(null)},onCancel:function(){return p(null)}}),u===Ri&&r.a.createElement(Ti,{open:!0,title:"Series Note",body:a.note||t.note,multiline:!0,onOk:function(e){o(Object(l.a)({},a,{note:e})),p(null)},onCancel:function(){return p(null)}}))},zi=Object(he.a)(function(e){return{root:{},inner:{display:"flex",flexDirection:"column"},dlgTitle:{background:e.palette.primary.main,color:e.palette.primary.contrastText},grow:{flexGrow:1},field:{flexGrow:0,marginBottom:e.spacing(2)},slider:{paddingLeft:e.spacing(1),paddingRight:e.spacing(1)},textField:{marginLeft:e.spacing(1),marginRight:e.spacing(1),width:"100%"},formLabel:{display:"block",marginTop:e.spacing(1),marginBottom:e.spacing(1)},mapFormLabel:{display:"block",marginTop:e.spacing(1),marginBottom:e.spacing(1)},mapInnerWrap:{flexGrow:1},mapWrapper:{flexGrow:1,display:"flex",flexDirection:"column",paddingBottom:e.spacing(2)},formControl:{margin:e.spacing(1),minWidth:120},chips:{display:"flex",flexWrap:"wrap"}}}),Mi=function(e){var t=e.onOk,a=e.onCancel,o=zi(),i=Object(n.useContext)(ir).series,c=Object(n.useState)({}),s=Object(Pe.a)(c,2),u=s[0],p=s[1];return r.a.createElement(Re.a,{scroll:"paper",className:o.root,fullScreen:!0,open:!0,fullWidth:!0,onClose:a},r.a.createElement(ge.a,null),r.a.createElement(_e.a,{disableTypography:!0,className:o.dlgTitle},r.a.createElement(me.a,{variant:"subtitle1",color:"inherit",className:o.grow},"Edit Series Details")),r.a.createElement(Le.a,{className:o.inner},r.a.createElement(Li,{series:i,delta:u,onChange:p})),r.a.createElement(De.a,null,r.a.createElement(Ae.a,{className:o.menuButton,color:"inherit",onClick:function(){return p({})},"aria-label":"Menu"},"Reset"),r.a.createElement(Ae.a,{className:o.menuButton,color:"inherit",onClick:a,"aria-label":"Menu"},"Cancel"),r.a.createElement(Ae.a,{className:o.menuButton,color:"inherit",onClick:function(){return t(Object(l.a)({id:i.id},u))},"aria-label":"Menu"},"Ok")))},Di=a(465),Fi=a.n(Di),Bi=a(464),Ui=a.n(Bi),$i=Object(he.a)(function(e){return{root:{height:"100%",display:"flex",flexDirection:"column"},swipeAble:{height:"100%"},slideContainer:{flexGrow:1},titleBar:{padding:e.spacing(0,1),height:"35px!important"},mobileStepper:{flexGrow:0,background:e.palette.grey[800],color:e.palette.getContrastText(e.palette.grey[800])},slide:{top:0,zIndex:0,opacity:0,position:"absolute",display:"block",overflow:"hidden",width:"100%",height:"100%",minHeight:300},dotActive:{background:"white"},iconButton:{color:"white"},active:{zIndex:5,opacity:1},last:{opacity:1,zIndex:4},tagContainer:{},labelBadge:{color:"white",zIndex:10,position:"absolute",right:e.spacing(2),bottom:e.spacing(1),opacity:.8},tagChip:{marginRight:e.spacing(1),fontSize:10,height:e.spacing(2),padding:e.spacing(.5)},xyTagChip:{position:"absolute",fontSize:e.spacing(1),height:e.spacing(2)},manualBack:{color:"white",zIndex:10,position:"absolute",transform:"translateY(-50%)",left:0,top:"50%"},manualForward:{color:"white",zIndex:10,position:"absolute",transform:"translateY(-50%)",right:0,top:"50%"}}}),Wi=function(e){var t=e.onCancel,a=e.photos,o=e.transition,i=$i(),l=Object(xr.a)(),c=qi(a.length,o),s=c.activeStep,u=c.lastStep,p=c.handleForward,d=c.handleBack,m=c.paused,g=c.pause,h=c.play,b=Object(n.useState)(!1),f=Object(Pe.a)(b,2),y=f[0],v=f[1],x=Object(n.useRef)(null),w=hr(x).size,E=w.height,O=w.width;return r.a.createElement("div",{className:i.root},r.a.createElement(ge.a,null),r.a.createElement("div",{ref:x,className:i.slideContainer},a.map(function(e,n){return r.a.createElement(di.a,{key:"slide-".concat(n),className:jn()(i.slide,s===n&&i.active,u===n&&i.last),onClick:function(){return v(!y)},style:{height:E,width:O,transition:l.transitions.create(["opacity"],{duration:.25*o})}},r.a.createElement(li,{photo:e,className:i.photo,showTags:y}),r.a.createElement(me.a,{className:i.labelBadge},"Tags: ",y?"On ":"Off ",r.a.createElement(So.a,{color:"secondary",badgeContent:a[s].tags.filter(function(e){return e.coords}).length},r.a.createElement(Co.a,{color:"inherit"}))),r.a.createElement(ko.a,{className:i.titleBar,titlePosition:"top",title:r.a.createElement(me.a,{color:"inherit",variant:"caption"},r.a.createElement(Un.a,{className:i.iconButton,onClick:function(e){return t()}},r.a.createElement(qn.a,null)),Object(yo.d)(e.takenOn)),subtitle:r.a.createElement("em",null,m?"Paused":"    "),actionIcon:m?r.a.createElement(Un.a,{className:i.iconButton,onClick:function(e){e.preventDefault(),e.stopPropagation(),h()}},r.a.createElement(Ui.a,null)):r.a.createElement(Un.a,{className:i.iconButton,onClick:function(e){e.preventDefault(),e.stopPropagation(),g()}},r.a.createElement(Fi.a,null))}))}),r.a.createElement(Un.a,{size:"small",className:i.manualBack,onClick:d,color:"inherit"},"rtl"===l.direction?r.a.createElement(To.a,null):r.a.createElement(Io.a,null)),r.a.createElement(Un.a,{size:"small",className:i.manualForward,onClick:p,color:"inherit"},"rtl"===l.direction?r.a.createElement(Io.a,null):r.a.createElement(To.a,null))),r.a.createElement(Oo.a,{steps:a.length,position:"static",activeStep:s,classes:{root:i.mobileStepper,dotActive:i.dotActive},nextButton:r.a.createElement(Ae.a,{color:"inherit",size:"small",onClick:p,disabled:s===a.length-1},"Next","rtl"===l.direction?r.a.createElement(Io.a,null):r.a.createElement(To.a,null)),backButton:r.a.createElement(Ae.a,{color:"inherit",size:"small",onClick:d,disabled:0===s},"rtl"===l.direction?r.a.createElement(To.a,null):r.a.createElement(Io.a,null),"Back")}))};Wi.defaultProps={transition:5e3,isFullScreen:!1,slides:[]};var Gi=Wi,qi=function(e,t){var a=Object(n.useState)(0),r=Object(Pe.a)(a,2),o=r[0],i=r[1],l=Object(n.useState)(!1),c=Object(Pe.a)(l,2),s=c[0],u=c[1],p=Object(n.useState)(0),d=Object(Pe.a)(p,2),m=d[0],g=d[1],h=Object(n.useRef)(),b=function(){h.current=window.setInterval(function(){return i(function(t){return g(t),t+1>=e?0:t+1})},t)},f=function(){h.current&&window.clearInterval(h.current)};return Object(n.useEffect)(function(){return b(),function(){f()}},[]),{activeStep:o,lastStep:m,handleForward:function(){g(o),i(o+1>=e?0:o+1),s||(f(),b())},handleBack:function(){g(o),i(o-1<0?e-1:o-1),s||(f(),b())},setActiveStep:i,paused:s,pause:function(){f(),u(!0)},play:function(){u(!1),f(),b()}}},Hi=a(466),Yi=a.n(Hi),Vi=Object(he.a)(function(e){return{}}),Qi=function(e){var t=e.title,a=e.message,n=e.onConfirm,o=e.open,i=Vi();return r.a.createElement(Re.a,{className:i.root,disableBackdropClick:!0,fullWidth:!0,open:o,disableEscapeKeyDown:!0,maxWidth:"xl","aria-labelledby":"confirmation-dialog-title"},r.a.createElement(_e.a,{id:"confirmation-dialog-title"},t),r.a.createElement(Le.a,null,r.a.createElement(me.a,null,a)),r.a.createElement(De.a,null,r.a.createElement(Ae.a,{onClick:function(){return n(!1)},color:"primary"},"No"),r.a.createElement(Ae.a,{onClick:function(){return n(!0)},color:"secondary"},"Yes")))},Xi=function(e){return{root:{width:"100%"},tagContainer:{},formControl:{},actionButtons:{textAlign:"right"},noOptionsMessage:{padding:e.spacing(1,2)},singleValue:{fontSize:16},placeholder:{position:"absolute",left:2,fontSize:16},input:{display:"flex",padding:0},valueContainer:{display:"flex",flexWrap:"wrap",flex:1,alignItems:"center",overflow:"hidden"},paper:{position:"absolute",zIndex:1,marginTop:e.spacing(1),left:0,right:0}}},Zi=Object(he.a)(Xi),Ji=function(e){var t=e.tags,a=(e.label,e.tagConfig),n=e.className,o=Zi(),i=t.filter(function(e){return e.typeId===a.id&&!e.coords});return r.a.createElement("div",{className:jn()(o.root,n)},r.a.createElement(me.a,{variant:"overline",className:o.fieldTitle},a.label),r.a.createElement("div",{className:o.tagContainer},i.map(function(e,t){return r.a.createElement(lo,{tag:e,key:"tagchip".concat(t),color:a.color})})))},Ki=Object(he.a)(function(e){return{root:{},rootEdit:{},formControl:{width:"100%"},textBody:{whiteSpace:"pre-line"},actionButtons:{textAlign:"right"}}}),el=function(e){var t=e.label,a=e.value,n=e.hint,o=e.onChange,i=e.className,l=Ki();return r.a.createElement("div",{className:jn()(l.root,i)},r.a.createElement(me.a,{variant:"overline",className:l.fieldTitle},t),r.a.createElement(Me.a,{type:"datetime-local",fullWidth:!0,value:Object(yo.e)(a),className:l.textField,onChange:function(e){return o(Object(yo.a)(e.target.value))}}),n&&r.a.createElement(me.a,{variant:"caption",className:l.hint},n))},tl=Object(he.a)(Xi),al=function(e){var t=e.tags,a=e.onChange,n=e.hint,o=e.tagConfig,i=e.className,c=tl(),s=function(e,n){var r=n.action,i=n.removedValue,c=n.option;switch(r){case"clear":a([]);break;case"remove-value":a(t.filter(function(e){return e.id!==i.value}));break;case"select-option":var s=Object(l.a)({},o.values.find(function(e){return e.id===c.value}),{typeId:o.id});a([].concat(Object(Va.a)(t),[s]));break;case"create-option":var u={label:e.find(function(e){return e.__isNew__}).value,typeId:o.id};a([].concat(Object(Va.a)(t),[u]))}},u=t.filter(function(e){return e.typeId===o.id&&!e.coords}),p=u.map(function(e){return{label:e.label,value:e.id}}),d=o.values.filter(function(e){return-1===u.map(function(e){return e.id}).indexOf(e.id)}).map(function(e){return{label:e.label,value:e.id}});return r.a.createElement("div",{className:jn()(c.root,i)},r.a.createElement(me.a,{variant:"overline",className:c.fieldTitle},o.label),!o.allowAdditions&&r.a.createElement(Bo.a,{options:d,classes:c,isFocused:!0,components:{Control:nl,Menu:ol,NoOptionsMessage:rl,Option:cl,Placeholder:ll,ValueContainer:sl},deleteRemoves:!0,value:p,isClearable:!1,onChange:s,placeholder:"Select Tags",isMulti:!0,isSearchable:!0}),o.allowAdditions&&r.a.createElement($o.a,{options:d,classes:c,isFocused:!0,deleteRemoves:!0,components:{Control:nl,Menu:ol,NoOptionsMessage:rl,Option:cl,Placeholder:ll,ValueContainer:sl},value:p,isClearable:!1,onChange:s,placeholder:"Select Tags",isMulti:!0,isSearchable:!0}),n&&r.a.createElement(me.a,{variant:"caption",className:c.hint},n))};function nl(e){return r.a.createElement(Me.a,Object.assign({fullWidth:!0,InputProps:{inputComponent:il,inputProps:{className:e.selectProps.classes.input,inputRef:e.innerRef,children:e.children,onMouseDown:function(t){e.innerProps.onMouseDown(t)},onTouchEnd:function(t){e.innerProps.onTouchEnd(t)}}}},e.selectProps.textFieldProps))}var rl=function(e){var t=e.innerProps,a=e.selectProps,n=e.children;return r.a.createElement(me.a,Object.assign({color:"textSecondary",className:a.classes.noOptionsMessage},t),n)},ol=function(e){var t=e.selectProps,a=e.innerProps,n=e.children;return r.a.createElement(_a.a,Object.assign({square:!0,className:t.classes.paper},a),n)},il=function(e){var t=e.inputRef,a=Object(c.a)(e,["inputRef"]);return r.a.createElement("div",Object.assign({ref:t},a))},ll=function(e){return r.a.createElement(me.a,Object.assign({color:"textSecondary",className:e.selectProps.classes.placeholder},e.innerProps),e.children)},cl=function(e){var t=e.innerRef,a=e.isFocused,n=e.isSelected,o=e.innerProps,i=e.children;return r.a.createElement(Hr.a,Object.assign({buttonRef:t,selected:a,component:"div",style:{fontWeight:n?500:400}},o),i)},sl=function(e){var t=e.selectProps,a=e.children;return r.a.createElement("div",{className:t.classes.valueContainer},a)},ul=Object(he.a)(function(e){return{root:{},dlgContent:{overflowY:"visible!important",paddingBottom:300},title:{width:"100%",margin:0,display:"flex",padding:e.spacing(2)},dlgTitle:{flexGrow:1},closeButton:{color:e.palette.grey[500]}}}),pl=function(e){var t=e.open,a=e.title,o=e.onOk,i=e.onCancel,l=e.tags,c=e.tagConfig,s=ul(),u=Object(n.useState)(l),p=Object(Pe.a)(u,2),d=p[0],m=p[1];return r.a.createElement(Re.a,{className:s.root,scroll:"body",fullScreen:!0,open:t,onClose:function(){return o(d)}},r.a.createElement(_e.a,{className:s.title,disableTypography:!0},r.a.createElement(me.a,{className:s.dlgTitle},a),r.a.createElement(Un.a,{className:s.closeButton,onClick:i},r.a.createElement(ho.a,null))),r.a.createElement(Le.a,{className:s.dlgContent},r.a.createElement(al,{className:s.field,tags:d,tagConfig:c,onChange:m})),r.a.createElement(De.a,null,r.a.createElement(Ae.a,{onClick:i},"Cancel"),r.a.createElement("div",{style:{flexGrow:1}}),r.a.createElement(Ae.a,{onClick:function(){return m(l)}},"Reset"),r.a.createElement(Ae.a,{onClick:function(){return o(d)}},"Ok")))},dl=Object(he.a)(function(e){return{root:{},rootEdit:{},formControl:{width:"100%"},textBody:{whiteSpace:"pre-line"},actionButtons:{textAlign:"right"}}}),ml=function(e){var t=e.label,a=e.value,n=e.className,o=dl();return r.a.createElement("div",{className:jn()(o.root,n)},r.a.createElement(me.a,{variant:"overline",className:o.fieldTitle},t),r.a.createElement(me.a,{variant:"body1",className:o.hint},a?Object(yo.d)(a):""))},gl=Object(he.a)(function(e){return{root:{height:"90%",width:"85%"},dlgTitleContainer:{display:"flex",padding:0},catTagTitle:{marginTop:e.spacing(2)},dlgTitle:{flexGrow:1,paddingTop:e.spacing(2),paddingBottom:e.spacing(1),paddingLeft:e.spacing(3)},field:{marginBottom:e.spacing(2)}}}),hl="noteEdit",bl="noteView",fl="tag",yl=function(e){var t=e.canEdit,a=e.photo,o=e.delta,i=e.onChange,l=gl(),c=Object(n.useContext)(ir).seriesConfig,s=Object(n.useState)({}),u=Object(Pe.a)(s,2),p=u[0],d=p.activeDialog,m=p.activeDialogContext,g=u[1],h=new ei(c,o.tags||a.tags),b=[];try{b=a.meta?Object.keys(JSON.parse(a.meta)):[]}catch(f){console.error(f)}return r.a.createElement("div",null,a.createdUser&&r.a.createElement(r.a.Fragment,null,r.a.createElement(mo,{user:a.createdUser,onAvatarClick:function(){return c.onAvatarClick(a.createdUser.username)},secondary:"uploaded this photo"}),r.a.createElement(Qr.a,null)),t?r.a.createElement(el,{className:l.field,label:"Photo taken on",value:o.takenOn||a.takenOn,onChange:function(e){return i({takenOn:e})},canEdit:t}):r.a.createElement(ml,{label:"Photo taken on",value:o.takenOn||a.takenOn}),(t||a.note)&&r.a.createElement(uo,{label:"Photo Note",text:o.note||a.note,onClick:function(){g(t?{activeDialog:hl}:{activeDialog:bl})}}),r.a.createElement(me.a,{variant:"subtitle1",className:l.catTagTitle},"Category tags"),r.a.createElement(Qr.a,null),h.seriesConfig.getNonXYTagTypes().map(function(e,n){return r.a.createElement("div",{key:"tagtype-".concat(n),onClick:function(){return t?g({activeDialog:fl,activeDialogContext:e}):null}},r.a.createElement(Ji,{className:l.field,label:e.label,tags:o.tags||a.tags,tagConfig:e}))}),b.length>0&&Object.keys(c.meta).length>0&&r.a.createElement(r.a.Fragment,null,r.a.createElement(me.a,{className:l.heading},"Metadata"),r.a.createElement(Qr.a,null),r.a.createElement(Zr.a,{className:l.list},b.map(function(e,t){return c.meta[e]?r.a.createElement(Jr.a,{key:"metadata".concat(t)},r.a.createElement(Vr.a,{primary:c.meta[e].label,secondary:c.meta[e].render(a.meta[e])})):null}))),d&&d===hl&&r.a.createElement(Ti,{open:!0,multiline:!0,onOk:function(e){i({note:e}),g({})},title:"Edit Photo Note",body:o.note||a.note}),d&&d===bl&&r.a.createElement(fo,{open:!0,multiline:!0,onClose:function(){return g({})},title:"Photo Note",body:o.note||a.note}),d&&d===fl&&r.a.createElement(pl,{open:!0,title:"Edit Tags: ".concat(m.label),onOk:function(e){g({}),i({tags:e})},onCancel:function(){return g({})},tags:o.tags||a.tags,tagConfig:m}))},vl=Object(he.a)(function(e){return{root:{height:"90%",width:"85%"},dlgTitleContainer:{display:"flex",padding:0},dlgTitle:{flexGrow:1,paddingTop:e.spacing(2),paddingBottom:e.spacing(1),paddingLeft:e.spacing(3)},field:{marginBottom:e.spacing(2)}}}),xl="cancel",wl=function(e){var t=e.canEdit,a=e.photo,o=e.onCancel,i=e.onOk,c=e.open,s=vl(),u=Object(n.useState)(null),p=Object(Pe.a)(u,2),d=p[0],m=p[1],g=Object(n.useState)({}),h=Object(Pe.a)(g,2),b=h[0],f=h[1],y=b&&Object.keys(b).length>0;return r.a.createElement(Re.a,{fullScreen:!0,fullWidth:!0,onClose:function(){y?m(xl):o()},"aria-labelledby":"customized-dialog-title",open:c},r.a.createElement(_e.a,{disableTypography:!0,className:s.dlgTitleContainer},r.a.createElement(me.a,{variant:"h5",className:s.dlgTitle},"Photo Properties"),r.a.createElement(Un.a,{onClick:o},r.a.createElement(ho.a,null))),r.a.createElement(Le.a,null,r.a.createElement(yl,{photo:a,delta:b,onChange:function(e){return f(Object(l.a)({},b,e))},canEdit:t})),r.a.createElement(De.a,null,!t&&r.a.createElement(Ae.a,{onClick:o,color:"primary"},"Ok"),t&&!y&&r.a.createElement(Ae.a,{onClick:o,color:"primary"},"Back"),t&&y&&r.a.createElement(r.a.Fragment,null,r.a.createElement(Ae.a,{onClick:function(){return m(xl)},color:"primary"},"Cancel"),r.a.createElement(Ae.a,{onClick:function(){return f({})},color:"primary"},"Reset"),r.a.createElement(Ae.a,{onClick:function(){return i(b)},color:"primary"},"Ok"))),d&&d===xl&&r.a.createElement(Qi,{open:!0,title:"Lose unsaved changes?",message:"You will lose any changes you made to this form",onConfirm:function(e){m(null),e&&o()}}))},El=Object(he.a)(function(e){return{root:{display:"flex",height:"100%",flexDirection:"column",overflow:"hidden"},appBar:{flexGrow:0},appBarEdit:{color:e.palette.secondary.contrastText,background:e.palette.secondary.main},grow:{flexGrow:1},photoWrapper:{height:"100%"},inner:{flex:"1 1",position:"relative"},tabMenu:{marginTop:e.spacing(7)},tipChip:{position:"absolute",zIndex:11,bottom:20,left:"50%",opacity:.6,transform:"translateX(-50%)"},mobileStepper:{background:"none"},dots:{margin:"0 auto"},dot:{border:"1px solid #FFFFFF77"},dotActive:{background:e.palette.secondary.main},activeButton:{color:e.palette.primary.main,opacity:1}}}),Ol=0,kl=1,Sl=2,jl=3,Cl=4,Nl=function(e){var t=e.photos,a=e.initPhotoId,o=e.onMenuBack,i=e.onUpdatePhoto,c=e.newPhoto,s=El(),u=Object(xr.a)(),p=Object(n.useContext)(ir),d=p.series,m=p.seriesConfig,g=p.ac,h=Object(Va.a)(t);h.sort(function(e,t){return parseInt(t.takenOn,10)-parseInt(e.takenOn,10)});var b=Object(n.useState)(a?h.findIndex(function(e){return e.id===a}):0),f=Object(Pe.a)(b,2),y=f[0],v=f[1],x=t[y],w=Object(n.useState)(c?x:{}),E=Object(Pe.a)(w,2),O=E[0],k=E[1],S=Object(n.useState)({current:c?Cl:Ol,last:null}),j=Object(Pe.a)(S,2),C=j[0],N=j[1],I=new ei(m,O.tags||x.tags),P=function(e){N({current:e,last:C.current})},T=function(){P(Sl),i(x,Object(l.a)({id:x.id},O))},A={update:g.canUser("update",d,"series")||g.canUser("update",x,"photo")};return r.a.createElement("div",{className:s.root},r.a.createElement(ge.a,null)," ",r.a.createElement(Bn.a,{position:"static",className:jn()(s.appBar,C.current!==Ol?s.appBarEdit:null)},r.a.createElement(ra.a,null,C.current!==Cl&&r.a.createElement(Un.a,{className:s.menuButton,color:"inherit","aria-label":"Menu",onClick:function(){return o()}},r.a.createElement(qn.a,null)),r.a.createElement("div",{className:s.grow},r.a.createElement(me.a,{variant:"subtitle2",color:"inherit"},c?"Add Tags":"Photo View (".concat(y+1,"/").concat(t.length,")")),r.a.createElement(me.a,{variant:"subtitle2",color:"inherit"},Object(yo.d)(x.takenOn,"lll"))),C.current===jl&&r.a.createElement(Ae.a,{color:"inherit",onClick:function(){P(Sl),k(x)}},"Cancel"),C.current===jl&&r.a.createElement(Ae.a,{color:"inherit",onClick:T},"Save"),C.current===Cl&&r.a.createElement(Ae.a,{color:"inherit",onClick:function(){i(x,Object(l.a)({id:x.id},O)),o()}},"Next"),A.update&&C.current===Sl&&r.a.createElement(Ae.a,{color:"inherit",onClick:function(){return P(jl)}},"Edit"),C.current!==jl&&C.current!==Cl&&r.a.createElement(Un.a,{color:"inherit",className:jn()(s.tagButton,C.current===Sl&&s.activeButton),onClick:function(){return P(C.current===Sl?Ol:Sl)}},r.a.createElement(So.a,{className:s.margin,badgeContent:I.getXYTags().length,color:"primary"},r.a.createElement(Co.a,{color:"inherit"}))),C.current!==jl&&C.current!==Cl&&r.a.createElement(Un.a,{color:"inherit",className:jn()(s.infoButton,C.current===kl&&s.activeButton),onClick:function(){return P(C.current===kl?Ol:kl)}},r.a.createElement(Yi.a,null)))),r.a.createElement("div",{className:s.inner,onClick:function(e){C.current===Ol&&(e.preventDefault(),e.stopPropagation(),P(kl))}},r.a.createElement(Ro.a,{axis:"rtl"===u.direction?"x-reverse":"x",index:y,containerStyle:{height:"100%"},style:{height:"100%"},disabled:C.current!==Ol,onChangeIndex:function(e){return v(e)},enableMouseEvents:!0},h.map(function(e,t){return r.a.createElement("div",{className:s.photoWrapper,key:"swipeshowpic-".concat(t)},r.a.createElement(li,{showTags:C.current===Sl,photo:Object(l.a)({},e,O),edit:A.update&&(C.current===jl||C.current===Cl),onChange:k,onCommitTags:T}))})),C.current===Ol&&r.a.createElement(Oo.a,{steps:h.length,position:"bottom",activeStep:y,classes:{root:s.mobileStepper,dots:s.dots,dot:s.dot,dotActive:s.dotActive}})),r.a.createElement(wl,{open:C.current===kl,photo:x,canEdit:A.update,onOk:function(e){i(x,Object(l.a)({id:x.id},e)),P(C.last)},onCancel:function(){return P(C.last)}}),(C.current===jl||C.current===Cl)&&r.a.createElement(ao.a,{label:"Tap to tag features...",onClick:function(){},className:s.tipChip}))},Il=Object(he.a)(function(e){return{root:{color:"white",zIndex:10,display:"flex",flexDirection:"column",position:"absolute",height:"50%",top:"45%",left:"0",transform:"translateY(-50%)"},sliderLabel:{display:"block",flexGrow:1,textAlign:"center",padding:e.spacing(3,0,3,0),textShadow:"0 0 5px black, 0 0 5px black"},vertical:{padding:"0px 31px!important",width:"4px!important"},rail:{width:"4px!important",background:e.palette.primary.dark,boxShadow:"0 0 10px 5px black"},track:{width:"4px!important",background:e.palette.primary.main},thumb:{background:e.palette.primary.main,border:"1px solid ".concat(e.palette.primary.dark),marginLeft:"-8px !important",width:20,height:20}}}),Pl=function(e){var t=e.defaultValue,a=e.onChange,o=Il(),i=Object(n.useState)(t),l=Object(Pe.a)(i,2),c=l[0],s=l[1];return r.a.createElement("div",{className:o.root},r.a.createElement(me.a,{className:o.sliderLabel,color:"inherit",variant:"caption"},"New"),r.a.createElement(Ci.a,{classes:{vertical:o.vertical,rail:o.rail,track:o.track,thumb:o.thumb},value:c,"aria-labelledby":"label",onChange:function(e,t){s(t),a(t)},orientation:"vertical"}),r.a.createElement(me.a,{className:o.sliderLabel,color:"inherit",variant:"caption"},"Reference"))};Pl.defaultProps={defaultValue:100,onChange:function(){}};var Tl=Pl,Al=Object(he.a)(function(e){return{root:{background:"rgb(150,150, 150)",height:"100%",width:"100%"},capturedContainer:{position:"absolute",zIndex:1,height:"100%",width:"100%"},referenceContainer:{position:"absolute",zIndex:0,height:"100%",width:"100%"},captured:{},reference:{},referenceTextContainer:{width:"100%",display:"flex",color:"white",background:"rgba(0,0,0,0.5)",padding:e.spacing(3),position:"absolute",zIndex:4,top:0},newText:{flexGrow:1,color:"white",textShadow:"1 1 1 black",textAlign:"right"},refText:{flexGrow:1,color:"white",textShadow:"1 1 1 black"}}}),Rl=function(e){var t=e.captured,a=e.defaultRefPhotoId,o=e.onConfirm,i=e.onCancel,l=e.onRetry,c=e.dataUrl,s=Object(n.useContext)(ir).series,u=s&&s.photos?s.photos:null,p=Al(),d=a?u.find(function(e){return e.id===a}):u&&u.length>0?u[0]:null,m=Object(n.useState)(d),g=Object(Pe.a)(m,2),h=g[0],b=(g[1],Object(n.useState)(100)),f=Object(Pe.a)(b,2),y=f[0],v=f[1];return t?r.a.createElement("div",{className:p.root},r.a.createElement(ge.a,null),Boolean(h)&&r.a.createElement(Tl,{defaultValue:100,onChange:v}),r.a.createElement("div",{className:p.captured},r.a.createElement(li,{opacity:y/100,className:p.capturedContainer,photo:t,dataUrl:c})),Boolean(h)&&r.a.createElement("div",{className:p.reference},r.a.createElement(li,{className:p.referenceContainer,photo:h})),r.a.createElement(Ra.a,{open:!0,autoHideDuration:null,ContentProps:{"aria-describedby":"snackbar-fab-message-id",className:p.snackbarContent},message:r.a.createElement("span",{id:"snackbar-fab-message-id"},"Keep this photo?"),action:r.a.createElement("div",null,r.a.createElement(Ae.a,{color:"inherit",size:"small",onClick:i},"Cancel"),Boolean(l)&&r.a.createElement(Ae.a,{color:"inherit",size:"small",onClick:l},"Retry"),r.a.createElement(Ae.a,{color:"inherit",size:"small",onClick:o},"Keep")),className:p.snackbar})):"Loading..."},_l=a(976),Ll=a(240),zl=a.n(Ll),Ml=function(e,t,a){var r=Object(n.useState)(!1),o=Object(Pe.a)(r,2),i=o[0],c=o[1],s=Object(n.useState)(!1),u=Object(Pe.a)(s,2),p=u[0],d=u[1],m=Object(n.useRef)();Object(n.useEffect)(function(){m.current=new Dl(document.getElementById("webcam"),document.createElement("canvas")),m.current.setup(a||window.innerWidth,t||window.innerHeight).then(function(e){d(!0)}).catch(function(e){console.error(e),c(!0)})},[t,a]);return{cameraError:i,captureImage:function(){if(m.current&&p){var t=m.current.takeBlobPhoto({type:"jpeg",quality:1});e(Object(l.a)({},t,{name:"upload.jpg",ext:"jpg"}))}},cameraOnline:p,captureRawData:function(){if(m.current&&p){var t=m.current.takeImageData();e(t)}}}},Dl=function(){function e(t,a){Object(ke.a)(this,e),this.webcamElement=t,this.canvasElement=a,"https:"!==window.location.protocol&&"localhost"!==window.location.hostname&&console.warn("getUserMedia() must be run from a secure origin: https or localhost.\nChanging protocol to https."),navigator.mediaDevices||navigator.getUserMedia||console.warn("Your browser doesn't support navigator.mediaDevices.getUserMedia and navigator.getUserMedia.")}return Object(Se.a)(e,[{key:"adjustVideoSize",value:function(e,t){var a=e/t;e>=t?this.webcamElement.width=a*this.webcamElement.height:e<t&&(this.webcamElement.height=this.webcamElement.width/a)}},{key:"destroy",value:function(){var e=Object(ft.a)(bt.a.mark(function e(){return bt.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:try{this.webcamElement.srcObject.getTracks()[0].stop(),this.webcamElement=null,this.canvasElement=null}catch(t){console.error(t)}case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"setup",value:function(){var e=Object(ft.a)(bt.a.mark(function e(t,a){var n=this;return bt.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,r){void 0!==navigator.mediaDevices.getUserMedia?navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:"environment",width:t,height:a}}).then(function(t){"srcObject"in n.webcamElement?n.webcamElement.srcObject=t:n.webcamElement.src=window.URL.createObjectURL(t),n.webcamElement.onloadedmetadata=function(e){n.webcamElement.play()},n.webcamElement.onplaying=function(t){e()}}).catch(function(e){return r(e)}):r(new Error("Error accessing camera"))}));case 1:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}()},{key:"_drawImage",value:function(){var e=this.webcamElement.videoWidth,t=this.webcamElement.videoHeight,a=this.canvasElement.getContext("2d");return this.canvasElement.width=e,this.canvasElement.height=t,a.drawImage(this.webcamElement,0,0,e,t),{imageHeight:t,imageWidth:e}}},{key:"takeImageData",value:function(){var e=this._drawImage(),t=e.imageHeight,a=e.imageWidth,n={data:null,imageHeight:t,imageWidth:a};try{n.data=this.canvasElement.getContext("2d").getImageData(0,0,a,t).data}catch(r){}return n}},{key:"takeBlobPhoto",value:function(){var e=this,t=this._drawImage(),a=t.imageWidth,n=t.imageHeight;return new Promise(function(t,r){e.canvasElement.toBlob(function(e){t({fileBlob:e,imageHeight:n,imageWidth:a})})})}},{key:"takeDataURLPhoto",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{type:"jpeg",quality:1},t=e.type,a=e.quality,n=this._drawImage(),r=n.imageHeight,o=n.imageWidth;return{dataUrl:this.canvasElement.toDataURL("image/"+t,a),imageHeight:r,imageWidth:o,type:"image/"+t}}}]),e}(),Fl=Object(he.a)(function(e){return{root:{background:"black",height:"100%",width:"100%"},cameraErrorText:{color:"white",position:"absolute",top:"50%",left:"50%",width:"90%",transform:"translateY(-50%) translateX(-50%)",textAlign:"center"},disabledFab:{color:"#AAAAA!important",background:"#DDDDDD!important",opacity:.2},cameraFab:{position:"absolute",zIndex:10,"@media (orientation: landscape)":{right:"20px",top:"50%",transform:"translateY(-50%)",height:"25vh",width:"25vh"},"@media (orientation: portrait)":{bottom:"20px",left:"50%",transform:"translateX(-50%)",height:"25vw",width:"25vw"}},cameraIcon:{height:"100%",width:"100%"},cancelFab:{position:"absolute",zIndex:10,"@media (orientation: landscape)":{right:"15px",top:"15px",height:"15vh",width:"15vh"},"@media (orientation: portrait)":{right:"15px",bottom:"15px",height:"15vw",width:"15vw"}},cancelIcon:{height:"100%",width:"100%"},swipeDrawer:{width:"50%"},libraryFab:{position:"absolute",zIndex:10,"@media (orientation: landscape)":{left:"15px",top:"15px",height:"15vh",width:"15vh"},"@media (orientation: portrait)":{left:"15px",top:"15px",height:"15vw",width:"15vw"}},myLocationFab:{position:"absolute",zIndex:10,"@media (orientation: landscape)":{right:"15px",bottom:"15px",height:"15vh",width:"15vh"},"@media (orientation: portrait)":{left:"15px",bottom:"15px",height:"15vw",width:"15vw"}},myLocationIcon:{height:"80%",width:"80%"},capturedContainer:{position:"absolute",zIndex:1,height:"100%",width:"100%"},referenceContainer:{position:"absolute",zIndex:2,height:"100%",width:"100%"},captured:{},reference:{},video:{position:"absolute",top:0,left:0,height:"100vh",width:"100vw",zIndex:1}}}),Bl=function(e){var t=e.photos,a=e.onCancel,o=e.onShutter,i=e.defaultRefPhotoId,l=Fl(),c=Object(n.useState)(50),s=Object(Pe.a)(c,2),u=s[0],p=s[1],d=i?t.find(function(e){return e.id===i}):t&&t.length>0?t[0]:null,m=Object(n.useState)(d),g=Object(Pe.a)(m,2),h=g[0],b=g[1],f=Object(n.useState)(!1),y=Object(Pe.a)(f,2),v=y[0],x=y[1],w=Ml(function(e){return o(e,h?h.id:null)}),E=w.cameraError,O=w.captureImage,k=w.cameraOnline;return r.a.createElement("div",{className:l.root},r.a.createElement(ge.a,null),!E&&Boolean(h)&&r.a.createElement(Tl,{defaultValue:u,onChange:p}),E&&r.a.createElement("div",{className:l.cameraErrorText},r.a.createElement(me.a,{variant:"subtitle1",color:"inherit"},"No Camera Access"),r.a.createElement(me.a,{variant:"body2",color:"inherit"},"Please enabled access in your settings.")),r.a.createElement("div",{className:l.captured},Boolean(h)&&r.a.createElement("div",{className:l.reference},r.a.createElement(li,{className:l.referenceContainer,opacity:(100-u)/100,photo:h})),!E&&r.a.createElement("video",{autoPlay:!0,playsInline:!0,muted:!0,id:"webcam",width:window.innerWidth,height:window.innerHeight,className:l.video})),r.a.createElement(kr.a,{color:"primary","aria-label":"Take Photo",classes:{disabled:l.disabledFab},disabled:E||!k,className:jn()(l.cameraFab,l.buttonFab),onClick:O},r.a.createElement(zl.a,{className:l.cameraIcon})),r.a.createElement(kr.a,{color:"secondary","aria-label":"cancel",onClick:a,classes:{disabled:l.disabledFab},className:jn()(l.cancelFab,l.buttonFab)},r.a.createElement(ro.a,{className:l.cancelIcon})),r.a.createElement(kr.a,{"aria-label":"cancel",className:jn()(l.libraryFab,l.buttonFab),classes:{disabled:l.disabledFab},disabled:!t||0===t.length,onClick:function(){return x(!0)}},r.a.createElement(Br.a,{className:l.libraryIcon})),r.a.createElement(_l.a,{anchor:"left",open:v,classes:{paperAnchorLeft:l.swipeDrawer},onClose:function(){return x(!1)},onOpen:function(){return x(!0)}},r.a.createElement("div",{tabIndex:0,className:l.swipeDrawerContainer,role:"button",onClick:function(){return x(!1)},onKeyDown:function(){return x(!1)}},r.a.createElement(wi,{multiSelect:!1,columns:1,photos:t,onTileClick:function(e){b(t.find(function(t){return t.id===e})),x(!1)}}))))},Ul=Object(he.a)(function(e){return{root:{},formLabel:{color:e.palette.text.secondary},mapFormLabel:{marginTop:e.spacing(2),marginBottom:e.spacing(1),color:e.palette.text.secondary},map:{marginBottom:e.spacing(2)},mapWrapper:{marginBottom:e.spacing(2)},field:{marginBottom:e.spacing(2)}}}),$l=function(e){var t=e.photo,a=e.newSeries,o=e.onCancel,i=e.onSave,c=Ul(),s=Object(n.useState)(a||{}),u=Object(Pe.a)(s,2),p=u[0],d=u[1],m=Object(n.useState)(t),g=Object(Pe.a)(m,2),h=g[0],b=g[1];return r.a.createElement("div",{className:c.root},r.a.createElement(ge.a,null)," ",r.a.createElement(Re.a,{fullScreen:!0,fullWidth:!0,scroll:"paper",disableBackdropClick:!0,disableEscapeKeyDown:!0,onClose:o,"aria-labelledby":"customized-dialog-title",open:!0},r.a.createElement(_e.a,{disableTypography:!0,className:c.dlgTitleContainer},r.a.createElement(me.a,{variant:"h5",className:c.dlgTitle},"New Photo Properties")),r.a.createElement(Le.a,null,!!a&&r.a.createElement(Li,{series:a,delta:p,onChange:d}),r.a.createElement(yl,{photo:t,canEdit:!0,delta:h,onChange:function(e){return b(Object(l.a)({},h,e))}})),r.a.createElement(De.a,null,r.a.createElement(Ae.a,{onClick:o,color:"primary"},"Cancel"),r.a.createElement(Ae.a,{onClick:function(){return i(p,h)},color:"primary"},"Next"))))},Wl=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=Object(n.useRef)(),o=Object(n.useRef)(),i=r.a.createElement("input",{style:{display:"none"},ref:a,type:"file",accept:t?null:"image/*"});return Object(n.useEffect)(function(){var t=function(t){var n=Object(Va.a)(a.current.files)[0];if(n){console.log("file",n);var r=new FileReader;r.onloadend=function(){var t=n.type,a=n.name,o=n.size;e({dataUrl:r.result,type:t,name:a,size:o,ext:Gl(n)})},r.readAsDataURL(n)}a.current.value=null};return a.current&&(a.current.addEventListener("change",t),o.current||(a.current.click(),o.current=!0)),function(){a.current&&a.current.removeEventListener("change",t)}},[a.current]),{fileClickEl:i,forceClick:function(){a.current&&a.current.click()}}},Gl=function(e){switch(e.type){case"image/jpeg":case"image/jpg":return"jpeg";case"image/png":return"png";default:return"jpg"}},ql=Object(he.a)(function(e){return{root:{height:"100%",display:"flex",flexDirection:"column",textAlign:"center",color:e.palette.grey[600],border:"20px solid ".concat(e.palette.grey[400])},icon:{color:e.palette.grey[600],margin:"auto",flex:"1 1 50%",height:"70%",width:"70%"},button:{margin:e.spacing(2)}}}),Hl=function(e){var t=e.onLibraryAdd,a=e.onCancel,n=ql(),o=Wl(t),i=o.fileClickEl,l=o.forceClick;return r.a.createElement("div",{className:n.root},i,r.a.createElement(Br.a,{className:n.icon,color:"inherit",onClick:l}),r.a.createElement(Ae.a,{variant:"contained",className:n.button,color:"primary",onClick:l},"Import from Library"),r.a.createElement(Ae.a,{variant:"outlined",className:n.button,color:"secondary",onClick:a},"Cancel"))},Yl=a(143),Vl=a.n(Yl),Ql=function e(t,a){var n=this;Object(ke.a)(this,e),this.setMeta=function(){n.meta=JSON.stringify(n.config.getSeriesMeta())},this.newSeries=function(){return{id:"__LOCAL_SERIES::".concat(Vl()()),meta:JSON.stringify(n.config.getSeriesMeta()),photos:[]}},this.config=new vo.a(t),this.series=a||this.newSeries()},Xl="camera",Zl="library",Jl="photoreview",Kl="photoinfoedit",ec=function(e){var t=e.inputMethod,a=e.onCreate,o=e.onCancel,i=e.isNewSeries,c=Object(n.useContext)(ir),s=c.seriesConfig,u=c.series,p=Object(n.useState)(null),d=Object(Pe.a)(p,2),m=d[0],g=d[1],h=Object(n.useState)(i?new Ql(s).series:u),b=Object(Pe.a)(h,2),f=b[0],y=b[1],v=Object(n.useState)(new _o.a(s).photo),x=Object(Pe.a)(v,2),w=x[0],E=x[1],O=Object(n.useState)(null),k=Object(Pe.a)(O,2),S=k[0],j=k[1],C=Object(n.useState)({current:t,history:[]}),N=Object(Pe.a)(C,2),I=N[0],P=N[1],T=function(){var e=Object(n.useState)({absolute:!1,alpha:null,beta:null,gamma:null}),t=Object(Pe.a)(e,2),a=t[0],r=t[1];function o(e){r({absolute:e.absolute,alpha:e.alpha,beta:e.beta,gamma:e.gamma})}return Object(n.useEffect)(function(){return window.addEventListener("deviceorientation",o,!0),function(){window.removeEventListener("deviceorientation",o)}},[]),a}(),A=Ta(),R=!i&&u&&u.photos?u.photos:[],_=function(e){console.log("NEWPHOTO changeMode",I,e),P({current:e,history:[].concat(Object(Va.a)(I.history),[I.current])})},L=null;switch(I.current){case Xl:L=r.a.createElement(Bl,{photos:R,onShutter:function(e,t){g(e),console.log("onShutter Debug GOT DATA",{data:e});var a=Object(_o.b)(e.dataUrl),n=a.exif,r=a.exifGPS,o=String(Date.now()),c=A;c||(c=A&&r?r:[-123.1398254,49.3050394]),i&&y(Object(l.a)({},f,{coords:c}));var s=Object(l.a)({},w,{takenOn:o,rawData:JSON.stringify({exif:n,sensors:{orientation:T,geo:A}})});E(s),console.log("onShutter",s),j(t),_(Jl)},onCancel:o});break;case Zl:L=r.a.createElement(Hl,{onCancel:o,onLibraryAdd:function(e){console.log("onLibraryAdd Debug GOT DATA",{data:e,isNewSeries:i}),g(e);var t=Object(_o.b)(e.dataUrl),a=t.exif,n=t.exifDateTime,r=t.exifGPS,o=r,c=n||String(Date.now());if(!o)if(A&&A.latitude&&A.longitude){var s=A.latitude;o=[A.longitude,s]}else o=[-123.1398254,49.3050394];i&&y(Object(l.a)({},f,{coords:o})),console.log("LATLONG FOR LIB PICK",{coords:o,exifGPS:r,geo:A});var u=Object(l.a)({},w,{takenOn:c,rawData:JSON.stringify({exif:a,sensors:{orientation:T,geo:A}})});E(u),console.log("onLibraryAdd",u),_(Jl),console.log("onLibraryAdd FINISHED",u)}});break;case Jl:L=r.a.createElement(Rl,{defaultRefPhotoId:S,photos:R,captured:w,dataUrl:m.dataUrl,onConfirm:function(){return _(Kl)},onCancel:o,onRetry:function(){if(I.history.length>0){var e=Object(Va.a)(I.history),t=e.pop();P({current:t,history:e})}else o()}});break;case Kl:L=r.a.createElement($l,{photo:w,newSeries:f,onSave:function(e,t){return a(e,t,m)},onCancel:o});break;default:console.log("NEWPHOTO: default state. you should NEVER see this",I),o()}return L},tc=a(467),ac=a.n(tc),nc=function(){function e(t,a,n){var r=this;Object(ke.a)(this,e),this.ownOrAny=function(e){if(!e||!e.createdUser||!e.createdUser.id)throw new Error("No Created user found");try{return e.createdUser.id===r.userSub?"Own":"Any"}catch(t){return"Any"}},this.isOwner=function(e){if(!e||!e.createdUser||!e.createdUser.id)throw new Error("No Created user found");try{return e.createdUser.id===r.userSub}catch(t){return!1}},this.canUser=function(e,t,a,n){if(["series","photo"].indexOf(a)<0)throw new Error("canUser: type not supported ".concat(a));try{var o=r.ownOrAny(t),i=r.ac.can(r.role)["".concat(e).concat(o)](a),l=null;return"series"===a&&("PUBLIC"===t.access?l=r.ac.can(r.role)["".concat(e).concat(o)]("series_public"):"OPEN"===t.access&&(l=r.ac.can(r.role)["".concat(e).concat(o)]("series_open"))),n?l?!!i.attributes.find(function(e){return"*"===e||n.indexOf(e)>-1})||!!l.attributes.find(function(e){return"*"===e||n.indexOf(e)>-1}):!!i.attributes.find(function(e){return"*"===e||n.indexOf(e)>-1}):l?i.granted||l.granted:i.granted}catch(c){return console.error(c),!1}},this.userSub=t,this.role=a,this.permissionObj=n,this.ac=new ac.a(n)}return Object(Se.a)(e,[{key:"toString",value:function(){console.log("AccessHelper:",{sub:this.userSub,role:this.role})}}]),e}(),rc=Object(he.a)(Ei),oc=function(e){var t=e.onMenuBack,a=rc();return r.a.createElement("div",{className:a.root},r.a.createElement(ge.a,null),r.a.createElement(Bn.a,{position:"static",className:a.appBar},r.a.createElement(ra.a,{disableGutters:!0},r.a.createElement(Un.a,{className:a.menuButton,color:"inherit",onClick:t,"aria-label":"Menu"},r.a.createElement(qn.a,null)),r.a.createElement(me.a,{variant:"subtitle1",color:"inherit",className:a.toolbarTitle},"Series"))),r.a.createElement("div",{className:a.placeholderInner},r.a.createElement("div",{className:a.grow}),r.a.createElement(me.a,{className:a.placeholderText,variant:"h3"},"Series not found"),r.a.createElement("div",{className:a.grow})))},ic=a(969),lc=Object(he.a)(Ei),cc=function(e){var t=e.onMenuBack,a=lc();return r.a.createElement("div",{className:a.root},r.a.createElement(ge.a,null),r.a.createElement(Bn.a,{position:"static",className:a.appBar},r.a.createElement(ra.a,{disableGutters:!0},r.a.createElement(Un.a,{className:a.menuButton,color:"inherit",onClick:t,"aria-label":"Menu"},r.a.createElement(qn.a,null)),r.a.createElement(me.a,{variant:"subtitle1",color:"inherit",className:a.toolbarTitle},"Series"))),r.a.createElement("div",{className:a.placeholderInner},r.a.createElement("div",{className:a.grow}),r.a.createElement("div",{className:a.progressWrapper},r.a.createElement(ic.a,{className:a.progress,color:"inherit",size:150,thickness:5})),r.a.createElement(me.a,{className:a.placeholderText,variant:"h4"},"Loading..."),r.a.createElement("div",{className:a.grow})))},sc="series",uc="editseries",pc="newphoto",dc="newseries",mc="photoviewer",gc="newphotoviewer",hc="slideshow",bc=[sc,mc,hc],fc=function(e){var t=e.modeName,a=e.series,o=e.seriesConfig,i=e.inputMethod,c=e.currentUserId,s=e.currentUserRole,u=e.accessControl,p=e.initialPhoto,d=e.onChange,m=e.onClose,g=e.onDelete,h=e.onNewSeries,b=e.onChangePhoto,f=e.onNewPhoto,y=e.onDeletePhoto,v=e.loading,x=e.onWatch,w=e.onUnWatch,E=e.watching,O=e.owned,k=Object(n.useState)({series:a,seriesConfig:o,ac:u?new nc(c,s,u):null}),S=Object(Pe.a)(k,2),j=S[0],C=S[1],N=Object(n.useState)({current:{name:t||sc,pid:p,inputMethod:i},history:[]}),I=Object(Pe.a)(N,2),P=I[0],T=I[1];Object(n.useEffect)(function(){C(Object(l.a)({},j,{series:a})),T({current:{name:t||sc,pid:p,inputMethod:i},history:[]})},[a]);var A=function(e,t){var a=Object(l.a)({},j.series);a.photos=a.photos.map(function(e){return e.id===t.id?Object(l.a)({},e,t):e}),b(e,Object(l.a)({},t,{seriesId:a.id}))},R=function(){var e=Object(ft.a)(bt.a.mark(function e(t,n,r){return bt.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("RepeatablePhotos: waiting for photo ID",{newSeries:t,newPhoto:n,newPhotoData:r}),e.next=3,f(n,r);case 3:C(Object(l.a)({},j,{series:Object(l.a)({},a,{photos:[].concat(Object(Va.a)(a.photos),[n])})})),_(gc,n.id);case 5:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}(),_=function(e,t,n){var r=j.ac.canUser("update",a,"series");null===j&&m(),!r&&bc.indexOf(e)<0?console.error("ILLEGAL MODE CHANGE!!!!!",{from:P.current,to:e,canUpdate:r}):T({current:{name:e,pid:t,inputMethod:n},history:[].concat(Object(Va.a)(P.history),[P.current])})},L=function(){if(P.history.length>0){var e=Object(Va.a)(P.history),t=e.pop();T({current:t,history:e})}else m()},z=null;if(v)return r.a.createElement(cc,{onMenuBack:m});if(!j.series&&P.current.name!==dc)return r.a.createElement(oc,{onMenuBack:m});switch(P.current.name){case sc:z=r.a.createElement(ki,{onSlideshowStart:function(){return _(hc)},onChange:function(){console.log("onChange NOT IMPLEMENTED")},watching:E,owned:O,initialPhoto:p,onDeletePhotos:function(e){a.photos.filter(function(t){return e.indexOf(t.id)>-1}).forEach(function(e){return y(e)})},onDeleteSeries:g,onCameraAdd:function(){return _(pc,null,"camera")},onEditSeries:function(){return _(uc)},onLibraryAdd:function(){return _(pc,null,"library")},onTileClick:function(e){_(mc,e)},onMenuBack:m,onWatch:x,onUnWatch:w});break;case uc:z=r.a.createElement(Mi,{onCancel:function(){return _(sc)},onOk:function(e){d(a,Object(l.a)({},e,{id:a.id})),_(sc)}});break;case mc:z=r.a.createElement(Nl,{photos:j.series.photos,initPhotoId:P.current.pid,onMenuBack:L,onUpdatePhoto:A});break;case gc:z=r.a.createElement(Nl,{photos:j.series.photos,initPhotoId:P.current.pid,newPhoto:!0,onMenuBack:function(){return _(sc)},onUpdatePhoto:A});break;case hc:z=r.a.createElement(Gi,{photos:j.series.photos,onCancel:L});break;case pc:z=r.a.createElement(ec,{inputMethod:P.current.inputMethod,photos:a?a.photos:null,onCreate:R,onCancel:L});break;case dc:z=r.a.createElement(ec,{inputMethod:P.current.inputMethod,isNewSeries:!0,onCreate:h,onCancel:L});break;default:console.log("REPEATABLEPHOTO: default state. you should NEVER see this",j),z=null}return r.a.createElement(ir.Provider,{value:j},z)};fc.defaultProps={mode:sc};var yc=fc,vc=Object(s.d)(J,{props:function(e){var t=e.data;t.error&&console.error(t.error),console.log("getWholeSeries:: ",{data:t});var a=null;try{t.loading||t.error||(a=t.series)}catch(n){console.log("getWholeSeries:: error",{data:t,e:n}),console.error(n)}return{data:t,loading:t.loading,series:a}},skip:function(e){var t=e.activeSeries,a=e.isNewSeries;return!t||a},options:function(e){return{variables:{id:e.activeSeries}}}}),xc=Object(s.d)(it,{props:function(e){var t=e.mutate,a=e.ownProps;return{updateSeriesMutation:function(e,n){return t({variables:{series:Pc(n,["id","name","access","note","coords","direction"])},optimisticResponse:{updateSeries:Object(l.a)({},e,n,{__typename:"Series"})},update:function(e,t){t.data;var r=e.readQuery({query:J,variables:{id:a.activeSeries}});r.series=Object(l.a)({},r.series,n),e.writeQuery({query:J,data:r});try{var o=e.readQuery({query:$,variables:{limit:100}}),i=Pc(n,["id","name","access","coords","direction"]);o.allSeries.seriesSummaries=o.allSeries.seriesSummaries.map(function(e){return e.id!==i.id?e:Object(l.a)({},e,i)}),e.writeQuery({query:$,data:o})}catch(c){}}})}}}}),wc=Object(s.d)(lt,{props:function(e){var t=e.mutate,a=e.ownProps;return{updatePhotoMutation:function(e,n){var r=Pc(n,["id","seriesId","takenOn","tags","note"]);return r.tags&&r.tags.length>0&&(r.tags=r.tags.map(function(e){var t=Pc(e,["label","typeId","coords"]);return t.coords&&(t.coords=Pc(t.coords,["x","y"])),t})),t({variables:{photo:r},optimisticResponse:{updatePhoto:Object(l.a)({},e,r,{__typename:"Photo"})},update:function(e,t){t.data;var o=e.readQuery({query:J,variables:{id:a.activeSeries}}),i=Object(l.a)({},r,{tags:r.tags?r.tags.map(function(e){var t=Object(l.a)({},e,{__typename:"Tag"});return t.coords=t.coords?Object(l.a)({},t.coords,{__typename:"ImageCoords"}):null,t}):[]});o.series.photos=o.series.photos.map(function(e){return e.id!==n.id?e:Object(l.a)({},e,i)}),e.writeQuery({query:J,data:o})}})}}}}),Ec=Object(s.d)(ot,{props:function(e){var t=e.mutate,a=e.ownProps;return{deleteSeriesMutation:function(){return t({variables:{id:a.activeSeries},optimisticResponse:{deleteSeries:a.activeSeries},update:function(e,t){var a=t.data;try{var n=e.readQuery({query:$,variables:{limit:100}});n.allSeries.seriesSummaries=n.allSeries.seriesSummaries.filter(function(e){return e.id!==a.deleteSeries}),e.writeQuery({query:$,data:n})}catch(r){}}})}}}}),Oc=Object(s.d)(rt,{props:function(e){var t=e.mutate,a=e.ownProps;return{deletePhotoMutation:function(e){return t({variables:{seriesId:a.series.id,photoId:e},optimisticResponse:{deletePhoto:e},update:function(e,t){var n=t.data;console.log("deletePhotoMutation start Manip:",JSON.stringify(n,null,2));var r,o=e.readQuery({query:J,variables:{id:a.activeSeries}});o.series.photos=o.series.photos.filter(function(e){return e.id!==n.deletePhoto}),r=o.series.photos.length,o.series.photoCount=r,e.writeQuery({query:J,data:o}),console.log("deletePhotoMutation start Manip WRITE:",o);try{var i=e.readQuery({query:$,variables:{limit:100}});console.log("deletePhotoMutation qdataAll:",i),i.allSeries.seriesSummaries=i.allSeries.seriesSummaries.map(function(e){return e.id!==n.deletePhoto?e:Object(l.a)({},e,{photoCount:null!==r?r:e.photoCount})}),e.writeQuery({query:$,data:i}),console.log("deletePhotoMutation qdataAll WRITE:",i)}catch(c){}console.log("Done Manip:",o.series.photos)}})}}}}),kc=Object(s.d)(st,{props:function(e){var t=e.mutate,a=e.ownProps;return{createSeriesMutation:function(e,n,r){var o=a.user,i={id:o.id,gravatar:o.gravatar,gravatarProfile:o.gravatarProfile,username:o.username,__typename:"UserSummary"};return e.access||(e.access="PRIVATE"),t({variables:{series:Pc(e,["name","note","access","coords","direction","meta"]),photo:Pc(n,["seriesId","takenOn","meta","rawData","coords","tags","note","uploadToken"]),ext:r},optimisticResponse:{createSeries:{series:{id:e.id,name:e.name,note:e.note||null,access:e.access,meta:e.meta||null,featured:null,latest:null,coords:e.coords||null,direction:e.direction||null,photoCount:1,createdUser:i,updatedUser:i,createdBy:i.id,updatedBy:i.id,createdOn:Date.now().toString(),updatedOn:Date.now().toString(),watchers:0,photos:[{id:n.id,meta:n.meta||null,seriesId:e.id,createdOn:Date.now().toString(),createdUser:i,updatedUser:i,createdBy:i.id,updatedBy:i.id,uploadToken:n.uploadToken,updatedOn:Date.now().toString(),seriesCreatedBy:i.id,takenOn:n.takenOn,coords:n.coords||null,tags:n.tags||[],paths:{base:null,large:null,orig:null,thumb:null,medium:null,__typename:"Paths"},__typename:"Photo"}],__typename:"Series"},preAuth:null,__typename:"NewSeries"}},update:function(e,t){var n=t.data;console.log("createSeriesMutation:: STARTING TO CREATE THE SERIES",{data:n,store:e,ownProps:a});try{var r=e.readQuery({query:$,variables:{limit:100}}),o=Pc(n.createSeries.series,["id","name","access","updatedOn","updatedOn","createdUser","createdOn","featured","latest","coords","photoCount","seriesStatus","direction","watchers"]);r.allSeries.seriesSummaries.push(o),e.writeQuery({query:$,data:r})}catch(i){console.log("ERROR: createSeriesMutation:: updating allSeries failed")}console.log("Series.connect: createSeriesMutation:: Setting new series id:",n.createSeries),a.doneCreatingSeries(n.createSeries.series.id)}})}}}}),Sc=Object(s.d)(ct,{props:function(e){var t=e.mutate,a=e.ownProps;return{createPhotoMutation:function(e,n,r){n.fileBlob;var o=Object(c.a)(n,["fileBlob"]);!o.seriesId&&a.activeSeries&&(o.seriesId=a.activeSeries);var i=a.user,s={id:i.id,gravatar:i.gravatar,gravatarProfile:i.gravatarProfile,username:i.username,__typename:"UserSummary"};return console.log("createPhotoMutation::",{newPhotoInput:o,series:e,ext:r}),t({variables:{photo:Pc(o,["seriesId","takenOn","meta","rawData","coords","tags","note","uploadToken"]),ext:r},optimisticResponse:{createPhoto:{photo:{id:o.id,meta:o.meta||null,seriesId:o.seriesId,createdOn:Date.now().toString(),createdUser:s,updatedUser:s,createdBy:s.id,updatedBy:s.id,uploadToken:o.uploadToken,updatedOn:Date.now().toString(),seriesCreatedBy:e.createdUser.id,takenOn:o.takenOn,coords:o.coords||null,tags:o.tags||[],paths:{base:null,large:null,orig:null,thumb:null,medium:null,__typename:"Paths"},__typename:"Photo"},preAuth:null,__typename:"NewPhoto"}},update:function(){var e=Object(ft.a)(bt.a.mark(function e(t,a){var n,r,o;return bt.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=a.data;try{(r=t.readQuery({query:J,variables:{id:n.createPhoto.photo.seriesId}})).series.photos=r.series.photos=[].concat(Object(Va.a)(r.series.photos),[n.createPhoto.photo]),t.writeQuery({query:J,data:r})}catch(i){console.log("createPhotoMutation:: getWholeSeries ERROR")}o=null;try{o=t.readQuery({query:$,variables:{limit:100}}),console.log("createPhotoMutation:: qdataAll:",o),o.allSeries.seriesSummaries=o.allSeries.seriesSummaries.map(function(e){return e.id!==n.createPhoto.photo.seriesId?e:Object(l.a)({},e,{photoCount:e.photoCount+1,latest:Pc(n.createPhoto.photo,["id","takenOn","seriesCreatedBy","updatedOn","createdOn","seriesId","createdUser","paths"])})}),t.writeQuery({query:$,data:o}),console.log("createPhotoMutation:: qdataAll: WRITE",o)}catch(i){console.log("createPhotoMutation:: allSeries ERROR")}case 4:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}()})}}}}),jc=Object(s.d)(ut,{props:function(e){var t=e.mutate,a=e.ownProps;return{watchSeriesMutation:function(){return t({variables:{seriesId:a.activeSeries},optimisticResponse:{watchSeries:a.activeSeries},update:function(e,t){var a=t.data,n=e.readQuery({query:V});n.user.watching=Object(Va.a)(new Set([].concat(Object(Va.a)(n.user.watching||[]),[a.watchSeries]))),e.writeQuery({query:V,data:n});var r=e.readQuery({query:X});console.log("DEBUG",r)}})}}}}),Cc=Object(s.d)(pt,{props:function(e){var t=e.mutate,a=e.ownProps;return{unWatchSeriesMutation:function(){return t({variables:{seriesId:a.activeSeries},optimisticResponse:{unWatchSeries:a.activeSeries},update:function(e,t){var a=t.data,n=e.readQuery({query:V});n.user.watching=n.user.watching.filter(function(e){return e!==a.unWatchSeries}),e.writeQuery({query:V,data:n})}})}}}}),Nc=Object(s.c)(vc,kc,Sc,xc,wc,Ec,Oc,jc,Cc)(function(e){var t=e.series,a=e.loading,o=e.domain,i=e.activeSeries,l=e.initialPhoto,c=e.onAfterSeriesDelete,s=e.onBack,u=e.queueUpload,p=e.createSeriesMutation,d=e.createPhotoMutation,m=e.updateSeriesMutation,g=e.updatePhotoMutation,h=e.deleteSeriesMutation,b=e.deletePhotoMutation,f=e.watchSeriesMutation,y=e.unWatchSeriesMutation,v=Object(n.useContext)(de),x=v.role,w=v.currentUser,E=v.user,O=v.signedIn,k=v.isIos,S=v.onAvatarClick,j=v.getPhotoUrl,C="camera";o===Lt.NEW_SERIES_CAMERA?C="camera":o===Lt.NEW_SERIES_LIBRARY&&(C="library");var N=sc;o!==Lt.SERIES&&(N=dc);var I={meta:{},tags:[{isIos:k,id:"freeBothType",label:null,color:At[0],allowXY:!0,allowNonXY:!0,allowAdditions:!0,getValues:function(){return Promise.resolve(["a","b","c"])},imgStore:Gt,values:[]}],onAvatarClick:S,getPhotoUrl:j};return console.log("[SERIESCONNECT]",{series:t,loading:a}),r.a.createElement(xe.a,{theme:pe.series},r.a.createElement(yc,{modeName:N,inputMethod:C,owned:O&&E&&t&&E.id===t.id,watching:O&&E&&E.watching&&E.watching.indexOf(i)>-1,currentUserId:O?w.attributes.sub:null,currentUserRole:x,accessControl:Fn,loading:a,series:t,initialPhoto:l,seriesConfig:I,onNewPhoto:function(){var e=Object(ft.a)(bt.a.mark(function e(a,n){return bt.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("onNewPhoto::",{newPhoto:a,newPhotoData:n}),e.next=3,Gt.setItem(a.uploadToken,n);case 3:return e.abrupt("return",d(t,a,n.ext).then(function(e){var t=e.data,a=t.createPhoto.photo;if(t.createPhoto.preAuth){var n=JSON.parse(t.createPhoto.preAuth);u({id:a.id,uploadToken:a.uploadToken,seriesId:a.seriesId,preAuth:n})}}).catch(function(e){console.log("onNewPhoto:: Graphql Error",e.stack),console.error(e)}));case 4:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),onChangePhoto:function(e,t){return g(e,t).catch(function(e){console.log("onChangePhoto:: Graphql Error",e.stack),console.error(e)})},onDeletePhoto:function(e){return b(e.id).then(function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];console.log("onDeletePhoto:: photo deleted",t)}).catch(function(e){console.log("onDeletePhoto:: Graphql Error",e.stack),console.error(e)})},onChange:function(e,t){return m(e,t).catch(function(e){console.log("onChange:: Graphql Error",e.stack),console.error(e)})},onNewSeries:function(){var e=Object(ft.a)(bt.a.mark(function e(t,a,n){return bt.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Series.connect:: onNewSeries starting",{newSeries:t,newPhoto:a,newPhotoData:n}),e.next=3,Gt.setItem(a.uploadToken,n);case 3:return e.abrupt("return",p(t,a,n.ext).then(function(){var e=Object(ft.a)(bt.a.mark(function e(t){var a,n,r;return bt.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:(a=t.data).createSeries.preAuth&&(n=a.createSeries.series.photos[0],console.log("Series.connect:: done createSeriesMutation",a),r=JSON.parse(a.createSeries.preAuth),u({id:n.id,uploadToken:n.uploadToken,seriesId:n.seriesId,preAuth:r}));case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()).catch(function(e){console.log("onNewSeries:: Graphql Error",e.stack),console.error(e)}));case 4:case"end":return e.stop()}},e)}));return function(t,a,n){return e.apply(this,arguments)}}(),onDelete:function(){return h().then(c).catch(function(e){console.log("onDelete:: Graphql Error",e.stack),console.error(e)})},onClose:s,onWatch:O?f:null,onUnWatch:O?y:null}))}),Ic=Object(Te.b)(function(e,t){var a=e.home.current;return{activeSeries:a.activeSeries,initialPhoto:a.initialPhoto,domain:a.domain}},function(e){return{onBack:function(){e(ln())},onAfterSeriesDelete:function(t,a){e(on(Lt.FEED))},queueUpload:function(t){e(dn(t))},doneCreatingSeries:function(t){e(on(Lt.SERIES,{activeSeries:t}))}}})(Nc);function Pc(e,t){var a=[].concat(Object(Va.a)(t),["__typename"]),n=Object.keys(e).filter(function(e){return a.indexOf(e)>-1});return console.log("sanitizeUpdateParams",{orig:Object.keys(e),remainder:n}),n.reduce(function(t,a){return Object(l.a)({},t,Object(Fa.a)({},a,e[a]))},{})}var Tc=a(468),Ac=a.n(Tc),Rc=a(86),_c=function(e,t,a,r,o,i){var l=Object(n.useState)([]),c=Object(Pe.a)(l,2),s=c[0],u=c[1],p=Object(n.useState)({single:[],cluster:[]}),d=Object(Pe.a)(p,2),m=d[0],g=d[1],h=Object(n.useState)(0),b=Object(Pe.a)(h,2),f=b[0],y=b[1],v=Object(n.useCallback)(Object(Ba.a)(Object(ft.a)(bt.a.mark(function e(){var t,a=arguments;return bt.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Lc.apply(void 0,a);case 2:t=e.sent,u(t),y(f+1);case 5:case"end":return e.stop()}},e)})),1e3),[]),x=Object(n.useCallback)(Object(Ba.a)(Object(ft.a)(bt.a.mark(function e(){var t,a=arguments;return bt.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,zc.apply(void 0,a);case 2:t=e.sent,g(t);case 4:case"end":return e.stop()}},e)})),300),[]);return Object(n.useEffect)(function(){v(e,o,r)},[e.length,i]),Object(n.useEffect)(function(){x(s,t,a)},[s,a,t,f]),{filteredClusteredData:m}},Lc=function(e,t,a){if(!e)return[];var n=Ac()(9,[".x",".y",".x",".y"]),r=new mr.a(Object(l.a)({},a,{zoom:0})),o=e.map(function(e){var t=[0,0];try{t=r.project(e.coords)}catch(n){console.error(n)}e.longitude,e.latitude;var a=Object(c.a)(e,["longitude","latitude"]);return{x:t[0],y:t[1],photoCount:a.photoCount,zoomLevels:[],geoJSON:e.coords?Object(Rc.point)(e.coords,Object(l.a)({},a)):null}});n.clear(),n.load(o);for(var i=function(e){var a=t/Math.sqrt(2)/Math.pow(2,e);o.forEach(function(t){if(void 0===t.zoomLevels[e]){var r=t.x,o=t.y,i=n.search({minX:r-a,minY:o-a,maxX:r+a,maxY:o+a}).filter(function(t){return void 0===t.zoomLevels[e]});i.forEach(function(a){if(a===t){var n=1===i.length?t.geoJSON:Object(Rc.centroid)(Object(Rc.featureCollection)(i.map(function(e){return e.geoJSON})));n.properties=Object(l.a)({},n.properties,{id:n.properties.id||Vl()(),count:i.length,reducedPhotoCount:i.reduce(function(e,t){var a=t.photoCount;return a?e+a:e},0),points:i.map(function(e){return e.geoJSON})}),t.zoomLevels[e]=n}else a.zoomLevels[e]=null})}})},s=0;s<=20;s++)i(s);return o.map(function(e){return e.zoomLevels})};function zc(e,t,a){return e.filter(function(e){return!!e[a]}).reduce(function(e,n){var r=n[a],o=r.geometry.coordinates,i=r.properties.count;return(!t||t.length<4||t[0]<o[0]&&t[1]<o[1]&&t[2]>o[0]&&t[3]>o[1])&&(i>1?e.cluster.push(r):e.single.push(r)),e},{single:[],cluster:[]})}var Mc=ye()(r.a.createElement(r.a.Fragment,null,r.a.createElement("path",{d:"M16.432,6.104c-2.671,-1.06 -6.842,4.123 -6.572,5.826c-3.78,-7.611 2.788,-8.409 3.682,-10.699c0.64,1.255 5.18,2.608 2.89,4.873Z"}),r.a.createElement("path",{d:"M9.159,5.228c-2.254,1.782 0.149,7.986 1.76,8.604c-8.482,-0.532 -5.889,-6.619 -7.425,-8.538c1.407,0.073 4.848,-3.183 5.665,-0.066Z"}),r.a.createElement("path",{d:"M4.727,11.059c0.417,2.844 6.991,3.864 8.331,2.779c-4.701,7.079 -8.676,1.79 -11.106,2.161c0.766,-1.183 -0.332,-5.791 2.775,-4.94Z"}),r.a.createElement("path",{d:"M7.561,17.813c2.671,1.061 6.842,-4.122 6.572,-5.826c3.781,7.611 -2.788,8.409 -3.681,10.699c-0.641,-1.255 -5.181,-2.607 -2.891,-4.873Z"}),r.a.createElement("path",{d:"M14.828,18.736c2.254,-1.783 -0.149,-7.987 -1.76,-8.605c8.482,0.532 5.889,6.619 7.425,8.538c-1.407,-0.072 -4.849,3.183 -5.665,0.067Z"}),r.a.createElement("path",{d:"M19.26,12.904c-0.417,-2.843 -6.991,-3.864 -8.331,-2.778c4.701,-7.08 8.676,-1.791 11.106,-2.162c-0.767,1.183 0.332,5.791 -2.775,4.94Z"})),"AppLogoSimple"),Dc=ye()(r.a.createElement(r.a.Fragment,null,r.a.createElement("path",{d:"M21.229,18.388c-0.346,0.799 -0.756,1.535 -1.23,2.211c-0.647,0.922 -1.176,1.56 -1.584,1.914c-0.632,0.582 -1.31,0.88 -2.036,0.897c-0.521,0 -1.149,-0.148 -1.88,-0.449c-0.734,-0.299 -1.408,-0.448 -2.025,-0.448c-0.646,0 -1.34,0.149 -2.081,0.448c-0.743,0.301 -1.342,0.457 -1.799,0.473c-0.696,0.03 -1.39,-0.277 -2.082,-0.921c-0.442,-0.385 -0.995,-1.046 -1.657,-1.982c-0.71,-0.999 -1.294,-2.158 -1.752,-3.48c-0.49,-1.427 -0.735,-2.809 -0.735,-4.147c0,-1.533 0.331,-2.855 0.994,-3.963c0.521,-0.89 1.215,-1.591 2.083,-2.107c0.868,-0.515 1.806,-0.778 2.816,-0.794c0.553,0 1.278,0.17 2.179,0.506c0.898,0.338 1.474,0.509 1.727,0.509c0.189,0 0.83,-0.2 1.916,-0.599c1.027,-0.369 1.894,-0.522 2.604,-0.462c1.924,0.155 3.37,0.914 4.331,2.28c-1.721,1.043 -2.572,2.503 -2.555,4.377c0.016,1.459 0.545,2.674 1.585,3.638c0.472,0.447 0.999,0.793 1.584,1.039c-0.127,0.368 -0.261,0.721 -0.403,1.06Zm-4.413,-17.366c0,1.144 -0.418,2.212 -1.251,3.2c-1.005,1.176 -2.221,1.855 -3.54,1.748c-0.017,-0.138 -0.026,-0.282 -0.026,-0.434c0,-1.098 0.478,-2.273 1.327,-3.234c0.423,-0.486 0.962,-0.891 1.616,-1.214c0.652,-0.318 1.269,-0.493 1.85,-0.523c0.016,0.152 0.024,0.305 0.024,0.457l0,0Z"})),"Apple"),Fc=Object(he.a)(function(e){return{root:{},icon:{height:50,width:"100%",margin:"0 auto",color:e.palette.error.main},title:{}}}),Bc=function(e){var t=e.title,a=e.message,n=e.onClose,o=e.open,i=e.icon,l=Fc(),c=i||Dc;return r.a.createElement(Re.a,{className:l.root,disableBackdropClick:!0,fullWidth:!0,open:o,disableEscapeKeyDown:!0,maxWidth:"xl","aria-labelledby":"confirmation-dialog-title"},r.a.createElement(_e.a,{id:"confirmation-dialog-title",className:l.title},t),r.a.createElement(Le.a,null,r.a.createElement(c,{className:l.icon}),r.a.createElement(me.a,{component:"div"},a)),r.a.createElement(De.a,null,r.a.createElement(Ae.a,{onClick:n,color:"primary"},"Ok")))},Uc=a(469),$c=a.n(Uc),Wc=a(470),Gc=a.n(Wc),qc=a(305),Hc=a.n(qc),Yc=Object(he.a)(function(e){return{drawerInner:{width:250,display:"flex",flexDirection:"column",height:"100%"},disableListItem:{color:"rgba(0, 0, 0, 0.26)"},avatar:{height:e.spacing(7),width:e.spacing(7),border:"3px solid ".concat(e.palette.primary.main),margin:e.spacing(0,1)},gravatarImg:{width:"100%"},spacer:{flexGrow:1},fullList:{width:"auto"}}}),Vc=function(e){var t=e.open,a=e.onOpen,o=e.onClose,i=e.onDisabledClick,l=Yc(),c=Object(n.useContext)(de),s=c.signOut,u=c.signedIn,p=c.forceSignIn,d=c.user,m=c.onQRClick,g=c.addToHomeScreen,h=c.isIos;return r.a.createElement(_l.a,{open:t,onClose:o,onOpen:a},r.a.createElement("div",{className:l.drawerInner,role:"presentation",onClick:o,onKeyDown:o},d&&d.username&&r.a.createElement(Zr.a,null,r.a.createElement(Jr.a,{className:l.root,onClick:function(){},disableGutters:!0},r.a.createElement(eo.a,{className:l.avatar},u&&d?r.a.createElement("img",{alt:"profile",className:l.gravatarImg,src:d.gravatar}):r.a.createElement(Hc.a,{color:"inherit",className:l.loginButton}))),r.a.createElement(Jr.a,{className:l.root,onClick:function(){}},r.a.createElement(Vr.a,{primary:d.username}))),r.a.createElement(Qr.a,null),r.a.createElement(Zr.a,null,r.a.createElement(Jr.a,{className:h?l.disableListItem:null,button:!0,onClick:h?i:m},r.a.createElement(Yr.a,null,r.a.createElement(sr,null)),r.a.createElement(Vr.a,{primary:"Scan QR Code"})),g&&r.a.createElement(Jr.a,{button:!0,onClick:g},r.a.createElement(Yr.a,null,r.a.createElement($c.a,null)),r.a.createElement(Vr.a,{primary:"Install this app",secondary:"It works better!"}))),r.a.createElement("div",{className:l.spacer}),r.a.createElement(Qr.a,null),r.a.createElement(Zr.a,null,u?r.a.createElement(Jr.a,{button:!0,onClick:s},r.a.createElement(Yr.a,null,r.a.createElement(Gc.a,null)),r.a.createElement(Vr.a,{primary:"Sign Out"})):r.a.createElement(Jr.a,{button:!0,onClick:p},r.a.createElement(Yr.a,null,r.a.createElement(Hc.a,null)),r.a.createElement(Vr.a,{primary:"Sign In"})))))},Qc=Object(he.a)(function(e){return{root:{display:"flex",alignItems:"center",width:"100%",padding:e.spacing(0,1),backgroundColor:e.palette.primary.main,color:e.palette.primary.contrastText,borderBottom:"2px solid ".concat(e.palette.primary),background:"linear-gradient(90deg, ".concat(e.palette.secondary.main," 0%, ").concat(e.palette.primary.main," 100%)")},searchIcon:{opacity:.3,marginRight:e.spacing(1)},transparent:{backgroundColor:"transparent",background:"none",color:e.palette.text.primary},iOsIcon:{color:"rgba(0, 0, 0, 0.26)"},logo:{padding:e.spacing(0,0),height:40,width:40},transparentLogo:{background:"linear-gradient(90deg, ".concat(e.palette.secondary.main," 0%, ").concat(e.palette.primary.main," 100%)"),padding:e.spacing(.5,.5)},transparentLogoIcon:{color:"white",height:35,width:35},children:{flexGrow:1,padding:e.spacing(0,1)},qrButton:{padding:e.spacing(0,0)},qrButtonTransparent:{background:"white",padding:e.spacing(.5,.5)}}}),Xc=function(e){var t=e.className,a=e.children,o=e.isTransparent,i=(e.menuItems,e.hideLogo),l=Qc(),c=Object(n.useState)(!1),s=Object(Pe.a)(c,2),u=s[0],p=s[1],d=Object(n.useState)(!1),m=Object(Pe.a)(d,2),g=m[0],h=m[1],b=Object(n.useContext)(de),f=b.onQRClick,y=b.isIos;return r.a.createElement(r.a.Fragment,null,r.a.createElement(Bn.a,{position:"static"},r.a.createElement(ra.a,{className:jn()(l.root,t,o?l.transparent:null),disableGutters:!0},!i&&r.a.createElement(Un.a,{className:o?l.transparentLogo:l.logo,color:"inherit",onClick:function(){return h(!0)}},r.a.createElement(Mc,{className:o?l.transparentLogoIcon:l.logo})),r.a.createElement("div",{className:l.children},a),r.a.createElement(Un.a,{color:"inherit",className:jn()(y?l.iOsIcon:null,o?l.qrButtonTransparent:l.qrButton),"aria-label":"Menu",onClick:y?function(){return p(!0)}:f},r.a.createElement(sr,{color:"inherit"})))),r.a.createElement(Vc,{open:g,onClose:function(){return h(!1)},onOpen:function(){return h(!0)},onDisabledClick:function(){return p(!0)}}),y&&r.a.createElement(Bc,{open:u,title:"iOS Feature Disabled",message:r.a.createElement(me.a,{variant:"body2",component:"div"},r.a.createElement("p",null,"This feature cannot function due to a bug in iOS 12 that prevents ",r.a.createElement("strong",null,"direct camera access from progressive web apps"),"."),r.a.createElement("p",null,"There is good evidence iOS 13 has things sorted. ETA from Apple is mid-September 2019.")),onClose:function(){return p(!1)}}))},Zc=function(e){return r.a.createElement(xe.a,{theme:pe.topbar},r.a.createElement(Xc,e))},Jc=a(979),Kc=a(471),es=a.n(Kc),ts=Object(he.a)(function(e){return{root:Object(Fa.a)({position:"relative",borderRadius:e.shape.borderRadius,backgroundColor:Object(ee.fade)(e.palette.common.white,.3),"&:hover":{backgroundColor:Object(ee.fade)(e.palette.common.white,.5)},marginRight:e.spacing(2),marginLeft:0,width:"100%"},e.breakpoints.up("sm"),{marginLeft:e.spacing(3),width:"auto"}),transparent:{backgroundColor:Object(ee.fade)(e.palette.common.white,.7),"&:hover":{backgroundColor:Object(ee.fade)(e.palette.common.white,.9)}},inputRoot:{color:"inherit",width:"100%"},inputInput:Object(Fa.a)({padding:e.spacing(1,1,1,4),transition:e.transitions.create("width"),width:"100%"},e.breakpoints.up("md"),{width:200}),searchIcon:{width:e.spacing(4),height:"100%",position:"absolute",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"}}}),as=function(e){var t=e.autoFocus,a=e.disabled,o=e.onChange,i=e.onClick,l=e.defaultValue,c=e.isTransparent,s=Object(n.useRef)(),u=ts(),p=Object(n.useCallback)(Object(Ba.a)(o,500),[o]);return Object(n.useLayoutEffect)(function(){s.current&&!t&&(console.log("Setting blur"),s.current.blur())},[t]),r.a.createElement("div",{className:jn()(u.root,c?u.transparent:null),onClick:i},r.a.createElement("div",{className:u.searchIcon},r.a.createElement(es.a,null)),r.a.createElement(Jc.a,{autoFocus:!a&&t,inputProps:{onBlur:function(){}},onChange:function(e){p(e.target.value)},placeholder:"Search\u2026",disabled:a,defaultValue:l,inputRef:s,classes:{root:u.inputRoot,input:u.inputInput}}))},ns=Object(he.a)(function(e){return{root:{margin:0,padding:e.spacing(1)},chipContainer:{display:"flex",width:"100%"},grow:{flexGrow:1},accessLabel:{padding:e.spacing(.5,.5)},accessPUBLIC:{color:"white",background:Bt.PUBLIC.color[900]},accessPRIVATE:{color:"white",background:Bt.PRIVATE.color[900]},accessOPEN:{color:"white",background:Bt.OPEN.color[900]},img:{verticalAlign:"top",objectFit:"cover",height:"100%",width:"100%"},text:{height:"115px",margin:0,padding:e.spacing(0,1),alignSelf:"flex-start",display:"flex",flexDirection:"column"},titleText:{textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"},dateContainer:{display:"flex"},dateLabel:{fontWeight:"bold",flex:"1 1 50px"},dateText:{},imgFiller:{flexGrow:1,background:e.palette.text.primary},imgContainer:{flex:"0 0 115px",alignSelf:"flex-start",height:"100%",minHeight:115,display:"flex",flexDirection:"column"}}}),rs=function(e){var t=e.series,a=e.loading,o=e.onClick,i=e.children,l=e.showCreatedOn,c=e.showLastPhoto,s=ns(),u=Object(n.useContext)(de).seriesConfig;if(a||!t)return"LOADING...";var p=null,d=Bt.PRIVATE.label;try{p=u.getPhotoUrl(t.featured,"thumb"),d=t.access?Bt[t.access].label:Bt.PRIVATE.label}catch(m){console.error(m)}return r.a.createElement(Jr.a,{className:s.root,button:!0,component:"div",disableGutters:!0},r.a.createElement("div",{className:s.imgContainer,onClick:o},r.a.createElement("div",{className:s.imgFiller},r.a.createElement("img",{alt:"thumbnail",src:p,className:s.img})),t.access&&r.a.createElement(me.a,{className:jn()(s.accessLabel,s["access".concat(t.access)]),variant:"caption",component:"div"},"".concat(t.photoCount||0," Photos")," ",r.a.createElement("em",null,"(",d,")"))),r.a.createElement(Vr.a,{className:s.text,disableTypography:!0,onClick:o},r.a.createElement(me.a,{variant:"body1",component:"div",className:s.titleText},t.name||a),r.a.createElement(me.a,{variant:"body2",component:"div"},r.a.createElement("strong",null,"Created by:")," ",t.createdUser.username),r.a.createElement("div",{className:s.grow}),l&&r.a.createElement("div",{className:s.dateContainer},r.a.createElement(me.a,{variant:"caption",className:s.dateLabel},"Created:"),r.a.createElement(me.a,{variant:"caption",className:s.dateText},Object(yo.d)(t.createdOn,"lll"))),c&&r.a.createElement("div",{className:s.dateContainer},r.a.createElement(me.a,{variant:"caption",className:s.dateLabel},"Last Photo:"),r.a.createElement(me.a,{variant:"caption",className:s.dateText},Object(yo.d)(t.latest.takenOn,"lll")))),i)},os=rs,is=a(472),ls=a.n(is),cs=Object(he.a)(function(e){return{root:{}}}),ss=function(e){var t=e.seriesCount,a=e.reducedPhotoCount,n=e.onZoomTo,o=(e.onClose,cs());return console.log("cluster selected",{seriesCount:t,reducedPhotoCount:a}),r.a.createElement(Zr.a,null,r.a.createElement(Jr.a,{className:o.root},r.a.createElement(Yr.a,{onClick:n},r.a.createElement(ls.a,null)),r.a.createElement(Vr.a,{onClick:n,primary:"".concat(t," Photo series"),secondary:"containing ".concat(a," individual photo").concat(1===a?"":"s")})))},us=Object(he.a)(function(e){return{root:{color:e.palette.primary.main,width:150,position:"absolute",top:"50%",left:"50%",textAlign:"center",transformOrigin:"50% 50%",transform:"translateY(-50%) translateX(-50%)"},rootActive:{zIndex:1e3},icon:{},avatar:{position:"relative",margin:"0 auto",background:"green",color:"white",border:"2px solid white",height:40,width:40,zIndex:120,"&.PUBLIC":{background:Bt.PUBLIC.color},"&.PRIVATE":{background:Bt.PRIVATE.color},"&.OPEN":{background:Bt.OPEN.color}},avatarActive:{background:"#FFFF00",color:"black",border:"2px solid black","&.PUBLIC":{background:"#FFFF00"},"&.PRIVATE":{background:"#FFFF00"},"&.OPEN":{background:"#FFFF00"}},badge:{zIndex:124,color:e.palette.secondary.contrastText,background:e.palette.secondary.main,transform:"scale(1) translate(30%, -30%)"},badgeActive:{color:e.palette.primary.contrastText,background:e.palette.primary.main},directionIndicator:{position:"absolute",top:20,left:"50%",zIndex:100},name:{color:"white",fontWeight:"bold",textShadow:"\n        0px 0px 4px #000000, \n        0px 0px 4px #000000 \n    ",zIndex:122,position:"relative"},nameActive:{color:"black",textShadow:"\n    0px 0px 2px #FFFFFF, \n    0px 0px 2px #FFFFFF,\n    0px 0px 4px #FFFFFF \n"}}}),ps=function(e){var t=e.name,a=e.access,n=e.onClick,o=e.active,i=e.photoCount,l=e.direction,c=us();return r.a.createElement("div",{className:jn()(c.root,o?c.rootActive:null,a)},r.a.createElement(So.a,{classes:{badge:jn()(c.badge,o?c.badgeActive:null,a)},badgeContent:i},r.a.createElement(eo.a,{className:jn()(c.avatar,o?c.avatarActive:null,a),onClick:n},r.a.createElement(zl.a,{className:c.icon,color:"inherit"}))),l&&l>=0?r.a.createElement("div",{className:c.directionIndicator},r.a.createElement("svg",{className:c.svgArc,version:"1.1",width:"100",height:"100",viewBox:"0, 0, 100, 100",style:{transform:"translateY(-50%) translateX(-50%) rotateZ(".concat(l,"deg)")}},r.a.createElement("path",{d:"M50,0 C60.946,0.151 72.136,3.514 80.675,10.56 L50,50 L19.325,10.56 C27.938,3.461 39,0.278 50,0 z",fill:"#009DC1",fillOpacity:"0.444",strokeWidth:"1",strokeOpacity:"0.6",stroke:"#FFFFFF"}))):null,r.a.createElement(me.a,{variant:"body1",className:jn()(c.name,o?c.nameActive:null)},t))},ds=a(232),ms=a.n(ds),gs=Object(he.a)(function(e){return{avatar:{background:e.palette.grey[900],border:"2px solid ".concat(e.palette.grey[100]),color:e.palette.grey[100]},avatarActive:{background:"#FFFF00",border:"2px solid black",color:"black",zIndex:1e3}}}),hs=function(e){var t=e.seriesCount,a=e.active,n=e.onClick,o=gs();return r.a.createElement(eo.a,{onClick:n,className:jn()(o.avatar,a?o.avatarActive:null)},ms()(t).format("0,0"))},bs=Object(he.a)(function(e){return{root:{position:"relative",height:"100%","& .myPosMarker":{zIndex:1},"& .singleMarker":{zIndex:3},"& .clusterMarker":{zIndex:2}},fab:{background:e.palette.secondary.main,color:e.palette.secondary.contrastText},topBar:{position:"absolute",zIndex:1e3,top:0},loadingWrapper:{position:"absolute",color:e.palette.text.primary,opacity:.5,zIndex:3e3,textAlign:"center",top:"50%",left:"50%",transform:"translateY(-50%) translateX(-50%)"},zoomOutFab:{margin:e.spacing(.5),padding:e.spacing(.5),border:"2px solid",borderRadius:e.spacing(1),background:e.palette.common.white,fontSize:20,position:"absolute",zIndex:100,bottom:e.spacing(2),right:e.spacing(10)},selectedPopup:{width:"90%",maxWidth:400,zIndex:2e3,position:"absolute",bottom:e.spacing(1),left:"50%",transformOrigin:"0% 50%",transform:"translateY(0%) translateX(-50%)"}}}),fs={zoom:4,latitude:44.629701,longitude:-120.333379},ys=function(e){var t=e.seriesList,a=e.initViewport,o=e.loading,i=e.activeSeries,c=e.queryVersion,s=e.onSeriesClick,u=e.onSearchClick,p=(e.popMapHistory,e.pushMapHistory),d=(e.clearMapHistory,Object(n.useState)({viewport:Object(l.a)({},fs,a.viewport),bounds:a.bounds,filterBounds:null})),m=Object(Pe.a)(d,2),g=m[0],h=m[1],b=bs(),f=Object(n.useRef)(),y=Object(n.useState)(!1),v=Object(Pe.a)(y,2),x=v[0],w=v[1],E=Object(n.useRef)(),O=Object(n.useState)(0),k=Object(Pe.a)(O,2),S=k[0],j=k[1],C=Object(n.useState)(null),N=Object(Pe.a)(C,2),I=N[0],P=N[1],T=Object(n.useState)(),A=Object(Pe.a)(T,2),R=A[0],_=A[1],L=_c(t||[],g.filterBounds,S,g.viewport,80,c).filteredClusteredData;Object(n.useEffect)(function(){if(i&&t&&!R)try{var e=t.find(function(e){return e.id===i});if(e&&e.coords){var a=Object(Rc.buffer)(Object(Rc.point)(e.coords),10,{units:"meters"}),n=Object(Rc.bbox)(a);h(Object(l.a)({},g,{bounds:n}))}}catch(r){console.error(r)}},[t]),Object(n.useEffect)(function(){if(i&&L.single&&!R)try{var e=L.single.find(function(e){return e.properties.id===i});e&&E.current&&_(e)}catch(t){console.error(t)}},[L.single]);var z=function(e){_(e),function(){var e=f.current?f.current:g.viewport,t=e.latitude,a=e.longitude,n=e.zoom,r=e.bearing,o=e.pitch,i=e.altitude;setTimeout(function(){return p({viewport:{latitude:t,longitude:a,zoom:n,bearing:r,pitch:o,altitude:i}})},2e3)}()},M=function(e){try{var t=Object(Rc.featureCollection)(e.properties.points),a=Object(Rc.bbox)(t),n=.2*(a[2]-a[0]),r=.2*(a[3]-a[1]),o=[a[0]-n,a[1]-r,a[2]+n,a[3]+r];P({transitionDuration:2e3,transitionInterpolator:new ur.a,transitionEasing:pr.a}),h(Object(l.a)({},g,{bounds:o})),e.properties.count>1&&setTimeout(function(){return z(null)},2e3)}catch(i){console.error(i)}},D=function(e){R&&R.properties.id===e.properties.id?M(R):(P({transitionDuration:500,transitionInterpolator:new ur.b,transitionEasing:pr.a}),h({viewport:{longitude:e.geometry.coordinates[0],latitude:e.geometry.coordinates[1]}})),z(e)},F=Object(n.useMemo)(function(){return[].concat(Object(Va.a)(L.single.map(function(e){return r.a.createElement(ur.c,{className:"singleMarker",key:"single-".concat(e.properties.id),latitude:e.geometry.coordinates[1],longitude:e.geometry.coordinates[0],offsetLeft:0,offsetTop:-20},r.a.createElement(ps,{name:e.properties.name,access:e.properties.access,photoCount:e.properties.photoCount,onClick:function(){return D(e)},direction:S>10&&e.properties.direction?e.properties.direction:null,active:R&&R.properties.id===e.properties.id}))})),Object(Va.a)(L.cluster.map(function(e){return r.a.createElement(ur.c,{className:"clusterMarker",key:"cluster-".concat(e.properties.id),latitude:e.geometry.coordinates[1],longitude:e.geometry.coordinates[0],offsetLeft:-20,offsetTop:-20},r.a.createElement(hs,{seriesCount:e.properties.count,photoCount:e.properties.reducedPhotoCount,onClick:function(){return D(e)},active:R&&R.properties.id===e.properties.id&&R.properties.count===e.properties.count}))})))},[L,R]),B=Object(n.useMemo)(function(){return!!R&&r.a.createElement(_a.a,{className:b.selectedPopup},1===R.properties.count?r.a.createElement(os,{series:R.properties,showCreatedOn:!0,showLastPhoto:!0,onClick:function(){return s(R.properties.id)}}):r.a.createElement(ss,{seriesCount:R.properties.count,reducedPhotoCount:R.properties.reducedPhotoCount,onClose:function(){return z(null)},onZoomTo:function(){return M(R)}}))},[R]);return r.a.createElement("div",{className:b.root,ref:E},r.a.createElement(Zc,{isTransparent:!0,className:b.topBar},r.a.createElement(as,{isTransparent:!0,onClick:u,defaultValue:""})),o&&r.a.createElement("div",{className:b.loadingWrapper},r.a.createElement(ic.a,{size:80,thickness:7,color:"inherit"})),r.a.createElement(Pr,Object.assign({showMe:!0,viewport:g.viewport,transitions:I,mapStyles:Nt,controlPadding:{top:56},initStyle:Nt.length>1?1:0},{},{onTransitionStart:function(){w(!0)},onTransitionEnd:function(){w(!1),P(null)},bounds:g.bounds,maxZoom:20,minZoom:1,onViewportChange:function(e){var t=e.viewport,a=e.map;f.current=t;var n=Math.floor(t.zoom);if(!x&&a&&a.getBounds){var r=a.getBounds(),o=r._sw,i=o.lng,c=o.lat,s=r._ne,u=s.lng,p=s.lat,d=g.filterBounds||[i,c,u,p],m=Object(Pe.a)(d,4),b=m[0],y=m[1],v=m[2],w=m[3];if(n!==S||b>=i||y>=c||v<=u||w<=p){var E=[i-(u-i)/2,c-(p-c)/2,u+(u-i)/2,p+(p-c)/2];h(Object(l.a)({},g,{filterBounds:E}))}}n!==S&&j(n)},onNativeClick:function(){R&&z(null)}}),F),B)},vs=20,xs=Object(s.d)($,{props:function(e){var t=e.data,a=e.ownProps;return!t.loading&&!t.error&&t.allSeries&&t.allSeries.seriesSummaries.length>0&&t.allSeries.nextToken?t.fetchMore({variables:Object(l.a)({},t.variables,{nextToken:t.allSeries.nextToken}),updateQuery:function(e,t){var a=t.fetchMoreResult;return{allSeries:Object(l.a)({},a.allSeries,{seriesSummaries:[].concat(Object(Va.a)(e.allSeries.seriesSummaries),Object(Va.a)(a.allSeries.seriesSummaries))})}}}):t.loading||t.error?a.setSeriesProps(t):a.setSeriesProps(Object(l.a)({},t,{readyForPolling:!0})),null},options:{variables:{limit:100}}}),ws=Object(s.d)(W,{skip:function(e){return!e.lastCheck},props:function(e){var t=e.data,a=e.ownProps,n=a.seriesProps,r=a.updateIncrement;if(t.error&&(console.log("POLL FAIL",t.error,t),console.error(t.error)),!t.loading&&t.changedSeries&&t.changedSeries.seriesSummaries){var o=t.changedSeries.seriesSummaries,i=n.allSeries.seriesSummaries;if(console.log("DEBUG",n),t.changedSeries){var s=n.allSeries.seriesSummaries;o.forEach(function(e){var t=e.seriesStatus,a=Object(c.a)(e,["seriesStatus"]);if("deleted"===t)console.log("Polling found a series to delete: ",a.id),s=i.filter(function(e){return e.id!==a.id});else{var o=i.findIndex(function(e){return e.id===a.id});o>=0?(console.log("Polling found a series to Update: ",a.id),s=i.map(function(e,t){return t===o?a:e})):(console.log("Polling found a series to add: ",a.id),s=[].concat(Object(Va.a)(i),[a]))}n.updateQuery(function(e,t){try{return Object(l.a)({},e).allSeries.seriesSummaries=s,r(),e}catch(a){return console.error(a),e}})})}}return null},options:function(e){return{variables:{limit:100,lastCheck:e.lastCheck}}}}),Es=xs(function(){return null}),Os=ws(function(){return null}),ks=Object(Te.b)(function(e,t){return{activeSeries:e.home.current.activeSeries,initViewport:e.map.slice(-1).pop()}},function(e){return{mapFuncs:{onSeriesClick:function(t){e(on(Lt.SERIES,{activeSeries:t}))},onSearchClick:function(){e(on(Lt.SEARCH,{search:{tab:zt.LOCATION,text:""}}))},popMapHistory:function(){e(sn())},pushMapHistory:function(t){e(un(t))},clearMapHistory:function(){e(pn())}}}})(function(e){var t=e.initViewport,a=e.activeSeries,o=e.mapFuncs,i=Object(n.useState)(),l=Object(Pe.a)(i,2),c=l[0],s=l[1],u=Object(n.useState)(0),p=Object(Pe.a)(u,2),d=p[0],m=p[1],g=function(){return m(d+1)},h=Object(n.useRef)(),b=Object(n.useState)(null),f=Object(Pe.a)(b,2),y=f[0],v=f[1];h.current=y;var x=Object(n.useMemo)(function(){return r.a.createElement(Es,{setSeriesProps:s})},[]),w=Object(n.useMemo)(function(){return r.a.createElement(Os,{lastCheck:y,seriesProps:c,updateIncrement:g})},[y]);return Object(n.useEffect)(function(){if(c)return!h.current&&c.readyForPolling&&(h.current=setInterval(function(){h.current&&v(String(Date.now()-1e3*vs))},1e3*vs)),function(){h.current&&(console.log("clear poll timer"),clearInterval(h.current),h.current=null)}},[c]),r.a.createElement(r.a.Fragment,null,x,w,r.a.createElement(ys,Object.assign({queryVersion:d,seriesList:c&&c.allSeries?c.allSeries.seriesSummaries:[],activeSeries:a,initViewport:t,loading:c&&c.loading},o)))}),Ss=a(159),js=a.n(Ss),Cs=a(241),Ns=a.n(Cs),Is=Object(he.a)(function(e){return{root:{},chosenItem:{color:e.palette.primary.contrastText,background:e.palette.primary.dark},avatar:{background:e.palette.primary.main},closeIcon:{color:e.palette.primary.contrastText,paddingRight:0},avatarImg:{height:"100%",width:"100%",objectFit:"cover"}}}),Ps=function(e){var t,a=e.className,n=e.variant,o=e.name,i=e.description,l=e.gravatar,c=e.onClick,s=e.onCancel,u=Is(),p=js.a;switch(n){case"tag":p=Co.a;break;case"location":p=js.a;break;case"user":p=l?(t=l,function(){return r.a.createElement(eo.a,{className:u.avatar},r.a.createElement("img",{className:u.avatarImg,alt:"profile",src:t}))}):Ns.a}return r.a.createElement(Jr.a,{className:jn()(a,u.root,s?u.chosenItem:null),button:!!c,onClick:c},r.a.createElement(Kr.a,null,r.a.createElement(eo.a,{className:u.avatar},r.a.createElement(p,{color:"inherit"}))),r.a.createElement(Vr.a,{disableTypography:!0},r.a.createElement(me.a,{variant:"body1",color:"inherit"},o),r.a.createElement(me.a,{variant:"body2",color:"inherit"},i)),s&&r.a.createElement(Yr.a,null,r.a.createElement(Un.a,{onClick:s,className:u.closeIcon},r.a.createElement(ro.a,{color:"inherit"}))))},Ts=Ps,As=Object(he.a)(function(e){return{root:{height:"100%",backgroundColor:e.palette.background.paper,position:"relative",overflowX:"hidden",overflowY:"scroll",flexGrow:1},listSection:{backgroundColor:"inherit"},placeholderText:{textAlign:"center",padding:e.spacing(3,1),color:e.palette.grey[400]},ul:{backgroundColor:"inherit",padding:0}}}),Rs=function(e){var t=e.variant,a=e.loading,n=e.contextResults,o=e.setContextChoice,i=As();return a?r.a.createElement(me.a,{className:i.placeholderText,variant:"h3"},"Searching..."):n&&0!==n.length?r.a.createElement(Zr.a,{className:i.root},n.map(function(e,a){return r.a.createElement(Ts,Object.assign({key:"scr-".concat(a),variant:t,onClick:function(){return o(e)}},e))})):r.a.createElement(me.a,{className:i.placeholderText,variant:"h4"},"No ",t," results")},_s=Object(he.a)(function(e){return{root:{textAlign:"center",fontStyle:"italic",padding:e.spacing(2,1)}}}),Ls=function(e){var t=e.style,a=e.icon,n=e.text,o=_s();return r.a.createElement(me.a,{className:o.root,variant:"subtitle1",color:"textSecondary",component:"div",style:t},a,n)},zs=Object(he.a)(function(e){return{root:{height:"100%",flexGrow:1,display:"flex",flexDirection:"column",overflow:"hidden"},ctxItem:{flexGrow:0},list:{flexGrow:1,backgroundColor:e.palette.background.paper,position:"relative",overflowX:"hidden",overflowY:"scroll"},placeholderText:{textAlign:"center",padding:e.spacing(3,1),color:e.palette.grey[400]},listSection:{backgroundColor:"inherit"},ul:{backgroundColor:"inherit",padding:0}}}),Ms=function(e){var t=e.variant,a=e.loading,o=e.seriesList,i=e.contextChoice,l=e.onCancel,c=e.onResultClick,s=e.fetchMore,u=zs(),p=Object(n.useRef)(),d=Object(n.useRef)(),m=Object(Ba.a)(function(){if(!a&&s&&d.current&&p.current){var e=d.current.offsetTop,t=p.current,n=t.scrollTop,r=t.offsetHeight;e<2*(r+n)&&(console.log("SCROLL",{offsetHeight:r,scrollTop:n,offsetTop:e}),s())}},500);Object(n.useEffect)(m,[o]);var g=null;return a?g=r.a.createElement(me.a,{className:u.placeholderText,variant:"h3"},"Searching..."):o&&o.length>0?(g=o.map(function(e,t){return r.a.createElement(os,{key:"series-".concat(t),series:e,onClick:function(){return c(e.id)},showCreatedOn:!0,showLastPhoto:!0})})).push(r.a.createElement("div",{key:"ender",ref:d},r.a.createElement(Ls,{text:s?"Loading...":"No More Results"}))):g=r.a.createElement(me.a,{className:u.placeholderText,variant:"h4"},"No series found"),r.a.createElement("div",{className:u.root},r.a.createElement(Ts,Object.assign({className:u.ctxItem},i,{variant:t,onCancel:l})),r.a.createElement(Zr.a,{className:u.list,subheader:r.a.createElement("li",null),onScroll:m,innerRef:p},g))},Ds=Object(he.a)(function(e){return{root:{flexGrow:1,padding:"10%",display:"flex",flexDirection:"column",opacity:.3,textAlign:"center"},icon:{width:"100%",flex:"1 1 40%",color:e.palette.primary.light,opacity:.5},primary:{flex:"1 1 30%",width:"100%"},secondary:{flex:"1 1 30%",width:"100%"}}}),Fs=function(e){var t=e.icon,a=e.primary,n=e.secondary,o=Ds(),i=t;return r.a.createElement("div",{className:o.root},r.a.createElement(i,{className:o.icon}),a&&r.a.createElement(me.a,{className:o.primary,variant:"h3"},a),n&&r.a.createElement(me.a,{className:o.secondary,variant:"h4"},n))},Bs=a(473),Us=a.n(Bs),$s=zt,Ws=Object(he.a)(function(e){return{root:{height:"100%",display:"flex",overflow:"hidden",flexDirection:"column"},tabs:{},ListWrapper:{flexGrow:1,overflow:"hidden",display:"flex",flexDirection:"column"},tab:{flexGrow:1},grow:{flexGrow:1}}}),Gs=function(e){e.onMenuBack;var t=e.currentTab,a=e.setCurrentTab,o=e.defaultText,i=e.searchText,l=e.setSearchText,c=e.contextResults,s=e.searchResults,u=e.contextChoice,p=e.loading,d=e.setContextChoice,m=e.onMapClick,g=e.onResultClick,h=e.fetchMore,b=Ws(),f=Da().online;Object(n.useEffect)(function(){c&&!s&&1===c.length&&d(c[0])},[c]);var y={};switch(t){case $s.TAG:y={primary:"Tag search",secondary:"example: 'beaver...'",icon:Co.a};break;case $s.USER:y={primary:"User search",secondary:"example: 'SuperGreg123...'",icon:Ns.a};break;case $s.LOCATION:y={primary:"Location Search",secondary:"example: 'Vancouver...'",icon:js.a}}var v=null;return v=f?u&&s?r.a.createElement(Ms,{variant:t,loading:p,onResultClick:g,fetchMore:h,seriesList:s,contextChoice:u,onCancel:function(){return d(null)}}):c?r.a.createElement(Rs,{loading:p,variant:t,contextResults:c,setContextChoice:t===$s.LOCATION?m:d}):o.length>0?r.a.createElement(me.a,null,"Searching for ","'".concat(i,"'")||"..."):r.a.createElement(Fs,y):r.a.createElement(Fs,{primary:"Search Disabled",secondary:"(Offline)",icon:Us.a}),r.a.createElement("div",{className:b.root},r.a.createElement(Zc,null,r.a.createElement(as,{disabled:!f,onChange:l,defaultValue:i})),f&&r.a.createElement($n.a,{value:t,disabled:!f,onChange:function(e,t){return a(t)},indicatorColor:"primary",classes:{flexContainer:b.tabs},centered:!0},r.a.createElement(Wn.a,{className:b.tab,value:$s.TAG,label:"Tags"}),r.a.createElement(Wn.a,{className:b.tab,value:$s.LOCATION,label:"Places"}),r.a.createElement(Wn.a,{className:b.tab,value:$s.USER,label:"Users"})),r.a.createElement("div",{className:b.ListWrapper},v))};Gs.defaultProps={currentTab:$s.TAGS,defaultText:""};var qs=Gs,Hs=Object(s.d)(Y,{props:function(e){var t=e.data;t.error&&console.error(t.error);var a=null;try{t.loading||t.error||(a=t.series)}catch(n){console.error(t),console.error(n)}return{contextResults:t.tags?t.tags.map(function(e){var t=e.name,a=e.count;return{name:t,description:"~ ".concat(a<10?a:10*Math.ceil(a/10)," Photo series tagged")}}):[],loading:t.loading,series:a}},options:function(e){var t=e.searchText;return{variables:{tag:!t||t.length<3?"":t,limit:10}}}}),Ys=Object(s.d)(Z,{props:function(e){var t=e.data;t.error&&console.error(t.error);var a=null;try{t.loading||t.error||(a=t.series)}catch(n){console.error(t),console.error(n)}return{contextResults:t.userSearch?t.userSearch.map(function(e){var t=e.username,a=e.gravatar,n=e.createdOn;return{name:t,id:e.id,description:"Joined ".concat(Object(yo.c)(n)),gravatar:a}}):[],loading:t.loading,series:a}},skip:function(e){var t=e.searchText;return!t||t.length<3},options:function(e){return{variables:{searchStr:e.searchText,limit:10}}}}),Vs=Object(s.d)(Q,{props:function(e){var t=e.data;t.error&&console.error(t.error);var a=null;try{t.loading||t.error||(a=t.series)}catch(n){console.error(t),console.error(n)}return{contextResults:t.geocoder?t.geocoder.map(function(e){var t=e.relevance;return{name:e.text,description:e.placeName,bbox:e.bbox,center:e.center,relevance:t}}):[],loading:t.loading,series:a}},skip:function(e){var t=e.searchText;return!t||t.length<3},options:function(e){return{variables:{search:e.searchText}}}}),Qs=Object(s.d)(H,{props:function(e){var t=e.data;t.error&&console.error(t.error);var a=null;try{t.loading||t.error||(a=t.series)}catch(r){console.error(t),console.error(r)}var n=!t.loading&&t.tagSeries&&t.tagSeries.nextToken?function(){console.log("fetchMore",t),t.fetchMore({variables:Object(l.a)({},t.variables,{nextToken:t.tagSeries.nextToken}),updateQuery:function(e,t){var a=t.fetchMoreResult;return{tagSeries:Object(l.a)({},a.tagSeries,{seriesSummaries:[].concat(Object(Va.a)(e.tagSeries.seriesSummaries),Object(Va.a)(a.tagSeries.seriesSummaries))})}}})}:null;return{searchResults:t.tagSeries&&t.tagSeries.seriesSummaries?t.tagSeries.seriesSummaries:[],fetchMore:n,loading:t.loading,series:a}},skip:function(e){return!e.contextChoice},options:function(e){return{variables:{tag:e.contextChoice.name,limit:10}}}}),Xs=Object(s.d)(G,{props:function(e){var t=e.data;t.error&&console.error(t.error);var a=null;try{t.loading||t.error||(a=t.series)}catch(r){console.error(t),console.error(r)}var n=!t.loading&&t.userSeries&&t.userSeries.nextToken?function(){console.log("fetchMore",t),t.fetchMore({variables:Object(l.a)({},t.variables,{nextToken:t.userSeries.nextToken}),updateQuery:function(e,t){var a=t.fetchMoreResult;return{userSeries:Object(l.a)({},a.userSeries,{seriesSummaries:[].concat(Object(Va.a)(e.userSeries.seriesSummaries),Object(Va.a)(a.userSeries.seriesSummaries))})}}})}:null;return{searchResults:t.userSeries&&t.userSeries.seriesSummaries?t.userSeries.seriesSummaries:[],fetchMore:n,loading:t.loading,series:a}},skip:function(e){return!e.contextChoice},options:function(e){return{variables:{createdBy:e.contextChoice.id,limit:10}}}}),Zs=Object(Te.b)(function(e,t){var a=e.home.current,n=a.search,r=a.activeSeries,o=a.domain;return{defaultTab:n?n.tab:null,defaultText:n?n.text:null,activeSeries:r,domain:o}},function(e){return{onBack:function(){e(ln())},queueUpload:function(t){e(dn(t))},jumpToSeries:function(t){e(on(Lt.SERIES,{activeSeries:t}))},jumpToMap:function(t){var a=t.bbox,n=t.center,r=a;if(!r&&n){var o=Object(Rc.buffer)(Object(Rc.point)(n),500,{units:"meters"});r=Object(Rc.bbox)(o)}r&&(e(un({mode:Mt.FREE,bounds:r})),e(on(Lt.MAP,{activeSeries:null,initialPhoto:null})))}}})(function(e){var t=e.jumpToMap,a=e.jumpToSeries,o=e.defaultTab,i=e.defaultText,l=e.fetchMore,c=Object(n.useState)(o||zt.TAG),u=Object(Pe.a)(c,2),p=u[0],d=u[1],m=Object(n.useState)(i||""),g=Object(Pe.a)(m,2),h=g[0],b=g[1],f=Object(n.useState)(null),y=Object(Pe.a)(f,2),v=y[0],x=y[1],w=null,E=null;switch(p){case zt.TAG:w=Hs,E=Qs;break;case zt.LOCATION:w=Vs;break;case zt.USER:w=Ys,E=Xs}var O=Object(n.useMemo)(function(){return E?Object(s.c)(w,E)(qs):w(qs)},[w,E]);return r.a.createElement(O,Object.assign({currentTab:p,searchText:h,contextChoice:v},{onMenuBack:function(){},onMapClick:t,onResultClick:a,setContextChoice:function(e){x(e)},fetchMore:l,setCurrentTab:function(e){x(null),d(e)},setSearchText:function(e){b(e),x(null)}}))}),Js=Object(he.a)(function(e){return{root:{},imgContainer:{flex:"0 0 100px",margin:e.spacing(1,1,0,2)},gravatarImg:{verticalAlign:"top"}}}),Ks=function(e){var t=e.user,a=e.loading,n=e.onAvatarClick,o=Js();return a||!t?"LOADING...":r.a.createElement(Jr.a,{className:o.root,onClick:n,disableGutters:!0},r.a.createElement(Yr.a,{className:o.imgContainer},r.a.createElement("img",{alt:"profile",className:o.gravatarImg,src:t.gravatar})),r.a.createElement(Vr.a,{primary:t.username,secondary:"Member since: ".concat(Object(yo.d)(t.createdOn,"LL"))}))},eu=Object(he.a)(function(e){return{root:{background:e.palette.background.paper,display:"flex",flexDirection:"column",height:"100%"},filterContainer:{color:e.palette.primary.secondary,background:e.palette.background.default,textAlign:"center",padding:e.spacing(1,1)},filterChip:{},seriesListItemWrap:{margin:e.spacing(1,.5)},seriesList:{height:"100%",overflowX:"hidden",overflowY:"scroll"},tabs:{},noneFound:{color:e.palette.text.secondary,textAlign:"center",padding:e.spacing(2)}}}),tu="Last Photo",au="Created",nu="Name",ru=function(e){var t=e.mySeries,a=e.watchingSeries,o=e.loading,i=e.jumpToSeries,l=(e.jumpToMap,eu()),c=Object(n.useState)(0),s=Object(Pe.a)(c,2),u=s[0],p=s[1],d=Object(n.useState)(tu),m=Object(Pe.a)(d,2),g=m[0],h=m[1],b=Object(n.useState)(!1),f=Object(Pe.a)(b,2),y=f[0],v=f[1],x=Object(n.useContext)(de).user,w=function(e){e===g?v(!y):h(e)},E=0===u?t:a;switch(g){case tu:y?E.sort(function(e,t){return e.latest.takenOn-t.latest.takenOn}):E.sort(function(e,t){return t.latest.takenOn-e.latest.takenOn});break;case au:y?E.sort(function(e,t){return e.createdOn-t.createdOn}):E.sort(function(e,t){return t.createdOn-e.createdOn});break;case nu:y?E.sort(function(e,t){return e.name<t.name?-1:e.name>t.firstname?1:0}):E.sort(function(e,t){return t.name<e.name?-1:t.name>e.name?1:0})}return r.a.createElement("div",{className:l.root},r.a.createElement(Zc,null,r.a.createElement(me.a,null,"My Profile")),r.a.createElement(Ks,{user:x}),r.a.createElement($n.a,{value:u,onChange:function(e,t){return p(t)},indicatorColor:"primary",centered:!0,classes:{flexContainer:l.tabs}},r.a.createElement(Wn.a,{className:l.tab,value:0,label:"My Series"}),r.a.createElement(Wn.a,{className:l.tab,value:1,label:"Watching"})),r.a.createElement(Qr.a,null),r.a.createElement("div",{className:l.filterContainer},r.a.createElement(iu,{asc:y,active:g===nu,onClick:function(){return w(nu)},label:nu}),"|",r.a.createElement(iu,{asc:y,active:g===tu,onClick:function(){return w(tu)},label:tu}),"|",r.a.createElement(iu,{asc:y,active:g===au,onClick:function(){return w(au)},label:au})),r.a.createElement(Qr.a,null),r.a.createElement("div",{className:l.seriesList},!o&&(!E||0===E.length)&&r.a.createElement(me.a,{className:l.noneFound,component:"div"},"No Series Found"),o&&r.a.createElement(me.a,{className:l.noneFound,component:"div"},"Loading..."),E.map(function(e,t){return r.a.createElement(os,{key:"seriesListItem".concat(t),series:e,showCreatedOn:!0,showLastPhoto:!0,onClick:function(){return i(e.id)}})})))},ou=Object(he.a)(function(e){return{root:{margin:e.spacing(0,1,0,1)}}}),iu=function(e){var t=e.active,a=e.asc,n=e.onClick,o=e.label,i=ou(),l=!0===a?"\u25b2":"\u25bc";return r.a.createElement(Ae.a,{size:"small",className:i.root,onClick:n,color:t?"secondary":"inherit"},o,r.a.createElement("span",{style:{opacity:t?1:0}},l))},lu=Object(s.d)(G,{props:function(e){var t=e.data,a=e.ownProps;return{data:Object(l.a)({},a.data,{seriesQ:t})}}}),cu=Object(s.d)(q,{props:function(e){var t=e.data,a=e.ownProps;return{data:Object(l.a)({},a.data,{watchedSeriesQ:t})}},skip:function(e){e.data;var t=e.user;try{return t.watching.length<1}catch(a){return!0}},options:function(e){e.data;return{variables:{seriesList:e.user.watching}}}}),su=Object(s.c)(lu,cu)(function(e){var t=e.data,a=e.jumpToSeries,n=e.jumpToMap,o=t.seriesQ,i=t.watchedSeriesQ,l=o&&o.userSeries&&o.userSeries.seriesSummaries?o.userSeries.seriesSummaries:[],c=i&&i.arraySeries?i.arraySeries:[],s=Boolean(o&&o.loading||i&&i.loading);return r.a.createElement(ru,{loading:s,mySeries:l,watchingSeries:c,jumpToSeries:a,jumpToMap:n})}),uu=Object(Te.b)(function(e,t){return{}},function(e){return{jumpToSeries:function(t){e(on(Lt.SERIES,{activeSeries:t}))},jumpToMap:function(t){e(on(Lt.MAP,{activeSeries:t}))}}})(su),pu=a(484),du=Object(he.a)(function(e){return{root:{display:"flex",alignItems:"center"},grow:{flexGrow:1},text:{textAlign:"center",fontStyle:"italic",padding:e.spacing(2,1)}}}),mu=function(e){var t=e.style,a=e.icon,n=e.text,o=du();return r.a.createElement("div",{className:o.root},r.a.createElement("div",{className:o.grow}),a,r.a.createElement(me.a,{className:o.text,variant:"subtitle1",color:"textSecondary",component:"div",style:t},n),r.a.createElement("div",{className:o.grow}))},gu=Object(he.a)(function(e){return{root:{textAlign:"center"},placeAvatar:{color:e.palette.primary.contrastText,border:"2px solid ".concat(e.palette.primary.contrastText),background:e.palette.text.primary,margin:"auto"},placeIcon:{}}}),hu=function(e){var t=e.onClick,a=gu();return r.a.createElement("div",{className:a.root},r.a.createElement(eo.a,{className:a.placeAvatar},r.a.createElement(Un.a,{color:"inherit",onClick:function(e){e.preventDefault(),e.stopPropagation(),t()}},r.a.createElement(js.a,{color:"inherit"}))))},bu=Object(he.a)(function(e){return{root:{height:"100%",padding:e.spacing(.5,1)},imgContainer:{overflow:"hidden",height:"100%",position:"relative"},findOnMapButtonContainer:{position:"absolute",opacity:.8,bottom:e.spacing(1),right:e.spacing(1)},titleContainer:{background:"#444444AA",textShadow:"1px 1px 10px black",color:"white",position:"absolute",alignItems:"center",display:"flex",top:0,width:"100%",paddingRight:e.spacing(1)},avatar:{border:"1px solid white",margin:e.spacing(0,1)},title:{flex:"1 1 50%",overflow:"hidden"},seriesName:{textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"},img:{objectFit:"cover",height:"100%",width:"100%"},gravatarImg:{width:"100%"}}}),fu="Added",yu=function(e){var t=e.event,a=e.onMapClick,o=e.onImageClick,i=e.onProfileClick,l=(e.onSeriesClick,t.series),c=t.photo,s=bu(),u=Object(n.useContext)(de).getPhotoUrl;return r.a.createElement("div",{className:s.root},r.a.createElement(_a.a,{className:s.imgContainer},r.a.createElement("img",{alt:"medium",className:s.img,src:u(c,"medium"),onClick:function(){return o(l.id,c.id)}}),r.a.createElement("div",{className:s.titleContainer},r.a.createElement(eo.a,{onClick:function(){return i(c.createdUser.username)},className:s.avatar},r.a.createElement("img",{alt:"profile",className:s.gravatarImg,src:c.createdUser.gravatar})),r.a.createElement("div",{className:s.title},r.a.createElement(me.a,{className:s.seriesName,variant:"body1",color:"inherit"},l.name),r.a.createElement(me.a,{variant:"body2",color:"inherit"},c.createdUser.username," ",fu," a photo"),r.a.createElement(me.a,{variant:"caption",color:"inherit"},Object(yo.d)(c.updatedOn))),r.a.createElement(hu,{onClick:function(){return a(l.id,c.id)}}))))},vu=yu,xu=Object(he.a)(function(e){return{root:{display:"flex",flexDirection:"column",height:"100%"},listContainer:{flexGrow:1,overflow:"hidden"},vList:{height:"100%",width:"100%"},feedContainer:{flexGrow:1,transform:"translateZ(0)"},grow:{flexGrow:1}}}),wu=function(e){var t=e.events,a=e.loading,o=e.onMapClick,i=e.onImageClick,l=e.onProfileClick,c=e.onSeriesClick,s=(e.fetchNewest,e.fetchMore),u=e.window,p=xu(),d=Object(n.useRef)(),m=hr(d).size,g=Da().online;return r.a.createElement("div",{className:p.root},r.a.createElement(Zc,null,r.a.createElement(me.a,{className:p.grow},"Home Feed")),r.a.createElement("div",{className:p.listContainer,ref:d},r.a.createElement(pu.a,{height:m.height,width:m.width,className:p.vList,rowCount:t.length+1,rowHeight:300,rowRenderer:function(e){var n,d=e.index,m=(e.isScrolling,e.isVisible,e.key),h=e.parent,b=e.style,f=t[d];if(d<t.length&&f)n=r.a.createElement(vu,{event:t[d],onSeriesClick:c,onImageClick:i,onProfileClick:l,onMapClick:o});else if(d===t.length){var y=u&&0===u[0];n=r.a.createElement(mu,{icon:r.a.createElement(ic.a,{size:30,thickness:2,color:"inherit"}),text:"Loading..."});var v=1200+h.state.scrollTop>b.top;g?y?n=r.a.createElement(mu,{text:"End of feed"}):!a&&v&&s():n=r.a.createElement(mu,{icon:r.a.createElement($e.a,null),text:"Cannot Refresh Offline"})}return r.a.createElement("div",{className:p.row,key:m,style:b},n)}})))},Eu=20,Ou=Object(s.d)(X,{props:function(e){var t=e.data;t.error&&console.error(t.error);var a=!1,n=!1;return{data:t,loadingNewest:a,loadingMore:n,fetchNewest:function(){a=!0,console.log("fetchNewest",t),t.myFeed&&t.fetchMore({variables:Object(l.a)({},t.variables,{start:t.myFeed.window[1]}),updateQuery:function(e,t){var n=t.fetchMoreResult;return a=!1,{myFeed:Object(l.a)({},n.myFeed,{feed:[].concat(Object(Va.a)(n.myFeed.feed),Object(Va.a)(e.myFeed.feed)),window:[e.myFeed.window[0],n.myFeed.window[1]]})}}})},fetchMore:function(){n=!0,console.log("fetchMore",t),t.myFeed&&t.fetchMore({variables:Object(l.a)({},t.variables,{end:t.myFeed.window[0]}),updateQuery:function(e,t){var a=t.fetchMoreResult;return n=!1,{myFeed:Object(l.a)({},a.myFeed,{feed:[].concat(Object(Va.a)(e.myFeed.feed),Object(Va.a)(a.myFeed.feed)),window:[a.myFeed.window[0],e.myFeed.window[1]]})}}})},loading:t.loading}},options:function(e){e.activeSeries;return{variables:{limit:5}}}}),ku=Object(Te.b)(function(e,t){return{}},function(e){return{jumpToSeries:function(t,a){e(on(Lt.SERIES,{activeSeries:t,initialPhoto:a}))},jumpToUser:function(t){e(on(Lt.SEARCH,{search:{tab:zt.USER,text:t}}))},jumpToMap:function(t,a){e(un({mode:Mt.FREE})),e(on(Lt.MAP,{activeSeries:t,initialPhoto:a}))}}})(Ou(function(e){var t=e.data,a=e.loading,o=e.fetchMore,i=e.fetchNewest,l=(e.loadingNewest,e.loadingMore,e.jumpToSeries),c=e.jumpToMap,s=e.jumpToUser,u=Object(n.useRef)(),p=Da().online,d=Object(n.useState)(null),m=Object(Pe.a)(d,2),g=m[0],h=m[1];u.current=g,Object(n.useEffect)(function(){return u.current||(u.current=setInterval(function(){!a&&p&&i(),u.current&&h(String(Date.now()-1e3*Eu))},1e3*Eu)),function(){u.current&&(console.log("clear poll timer"),clearInterval(u.current),u.current=null)}},[]);var b=t.myFeed&&t.myFeed.feed||[],f=t.myFeed&&t.myFeed.window.map(function(e){return parseInt(e,10)})||[null,null];return r.a.createElement(wu,Object.assign({events:b,loading:a,window:f,fetchMore:o,fetchNewest:i,jumpToSeries:l},{onSeriesClick:function(){},onImageClick:l,onProfileClick:s,onMapClick:c}))})),Su=a(950),ju=a(479),Cu=a.n(ju),Nu=Object(he.a)(function(e){return{root:{display:"flex",height:"100%",flexDirection:"column"},qrIcon:{border:"5px solid red",padding:e.spacing(2),position:"absolute",color:"white",opacity:.4,zIndex:2,width:"70%",height:"70%",top:"50%",left:"50%",transformOrigin:"50% 50%",transform:"translateY(-50%) translateX(-50%)"},appBar:{},inner:{padding:e.spacing(2),height:"100%",flexGrow:1,overflow:"hidden"},tipPaper:{padding:e.spacing(2),margin:e.spacing(2)},docContainer:{flexGrow:1,padding:e.spacing(2)},cameraContainer:{width:"80%",margin:"0 auto",position:"relative","&::before":{content:" ",display:"block",paddingTop:"100%"}},snackErr:{background:Pt.a[500],color:"white"},snackSuccess:{background:It.a[500],color:"white"},snackMsg:{},video:{height:"100%",width:"100%",verticalAlign:"top"}}}),Iu=function(e){var t=e.onMenuBack,a=e.onCapture,o=Nu(),i=Object(n.useState)(),l=Object(Pe.a)(i,2),c=l[0],s=l[1],u=Object(n.useState)(null),p=Object(Pe.a)(u,2),d=p[0],m=p[1],g=Object(n.useState)(null),h=Object(Pe.a)(g,2),b=h[0],f=h[1],y=Ml(s,400,400),v=y.cameraError,x=y.captureRawData,w=y.cameraOnline,E=Object(n.useCallback)(Object(Ba.a)(x,100),[w,v]);return Object(n.useEffect)(function(){!w||v||d||b||(c&&c.data?function(){var e=Object(ft.a)(bt.a.mark(function e(){var t,a,n,r;return bt.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=null,e.prev=1,e.next=4,Pu(c);case 4:t=e.sent,e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),console.error(e.t0);case 10:if(e.prev=10,!t){e.next=22;break}if(a=t.data.indexOf("?fromqr=")+"?fromqr=".length,n=t.data.slice(a),console.log("DEBUG",{data:t.data,newData:n}),(r=JSON.parse(decodeURI(n))).type&&r.id){e.next=19;break}throw new Error("Type or ID missing from QR Code");case 19:f(r),m(null),console.log("QRCODE",t);case 22:E(),e.next=30;break;case 25:e.prev=25,e.t1=e.catch(10),m("Not a valid QR Code"),console.error(e.t1),E();case 30:case"end":return e.stop()}},e,null,[[1,7],[10,25]])}));return function(){return e.apply(this,arguments)}}()():E())},[w,c,d,b]),r.a.createElement("div",{className:o.root},r.a.createElement(ge.a,null)," ",r.a.createElement(Bn.a,{position:"static",className:o.appBar},r.a.createElement(ra.a,{disableGutters:!0},r.a.createElement(Un.a,{className:o.menuButton,color:"inherit",onClick:t,"aria-label":"Menu"},r.a.createElement(qn.a,null)),r.a.createElement(me.a,{variant:"subtitle1",color:"inherit",className:o.toolbarTitle},"Capture QR Code"))),r.a.createElement("div",{className:o.inner},r.a.createElement(_a.a,{className:o.cameraContainer},r.a.createElement(sr,{className:o.qrIcon}),r.a.createElement("video",{autoPlay:!0,playsInline:!0,muted:!0,id:"webcam",className:o.video})),r.a.createElement(_a.a,{className:o.tipPaper},r.a.createElement(me.a,null,"TIP: You can find the QR code for a series in the SHARE tab of that series"))),r.a.createElement(Ra.a,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:!!d,autoHideDuration:2e3,onClose:function(){return m(null)}},r.a.createElement(Su.a,{className:o.snackErr,message:r.a.createElement("span",{className:o.snackMsg},d)})),r.a.createElement(Ra.a,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:v},r.a.createElement(Su.a,{className:o.snackErr,message:r.a.createElement("span",{className:o.snackMsg},"Camera Error. Check your device's permissions")})),r.a.createElement(Ra.a,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:!!b,autoHideDuration:500,onClose:function(){return a(b.type,b.id)}},r.a.createElement(Su.a,{className:o.snackSuccess,message:r.a.createElement("span",{className:o.snackMsg},"Valid QR Code found!")})))},Pu=function(e){var t=e.data,a=e.imageHeight,n=e.imageWidth;return new Promise(function(e,r){try{e(Cu()(t,n,a))}catch(o){r(o)}})},Tu=a(130),Au=a.n(Tu),Ru=Object(he.a)(function(e){return{root:{background:"black",color:"white",textAlign:"center"}}}),_u=function(){var e=Ru(),t=Object(n.useContext)(de),a=t.online,o=t.offlineSince,i=Object(n.useState)(),l=Object(Pe.a)(i,2),c=l[0],s=l[1],u=Object(n.useRef)(),p=function(){var e=Au()(o,"x").fromNow();s(e)},d=function(){u.current&&(clearInterval(u.current),u.current=null)};return Object(n.useEffect)(function(){return o&&!u.current?(p(),u.current=setInterval(p,5e3)):o||d(),function(){d()}},[o]),a?null:r.a.createElement(me.a,{className:e.root,variant:"caption",component:"div"},"Offline (",c,")")},Lu=a(480),zu=a.n(Lu),Mu=a(481),Du=a.n(Mu),Fu=a(482),Bu=a.n(Fu),Uu=a(483),$u=a.n(Uu),Wu=Lt,Gu=Object(he.a)(function(e){return{root:{borderTop:"2px solid ".concat(e.palette.secondary.main)},text:{padding:e.spacing(2,2,0)},paper:{paddingBottom:50},list:{marginBottom:e.spacing(2)},subheader:{backgroundColor:e.palette.background.paper},grow:{flexGrow:1},addFab:{position:"absolute",bottom:0,left:"50%",transformOrigin:"0% 100%",transform:"translateY(-25%) translateX(-50%) translateZ(0)",zIndex:3e3},spacer:{width:40,flexGrow:1}}}),qu=function(e){var t=e.className,a=e.domain,o=e.signedIn,i=e.onHomeClick,l=e.onMapClick,c=e.onSearchClick,s=e.onProfileClick,u=e.onCameraClick,p=e.onLibraryClick,d=Gu(),m=Object(n.useContext)(de),g=m.isIos,h=m.online;return r.a.createElement(Bn.a,{position:"static",className:jn()(d.root,t)},r.a.createElement(ra.a,null,o&&r.a.createElement(Ae.a,{edge:"start",className:d.grow,color:a===Wu.FEED?"secondary":"inherit",onClick:i},r.a.createElement(zu.a,null)),r.a.createElement(Ae.a,{edge:"start",className:d.grow,color:a===Wu.MAP?"secondary":"inherit",onClick:l},r.a.createElement(Du.a,null)),o&&r.a.createElement($r,{isIos:g,className:d.addFab,onCameraClick:u,onLibraryClick:p},r.a.createElement(gi.a,null)),r.a.createElement("div",{className:d.spacer}),r.a.createElement(Ae.a,{color:a===Wu.SEARCH?"secondary":"inherit",className:d.grow,disabled:!h,onClick:c},r.a.createElement(Bu.a,null)),o&&r.a.createElement(Ae.a,{edge:"end",color:a===Wu.PROFILE?"secondary":"inherit",className:d.grow,onClick:s},r.a.createElement($u.a,null))))},Hu=qu,Yu=(Object(he.a)(function(e){return{root:{height:"100%",display:"flex",flexDirection:"column"},paper:{flexGrow:1}}}),Lt),Vu=Object(he.a)(function(e){return{outerRoot:{height:"100%",overflow:"hidden"},root:{height:"100%",overflow:"hidden",display:"flex",flexDirection:"column"},offlineBar:{flex:"0 0"},activeWrapper:{overflow:"hidden",flexGrow:1,flexShrink:1,height:"100%"},uploaderContainer:{zIndex:2e3,flex:"0 0"}}}),Qu=function(e){var t=e.domain,a=e.onQRCapture,o=e.onMenuBack,i=e.setHomeState,l=e.onCameraClick,c=e.onLibraryClick,s=e.children,u=Vu(),p=Object(n.useContext)(de),d=p.signedIn,m=p.user,g=p.windowSize;Object(n.useEffect)(function(){!d&&[Yu.MAP,Yu.SEARCH,Yu.SERIES,Yu.QRCAPTURE].indexOf(t)<0&&i(Yu.MAP)},[t]);var h=!0,b={},f=ku;switch(t){case Yu.FEED:f=ku;break;case Yu.MAP:f=ks;break;case Yu.PROFILE:f=uu,b={user:m};break;case Yu.SEARCH:f=Zs;break;case Yu.SERIES:f=Ic,b={user:m},h=!1;break;case Yu.NEW_SERIES_CAMERA:case Yu.NEW_SERIES_LIBRARY:b={user:m},f=Ic,h=!1;break;case Yu.QRCAPTURE:f=Iu,h=!1,b={onCapture:a,onMenuBack:o}}return r.a.createElement("div",{className:u.outerRoot},r.a.createElement("div",{className:u.root,style:{width:g.width,height:g.height}},r.a.createElement(ge.a,null)," ",r.a.createElement(_u,{className:u.offlineBar}),r.a.createElement("div",{className:u.activeWrapper},r.a.createElement(f,b)),h&&r.a.createElement(xe.a,{theme:pe.bottombar},r.a.createElement(Hu,{signedIn:d,domain:t,onHomeClick:function(){return i(Yu.FEED)},onMapClick:function(){return i(Yu.MAP)},onSearchClick:function(){return i(Yu.SEARCH,{search:null})},onProfileClick:function(){return i(Yu.PROFILE)},onCameraClick:l,onLibraryClick:c})),r.a.createElement(Dn,{className:u.uploaderContainer}),s))},Xu=Object(s.c)(kn,Object(Te.b)(function(e,t){return{domain:e.home.current.domain,flags:e.flags}},function(e){return{setHomeState:function(t,a){e(on(t,a))},onCameraClick:function(){e(on(Lt.NEW_SERIES_CAMERA))},onLibraryClick:function(){e(on(Lt.NEW_SERIES_LIBRARY))},dismissInstall:function(){e(cn("install",!1))},setUseOffline:function(t){e(cn("useLoggedOut",t))},onQRClick:function(){e(on(Lt.QRCAPTURE))},onMenuBack:function(){e(ln())},onAvatarClick:function(t){e(on(Lt.SEARCH,{search:{tab:zt.USER,text:t}}))},onQRCapture:function(t,a){switch(t){case"series":e(on(Lt.SERIES,{activeSeries:a}))}}}}),function(e){return function(t){var a=t.onQRClick,o=t.onAvatarClick,i=t.setUseOffline,u=t.dismissInstall,p=t.flags,d=Object(c.a)(t,["onQRClick","onAvatarClick","setUseOffline","dismissInstall","flags"]),g=Oa(p.useLoggedOut,i),h=g.isGod,b=g.signedIn,f=g.authData,y=g.signOut,v=g.authScreen,x=g.forceSignIn,w=Zt(),E=w.client,O=w.loaded,k=Da(),S=k.online,j=k.offlineSince,C=Ma(p.install,u),N=C.installPrompt,I=C.addToHomeScreen,P=Ga();if(Object(n.useEffect)(function(){!0===b&&p.useLoggedOut?i(!1):!1!==b||p.useLoggedOut||i(!0)},[b]),!O)return r.a.createElement(Oe,{message:"DBStore"});if(null===b&&!p.useLoggedOut)return v;var T=Object(l.a)({signOut:y,forceSignIn:function(){i(!1),x()},getPhotoUrl:function(e,t){try{return"".concat(e.paths.base).concat(e.paths[t])}catch(a){return null}},onAvatarClick:o,online:S,offlineSince:j},P,{signedIn:Boolean(b),role:b?h?"admin":"user":"nonuser",currentUser:f,onQRClick:a,addToHomeScreen:I});return r.a.createElement(xe.a,{theme:pe.home},r.a.createElement(s.a,{client:E},r.a.createElement(s.b,{query:V,skip:!b},function(t){var a=t.loading,n=t.error,o=t.data;return a?r.a.createElement(Oe,{message:"UserData"}):(n&&console.error(n),b&&(T.user=o.user),r.a.createElement(de.Provider,{value:T},r.a.createElement(m,null,r.a.createElement(e,d,N))))})))}},function(e){return function(t){return r.a.createElement(Ie,{fallback:gt},r.a.createElement(e,t))}})(Qu),Zu=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function Ju(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See http://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}a(883);a(885),console.log("Rendering Main App"),i.a.render(r.a.createElement(Xu,null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/photomon_v0",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("/photomon_v0","/service-worker.js");Zu?(function(e,t){fetch(e).then(function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):Ju(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit http://bit.ly/CRA-PWA")})):Ju(t,e)})}}()}},[[504,2,1]]]);
//# sourceMappingURL=main.d8808e6d.chunk.js.map