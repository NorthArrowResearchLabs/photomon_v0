{"version":3,"sources":["lib/SeriesConfig.js","lib/Photo.js","lib/datelib.js","lib/util.js","translations.js","graphql/fragments.js","graphql/queries.js","themes/index.js","contexts.js","components/auth/useAuthCommon.js","icons/AppLogo.jsx","components/auth/AuthContainer.jsx","components/auth/Loading.jsx","lib/ErrorBoundary.jsx","components/misc/ErrorScreen.jsx","graphql/mutations.js","graphql/Error.connect.js","mapStyles/index.js","config.js","storage.js","lib/useGraphQL.js","components/auth/auth.style.js","components/auth/SignIn.jsx","components/auth/ConfirmSignIn.jsx","components/auth/RequireNewPassword.jsx","components/auth/SignUp.jsx","components/auth/ConfirmSignUp.jsx","components/auth/ForgotPassword.jsx","lib/useAuthentication.js","lib/sensors.js","components/misc/InstallPrompt.jsx","lib/useShowAddToHome.js","lib/useOnline.js","lib/useResponsive.js","redux/actions.js","redux/reducers/map.js","redux/reducers/home.js","redux/reducers/uploader.js","redux/reducers/flags.js","redux/reducers/index.js","redux/storeConfig.js","redux/withReduxProvider.js","components/UploadControl.jsx","lib/s3upload.js","graphql/Uploader.connect.js","permissions.js","components/PhotoSeries/contexts.js","components/PhotoSeries/views/QRDisplay.jsx","icons/QRCode.jsx","lib/useComponentSize.js","components/maps/markers/MyLocation.jsx","components/maps/controls/StyleButtons.jsx","components/maps/controls/MyLocationButton.jsx","components/maps/BaseMap.jsx","components/maps/markers/Dot.jsx","components/maps/BaseStaticMap.jsx","components/maps/MapDot.jsx","components/PhotoSeries/views/controls/AddFab.jsx","components/PhotoSeries/views/controls/ContextMenu.jsx","components/PhotoSeries/views/tags/TagChip.jsx","components/PhotoSeries/views/controls/ShortLongText.jsx","components/PhotoSeries/views/controls/UserListItem.jsx","components/PhotoSeries/views/dialogs/BigText.jsx","components/PhotoSeries/views/subViews/SeriesInfo.jsx","components/PhotoSeries/views/subViews/SeriesInfo.style.js","components/PhotoSeries/views/tags/XYTagChip.style.js","components/PhotoSeries/views/tags/XYTagChip.jsx","components/PhotoSeries/views/tags/XYTagSelect.jsx","components/PhotoSeries/views/tags/XYTagSelect.style.js","components/PhotoSeries/views/tags/XYTagChooser.jsx","components/PhotoSeries/views/tags/XYTagChooser.style.js","lib/Tags.js","components/PhotoSeries/views/tags/useXYTags.js","components/PhotoSeries/views/subViews/BrokenImg.jsx","components/PhotoSeries/views/subViews/Photo.jsx","components/PhotoSeries/views/subViews/Photo.style.js","components/PhotoSeries/views/subViews/SwipeShow.jsx","components/PhotoSeries/views/subViews/SwipeShow.style.js","components/PhotoSeries/views/dialogs/DeleteDialog.jsx","components/PhotoSeries/views/subViews/PhotoGrid.jsx","components/PhotoSeries/views/subViews/PhotoGrid.style.js","components/PhotoSeries/views/SeriesView.style.js","components/PhotoSeries/views/SeriesView.jsx","components/PhotoSeries/views/dialogs/MapDirPicker.jsx","components/PhotoSeries/views/dialogs/BigTextEdit.jsx","components/PhotoSeries/views/subViews/SeriesEditInner.jsx","components/PhotoSeries/views/subViews/SeriesEditInner.style.js","components/PhotoSeries/views/SeriesEdit.jsx","components/PhotoSeries/views/SeriesEdit.style.js","components/PhotoSeries/views/Slideshow.jsx","components/PhotoSeries/views/Slideshow.style.js","components/PhotoSeries/views/dialogs/CancelConfirm.jsx","components/PhotoSeries/views/controls/TagControl.style.js","components/PhotoSeries/views/controls/TagView.jsx","components/PhotoSeries/views/controls/DateControl.jsx","components/PhotoSeries/views/controls/TagControl.jsx","components/PhotoSeries/views/dialogs/TagEdit.jsx","components/PhotoSeries/views/controls/DateView.jsx","components/PhotoSeries/views/subViews/PhotoInfoInner.jsx","components/PhotoSeries/views/subViews/PhotoInfo.jsx","components/PhotoSeries/views/PhotoViewTool.jsx","components/PhotoSeries/views/PhotoViewTool.style.js","components/PhotoSeries/views/controls/PhotoFadeSlider.jsx","components/PhotoSeries/views/PhotoReviewTool.jsx","components/PhotoSeries/views/PhotoReviewTool.style.js","lib/useCamera.js","components/PhotoSeries/views/CameraTool.jsx","components/PhotoSeries/views/CameraTool.style.js","components/PhotoSeries/views/NewPhotoInfo.jsx","components/PhotoSeries/views/NewPhotoInfo.style.js","lib/useFileInput.js","components/PhotoSeries/views/controls/LibraryFilePicker.jsx","lib/Series.js","components/PhotoSeries/views/NewPhoto.jsx","lib/AccessHelper.js","components/PhotoSeries/views/SeriesNotFound.jsx","components/PhotoSeries/views/SeriesLoading.jsx","components/PhotoSeries/index.jsx","graphql/Series.connect.js","lib/useClusteredData.js","components/maps/HomeMap.style.js","icons/AppLogoSimple.jsx","icons/Apple.jsx","components/misc/FeatureDisabled.jsx","components/SideDrawer.jsx","components/TopBar.jsx","components/Search/SearchInput.jsx","components/misc/SeriesListItem.jsx","components/misc/ClusterSelected.jsx","components/maps/markers/Single.jsx","components/maps/markers/Cluster.jsx","components/maps/HomeMap.jsx","graphql/Map.connect.js","components/Search/SearchContextItem.jsx","components/Search/SearchContextResults.jsx","components/Search/SearchEnder.jsx","components/Search/SearchResults.jsx","components/Search/SearchPlaceholder.jsx","components/Search/Search.jsx","graphql/Search.connect.js","components/MyProfile/MeCard.jsx","components/MyProfile/MyProfile.jsx","graphql/Profile.connect.js","components/MyFeed/FeedEnder.jsx","components/misc/FindOnMapButton.jsx","components/MyFeed/FeedItem.jsx","components/MyFeed/MyFeed.jsx","graphql/Feed.connect.js","components/PhotoSeries/views/QRReader.jsx","components/misc/OfflineBar.jsx","components/BottomBar.jsx","App.jsx","App.connect.js","serviceWorker.js","index.js"],"names":["TYPES","SeriesConfig","seriesConfig","_this","this","Object","_Users_matt_Work_Git_PBR_PhotoMonitoring_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_2__","getTagType","typeId","config","tags","find","tt","id","getTagTypeIndex","findIndex","getXYTagTypes","filter","allowXY","getNonXYTagTypes","allowNonXY","getSeriesMeta","keys","meta","key","type","reduce","acc","_Users_matt_Work_Git_PBR_PhotoMonitoring_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_1__","_Users_matt_Work_Git_PBR_PhotoMonitoring_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__","default","getPhotoMeta","Error","__webpack_exports__","Photo","photo","setMeta","JSON","stringify","newPhoto","concat","uuidv4","uploadToken","takenOn","convertJSDatetoTimestamp","Date","getObjectUrl","_ref","_Users_matt_Work_Git_PBR_PhotoMonitoring_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_asyncToGenerator__WEBPACK_IMPORTED_MODULE_1__","_Users_matt_Work_Git_PBR_PhotoMonitoring_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default","a","mark","_callee","store","dbval","urlVal","wrap","_context","prev","next","getItem","sent","window","URL","createObjectURL","indexOf","abrupt","t0","console","error","stop","_x","_x2","apply","arguments","getExif","dataUrl","log","exif","exifDateTime","exifGPS","foundIdx","length","newData","slice","exifParser","create","Buffer","from","parse","err","DateTimeOriginal","String","GPSLatitude","isNumeric","GPSLongitude","e","__webpack_require__","d","formatDate","formatDatAgo","timestampToHTML5Input","HTML5InputToTimestamp","moment__WEBPACK_IMPORTED_MODULE_0__","moment__WEBPACK_IMPORTED_MODULE_0___default","n","utctimestamp","format","undefined","moment","fromNow","jsDate","utc","isoStr","debounce","num","isNaN","parseFloat","isFinite","func","wait","immediate","timeout","_len","innerArgs","Array","_key","context","callNow","clearTimeout","setTimeout","addLocaleData","frLocaleData","React","createContext","IntlWrapper","children","react_default","createElement","index_es","locale","photoSummaryFragment","gql","_templateObject","userSummaryFragment","_templateObject2","seriesSummaryFragment","_templateObject3","seriesFragment","_templateObject4","photoFragment","_templateObject5","userFragment","_templateObject6","allSeries","queries_templateObject","pollQuery","queries_templateObject2","userSeries","queries_templateObject3","seriesFromList","queries_templateObject4","queries_templateObject5","seriesWithTag","queries_templateObject6","tagSearch","_templateObject7","getUser","_templateObject8","_templateObject9","geocode","_templateObject10","getMyFeed","_templateObject11","userSearch","_templateObject12","getWholeSeries","_templateObject13","typography","useNextVariants","colors","home","palette","primary","main","secondary","text","fade","series","lighten","topbar","bottombar","login","background","paper","themes","createMuiTheme","AppContext","useAuthCommon","containerRef","useRef","handleKeyPress","event","current","found","getElementsByClassName","click","useEffect","document","addEventListener","removeEventListener","createSvgIcon","Fragment","useStyles","makeStyles","theme","root","height","bgSwoosh","width","position","top","left","zIndex","spacer","flex","logo","minHeight","inner","margin","minWidth","maxWidth","display","flexDirection","textAlign","AuthContainer","classes","ThemeProvider","ref","className","CssBaseline","AppLogo","Typography","variant","Loading","message","auth_AuthContainer","ErrorBoundary","props","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","state","hasError","info","_this$state","FallbackUI","fallback","Component","SEND_STATES","overflow","padding","spacing","color","border","button","icon","opacity","flexGrow","stack","marginBottom","fontSize","whiteSpace","fontFamily","ErrorScreen","sendState","reportError","_useState","useState","_useState2","slicedToArray","dlgOpen","setDialogOpen","_useState3","_useState4","note","setNote","stackEl","buttonText","disabled","Error_default","Button","onClick","BugReport_default","Dialog","open","onClose","aria-labelledby","DialogTitle","DialogContent","DialogContentText","TextField","autoFocus","multiline","onChange","target","value","rowsMax","placeholder","label","fullWidth","DialogActions","deletePhoto","mutations_templateObject","deleteSeries","mutations_templateObject2","updateSeries","mutations_templateObject3","updatePhoto","mutations_templateObject4","createPhoto","mutations_templateObject5","createSeries","mutations_templateObject6","watchSeries","mutations_templateObject7","unWatchSeries","mutations_templateObject8","reportBug","mutations_templateObject9","withReportBugMutation","graphql","mutate","_ref$ownProps","ownProps","reduxState","setState","reportJSON","errObj","env","process","toString","variables","update","_ref2","data","connect","map","other","uploader","objectWithoutProperties","newMap","objectSpread","Wrapped","assign","src_mapStyles","toolTip","Icon","SatelliteOutlined","ActiveIcon","SatIcon","style","Satellite","TerrainOutlined","Terrain","TopoMap","tagColors","mapConfig","mapBoxToken","styles","MapStyles","baseurl","REACT_APP_BASEURL","FEED","MAP","SEARCH","PROFILE","SERIES","QRCAPTURE","NEW_SERIES_CAMERA","NEW_SERIES_LIBRARY","TAG","LOCATION","USER","FREE","endpoints","aws","Auth","region","userPoolId","userPoolWebClientId","mandatorySignIn","cookieStorage","domain","expires","secure","ACCESS","OPEN","description","green","PRIVATE","red","PUBLIC","blue","localforage","storeName","imgStore","createInstance","name","apolloStore","reduxStore","Amplify","configure","LOCAL_STORAGE_TOKEN","lib_useGraphQL","client","setClient","loaded","setLoaded","createApolloClient","getCurrentToken","asyncToGenerator","regenerator_default","currSession","currentSession","accessToken","jwtToken","_callee3","onDone","cache","authLink","httpLink","apolloClient","_context3","InMemoryCache","persistCache","storage","setContext","_ref3","_callee2","_","headers","token","newHeaders","_context2","authorization","_x3","createHttpLink","uri","ApolloClient","link","ApolloLink","tokenName","connectToDevTools","auth_style","forgotPassword","switch","switchButton","&:last-child","borderRadius","&:first-child","phoneNumInner","marginTop","phoneNumDropdown","warnText","fontStyle","noSignin","SignIn","loading","handleSignup","handleForgotPassword","federated","handleInputChange","handleBeAnonymous","handleSignIn","textField","autoComplete","Toolbar","disableGutters","component","size","ConfirmSignIn","handleBack","handleConfirm","RequireNewPassword","change","requiredAttributes","placeholders","attribute","idx","SignUp","signUpFields","signUpFieldLabels","signUpFieldPlaceholders","countryDialCodes","defaultDialCode","selectVal","setSelectVal","handleDialCodeChange","field","f","FormControl","InputLabel","htmlFor","shrink","required","Select","inputProps","dialCode","ConfirmSignUp","handleResend","Link","resendCode","ForgotPassword","handleSubmit","handleSendCode","setSent","defaultAuthState","authState","authData","signedIn","useAuthentication","_useState2$","setAuth","authScreen","dist","onStateChange","hideDefault","useAuthentication_SignIn","useAuthentication_Loading","useAuthentication_RequireNewPassword","useAuthentication_ConfirmSignIn","useAuthentication_ConfirmSignUp","useAuthentication_ForgotPassword","useAuthentication_SignUp","isGod","signInUserSession","idToken","payload","signOut","then","catch","forceSignIn","newProps","changeState","signIn","auth_SignIn","SignInOrig","_this2","hide","includes","checkCustomSignUpFields","signUpConfig","sortFields","getDefaultDialCode","I18n","get","signUp","auth_SignUp","SignUpOrig","_this3","confirm","auth_ConfirmSignIn","ConfirmSignInOrig","_this4","resend","auth_ConfirmSignUp","ConfirmSignUpOrig","challengeParam","isArray","split","part","charAt","toUpperCase","substr","toLowerCase","join","auth_RequireNewPassword","RequireNewPasswordOrig","auth_Loading","LoadingOrig","_this5","send","submit","auth_ForgotPassword","ForgotPasswordOrig","useGeolocation","accuracy","altitude","altitudeAccuracy","heading","latitude","longitude","speed","timestamp","now","mountedRef","watchIdRef","onEvent","coords","navigator","geolocation","getCurrentPosition","watchPosition","clearWatch","isIos","test","userAgent","vendor","opera","content","messageWrapper","contrastText","boxShadow","animation","@keyframes installPulse","0%","50%","100%","textWrapper","paddingLeft","buttons","InstallPrompt","onInstall","Snackbar","anchorOrigin","vertical","horizontal","Paper","elevation","paragraph","useShowAddToHome","showInstall","dismissInstall","deferredPrompt","setPrompt","handleBeforePrompt","preventDefault","installPrompt","useMemo","misc_InstallPrompt","addToHomeScreen","prompt","userChoice","choiceResult","outcome","standalone","useOnline","setOnline","setOffline","newDate","online","offlineSince","metaViewports","getState","_window","orientation","innerWidth","innerHeight","_window$screen","screen","wOrient","bIsIos","bIsPhone","isPhone","windowSize","screenSize","activeElement","tagName","minSize","Math","min","viewport","querySelector","contentDict","getAttribute","el","elsplit","defineProperty","setAttribute","useResponsive","mediaQueries","handleResizeDebounced","useCallback","stopPropagation","newState","useLayoutEffect","Actions","actions","newDomain","params","flagName","flagVal","viewportSave","uploadObj","newProgress","mapInit","mode","zoom","homeInit","history","initState","activeUpload","defaultFlags","iOSWarning","install","useLoggedOut","combineReducers","action","toConsumableArray","newStateHistory","newCurrentState","pop","activeSeries","initialPhoto","newParams","newHistory","newStore","newActive","flags","persistConfig","persistedReducer","persistReducer","rootReducer","storeConfig","preloadedState","createStore","compose","applyMiddleware","thunk","persistor","persistStore","withReduxProvider","BaseComponent","_storeConfig","es","integration_react","msgText","messageInner","UploadControl","progress","classNames","LinearProgress","UploadControlCOSMOSWrapper","useWrapperStyles","displayName","updateUploadProgress","completeActiveUpload","formData","file","FormData","preAuth","fields","forEach","fieldkey","append","Content-Type","onUploadProgress","progressEvent","total","floor","axios","post","url","interceptors","request","use","Promise","reject","response","dispatch","uploadingRef","_doUpload","s3Upload","Boolean","components_UploadControl","permissions","admin","create:own","read:any","update:any","delete:any","create:any","nonuser","series_public","series_open","user","read:own","update:own","delete:own","SeriesContext","title","qrPaper","qrCode","QRDisplay","useContext","qrCodeEl","setQRCodeEl","obj","encodedId","encodeURI","QRCode","svgStr","dangerouslySetInnerHTML","__html","x","y","getSize","defaultSize","max","offsetWidth","offsetHeight","useComponentSize","resizeActiveRef","resizeActive","setResizeActive","setComponentSize","handleResize","newSize","ResizeObserver","resizeObserver","observe","disconnect","svgDot","transformOrigin","transform","svgAccuracyDot","MyLocation","projection","accHeight","pixelsPerMeter","accWidth","version","viewBox","cx","cy","r","stroke","fillOpacity","strokeWidth","fill","speedDialFab","speedDialAction","speedDialIcon","speedDialLabel","actionsClosed","StyleButtons","controlPadding","currStyle","mapStyles","setCurrStyle","setOpen","useTheme","noEventSetOpen","right","SpeedDial","ariaLabel","speedDial","fab","direction","SpeedDialAction","tooltipPlacement","ButtonProps","TooltipClasses","tooltip","tooltipTitle","tooltipOpen","defaultProps","grey","MyLocationButton","Fab","aria-label","MyLocation_default","BaseMap","showMe","initViewport","bounds","lockToBounds","lockPan","initStyle","incomingOnViewportChange","onViewportChange","incomingOnTransitionStart","onTransitionStart","incomingOnTransitionEnd","onTransitionEnd","transitions","onMapDataEvent","stylechooser","passthroughProps","mapContainerRef","mapBoxRef","innerTransitionsRef","defaultViewVals","setViewport","_useState5","_useState6","isTransitioning","setIsTransitioning","_useState7","_useState8","setProjection","myPosition","geoMarker","esm","markers_MyLocation","getDistanceScales","viewportChange","newViewport","getMap","_bounds","minlng","minlat","maxlng","maxlat","_fitBounds","WebMercatorViewport","fitBounds","offset","mapStyle","onData","dragPan","mapboxApiAccessToken","c","cloneElement","handleChild","controls_StyleButtons","hideNavControls","showZoom","touchZoom","scrollZoom","showCompass","touchRotate","dragRotate","controls_MyLocationButton","transitionDuration","transitionInterpolator","FlyToInterpolator","transitionEasing","easeCubic","bearing","pitch","child","rootActive","dot","directionIndicator","fontWeight","textShadow","nameActive","dark","Single","svgArc","strokeOpacity","BaseStaticMap","mapRef","recalcProjection","MapDot","staticMap","editable","Map","mapProps","Dot","pulseCol","light","&::before","animationIterationCount","animationTimingFunction","@keyframes fabPulse","90%","directionUp","AddFab","onCameraClick","onLibraryClick","down","setDown","timerRef","downRef","onDown","currentTarget","block","cameraAction","libraryAction","AddFab_AddFabIos","rootContainer","onBlur","disableFocusRipple","onMouseDown","onTouchStart","AddAPhoto_default","PhotoLibrary_default","useIosStyles","AddFabIos","ContextMenu","anchorEl","menuItems","Menu_Menu","divider","Divider","MenuItem","ListItemIcon","ListItemText","primaryTypographyProps","tagChips","marginRight","deleteIcon","chipAvatar","TagChip","edit","tag","onDelete","Chip","getContrastText","Cancel_default","bottom","ShortLongText","FormLabel","formLabel","imgContainer","gravatarImg","objectFit","UserListItem","onAvatarClick","ListItem","ListItemAvatar","Avatar","alt","src","gravatar","username","body","paddingBottom","alignSelf","dlgTitle","closeButton","BigText","scroll","disableTypography","IconButton","Close_default","DIALOGS","backgroundColor","list","watchers","numPhotos","tagListItem","chip","access","SeriesInfo","_useContext","seriesConfigInst","SeriesConfigClass","activeDialog","setActiveDialog","newTags","photos","existing","count","metaKeys","controls_ShortLongText","List","dense","createdUser","controls_UserListItem","tagKey","idtk","subheading","values","tags_TagChip","render","dialogs_BigText","xyTagChip","cursor","editing","reversedChip","chipAvatarIcon","reversedDelete","chipBucket","reversedChipBucket","XYTagChip","onTagDragOver","onTagDragStop","onTagDelete","onNewTag","isReversed","relCoords","newWidth","stopBadness","react_draggable_default","newHeight","onDrag","onStop","avatar","noOptionsMessage","singleValue","input","valueContainer","flexWrap","alignItems","XYTagSelect","tagConfig","options","tc","allowAdditions","react_select_esm","components","Control","Menu","NoOptionsMessage","Option","Placeholder","ValueContainer","blurInputOnSelect","isClearable","isSearchable","Creatable_default","InputProps","inputComponent","selectProps","inputRef","innerRef","innerProps","textFieldProps","square","_ref4","_ref5","isFocused","isSelected","buttonRef","selected","_ref6","header","listItem","dlgBody","paddingRight","XYTagChooser","xyTags","t","fullScreen","paperScrollPaper","tagType","tags_XYTagSelect","Tags","findTagById","tagId","getXYTags","xyTagIds","getNonXYTags","NonXYTagIds","createNewTagObj","createExistingTagObj","createNewXYTagObj","createExistingXYTagObj","getRelXYTags","multiplier","group","useXYTags","isDragging","setIsDragging","newTagDialog","setNewTagDialog","tagClass","addTag","__isNew__","updateTagLocation","oldTag","newX","parseInt","newY","onAddTagTrigger","pageX","pageY","TagChooser","tags_XYTagChooser","BrokenImg","BrokenImage_default","img","brokenImg","formControl","showTags","transition","refImgWrap","setNewSize","setUrl","broken","setBroken","urlRetryCounter","setURLRetryCounter","_getURL","newUrl","blob","getPhotoUrl","getURL","_useComponentSize","_useComponentSize$siz","urlWithRetries","_useXYTags","tags_XYTagChip","subViews_BrokenImg","onError","onLoad","_event$target","naturalHeight","naturalWidth","photoWrapper","dateCaption","mobileStepper","manualBack","manualForward","tagButton","slideshowButton","dots","SwipeShow","onImageSelect","initPhotoIndex","p","activePhoto","setActivePhoto","setShowTags","singular","sortedPhotos","sort","b","react_swipeable_views_lib_default","axis","index","onChangeIndex","val","enableMouseEvents","subViews_Photo","KeyboardArrowRight_default","KeyboardArrowLeft_default","GridListTileBar","subtitle","actionIcon","Badge","badgeContent","Label_default","MobileStepper","steps","activeStep","isFullScreen","slides","DeleteDialog","onConfirm","disableBackdropClick","disableEscapeKeyDown","tile","addFab","notDeleteable","unSelectedTile","& img","selectedTile","snackbarContent","snackbar","PhotoGrid","columns","multiSelect","onTileClick","selectMode","setSelectMode","selectedItems","setSelectedItems","deleteConfirm","setDeleteConfirm","ac","handleCancelSelection","toggleListItem","remaining","arrId","GridList","cols","cellHeight","canDelete","canUser","photoUrl","base64","GridListTile","handlePhotoTap","handleAddToSelection","Remove_default","Add_default","autoHideDuration","ContentProps","aria-describedby","dialogs_DeleteDialog","confirmation","SeriesView_style","appBar","overflowY","-webkit-overflow-scrolling","tabMenu","mapWrap","toolbarTitle","textOverflow","grow","gridList","titleBar","menuButton","placeholderInner","progressWrapper","placeholderText","SeriesView","onSlideshowStart","onEditSeries","onDeletePhotos","onCameraAdd","onDeleteSeries","onLibraryAdd","onMenuBack","onWatch","onUnWatch","watching","owned","contextEl","setContextEl","showQR","setShowQR","can","delete","contribute","listTypeTab","setListTypeTab","AppBar","ArrowBack_default","aria-haspopup","MoreVert_default","controls_ContextMenu","AddAlertIcon","QRCodeIcon","SlideshowIcon","EditIcon","DeleteIcon","Tabs","Tab","subViews_SwipeShow","subViews_SeriesInfo","subViews_PhotoGrid","maps_MapDot","controls_AddFab","views_QRDisplay","dlgContent","mapWrapper","sliderWrapper","slider","sliderRoot","MapDirPicker","onOk","onCancel","initLat","initLong","initDir","setCoords","setRotation","_ref2$viewport","mapFormLabel","Slider","step","BigTextEdit","setValue","rows","defaultValue","accessRadio","marginLeft","mapInnerWrap","chips","SeriesEditInner","delta","FormControlLabel","control","Switch","checked","dialogs_MapDirPicker","dialogs_BigTextEdit","newNote","SeriesEdit","setDelta","subViews_SeriesEditInner","swipeAble","slideContainer","slide","dotActive","iconButton","active","last","tagContainer","labelBadge","tagChip","Slideshow","_useStepper","useStepper","lastStep","handleForward","paused","pause","play","showXYTags","setShowXYTags","duration","titlePosition","PlayCircleFilled_default","PauseCircleFilled_default","nextButton","backButton","interval","setActiveStep","setPaused","setLastStep","createTimer","setInterval","oldStep","destroyTimer","clearInterval","CancelConfirm","TagControl_style","actionButtons","TagControl","tagValues","fieldTitle","rootEdit","textBody","DateControl","hint","onSelectChange","inputValue","removedValue","option","newVal","tcv","newCreateVal","v","selectOptions","remainingTags","deleteRemoves","isMulti","onTouchEnd","_ref7","_ref8","_ref9","TagEdit","controls_TagControl","DateView","dlgTitleContainer","catTagTitle","paddingTop","PhotoInfo","canEdit","activeDialogContext","tagInst","TagClass","controls_DateControl","controls_DateView","TagView","dialogs_TagEdit","dirty","PhotoInfoInner","newDelta","dialogs_CancelConfirm","appBarEdit","tipChip","activeButton","STATES","PhotoViewTool","initPhotoId","onUpdatePhoto","setMode","tagsClass","changeMode","desired","onCommitTags","infoButton","Info_default","containerStyle","photoidx","subViews_PhotoInfo","sliderLabel","rail","track","thumb","PhotoFadeSlider","setSlider","capturedContainer","referenceContainer","captured","reference","referenceTextContainer","newText","refText","PhotoReviewTool","defaultRefPhotoId","onRetry","newRefPhoto","refPhoto","controls_PhotoFadeSlider","useCamera","onCapture","cameraError","setCameraError","cameraOnline","setCameraOnline","camRef","Webcam","getElementById","setup","captureImage","capturedData","takeBlobPhoto","quality","ext","captureRawData","takeImageData","webcamElement","canvasElement","location","protocol","hostname","warn","mediaDevices","getUserMedia","aspectRatio","srcObject","getTracks","resolve","audio","video","facingMode","mediaStream","onloadedmetadata","onplaying","imageWidth","videoWidth","imageHeight","videoHeight","getContext","drawImage","_this$_drawImage","_drawImage","getImageData","_this$_drawImage2","toBlob","fileBlob","_this$_drawImage3","toDataURL","cameraErrorText","disabledFab","cameraFab","@media (orientation: landscape)","@media (orientation: portrait)","cameraIcon","cancelFab","cancelIcon","swipeDrawer","libraryFab","myLocationFab","myLocationIcon","CameraTool","onShutter","setRefPhoto","drawerOpen","setDrawerOpen","_useCamera","autoPlay","playsInline","muted","buttonFab","Camera_default","libraryIcon","SwipeableDrawer","anchor","paperAnchorLeft","onOpen","tabIndex","swipeDrawerContainer","role","onKeyDown","NewPhotoInfo","newSeries","onSave","seriesDelta","setSeriesDelta","photoDelta","setPhotoDelta","newAttr","useFileInput","anyFile","clickRef","element","accept","handleChange","evt","files","reader","FileReader","onloadend","result","getExtFromFile","readAsDataURL","fileClickEl","forceClick","LibraryFilePicker","_useFileInput","Series","MODES","NewPhoto","inputMethod","onCreate","isNewSeries","newPhotoData","setNewPhotoData","SeriesClass","setNewSeries","PhotoClass","setNewPhoto","photoRefId","setPhotoRefId","_useState9","_useState10","_changeMode","absolute","alpha","beta","gamma","deviceOrientation","setDeviceOrientation","handleDeviceOrientation","useDeviceOrientation","geo","newModeName","views_CameraTool","refId","_getExif2","date","_newPhoto","rawData","sensors","controls_LibraryFilePicker","_getExif","views_PhotoReviewTool","oldHistory","oldMode","views_NewPhotoInfo","AccessHelper","userSub","permissionObj","ownOrAny","isOwner","attrs","ownAny","perm","otherPerm","attributes","granted","AccessControl","sub","SeriesNotFound","SeriesLoading","CircularProgress","thickness","VIEW_ONLY_MODES","RepeatablePhotos","modeName","inputMethodINIT","currentUserId","currentUserRole","accessControl","onNewSeries","onChangePhoto","onNewPhoto","onDeletePhoto","AccesHelper","seriesState","pid","ph","seriesId","onApprovePhoto","newPid","newInputMethod","canUpdate","to","lastMode","views_SeriesLoading","views_SeriesNotFound","views_SeriesView","photoIdArr","sp","views_SeriesEdit","views_PhotoViewTool","views_Slideshow","views_NewPhoto","Provider","withGetSelectedQuery","skip","withUpdateSeriesMutation","_ref10","updateSeriesMutation","sanitizeUpdateParams","optimisticResponse","__typename","_ref11","qdata","readQuery","query","writeQuery","qdataAll","limit","summary","seriesSummaries","s","withUpdatePhotoMutation","_ref12","updatePhotoMutation","sanitizedPhotoDelta","newT","_ref13","updatedPhoto","withDeleteSeriesDeleteMutation","_ref14","deleteSeriesMutation","_ref15","withDeletePhotoMutation","_ref16","deletePhotoMutation","photoId","_ref17","finalCount","photoCount","withCreateNewSeries","_ref18","createSeriesMutation","_ownProps$user","meUserSummary","gravatarProfile","featured","latest","updatedUser","createdBy","updatedBy","createdOn","updatedOn","seriesCreatedBy","paths","base","large","orig","medium","_ref19","newAllSeriesEntry","push","doneCreatingSeries","withCreateNewPhoto","_ref20","createPhotoMutation","newPhotoInput","_ownProps$user2","_update","_callee4","_ref21","_context4","_x7","_x8","withWatchSeriesMutation","_ref22","watchSeriesMutation","_ref23","Set","qFeedData","withUnWatchSeriesMutation","_ref24","unWatchSeriesMutation","_ref25","sid","connectedWithApollo","onAfterSeriesDelete","onBack","queueUpload","currentUser","getValues","PhotoSeries","setItem","_x6","_x4","_x5","_state$home$current","inputObj","desiredParams","newDesiredParams","remainder","useClusteredData","filterBounds","currentZoom","sizeScale","queryVersion","clusteredData","setClusteredData","single","cluster","filteredData","setFilteredData","setVersion","updateDataDebounce","updatedData","_args","updateData","filterDataDebounce","filtered","_args2","filterData","filteredClusteredData","tree","rbush","screenCoords","project","properties","zoomLevels","geoJSON","point","clear","load","_loop","z","radius","sqrt","pow","neighbors","search","minX","minY","maxX","maxY","neighbor","newGeoJSON","centroid","featureCollection","uuid","reducedPhotoCount","points","newZ","geometry","coordinates","Apple","FeatureDisabled","IconComp","AppleIcon","drawerInner","disableListItem","fullList","SideDrawer","onDisabledClick","onQRClick","AccountCircle_default","loginButton","CloudDownload_default","ExitToApp_default","borderBottom","searchIcon","transparent","iOsIcon","transparentLogo","transparentLogoIcon","qrButton","qrButtonTransparent","TopBar","isTransparent","hideLogo","appleDlg","setAppleDlg","AppLogoSimple","components_SideDrawer","misc_FeatureDisabled","components_TopBar","TopBar_TopBar","useSearchBarStyles","shape","common","white","&:hover","breakpoints","up","inputRoot","inputInput","pointerEvents","justifyContent","SearchInput","debounceSearchText","blur","Search_default","InputBase","chipContainer","accessLabel","accessPUBLIC","accessPRIVATE","accessOPEN","verticalAlign","titleText","dateContainer","dateLabel","dateText","imgFiller","SeriesListItem","showCreatedOn","showLastPhoto","misc_SeriesListItem","ClusterSelected","seriesCount","onZoomTo","ZoomOutMap_default","&.PUBLIC","&.PRIVATE","&.OPEN","avatarActive","badge","badgeActive","Cluster","numeral","& .myPosMarker","& .singleMarker","& .clusterMarker","topBar","loadingWrapper","zoomOutFab","selectedPopup","defaultView","HomeMap","seriesList","onSeriesClick","onSearchClick","pushMapHistory","popMapHistory","clearMapHistory","mapViewObj","setMapViewObj","mapViewRef","homeMapContainerRef","setCurrentZoom","setTransitions","selectedItem","setSelectedItem","bufferPts","buffer","units","bbox","updateSelectedItem","item","saveMap","object","pts","lngBuff","latBuff","buffBounds","onMarkerClick","LinearInterpolator","markersRendered","offsetLeft","offsetTop","markers_Single","markers_Cluster","selectedItemRender","misc_ClusterSelected","Search_SearchInput","components_maps_BaseMap","maxZoom","minZoom","viewZoom","getBounds","_map$getBounds","_map$getBounds$_sw","_sw","minLng","lng","minLat","lat","_map$getBounds$_ne","_ne","maxLng","maxLat","oldMinLng","oldMinLat","oldMaxLng","oldMaxLat","onNativeClick","POLL_INTERVAL","withAllSeries","nextToken","fetchMore","updateQuery","fetchMoreResult","setSeriesProps","readyForPolling","withPollQuery","lastCheck","_ref5$ownProps","seriesProps","updateIncrement","changedSeries","oldList","newSeriesSummaries","seriesStatus","polledSeries","ds","oldSeries","oldId","AllSeriesConnect","PollQueryConnect","mapFuncs","tab","setLastCheck","allSeriesQUERY","pollSeriesQUERY","maps_HomeMap","chosenItem","closeIcon","avatarImg","SearchContextItem","TheIcon","PlaceIcon","LabelIcon","PersonIcon","Search_SearchContextItem","overflowX","listSection","ul","SearchContextResults","contextResults","setContextChoice","cr","SearchEnder","ctxItem","SearchResults","contextChoice","onResultClick","listRef","enderRef","handleScroll","_listRef$current","scrollTop","Search_SearchEnder","subheader","onScroll","SearchPlaceholder","PlaceholderIcon","TABS","tabs","ListWrapper","Search","currentTab","setCurrentTab","defaultText","searchText","setSearchText","searchResults","onMapClick","Search_SearchResults","Search_SearchContextResults","Search_SearchPlaceholder","PortableWifiOffIcon","indicatorColor","flexContainer","centered","TAGS","withTagSearch","ceil","withUserSearch","searchStr","withGeoCode","geocoder","relevance","placeName","center","withTagSeries","tagSeries","withUserSeries","defaultTab","jumpToSeries","jumpToMap","bboxFunc","withContextQuery","withSearchQuery","ComposedSearch","newContextChoice","newTab","MeCard","filterContainer","filterChip","seriesListItemWrap","noneFound","SORT","MyProfile","mySeries","watchingSeries","sortVal","setSort","sortAsc","setSortAsc","sortSetter","newSort","tabFeed","firstname","MyProfile_MeCard","MyProfile_FilterSortItem","asc","useFilterStyles","FilterSortItem","arrow","withuserSeriesQuery","seriesQ","withMyWatchedSeriesQuery","watchedSeriesQ","queryWrapped","arraySeries","components_MyProfile_MyProfile","FeedEnder","placeAvatar","placeIcon","FindOnMapButton","Place_default","findOnMapButtonContainer","titleContainer","seriesName","EVENT_VERBS","FeedItem","onImageClick","onProfileClick","misc_FindOnMapButton","listContainer","vList","feedContainer","MyFeed","events","fetchNewest","dist_es","rowCount","rowHeight","rowRenderer","isScrolling","isVisible","parent","row","MyFeed_FeedItem","wEnd","MyFeed_FeedEnder","almostAtEnd","ROWHEIGHT","withFeedQuery","loadingNewest","loadingMore","myFeed","start","feed","end","jumpToUser","components_MyFeed_MyFeed","qrIcon","tipPaper","docContainer","cameraContainer","snackErr","snackSuccess","snackMsg","QRReader","capturedImg","setCapturedImg","setErr","code","setCode","captureFunc","scannedCode","decodedUrl","jsQRFromBase64","decodeURI","t1","scan","SnackbarContent","jsQR","OfflineBar","sinceStr","setSinceStr","calcSinceStr","clearTimer","homeConfig","borderTop","BottomBar","onHomeClick","edge","HomeOutlined_default","MapOutlined_default","SearchOutlined_default","PersonOutline_default","components_BottomBar","outerRoot","offlineBar","activeWrapper","flexShrink","uploaderContainer","App","onQRCapture","setHomeState","showBottomBar","activeProps","ActiveComponent","FeedConnect","MapConnect","ProfileConnect","SearchConnect","SeriesConnect","misc_OfflineBar","Uploader_connect","App_connect","setUseOffline","bVal","_useAuthentication","_useGraphQL","useGraphQL","apolloLoaded","_useOnline","_useShowAddToHome","responsive","appContext","react_apollo_esm","translations_IntlWrapper","lib_ErrorBoundary","ErrorConnect","isLocalhost","match","registerValidSW","swUrl","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","onUpdate","onSuccess","require","ReactDOM","href","origin","fetch","contentType","status","ready","unregister","reload","checkValidServiceWorker"],"mappings":"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","file":"static/js/main.d8808e6d.chunk.js","sourcesContent":["const TYPES = {\n  // Series meta gets appended automatically to the seriees\n  SERIES: 'SERIES',\n  // Same but now only gets appended to the photo\n  PHOTO: 'PHOTO'\n}\nclass SeriesConfig {\n  constructor (seriesConfig) {\n    if (!seriesConfig) throw new Error('No seriesConfig object provided to SeriesConfig class')\n    this.config = seriesConfig\n  }\n\n  getTagType = (typeId) => this.config.tags.find(tt => tt.id === typeId)\n  // getTagTypeIndex = (typeId) => this.config.tags.findIndex(tt => tt.id === typeId)\n  getTagTypeIndex = (typeId) => {\n    // console.log('HERE', typeId)\n    return this.config.tags.findIndex(tt => tt.id === typeId)\n  }\n\n  getXYTagTypes = () => this.config.tags.filter(tt => tt.allowXY)\n  getNonXYTagTypes = () => this.config.tags.filter(tt => tt.allowNonXY)\n\n  getSeriesMeta = () => Object.keys(this.config.meta)\n    .filter(key => this.config.meta[key].type === TYPES.SERIES)\n    .reduce((acc, key) => ({\n      ...acc,\n      [key]: this.config.meta[key].default\n    }), {})\n\n  getPhotoMeta = () => Object.keys(this.config.meta)\n    .filter(key => this.config.meta[key].type === TYPES.PHOTO)\n    .reduce((acc, key) => ({\n      ...acc,\n      [key]: this.config.meta[key].default\n    }), {})\n}\n\nexport default SeriesConfig\n","import { convertJSDatetoTimestamp } from './datelib'\nimport SeriesConfig from './SeriesConfig'\nimport uuidv4 from 'uuid/v4'\nimport exifParser from 'exif-parser'\nimport { isNumeric } from './util'\n\nclass Photo {\n  constructor (seriesConfig, photo) {\n    this.config = new SeriesConfig(seriesConfig)\n    if (photo) this.photo = photo\n    else {\n      this.photo = this.newPhoto()\n    }\n  }\n\n  setMeta = () => {\n    this.meta = JSON.stringify(this.config.getPhotoMeta())\n  }\n\n  newPhoto = () => ({\n    id: `__LOCAL_PHOTO::${uuidv4()}`,\n    uploadToken: uuidv4(),\n    takenOn: convertJSDatetoTimestamp(new Date()),\n    meta: JSON.stringify(this.config.getPhotoMeta()),\n    tags: []\n  })\n}\n\nexport default Photo\n\nexport const getObjectUrl = async (store, key) => {\n  try {\n    const dbval = await store.getItem(key)\n    const urlVal = window.URL.createObjectURL(dbval)\n    if (urlVal && urlVal.indexOf('data:image') === 0) {\n      return urlVal\n    }\n  }\n  catch (e) {\n    console.error(e)\n  }\n\n  return null\n}\n\nexport const getExif = (dataUrl) => {\n  console.log('onLibraryAdd Buffered')\n\n  let exif = null\n  let exifDateTime = null\n  let exifGPS = null\n  try {\n    const find = 'base64,'\n    const foundIdx = dataUrl.indexOf(find) + find.length\n    const newData = dataUrl.slice(foundIdx)\n    const parser = exifParser.create(Buffer.from(newData, 'base64'))\n    exif = parser.parse()\n    console.log('got EXIF', exif)\n  }\n  catch (err) {\n  // got invalid data, handle error\n    console.error('EXIF ERROR', err)\n  }\n  if (exif && exif.tags) {\n    // Try to parse the DateTime of the original image\n    try {\n      if (exif.tags && exif.tags.DateTimeOriginal && String(exif.tags.DateTimeOriginal)) {\n        exifDateTime = String(exif.tags.DateTimeOriginal)\n      }\n    }\n    catch (err) {\n      console.log('EXIF', exif)\n      console.error('ERROR GETTING TIMESTAMP', err)\n    }\n    // Try to pull out the GPS info from the image\n    try {\n      if (exif.tags.GPSLatitude && isNumeric(exif.tags.GPSLatitude) && exif.tags.GPSLongitude && isNumeric(exif.tags.GPSLongitude)) {\n        exifGPS = [exif.tags.GPSLongitude, exif.tags.GPSLatitude]\n      }\n    }\n    catch (e) {\n      console.error('GPS Longitude and Latitude could not be determined')\n    }\n  }\n  return { exif, exifDateTime, exifGPS }\n}\n","import moment from 'moment'\n\n/**\n * Takes a UTC unix timestamp integer or string (milliseconds)\n * and a valid moment format string and returns a formatted\n * date string\n * @param {*} utctimestamp\n * @param {*} format\n */\nexport const formatDate = (utctimestamp, format = 'LLLL') => {\n  return moment(utctimestamp, 'x').format(format)\n}\n\nexport const formatDatAgo = (utctimestamp) => {\n  return moment(utctimestamp, 'x').fromNow()\n}\n\n/**\n * Takes a UTC timestamp and returns a moment object in LOCAL mode\n * @param {*} utctimestamp\n */\nexport const parseDate = (utctimestamp) => {\n  return moment(utctimestamp, 'x')\n}\n\n/**\n * This returns the object in LOCAL mode\n * @param {*} jsDate\n */\nexport const convertJSDatetoTimestamp = (jsDate) => {\n  return moment\n    .utc(jsDate)\n    .format('x')\n}\n\n/**\n *\n * @param {*} utctimestamp\n */\nexport function timestampToHTML5Input (utctimestamp) {\n  // // trim the Z and milliseconds + seconds\n  return moment(utctimestamp, 'x').format('YYYY-MM-DDTkk:mm')\n}\n\n/**\n * Returns an integer timestamp\n * @param {*} isoStr\n */\nexport function HTML5InputToTimestamp (isoStr) {\n  return moment(new Date(isoStr), 'YYYY-MM-DDTkk:mm').format('x')\n}\n","import numeral from 'numeral'\n\nexport const isNumeric = num => {\n  try {\n    return !isNaN(parseFloat(num)) && isFinite(num)\n  }\n  catch (e) {\n    return false\n  }\n}\n/**\n * This is a correction to strip === signs off of base64-encoded strings\n * @param {} x\n */\nexport const urlizeb64 = x => x.replace('+', '-').replace('/', '_').replace(/=+$/, '')\n\n/**\n * We need numbers displayed consistently. This is how we do it.\n * @param {*} num\n * @param {*} precision\n */\nexport function formatNum (num, precision) {\n  try {\n    const precstr = precision > 0 ? '.' + Array(precision + 1).join('0') : ''\n    const newprec = isNumeric(num) ? numeral(num).format(`0,0${precstr}`) : num\n    return newprec.replace(/(\\.(0{0,1}[1-9]*))0+$/, '$1')\n  }\n  catch (e) {\n    return num\n  }\n}\n\n/**\n * Magic function to clear mouse selection. Use sparingly.\n */\nexport function clearSelection () {\n  if (document.selection && document.selection.empty) {\n    document.selection.empty()\n  }\n  else if (window.getSelection) {\n    var sel = window.getSelection()\n    sel.removeAllRanges()\n  }\n}\n\nexport function isObjectWithKeys (obj) {\n  return ((typeof obj === 'object') && (obj !== null) && Object.keys(obj).length > 0)\n}\n\n/**\n * Dom node parsing is weird because it may return an array or a single element with no way to know\n * which is which.\n */\nexport function makeDomArray (domnode) {\n  if (!domnode) return []\n  const keys = Object.keys(domnode)\n  // This is not the pattern we expect\n  if (keys.length > 1 || keys.length === 0) throw Error('Expected nester domnode structure.')\n  if (!domnode) return []\n  if (!domnode[keys[0]]) return []\n  return Array.isArray(domnode[keys[0]]) ? domnode[keys[0]] : [domnode[keys[0]]]\n}\n\nexport function capitalizeFirstLetter (string) {\n  return string.charAt(0).toUpperCase() + string.slice(1)\n}\n\n/**\n * Good for comparing two purely numeric arrays\n * @param {*} arr1\n * @param {*} arr2\n */\nexport function numericArrayCompare (arr1, arr2) {\n  if (!Array.isArray(arr1) || !Array.isArray(arr2)) return false\n  if (arr1.length !== arr2.length) return false\n\n  return !arr1.some((el, idx) => el !== arr2[idx])\n}\n\n/**\n * We need a function to add the padding '=' signs back before we decode\n * @param {*} hash\n */\nexport function decodeUnbufferedBase64 (hash) {\n  const missingPadding = hash.length % 4\n  if (missingPadding !== 0) {\n    const newhash = hash + Array(4 - missingPadding).join('=')\n    return Buffer.from(newhash, 'base64').toString()\n  }\n  else {\n    return Buffer.from(hash, 'base64').toString()\n  }\n}\n\nexport function encodeUnbufferedBase64 (str) {\n  return urlizeb64(Buffer.from(str).toString('base64'))\n}\n\n/**\n *\n * @param {*} o\n */\nexport function isObject (o) {\n  return o instanceof Object && o.constructor === Object\n}\n\n/**\n * XML to JSON is a non-trivial exercise. We can make certain assumptions\n * about our incoming file\n * @param {*} data\n */\nexport function arrToObj (data) {\n  for (const key in data) {\n    // Make sure we're looping over legitimate objects\n    if (data.hasOwnProperty(key)) {\n      const keyDat = data[key]\n      if (keyDat._) {\n        keyDat.val = keyDat._\n        delete keyDat._\n      }\n      if (keyDat.$) {\n        keyDat.attr = keyDat.$\n        delete keyDat.$\n      }\n      if (typeof keyDat === 'object') {\n        data[key] = arrToObj(keyDat)\n        // There's a pattern we want to collapse\n        // It puts every single individual value into its own array. Not cool\n        if (Array.isArray(keyDat) && keyDat.length === 1 && typeof keyDat[0] === 'string') {\n          if (isNumeric(keyDat[0])) data[key] = Number(keyDat[0])\n          else data[key] = keyDat[0].replace(/\\\\/g, '/')\n        }\n        else if (Array.isArray(keyDat) && keyDat.length === 1 &&\n        // The second case is when it puts objects into its own array\n          isObject(keyDat[0]) &&\n          Object.keys(keyDat[0]).length === 1) {\n          // xml2js does a weird thing where attributes get put into the following structure\n          // [{ \"_\": \"475945.992587164,5125837.37170763\", \"$\": { \"units\": \"m\"  } }]\n          data[key] = keyDat[0][Object.keys(keyDat[0])[0]]\n        }\n        // Dynamo DB does not like empty strings\n        if (typeof data[key] && data[key].length === 0) {\n          delete data[key]\n        }\n        if (typeof data[key] === 'string' && isNumeric(data[key])) data[key] = Number(data[key])\n      }\n    }\n  }\n  return data\n}\n\n/**\n * Returns a random number between min (inclusive) and max (exclusive)\n */\nexport function getRandomArbitraryInt (min, max) {\n  return parseInt(Math.random() * (max - min) + min, 10)\n}\n\n/**\n * Returns a function, that, as long as it continues to be invoked, will not\n * be triggered. The function will be called after it stops being called for\n * N milliseconds. If `immediate` is passed, trigger the function on the\n * leading edge, instead of the trailing.\n * @param {*} func\n * @param {*} wait\n * @param {*} immediate\n */\nexport function debounce (func, wait, immediate) {\n  let timeout = null\n  return (...innerArgs) => {\n    const context = this\n    // const args = arguments\n    const callNow = immediate && !timeout\n    clearTimeout(timeout)\n\n    timeout = setTimeout(() => {\n      timeout = null\n      if (!immediate) {\n        // console.log('debounce', innerArgs)\n        func.apply(context, innerArgs)\n      }\n    }, wait)\n    if (callNow) {\n      // console.log('debounce', innerArgs)\n      func.apply(context, innerArgs)\n    }\n  }\n};\n\n// var myEfficientFn = debounce(function() {\n// // All the taxing stuff you do\n// }, 250);\n\n// window.addEventListener('resize', myEfficientFn);\n","// https://medium.com/@shalkam/create-react-app-i18n-the-easy-way-b05536c594cb\nimport React, { useContext } from 'react'\nimport PropTypes from 'prop-types'\nimport { IntlProvider, addLocaleData } from 'react-intl'\nimport frLocaleData from 'react-intl/locale-data/fr'\n\naddLocaleData(frLocaleData)\n\nexport const IntlContext = React.createContext({})\n\n// the format message hook\nexport const useIntl = () => {\n  const intl = useContext(IntlContext)\n  return intl.formatMessage\n}\n\nexport const IntlWrapper = ({ children }) => (\n  <IntlProvider locale='en'>\n    {children}\n  </IntlProvider>\n)\nIntlWrapper.propTypes = {\n  children: PropTypes.any\n}\n","import gql from 'graphql-tag'\n\nexport const photoSummaryFragment = gql`\nfragment photoSummaryFragment on PhotoSummary {\n  id\n  takenOn\n  seriesCreatedBy\n  updatedOn\n  createdOn\n  seriesId\n  createdUser {\n    ...userSummaryFragment\n  }\n  paths {\n    base\n    thumb\n    medium\n    large\n  }\n}\n`\n\nexport const userSummaryFragment = gql`\nfragment userSummaryFragment on UserSummary {\n  id\n  gravatar\n  gravatarProfile\n  username\n}\n`\n\nexport const seriesSummaryFragment = gql`\nfragment seriesSummaryFragment on SeriesSummary {\n  id\n  name\n  access\n  createdUser {\n    ...userSummaryFragment\n  }\n  seriesStatus\n  updatedOn\n  createdOn\n  photoCount\n  coords\n  direction\n  watchers\n  featured {\n    ...photoSummaryFragment\n  }\n  latest {\n    ...photoSummaryFragment\n  }\n}\n${photoSummaryFragment}\n${userSummaryFragment}\n`\n\nexport const seriesFragment = gql`\nfragment seriesFragment on Series {\n  id\n  name\n  access\n  note\n  meta\n  watchers\n  createdOn\n  updatedOn\n  createdUser {\n    ...userSummaryFragment\n  }\n  updatedUser {\n    ...userSummaryFragment\n  }\n  coords\n  direction\n  photoCount\n  featured {\n    ...photoSummaryFragment\n  }\n  latest {\n    ...photoSummaryFragment\n  }\n}\n${photoSummaryFragment}\n${userSummaryFragment}\n`\n\nexport const photoFragment = gql`\nfragment photoFragment on Photo {\n  id\n  meta\n  createdOn\n  takenOn\n  updatedOn\n  coords\n  seriesId\n  seriesCreatedBy\n  createdBy\n  updatedBy\n  uploadToken\n  createdUser {\n    ...userSummaryFragment\n  }\n  updatedUser {\n    ...userSummaryFragment\n  }\n  tags {\n    label\n    typeId\n    coords {\n      x\n      y\n    }\n  }\n  paths {\n    base\n    large\n    thumb\n    medium\n  }\n}\n${userSummaryFragment}\n`\n\nexport const userFragment = gql`\nfragment userFragment on User {\n  id\n  username\n  gravatar\n  watching\n  gravatarProfile\n  meta\n  createdOn\n  updatedOn\n}\n`\n","import gql from 'graphql-tag'\nimport {\n  photoSummaryFragment,\n  photoFragment,\n  seriesSummaryFragment,\n  seriesFragment,\n  userFragment\n} from './fragments'\n\nexport const allSeries = gql`\nquery allSeries($limit: Int, $nextToken: String) {\n  allSeries(limit: $limit, nextToken: $nextToken) @connection(key: \"allSeries\"){\n    seriesSummaries {\n      ...seriesSummaryFragment\n    }\n    nextToken\n  }\n}\n${seriesSummaryFragment}\n`\n\nexport const pollQuery = gql`\nquery pollQuery($lastCheck: String!, $limit: Int, $nextToken: String) {\n  changedSeries(lastCheck: $lastCheck, limit: $limit, nextToken: $nextToken) @connection(key: \"changedSeries\"){\n    seriesSummaries {\n      ...seriesSummaryFragment\n    }\n  }\n}\n${seriesSummaryFragment}\n`\n\nexport const userSeries = gql`\nquery userSeries($createdBy: ID) {\n  userSeries(createdBy: $createdBy ) {\n    seriesSummaries {\n      ...seriesSummaryFragment\n    }\n    nextToken\n  }\n}\n${seriesSummaryFragment}\n`\n\nexport const seriesSummaryFromList = gql`\nquery seriesFromList($seriesList: [ID]) {\n  arraySeries(seriesIds: $seriesList) {\n    ...seriesSummaryFragment\n  }\n}\n${seriesSummaryFragment}\n`\n\nexport const seriesFromList = gql`\nquery seriesFromList($seriesList: [ID]) {\n  arraySeries(seriesIds: $seriesList) {\n    ...seriesFragment\n    photos {\n      ...photoFragment\n    }\n  }\n}\n${seriesFragment}\n${photoFragment}\n`\n\nexport const seriesWithTag = gql`\nquery seriesWithTag($tag: String!, $limit: Int, $nextToken: String) {\n  tagSeries(tag: $tag, limit: $limit, nextToken: $nextToken) {\n    seriesSummaries{\n      ...seriesSummaryFragment\n    }\n    nextToken\n  }\n}\n${seriesSummaryFragment}\n`\n\nexport const tagSearch = gql`\nquery tagSearch($limit: Int, $tag: String) {\n  tags(limit: $limit, tag: $tag ){\n    _id\n    name\n    count\n  }\n}\n`\n\nexport const geoSeries = gql`\nquery seriesInGeoBounds($bounds: [Float], $limit: Int, $nextToken: String) {\n  seriesInGeoBounds(bounds: $bounds, limit: $limit, nextToken: $nextToken) {\n    seriesSummaries {\n      ...seriesSummaryFragment\n    }\n    nextToken\n  }\n}\n${seriesSummaryFragment}\n`\n\nexport const getUser = gql`\nquery getUser($userId: ID) {\n  user(id: $userId){\n    ...userFragment\n  }\n}\n${userFragment}\n`\n\nexport const geocode = gql`\nquery geocode($search: String!) {\n  geocoder(search: $search) {\n    relevance\n    text\n    placeName\n    bbox\n    center\n    # geoType\n    # context\n  }\n}\n`\nexport const getMyFeed = gql`\nquery myFeed($start: String, $end: String, $limit: Int) {\n  myFeed(start: $start, end: $end, limit: $limit) @connection(key: \"myFeed\"){\n    feed {\n      _id\n      series {\n        ...seriesSummaryFragment\n      }\n      photo {\n        ...photoSummaryFragment\n      }\n      relation\n    }\n    window\n  }\n}\n${seriesSummaryFragment}\n${photoSummaryFragment}\n`\n\nexport const userSearch = gql`\nquery userSearch($searchStr: String!, $limit: Int) {\n  userSearch(searchStr: $searchStr, limit: $limit ){\n    ...userFragment\n  }\n}\n${userFragment}\n`\n\nexport const getWholeSeries = gql`\nquery getWholeSeries($id: ID!) {\n  series(id: $id) {\n    ...seriesFragment\n    photos {\n      ...photoFragment\n    }\n  }\n}\n${seriesFragment}\n${photoFragment}\n`\n","import { createMuiTheme } from '@material-ui/core/styles'\nimport { fade, lighten } from '@material-ui/core/styles/colorManipulator'\n// import {\n//   cyan, teal, indigo, grey, blueGrey, pink, yellow, deepOrange, red\n// } from '@material-ui/core/colors'\n\n// We need this so that it doesn't freak out abotu old variants\nconst typography = {\n  useNextVariants: true\n}\n\nconst colors = {\n  jet: '#3a3335', // JET\n  rose: '#d81e5b', // DOGWOOD ROSE\n  redorange: '#f0544f', // RED-ORANGE\n  papayawhip: '#FDF0D5', // PAPAYA WHIP\n  cblue: '#C6D8D3' // COLUMBIA-BLUE\n}\n\nconst home = {\n  palette: {\n    primary: {\n      main: colors.redorange\n    },\n    secondary: {\n      main: colors.rose\n    },\n    text: {\n      primary: colors.jet,\n      secondary: fade(colors.jet, 0.7)\n    }\n  },\n  typography\n}\n\nconst series = {\n  palette: {\n    primary: {\n      main: lighten(colors.jet, 0.1)\n    },\n    secondary: {\n      main: colors.rose\n    },\n    text: {\n      primary: colors.jet,\n      secondary: fade(colors.jet, 0.7)\n    }\n  },\n  typography\n}\n\nconst topbar = {\n  palette: {\n    primary: {\n      main: colors.redorange\n    },\n    secondary: {\n      main: colors.rose\n    }\n  },\n  typography\n}\n\nconst bottombar = {\n  palette: {\n    primary: {\n      main: colors.papayawhip\n    },\n    secondary: {\n      main: colors.redorange\n    }\n  },\n  typography\n}\n\nconst login = {\n  palette: {\n    primary: {\n      main: colors.redorange\n    },\n    secondary: {\n      main: colors.rose\n    },\n    text: {\n      primary: colors.papayawhip,\n      secondary: fade(colors.papayawhip, 0.7)\n    },\n    background: {\n      default: colors.jet,\n      paper: colors.jet\n    }\n  },\n  typography\n}\n\nexport default {\n  home: createMuiTheme(home),\n  login: createMuiTheme(login),\n  series: createMuiTheme(series),\n  topbar: createMuiTheme(topbar),\n  bottombar: createMuiTheme(bottombar)\n}\n","import React from 'react'\n\nexport const AppContext = React.createContext({})\n","import { useRef, useEffect } from 'react'\n\nconst useAuthCommon = () => {\n  const containerRef = useRef()\n  const handleKeyPress = (event) => {\n    if (event.key === 'Enter') {\n      if (containerRef.current) {\n        try {\n          const found = containerRef.current.getElementsByClassName('enterAction')\n          if (found && found[0]) found[0].click()\n        }\n        catch (e) {\n          console.error('useAuthCommon::handleKeyPress', e)\n        }\n      }\n    }\n  }\n  useEffect(() => {\n    if (containerRef.current) {\n      try {\n        document.addEventListener('keypress', handleKeyPress, false)\n      }\n      catch (e) {\n        console.error('useAuthCommon::useEffect', e)\n      }\n      return () => document.removeEventListener('keypress', handleKeyPress, false)\n    }\n  }, [])\n\n  return containerRef\n}\n\nexport default useAuthCommon\n","import React from 'react'\nimport createSvgIcon from '@material-ui/icons/utils/createSvgIcon'\n\nexport default createSvgIcon(\n  <React.Fragment>\n    <path d='M13.685,2.797c-0.44,1.273 0.852,3.525 -1.082,4.966c-1.247,0.93 -2.133,2.247 -2.743,4.167c-3.78,-7.611 2.788,-8.409 3.682,-10.699c0.64,1.255 5.18,2.608 2.89,4.873c1.28,-2.034 -2.359,-1.862 -2.747,-3.307Z' />\n    <path d='M4.921,5.953c0.883,1.017 3.479,1.024 3.76,3.42c0.181,1.545 0.879,2.971 2.238,4.459c-8.482,-0.532 -5.889,-6.619 -7.425,-8.538c1.407,0.073 4.848,-3.183 5.665,-0.066c-1.121,-2.126 -2.792,1.111 -4.238,0.725Z' />\n    <path d='M3.236,15.092c1.323,-0.256 2.627,-2.5 4.842,-1.546c1.428,0.615 3.013,0.724 4.98,0.292c-4.701,7.079 -8.676,1.79 -11.106,2.161c0.766,-1.183 -0.332,-5.791 2.775,-4.94c-2.402,-0.091 -0.433,2.974 -1.491,4.033Z' />\n    <path d='M10.309,21.121c0.439,-1.274 -0.852,-3.525 1.081,-4.967c1.247,-0.929 2.133,-2.246 2.743,-4.167c3.781,7.611 -2.788,8.409 -3.681,10.699c-0.641,-1.255 -5.181,-2.607 -2.891,-4.873c-1.28,2.034 2.359,1.863 2.748,3.308Z' />\n    <path d='M19.066,18.01c-0.883,-1.017 -3.479,-1.024 -3.76,-3.42c-0.182,-1.544 -0.88,-2.971 -2.238,-4.459c8.482,0.532 5.889,6.619 7.425,8.538c-1.407,-0.072 -4.849,3.183 -5.665,0.067c1.121,2.125 2.792,-1.112 4.238,-0.726Z' />\n    <path d='M20.751,8.871c-1.323,0.256 -2.627,2.501 -4.842,1.546c-1.429,-0.615 -3.013,-0.723 -4.98,-0.291c4.701,-7.08 8.676,-1.791 11.106,-2.162c-0.767,1.183 0.332,5.791 -2.775,4.94c2.401,0.092 0.433,-2.974 1.491,-4.033Z' />\n\n  </React.Fragment>, 'AppLogo')\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport { makeStyles } from '@material-ui/core/styles'\n// import style from './auth.style'\nimport useAuthCommon from './useAuthCommon'\nimport AppLogo from '../../icons/AppLogo'\n\nimport { ThemeProvider } from '@material-ui/styles'\nimport themes from '../../themes'\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    height: '100%'\n  },\n  bgSwoosh: {\n    width: '100%',\n    height: '100%',\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    zIndex: 0\n  },\n  spacer: {\n    flex: '1 1 5%'\n  },\n  logo: {\n    flex: '1 1 40%',\n    width: '100%',\n    minHeight: 90\n  },\n  inner: {\n    margin: '0 auto',\n    width: '100%',\n    height: '100%',\n    minWidth: 200,\n    maxWidth: 300,\n    display: 'flex',\n    flexDirection: 'column',\n    textAlign: 'center'\n  }\n}))\n\nconst AuthContainer = ({ children }) => {\n  const containerRef = useAuthCommon()\n  const classes = useStyles()\n  return (\n    <ThemeProvider theme={themes.login}>\n      <div ref={containerRef} className={classes.root}>\n        <CssBaseline />\n        {/* Look for: LoginSwoosh.svg */}\n        {/* <svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 500 500' preserveAspectRatio='none' className={classes.bgSwoosh}>\n        <path className={classes.bgSwooshFill} d=' M 0 0 L 500 0 C 500 209.782 489.956 180 250 180 C 10.044 180 0 219.954 0 370 L 0 0 Z ' />\n      </svg> */}\n\n        <div className={classes.inner}>\n          {/* Look for: Logo.svg */}\n          <AppLogo className={classes.logo} />\n\n          <Typography variant='h5'>MorPhoto</Typography>\n          {children}\n          <div className={classes.spacer} />\n        </div>\n      </div>\n    </ThemeProvider>\n  )\n}\n\nAuthContainer.propTypes = {\n  children: PropTypes.any\n}\n\nexport default AuthContainer\n","import React from 'react'\nimport PropTypes from 'prop-types'\n// import MenuIcon from '@material-ui/core/Menu'\n// import { makeStyles } from '@material-ui/core/styles'\n// import style from './auth.style'\nimport AuthContainer from './AuthContainer'\nimport { Typography } from '@material-ui/core'\n\n// const useStyles = makeStyles(style)\n\nconst Loading = ({ message }) => {\n  // const classes = useStyles()\n  return (\n    <AuthContainer>\n      <Typography variant='h3'>Loading...</Typography>\n      {message && <Typography variant='overline'>{message}</Typography>}\n    </AuthContainer>\n  )\n}\n\nLoading.propTypes = {\n  message: PropTypes.string\n}\n\nexport default Loading\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\n/**\n * Note: this was one of the few components we didn't use hooks for\n * mostly because I couldn't find an easy way to do getDerivedStateFromError()\n *\n * We might revise this later\n */\nclass ErrorBoundary extends React.Component {\n  constructor (props) {\n    console.log('ErrorBoundary constructor')\n    super(props)\n    this.state = { hasError: false }\n  }\n\n  static getDerivedStateFromError (error) {\n    // Update state so the next render will show the fallback UI.\n    console.log('ErrorBoundary getDerivedStateFromError')\n    console.error(error)\n    return { hasError: true, error }\n  }\n\n  componentDidCatch (error, info) {\n    console.log('ErrorBoundary componentDidCatch')\n    console.error(error)\n    // You can also log the error to an error reporting service\n    // logErrorToMyService(error, info)\n  }\n\n  render () {\n    const { hasError, error } = this.state\n    const { fallback: FallbackUI } = this.props\n    if (hasError) {\n      console.log('ErrorBoundary hasError')\n      // You can render any custom fallback UI\n      return <FallbackUI error={error} />\n    }\n\n    return this.props.children\n  }\n}\nErrorBoundary.propTypes = {\n  children: PropTypes.any,\n  fallback: PropTypes.any\n}\n\nexport default ErrorBoundary\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport Button from '@material-ui/core/Button'\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport DialogContentText from '@material-ui/core/DialogContentText'\nimport TextField from '@material-ui/core/TextField'\nimport DialogActions from '@material-ui/core/DialogActions'\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport BugReportIcon from '@material-ui/icons/BugReport'\nimport ErrorIcon from '@material-ui/icons/Error'\nimport { makeStyles } from '@material-ui/core/styles'\n\nexport const SEND_STATES = {\n  UNSENT: 'UNSENT',\n  SENDING: 'SENDING',\n  SENT: 'SENT',\n  ERROR: 'ERROR'\n}\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    height: '100%',\n    overflow: 'hidden',\n    padding: theme.spacing(1),\n    display: 'flex',\n    flexDirection: 'column',\n    textAlign: 'center',\n    color: theme.palette.text.primary,\n    border: `20px solid ${theme.palette.text.secondary}`\n  },\n  button: {\n    // background: theme.palette.success.main,\n    // color: theme.palette.success.contrastText\n  },\n  icon: {\n    opacity: 0.5,\n    margin: 'auto',\n    flex: '0 1 10%',\n    // height: '50%',\n    width: '50%'\n  },\n  text: {\n  },\n  spacer: {\n    flexGrow: 1\n  },\n  stack: {\n    padding: theme.spacing(2),\n    marginBottom: theme.spacing(2),\n    fontSize: '8px',\n    flexGrow: 1,\n    textAlign: 'left',\n    whiteSpace: 'pre-wrap',\n    overflow: 'scroll',\n    color: theme.palette.error.main,\n    fontFamily: 'Consolas, monaco, monospace'\n  }\n}))\n\nconst ErrorScreen = ({ error, sendState, reportError }) => {\n  const classes = useStyles()\n  const [dlgOpen, setDialogOpen] = useState(false)\n  const [note, setNote] = useState('')\n\n  let stackEl = <div className={classes.spacer} />\n  try {\n    if (process.env.NODE_ENV === 'development') {\n      stackEl = (\n        <Typography className={classes.stack}>\n          {error.stack}\n        </Typography>\n      )\n    }\n  }\n  catch (e) {}\n\n  let buttonText = 'Report this bug'\n  let disabled = false\n  let color = 'primary'\n  switch (sendState) {\n    case SEND_STATES.UNSENT:\n      buttonText = 'Report this bug'\n      break\n    case SEND_STATES.SENDING:\n      disabled = true\n      color = 'default'\n      buttonText = 'Sending...'\n      break\n    case SEND_STATES.SENT:\n      color = 'default'\n      disabled = true\n      buttonText = 'Thank you for your feedback'\n      break\n    case SEND_STATES.ERROR:\n      color = 'secondary'\n      disabled = true\n      buttonText = 'ERROR SENDING BUG REPORT'\n      break\n    default:\n      break\n  }\n\n  return (\n    <div className={classes.root}>\n      <CssBaseline />\n      <ErrorIcon className={classes.icon} color='error' />\n      <Typography variant='subtitle1' className={classes.text} color='inherit'>\n        Something went wrong\n      </Typography>\n      {error && error.message && <Typography variant='body1' className={classes.text} color='inherit'>\n        {error.message}\n      </Typography>}\n      <Button\n        className={classes.button}\n        variant='contained'\n        disabled={disabled}\n        color={color}\n        onClick={() => setDialogOpen(true)}\n      >\n        <BugReportIcon />\n        {buttonText}\n      </Button>\n      {stackEl}\n      <Dialog open={dlgOpen} onClose={() => setDialogOpen(false)} aria-labelledby='form-dialog-title'>\n        <DialogTitle id='form-dialog-title'>Report a bug</DialogTitle>\n        <DialogContent>\n          <DialogContentText>\n            What were you trying to do when the error happened?\n          </DialogContentText>\n          <TextField\n            autoFocus\n            margin='dense'\n            multiline\n            onChange={(e) => setNote(e.target.value)}\n            rowsMax='6'\n            id='note'\n            placeholder='I tried to X and then Y happened...'\n            label='Note'\n            fullWidth\n          />\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={() => setDialogOpen(false)} color='primary'>\n            Cancel\n          </Button>\n          <Button onClick={() => {\n            reportError(note)\n            setDialogOpen(false)\n          }} color='primary'>\n            Send\n          </Button>\n        </DialogActions>\n      </Dialog>\n    </div>\n  )\n}\n\nErrorScreen.propTypes = {\n  error: PropTypes.object,\n  sendState: PropTypes.string,\n  reportError: PropTypes.func.isRequired\n}\n\nexport default ErrorScreen\n","import gql from 'graphql-tag'\nimport { photoFragment, seriesFragment } from './fragments'\n\nexport const deletePhoto = gql`\nmutation deletePhoto($seriesId: ID!, $photoId: ID!) {\n  deletePhoto(seriesId: $seriesId, photoId: $photoId)\n}\n`\n\nexport const deleteSeries = gql`\nmutation deleteSeries($id: ID!) {\n  deleteSeries(id: $id)\n}\n`\n\nexport const updateSeries = gql`\nmutation updateSeries($series: UpdateSeriesInput!) {\n  updateSeries(series: $series){\n    ...seriesFragment\n  }\n}\n`\n\nexport const updatePhoto = gql`\nmutation updatePhoto($photo: UpdatePhotoInput!) {\n  updatePhoto(photo: $photo){\n    ...photoFragment\n    uploadToken\n  }\n}\n`\n\nexport const createPhoto = gql`\nmutation createPhoto($photo: NewPhotoInput!, $ext: String!) {\n  createPhoto(photo: $photo, ext: $ext) {\n    photo {\n      ...photoFragment\n      uploadToken\n    }\n    preAuth\n  }\n}\n${photoFragment}\n`\n\nexport const createSeries = gql`\nmutation createSeries($series: NewSeriesInput, $photo: NewPhotoInput!, $ext: String!) {\n  createSeries(series: $series, photo: $photo, ext: $ext) {\n    series {\n      ...seriesFragment\n      photos {\n        ...photoFragment\n      }\n    }\n    preAuth\n  }\n}\n${seriesFragment}\n${photoFragment}\n`\n\nexport const watchSeries = gql`\nmutation watch($seriesId: ID) {\n  watchSeries(seriesId: $seriesId)\n}\n`\n\nexport const unWatchSeries = gql`\nmutation unWatch($seriesId: ID) {\n  unWatchSeries(seriesId: $seriesId)\n}\n`\n\nexport const reportBug = gql`\nmutation reportBug($reportJSON: String!) {\n  reportBug(reportJSON: $reportJSON)\n}\n`\n","import React, { useState } from 'react'\n// import PropTypes from 'prop-types'\nimport { graphql } from 'react-apollo'\nimport { connect } from 'react-redux'\nimport ErrorScreen, { SEND_STATES } from '../components/misc/ErrorScreen'\nimport { reportBug } from './mutations'\n\nconst ErrorConnect = (props) => {\n  const [state, setState] = useState(SEND_STATES.UNSENT)\n  const Wrapped = withReportBugMutation(ErrorScreen)\n  return <Wrapped {...props} setState={setState} sendState={state} />\n}\n\nconst withReportBugMutation = graphql(reportBug, {\n  props: ({ mutate, ownProps: { reduxState, error, setState } }) => {\n    console.log('withReportBugMutation props', { mutate, reduxState, error })\n    if (mutate.error) setState(SEND_STATES.ERROR)\n    return {\n      reportError: (note) => {\n        setState(SEND_STATES.SENDING)\n        let reportJSON = ''\n        const errObj = { note, reduxState, error, env: process.env }\n        console.log('withReportBugMutation StartingError', errObj)\n        try {\n          reportJSON = JSON.stringify(errObj)\n        }\n        catch (e) {\n          reportJSON = error.toString()\n        }\n        console.log('withReportBugMutation got through it', reportJSON)\n        return mutate({\n          variables: { reportJSON },\n          update: (store, { data }) => {\n            console.log('withReportBugMutation update', data)\n            setState(SEND_STATES.SENT)\n          }\n        })\n      }\n    }\n  }\n})\n\n/**\n * Map our redux state and functions\n */\nconst mapStateToProps = (state, props) => {\n  const { map, home, uploader, ...other } = state\n  const newMap = map.slice(-5) // only the last 5 map states come through\n\n  return {\n    reduxState: {\n      ...other,\n      map: newMap,\n      home\n    }\n  }\n}\n\nexport default connect(\n  mapStateToProps\n)(ErrorConnect)\n","import Satellite from './Satellite.json'\n// import BasicMap from './BasicMap.json'\nimport TopoMap from './TopoMap.json'\n\nimport {\n  Satellite as SatIcon,\n  SatelliteOutlined,\n  // DirectionsCar,\n  // DirectionsCarOutlined,\n  Terrain,\n  TerrainOutlined\n} from '@material-ui/icons'\n\nexport default [\n  {\n    toolTip: 'Sat',\n    Icon: SatelliteOutlined,\n    ActiveIcon: SatIcon,\n    color: 'green',\n    style: Satellite\n  },\n  {\n    toolTip: 'Topo',\n    Icon: TerrainOutlined,\n    ActiveIcon: Terrain,\n    color: 'blue',\n    style: TopoMap\n  }\n]\n","import MapStyles from './mapStyles'\nimport {\n  green, blue, red\n} from '@material-ui/core/colors'\n\nexport const tagColors = [\n  '#418CF0', '#FCB441', '#E0400A', '#056492', '#BFBFBF', '#1A3B69', '#FFE382', '#129CDD', '#CA6B4B',\n  '#005CDB', '#F3D288', '#506381', '#F1B9A8', '#E0830A', '#7893BE'\n]\n\nexport const mapConfig = {\n  mapBoxToken: process.env.REACT_APP_MAPBOX_TOKEN,\n  styles: MapStyles\n}\n\nlet baseurl = process.env.REACT_APP_BASEURL\nlet basename = process.env.REACT_APP_BASENAME\nlet domain = process.env.REACT_APP_DOMAIN\nif (process.env.NODE_ENV && process.env.NODE_ENV === 'development') {\n  domain = 'localhost'\n  basename = ''\n}\nconsole.log('config: ', baseurl, basename)\n\nexport const home = {\n  AppStateTypes: {\n    FEED: 'feed', // Looking at the Home Feed\n    MAP: 'map', // Looking at the map\n    SEARCH: 'search', // looking at the search\n    PROFILE: 'profile', // Looking at user information\n    SERIES: 'series', // Looking at one particular series\n    QRCAPTURE: 'QRCapture', // Capture a QRCode\n    NEW_SERIES_CAMERA: 'new_series_camera', // Looking at one particular sereis\n    NEW_SERIES_LIBRARY: 'new_series_library' // Looking at one particular sereis\n  },\n  SEARCH_TABS: {\n    TAG: 'tag',\n    LOCATION: 'location',\n    USER: 'user'\n  },\n  MapModeTypes: {\n    FREE: 'free', //\n    USER: 'user', // filtered to a given user\n    TAG: 'tag' // filtered to a given tag\n  }\n}\n\nexport const federated = {\n  // oauth_config: {\n\n  // },\n  // google_client_id: process.env.REACT_APP_GOOGLE_APP_ID\n}\n\nexport const endpoints = {\n  graphql: process.env.REACT_APP_GRAPHQL\n}\n\nexport const aws = {\n  Auth: {\n    // REQUIRED - Amazon Cognito Identity Pool ID\n    // identityPoolId: process.env.REACT_APP_COGNITO_IDPOOLID, // XX-XXXX-X:XXXXXXXX-XXXX-1234-abcd-1234567890ab\n    // REQUIRED - Amazon Cognito Region\n    region: process.env.REACT_APP_AWS_REGION,\n    // OPTIONAL - Amazon Cognito User Pool ID\n    userPoolId: process.env.REACT_APP_COGNITO_USER_POOL_ID,\n    // OPTIONAL - Amazon Cognito Web Client ID (26-char alphanumeric string)\n    userPoolWebClientId: process.env.REACT_APP_COGNITO_CLIENT_ID,\n    // OPTIONAL - Enforce user authentication prior to accessing AWS resources or not\n    mandatorySignIn: true,\n    // OPTIONAL - Configuration for cookie storage\n    cookieStorage: {\n      // REQUIRED - Cookie domain (only required if cookieStorage is provided)\n      domain: `${domain}`,\n      // OPTIONAL - Cookie path\n      // path: `/${basename}`,\n      // OPTIONAL - Cookie expiration in days\n      expires: 20,\n      // OPTIONAL - Cookie secure flag\n      secure: false\n    }\n\n  }\n\n}\n\nexport const ACCESS = {\n  OPEN: {\n    label: 'Open',\n    description: 'Anyone can see and contribute photos to this series.',\n    color: green\n  },\n  PRIVATE: {\n    label: 'Private',\n    description: 'Can only be seen by you.',\n    color: red\n  },\n  PUBLIC: {\n    label: 'Public',\n    description: 'Anyone can see this series. Only the owner can add photos.',\n    color: blue\n  }\n}\n","import localforage from 'localforage'\n\nlocalforage.config({\n  storeName: 'MorPhoto', // Should be alphanumeric, with underscores.\n  description: 'image blobs'\n})\n\nexport const imgStore = localforage.createInstance({\n  name: 'imgStore'\n})\nexport const apolloStore = localforage.createInstance({\n  name: 'apolloStore'\n})\nexport const reduxStore = localforage.createInstance({\n  name: 'reduxStore'\n})\n","import { useState, useEffect } from 'react'\nimport { createHttpLink } from 'apollo-link-http'\nimport { setContext } from 'apollo-link-context'\nimport Amplify, { Auth } from 'aws-amplify'\n// import PropTypes from 'prop-types'\nimport { endpoints, aws } from '../config'\nimport { ApolloLink } from 'apollo-link'\nimport { apolloStore } from '../storage'\nimport { InMemoryCache, ApolloClient } from 'apollo-boost'\nimport { persistCache } from 'apollo-cache-persist'\n\nAmplify.configure(aws)\n\nconst LOCAL_STORAGE_TOKEN = 'apollo-token'\n\nfunction useGraphQL () {\n  const [client, setClient] = useState(null)\n  const [loaded, setLoaded] = useState(false)\n\n  useEffect(() => {\n    createApolloClient((client, loaded) => {\n      setClient(client)\n      setLoaded(loaded)\n    })\n  }, [])\n\n  return { client, loaded }\n}\n\nexport default useGraphQL\n\n/**\n * Helper function to create our Apollo Client object\n * @param {*} tokenFunc\n */\nconst getCurrentToken = async () => {\n  try {\n    const currSession = await Auth.currentSession()\n    return currSession.accessToken.jwtToken\n  }\n  catch (e) {\n    return null\n  }\n}\n\nasync function createApolloClient (onDone) {\n  // Set up our headers for authentication through graphql\n  const cache = new InMemoryCache({\n    // dataIdFromObject: ({ __typename, id }) => __typename && id ? `${__typename}::${id}`\n  })\n\n  try {\n    // See above for additional options, including other storage providers.\n    await persistCache({\n      cache,\n      storage: apolloStore\n    })\n  }\n  catch (error) {\n    console.error('Error restoring Apollo cache', error)\n    onDone(null, false)\n    return\n  }\n\n  // The auth link is just used to decorate our HTTP headers with authentication data\n  const authLink = setContext(async (_, { headers }) => {\n    const token = await getCurrentToken()\n\n    const newHeaders = {\n      ...headers,\n      authorization: token ? `Bearer ${token}` : ''\n    }\n    // on Dev machines, allow us to fake a user. This will ONLY work with a complimentary\n    // Dev graphql endpoint and singin is still required.\n\n    // This was done so we can test what the App looks like from varying perspectives\n    if (token && process.env.NODE_ENV === 'development' && process.env.REACT_APP_FAKE_USER) {\n      newHeaders.auth_user = process.env.REACT_APP_FAKE_USER\n    }\n    return { headers: newHeaders }\n  })\n\n  // HTTP link creates the network connection to our graphql host\n  const httpLink = createHttpLink({ uri: endpoints.graphql })\n  console.log('Creating Apollo Client Client', endpoints.graphql)\n\n  const apolloClient = new ApolloClient({\n    link: ApolloLink.from([authLink, httpLink]),\n    tokenName: LOCAL_STORAGE_TOKEN,\n    cache,\n    connectToDevTools: process.env.NODE_ENV === 'development'\n  })\n\n  // Now put it all together\n  onDone(apolloClient, true)\n}\n\n// Note: this method comes from isntructions here:\n// https://www.apollographql.com/docs/react/recipes/authentication.html\n// export const withApollo = compose(\n//   lifecycle({\n//     shouldComponentUpdate (nextProps) {\n//       const { authStore: { jwtToken: oldToken } } = nextProps\n//       const { authStore: { jwtToken: newToken } } = this.props\n//       if (newToken === oldToken) {\n//         return true\n//       }\n//       return true\n//     }\n//   }),\n//   withWrapClient\n// )\n","export default theme => ({\n  root: {\n  },\n  spacer: {\n    flexGrow: 1\n  },\n  forgotPassword: {\n    width: '100%',\n    textAlign: 'right'\n  },\n  switch: {\n\n  },\n  switchButton: {\n    flexGrow: 1,\n    '&:last-child': {\n      borderRadius: 0\n    },\n    '&:first-child': {\n      borderRadius: 0\n    }\n  },\n  phoneNumInner: {\n    marginTop: theme.spacing(1),\n    display: 'flex'\n    // border: '1px solid red'\n  },\n  phoneNumDropdown: {\n    margin: theme.spacing(1),\n    minWidth: 120\n  },\n  warnText: {\n    marginTop: theme.spacing(2),\n    fontStyle: 'italic'\n  },\n  noSignin: {\n    margin: theme.spacing(2, 0),\n    padding: theme.spacing(1),\n    textAlign: 'left',\n    border: `1px solid #00000022`,\n    background: `#0000000F`\n  }\n})\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport TextField from '@material-ui/core/TextField'\nimport Button from '@material-ui/core/Button'\nimport Toolbar from '@material-ui/core/Toolbar'\n// import MenuIcon from '@material-ui/core/Menu'\n// import { FederatedButtons } from 'aws-amplify-react'\nimport { makeStyles } from '@material-ui/core/styles'\nimport style from './auth.style'\nimport AuthContainer from './AuthContainer'\nimport { Typography } from '@material-ui/core'\n\nconst useStyles = makeStyles(style)\n\nconst SignIn = ({ loading,\n  handleSignup,\n  federated,\n  handleForgotPassword,\n  handleInputChange,\n  handleBeAnonymous,\n  handleSignIn, ...props }) => {\n  const classes = useStyles()\n  return (\n    <AuthContainer>\n      {/* {props.federated && (\n        <FederatedButtons {...props} />\n      )} */}\n      <TextField\n        id='username'\n        fullWidth\n        key='username'\n        name='username'\n        label='Username'\n        color='inherit'\n        autoFocus\n        className={classes.textField}\n        margin='normal'\n        onChange={handleInputChange}\n      />\n      <TextField\n        fullWidth\n        id='password'\n        label='Password'\n        color='inherit'\n        key='password'\n        name='password'\n        type='password'\n        className={classes.textField}\n        autoComplete='current-password'\n        margin='normal'\n        onChange={handleInputChange}\n      />\n      <Toolbar disableGutters>\n\n        <Button component='button' color='secondary' variant='contained' disabled={loading} onClick={handleSignup}>\n          New Account\n        </Button>\n        <div className={classes.spacer} />\n        <Button\n          className='enterAction'\n          component='button'\n          color='primary'\n          variant='contained'\n          disabled={loading}\n          onClick={handleSignIn}\n        >\n          Sign In\n        </Button>\n      </Toolbar>\n      <Button color='primary' onClick={handleForgotPassword} size='small'>\n      Forgot Password\n      </Button>\n      <div className={classes.noSignin}>\n        <Button fullWidth size='small' variant={'outlined'} onClick={handleBeAnonymous} color='inherit'>\n          Continue without logging in\n        </Button>\n        <Typography variant='caption' className={classes.warnText} color='textSecondary' component='div'>\n          You will not be able to add content and many features will be unavailable.\n        </Typography>\n      </div>\n    </AuthContainer>\n  )\n}\n\nSignIn.propTypes = {\n  loading: PropTypes.bool,\n  federated: PropTypes.object,\n  handleSignup: PropTypes.func.isRequired,\n  handleForgotPassword: PropTypes.func.isRequired,\n  handleInputChange: PropTypes.func.isRequired,\n  handleBeAnonymous: PropTypes.func.isRequired,\n  handleSignIn: PropTypes.func.isRequired\n}\n\nexport default SignIn\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport TextField from '@material-ui/core/TextField'\nimport Button from '@material-ui/core/Button'\nimport Toolbar from '@material-ui/core/Toolbar'\n// import MenuIcon from '@material-ui/core/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nimport style from './auth.style'\nimport AuthContainer from './AuthContainer'\n\nconst useStyles = makeStyles(style)\n\nconst ConfirmSignIn = ({ handleInputChange, handleBack, handleConfirm }) => {\n  const classes = useStyles()\n  return (\n    <AuthContainer>\n      <TextField\n        id='mfaCode'\n        fullWidth\n        autoFocus\n        label='MFA Code'\n        name='code'\n        className={classes.textField}\n        margin='normal'\n        onChange={handleInputChange}\n      />\n\n      <Toolbar disableGutters>\n        <Button color='secondary' variant='contained' onClick={handleBack}>\n          Back\n        </Button>\n        <div className={classes.spacer} />\n        <Button\n          className='enterAction'\n          color='primary'\n          variant='contained'\n          onClick={handleConfirm}\n        >\n          Confirm\n        </Button>\n      </Toolbar>\n    </AuthContainer>\n  )\n}\n\nConfirmSignIn.propTypes = {\n  handleInputChange: PropTypes.func.isRequired,\n  handleBack: PropTypes.func.isRequired,\n  handleConfirm: PropTypes.func.isRequired\n}\n\nexport default ConfirmSignIn\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport TextField from '@material-ui/core/TextField'\nimport Button from '@material-ui/core/Button'\nimport Typography from '@material-ui/core/Typography'\nimport Toolbar from '@material-ui/core/Toolbar'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport style from './auth.style'\nimport AuthContainer from './AuthContainer'\n\nconst useStyles = makeStyles(style)\n\nconst RequireNewPassword = ({ change, requiredAttributes, placeholders, handleInputChange }) => {\n  const classes = useStyles()\n  return (\n    <AuthContainer>\n      <Typography>A new password is required</Typography>\n      <TextField\n        id='newassword'\n        fullWidth\n        autoFocus\n        label='New Password'\n        className={classes.textField}\n        type='password'\n        autoComplete='new-password'\n        margin='normal'\n        onChange={handleInputChange}\n      />\n      {requiredAttributes\n        .map((attribute, idx) => (\n          <TextField\n            fullWidth\n            key={attribute}\n            name={attribute}\n            className={classes.textField}\n            placeholder={placeholders[idx]}\n            type='text'\n            margin='normal'\n            onChange={handleInputChange}\n          />\n        ))}\n\n      <Toolbar disableGutters>\n\n        <Button color='secondary' variant='contained'>\n          Back\n        </Button>\n        <div className={classes.spacer} />\n        <Button\n          color='primary'\n          variant='contained'\n          onClick={change}\n          className='enterAction'\n        >\n          Change\n        </Button>\n      </Toolbar>\n    </AuthContainer>\n  )\n}\n\nRequireNewPassword.propTypes = {\n  change: PropTypes.func.isRequired,\n  handleInputChange: PropTypes.func.isRequired,\n  requiredAttributes: PropTypes.array,\n  placeholders: PropTypes.array\n}\n\nexport default RequireNewPassword\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\nimport TextField from '@material-ui/core/TextField'\nimport Button from '@material-ui/core/Button'\nimport Toolbar from '@material-ui/core/Toolbar'\nimport FormControl from '@material-ui/core/FormControl'\nimport InputLabel from '@material-ui/core/InputLabel'\nimport Select from '@material-ui/core/Select'\nimport AuthContainer from './AuthContainer'\n\n// import MenuIcon from '@material-ui/core/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nimport style from './auth.style'\n// import AuthPhoneNum from './AuthPhoneNum'\nconst useStyles = makeStyles(style)\n\nconst SignUp = ({ handleInputChange, signUpFields, signUpFieldLabels, signUpFieldPlaceholders,\n  handleSignup, handleBack, countryDialCodes, defaultDialCode }) => {\n  console.log('SIGNUPPROPS', { defaultDialCode, countryDialCodes, signUpFields, signUpFieldLabels, signUpFieldPlaceholders })\n  const [selectVal, setSelectVal] = useState(defaultDialCode)\n  const classes = useStyles()\n  const handleDialCodeChange = e => {\n    handleInputChange(e)\n    setSelectVal(e.target.value)\n  }\n  return (\n    <AuthContainer>\n      {\n        signUpFields.map((field, idx) => {\n          return field.key !== 'phone_number' ? (\n            <TextField\n              fullWidth\n              autoFocus={signUpFields.findIndex(f => f.key === field.key) === 0}\n              type={field.type}\n              name={field.key}\n              key={field.key}\n              placeholder={signUpFieldPlaceholders[idx]}\n              label={signUpFieldLabels[idx]}\n              className={classes.textField}\n              margin='normal'\n              onChange={handleInputChange}\n            />\n          ) : (\n            <FormControl\n              className={classes.phoneNumDropdown}\n              fullWidth\n              key='phonenum'\n            >\n              <InputLabel htmlFor='dial_code' shrink>\n                {signUpFieldLabels[idx]}\n                {field.required ? '*' : ''}\n              </InputLabel>\n              <div className={classes.phoneNumInner}>\n                <Select\n                  value={selectVal}\n                  onChange={handleDialCodeChange}\n                  inputProps={{\n                    name: 'dial_code',\n                    id: 'dial_code'\n                  }}\n                >\n                  {countryDialCodes.map(dialCode =>\n                    <option key={dialCode} value={dialCode}>\n                      {dialCode}\n                    </option>\n                  )}\n                </Select>\n                <TextField\n                  placeholder={signUpFieldPlaceholders[idx]}\n                  type='tel'\n                  fullWidth\n                  id='phone_line_number'\n                  key='phone_line_number'\n                  name='phone_line_number'\n                  onChange={handleInputChange}\n                />\n              </div>\n            </FormControl>\n          )\n        })\n      }\n      <Toolbar disableGutters>\n        <Button color='secondary' variant='outlined' onClick={handleBack}>\n          Back\n        </Button>\n        <div className={classes.spacer} />\n        <Button\n          className='enterAction'\n          component='button'\n          color='primary'\n          variant='contained'\n          onClick={handleSignup}\n        >\n          Create Account\n        </Button>\n      </Toolbar>\n    </AuthContainer>\n  )\n}\n\nSignUp.propTypes = {\n  handleInputChange: PropTypes.func.isRequired,\n  signUpFields: PropTypes.array.isRequired,\n  signUpFieldLabels: PropTypes.array.isRequired,\n  signUpFieldPlaceholders: PropTypes.array.isRequired,\n  countryDialCodes: PropTypes.array.isRequired,\n  defaultDialCode: PropTypes.string.isRequired,\n  handleSignup: PropTypes.func.isRequired,\n  handleBack: PropTypes.func.isRequired\n}\n\nexport default SignUp\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport TextField from '@material-ui/core/TextField'\nimport Button from '@material-ui/core/Button'\nimport Link from '@material-ui/core/Link'\nimport Toolbar from '@material-ui/core/Toolbar'\n// import MenuIcon from '@material-ui/core/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nimport style from './auth.style'\nimport AuthContainer from './AuthContainer'\n\nconst useStyles = makeStyles(style)\n\nconst ConfirmSignUp = ({ handleInputChange, handleBack, handleResend, handleConfirm }) => {\n  const classes = useStyles()\n  return (\n    <AuthContainer>\n      <TextField\n        id='username'\n        fullWidth\n        autoFocus\n        name='username'\n        label='Username'\n        className={classes.textField}\n        margin='normal'\n        onChange={handleInputChange}\n      />\n      <TextField\n        id='confirmationCode'\n        fullWidth\n        name='code'\n        label='Confirmation Code'\n        className={classes.textField}\n        margin='normal'\n        onChange={handleInputChange}\n\n      />\n      <Link component='button' variant='body2' className={classes.resendCode} onClick={handleResend}>\n          Resend Code\n      </Link>\n      <Toolbar disableGutters>\n\n        <Button color='secondary' variant='outlined' onClick={handleBack}>\n          Back\n        </Button>\n        <div className={classes.spacer} />\n        <Button\n          color='primary'\n          variant='contained'\n          className='enterAction'\n          onClick={handleConfirm}\n        >\n          Sign In\n        </Button>\n      </Toolbar>\n    </AuthContainer>\n  )\n}\n\nConfirmSignUp.propTypes = {\n  handleInputChange: PropTypes.func.isRequired,\n  handleBack: PropTypes.func.isRequired,\n  handleResend: PropTypes.func.isRequired,\n  handleConfirm: PropTypes.func.isRequired\n}\n\nexport default ConfirmSignUp\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\nimport Link from '@material-ui/core/Link'\nimport TextField from '@material-ui/core/TextField'\nimport Typography from '@material-ui/core/Typography'\nimport Button from '@material-ui/core/Button'\n\nimport Toolbar from '@material-ui/core/Toolbar'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport style from './auth.style'\nimport AuthContainer from './AuthContainer'\n\nconst useStyles = makeStyles(style)\n\nconst ForgotPassword = ({ handleSubmit, handleInputChange, handleSendCode, handleBack }) => {\n  const [sent, setSent] = useState(false)\n  const classes = useStyles()\n  return (\n    <AuthContainer>\n      <Typography>Forgot Password</Typography>\n      {!sent && (\n        <TextField\n          id='username'\n          autoFocus\n          fullWidth\n          label='Username'\n          name='username'\n          className={classes.textField}\n          margin='normal'\n          onChange={handleInputChange}\n        />\n      )}\n      {sent && (\n        <TextField\n          id='changecode'\n          fullWidth\n          autoFocus\n          label='Code'\n          name='code'\n          className={classes.textField}\n          margin='normal'\n          onChange={handleInputChange}\n        />\n      )}\n      {sent && (\n        <TextField\n          id='newpassword'\n          fullWidth\n          label='New Password'\n          className={classes.textField}\n          type='password'\n          name='password'\n          autoComplete='current-password'\n          margin='normal'\n          onChange={handleInputChange}\n        />\n      )}\n      {sent && (\n        <Link component='button' variant='body2' className={classes.resendCode} onClick={handleSendCode}>\n          Resend Code\n        </Link>\n\n      )}\n      <Toolbar disableGutters>\n        <Button\n          color='secondary'\n          variant='outlined'\n          onClick={() => {\n            sent ? setSent(false) : handleBack()\n          }}\n        >\n          Back\n        </Button>\n        <div className={classes.spacer} />\n        {!sent && (\n          <Button\n            color='primary'\n            variant='contained'\n            className='enterAction'\n            onClick={() => {\n              setSent(true)\n              handleSendCode()\n            }}\n          >\n          Send Code\n          </Button>\n        )}\n        {sent && (\n          <Button\n            className='enterAction'\n            color='primary'\n            variant='contained'\n            onClick={handleSubmit}\n          >\n          Submit\n          </Button>\n        )}\n      </Toolbar>\n    </AuthContainer>\n  )\n}\n\nForgotPassword.propTypes = {\n  handleSubmit: PropTypes.func.isRequired,\n  handleInputChange: PropTypes.func.isRequired,\n  handleSendCode: PropTypes.func.isRequired,\n  handleBack: PropTypes.func.isRequired\n}\n\nexport default ForgotPassword\n","import React, { useState } from 'react'\nimport Amplify, { Auth } from 'aws-amplify'\nimport { I18n } from '@aws-amplify/core' // ConsoleLogger as Logger\nimport countryDialCodes from 'aws-amplify-react/dist/Auth/common/country-dial-codes'\nimport {\n  Authenticator,\n  SignIn as SignInOrig,\n  SignUp as SignUpOrig,\n  ConfirmSignIn as ConfirmSignInOrig,\n  ConfirmSignUp as ConfirmSignUpOrig,\n  RequireNewPassword as RequireNewPasswordOrig,\n  Loading as LoadingOrig,\n  VerifyContact as VerifyContactOrig,\n  ForgotPassword as ForgotPasswordOrig\n} from 'aws-amplify-react'\n\nimport CompSignIn from '../components/auth/SignIn'\nimport CompConfirmSignIn from '../components/auth/ConfirmSignIn'\nimport CompRequireNewPassword from '../components/auth/RequireNewPassword'\nimport CompSignUp from '../components/auth/SignUp'\nimport CompLoading from '../components/auth/Loading'\nimport CompConfirmSignUp from '../components/auth/ConfirmSignUp'\n// import CompVerifyContact from '../components/auth/VerifyContact'\nimport CompForgotPassword from '../components/auth/ForgotPassword' // or 'aws-amplify-react-native';\nimport { aws } from '../config'\n\nAmplify.configure(aws)\n\nconst defaultAuthState = { authState: 'init', authData: {}, signedIn: null }\n\nconst useAuthentication = () => {\n  const [{ authState, authData, signedIn }, setAuth] = useState(defaultAuthState)\n\n  // Set up the trinary\n  // if (authState === 'signedIn') signedIn = true\n\n  const handleAuthStateChange = (state, data) => {\n    // console.log('handleAuthStateChange', { state, data })\n    setAuth({\n      authState: state,\n      authData: data,\n      // true = signedIn, false = beAnonymous, null = showLoginScreen\n      signedIn: !state || state.length === 0\n        ? null\n        : state === 'signedIn'\n          ? true\n          : signedIn\n    })\n  }\n\n  const getCurrentToken = async () => {\n    const currSession = await Auth.currentSession()\n    console.log('here', currSession.accessToken)\n    return currSession && currSession.accessToken ? currSession.accessToken : null\n  }\n\n  const signOut = () => Auth.signOut()\n    .then(data => console.log(data))\n    .catch(err => console.log(err))\n\n  const beAnonymous = () => {\n    setAuth({ authState, authData, signedIn: false })\n  }\n\n  const authScreen = signedIn ? null\n    : <Authenticator onStateChange={handleAuthStateChange} hideDefault>\n      <SignIn handleBeAnonymous={beAnonymous} />\n      <Loading message='Loggin in' />\n      <RequireNewPassword />\n      {/* <RequireNewPasswordOrig /> */}\n      <ConfirmSignIn />\n      <ConfirmSignUp />\n      {/* <VerifyContact /> NOT READY */}\n      <VerifyContactOrig />\n      <ForgotPassword />\n      <SignUp />\n      {/* <SignUpOrig /> */}\n    </Authenticator>\n\n  let isGod = false\n  try {\n    isGod = authData.signInUserSession.idToken.payload['cognito:groups'].indexOf('GodUsers') > -1\n  }\n  catch (e) {}\n\n  return {\n    authState,\n    authData,\n    isGod,\n    signOut,\n    getCurrentToken,\n    forceSignIn: () => setAuth(defaultAuthState),\n    signedIn,\n    authScreen\n  }\n}\n\nexport default useAuthentication\n\nclass SignIn extends SignInOrig {\n  showComponent () {\n    const { loading } = this.state\n    const newProps = {\n      ...this.props,\n      loading,\n      handleForgotPassword: () => this.changeState('forgotPassword'),\n      handleSignup: () => this.changeState('signUp'),\n      handleInputChange: this.handleInputChange,\n      handleSignIn: this.signIn\n    }\n    return <CompSignIn {...newProps} />\n  }\n}\n\nclass SignUp extends SignUpOrig {\n  showComponent () {\n    const { hide } = this.props\n    if (hide && hide.includes(SignUp)) {\n      return null\n    }\n    if (this.checkCustomSignUpFields()) {\n      this.signUpFields = this.props.signUpConfig.signUpFields\n    }\n    this.sortFields()\n\n    const newProps = {\n      ...this.props,\n      countryDialCodes,\n      defaultDialCode: this.getDefaultDialCode(),\n      handleInputChange: this.handleInputChange,\n      signUpFields: this.signUpFields,\n      signUpFieldLabels: this.signUpFields.map(field => I18n.get(field.label)),\n      signUpFieldPlaceholders: this.signUpFields.map(field => I18n.get(field.placeholder)),\n      handleSignup: this.signUp,\n      handleBack: () => this.changeState('signIn')\n    }\n    return <CompSignUp {...newProps} />\n  }\n}\n\nclass ConfirmSignIn extends ConfirmSignInOrig {\n  showComponent () {\n    const newProps = {\n      ...this.props,\n      handleBack: () => this.changeState('signIn'),\n      handleInputChange: this.handleInputChange,\n      handleConfirm: this.confirm\n    }\n    return <CompConfirmSignIn {...newProps} />\n  }\n}\n\nclass ConfirmSignUp extends ConfirmSignUpOrig {\n  showComponent () {\n    const newProps = {\n      ...this.props,\n      handleBack: () => this.changeState('signIn'),\n      handleInputChange: this.handleInputChange,\n      handleConfirm: this.confirm,\n      handleResend: this.resend\n    }\n    return <CompConfirmSignUp {...newProps} />\n  }\n}\n\nclass RequireNewPassword extends RequireNewPasswordOrig {\n  showComponent () {\n    const user = this.props.authData\n    const { requiredAttributes } = user.challengeParam\n    const placeholders = Array.isArray(requiredAttributes)\n      ? requiredAttributes.map(attribute => I18n.get(convertToPlaceholder(attribute)))\n      : []\n\n    const newProps = {\n      ...this.props,\n      handleInputChange: this.handleInputChange,\n      requiredAttributes,\n      placeholders,\n      change: this.change\n    }\n    return <CompRequireNewPassword {...newProps} />\n  }\n}\n\nclass Loading extends LoadingOrig {\n  showComponent () {\n    return <CompLoading {...this.props} />\n  }\n}\n// class VerifyContact extends VerifyContactOrig {\n//   showComponent () {\n//     const user = this.props.authData\n//     if (!user) {\n//       verifyLogger.debug('no user for verify')\n//       return null\n//     }\n//     const { unverified } = user\n//     if (!unverified) {\n//       verifyLogger.debug('no unverified on user')\n//       return null\n//     }\n//     const { email, phoneNumber } = unverified\n\n//     const { authData } = this.props\n//     const newProps = {\n//       ...this.props,\n//       handleInputChange: this.handleInputChange,\n//       handleSkip: () => this.changeState('signedIn', authData),\n//       handleVerify: this.verify,\n//       handleSubmit: this.submit\n//     }\n//     return <CompVerifyContact {...newProps} />\n//   }\n// }\nclass ForgotPassword extends ForgotPasswordOrig {\n  showComponent () {\n    const newProps = {\n      ...this.props,\n      handleBack: () => this.changeState('signIn'),\n      handleInputChange: this.handleInputChange,\n      handleConfirm: this.confirm,\n      handleResend: this.send,\n      handleSubmit: this.submit,\n      handleSendCode: this.send\n    }\n    return <CompForgotPassword {...newProps} />\n  }\n}\n\n// const verifyLogger = new Logger('VerifyContact')\n\nfunction convertToPlaceholder (str) {\n  return str.split('_').map(part => part.charAt(0).toUpperCase() + part.substr(1).toLowerCase()).join(' ')\n}\n\n// const eqSpacer = '==============================================================='\n","import { useState, useEffect, useRef } from 'react'\n\nexport const useGeolocation = () => {\n  const [state, setState] = useState({\n    accuracy: null,\n    altitude: null,\n    altitudeAccuracy: null,\n    heading: null,\n    latitude: null,\n    longitude: null,\n    speed: null,\n    timestamp: Date.now()\n  })\n  const mountedRef = useRef()\n  const watchIdRef = useRef()\n  mountedRef.current = true\n\n  const onEvent = event => {\n    if (mountedRef.current) {\n      setState({\n        accuracy: event.coords.accuracy,\n        altitude: event.coords.altitude,\n        altitudeAccuracy: event.coords.altitudeAccuracy,\n        heading: event.coords.heading,\n        latitude: event.coords.latitude,\n        longitude: event.coords.longitude,\n        speed: event.coords.speed,\n        timestamp: event.timestamp\n      })\n    }\n  }\n\n  useEffect(() => {\n    navigator.geolocation.getCurrentPosition(onEvent)\n    watchIdRef.current = navigator.geolocation.watchPosition(onEvent)\n\n    return () => {\n      mountedRef.current = false\n      navigator.geolocation.clearWatch(watchIdRef.current)\n    }\n  }, [navigator.geolocation])\n\n  return state\n}\n\nexport function useDeviceOrientation () {\n  const [deviceOrientation, setDeviceOrientation] = useState({ absolute: false, alpha: null, beta: null, gamma: null })\n\n  function handleDeviceOrientation (event) {\n    setDeviceOrientation({\n      absolute: event.absolute,\n      alpha: event.alpha,\n      beta: event.beta,\n      gamma: event.gamma\n    })\n  }\n\n  useEffect(() => {\n    window.addEventListener('deviceorientation', handleDeviceOrientation, true)\n\n    return () => {\n      window.removeEventListener('deviceorientation', handleDeviceOrientation)\n    }\n  }, [])\n\n  return deviceOrientation\n}\n\nexport function playClickAudio (clickSound) {\n  let audio = new Audio('data:audio/mp3;base64,' + clickSound.base64)\n  audio.play()\n}\n\n// Detects if device is on iOS\nexport const isIos = () => {\n  return /iphone|ipad|ipod/i.test(window.navigator.userAgent || navigator.vendor || window.opera || '')\n}\n\nexport const isPhone = () => {\n  const a = (window.navigator.userAgent || navigator.vendor || window.opera || '')\n  return /(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i\n    .test(a) ||\n  /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i\n    .test(a.substr(0, 4))\n}\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Snackbar from '@material-ui/core/Snackbar'\nimport Typography from '@material-ui/core/Typography'\nimport Paper from '@material-ui/core/Paper'\nimport AppLogo from '../../icons/AppLogo'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { Button } from '@material-ui/core'\nconst useStyles = makeStyles(theme => ({\n  root: {\n\n  },\n  content: {\n\n  },\n  messageWrapper: {\n    display: 'flex'\n  },\n  logo: {\n    height: 50,\n    width: 50\n  },\n  paper: {\n    background: theme.palette.text.primary,\n    color: theme.palette.primary.contrastText,\n    border: `2px solid ${theme.palette.primary.contrastText}`,\n    boxShadow: `0 0 0 0 ${theme.palette.primary.main}`,\n    animation: '$installPulse 2s infinite',\n    padding: theme.spacing(2, 3),\n    width: '100%'\n  },\n  '@keyframes installPulse': {\n    '0%': {\n      boxShadow: `0 0 0 0px ${theme.palette.primary.main}`\n    },\n    '50%': {\n      boxShadow: `0 0 0 0px ${theme.palette.primary.main}`\n    },\n    '100%': {\n      boxShadow: `0 0 0 20px transparent`\n    }\n  },\n  textWrapper: {\n    flexGrow: 1,\n    paddingLeft: theme.spacing(1)\n  },\n  buttons: {\n    display: 'flex'\n  },\n  spacer: {\n    flexGrow: 1\n  }\n}))\n\nconst InstallPrompt = ({ open, onClose, onInstall }) => {\n  const classes = useStyles()\n\n  return (\n    <Snackbar\n      anchorOrigin={{\n        vertical: 'bottom',\n        horizontal: 'center'\n      }}\n      open={open}\n      // autoHideDuration={6000}\n      onClose={onClose}\n    >\n      <Paper className={classes.paper} elevation={24}>\n        <div id='client-snackbar' className={classes.messageWrapper}>\n          <AppLogo className={classes.logo} />\n          <div className={classes.textWrapper}>\n            <Typography variant='body1' color='inherit'>Install MorPhoto</Typography>\n            <Typography variant='body2' color='inherit' paragraph>This app can be installed and used on your device natively and offline if you would like.</Typography>\n            <div className={classes.buttons}>\n              <Button color='secondary' variant='contained' onClick={onClose}>No thanks</Button>\n              <div className={classes.spacer} />\n              <Button color='primary' variant='contained' onClick={onInstall}>Install</Button>\n            </div>\n          </div>\n        </div>\n      </Paper>\n    </Snackbar>\n  )\n}\n\nInstallPrompt.propTypes = {\n  open: PropTypes.bool,\n  onClose: PropTypes.func.isRequired,\n  onInstall: PropTypes.func.isRequired\n}\n\nexport default InstallPrompt\n","import React, { useEffect, useState, useMemo } from 'react'\nimport { isIos } from './sensors'\nimport InstallPrompt from '../components/misc/InstallPrompt'\n/**\n * Everything below here is about the prompt for installing a PWA\n */\n\n// Detects if device is in standalone mode\nconst isInStandaloneMode = () => ('standalone' in window.navigator) && (window.navigator.standalone)\n\nconst useShowAddToHome = (showInstall, dismissInstall) => {\n  const [deferredPrompt, setPrompt] = useState(null)\n\n  const handleBeforePrompt = e => {\n    // Prevent Chrome 67 and earlier from automatically showing the prompt\n    e.preventDefault()\n    // Stash the event so it can be triggered later.\n    setPrompt(e)\n    // showAddToHomeScreen()\n  }\n\n  const installPrompt = useMemo(() => {\n    if (!showInstall || !deferredPrompt) return null\n    return <InstallPrompt open onClose={dismissInstall} onInstall={addToHomeScreen} />\n  }, [showInstall, deferredPrompt])\n\n  useEffect(() => {\n    // window.orientation [0,90,180, 270]\n    // screen\n    // Checks if should display install popup notification:\n    if (isIos() && !isInStandaloneMode()) {\n      console.log('I AM on IOS and I am NOT in standalone mode.')\n    // this.setState({ showInstallMessage: true })\n    }\n\n    window.addEventListener('beforeinstallprompt', handleBeforePrompt)\n    return () => {\n      window.removeEventListener('beforeinstallprompt', handleBeforePrompt)\n    }\n  }, [])\n\n  function addToHomeScreen () {\n    // Show the prompt\n    deferredPrompt.prompt()\n    // Wait for the user to respond to the prompt\n    deferredPrompt.userChoice\n      .then((choiceResult) => {\n        if (choiceResult.outcome === 'accepted') {\n          console.log('User accepted the A2HS prompt')\n          dismissInstall()\n        }\n        else {\n          console.log('User dismissed the A2HS prompt')\n          dismissInstall()\n        }\n        setPrompt(null)\n      })\n  }\n\n  // function showAddToHomeScreen () {\n  //   const a2hsBtn = document.querySelector('.ad2hs-prompt')\n  //   a2hsBtn.style.display = 'block'\n  //   a2hsBtn.addEventListener('click', addToHomeScreen)\n  // }\n\n  return {\n    installPrompt,\n    addToHomeScreen: installPrompt ? addToHomeScreen : null\n  }\n}\n\nexport default useShowAddToHome\n","import { useEffect, useState } from 'react'\n\nconst useOnline = () => {\n  const [state, setState] = useState(null)\n\n  const setOnline = () => {\n    console.log('ONLINE')\n    setState(null)\n  }\n  const setOffline = () => {\n    console.log('OFFLINE')\n    const newDate = Date.now()\n    setState(newDate)\n  }\n\n  useEffect(() => {\n    window.addEventListener('online', setOnline)\n    window.addEventListener('offline', setOffline)\n\n    return () => {\n      window.removeEventListener('online', setOnline)\n      window.removeEventListener('offline', setOffline)\n    }\n  }, [])\n\n  return {\n    online: state === null,\n    offlineSince: state\n  }\n}\n\nexport default useOnline\n","import { useCallback, useState, useLayoutEffect } from 'react'\nimport { debounce } from './util'\nimport { isIos, isPhone } from './sensors'\n\nconst metaViewports = {\n  sm: 'width=device-width, initial-scale=0.5, maximum-scale=0.5, user-scalable=0, shrink-to-fit=no',\n  lg: 'width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no'\n}\n\nconst getState = (state) => {\n  const { orientation, innerWidth, innerHeight, screen: { width, height } } = window\n  const wOrient = [90, 270].indexOf(orientation) !== 0 ? 'portrait' : 'landscape'\n  const bIsIos = isIos()\n  const bIsPhone = isPhone()\n  const windowSize = { width: innerWidth, height: innerHeight }\n  const screenSize = { width, height }\n\n  // VirtualKeyboards are the worst because they don't tell you when they're open.\n  // as a result we put the lockheight attribute on inputs so that the window height doesn't change\n  if (state && window.document.activeElement.tagName.toLowerCase() === 'input') {\n    console.log('preserving height')\n    windowSize.height = state.windowSize.height\n  }\n  else {\n    const minSize = Math.min(windowSize.width, windowSize.height)\n    const viewport = window.document.querySelector('meta[name=viewport]')\n    const contentDict = viewport.getAttribute('content').split(', ').reduce((acc, el) => {\n      const elsplit = el.split('=')\n      return { ...acc, [elsplit[0]]: elsplit[1] }\n    }, {})\n    if (minSize < 350 && contentDict['initial-scale'] === '1.0') {\n      console.log('ZOOM Making it Small')\n      viewport.setAttribute('content', metaViewports.sm)\n    }\n    else if (minSize >= 350 && contentDict['initial-scale'] === '0.5') {\n      console.log('ZOOM Making it Large')\n      viewport.setAttribute('content', metaViewports.lg)\n    }\n  }\n\n  const returnState = {\n    isPhone: bIsPhone,\n    isIos: bIsIos,\n    orientation: wOrient,\n    windowSize,\n    screenSize\n    // This failed. the only way to handle this is to set it explicitly\n    // isVKeyBdOn: bIsPhone && windowSize.height < screenSize.height\n  }\n  return returnState\n}\n\nconst useResponsive = (mediaQueries) => {\n  const [state, setState] = useState(getState())\n\n  const handleResize = (e) => {\n    if (e) {\n      e.preventDefault()\n      e.stopPropagation()\n    }\n    const newState = getState(state)\n    console.log('handleResize', newState)\n    setState(newState)\n  }\n\n  // const handleFlip = (e) => {\n  //   e.preventDefault()\n  //   e.stopPropagation()\n  //   const newState = getState()\n  //   console.log('handleFlip', newState)\n  //   setState(newState)\n  // }\n\n  const handleResizeDebounced = useCallback(debounce(handleResize, 500), [])\n  // const handleFlipDebounced = useCallback(debounce(handleFlip, 500), [])\n\n  useLayoutEffect(() => {\n    handleResizeDebounced()\n    window.addEventListener('resize', handleResizeDebounced)\n    // window.addEventListener('orientationchange', handleFlipDebounced)\n\n    return () => {\n      window.removeEventListener('resize', handleResizeDebounced)\n      // window.removeEventListener('orientationchange', handleFlipDebounced)\n    }\n  },\n  [])\n\n  return state\n}\n\nexport default useResponsive\n","/**\n * We put our action types at the top to keep them straight\n *\n * This is just a handy enumeration we use everywhere to make sure we're\n * all talking about the same ations\n */\nexport const Actions = {\n\n  HOME_CHANGE_STATE: 'HOME_CHANGE_STATE',\n  HOME_CHANGE_ACTIVE_SERIES: 'HOME_CHANGE_ACTIVE_SERIES',\n  HOME_STATE_BACK: 'HOME_STATE_BACK',\n\n  MAP_HISTORY_POP: 'MAP_HISTORY_POP',\n  MAP_HISTORY_PUSH: 'MAP_HISTORY_PUSH',\n  MAP_HISTORY_CLEAR: 'MAP_HISTORY_CLEAR',\n\n  UPLOADER_START: 'UPLOADER_START',\n  UPLOADER_COMPLETE: 'UPLOADER_COMPLETE',\n  UPLOADER_UPDATE_PROGRESS: 'UPLOADER_UPDATE_PROGRESS',\n\n  SETFLAG: 'SETFLAG'\n}\n\n/**\n * Now here are the actual action functions we will be dispatching\n * The actions have arguments related to what they do but they action they\n * dispatch consists only of a type and data3\n */\nexport default {\n  setHomeState: (newDomain, params) => ({ type: Actions.HOME_CHANGE_STATE, data: { newDomain, params } }),\n  homeStateBack: () => ({ type: Actions.HOME_STATE_BACK }),\n  setActiveSeries: (seriesId, initialPhoto) => ({ type: Actions.HOME_CHANGE_ACTIVE_SERIES, data: { seriesId, initialPhoto } }),\n\n  setFlag: (flagName, flagVal) => ({ type: Actions.SETFLAG, data: { flagName, flagVal } }),\n\n  popMapHistory: () => ({ type: Actions.MAP_HISTORY_POP }),\n  pushMapHistory: (viewportSave) => ({ type: Actions.MAP_HISTORY_PUSH, data: viewportSave }),\n  clearMapHistory: () => ({ type: Actions.MAP_HISTORY_CLEAR }),\n\n  queueUpload: (uploadObj) => ({ type: Actions.UPLOADER_START, data: uploadObj }),\n  // startActiveUpload: () => ({ type: Actions.UPLOADER_START }),\n  completeActiveUpload: () => ({ type: Actions.UPLOADER_COMPLETE }),\n  updateUploadProgress: (newProgress) => ({ type: Actions.UPLOADER_UPDATE_PROGRESS, data: newProgress })\n\n}\n","import { Actions } from '../actions'\nimport { home } from '../../config'\nconst mapInit = [\n  {\n    mode: home.MapModeTypes.FREE,\n    // selectedItem: null\n    viewport: {\n      // 'latitude': 49.2707848, // vancouver\n      // 'longitude': -123.0714866,\n      latitude: 36.80191008366581, // Grand Canyon\n      longitude: -111.63999999999784,\n      zoom: 11\n    }\n  }\n]\n\nexport default (state = mapInit, action) => {\n  const { type, data } = action\n\n  switch (type) {\n    case Actions.MAP_HISTORY_CLEAR:\n      const newClearerHistory = state.length > 0 ? [[state.length - 1]] : []\n      return newClearerHistory\n\n    case Actions.MAP_HISTORY_POP:\n      return state.slice(0, -1)\n\n    case Actions.MAP_HISTORY_PUSH:\n      return [...state, data]\n    default:\n      return state\n  }\n}\n","import { Actions } from '../actions'\nimport { home } from '../../config'\n\nconst homeInit = {\n  history: [],\n  current: {\n    domain: home.AppStateTypes.FEED\n    // search: null // { tab, text }\n    // defaultSearchTab:\n    // defaultSearchText:\n    // activeSeries: 'fda17bae-0335-4f0d-9065-dc8d7aa23ed1',\n    // initialPhoto: 'someguid'\n  }\n}\n\nexport default (state = homeInit, action) => {\n  const { type, data } = action\n  const { history, current } = state\n\n  switch (type) {\n    case Actions.HOME_STATE_BACK:\n      const newStateHistory = [...history]\n      const newCurrentState = newStateHistory.length > 0 ? newStateHistory.pop() : homeInit.current\n      return {\n        ...state,\n        current: newCurrentState,\n        history: newStateHistory\n      }\n\n    case Actions.HOME_CHANGE_ACTIVE_SERIES:\n      const { activeSeries, initialPhoto } = current\n      return {\n        ...state,\n        history,\n        current: {\n          ...current,\n          activeSeries: activeSeries || null,\n          initialPhoto: activeSeries && initialPhoto ? initialPhoto : null\n        }\n      }\n\n    case Actions.HOME_CHANGE_STATE:\n      const { newDomain, params } = data\n      const newParams = params || {}\n      const newHistory = [...history, current]\n      return {\n        ...state,\n        history: newHistory,\n        current: {\n          ...current,\n          domain: newDomain,\n          ...newParams\n        }\n      }\n\n    default:\n      return state\n  }\n}\n","import { Actions } from '../actions'\n\nconst initState = {\n  store: [],\n  activeUpload: null\n}\n\nexport default (state = initState, action) => {\n  const { type, data } = action\n  const { store, activeUpload } = state\n\n  switch (type) {\n    case Actions.UPLOADER_START:\n      if (!activeUpload) {\n        return {\n          ...state,\n          activeUpload: data\n        }\n      }\n      else {\n        return {\n          ...state,\n          store: [...store, data]\n        }\n      }\n    case Actions.UPLOADER_COMPLETE:\n      if (store.length === 0) {\n        return {\n          ...state,\n          activeUpload: null\n        }\n      }\n      else {\n        const newStore = [...store]\n        const newActive = newStore.pop()\n        return {\n          ...state,\n          store: newStore,\n          activeUpload: newActive\n        }\n      }\n    case Actions.UPLOADER_UPDATE_PROGRESS:\n      return {\n        ...state,\n        activeUpload: { ...activeUpload, ...data }\n      }\n    default:\n      return state\n  }\n}\n","import { Actions } from '../actions'\nimport { isIos } from '../../lib/sensors'\n\nconst defaultFlags = {\n  iOSWarning: isIos(),\n  install: true,\n  useLoggedOut: false\n}\nexport default (state = defaultFlags, action) => {\n  const { type, data } = action\n\n  switch (type) {\n    case Actions.SETFLAG:\n      const { flagName, flagVal } = data\n      return { ...state, [flagName]: flagVal }\n\n    default:\n      return state\n  }\n}\n","import { combineReducers } from 'redux'\nimport map from './map'\nimport home from './home'\nimport uploader from './uploader'\nimport flags from './flags'\n\nexport default combineReducers({ map, home, uploader, flags })\n","import { createStore, applyMiddleware, compose } from 'redux'\nimport thunk from 'redux-thunk'\nimport rootReducer from './reducers'\nimport { persistStore, persistReducer } from 'redux-persist'\nimport { reduxStore } from '../storage'\n// import storage from 'redux-persist/lib/storage' // defaults to localStorage for web\n\n// import api from '../middleware/api'\n// https://github.com/reduxjs/redux/blob/master/examples/real-world/src/middleware/api.js\n\nconst persistConfig = {\n  key: 'root',\n  storage: reduxStore\n}\n\nconst persistedReducer = persistReducer(persistConfig, rootReducer)\n\n/**\n * On Dev we want our devTools available\n */\nconst configureStoreDev = preloadedState => {\n  const { devToolsEnhancer } = require('redux-devtools-extension')\n  const { createLogger } = require('redux-logger')\n  const store = createStore(\n    persistedReducer,\n    preloadedState,\n    compose(\n      devToolsEnhancer(),\n      applyMiddleware(\n        thunk,\n        createLogger()\n      )\n    )\n  )\n  if (module.hot) {\n    // Enable Webpack hot module replacement for reducers\n    module.hot.accept('./reducers', () => {\n      store.replaceReducer(rootReducer)\n    })\n  }\n  return store\n}\n\n/**\n * Production gets a simpler more performant store:\n */\nconst configureStoreProd = preloadedState => {\n  const store = createStore(\n    persistedReducer,\n    preloadedState,\n    compose(\n      applyMiddleware(\n        thunk\n      )\n    )\n  )\n  return store\n}\n\nexport default () => {\n  const store = process.env.NODE_ENV === 'production' ? configureStoreProd() : configureStoreDev()\n  return {\n    store,\n    persistor: persistStore(store)\n  }\n}\n","import React from 'react'\nimport { PersistGate } from 'redux-persist/integration/react'\nimport { Provider } from 'react-redux'\nimport storeConfig from './storeConfig'\nimport Loading from '../components/auth/Loading'\n/**\n * In this example, 'store' is the configured Redux store and\n *'persist' is a function that returns a Promise to rehydrate the\n * Redux store using redux-persist\n *\n * FROM: https://medium.com/hexient-labs/redux-store-provider-hoc-3495281905c\n */\nconst withReduxProvider = BaseComponent => (props) => {\n  const { store, persistor } = storeConfig()\n  // console.log('withReduxProvider', { props, store, persistor })\n  return (\n    <Provider store={store}>\n      <PersistGate loading={<Loading />} persistor={persistor}>\n        <BaseComponent {...props} />\n      </PersistGate>\n    </Provider>\n  )\n}\n\nexport default withReduxProvider\n","import React from 'react'\nimport classNames from 'classnames'\nimport PropTypes from 'prop-types'\nimport Paper from '@material-ui/core/Paper'\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport LinearProgress from '@material-ui/core/LinearProgress'\nimport Typography from '@material-ui/core/Typography'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n    background: 'black',\n    color: theme.palette.primary.contrastText,\n    padding: theme.spacing(1) * 2\n  },\n  message: {\n    // width: '100%'\n  },\n  msgText: {\n    display: 'flex'\n  },\n  spacer: {\n    flexGrow: 1\n  },\n  messageInner: {\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst UploadControlUnstyled = ({ className, text, progress }) => {\n  const classes = useStyles()\n  if (!text) return null\n  const message = `Uploading: ${text}`\n  return (\n    <div className={classNames(classes.root, className)}>\n      <div className={classes.messageInner}>\n        <div className={classes.msgText}>\n          <Typography color='inherit'>{message}</Typography>\n          <div className={classes.spacer} />\n          <Typography color='inherit'>{progress}%</Typography>\n        </div>\n        <LinearProgress color='secondary' variant='determinate' value={progress} />\n      </div>\n    </div>\n  )\n}\n\nUploadControlUnstyled.propTypes = {\n  className: PropTypes.string,\n  text: PropTypes.string,\n  progress: PropTypes.number\n}\n\nconst UploadControl = UploadControlUnstyled\nexport default UploadControl\n\nexport const UploadControlCOSMOSWrapper = ({ text, progress }) => {\n  // const [someStateItem, setSomeStateItem] = useState()\n  const classes = useWrapperStyles()\n  return (\n    <div className={classes.root}>\n      <CssBaseline /> {/* You only need this in a root element. Don't put it anywhere else in the dom */}\n      <Paper className={classes.paper}>\n        <Typography variant='h5'>\n          This is a dummy component.\n        </Typography>\n      </Paper>\n      <UploadControl text={text} progress={progress} />\n    </div>\n  )\n}\n\nUploadControlCOSMOSWrapper.propTypes = {\n  text: PropTypes.string,\n  progress: PropTypes.number\n}\nconst wrapperStyle = theme => ({\n  root: {\n    height: '100%',\n    display: 'flex',\n    flexDirection: 'column'\n  },\n  paper: {\n    flexGrow: 1\n  }\n})\n\nconst useWrapperStyles = makeStyles(wrapperStyle)\n\nUploadControlCOSMOSWrapper.displayName = UploadControl.displayName\nexport const UploadControlTest = UploadControlCOSMOSWrapper\n","import axios from 'axios'\nimport FormData from 'form-data'\nimport { imgStore } from '../storage'\n// import { getExtFromBlob } from '../lib/Photo'\n/**\n * DEbuggers for AXIOS\n */\naxios.interceptors.request.use(\n  request => {\n    console.log('AXIOS:::: Starting Request', request)\n    return request\n  },\n  err => {\n    console.log('AXIOS:::: Starting Request ERROR', err)\n    return Promise.reject(err)\n  }\n)\n\naxios.interceptors.response.use(\n  response => {\n    console.log('AXIOS:::: Response', response)\n    return response\n  },\n  err => {\n    console.log('AXIOS:::: Starting Response ERROR', err)\n    return Promise.reject(err)\n  }\n)\n\nexport default async function doUpload (activeUpload, updateUploadProgress, completeActiveUpload) {\n  console.log('UploadConntect: upload start', activeUpload)\n\n  // Initialising the HTML POST form for posting to S3 directly\n  let formData = new FormData()\n  // Take the auth credentials that we got from the backend and add them to our S3 POST\n  Object.keys(activeUpload.preAuth.fields).forEach(fieldkey => {\n    console.log('APPEND', fieldkey, activeUpload.preAuth.fields[fieldkey])\n    formData.append(fieldkey, activeUpload.preAuth.fields[fieldkey])\n  })\n  const file = imgStore.getItem(activeUpload.uploadToken)\n  formData.append('file', file)\n\n  const config = {\n    headers: {\n      'Content-Type': 'multipart/form-data'\n    },\n    onUploadProgress: progressEvent => {\n      const { loaded, total } = progressEvent\n      // Do something with the progress details\n      console.log('PROGRESSEVENT', loaded, total, Math.floor(100 * loaded / total))\n      updateUploadProgress({ progress: Math.floor(100 * loaded / total) })\n    }\n  }\n\n  console.log('FORMDATA', formData)\n  // Upload file to S3\n  await axios.post(\n    activeUpload.preAuth.url,\n    formData,\n    config\n  ).catch(err => {\n    console.error(err)\n    console.log(err.stack)\n  })\n  console.log('UploadConntect: upload done')\n  completeActiveUpload()\n}\n\n// export function dataURLtoFile (dataurl, filename) {\n//   var arr = dataurl.split(','); var mime = arr[0].match(/:(.*?);/)[1]\n\n//   var bstr = atob(arr[1]); var n = bstr.length; var u8arr = new Uint8Array(n)\n//   while (n--) {\n//     u8arr[n] = bstr.charCodeAt(n)\n//   }\n//   return new File([u8arr], filename, { type: mime })\n// }\n","import React, { useRef, useEffect } from 'react'\nimport PropTypes from 'prop-types'\nimport { connect } from 'react-redux'\nimport actions from '../redux/actions'\nimport UploadControl from '../components/UploadControl'\nimport s3Upload from '../lib/s3upload'\n\nconst UploadConntect = ({\n  activeUpload,\n  completeActiveUpload,\n  updateUploadProgress,\n  ...props\n}) => {\n  const uploadingRef = useRef()\n  useEffect(() => {\n    uploadingRef.current = uploadingRef.current && !!activeUpload\n\n    if (activeUpload && !uploadingRef.current) {\n      s3Upload(activeUpload, updateUploadProgress, completeActiveUpload)\n    }\n  }, [Boolean(activeUpload)])\n\n  if (!activeUpload) return null\n  return <UploadControl text={'Uploading thing'} progress={activeUpload.progress || 0} {...props} />\n}\nUploadConntect.propTypes = {\n  // All from redux\n  activeUpload: PropTypes.object,\n  completeActiveUpload: PropTypes.func.isRequired,\n  updateUploadProgress: PropTypes.func.isRequired\n}\n\n/**\n * Map our redux state and functions\n */\nconst mapStateToProps = (state, props) => {\n  const { activeUpload } = state.uploader\n  return { activeUpload }\n}\n\nconst mapDispatchToProps = dispatch => ({\n  completeActiveUpload: () => {\n    dispatch(actions.completeActiveUpload())\n  },\n  updateUploadProgress: (newProgress) => {\n    dispatch(actions.updateUploadProgress(newProgress))\n  }\n})\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(UploadConntect)\n","/**\n * Valid Roles are: admin, user, nonuser\n *\n * Valid Resources are: series, series_public, series_open, photo\n *\n * For more see:\n * https://docs.google.com/spreadsheets/d/1oXsZrsuyOSFs_tufRluSjQiR6OSTObWiGsKDUKb5vLk/edit#gid=0\n *\n * RTFM:\n * https://onury.io/accesscontrol/?content=guide#resources-and-resource-attributes\n */\nexport default {\n  // Admin is god. Be careful who you give this to.\n  admin: {\n    series: {\n      'create:own': ['*'],\n      'read:any': ['*'],\n      'update:any': ['*'],\n      'delete:any': ['*']\n    },\n    photo: {\n      'create:any': ['*'],\n      'read:any': ['*'],\n      'update:any': ['*'],\n      'delete:any': ['*']\n    }\n  },\n  // Logged out users can see public stuff but nothing esle\n  nonuser: {\n    photo: {\n      'read:any': ['*'],\n      'update:any': ['*'],\n      'delete:any': ['*']\n    },\n    series_public: {\n      'read:any': ['*']\n    },\n    series_open: {\n      'read:any': ['*']\n    }\n  },\n  // Users are the key permissions role in V0\n  // Note: we could inherit from user but we keep it explicit for now\n  user: {\n    series: {\n      'create:own': ['*'],\n      'read:own': ['*'],\n      'update:own': ['*'],\n      'delete:own': ['*']\n    },\n    series_public: {\n      'read:any': ['*']\n    },\n    series_open: {\n      'read:any': ['*'],\n      'update:any': ['photos']\n    },\n    photo: {\n      'read:any': ['*'],\n      'create:own': ['*'],\n      'update:own': ['*'],\n      'delete:own': ['*']\n    }\n  }\n}\n","import React from 'react'\n\nexport const SeriesContext = React.createContext({})\n","import React, { useState, useLayoutEffect, useContext } from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport Dialog from '@material-ui/core/Dialog'\n// import MenuIcon from '@material-ui/icons/Menu'\nimport QRCode from 'qrcode'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { Paper } from '@material-ui/core'\nimport { SeriesContext } from '../contexts'\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n  },\n  title: {\n    textAlign: 'center'\n  },\n  qrPaper: {\n    padding: theme.spacing(2)\n  },\n  qrCode: {\n    width: '100%',\n    height: 400\n  }\n}))\n\nconst QRDisplay = ({ onClose, open }) => {\n  const classes = useStyles()\n  const { series } = useContext(SeriesContext)\n  const [qrCodeEl, setQRCodeEl] = useState(null)\n  const obj = { type: 'series', id: series.id }\n  const encodedId = encodeURI(JSON.stringify(obj))\n  const url = `${process.env.PUBLIC_URL}/?fromqr=${encodedId}`\n\n  useLayoutEffect(() => {\n    QRCode.toString(url, (err, svgStr) => {\n      if (err) console.error(err)\n      else setQRCodeEl(svgStr)\n    })\n  }, [series])\n\n  return (\n    <Dialog\n      open={open}\n      onClose={onClose}\n      className={classes.root\n      }>\n      <Paper className={classes.qrPaper}>\n        <Typography variant='subtitle1' component='div' className={classes.title}>{series.name}</Typography>\n        <svg className={classes.qrCode} dangerouslySetInnerHTML={{ __html: qrCodeEl }} />\n        {series.coords && <Typography component='div' className={classes.title}>[ {series.coords[0]}, {series.coords[1]} ]</Typography>}\n      </Paper>\n    </Dialog>\n  )\n}\n\nQRDisplay.propTypes = {\n  onClose: PropTypes.func.isRequired,\n  open: PropTypes.bool\n}\n\nexport default QRDisplay\n","import React from 'react'\nimport createSvgIcon from '@material-ui/icons/utils/createSvgIcon'\n\nexport default createSvgIcon(\n  <React.Fragment>\n    <path d='M22,2l0,20l-20,0l0,-20l20,0Zm-2,2l-16,0l0,16l16,0l0,-16Z' />\n    <rect x='5' y='5' width='4' height='4' />\n    <rect x='15' y='5' width='4' height='4' />\n    <rect x='5' y='15' width='4' height='4' />\n    <rect x='10' y='10' width='1' height='5' />\n    <rect x='11' y='10' width='6' height='2' />\n    <rect x='11' y='12' width='2' height='2' />\n    <rect x='13' y='7' width='1' height='2' />\n    <rect x='14' y='9' width='1' height='1' />\n    <rect x='8' y='10' width='1' height='4' />\n    <rect x='7' y='11' width='1' height='3' />\n    <rect x='9' y='11' width='1' height='1' />\n    <rect x='10' y='6' width='2' height='3' />\n    <rect x='12' y='7' width='1' height='1' />\n    <rect x='15' y='14' width='2' height='4' />\n    <rect x='14' y='14' width='1' height='1' />\n    <rect x='17' y='15' width='2' height='2' />\n    <rect x='11' y='16' width='1' height='3' />\n    <rect x='12' y='15' width='2' height='2' />\n    <rect x='10' y='18' width='1' height='1' />\n  </React.Fragment>, 'QRCode')\n","import { useCallback, useState, useLayoutEffect, useRef } from 'react'\nimport { debounce } from './util'\n\nconst getSize = (el, minSize, defaultSize) => {\n  if (!el) return defaultSize || minSize || { width: 0, height: 0 }\n\n  if (minSize) {\n    return {\n      width: Math.max(minSize.width, el.offsetWidth),\n      height: Math.max(minSize.height, el.offsetHeight)\n    }\n  }\n  else {\n    return {\n      width: el.offsetWidth,\n      height: el.offsetHeight\n    }\n  }\n}\n\nconst useComponentSize = (ref, minSize, defaultSize) => {\n  const resizeActiveRef = useRef()\n  const [resizeActive, setResizeActive] = useState(true)\n\n  resizeActiveRef.current = resizeActive\n  const [size, setComponentSize] = useState(\n    getSize(ref ? ref.current : null, minSize, defaultSize)\n  )\n\n  const handleResize = () => {\n    if (!resizeActiveRef.current || !ref.current) return\n    const newSize = getSize(ref.current, minSize, defaultSize)\n    if (newSize.height !== size.height || newSize.width !== size.width) {\n      // console.log('handleResize Called', { newSize, size })\n      setComponentSize(newSize)\n    }\n  }\n\n  const handleResizeDebounced = useCallback(\n    debounce(handleResize, 500),\n    []\n  )\n\n  useLayoutEffect(() => {\n    if (!ref.current) return\n    handleResize()\n\n    if (typeof ResizeObserver === 'function') {\n      let resizeObserver = new ResizeObserver(handleResizeDebounced)\n      resizeObserver.observe(ref.current)\n\n      return () => {\n        resizeObserver.disconnect(ref.current)\n        resizeObserver = null\n      }\n    }\n    else {\n      window.addEventListener('resize', handleResizeDebounced)\n\n      return () => {\n        window.removeEventListener('resize', handleResizeDebounced)\n      }\n    }\n  },\n  [ref.current])\n\n  return { size, setResizeActive }\n}\n\nexport default useComponentSize\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n    width: 1,\n    height: 1,\n    zIndex: 1\n  },\n  svgDot: {\n    width: 20,\n    height: 20,\n    position: 'absolute',\n    top: '50%',\n    left: '50%',\n    textAlign: 'center',\n    transformOrigin: '50% 50%',\n    transform: 'translateY(-50%) translateX(-50%)'\n  },\n  svgAccuracyDot: {\n    position: 'absolute',\n    top: '50%',\n    left: '50%',\n    textAlign: 'center',\n    transformOrigin: '50% 50%',\n    transform: 'translateY(-50%) translateX(-50%)'\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst MyLocation = ({ position, projection }) => {\n  const classes = useStyles()\n  const accuracy = 20 // assume 20m to start\n  // metersPerPixel [12, 12, 12]\n  // pixelsPerMeter [0: 0.08029229250399847, 1: -0.08029229250399847, 2: 0.08029229250399847]\n  // console.log('POSITION', { position, projection })\n  const accHeight = projection.pixelsPerMeter[0] * (accuracy)\n  const accWidth = projection.pixelsPerMeter[1] * (accuracy)\n  return (\n    <div className={classes.root}>\n      {/* This is the accuracy radius */}\n      <svg\n        style={{ height: accHeight, width: accWidth }}\n        className={classes.svgAccuracyDot}\n        version='1.1'\n        viewBox='0, 0, 100, 100'\n      >\n        <circle cx='50' cy='50' r={49}\n          stroke='#8888FF'\n          fillOpacity='0.4'\n          strokeWidth='1'\n          fill='#AAAAFF'\n        />\n      </svg>\n      {/* This is the dot */}\n      <svg className={classes.svgDot} version='1.1' viewBox='0, 0, 10, 10'>\n        <circle cx='5' cy='5' r='4'\n          stroke='#FFFFFF'\n          strokeWidth='1'\n          fill='#4444FF'\n        />\n      </svg>\n    </div>\n  )\n}\n\nMyLocation.propTypes = {\n  position: PropTypes.object,\n  projection: PropTypes.object\n}\n\nexport default MyLocation\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\nimport SpeedDial from '@material-ui/lab/SpeedDial'\nimport SpeedDialAction from '@material-ui/lab/SpeedDialAction'\n// import MapLayersIcon from '@material-ui/icons/Layers'\nimport { makeStyles, useTheme } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n    zIndex: 10,\n    position: 'absolute'\n  },\n  speedDialFab: {\n    border: '2px solid',\n    background: theme.palette.text.primary,\n    color: theme.palette.primary.contrastText,\n    width: 40,\n    height: 40\n  },\n  speedDialAction: {\n    border: '2px solid',\n    background: theme.palette.primary.main,\n    color: theme.palette.primary.contrastText,\n    marginTop: 0,\n    marginBottom: 0\n  },\n  speedDialIcon: {\n    // border: '1px solid red'\n  },\n  speedDialLabel: {\n    background: 'black',\n    color: 'white'\n  },\n  actionsClosed: {\n    display: 'none'\n  }\n})\n\nconst useStyles = makeStyles(style)\n\nconst StyleButtons = ({ controlPadding, currStyle, mapStyles, setCurrStyle }) => {\n  const [open, setOpen] = useState(false)\n  const classes = useStyles()\n  const theme = useTheme()\n  const noEventSetOpen = (e, state) => {\n    console.log('noEventSetOpen', e, state)\n    e.preventDefault()\n    e.stopPropagation()\n    setOpen(state)\n  }\n\n  if (!mapStyles || !Array.isArray(mapStyles) || mapStyles.length < 2 || !mapStyles[currStyle]) return null\n\n  const currStyleObj = mapStyles[currStyle]\n  const ActiveIcon = currStyleObj.ActiveIcon\n\n  return (\n    <div className={classes.root} style={{\n      top: controlPadding.top ? controlPadding.top : theme.spacing(2),\n      right: controlPadding.right ? controlPadding.right : theme.spacing(2)\n    }}>\n      {mapStyles.length > 1 && (\n        <SpeedDial\n          ariaLabel='SpeedDial example'\n          className={classes.speedDial}\n          classes={{\n            fab: classes.speedDialFab,\n            actionsClosed: classes.actionsClosed\n          }}\n          icon={<ActiveIcon className={classes.icon} />}\n          // onBlur={(e) => noEventSetOpen(e, false)}\n          onClick={(e) => noEventSetOpen(e, !open)}\n          onClose={(e) => noEventSetOpen(e, false)}\n          // onFocus={(e) => noEventSetOpen(e, true)}\n          // onMouseEnter={(e) => noEventSetOpen(e, true)}\n          // onMouseLeave={(e) => noEventSetOpen(e, false)}\n          open={open}\n          direction='left'\n        >\n\n          {mapStyles.map(({ Icon, ActiveIcon, toolTip }, idx) => (\n            <SpeedDialAction\n              key={`stylebutton${idx}`}\n              // Bit of a hack here. This function isn't quite ready for primetime\n              icon={<Icon className={classes.speedDialIcon} />}\n              tooltipPlacement='bottom'\n              ButtonProps={{\n                classes: {\n                  root: classes.speedDialAction\n                }\n              }}\n              TooltipClasses={{\n                tooltip: classes.speedDialLabel\n              }}\n              tooltipTitle={toolTip}\n              tooltipOpen\n              onClick={() => {\n                console.log('SET', idx)\n                setCurrStyle(idx)\n                setOpen(false)\n              }}\n            />\n          ))}\n\n        </SpeedDial>\n      ) }\n    </div>\n  )\n}\n\nStyleButtons.propTypes = {\n  // controlPadding: {top, right, bottom, left}\n  controlPadding: PropTypes.object,\n  currStyle: PropTypes.number,\n  mapStyles: PropTypes.array,\n  setCurrStyle: PropTypes.func\n}\nStyleButtons.defaultProps = {\n  controlPadding: {}\n}\n\nexport default StyleButtons\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Fab from '@material-ui/core/Fab'\nimport MyLocationIcon from '@material-ui/icons/MyLocation'\n\nimport { makeStyles, useTheme } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n    border: '1px solid',\n    background: theme.palette.grey[100],\n    color: 'black',\n    width: 40,\n    height: 40,\n    zIndex: 10,\n    position: 'absolute'\n    // margin: theme.spacing(0.5),\n    // padding: theme.spacing(0.5),\n    // border: '2px solid',\n    // borderRadius: theme.spacing(1),\n    // background: theme.palette.common.white,\n    // fontSize: 20,\n    // position: 'absolute',\n    // zIndex: 100,\n    // bottom: theme.spacing(10),\n    // right: theme.spacing(2)\n  }\n})\n\nconst useStyles = makeStyles(style)\n\nconst MyLocationButton = ({ onClick, controlPadding, disabled }) => {\n  const classes = useStyles()\n  const theme = useTheme()\n  return (\n    <Fab\n      disabled={disabled}\n      style={{\n        top: 56 + (controlPadding.top ? controlPadding.top : theme.spacing(2)),\n        right: controlPadding.right ? controlPadding.right : theme.spacing(2)\n      }}\n      aria-label='myLocation'\n      className={classes.root}\n      onClick={onClick}\n    >\n      <MyLocationIcon />\n    </Fab>\n  )\n}\n\nMyLocationButton.propTypes = {\n  controlPadding: PropTypes.object,\n  onClick: PropTypes.func.isRequired,\n  disabled: PropTypes.bool\n}\n\nexport default MyLocationButton\n","import React, { useState, useRef, useMemo, useEffect } from 'react'\nimport ReactMapGL, { NavigationControl, Marker, FlyToInterpolator } from 'react-map-gl'\nimport PropTypes from 'prop-types'\nimport { easeCubic } from 'd3-ease'\nimport WebMercatorViewport, { getDistanceScales } from 'viewport-mercator-project'\nimport useComponentSize from '../../lib/useComponentSize'\nimport MyLocation from './markers/MyLocation'\nimport { useGeolocation } from '../../lib/sensors'\n// import { debounce } from '../../lib/util'\nimport StyleButtons from './controls/StyleButtons'\nimport MyLocationButton from './controls/MyLocationButton'\nimport { mapConfig } from '../../config'\nimport classNames from 'classnames'\nimport 'mapbox-gl/dist/mapbox-gl.css'\nimport './BaseMap.css'\n\n/**\n * Note that this component technically has state but it is designed to be functionally stateless\n */\nconst BaseMap = (props) => {\n  // pull what we need out of the props\n  const {\n    showMe,\n    children,\n    mapStyles,\n    controlPadding,\n    viewport: initViewport,\n    bounds,\n    lockToBounds,\n    lockPan,\n    initStyle,\n    onViewportChange: incomingOnViewportChange,\n    onTransitionStart: incomingOnTransitionStart,\n    onTransitionEnd: incomingOnTransitionEnd,\n    transitions,\n    onMapDataEvent,\n    stylechooser,\n    ...passthroughProps\n  } = props\n\n  const mapContainerRef = useRef(null)\n  const mapBoxRef = useRef(null)\n  const innerTransitionsRef = useRef(null)\n\n  const { size } = useComponentSize(mapContainerRef)\n\n  const [currStyle, setCurrStyle] = useState(initStyle)\n\n  // This is the truth of the viewport!!\n  const [viewport, setViewport] = useState({ ...defaultViewVals, ...initViewport })\n  const [isTransitioning, setIsTransitioning] = useState(false)\n  const [projection, setProjection] = useState(null)\n\n  let myPosition = {}\n  if (showMe) {\n    myPosition = useGeolocation()\n  }\n  const geoMarker = (myPosition.latitude && myPosition.longitude)\n    ? (\n      <Marker key='myPos' className='myPosMarker' latitude={myPosition.latitude} longitude={myPosition.longitude} style={{ zIndex: 1 }}>\n        <MyLocation position={myPosition} projection={projection} />\n      </Marker>\n    ) : null\n\n  // Recalculate the projection if we need to but only when zoom changes\n  useMemo(() => {\n    if (!size || size.width < 10 || size.height < 10) return\n    if (mapStyles.length <= currStyle) setCurrStyle(initStyle)\n    try {\n      const projection = getDistanceScales(viewport)\n      // console.log('recalcProjection', { projection, size })\n      setProjection(projection)\n    }\n    catch (e) {\n      console.log('ERROR', viewport)\n      console.error(e)\n    }\n  }, [viewport.zoom, size])\n\n  const flyToMe = () => {\n    if (!myPosition.latitude || !myPosition.longitude) return\n    const transitionTime = 2000\n    innerTransitionsRef.current = {\n      transitionDuration: transitionTime,\n      transitionInterpolator: new FlyToInterpolator(),\n      transitionEasing: easeCubic\n    }\n    // You get `transitionTime` ms to figure this out. then we just jump\n    setTimeout(() => {\n      if (innerTransitionsRef.current) innerTransitionsRef.current = null\n    }, transitionTime)\n    setViewport({\n      ...viewport,\n      latitude: myPosition.latitude,\n      longitude: myPosition.longitude,\n      zoom: viewport.zoom > 10 ? viewport.zoom : 12\n    })\n  }\n\n  /**\n   * Callback fired when the user changes the viewport object\n   * @param {*} viewport\n   */\n  const onViewportChange = (viewportChange) => {\n    const newViewport = { ...viewportChange }\n    // Here we set/reset the bounds\n    if (bounds && lockToBounds) {\n      if (newViewport.longitude < bounds[0]) newViewport.longitude = bounds[0]\n      else if (newViewport.longitude > bounds[2]) newViewport.longitude = bounds[2]\n\n      if (newViewport.latitude < bounds[1]) newViewport.latitude = bounds[1]\n      else if (newViewport.latitude > bounds[3]) newViewport.latitude = bounds[3]\n    }\n    if (lockPan) {\n      newViewport.latitude = viewport.latitude\n      newViewport.longitude = viewport.longitude\n    }\n\n    // console.log('onViewportChange', newViewport)\n    // Fire the external callback so parent components can track viewport if they need to\n    if (!isTransitioning && typeof incomingOnViewportChange === 'function') {\n      incomingOnViewportChange({\n        viewport: newViewport,\n        size,\n        projection,\n        map: mapBoxRef.current && mapBoxRef.current.getMap()\n      })\n    }\n    setViewport(newViewport)\n  }\n\n  const recalcZoomBounds = () => {\n    // console.log('Should I recalc viewbounds?')\n    if (!bounds || !size || size.width < 10 || size.height < 10 || isTransitioning) return\n    // On the first run we're going to try to center the bounds.\n    const [minlng, minlat, maxlng, maxlat] = bounds\n    try {\n      console.log('recalcZoomBounds')\n      const { longitude, latitude, zoom } = new WebMercatorViewport({ ...size, ...viewport }).fitBounds(\n        [ [minlng, minlat], [maxlng, maxlat] ],\n        { padding: 40, offset: [0, 0] }\n      )\n      console.log('Changing Zoom ', bounds, viewport.zoom, zoom, viewport)\n\n      // console.log('recalcZoomBounds')\n      setViewport({ ...viewport, longitude, latitude, zoom })\n    }\n    catch (e) {\n      // Sometimes we don't have a valid bound. Don't make a big deal out of it.\n      console.error(e)\n    }\n  }\n\n  const handleTransitionStart = () => {\n    console.log('handleTransitionStart (internal)')\n    setIsTransitioning(true)\n    if (typeof incomingOnTransitionStart === 'function') incomingOnTransitionStart()\n  }\n\n  const handleTransitionEnd = () => {\n    console.log('handleTransitionEnd (internal)')\n    setIsTransitioning(false)\n    innerTransitionsRef.current = null\n    if (incomingOnTransitionEnd) incomingOnTransitionEnd()\n    if (typeof incomingOnViewportChange === 'function') {\n      incomingOnViewportChange({\n        viewport,\n        size,\n        projection,\n        map: mapBoxRef.current && mapBoxRef.current.getMap()\n      })\n    }\n  }\n\n  // RecalcZoombounds should only be done sparingly\n  useMemo(recalcZoomBounds, [size, bounds])\n\n  useEffect(() => {\n    setViewport({ ...viewport, ...initViewport })\n  }\n  , [initViewport])\n\n  return (\n    <div className={classNames('mapContainer', props.className)} ref={mapContainerRef}>\n      {size.height > 0 && size.width > 0 && (\n        <ReactMapGL\n          {...viewport}\n          {...(innerTransitionsRef.current || transitions)}\n          ref={map => {\n            mapBoxRef.current = map\n          }}\n          height={size.height}\n          width={size.width}\n          mapStyle={currStyle < mapStyles.length ? mapStyles[currStyle].style : mapStyles[0].style}\n          onData={onMapDataEvent}\n          onTransitionStart={handleTransitionStart}\n          onTransitionEnd={handleTransitionEnd}\n          dragPan={!lockPan}\n          onViewportChange={onViewportChange}\n          mapboxApiAccessToken={mapConfig.mapBoxToken}\n          {...passthroughProps}\n        >\n          {\n            children && Array.isArray(children)\n              ? children.map((c, idx) => c ? React.cloneElement(\n                handleChild(c, viewport, size.height, size.width, projection),\n                { key: `mapChild-${idx}` }\n              ) : null)\n              : handleChild(children, viewport, size.height, size.width, projection)\n          }\n          {/* Make sure the controls are above everything else */}\n          { stylechooser && (\n            <StyleButtons\n              controlPadding={controlPadding}\n              currStyle={currStyle}\n              mapStyles={mapStyles}\n              setCurrStyle={setCurrStyle}\n            />\n          )}\n          {/* Augment children with some props they need to survive in this harsh world */}\n          { !props.hideNavControls && (\n            <NavigationControl\n              onViewportChange={viewport => onViewportChange({ ...viewport, ...size })}\n              showZoom={!props.touchZoom === false && !props.scrollZoom === false}\n              showCompass={!props.touchRotate === false && !props.dragRotate === false}\n            />\n          )}\n          {showMe && !lockPan && (\n            <React.Fragment>\n              {geoMarker}\n              <MyLocationButton disabled={!myPosition || !myPosition.latitude} controlPadding={controlPadding} onClick={flyToMe} />\n            </React.Fragment>\n          )}\n        </ReactMapGL>\n      )}\n    </div>\n  )\n}\n\nBaseMap.propTypes = {\n  // Anything else we want to add to the map\n  children: PropTypes.any,\n  data: PropTypes.array,\n  // Maybe we want map controls to be padded\n  controlPadding: PropTypes.object,\n\n  showMe: PropTypes.bool,\n\n  // Separate transitions from viewport so we can set them independently\n  transitions: PropTypes.object,\n  initStyle: PropTypes.number,\n\n  // Some switches to make things easier\n  stylechooser: PropTypes.bool,\n  lockPan: PropTypes.bool,\n  lockRotation: PropTypes.bool,\n  lockZoom: PropTypes.bool,\n  lockToBounds: PropTypes.bool,\n  hideNavControls: PropTypes.bool,\n\n  // bounds of the map. may be locked or not [minlng, minlat], [maxlng, maxlat]\n  bounds: PropTypes.array,\n\n  // List of valid styles that will get picker buttons\n  mapStyles: PropTypes.array,\n\n  onMapDataEvent: PropTypes.func,\n  onViewportChange: PropTypes.func\n}\n\nBaseMap.defaultProps = {\n  controlPadding: {},\n  stylechooser: true,\n  initStyle: 0,\n  mapStyles: mapConfig.styles,\n  lockToBounds: false\n}\n\nexport default BaseMap\n\nconst defaultViewVals = {\n  latitude: 49.3050394,\n  longitude: -123.1398254,\n  bearing: 0,\n  pitch: 0,\n  zoom: 12\n}\n\nfunction handleChild (child, viewport, height, width, projection) {\n  return typeof child === 'function'\n    ? child(viewport, height, width, projection)\n    : child\n}\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n    color: theme.palette.primary.main,\n    position: 'absolute',\n    top: '50%',\n    left: '50%',\n    textAlign: 'center',\n    transformOrigin: '50% 50%',\n    transform: 'translateY(-50%) translateX(-50%)',\n    zIndex: 1\n  },\n  rootActive: {\n    zIndex: 1000\n  },\n  svgDot: {\n    zIndex: 102,\n    width: 20,\n    height: 20,\n    position: 'absolute',\n    top: '50%',\n    left: '50%',\n    textAlign: 'center',\n    transformOrigin: '50% 50%',\n    transform: 'translateY(-50%) translateX(-50%)'\n  },\n  dot: {\n    stroke: theme.palette.secondary.contrastText,\n    strokeWidth: '1',\n    fill: theme.palette.secondary.main\n  },\n  directionIndicator: {\n    position: 'absolute',\n    left: '50%',\n    // transformOrigin: '50% 50%',\n    // transform: 'translateY(-50%) translateX(-50%)',\n    zIndex: 100\n  },\n  name: {\n    color: 'white',\n    fontWeight: 'bold',\n    textShadow: `\n        0px 0px 4px #000000, \n        0px 0px 4px #000000 \n    `,\n    zIndex: 122,\n    position: 'relative'\n    // textStroke: '1px white'\n  },\n  nameActive: {\n    color: theme.palette.secondary.dark,\n    textShadow: `\n    0px 0px 2px #FFFFFF, \n    0px 0px 2px #FFFFFF,\n    0px 0px 4px #FFFFFF \n`\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst Single = ({ direction }) => {\n  const classes = useStyles()\n  return (\n    <div className={classes.root}>\n      <svg className={classes.svgDot} version='1.1' viewBox='0, 0, 10, 10' >\n        <circle cx='5' cy='5' r='4' className={classes.dot} />\n      </svg>\n      {direction && direction >= 0 ? (\n        <div className={classes.directionIndicator}>\n          <svg className={classes.svgArc}\n            version='1.1'\n            width='100'\n            height='100'\n            viewBox='0, 0, 100, 100'\n            style={{ transform: `translateY(-50%) translateX(-50%) rotateZ(${direction}deg)` }}>\n            <path d='M50,0 C60.946,0.151 72.136,3.514 80.675,10.56 L50,50 L19.325,10.56 C27.938,3.461 39,0.278 50,0 z'\n              fill='#009DC1'\n              fillOpacity='0.444'\n              strokeWidth='0.5'\n              strokeOpacity='0.6'\n              stroke='#FFFFFF'\n            />\n          </svg>\n        </div>\n      ) : null}\n    </div>\n  )\n}\n\nSingle.propTypes = {\n  direction: PropTypes.number\n}\n\nexport default Single\n","import React, { useState, useRef, useMemo } from 'react'\nimport { StaticMap } from 'react-map-gl'\nimport PropTypes from 'prop-types'\nimport { getDistanceScales } from 'viewport-mercator-project'\nimport useComponentSize from '../../lib/useComponentSize'\nimport StyleButtons from './controls/StyleButtons'\nimport { mapConfig } from '../../config'\nimport classNames from 'classnames'\nimport 'mapbox-gl/dist/mapbox-gl.css'\nimport './BaseMap.css'\n\n/**\n * Note that this component technically has state but it is designed to be functionally stateless\n */\nconst BaseStaticMap = (props) => {\n  const {\n    controlPadding,\n    viewport,\n    children,\n    mapStyles,\n    onMapDataEvent,\n    ...passthroughProps\n  } = props\n\n  const mapRef = useRef(null)\n  const { size } = useComponentSize(mapRef, { width: 100, height: 50 })\n\n  const [currStyle, setCurrStyle] = useState(0)\n  const [projection, setProjection] = useState(null)\n\n  const recalcProjection = () => {\n    if (!size || size.width < 10 || size.height < 10) return\n    try {\n      const projection = getDistanceScales(viewport)\n      // console.log('recalcProjection', { projection, size })\n      setProjection(projection)\n    }\n    catch (e) {\n      // Sometimes we don't have a valid bound. Don't make a big deal out of it.\n      console.error(e)\n    }\n  }\n\n  if (!projection) recalcProjection()\n  useMemo(recalcProjection, [size])\n\n  return (\n    <div className={classNames('BaseMap', props.className)} ref={mapRef} style={{ height: '100%', width: '100%' }}>\n      <StaticMap\n        {...viewport}\n        height={size.height}\n        width={size.width}\n        mapStyle={mapStyles[currStyle].style}\n        onData={onMapDataEvent}\n        mapboxApiAccessToken={mapConfig.mapBoxToken}\n        {...passthroughProps}\n      >\n        { mapStyles && mapStyles.length > 1 ? (\n          <StyleButtons\n            controlPadding={controlPadding}\n            currStyle={currStyle}\n            mapStyles={mapStyles}\n            setCurrStyle={setCurrStyle}\n          />\n        ) : null }\n        {\n          children && Array.isArray(children)\n            ? children.map(c => handleChild(c, viewport, size.height, size.width, projection))\n            : handleChild(children, viewport, size.height, size.width, projection)\n        }\n      </StaticMap>\n    </div>\n  )\n}\n\nfunction handleChild (child, viewport, height, width, projection) {\n  return typeof child === 'function'\n    ? child(viewport, height, width, projection)\n    : child\n}\n\nBaseStaticMap.propTypes = {\n  // Anything else we want to add to the map\n  children: PropTypes.any,\n  deckelements: PropTypes.array,\n  data: PropTypes.array,\n  // Maybe we want map controls to be padded\n  controlPadding: PropTypes.object,\n\n  minPitch: PropTypes.number,\n  maxPitch: PropTypes.number,\n  pitch: PropTypes.number,\n\n  // Lock the bounds of a map to a rectangle [minlng, minlat], [maxlng, maxlat]\n  bounds: PropTypes.array,\n  // Lock the possible zoom levels to a range: [minZoom, maxZoom]\n  zoomBounds: PropTypes.array,\n  // InitialBounds of the map.\n  InnerBounds: PropTypes.array,\n\n  // List of valid styles that will get picker buttons\n  mapStyles: PropTypes.array,\n\n  // Just some default props we probably won't set.\n  latitude: PropTypes.number,\n  longitude: PropTypes.number,\n  zoom: PropTypes.number,\n\n  onMapDataEvent: PropTypes.func\n}\nBaseStaticMap.defaultProps = {\n  controlPadding: {},\n  stylechooser: true,\n  // viewport: {\n  //   zoom: 12,\n  //   latitude: 49.3050394,\n  //   longitude: -123.1398254\n  // },\n  initStyle: 0,\n  mapStyles: mapConfig.styles\n}\n\nexport default BaseStaticMap\n","import React from 'react'\nimport PropTypes from 'prop-types'\n// import { makeStyles } from '@material-ui/core/styles'\nimport { Marker } from 'react-map-gl'\nimport BaseMap from './BaseMap'\nimport Dot from './markers/Dot'\nimport BaseStaticMap from './BaseStaticMap'\n// import style from './MapDot.style'\n\n// const useStyles = makeStyles(style)\n\nconst MapDot = ({ staticMap, editable, latitude, longitude, onChange, direction, ...props }) => {\n  const Map = staticMap ? BaseStaticMap : BaseMap\n  // const classes = useStyles()\n  const mapProps = staticMap ? {} : {\n    touchRotate: false,\n    dragRotate: false,\n    showMe: editable,\n    lockPan: !editable,\n    onViewportChange: onChange\n  }\n\n  return (\n    <Map\n      {...mapProps}\n      {...props}\n    >\n      {latitude && longitude ? (\n        <Marker\n          className={'singleMarker'}\n          latitude={latitude}\n          longitude={longitude}\n        >\n          <Dot direction={direction} />\n        </Marker>\n      )\n        : <Dot direction={direction} />\n      }\n\n    </Map>\n  )\n}\n\nMapDot.propTypes = {\n  direction: PropTypes.number,\n  latitude: PropTypes.number,\n  longitude: PropTypes.number,\n  editable: PropTypes.bool,\n  staticMap: PropTypes.bool,\n  onChange: PropTypes.func\n}\n\nexport default MapDot\n","import React, { useState, useRef, useEffect } from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport SpeedDial from '@material-ui/lab/SpeedDial'\nimport SpeedDialAction from '@material-ui/lab/SpeedDialAction'\nimport Fab from '@material-ui/core/Fab'\nimport { fade } from '@material-ui/core/styles/colorManipulator'\n\n// import useNewImageMenu from '../PhotoSeries/views/controls/useNewImageMenu'\nimport AddCameraIcon from '@material-ui/icons/AddAPhoto'\nimport PhotoLibraryIcon from '@material-ui/icons/PhotoLibrary'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst useStyles = makeStyles(theme => {\n  const pulseCol = fade(theme.palette.secondary.light, 0.4)\n  return {\n    root: {\n    },\n    speedDialFab: {\n      background: theme.palette.secondary.main,\n      color: theme.palette.secondary.contrastText,\n      '&::before': {\n        content: '\"  \"',\n        display: 'block',\n        position: 'absolute',\n        width: '100%',\n        height: '100%',\n        borderRadius: 'inherit',\n        boxShadow: `0 0 0 0 ${pulseCol}`,\n        animation: '$fabPulse 4s',\n        animationIterationCount: 5,\n        animationTimingFunction: 'linear'\n      }\n    },\n    '@keyframes fabPulse': {\n      '0%': {\n        boxShadow: `0 0 0 0px ${pulseCol}`\n      },\n      '90%': {\n        boxShadow: `0 0 0 0px ${pulseCol}`\n      },\n      '100%': {\n        boxShadow: `0 0 0 10px transparent`\n      }\n    },\n    directionUp: {\n    },\n    actionsClosed: {\n      display: 'none'\n    }\n  }\n})\n\nconst AddFab = ({ className, children, onCameraClick, onLibraryClick, isIos }) => {\n  const [open, setOpen] = useState(false)\n  const [down, setDown] = useState(false)\n  const timerRef = useRef()\n  const classes = useStyles()\n  // const theme = useTheme()\n  const downRef = useRef(down)\n  downRef.current = down\n\n  // Make sure to clean up the timer\n  useEffect(() => () => {\n    if (timerRef.current) timerRef.current = null\n  })\n\n  const startTimer = (el) => {\n    setDown(true)\n    if (!open && !timerRef.current) {\n      timerRef.current = setTimeout(() => {\n        if (downRef.current) setOpen(true)\n        timerRef.current = null\n      }, 300)\n    }\n  }\n\n  const onDown = (e) => {\n    // console.log('onDown', e.currentTarget)\n    // setSeries(series)\n    startTimer(e.currentTarget)\n  }\n\n  const block = (e) => {\n    if (e && e.stopPropagation) {\n      e.stopPropagation()\n      e.preventDefault()\n    }\n  }\n\n  const cameraAction = (e) => {\n    console.log('cameraclick')\n    setOpen(false)\n    setDown(false)\n    onCameraClick()\n    block(e)\n  }\n  const libraryAction = (e) => {\n    console.log('libraryClick')\n    setOpen(false)\n    setDown(false)\n    onLibraryClick()\n    block(e)\n  }\n\n  if (isIos) return <AddFabIos {...{ className, onLibraryClick, children }} />\n\n  return (\n    <div className={classNames(classes.rootContainer, className)}>\n      <SpeedDial\n        ariaLabel='SpeedDial photo adder'\n        onBlur={(e) => {\n          setTimeout(() => setOpen(false), 250)\n        }}\n        ButtonProps={{\n          disableFocusRipple: true\n        }}\n        classes={{\n          directionUp: classes.directionUp,\n          actionsClosed: classes.actionsClosed,\n          root: classes.root,\n          fab: classNames(classes.speedDialFab, 'fabanimation')\n        }}\n        icon={children}\n        onClick={(e) => {\n          block(e)\n          setDown(false)\n          if (!open) {\n            console.log('cameraclick MAIN')\n            onCameraClick()\n          }\n        }}\n        onMouseDown={onDown}\n        // onMouseUp={onUp}\n        onTouchStart={onDown}\n        // onTouchEnd={onUp}\n\n        open={open}\n        direction='up'\n      >\n        <SpeedDialAction\n        // Bit of a hack here. This function isn't quite ready for primetime\n          icon={<AddCameraIcon className={classes.speedDialIcon} />}\n          tooltipPlacement='right'\n          tooltipTitle='From Camera'\n          tooltipOpen\n          ButtonProps={{\n            disableFocusRipple: true\n          }}\n          onClick={cameraAction}\n          onMouseDown={onDown}\n          onTouchStart={cameraAction}\n        />\n        <SpeedDialAction\n        // Bit of a hack here. This function isn't quite ready for primetime\n          icon={<PhotoLibraryIcon className={classes.speedDialIcon} />}\n          tooltipPlacement='right'\n          tooltipTitle='From Photo Library'\n          tooltipOpen\n          ButtonProps={{\n            disableFocusRipple: true\n          }}\n          onClick={libraryAction}\n          onMouseDown={onDown}\n          onTouchStart={libraryAction}\n        />\n      </SpeedDial>\n    </div>\n\n  )\n}\n\nAddFab.propTypes = {\n  className: PropTypes.string,\n  children: PropTypes.any,\n  isIos: PropTypes.bool,\n  onCameraClick: PropTypes.func.isRequired,\n  onLibraryClick: PropTypes.func.isRequired\n}\n\nexport default AddFab\n\nconst useIosStyles = makeStyles(theme => {\n  const pulseCol = fade(theme.palette.secondary.light, 0.4)\n  return {\n    root: {\n      background: theme.palette.secondary.main,\n      color: theme.palette.secondary.contrastText,\n      '&::before': {\n        content: '\"  \"',\n        display: 'block',\n        position: 'absolute',\n        width: '100%',\n        height: '100%',\n        borderRadius: 'inherit',\n        boxShadow: `0 0 0 0 ${pulseCol}`,\n        animation: '$fabPulse 4s',\n        animationIterationCount: 5,\n        animationTimingFunction: 'linear'\n      }\n    },\n    '@keyframes fabPulse': {\n      '0%': {\n        boxShadow: `0 0 0 0px ${pulseCol}`\n      },\n      '90%': {\n        boxShadow: `0 0 0 0px ${pulseCol}`\n      },\n      '100%': {\n        boxShadow: `0 0 0 10px transparent`\n      }\n    }\n  }\n})\n\nexport const AddFabIos = ({ className, children, onLibraryClick }) => {\n  const classes = useIosStyles()\n  return (\n    <Fab className={classNames(classes.root, className)} onClick={onLibraryClick} disableFocusRipple>\n      {children}\n    </Fab>\n  )\n}\n\nAddFabIos.propTypes = {\n  className: PropTypes.string,\n  children: PropTypes.any,\n  onLibraryClick: PropTypes.func.isRequired\n}\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Menu from '@material-ui/core/Menu'\nimport MenuItem from '@material-ui/core/MenuItem'\nimport ListItemIcon from '@material-ui/core/ListItemIcon'\nimport ListItemText from '@material-ui/core/ListItemText'\nimport Divider from '@material-ui/core/Divider'\n\n// import { Menu as MenuIcon } from '@material-ui/icons'\n\nconst ContextMenu = ({ anchorEl, onClose, menuItems }) => {\n  return (\n    <Menu\n      anchorEl={anchorEl}\n      open={!!anchorEl}\n      onClose={onClose}\n    >\n      {menuItems.map(({ icon, color, text, hide, disabled, action, divider }, idx) => {\n        const Icon = icon || null\n        if (hide) return null\n        if (divider) return <Divider key={`contextMenu-${idx}`} />\n        return (\n          <MenuItem\n            key={`contextMenu-${idx}`}\n            disabled={disabled}\n            onClick={() => {\n              onClose()\n              action()\n            }}>\n            {Icon && (\n              <ListItemIcon>\n                <Icon color={disabled ? 'disabled' : color} />\n              </ListItemIcon>\n            )}\n            <ListItemText primary={text} primaryTypographyProps={{ color }} />\n          </MenuItem>\n        )\n      })}\n    </Menu>\n  )\n}\n\nContextMenu.propTypes = {\n  anchorEl: PropTypes.object,\n  onClose: PropTypes.func,\n  menuItems: PropTypes.arrayOf(PropTypes.shape({\n    text: PropTypes.string,\n    icon: PropTypes.any,\n    divider: PropTypes.any,\n    hide: PropTypes.bool,\n    disabled: PropTypes.bool,\n    color: PropTypes.string,\n    action: PropTypes.func\n  }))\n}\n\nexport default ContextMenu\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Chip from '@material-ui/core/Chip'\nimport CancelIcon from '@material-ui/icons/Cancel'\nimport { makeStyles, useTheme } from '@material-ui/core/styles'\n\nexport const tagChips = {\n  height: 20\n}\n\nconst style = theme => ({\n  root: {\n    fontSize: '0.6em',\n    height: tagChips.height,\n    marginRight: theme.spacing(1) / 2,\n    marginTop: theme.spacing(1) / 2\n  },\n  deleteIcon: {\n    width: tagChips.height - 1,\n    height: tagChips.height - 1\n  },\n  chipAvatar: {\n    width: tagChips.height,\n    height: tagChips.height\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst TagChip = ({ edit, tag, color, onDelete, ...props }) => {\n  const classes = useStyles()\n  const theme = useTheme()\n  return (\n    <Chip\n      style={{\n        background: color || null,\n        color: color ? `${theme.palette.getContrastText(color)}` : null\n      }}\n      label={tag.label}\n      data={tag.id}\n      onDelete={edit ? () => onDelete(tag) : null}\n      deleteIcon={(\n        <CancelIcon\n          className={classes.deleteIcon}\n          onClick={e => {\n            console.log('this click')\n          }}\n          style={{\n            opacity: 0.5,\n            color: color ? `${theme.palette.getContrastText(color)}` : null\n          }}\n        />\n      )}\n      className={classes.root}\n      {...props}\n    />\n  )\n}\n\nTagChip.propTypes = {\n  color: PropTypes.string.isRequired,\n  edit: PropTypes.bool,\n  tag: PropTypes.object.isRequired,\n  onDelete: PropTypes.func\n}\n\nexport default TagChip\n","import React from 'react'\nimport classNames from 'classnames'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport FormLabel from '@material-ui/core/FormLabel'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n    position: 'relative',\n    display: 'block',\n    overflow: 'hidden',\n    whiteSpace: 'pre-line',\n    '&::before': {\n      content: '\"  \"',\n      display: 'block',\n      position: 'absolute',\n      bottom: 0,\n      width: '100%',\n      height: 100,\n      background: `linear-gradient(180deg, rgba(255,255,255,0) 0%, ${theme.palette.background.paper} 100%)`\n    }\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst ShortLongText = ({ label, text, height, onClick }) => {\n  const classes = useStyles()\n  return (\n    <div onClick={onClick}>\n      {label && (\n        <FormLabel className={classes.formLabel}>\n          {label}\n        </FormLabel>\n      )}\n      <Typography\n\n        variant='body1'\n        color='inherit'\n        style={{ height }}\n        className={classNames(classes.root)}\n      >\n        {text}\n      </Typography>\n    </div>\n  )\n}\n\nShortLongText.propTypes = {\n  label: PropTypes.string,\n  text: PropTypes.string,\n  height: PropTypes.number,\n  onClick: PropTypes.func\n}\nShortLongText.defaultProps = {\n  height: 100\n}\n\nexport default ShortLongText\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemText from '@material-ui/core/ListItemText'\nimport ListItemAvatar from '@material-ui/core/ListItemAvatar'\nimport Avatar from '@material-ui/core/Avatar'\n// import MenuIcon from '@material-ui/icons/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n  },\n  imgContainer: {\n    // flex: '0 0 50px',\n    // alignSelf: 'flex-start',\n    // height: '100%',\n  },\n  gravatarImg: {\n    objectFit: 'cover',\n    height: '100%',\n    width: '100%'\n  }\n}))\n\nconst UserListItem = ({ user, loading, onAvatarClick, secondary }) => {\n  const classes = useStyles()\n\n  if (loading || !user) return 'LOADING...'\n  // console.log('USER', user)\n\n  return (\n    <ListItem className={classes.root} button={!!onAvatarClick} onClick={onAvatarClick}>\n      <ListItemAvatar className={classes.imgContainer}>\n        <Avatar>\n          <img alt='profile' className={classes.gravatarImg} src={user.gravatar} />\n        </Avatar>\n      </ListItemAvatar>\n      <ListItemText\n        primary={user.username}\n        secondary={secondary}\n      />\n    </ListItem>\n  )\n}\n\nUserListItem.propTypes = {\n  user: PropTypes.object,\n  loading: PropTypes.bool,\n  secondary: PropTypes.string,\n  onAvatarClick: PropTypes.func\n}\n\nexport default UserListItem\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport Dialog from '@material-ui/core/Dialog'\nimport IconButton from '@material-ui/core/IconButton'\nimport DialogTitle from '@material-ui/core/DialogTitle'\n\nimport CloseIcon from '@material-ui/icons/Close'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n\n  },\n  body: {\n    overflow: 'hidden',\n    whiteSpace: 'pre-line',\n    paddingBottom: theme.spacing(1)\n  },\n  title: {\n    alignSelf: 'flex-start',\n    width: '100%',\n    margin: 0,\n    display: 'flex',\n    padding: theme.spacing(2)\n  },\n  dlgTitle: {\n    flexGrow: 1\n  },\n  closeButton: {\n    alignSelf: 'flex-start',\n    color: theme.palette.grey[500]\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst BigText = ({ open, onClose, title, body }) => {\n  const classes = useStyles()\n  return (\n    <Dialog\n      scroll='paper'\n      open={open}\n      fullWidth\n      maxWidth='xl'\n      onClose={onClose}\n      aria-labelledby='simple-dialog-title'\n    >\n      <DialogTitle className={classes.title} disableTypography>\n        <Typography className={classes.dlgTitle}>{title}</Typography>\n        <IconButton className={classes.closeButton} onClick={onClose}>\n          <CloseIcon />\n        </IconButton>\n      </DialogTitle>\n      <DialogContent>\n        <Typography variant='body2' className={classes.body}>{body}</Typography>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nBigText.propTypes = {\n  open: PropTypes.bool,\n  onClose: PropTypes.func,\n  title: PropTypes.string,\n  body: PropTypes.string\n}\n\nexport default BigText\n","import React, { useState, useContext } from 'react'\n// import PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport Divider from '@material-ui/core/Divider'\nimport List from '@material-ui/core/List'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemText from '@material-ui/core/ListItemText'\nimport ListItemAvatar from '@material-ui/core/ListItemAvatar'\nimport Avatar from '@material-ui/core/Avatar'\nimport Typography from '@material-ui/core/Typography'\nimport FormLabel from '@material-ui/core/FormLabel'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport TagChip from '../tags/TagChip'\nimport style from './SeriesInfo.style'\n\nimport ShortLongText from '../controls/ShortLongText'\nimport UserListItem from '../controls/UserListItem'\nimport BigText from '../dialogs/BigText'\nimport { formatDate } from '../../../../lib/datelib'\nimport { ACCESS } from '../../../../config'\nimport SeriesConfigClass from '../../../../lib/SeriesConfig'\n\nimport { SeriesContext } from '../../contexts'\n\nconst DIALOGS = {\n  NOTEVIEW: 'NOTEVIEW'\n}\nconst useStyles = makeStyles(style)\n\nconst SeriesInfo = () => {\n  const classes = useStyles()\n  const { series, seriesConfig } = useContext(SeriesContext)\n  const seriesConfigInst = new SeriesConfigClass(seriesConfig)\n  const [activeDialog, setActiveDialog] = useState(null)\n\n  const newTags = series.photos.reduce((acc, { tags }) => {\n    tags.forEach(tag => {\n      if (!acc[tag.typeId]) {\n        acc[tag.typeId] = {\n          [tag.label]: { ...tag, count: 1 }\n        }\n      }\n      else if (acc[tag.typeId][tag.label]) {\n        const existing = acc[tag.typeId][tag.label]\n        acc[tag.typeId][tag.label] = { ...existing, count: existing.count + 1 }\n      }\n      else acc[tag.typeId][tag.label] = { ...tag, count: 1 }\n    })\n    return acc\n  }, {})\n\n  let metaKeys = []\n  try {\n    metaKeys = series.meta ? Object.keys(JSON.parse(series.meta)) : []\n  }\n  catch (e) {\n    console.error(e)\n  }\n\n  return (\n    <div className={classes.root}>\n      <div className={classes.field}>\n        <FormLabel className={classes.formLabel}>\n      Series Name\n        </FormLabel>\n        <Typography variant='body1' color='inherit'>\n          {series.name}\n        </Typography>\n      </div>\n      {series.note && (\n        <ShortLongText\n          label='Series Note'\n          text={series.note}\n          onClick={() => setActiveDialog(DIALOGS.NOTEVIEW)}\n        />\n      )}\n\n      <Typography className={classes.heading} variant='subtitle1'>Series Summary</Typography>\n      <Divider />\n      <List className={classes.list} dense>\n        <ListItem className={classNames(classes.access, classes[series.access])}>\n          <ListItemText\n            color='inherit'\n            primary={`Series is ${ACCESS[series.access].label}`}\n            secondary={ACCESS[series.access].description}\n          />\n        </ListItem>\n        {series.createdUser && (\n          <UserListItem\n            user={series.createdUser}\n            onAvatarClick={() => seriesConfig.onAvatarClick(series.createdUser.username)}\n            secondary='created this series'\n          />\n        )}\n        <ListItem>\n          <ListItemAvatar>\n            <Avatar className={classes.numPhotos}>\n              {series.photos.length}\n            </Avatar>\n          </ListItemAvatar>\n          <ListItemText\n            primary={series.photos.length > 1 ? 'Photos' : 'Photo'}\n            secondary={series.photos.length > 0 && (\n              <span>\n                {formatDate(series.photos[0].takenOn, 'LL')}\n                <span>&nbsp;&nbsp;</span>to<span>&nbsp;&nbsp;</span>\n                {formatDate(series.photos[series.photos.length - 1].takenOn, 'LL')}\n              </span>\n            )}\n          />\n        </ListItem>\n        <ListItem>\n          <ListItemAvatar>\n            <Avatar className={classes.watchers}>\n              {series.watchers}\n            </Avatar>\n          </ListItemAvatar>\n          <ListItemText primary='Users Watching' />\n        </ListItem>\n        <ListItem>\n          <ListItemText>\n            <FormLabel className={classes.formLabel}>\n              Tags in use (across all photos)\n            </FormLabel>\n            <Divider />\n            {Object.keys(newTags).length === 0 && (\n              <Typography variant='caption'>No photos in this series have tags</Typography>\n            )}\n            {Object.keys(newTags).map((tagKey, idtk) => (\n              <div key={`tagchipkey${idtk}`} className={classes.tagListItem}>\n                <Typography className={classes.subheading} variant='overline'>{seriesConfigInst.getTagType(tagKey).label}</Typography>\n                <Divider />\n                {Object.values(newTags[tagKey]).length > 0\n                  ? (\n                    Object.values(newTags[tagKey]).map((tag, idx) => (\n                      <TagChip\n                        key={`tagchip-${idtk}-${idx}`}\n                        tag={tag}\n                        color={seriesConfigInst.getTagType(tagKey).color}\n                      />\n                    ))\n                  )\n                  : (\n                    <Typography variant='caption'>No photos in this series have tags</Typography>\n                  )\n                }\n              </div>\n            ))}\n          </ListItemText>\n        </ListItem>\n\n      </List>\n\n      {metaKeys.length > 0 && Object.keys(seriesConfig.meta).length > 0 && (\n        <React.Fragment>\n          <FormLabel className={classes.formLabel}>\n            Metadata\n          </FormLabel>\n          <Divider />\n          <List className={classes.list}>\n            {metaKeys.map((key, idx) => seriesConfig.meta[key] ? (\n              <ListItem key={`metadata${idx}`}>\n                <ListItemText\n                  primary={seriesConfig.meta[key].label}\n                  secondary={seriesConfig.meta[key].render(series.meta[key])}\n                />\n              </ListItem>\n            ) : null\n            )}\n          </List>\n        </React.Fragment>\n      )}\n      {activeDialog === DIALOGS.NOTEVIEW && (\n        <BigText\n          open\n          multiline\n          onClose={() => setActiveDialog(null)}\n          title='Series Note'\n          body={series.note}\n        />\n      )}\n    </div>\n  )\n}\n\nSeriesInfo.propTypes = {\n}\n\nexport default SeriesInfo\n","import { ACCESS } from '../../../../config'\nexport default theme => ({\n  root: {\n    margin: theme.spacing(1),\n    backgroundColor: theme.palette.background.paper,\n    paddingBottom: 60 // a little extra room for the FAB\n\n  },\n  field: {\n    marginBottom: theme.spacing(1)\n  },\n  list: {\n    padding: theme.spacing(1)\n  },\n  heading: {\n    marginTop: theme.spacing(1)\n  },\n  watchers: {\n    // backgroundColor: theme.palette.primary.main,\n    // color: theme.palette.primary.contrastText\n  },\n  numPhotos: {\n    backgroundColor: theme.palette.primary.main,\n    color: theme.palette.primary.contrastText\n  },\n  tagListItem: {\n    marginTop: theme.spacing(1),\n    marginBottom: theme.spacing(2)\n  },\n  chip: {\n    margin: theme.spacing(0.5)\n  },\n  access: {\n    padding: theme.spacing(1),\n    borderRadius: theme.spacing(1)\n  },\n  ...Object.keys(ACCESS).reduce((acc, key) => ({\n    ...acc,\n    [key]: {\n      border: `1px solid ${ACCESS[key].color[500]}`,\n      background: `${ACCESS[key].color[700]}`,\n      color: theme.palette.getContrastText(ACCESS[key].color[700])\n    }\n  }), {})\n})\n","const tagChips = {\n  height: 20\n}\n\nexport default theme => ({\n  xyTagChip: {\n    cursor: 'pointer',\n    color: 'white',\n    fontSize: '0.6em',\n    background: '#444444',\n    height: tagChips.height,\n    position: 'absolute',\n    left: -tagChips.height / 2,\n    top: -tagChips.height / 2\n  },\n  editing: {\n    // color: 'white',\n    // background: theme.palette.secondary.main\n  },\n  // The tag is flipped on the right side of the screen\n  reversedChip: {\n    flexDirection: 'row-reverse',\n    left: 'unset',\n    right: -tagChips.height / 2\n  },\n  deleteIcon: {\n    // color: 'white',\n    width: tagChips.height - 1,\n    height: tagChips.height - 1\n  },\n  chipAvatarIcon: {\n    color: 'white',\n    width: tagChips.height - 4,\n    height: tagChips.height - 4\n  },\n  chipAvatar: {\n    background: 'inherit',\n    width: tagChips.height,\n    height: tagChips.height\n  },\n  reversedDelete: {\n    margin: `0 -${tagChips.height / 8}px 0 ${tagChips.height / 8}px`\n  },\n  // The chip bucket is the container div for the chip and represents the\n  // Actual XY coordinates. The chip itself is offset to make the\n  chipBucket: {\n    width: 1,\n    height: 1,\n    display: 'flex',\n    flexDirection: 'row',\n    position: 'absolute'\n  },\n  reversedChipBucket: {\n    flexDirection: 'row-reverse'\n  }\n})\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport Draggable from 'react-draggable'\n\nimport Chip from '@material-ui/core/Chip'\nimport Avatar from '@material-ui/core/Avatar'\n\nimport CancelIcon from '@material-ui/icons/Cancel'\nimport MyLocation from '@material-ui/icons/MyLocation'\n\nimport { makeStyles, useTheme } from '@material-ui/core/styles'\nimport style from './XYTagChip.style'\n\nconst useStyles = makeStyles(style)\n\nconst XYTagChip = ({\n  color, edit, tag, newSize,\n  onTagDragOver, onTagDragStop, onNewTag, onTagDelete, ...props\n}) => {\n  const isReversed = tag.relCoords.x > newSize.newWidth / 2\n  const classes = useStyles()\n  const theme = useTheme()\n  const stopBadness = (e) => {\n    e.preventDefault()\n    e.stopPropagation()\n  }\n\n  const handleDrag = (e, data) => {\n    stopBadness(e)\n    onTagDragOver(data, tag)\n  }\n  const handleStopDrag = (e, data) => {\n    stopBadness(e)\n    onTagDragStop(data, tag)\n  }\n\n  // Draggable chip if it is editable\n  return (\n    <Draggable\n      disabled={!edit}\n      bounds={{ left: 10, top: 10, right: newSize.newWidth - 10, bottom: newSize.newHeight - 10 }}\n      position={{ x: tag.relCoords.x, y: tag.relCoords.y }}\n      onDrag={handleDrag}\n      onStop={handleStopDrag}\n      onClick={stopBadness}\n    >\n      <div className={classNames(classes.chipBucket, isReversed && classes.reversedChipBucket)}>\n        <Chip\n          style={{\n            background: color ? `${color}!important` : null,\n            color: color ? `${theme.palette.getContrastText(color)}!important` : null\n          }}\n          color={edit ? 'secondary' : 'default'}\n          label={tag.label}\n          data={tag.id}\n          onClick={stopBadness}\n          onDelete={edit ? onTagDelete(tag) : null}\n          deleteIcon={edit ? <CancelIcon className={classNames(classes.deleteIcon, isReversed && classes.reversedDelete)} /> : <div />}\n          className={classNames(\n            classes.xyTagChip,\n            isReversed && classes.reversedChip,\n            edit && classes.editing\n          )}\n          {...props}\n          avatar={<Avatar className={classNames(classes.chipAvatar, edit && classes.editing)}>\n            <MyLocation className={classNames(classes.chipAvatarIcon, edit && classes.editing)} />\n          </Avatar>}\n        />\n      </div>\n    </Draggable>\n  )\n}\n\nXYTagChip.propTypes = {\n  color: PropTypes.string,\n  edit: PropTypes.bool,\n  tag: PropTypes.object.isRequired,\n  newSize: PropTypes.object,\n  onTagDragOver: PropTypes.func,\n  onTagDragStop: PropTypes.func,\n  onNewTag: PropTypes.func,\n  onTagDelete: PropTypes.func\n}\n\nexport default XYTagChip\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\nimport Paper from '@material-ui/core/Paper'\nimport Typography from '@material-ui/core/Typography'\nimport TextField from '@material-ui/core/TextField'\nimport MenuItem from '@material-ui/core/MenuItem'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport Select from 'react-select'\nimport CreatableSelect from 'react-select/lib/Creatable'\nimport style from './XYTagSelect.style'\n\nconst useStyles = makeStyles(style)\n\nconst XYTagSelect = ({ tagConfig, onChange }) => {\n  const classes = useStyles()\n  const options = tagConfig.values.map(tc => ({ label: tc.label, value: tc.id }))\n  console.log('XYTagSelect', tagConfig)\n  return (\n    <div className={classes.root}>\n      {!tagConfig.allowAdditions && (\n        <Select\n          options={options}\n          classes={classes}\n          components={{\n            Control,\n            Menu,\n            NoOptionsMessage,\n            Option,\n            Placeholder,\n            ValueContainer\n          }}\n          value={null}\n          // onBlur={e => e.preventDefault()}\n          blurInputOnSelect\n          isClearable={false}\n          onChange={onChange}\n          placeholder={tagConfig.label}\n          isSearchable\n        />\n      ) }\n      { tagConfig.allowAdditions && (\n        <CreatableSelect\n          options={options}\n          classes={classes}\n          components={{\n            Control,\n            Menu,\n            NoOptionsMessage,\n            Option,\n            Placeholder,\n            ValueContainer\n          }}\n          value={null}\n          isClearable={false}\n          // onBlur={e => e.preventDefault()}\n          blurInputOnSelect\n          onChange={onChange}\n          placeholder={tagConfig.label}\n          isSearchable\n        />\n      )}\n    </div>\n  )\n}\nXYTagSelect.propTypes = {\n  tagConfig: PropTypes.object.isRequired,\n  onChange: PropTypes.func.isRequired\n}\n\nexport default XYTagSelect\n\nfunction Control (props) {\n  return (\n    <TextField\n      fullWidth\n      InputProps={{\n        inputComponent,\n        inputProps: {\n          className: props.selectProps.classes.input,\n          inputRef: props.innerRef,\n          children: props.children,\n          ...props.innerProps\n        }\n      }}\n      {...props.selectProps.textFieldProps}\n    />\n  )\n}\n\nconst NoOptionsMessage = ({ innerProps, selectProps, children }) => (\n  <Typography\n    color='textSecondary'\n    className={selectProps.classes.noOptionsMessage}\n    {...innerProps}\n  >\n    {children}\n  </Typography>\n)\n\nconst Menu = ({ selectProps, innerProps, children }) => (\n  <Paper square className={selectProps.classes.paper} {...innerProps}>\n    {children}\n  </Paper>\n)\n\nconst inputComponent = ({ inputRef, ...props }) => <div ref={inputRef} {...props} />\n\nconst Placeholder = (props) => (\n  <Typography\n    color='textSecondary'\n    className={props.selectProps.classes.placeholder}\n    {...props.innerProps}\n  >\n    {props.children}\n  </Typography>\n)\n\nconst Option = ({ innerRef, isFocused, isSelected, innerProps, children }) => (\n  <MenuItem\n    buttonRef={innerRef}\n    selected={isFocused}\n    component='div'\n    style={{ fontWeight: isSelected ? 500 : 400 }}\n    {...innerProps}\n  >\n    {children}\n  </MenuItem>\n)\n\nconst ValueContainer = ({ selectProps, children }) => (\n  <div className={selectProps.classes.valueContainer}>{children}</div>\n)\nValueContainer.propTypes = {\n  selectProps: PropTypes.object.isRequired,\n  children: PropTypes.any\n}\n","export default theme => ({\n  root: {\n    width: '100%'\n  },\n  noOptionsMessage: {\n    padding: `${theme.spacing(1)}px ${theme.spacing(1) * 2}px`\n  },\n  singleValue: {\n    fontSize: 16\n  },\n  placeholder: {\n    position: 'absolute',\n    left: 2,\n    fontSize: 16\n  },\n  input: {\n    display: 'flex',\n    padding: 0\n  },\n  valueContainer: {\n    display: 'flex',\n    flexWrap: 'wrap',\n    flex: 1,\n    alignItems: 'center',\n    overflow: 'hidden'\n  },\n  paper: {\n    position: 'absolute',\n    zIndex: 100,\n    marginTop: theme.spacing(1),\n    left: 0,\n    right: 0\n  }\n})\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport Typography from '@material-ui/core/Typography'\nimport IconButton from '@material-ui/core/IconButton'\n\nimport CloseIcon from '@material-ui/icons/Close'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport XYTagSelect from './XYTagSelect'\nimport style from './XYTagChooser.style'\n\nconst useStyles = makeStyles(style)\n\nconst XYTagChooser = ({ coords, open, seriesConfig, onNewTag, onClose }) => {\n  const classes = useStyles()\n  const xyTags = seriesConfig.tags.filter(t => t.allowXY)\n  if (!coords) return null\n  return (\n    <Dialog\n      open={open}\n      scroll='paper'\n      fullScreen\n      classes={{ paperScrollPaper: classes.root }}\n      onClose={() => onClose()}\n      aria-labelledby='simple-dialog-title'\n    >\n      <DialogTitle id='simple-dialog-title' className={classes.header}>\n      New Tag:\n        <IconButton className={classes.closeButton} onClick={onClose}>\n          <CloseIcon />\n        </IconButton>\n      </DialogTitle>\n      <div className={classes.dlgBody}>\n        {xyTags.length > 1 && (\n          <Typography variant='caption'>What kind of tag would you like to create?</Typography>\n        )}\n\n        {xyTags.map((tagType, idx) => (\n          <div className={classes.listItem} key={`tagSelect${idx}`}>\n            <XYTagSelect tagConfig={tagType} onChange={onNewTag(coords, tagType)} />\n          </div>\n        ))}\n      </div>\n    </Dialog>\n  )\n}\n\nXYTagChooser.propTypes = {\n  seriesConfig: PropTypes.object.isRequired,\n  open: PropTypes.bool.isRequired,\n  coords: PropTypes.object,\n  onClose: PropTypes.func.isRequired,\n  onNewTag: PropTypes.func.isRequired\n}\n\nexport default XYTagChooser\n","export default theme => ({\n  root: {\n    overflow: 'visible'\n  },\n  header: {\n    padding: theme.spacing(1) * 2\n  },\n  listItem: {\n    flexDirection: 'column'\n  },\n  dlgBody: {\n    paddingLeft: theme.spacing(1) * 2,\n    paddingRight: theme.spacing(1) * 2,\n    paddingBottom: theme.spacing(1) * 2\n  },\n  closeButton: {\n    position: 'absolute',\n    right: theme.spacing(1),\n    top: theme.spacing(1),\n    color: theme.palette.grey[500]\n  }\n})\n","import SeriesConfig from './SeriesConfig'\n\nclass Tags {\n  constructor (seriesConfig, tags) {\n    this.tags = tags\n    this.seriesConfig = new SeriesConfig(seriesConfig)\n  }\n\n  findTagById = (typeId, tagId) => {\n    return this.seriesConfig.getTagType(typeId).values\n      .find(tt => tt.id === tagId)\n  }\n\n  // Filter the list of tags to those that are XY tags\n  getXYTags = () => {\n    const xyTagIds = this.seriesConfig.getXYTagTypes().map(tt => tt.id)\n    return this.tags.filter(tag => xyTagIds.indexOf(tag.typeId) > -1 && tag.coords && tag.coords.x)\n  }\n\n  getNonXYTags = () => {\n    const NonXYTagIds = this.seriesConfig.getNonXYTagTypes().map(tt => tt.id)\n    return this.tags.filter(tag => NonXYTagIds.indexOf(tag.typeId) > -1)\n  }\n\n  createNewTagObj = (label, typeId) => (\n    { label, typeId }\n  )\n\n  createExistingTagObj = (id, typeId) => ({\n    ...this.findTagById(typeId, id),\n    typeId\n  })\n\n  createNewXYTagObj = (label, typeId, coords) => ({\n    label,\n    typeId,\n    coords\n  })\n\n  createExistingXYTagObj = (id, typeId, coords) => ({\n    ...this.findTagById(typeId, id),\n    typeId,\n    coords\n  })\n\n  // Get tags in a way that's easy to render them\n  // We augment these tags with relative positions\n  // and a group number for coloring.\n  getRelXYTags = (multiplier) => this.getXYTags().map(tag => ({\n    ...tag,\n    group: this.seriesConfig.getTagTypeIndex(tag.typeId),\n    relCoords: {\n      x: tag.coords.x * multiplier,\n      y: tag.coords.y * multiplier\n    }\n  }))\n}\n\nexport default Tags\n","import React, { useState, useContext } from 'react'\nimport { SeriesContext } from '../../contexts'\nimport XYTagChooser from './XYTagChooser'\nimport Tags from '../../../../lib/Tags'\n\nconst useXYTags = (photo, newSize, onChange, setResizeActive) => {\n  const { seriesConfig } = useContext(SeriesContext)\n\n  // we hold the tags in state so that every little drag motion\n  // doesn't cause an updated state until you let go\n  const [isDragging, setIsDragging] = useState(false)\n  const [newTagDialog, setNewTagDialog] = useState(null)\n\n  const tagClass = new Tags(seriesConfig, photo.tags)\n\n  const onNewTag = (coords, tagType) => ({ value, __isNew__: isNew }) => {\n    let addTag = isNew\n      ? tagClass.createNewXYTagObj(value, tagType.id, coords)\n      : tagClass.createExistingXYTagObj(value, tagType.id, coords)\n\n    setNewTagDialog(null)\n    onChange({ ...photo, tags: [...photo.tags, addTag] })\n  }\n\n  const onTagDelete = (tag) => () => {\n    const tags = photo.tags.filter(oldTag => oldTag.id !== tag.id)\n    onChange({\n      ...photo,\n      tags\n    })\n  }\n\n  // When the photo is tapped, send the x,y coords of that tap\n  // to a dialog we will open\n  const onAddTagTrigger = (e) => {\n    if (!newTagDialog) {\n      // Turn off resizing so mobile keyboards don't complete F us.\n      setResizeActive(false)\n      setNewTagDialog({\n        x: parseInt(e.pageX - (window.innerWidth - newSize.newWidth) / 2 * newSize.multiplier, 10),\n        y: parseInt(e.pageY - (window.innerHeight - newSize.newHeight) / 2 * newSize.multiplier, 10)\n      })\n    }\n  }\n\n  // This gets used by the drag AND the stop\n  const updateTagLocation = ({ x, y }, tag) => {\n    const newTags = photo.tags.map(oldTag => {\n      if (oldTag.id !== tag.id) return oldTag\n      else {\n        let newX = parseInt(x / newSize.multiplier, 10)\n        let newY = parseInt(y / newSize.multiplier, 10)\n\n        return {\n          ...oldTag,\n          coords: { x: newX, y: newY }\n        }\n      }\n    })\n    return newTags\n  }\n\n  const onTagDragStop = (coords, tag) => {\n    const tags = updateTagLocation(coords, tag)\n    setIsDragging(false)\n    onChange({\n      ...photo,\n      tags\n    })\n  }\n\n  const onTagDragOver = (coords, tag) => {\n    updateTagLocation(coords, tag)\n    setIsDragging(true)\n  }\n  const TagChooser = () => (\n    <XYTagChooser\n      open={!isDragging && Boolean(newTagDialog)}\n      coords={newTagDialog}\n      seriesConfig={seriesConfig}\n      onNewTag={onNewTag}\n      onClose={() => {\n        setNewTagDialog(null)\n        // Turn on resizing again.\n        setResizeActive(true)\n      }}\n    />\n  )\n\n  return {\n    onNewTag,\n    onTagDelete,\n    onAddTagTrigger,\n    onTagDragOver,\n    onTagDragStop,\n    TagChooser,\n    getRelXYTags: tagClass.getRelXYTags\n  }\n}\n\nexport default useXYTags\n","import React from 'react'\nimport Typography from '@material-ui/core/Typography'\nimport BrokenImageIcon from '@material-ui/icons/BrokenImage'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    flexGrow: 1,\n    padding: '10%',\n    display: 'flex',\n    flexDirection: 'column',\n    opacity: 0.3,\n    textAlign: 'center',\n    color: theme.palette.grey[100]\n  },\n  icon: {\n    width: '100%',\n    flex: '1 1 40%',\n    color: theme.palette.grey[100],\n    opacity: 0.5\n  },\n  primary: {\n    color: theme.palette.grey[100],\n    textAlign: 'center',\n    flex: '1 1 30%',\n    width: '100%'\n  },\n  secondary: {\n    flex: '1 1 30%',\n    width: '100%'\n  }\n}))\n\nconst BrokenImg = () => {\n  const classes = useStyles()\n  return (\n    <div className={classes.root}>\n      <BrokenImageIcon className={classes.icon} />\n      <Typography className={classes.primary}>Img not found</Typography>\n    </div>\n  )\n}\n\nexport default BrokenImg\n","import React, { useState, useRef, useContext, useEffect } from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport { getObjectUrl } from '../../../../lib/Photo'\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport useComponentSize from '../../../../lib/useComponentSize'\n\nimport { SeriesContext } from '../../contexts'\nimport XYTagChip from '../tags/XYTagChip'\nimport useXYTags from '../tags/useXYTags'\nimport BrokenImg from './BrokenImg'\nimport style from './Photo.style'\n\nconst useStyles = makeStyles(style)\n\nconst Photo = ({ photo, opacity, edit, showTags, dataUrl, transition, onChange, className }) => {\n  const classes = useStyles()\n  const refImgWrap = useRef(null)\n  const [newSize, setNewSize] = useState({ multiplier: 1 })\n  const [url, setUrl] = useState(null)\n  const [broken, setBroken] = useState(false)\n  const [urlRetryCounter, setURLRetryCounter] = useState(0)\n  const { seriesConfig } = useContext(SeriesContext)\n\n  useEffect(() => {\n    async function getURL () {\n      // if something provides a blob then use it\n      if (dataUrl) {\n        setUrl(dataUrl)\n      }\n\n      // If this image hasn't been uploaded yet then go get it from indexDB\n      else if (photo.id.indexOf('__LOCAL_') === 0) {\n        const urlVal = await getObjectUrl(photo.id)\n        if (urlVal && urlVal.indexOf('data:image') === 0) {\n          setUrl(urlVal)\n        }\n        // If this image hasn't even been queued for upload then it may just\n        // be sitting in the object\n        else if (photo.blob) {\n          if (photo.blob.indexOf('data:image') === 0) setUrl(photo.blob)\n        }\n      }\n\n      // Otherwise try to form a coherent image\n      else {\n        const newUrl = seriesConfig.getPhotoUrl(photo, 'large')\n        if (refImgWrap.current) setUrl(newUrl)\n      }\n    }\n    getURL()\n  }, [photo])\n\n  const { size: { height, width }, setResizeActive } = useComponentSize(refImgWrap)\n  const urlWithRetries = urlRetryCounter > 0 ? `${url}?retry=${urlRetryCounter}` : url\n\n  // All tag-related info is put in its own hook\n  const { onAddTagTrigger, TagChooser, getRelXYTags, onTagDragOver, onTagDragStop, onTagDelete } = useXYTags(photo, { height, width }, onChange, setResizeActive)\n\n  const handleImageLoaded = event => {\n    if (refImgWrap.current) {\n      setBroken(false)\n      const { naturalHeight, naturalWidth } = event.target\n      // 4 different cases of orientation:\n      const multiplier = Math.min(\n        height / naturalHeight,\n        width / naturalWidth\n      )\n\n      const newWidth = multiplier * naturalWidth\n      const newHeight = multiplier * naturalHeight\n      setNewSize({ newWidth, newHeight, naturalWidth, naturalHeight, multiplier })\n    }\n  }\n\n  return (\n    <div className={classNames(classes.root, className)}\n      style={{ opacity: opacity !== null ? opacity : 1 }}\n      ref={refImgWrap}\n    >\n      <div className={classes.inner}\n        style={{\n          height: newSize ? newSize.newHeight : 1,\n          width: newSize ? newSize.newWidth : 1\n        }}\n        onClick={onAddTagTrigger}\n      >\n        { showTags || edit\n          ? (\n            <div className={className}>\n              { getRelXYTags(newSize.multiplier).map((tag, idx) => (\n                <XYTagChip\n                  key={`xytag-${idx}`}\n                  color={tag.color}\n                  {...{ edit, newSize, tag, onTagDragOver, onTagDragStop, onTagDelete }} />\n              ))}\n            </div>\n          ) : null\n        }\n        {broken && <BrokenImg />}\n        <img className={classNames(broken ? classes.brokenImg : classes.img)}\n          alt={urlWithRetries}\n          onError={(err) => {\n            if (urlRetryCounter < 10) {\n              setBroken(true)\n              console.log('Image Retry', urlRetryCounter)\n              console.error(err)\n              setTimeout(() => {\n                if (refImgWrap.current) setURLRetryCounter(urlRetryCounter + 1)\n              }, 4000)\n            }\n          }}\n          src={urlWithRetries}\n          onLoad={handleImageLoaded}\n          style={{ height: newSize.newHeight, width: newSize.newWidth }}\n        />\n      </div>\n      {edit && <TagChooser />}\n    </div>\n  )\n}\n\nPhoto.propTypes = {\n  className: PropTypes.string,\n  opacity: PropTypes.number,\n  photo: PropTypes.object.isRequired,\n  dataUrl: PropTypes.string,\n  edit: PropTypes.bool,\n  showTags: PropTypes.bool,\n  transition: PropTypes.string,\n  onChange: PropTypes.func\n}\n\nexport default Photo\n","// import { fade } from '@material-ui/core/styles/colorManipulator'\nexport default theme => ({\n  root: {\n    // maxWidth: 400,\n    display: 'block',\n    position: 'relative',\n    width: '100%',\n    height: '100%',\n    background: 'black',\n    overflow: 'hidden'\n  },\n  inner: {\n    position: 'absolute',\n    top: '50%',\n    left: '50%',\n    transform: 'translateY(-50%) translateX(-50%)',\n    overflow: 'hidden'\n  },\n  xyTags: {\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    // opacity: 0.8,\n    // border: '4px solid red',\n    height: '100%',\n    width: '100%'\n    // background: 'rgba(150, 150, 150, 0.5)'\n  },\n  img: {\n    display: 'block'\n  },\n  brokenImg: {\n    display: 'none'\n  },\n  formControl: {\n    width: '100%'\n  }\n})\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\n\nimport MobileStepper from '@material-ui/core/MobileStepper'\nimport IconButton from '@material-ui/core/IconButton'\nimport GridListTileBar from '@material-ui/core/GridListTileBar'\nimport Badge from '@material-ui/core/Badge'\n\nimport LabelIcon from '@material-ui/icons/Label'\n// import RemoveRedEye from '@material-ui/icons/RemoveRedEye'\nimport KeyboardArrowLeft from '@material-ui/icons/KeyboardArrowLeft'\nimport KeyboardArrowRight from '@material-ui/icons/KeyboardArrowRight'\n\nimport SwipeableViews from 'react-swipeable-views'\nimport Photo from './Photo'\nimport { formatDate } from '../../../../lib/datelib'\nimport { makeStyles, useTheme } from '@material-ui/core/styles'\nimport style from './SwipeShow.style'\n\nconst useStyles = makeStyles(style)\n\nconst SwipeShow = ({ photos, initialPhoto, onImageSelect }) => {\n  const classes = useStyles()\n  const theme = useTheme()\n  const initPhotoIndex = initialPhoto ? photos.findIndex(p => p.id === initialPhoto) || 0 : 0\n  const [activePhoto, setActivePhoto] = useState(initPhotoIndex >= 0 ? initPhotoIndex : 0)\n  const [showTags, setShowTags] = useState(false)\n  const singular = photos.length < 2\n\n  const sortedPhotos = [...photos]\n  sortedPhotos.sort((a, b) => parseInt(b.takenOn, 10) - parseInt(a.takenOn, 10))\n\n  const handleForward = () => setActivePhoto(activePhoto >= sortedPhotos.length ? 0 : activePhoto + 1)\n  const handleBack = () => setActivePhoto(activePhoto <= 0 ? sortedPhotos.length - 1 : activePhoto - 1)\n\n  return (\n    <div className={classes.root}>\n      <div className={classes.inner}>\n        <SwipeableViews\n          axis={theme.direction === 'rtl' ? 'x-reverse' : 'x'}\n          index={activePhoto}\n          onChangeIndex={(val) => setActivePhoto(val)}\n          enableMouseEvents\n        >\n          {sortedPhotos.map((photo, idx) => (\n            <div className={classes.photoWrapper} key={`swipeshowpic-${idx}`} onClick={() => onImageSelect(sortedPhotos[activePhoto].id)}>\n              <Photo photo={photo} className={classes.photo} showTags={showTags} />\n            </div>\n          ))}\n        </SwipeableViews>\n        <IconButton size='small' className={classes.manualBack} onClick={handleBack} color='inherit' disabled={activePhoto === 0}>\n          {theme.direction === 'rtl' ? <KeyboardArrowRight /> : <KeyboardArrowLeft />}\n        </IconButton>\n        <IconButton size='small' className={classes.manualForward} onClick={handleForward} color='inherit' disabled={activePhoto === photos.length - 1}>\n          {theme.direction === 'rtl' ? <KeyboardArrowLeft /> : <KeyboardArrowRight />}\n        </IconButton>\n        <GridListTileBar\n          title={singular ? 'Photo' : `Photo (${activePhoto + 1}/${sortedPhotos.length})`}\n          subtitle={sortedPhotos.length > 0 && (\n            <span>{formatDate(sortedPhotos[activePhoto].takenOn)}</span>\n          )}\n          actionIcon={\n            <React.Fragment>\n              <IconButton className={classes.tagButton} onClick={() => setShowTags(!showTags)}>\n                <Badge color={showTags ? 'primary' : 'secondary'} badgeContent={sortedPhotos[activePhoto].tags ? sortedPhotos[activePhoto].tags.filter(tag => tag.coords).length : null}>\n                  <LabelIcon />\n                </Badge>\n              </IconButton>\n            </React.Fragment>\n          }\n        />\n      </div>\n      {!singular &&\n      <MobileStepper\n        steps={sortedPhotos.length}\n        position='static'\n        activeStep={activePhoto}\n        classes={{\n          root: classes.mobileStepper,\n          dots: classes.dots\n        }}\n      />\n      }\n    </div>\n  )\n}\n\nSwipeShow.propTypes = {\n  // This is just the basic shape of the photo object\n  initialPhoto: PropTypes.string,\n  photos: PropTypes.arrayOf(PropTypes.shape({\n    img: PropTypes.string,\n    tags: PropTypes.array,\n    date: PropTypes.date\n  })),\n  transition: PropTypes.number,\n  onImageSelect: PropTypes.func.isRequired\n}\n\nSwipeShow.defaultProps = {\n  transition: 5000,\n  isFullScreen: false,\n  slides: []\n}\n\nexport default SwipeShow\n","export default theme => ({\n  root: {\n    position: 'relative'\n  },\n  inner: {\n    position: 'relative'\n  },\n  photoWrapper: {\n    minHeight: 250,\n    height: 250\n  },\n  dateCaption: {\n    padding: theme.spacing(1),\n    background: theme.palette.primary.dark,\n    color: theme.palette.primary.contrastText,\n    textAlign: 'center'\n  },\n  mobileStepper: {\n    // position: 'absolute',\n    // bottom: theme.spacing(1),\n    // right: theme.spacing(1)\n  },\n  manualBack: {\n    color: 'white',\n    zIndex: 10,\n    position: 'absolute',\n    transform: 'translateY(-50%)',\n    left: 0,\n    top: '50%'\n  },\n  manualForward: {\n    color: 'white',\n    zIndex: 10,\n    position: 'absolute',\n    transform: 'translateY(-50%)',\n    right: 0,\n    top: '50%'\n  },\n  tagButton: {\n    color: 'rgba(255, 255, 255, 0.54)'\n  },\n  slideshowButton: {\n    color: 'rgba(255, 255, 255, 0.54)'\n  },\n  dots: {\n    margin: '0 auto'\n  }\n})\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport Button from '@material-ui/core/Button'\nimport Typography from '@material-ui/core/Typography'\nimport DialogActions from '@material-ui/core/DialogActions'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n\n})\nconst useStyles = makeStyles(style)\n\nconst DeleteDialog = ({ title, message, onConfirm, open }) => {\n  const classes = useStyles()\n  return (\n    <Dialog\n      className={classes.root}\n      disableBackdropClick\n      open={open}\n      disableEscapeKeyDown\n      maxWidth='xl'\n      aria-labelledby='confirmation-dialog-title'\n    >\n      <DialogTitle id='confirmation-dialog-title'>{title}</DialogTitle>\n      <DialogContent>\n        <Typography>\n          {message}\n        </Typography>\n\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={() => onConfirm(false)} color='primary'>\n      No\n        </Button>\n        <Button onClick={() => onConfirm(true)} color='primary'>\n      Yes\n        </Button>\n      </DialogActions>\n    </Dialog>\n  )\n}\n\nDeleteDialog.propTypes = {\n  open: PropTypes.bool,\n  title: PropTypes.string.isRequired,\n  message: PropTypes.string.isRequired,\n  onConfirm: PropTypes.func.isRequired\n}\n\nexport default DeleteDialog\n","import React, { useState, useContext } from 'react'\nimport classNames from 'classnames'\nimport PropTypes from 'prop-types'\n\nimport GridList from '@material-ui/core/GridList'\nimport GridListTile from '@material-ui/core/GridListTile'\nimport GridListTileBar from '@material-ui/core/GridListTileBar'\nimport Snackbar from '@material-ui/core/Snackbar'\nimport Button from '@material-ui/core/Button'\nimport Fab from '@material-ui/core/Fab'\n\nimport AddIcon from '@material-ui/icons/Add'\nimport RemoveIcon from '@material-ui/icons/Remove'\n\nimport { SeriesContext } from '../../contexts'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport style from './PhotoGrid.style'\nimport DeleteDialog from '../dialogs/DeleteDialog'\nimport { formatDate } from '../../../../lib/datelib'\n\nconst useStyles = makeStyles(style)\n\nconst PhotoGrid = ({ photos, columns, multiSelect, onDelete, onTileClick }) => {\n  const [selectMode, setSelectMode] = useState(false)\n  const classes = useStyles()\n  const [selectedItems, setSelectedItems] = useState([])\n  const [deleteConfirm, setDeleteConfirm] = useState(false)\n\n  const { seriesConfig, ac } = useContext(SeriesContext)\n\n  const handleAddToSelection = (e, id) => {\n    e.preventDefault()\n    e.stopPropagation()\n\n    setSelectMode(true)\n    toggleListItem(id)\n  }\n\n  const handleCancelSelection = () => {\n    setSelectMode(false)\n    setSelectedItems([])\n  }\n\n  const onDeleteConfirm = (confirmation) => {\n    setDeleteConfirm(false)\n    if (confirmation === true && selectedItems.length < photos.length) onDelete(selectedItems)\n    handleCancelSelection()\n  }\n\n  const toggleListItem = (id) => {\n    const index = selectedItems.indexOf(id)\n    if (index < 0) setSelectedItems([...selectedItems, id])\n    else {\n      const remaining = selectedItems.filter(arrId => arrId !== id)\n      if (remaining.length === 0) handleCancelSelection()\n      setSelectedItems(remaining)\n    }\n  }\n\n  const handlePhotoTap = (e, photo) => {\n    e.preventDefault()\n    e.stopPropagation()\n    // Select / deselect the item in edit mode\n    if (selectMode) toggleListItem(photo.id)\n    // navigate if tileClick selected\n    else onTileClick(photo.id)\n  }\n\n  const sortedPhotos = [...photos]\n  sortedPhotos.sort((a, b) => parseInt(b.takenOn, 10) - parseInt(a.takenOn, 10))\n\n  return (\n    <div>\n      <GridList cols={columns} cellHeight={200} className={classes.root}>\n        {sortedPhotos.map((photo, idx) => {\n          const selected = selectedItems.indexOf(photo.id) > -1\n          const canDelete = ac.canUser('delete', photo, 'photo')\n\n          let photoUrl = seriesConfig.getPhotoUrl(photo, 'thumb') || photo.base64\n\n          return (\n            <GridListTile\n              key={`gridTile${idx}`}\n              onClick={(e) => canDelete && handlePhotoTap(e, photo)}\n              className={classNames(\n                classes.tile,\n                selectMode && !canDelete && classes.notDeleteable,\n                selectMode && canDelete && !selected && classes.unSelectedTile,\n                selectMode && selected && classes.selectedTile\n              )}\n            >\n              <img src={photoUrl} alt={photoUrl} className={classes.img} />\n              {canDelete && multiSelect && (\n                <Fab size='small' aria-label='Add' className={classes.addFab} onClick={(e) => handleAddToSelection(e, photo.id)}>\n                  {!selectMode || !selected ? <AddIcon /> : <RemoveIcon />}\n                </Fab>\n              )}\n              <GridListTileBar\n                title={<span>{formatDate(photo.takenOn)}</span>}\n              />\n            </GridListTile>\n          )\n        })}\n      </GridList>\n      <Snackbar\n        open={selectMode}\n        autoHideDuration={null}\n        ContentProps={{\n          'aria-describedby': 'snackbar-fab-message-id',\n          className: classes.snackbarContent\n        }}\n        message={<span id='snackbar-fab-message-id'>\n          {selectedItems.length >= photos.length ? 'You can\\'t delete all the photos. delete the series instead.' : `${selectedItems.length} Photos selected`}\n        </span>}\n        action={<div>\n          <Button color='inherit' disabled={selectedItems.length >= photos.length} size='small' onClick={() => setDeleteConfirm(true)}>\n                Delete\n          </Button>\n          <Button color='inherit' size='small' onClick={() => handleCancelSelection()}>\n                Cancel\n          </Button>\n        </div>\n        }\n        className={classes.snackbar}\n      />\n\n      <DeleteDialog\n        open={deleteConfirm}\n        onConfirm={onDeleteConfirm}\n        title={`Delete ${selectedItems.length} Photos`}\n        message='Are you sure you want to delete these photos?'\n      />\n    </div>\n\n  )\n}\n\nPhotoGrid.propTypes = {\n  photos: PropTypes.array.isRequired,\n  columns: PropTypes.number,\n\n  multiSelect: PropTypes.bool,\n  onDelete: PropTypes.func,\n  onTileClick: PropTypes.func.isRequired\n}\nPhotoGrid.defaultProps = {\n  multiSelect: true,\n  columns: 2\n}\n\nexport default PhotoGrid\n","import { red } from '@material-ui/core/colors'\nexport default theme => ({\n  root: {\n\n  },\n  tile: {\n\n  },\n  addFab: {\n    position: 'absolute',\n    zIndex: 10,\n    top: theme.spacing(1),\n    left: theme.spacing(1),\n    opacity: 0.3\n  },\n  notDeleteable: {\n    background: theme.palette.primary.dark,\n    opacity: 0.1\n    // '& img': {\n    // }\n  },\n  unSelectedTile: {\n    '& img': {\n      opacity: 0.7\n    }\n  },\n  selectedTile: {\n    padding: `${theme.spacing(2)}px!important`,\n    '& img': {\n      opacity: 1\n    }\n  },\n  img: {\n\n  },\n  snackbarContent: {\n    backgroundColor: red[700]\n  },\n  snackbar: {\n  }\n})\n","export default theme => ({\n  root: {\n    display: 'flex',\n    height: '100%',\n    flexDirection: 'column',\n    overflow: 'hidden'\n  },\n  appBar: {\n    flexGrow: 0\n  },\n  inner: {\n    position: 'relative',\n    flexGrow: 1,\n    overflowY: 'scroll',\n    '-webkit-overflow-scrolling': 'touch'\n  },\n  tabMenu: {\n    marginTop: theme.spacing(7)\n  },\n  mapWrap: {\n    position: 'absolute',\n    height: '100%',\n    width: '100%',\n    top: 0,\n    left: 0\n  },\n  toolbarTitle: {\n    flexGrow: 1,\n    textOverflow: 'ellipsis',\n    whiteSpace: 'nowrap',\n    overflow: 'hidden'\n  },\n  AddFab: {\n    position: 'absolute',\n    bottom: theme.spacing(2),\n    right: theme.spacing(2),\n    // left: '50%',\n    // transformOrigin: '0% 50%',\n    // transform: 'translateY(-25%) translateX(-50%)',\n    zIndex: 3000\n  },\n  grow: {\n    flexGrow: 1\n  },\n  gridList: {\n    flexWrap: 'nowrap',\n    // Promote the list into his own layer on Chrome. This cost memory but helps keeping high FPS.\n    transform: 'translateZ(0)'\n  },\n  titleBar: {\n    display: 'flex',\n    padding: theme.spacing(1)\n  },\n  menuButton: {\n    // marginLeft: -12,\n    // marginRight: 20\n  },\n  placeholderInner: {\n    position: 'relative',\n    flexGrow: 1,\n    overflow: 'hidden',\n    textAlign: 'center',\n    display: 'flex',\n    height: '100%',\n    flexDirection: 'column'\n  },\n  progressWrapper: {\n    textAlign: 'center',\n    marginBottom: theme.spacing(4)\n  },\n  placeholderText: {\n    opacity: 0.4\n  },\n  placeholder: {\n\n  },\n  progress: {\n    color: theme.palette.grey[300]\n  }\n})\n","import React, { useState, useContext } from 'react'\nimport PropTypes from 'prop-types'\n\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport AppBar from '@material-ui/core/AppBar'\nimport Toolbar from '@material-ui/core/Toolbar'\nimport IconButton from '@material-ui/core/IconButton'\nimport Typography from '@material-ui/core/Typography'\nimport Tabs from '@material-ui/core/Tabs'\nimport Tab from '@material-ui/core/Tab'\n\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack'\n\nimport AddCameraIcon from '@material-ui/icons/AddAPhoto'\nimport MoreIcon from '@material-ui/icons/MoreVert'\n\nimport AddAlertIcon from '@material-ui/icons/AddAlert'\nimport SlideshowIcon from '@material-ui/icons/Slideshow'\nimport EditIcon from '@material-ui/icons/Edit'\nimport DeleteIcon from '@material-ui/icons/Delete'\n\nimport QRDisplay from './QRDisplay'\nimport QRCodeIcon from '../../../icons/QRCode'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport MapDot from '../../maps/MapDot'\nimport AddFab from './controls/AddFab'\n\nimport ContextMenu from './controls/ContextMenu'\n\nimport SeriesInfo from './subViews/SeriesInfo'\nimport SwipeShow from './subViews/SwipeShow'\nimport PhotoGrid from './subViews/PhotoGrid'\n\nimport DeleteDialog from './dialogs/DeleteDialog'\n\nimport { SeriesContext } from '../contexts'\n\nimport style from './SeriesView.style'\nconst useStyles = makeStyles(style)\n\nconst SeriesView = ({\n  onSlideshowStart, onChange,\n  onEditSeries, onDeletePhotos, onCameraAdd,\n  onDeleteSeries, onLibraryAdd, onTileClick, onMenuBack,\n  onWatch, onUnWatch, initialPhoto,\n  watching, owned\n}) => {\n  const classes = useStyles()\n  const [contextEl, setContextEl] = useState()\n  const [showQR, setShowQR] = useState(false)\n  const [deleteConfirm, setDeleteConfirm] = useState(false)\n\n  const { series, seriesConfig, ac } = useContext(SeriesContext)\n\n  const onDeleteConfirm = (confirmation) => {\n    setDeleteConfirm(false)\n    if (confirmation === true) onDeleteSeries(series.id)\n  }\n\n  const viewport = { zoom: 16 }\n  if (series && series.coords && series.coords.length === 2) {\n    viewport.longitude = series.coords[0]\n    viewport.latitude = series.coords[1]\n  }\n\n  const can = {\n    update: ac.canUser('update', series, 'series', '*'),\n    delete: ac.canUser('delete', series, 'series', '*'),\n    contribute: ac.canUser('update', series, 'series', ['photos'])\n  }\n\n  const [listTypeTab, setListTypeTab] = useState(0)\n  return (\n    <div className={classes.root}>\n      <CssBaseline />\n      <AppBar position='static' className={classes.appBar}>\n        <Toolbar disableGutters>\n          <IconButton className={classes.menuButton} color='inherit' onClick={onMenuBack} aria-label='Menu'>\n            <ArrowBackIcon />\n          </IconButton>\n          <Typography variant='subtitle1' color='inherit' className={classes.toolbarTitle}>\n            {series.name || 'Series'}\n          </Typography>\n\n          {/* <IconButton className={classes.menuButton} color='inherit' onClick={onSlideshowStart} aria-label='Menu'>\n            <SlideshowIcon />\n          </IconButton> */}\n          <IconButton\n            aria-haspopup='true'\n            color='inherit'\n            onClick={event => setContextEl(event.currentTarget)}\n          >\n            <MoreIcon />\n          </IconButton>\n\n          <ContextMenu anchorEl={contextEl} onClose={() => setContextEl(null)} menuItems={[\n            {\n              text: 'Watch Series',\n              icon: AddAlertIcon,\n              hide: !onWatch || owned || watching,\n              action: onWatch\n            },\n            {\n              text: 'Unwatch Series',\n              icon: AddAlertIcon,\n              hide: !onUnWatch || owned || !watching,\n              action: onUnWatch\n            },\n            {\n              text: 'Series QR Code',\n              icon: QRCodeIcon,\n              action: () => setShowQR(true)\n            },\n            {\n              text: 'Start Slideshow',\n              icon: SlideshowIcon,\n              hide: !onSlideshowStart,\n              action: onSlideshowStart\n            },\n            { divider: true },\n            {\n              text: 'Edit Series',\n              icon: EditIcon,\n              hide: !onEditSeries || !can.update,\n              action: onEditSeries\n            },\n            {\n              text: 'Delete Series',\n              icon: DeleteIcon,\n              hide: !setDeleteConfirm || !can.delete,\n              color: 'error',\n              action: () => setDeleteConfirm(true)\n            }\n          ]} />\n        </Toolbar>\n        <Tabs variant='fullWidth'\n          value={listTypeTab}\n          onChange={(e, value) => setListTypeTab(value)}\n        >\n          <Tab label='Info' />\n          <Tab label='Map' />\n          <Tab label='Photos' />\n        </Tabs>\n      </AppBar>\n\n      <div className={classes.inner}>\n        {listTypeTab === 0 && (\n          <React.Fragment>\n            {series.photos && series.photos.length > 0 && (\n              <SwipeShow\n                photos={series.photos}\n                initialPhoto={initialPhoto}\n                onImageSelect={onTileClick}\n              />\n            )}\n            <SeriesInfo onChange={onChange} />\n          </React.Fragment>\n        )}\n        {series.photos && listTypeTab === 2 && (\n          <PhotoGrid\n            photos={series.photos}\n            onTileClick={onTileClick}\n            onDelete={onDeletePhotos}\n          />\n        )}\n      </div>\n\n      {listTypeTab === 1 && (\n        <MapDot\n          showMe\n          longitude={series.longitude}\n          latitude={series.latitude}\n          viewport={viewport}\n          direction={series.direction}\n        />\n      )}\n\n      {listTypeTab === 0 && can.contribute && (\n        <AddFab\n          isIos={seriesConfig.isIos}\n          className={classes.AddFab}\n          onCameraClick={onCameraAdd}\n          onLibraryClick={onLibraryAdd}\n        >\n          <AddCameraIcon />\n        </AddFab>\n      )}\n      <QRDisplay open={showQR} onClose={() => setShowQR(false)} />\n      <DeleteDialog\n        open={deleteConfirm}\n        onConfirm={onDeleteConfirm}\n        title='Delete Series'\n        message='Are you sure you want to delete this series? The record and all images associated with it will be gone forever.'\n      />\n    </div>\n  )\n}\n\nSeriesView.propTypes = {\n  initialPhoto: PropTypes.string,\n  watching: PropTypes.bool,\n  owned: PropTypes.bool,\n  // Action functions\n  onSlideshowStart: PropTypes.func.isRequired,\n  onChange: PropTypes.func.isRequired,\n  onDeletePhotos: PropTypes.func.isRequired,\n  onDeleteSeries: PropTypes.func.isRequired,\n  onCameraAdd: PropTypes.func.isRequired,\n  onEditSeries: PropTypes.func.isRequired,\n  onLibraryAdd: PropTypes.func.isRequired,\n  onTileClick: PropTypes.func.isRequired,\n  onMenuBack: PropTypes.func.isRequired,\n  onWatch: PropTypes.func,\n  onUnWatch: PropTypes.func\n}\n\nexport default SeriesView\n","import React, { useState, useMemo } from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogActions from '@material-ui/core/DialogActions'\nimport Button from '@material-ui/core/Button'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport FormLabel from '@material-ui/core/FormLabel'\nimport Slider from '@material-ui/lab/Slider'\n\nimport MapDot from '../../../maps/MapDot'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n\n  },\n  dlgContent: {\n    display: 'flex',\n    flexDirection: 'column',\n    padding: 0\n  },\n  mapWrapper: {\n    flexGrow: 1\n  },\n  sliderWrapper: {\n    padding: '20px'\n  },\n  slider: {\n\n  },\n  sliderRoot: {\n\n  },\n  body: {\n    overflow: 'hidden',\n    whiteSpace: 'pre-line',\n    paddingBottom: theme.spacing(1)\n  },\n  title: {\n    background: theme.palette.primary.main,\n    color: theme.palette.primary.contrastText,\n    margin: 0,\n    padding: theme.spacing(2)\n  },\n  closeButton: {\n    position: 'absolute',\n    right: theme.spacing(1),\n    top: theme.spacing(1),\n    color: theme.palette.grey[500]\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst MapDirPicker = ({ open, onOk, onCancel, title, latitude: initLat, longitude: initLong, direction: initDir }) => {\n  const classes = useStyles()\n  const [{ longitude, latitude }, setCoords] = useState({ longitude: initLong, latitude: initLat })\n  const [direction, setRotation] = useState(initDir)\n\n  const initViewport = useMemo(() => ({\n    zoom: 18,\n    latitude: initLat,\n    longitude: initLong\n  }), [initLat, initLong])\n\n  const mapChange = ({ viewport: { longitude, latitude } }) => setCoords({ longitude, latitude })\n\n  return (\n    <Dialog\n      scroll='paper'\n      open={open}\n      fullWidth\n      fullScreen\n      onClose={onCancel}\n    >\n      <DialogTitle className={classes.title} disableTypography>\n        <Typography color='inherit'>{title}</Typography>\n      </DialogTitle>\n      <DialogContent className={classes.dlgContent}>\n        <div className={classes.mapWrapper}>\n          <MapDot\n            editable\n            className={classes.map}\n            direction={direction > 0 ? direction : null}\n            viewport={initViewport}\n            onChange={mapChange}\n          />\n        </div>\n        <div className={classes.sliderWrapper}>\n          <FormLabel className={classes.mapFormLabel}>Direction {direction > -1 ? '' : '(off)'}</FormLabel>\n          <Slider\n            classes={{\n              root: classes.sliderRoot\n            }}\n            value={direction || -1}\n            min={-1}\n            max={360}\n            step={1}\n            onChange={(e, value) => setRotation(value)}\n          />\n        </div>\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={onCancel}>Cancel</Button>\n        <div style={{ flexGrow: 1 }} />\n        <Button onClick={() => onOk({ longitude, latitude, direction })}>Ok</Button>\n      </DialogActions>\n    </Dialog>\n  )\n}\n\nMapDirPicker.propTypes = {\n  open: PropTypes.bool,\n  latitude: PropTypes.number,\n  longitude: PropTypes.number,\n  direction: PropTypes.number,\n  onOk: PropTypes.func,\n  onCancel: PropTypes.func,\n  title: PropTypes.string\n}\n\nexport default MapDirPicker\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\n// import Typography from '@material-ui/core/Typography'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogActions from '@material-ui/core/DialogActions'\nimport TextField from '@material-ui/core/TextField'\nimport Button from '@material-ui/core/Button'\nimport DialogTitle from '@material-ui/core/DialogTitle'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n\n  },\n  body: {\n    overflow: 'hidden',\n    whiteSpace: 'pre-line',\n    paddingBottom: theme.spacing(1)\n  },\n  title: {\n    margin: 0,\n    padding: theme.spacing(2)\n  },\n  closeButton: {\n    position: 'absolute',\n    right: theme.spacing(1),\n    top: theme.spacing(1),\n    color: theme.palette.grey[500]\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst BigTextEdit = ({ open, onOk, title, body, multiline }) => {\n  const classes = useStyles()\n  const [value, setValue] = useState(body || '')\n  return (\n    <Dialog\n      scroll='paper'\n      open={open}\n      fullWidth\n      onClose={() => onOk(value)}\n    >\n      <DialogTitle className={classes.title}>\n        {title}\n      </DialogTitle>\n      <DialogContent>\n        <TextField\n          className={classes.body}\n          multiline={multiline}\n          fullWidth\n          rows={6}\n          rowsMax={20}\n          onChange={e => setValue(e.target.value)}\n          defaultValue={body}\n        />\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={() => onOk(body)}>Cancel</Button>\n        <div style={{ flexGrow: 1 }} />\n        <Button onClick={() => onOk(value)}>Ok</Button>\n      </DialogActions>\n    </Dialog>\n  )\n}\n\nBigTextEdit.propTypes = {\n  open: PropTypes.bool,\n  multiline: PropTypes.bool,\n  onOk: PropTypes.func,\n  title: PropTypes.string,\n  body: PropTypes.string\n}\n\nexport default BigTextEdit\n","\nimport React, { useState } from 'react'\nimport PropTypes from 'prop-types'\n\nimport TextField from '@material-ui/core/TextField'\nimport FormLabel from '@material-ui/core/FormLabel'\nimport Typography from '@material-ui/core/Typography'\nimport FormControlLabel from '@material-ui/core/FormControlLabel'\nimport Switch from '@material-ui/core/Switch'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport MapDot from '../../../maps/MapDot'\n\nimport MapDirPicker from '../dialogs/MapDirPicker'\nimport BigTextEdit from '../dialogs/BigTextEdit'\n\nimport style from './SeriesEditInner.style'\nimport { ACCESS } from '../../../../config'\nimport ShortLongText from '../controls/ShortLongText'\n\nconst DIALOGS = {\n  MAPPICK: 'mapPicker',\n  NOTEEDIT: 'noteEdit'\n}\n\nconst useStyles = makeStyles(style)\n\n/**\n * SeriesEdit appears in two places so we need this to be a bit reusable\n */\nconst SeriesEditInner = ({ series, delta, onChange }) => {\n  const classes = useStyles()\n  const [activeDialog, setActiveDialog] = useState(null)\n\n  const viewport = { zoom: 18 }\n  if ((delta.latitude || series.coords[1]) && (delta.longitude || series.coords[0])) {\n    viewport.longitude = delta.longitude || series.coords[0]\n    viewport.latitude = delta.latitude || series.coords[1]\n  }\n\n  const access = delta.access || series.access || 'PRIVATE'\n  // console.log('ACESS', access)\n  return (\n    <div>\n      <TextField\n        label='Series Name'\n        fullWidth\n        placeholder='New Series'\n        className={classes.field}\n        value={delta.name || series.name || ''}\n        onChange={e => onChange({ ...delta, name: e.target.value })}\n      />\n      <div className={classes.mapWrapper} onClick={() => setActiveDialog(DIALOGS.MAPPICK)}>\n        <FormLabel className={classes.mapFormLabel}>Location</FormLabel>\n        <div className={classes.mapInnerWrap}>\n          <MapDot\n            staticMap\n            className={classes.map}\n            direction={delta.direction || series.direction}\n            viewport={viewport}\n          />\n        </div>\n      </div>\n      <div className={classes.field}>\n        <FormLabel>Series Access</FormLabel>\n        <div className={classes.access}>\n          <FormControlLabel\n            className={classes.accessRadio}\n            control={\n              <Switch\n                checked={['OPEN', 'PUBLIC'].indexOf(access) > -1}\n                onChange={(e) => {\n                  onChange({ ...delta, access: e.target.checked ? 'PUBLIC' : 'PRIVATE' })\n                }}\n                value={'PUBLIC'}\n              />\n            }\n            label={<div>\n              <Typography variant='body2' component='div'>{ACCESS.PUBLIC.label}</Typography>\n              <Typography variant='caption' color='textSecondary' component='div'>{ACCESS.PUBLIC.description}</Typography>\n            </div>}\n\n          />\n          <FormControlLabel\n            className={classes.accessRadio}\n            disabled={['PRIVATE'].indexOf(access) > -1}\n            control={\n              <Switch\n                checked={['OPEN'].indexOf(access) > -1}\n                onChange={(e) => onChange({ ...delta, access: e.target.checked ? 'OPEN' : 'PUBLIC' })}\n                value={'OPEN'}\n              />\n            }\n            label={<div>\n              <Typography variant='body2' component='div'>{ACCESS.OPEN.label}</Typography>\n              <Typography variant='caption' color='textSecondary' component='div'>{ACCESS.OPEN.description}</Typography>\n            </div>}\n          />\n        </div>\n      </div>\n\n      <ShortLongText\n        onClick={() => setActiveDialog(DIALOGS.NOTEEDIT)}\n        className={classes.field}\n        label='Series Note'\n        text={delta.note || series.note}\n      />\n      {activeDialog === DIALOGS.MAPPICK && (\n        <MapDirPicker\n          open\n          title='Series Location & Direction'\n          latitude={delta.latitude || series.coords[1]}\n          longitude={delta.longitude || series.coords[0]}\n          direction={delta.direction || series.direction}\n          onOk={(data) => {\n            onChange({ ...delta, ...data })\n            setActiveDialog(null)\n          }}\n          onCancel={() => setActiveDialog(null)}\n        />\n      )}\n      {activeDialog === DIALOGS.NOTEEDIT && (\n        <BigTextEdit\n          open\n          title='Series Note'\n          body={delta.note || series.note}\n          multiline\n          onOk={(newNote) => {\n            onChange({ ...delta, note: newNote })\n            setActiveDialog(null)\n          }}\n          onCancel={() => setActiveDialog(null)}\n        />\n      )}\n    </div>\n  )\n}\n\nSeriesEditInner.propTypes = {\n  // now some functions\n  series: PropTypes.object.isRequired,\n  delta: PropTypes.object.isRequired,\n  onChange: PropTypes.func.isRequired\n}\n\nexport default SeriesEditInner\n","export default theme => ({\n  root: {\n\n  },\n  inner: {\n    display: 'flex',\n    flexDirection: 'column'\n    // padding: theme.spacing(1)\n  },\n  dlgTitle: {\n    background: theme.palette.primary.main,\n    color: theme.palette.primary.contrastText\n  },\n  access: {\n    display: 'flex',\n    flexDirection: 'column'\n  },\n  accessRadio: {\n    margin: theme.spacing(2, 1)\n    // flex: '1 1 50%'\n  },\n  grow: {\n    flexGrow: 1\n  },\n  field: {\n    flexGrow: 0,\n    marginBottom: theme.spacing(1) * 2\n  },\n  slider: {\n    paddingLeft: theme.spacing(1),\n    paddingRight: theme.spacing(1)\n  },\n  textField: {\n    marginLeft: theme.spacing(1),\n    marginRight: theme.spacing(1),\n    width: '100%'\n  },\n  formLabel: {\n    display: 'block',\n    marginTop: theme.spacing(1),\n    marginBottom: theme.spacing(1)\n  },\n  mapFormLabel: {\n    display: 'block',\n    marginTop: theme.spacing(1),\n    marginBottom: theme.spacing(1)\n  },\n  mapInnerWrap: {\n    flexGrow: 1,\n    height: '200px',\n    minHeight: '200px'\n  },\n  mapWrapper: {\n    flexGrow: 1,\n    display: 'flex',\n    flexDirection: 'column',\n    paddingBottom: theme.spacing(1) * 2\n  },\n  formControl: {\n    margin: theme.spacing(1),\n    minWidth: 120\n  },\n  chips: {\n    display: 'flex',\n    flexWrap: 'wrap'\n  }\n})\n","\nimport React, { useState, useContext } from 'react'\nimport PropTypes from 'prop-types'\n\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport DialogActions from '@material-ui/core/DialogActions'\nimport Button from '@material-ui/core/Button'\nimport Typography from '@material-ui/core/Typography'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport { SeriesContext } from '../contexts'\n\nimport style from './SeriesEdit.style'\nimport SeriesEditInner from './subViews/SeriesEditInner'\n\nconst useStyles = makeStyles(style)\n\nconst SeriesEdit = ({ onOk, onCancel }) => {\n  const classes = useStyles()\n  const { series } = useContext(SeriesContext)\n  const [delta, setDelta] = useState({})\n\n  return (\n    <Dialog\n      scroll='paper'\n      className={classes.root}\n      fullScreen\n      open\n      fullWidth\n      onClose={onCancel}\n    >\n      <CssBaseline />\n      <DialogTitle disableTypography className={classes.dlgTitle}>\n        <Typography variant='subtitle1' color='inherit' className={classes.grow}>\n           Edit Series Details\n        </Typography>\n      </DialogTitle>\n      <DialogContent className={classes.inner}>\n        <SeriesEditInner\n          series={series}\n          delta={delta}\n          onChange={setDelta}\n        />\n      </DialogContent>\n      <DialogActions>\n        <Button className={classes.menuButton} color='inherit' onClick={() => setDelta({})} aria-label='Menu'>\n            Reset\n        </Button>\n        <Button className={classes.menuButton} color='inherit' onClick={onCancel} aria-label='Menu'>\n            Cancel\n        </Button>\n        <Button className={classes.menuButton} color='inherit' onClick={() => onOk({ id: series.id, ...delta })} aria-label='Menu'>\n            Ok\n        </Button>\n      </DialogActions>\n    </Dialog>\n  )\n}\n\nSeriesEdit.propTypes = {\n  // now some functions\n  onOk: PropTypes.func.isRequired,\n  onCancel: PropTypes.func.isRequired\n}\n\nexport default SeriesEdit\n","export default theme => ({\n  root: {\n\n  },\n  inner: {\n    display: 'flex',\n    flexDirection: 'column'\n    // padding: theme.spacing(1)\n  },\n  dlgTitle: {\n    background: theme.palette.primary.main,\n    color: theme.palette.primary.contrastText\n  },\n  grow: {\n    flexGrow: 1\n  },\n  field: {\n    flexGrow: 0,\n    marginBottom: theme.spacing(2)\n  },\n  slider: {\n    paddingLeft: theme.spacing(1),\n    paddingRight: theme.spacing(1)\n  },\n  textField: {\n    marginLeft: theme.spacing(1),\n    marginRight: theme.spacing(1),\n    width: '100%'\n  },\n  formLabel: {\n    display: 'block',\n    marginTop: theme.spacing(1),\n    marginBottom: theme.spacing(1)\n  },\n  mapFormLabel: {\n    display: 'block',\n    marginTop: theme.spacing(1),\n    marginBottom: theme.spacing(1)\n  },\n  mapInnerWrap: {\n    flexGrow: 1\n  },\n  mapWrapper: {\n    flexGrow: 1,\n    display: 'flex',\n    flexDirection: 'column',\n    paddingBottom: theme.spacing(2)\n  },\n  formControl: {\n    margin: theme.spacing(1),\n    minWidth: 120\n  },\n  chips: {\n    display: 'flex',\n    flexWrap: 'wrap'\n  }\n})\n","import React, { useState, useEffect, useRef } from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\n\nimport Badge from '@material-ui/core/Badge'\nimport Typography from '@material-ui/core/Typography'\nimport IconButton from '@material-ui/core/IconButton'\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport GridListTile from '@material-ui/core/GridListTile'\nimport GridListTileBar from '@material-ui/core/GridListTileBar'\nimport MobileStepper from '@material-ui/core/MobileStepper'\nimport Button from '@material-ui/core/Button'\n\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack'\nimport LabelIcon from '@material-ui/icons/Label'\nimport PauseIcon from '@material-ui/icons/PauseCircleFilled'\nimport PlayIcon from '@material-ui/icons/PlayCircleFilled'\nimport KeyboardArrowLeft from '@material-ui/icons/KeyboardArrowLeft'\nimport KeyboardArrowRight from '@material-ui/icons/KeyboardArrowRight'\n\nimport { makeStyles, useTheme } from '@material-ui/core/styles'\n\nimport Photo from './subViews/Photo'\nimport { formatDate } from '../../../lib/datelib'\nimport useComponentSize from '../../../lib/useComponentSize'\n\nimport style from './Slideshow.style'\n\nconst useStyles = makeStyles(style)\n\nconst Slideshow = ({ onCancel, photos, transition }) => {\n  const classes = useStyles()\n  const theme = useTheme()\n  const { activeStep, lastStep, handleForward, handleBack, paused, pause, play } = useStepper(photos.length, transition)\n  const [showXYTags, setShowXYTags] = useState(false)\n\n  const refImgWrap = useRef(null)\n  const { size: { height, width } } = useComponentSize(refImgWrap)\n\n  return (\n    <div className={classes.root}>\n      <CssBaseline />\n      <div ref={refImgWrap} className={classes.slideContainer}>\n        {photos.map((slide, idx) => (\n          <GridListTile\n            key={`slide-${idx}`}\n            className={classNames(\n              classes.slide,\n              activeStep === idx && classes.active,\n              lastStep === idx && classes.last\n            )}\n            onClick={() => setShowXYTags(!showXYTags)}\n            style={{\n              height,\n              width,\n              transition: theme.transitions.create(['opacity'], { duration: 1 / 4 * transition })\n            }}\n          >\n            <Photo photo={slide} className={classes.photo} showTags={showXYTags} />\n            <Typography className={classes.labelBadge} >\n            Tags: {showXYTags ? 'On ' : 'Off '}\n              <Badge color='secondary' badgeContent={photos[activeStep].tags.filter(tag => tag.coords).length}>\n                <LabelIcon color='inherit' />\n              </Badge>\n            </Typography>\n\n            <GridListTileBar\n              className={classes.titleBar}\n              titlePosition='top'\n              title={(\n                <Typography color='inherit' variant='caption'>\n                  <IconButton className={classes.iconButton} onClick={(e) => onCancel()}>\n                    <ArrowBackIcon />\n                  </IconButton>\n                  {formatDate(slide.takenOn)}\n                </Typography>\n              )}\n              subtitle={<em>{paused ? 'Paused' : '    '}</em>}\n              actionIcon={paused ? (\n                <IconButton className={classes.iconButton} onClick={(e) => {\n                  e.preventDefault()\n                  e.stopPropagation()\n                  play()\n                }}>\n                  <PlayIcon />\n                </IconButton>\n              ) : (\n                <IconButton className={classes.iconButton} onClick={(e) => {\n                  e.preventDefault()\n                  e.stopPropagation()\n                  pause()\n                }}>\n                  <PauseIcon />\n                </IconButton>\n              )}\n            />\n          </GridListTile>\n        ))}\n        <IconButton size='small' className={classes.manualBack} onClick={handleBack} color='inherit'>\n          {theme.direction === 'rtl' ? <KeyboardArrowRight /> : <KeyboardArrowLeft />}\n        </IconButton>\n        <IconButton size='small' className={classes.manualForward} onClick={handleForward} color='inherit'>\n          {theme.direction === 'rtl' ? <KeyboardArrowLeft /> : <KeyboardArrowRight />}\n        </IconButton>\n      </div>\n\n      <MobileStepper\n        steps={photos.length}\n        position='static'\n        activeStep={activeStep}\n        classes={{\n          root: classes.mobileStepper,\n          dotActive: classes.dotActive\n        }}\n        nextButton={\n          <Button color='inherit' size='small' onClick={handleForward} disabled={activeStep === photos.length - 1}>\n            Next\n            {theme.direction === 'rtl' ? <KeyboardArrowLeft /> : <KeyboardArrowRight />}\n          </Button>\n        }\n        backButton={\n          <Button color='inherit' size='small' onClick={handleBack} disabled={activeStep === 0}>\n            {theme.direction === 'rtl' ? <KeyboardArrowRight /> : <KeyboardArrowLeft />}\n            Back\n          </Button>\n        }\n      />\n    </div>\n  )\n}\n\nSlideshow.propTypes = {\n  // We might want to go full screen\n  isFullScreen: PropTypes.bool,\n  // This is just the basic shape of the photo object\n  photos: PropTypes.array,\n  transition: PropTypes.number,\n  onCancel: PropTypes.func.isRequired\n}\n\nSlideshow.defaultProps = {\n  transition: 5000,\n  isFullScreen: false,\n  slides: []\n}\n\nexport default Slideshow\n\n/**\n * Custom React Hook for all our timer handling\n */\nconst useStepper = (num, interval) => {\n  const [activeStep, setActiveStep] = useState(0)\n  const [paused, setPaused] = useState(false)\n  const [lastStep, setLastStep] = useState(0)\n  const timerRef = useRef()\n\n  const handleForward = () => {\n    setLastStep(activeStep)\n    if (activeStep + 1 >= num) setActiveStep(0)\n    else setActiveStep(activeStep + 1)\n    if (!paused) {\n      destroyTimer()\n      createTimer()\n    }\n  }\n  const handleBack = () => {\n    setLastStep(activeStep)\n    if (activeStep - 1 < 0) setActiveStep(num - 1)\n    else setActiveStep(activeStep - 1)\n    if (!paused) {\n      destroyTimer()\n      createTimer()\n    }\n  }\n\n  const pause = () => {\n    destroyTimer()\n    setPaused(true)\n  }\n  const play = () => {\n    setPaused(false)\n    destroyTimer()\n    createTimer()\n  }\n\n  const createTimer = () => {\n    timerRef.current = window.setInterval(\n      // We need to use the alternate notation for the useState function\n      // because setInterval will only have access to the activeStep it was\n      // initialized with\n      () => setActiveStep(oldStep => {\n        setLastStep(oldStep)\n        return (oldStep + 1 >= num) ? 0 : oldStep + 1\n      })\n      , interval\n    )\n  }\n  const destroyTimer = () => {\n    if (timerRef.current) window.clearInterval(timerRef.current)\n  }\n\n  useEffect(() => {\n    createTimer()\n    return () => {\n      destroyTimer()\n    }\n  }, []) // Pass in empty array to run useEffect only on mount.\n\n  return { activeStep, lastStep, handleForward, handleBack, setActiveStep, paused, pause, play }\n}\n","export default theme => ({\n  root: {\n    // maxWidth: 400,\n    height: '100%',\n    display: 'flex',\n    flexDirection: 'column'\n  },\n  swipeAble: {\n    height: '100%'\n  },\n  slideContainer: {\n    flexGrow: 1\n  },\n  titleBar: {\n    padding: theme.spacing(0, 1),\n    height: '35px!important'\n  },\n  mobileStepper: {\n    flexGrow: 0,\n    background: theme.palette.grey[800],\n    color: theme.palette.getContrastText(theme.palette.grey[800])\n  },\n  slide: {\n    top: 0,\n    zIndex: 0,\n    opacity: 0,\n    position: 'absolute',\n    display: 'block',\n    overflow: 'hidden',\n    width: '100%',\n    height: '100%',\n    minHeight: 300\n  },\n  dotActive: {\n    background: 'white'\n  },\n  iconButton: {\n    color: 'white'\n  },\n  active: {\n    zIndex: 5,\n    opacity: 1\n  },\n  last: {\n    opacity: 1,\n    zIndex: 4\n  },\n  tagContainer: {\n\n  },\n  labelBadge: {\n    color: 'white',\n    zIndex: 10,\n    position: 'absolute',\n    right: theme.spacing(2),\n    bottom: theme.spacing(1),\n    opacity: 0.8\n  },\n  tagChip: {\n    // height: theme.spacing(3),\n    marginRight: theme.spacing(1),\n    fontSize: 10,\n    height: theme.spacing(2),\n    padding: theme.spacing(0.5)\n  },\n  xyTagChip: {\n    position: 'absolute',\n    fontSize: theme.spacing(1),\n    height: theme.spacing(2)\n  },\n  manualBack: {\n    color: 'white',\n    zIndex: 10,\n    position: 'absolute',\n    transform: 'translateY(-50%)',\n    left: 0,\n    top: '50%'\n  },\n  manualForward: {\n    color: 'white',\n    zIndex: 10,\n    position: 'absolute',\n    transform: 'translateY(-50%)',\n    right: 0,\n    top: '50%'\n  }\n})\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport Button from '@material-ui/core/Button'\nimport Typography from '@material-ui/core/Typography'\nimport DialogActions from '@material-ui/core/DialogActions'\n\n// import MenuIcon from '@material-ui/icons/MenuIcon'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n\n})\n\nconst useStyles = makeStyles(style)\n\nconst CancelConfirm = ({ title, message, onConfirm, open }) => {\n  const classes = useStyles()\n  return (\n    <Dialog\n      className={classes.root}\n      disableBackdropClick\n      fullWidth\n      open={open}\n      disableEscapeKeyDown\n      maxWidth='xl'\n      aria-labelledby='confirmation-dialog-title'\n    >\n      <DialogTitle id='confirmation-dialog-title'>{title}</DialogTitle>\n      <DialogContent>\n        <Typography>\n          {message}\n        </Typography>\n\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={() => onConfirm(false)} color='primary'>\n      No\n        </Button>\n        <Button onClick={() => onConfirm(true)} color='secondary'>\n      Yes\n        </Button>\n      </DialogActions>\n    </Dialog>\n  )\n}\n\nCancelConfirm.propTypes = {\n  open: PropTypes.bool,\n  title: PropTypes.string.isRequired,\n  message: PropTypes.string.isRequired,\n  onConfirm: PropTypes.func.isRequired\n}\n\nexport default CancelConfirm\n","export default theme => ({\n  root: {\n    width: '100%'\n  },\n  tagContainer: {\n  },\n  formControl: {\n\n  },\n  actionButtons: {\n    textAlign: 'right'\n  },\n  noOptionsMessage: {\n    padding: theme.spacing(1, 2)\n  },\n  singleValue: {\n    fontSize: 16\n  },\n  placeholder: {\n    position: 'absolute',\n    left: 2,\n    fontSize: 16\n  },\n  input: {\n    display: 'flex',\n    padding: 0\n  },\n  valueContainer: {\n    display: 'flex',\n    flexWrap: 'wrap',\n    flex: 1,\n    alignItems: 'center',\n    overflow: 'hidden'\n  },\n  paper: {\n    position: 'absolute',\n    zIndex: 1,\n    marginTop: theme.spacing(1),\n    left: 0,\n    right: 0\n  }\n\n})\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport Typography from '@material-ui/core/Typography'\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport TagChip from '../tags/TagChip'\nimport style from './TagControl.style'\n\nconst useStyles = makeStyles(style)\n/**\n * Just to be clear: the state here is being stored as []\n */\nconst TagControl = ({ tags, label, tagConfig, className }) => {\n  const classes = useStyles()\n  // Filter to just this tag type\n  const tagValues = tags.filter(tag => tag.typeId === tagConfig.id && !tag.coords)\n\n  return (\n    <div className={classNames(classes.root, className)}>\n      <Typography variant='overline' className={classes.fieldTitle}>\n        {tagConfig.label}\n      </Typography>\n      <div className={classes.tagContainer}>\n        {tagValues.map((tag, idx) => (\n          <TagChip tag={tag} key={`tagchip${idx}`} color={tagConfig.color} />\n        ))}\n      </div>\n\n    </div>\n  )\n}\n\nTagControl.propTypes = {\n  className: PropTypes.string,\n  label: PropTypes.string,\n  tags: PropTypes.array,\n  tagConfig: PropTypes.object\n}\n\nexport default TagControl\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport {\n  TextField,\n  Typography\n} from '@material-ui/core'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { timestampToHTML5Input, HTML5InputToTimestamp } from '../../../../lib/datelib'\n\nconst style = theme => ({\n  root: {\n  },\n  rootEdit: {\n  },\n  formControl: {\n    width: '100%'\n  },\n  textBody: {\n    whiteSpace: 'pre-line'\n  },\n  actionButtons: {\n    textAlign: 'right'\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst DateControl = ({\n  label,\n  value,\n  hint,\n  onChange,\n  className\n}) => {\n  const classes = useStyles()\n  return (\n    <div className={classNames(classes.root, className)}>\n      <Typography variant='overline' className={classes.fieldTitle}>\n        {label}\n      </Typography>\n      <TextField\n        type='datetime-local'\n        fullWidth\n        value={timestampToHTML5Input(value)}\n        className={classes.textField}\n        onChange={(e) => onChange(HTML5InputToTimestamp(e.target.value))}\n      />\n      {hint && <Typography variant='caption' className={classes.hint}>{hint}</Typography>}\n    </div>\n  )\n}\n\nDateControl.propTypes = {\n  className: PropTypes.string,\n  label: PropTypes.string.isRequired,\n  hint: PropTypes.string,\n  value: PropTypes.string, // all timestamps come in as integerstrings\n  onChange: PropTypes.func.isRequired\n}\n\nexport default DateControl\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport Paper from '@material-ui/core/Paper'\nimport TextField from '@material-ui/core/TextField'\nimport Typography from '@material-ui/core/Typography'\nimport MenuItem from '@material-ui/core/MenuItem'\n\nimport Select from 'react-select'\nimport CreatableSelect from 'react-select/lib/Creatable'\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport TagChip from '../tags/TagChip'\nimport style from './TagControl.style'\nconst useStyles = makeStyles(style)\n\n/**\n * Just to be clear: the state here is being stored as []\n */\nconst TagControl = ({\n  tags, onChange,\n  hint, tagConfig, className\n}) => {\n  const classes = useStyles()\n  // console.log('TagControl Rnder', { tags, tagConfig })\n  const onSelectChange = (inputValue, { action, removedValue, option }) => {\n    // If this was the last tag then close the menu\n    switch (action) {\n      case 'clear':\n        onChange([])\n        break\n      case 'remove-value':\n        // Remember we need to potentially remove it from the old AND the new\n        onChange(tags.filter(val => val.id !== removedValue.value))\n        break\n      case 'select-option':\n        const newVal = {\n          ...tagConfig.values.find(tcv => tcv.id === option.value),\n          typeId: tagConfig.id\n        }\n        onChange([...tags, newVal])\n        break\n      case 'create-option':\n        const newLabel = inputValue.find(v => v.__isNew__).value\n        const newCreateVal = {\n          label: newLabel,\n          typeId: tagConfig.id\n        }\n        onChange([...tags, newCreateVal])\n        break\n      default:\n        break\n    }\n  }\n\n  const SingleValue = ({ removeProps, innerProps, data, ...props }) => {\n    // console.log('SingleValue PROPS', { removeProps, innerProps, data, props })\n    return (\n      <TagChip tag={data} onDelete={(e) => {\n        // console.log('EVENT', e)\n        removeProps.onClick()\n      }} color={tagConfig.color} edit />\n    )\n  }\n  SingleValue.propTypes = {\n    removeProps: PropTypes.any,\n    innerProps: PropTypes.any,\n    data: PropTypes.any\n  }\n\n  const MultiValue = ({ removeProps, innerProps, data, ...props }) => {\n    // console.log('MultiValue PROPS', { removeProps, innerProps, data, props })\n    return (\n      <TagChip tag={data} onDelete={(e) => {\n        // console.log('EVENT', e)\n        removeProps.onClick()\n      }} color={tagConfig.color} edit />\n    )\n  }\n  MultiValue.propTypes = {\n    removeProps: PropTypes.any,\n    innerProps: PropTypes.any,\n    data: PropTypes.any\n  }\n\n  // Filter to just this tag type\n  const tagValues = tags.filter(tag => tag.typeId === tagConfig.id && !tag.coords)\n  // Now format it as {label, value: id} for react-select\n  const selectOptions = tagValues.map(val => ({ label: val.label, value: val.id }))\n\n  // Filter out things we haven't chosen yet\n  // Also transform the options into a label/value pair for react-select\n  const remainingTags = tagConfig.values\n    .filter(val => tagValues.map(t => t.id).indexOf(val.id) === -1)\n    .map(val => ({ label: val.label, value: val.id }))\n\n  // console.log('TAG DEBUG', { value, tagValues, tagConfig })\n\n  return (\n    <div className={classNames(classes.root, className)}>\n      <Typography variant='overline' className={classes.fieldTitle}>\n        {tagConfig.label}\n      </Typography>\n      {!tagConfig.allowAdditions && (\n        <Select\n          options={remainingTags}\n          classes={classes}\n          isFocused\n          components={{\n            Control,\n            Menu,\n            //   MultiValue,\n            NoOptionsMessage,\n            Option,\n            Placeholder,\n            //   SingleValue,\n            ValueContainer\n          }}\n          deleteRemoves\n          value={selectOptions}\n          isClearable={false}\n          onChange={onSelectChange}\n          placeholder='Select Tags'\n          isMulti\n          isSearchable\n        />\n      ) }\n      { tagConfig.allowAdditions && (\n        <CreatableSelect\n          options={remainingTags}\n          classes={classes}\n          isFocused\n          deleteRemoves\n          components={{\n            Control,\n            Menu,\n            //   MultiValue,\n            NoOptionsMessage,\n            Option,\n            Placeholder,\n            //   SingleValue,\n            ValueContainer\n          }}\n          value={selectOptions}\n          isClearable={false}\n          onChange={onSelectChange}\n          placeholder='Select Tags'\n          isMulti\n          isSearchable\n        />\n      )}\n      {hint && <Typography variant='caption' className={classes.hint}>{hint}</Typography>}\n    </div>\n  )\n}\n\nTagControl.propTypes = {\n  className: PropTypes.string,\n  hint: PropTypes.string,\n  tags: PropTypes.array,\n  onChange: PropTypes.func.isRequired,\n  tagConfig: PropTypes.object\n}\n\nexport default TagControl\n\nfunction Control (props) {\n  // console.log('CONTROL PROPS', props)\n  return (\n    <TextField\n      fullWidth\n      InputProps={{\n        inputComponent,\n        inputProps: {\n          className: props.selectProps.classes.input,\n          inputRef: props.innerRef,\n          children: props.children,\n          // innerProps: {\n          onMouseDown: (e) => {\n            props.innerProps.onMouseDown(e)\n          },\n          onTouchEnd: (e) => {\n            props.innerProps.onTouchEnd(e)\n          }\n          // }\n          // ...props.innerProps\n        }\n      }}\n      {...props.selectProps.textFieldProps}\n    />\n  )\n}\n\nconst NoOptionsMessage = ({ innerProps, selectProps, children }) => (\n  <Typography\n    color='textSecondary'\n    className={selectProps.classes.noOptionsMessage}\n    {...innerProps}\n  >\n    {children}\n  </Typography>\n)\n\nconst Menu = ({ selectProps, innerProps, children }) => (\n  <Paper square className={selectProps.classes.paper} {...innerProps}>\n    {children}\n    {/* {console.log('MENU PROPS', { selectProps, innerProps, children })} */}\n  </Paper>\n)\n\nconst inputComponent = ({ inputRef, ...props }) => <div ref={inputRef} {...props} />\n\nconst Placeholder = (props) => (\n  <Typography\n    color='textSecondary'\n    className={props.selectProps.classes.placeholder}\n    {...props.innerProps}\n  >\n    {props.children}\n  </Typography>\n)\n\nconst Option = ({ innerRef, isFocused, isSelected, innerProps, children }) => (\n  <MenuItem\n    buttonRef={innerRef}\n    selected={isFocused}\n    component='div'\n    style={{ fontWeight: isSelected ? 500 : 400 }}\n    {...innerProps}\n  >\n    {children}\n  </MenuItem>\n)\n\nconst ValueContainer = ({ selectProps, children }) => (\n  <div className={selectProps.classes.valueContainer}>{children}</div>\n)\nValueContainer.propTypes = {\n  selectProps: PropTypes.any,\n  children: PropTypes.any\n}\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\n// import Typography from '@material-ui/core/Typography'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport Typography from '@material-ui/core/Typography'\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogActions from '@material-ui/core/DialogActions'\nimport Button from '@material-ui/core/Button'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport IconButton from '@material-ui/core/IconButton'\n\nimport CloseIcon from '@material-ui/icons/Close'\nimport TagControl from '../controls/TagControl'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n  },\n  dlgContent: {\n    // position: 'relative',\n    // maxWidth: '200px',\n    overflowY: 'visible!important',\n    paddingBottom: 300\n    // overflowX: 'hidden'\n  },\n  title: {\n    width: '100%',\n    margin: 0,\n    display: 'flex',\n    padding: theme.spacing(2)\n  },\n  dlgTitle: {\n    flexGrow: 1\n  },\n  closeButton: {\n    color: theme.palette.grey[500]\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst TagEdit = ({ open, title, onOk, onCancel, tags, tagConfig }) => {\n  const classes = useStyles()\n  const [value, setValue] = useState(tags)\n  return (\n    <Dialog\n      className={classes.root}\n      scroll='body'\n      fullScreen\n      open={open}\n      onClose={() => onOk(value)}\n    >\n      <DialogTitle className={classes.title} disableTypography>\n        <Typography className={classes.dlgTitle}>{title}</Typography>\n        <IconButton className={classes.closeButton} onClick={onCancel}>\n          <CloseIcon />\n        </IconButton>\n      </DialogTitle>\n      <DialogContent className={classes.dlgContent}>\n        <TagControl\n          className={classes.field}\n          tags={value}\n          tagConfig={tagConfig}\n          onChange={setValue}\n        />\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={onCancel}>Cancel</Button>\n        <div style={{ flexGrow: 1 }} />\n        <Button onClick={() => setValue(tags)}>Reset</Button>\n        <Button onClick={() => onOk(value)}>Ok</Button>\n      </DialogActions>\n    </Dialog>\n  )\n}\n\nTagEdit.propTypes = {\n  open: PropTypes.bool,\n  title: PropTypes.string,\n  onOk: PropTypes.func,\n  onCancel: PropTypes.func,\n  tags: PropTypes.array.isRequired,\n  tagConfig: PropTypes.object.isRequired\n}\n\nexport default TagEdit\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport Typography from '@material-ui/core/Typography'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { formatDate } from '../../../../lib/datelib'\n\nconst style = theme => ({\n  root: { },\n  rootEdit: { },\n  formControl: {\n    width: '100%'\n  },\n  textBody: {\n    whiteSpace: 'pre-line'\n  },\n  actionButtons: {\n    textAlign: 'right'\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst DateView = ({\n  label,\n  value,\n  className\n}) => {\n  const classes = useStyles()\n  return (\n    <div className={classNames(classes.root, className)}>\n      <Typography variant='overline' className={classes.fieldTitle}>\n        {label}\n      </Typography>\n      <Typography variant='body1' className={classes.hint}>{value ? formatDate(value) : ''}</Typography>\n    </div>\n  )\n}\n\nDateView.propTypes = {\n  className: PropTypes.string,\n  label: PropTypes.string.isRequired,\n  value: PropTypes.string\n}\n\nexport default DateView\n","import React, { useContext, useState } from 'react'\nimport PropTypes from 'prop-types'\n\nimport Typography from '@material-ui/core/Typography'\nimport Divider from '@material-ui/core/Divider'\nimport List from '@material-ui/core/List'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemText from '@material-ui/core/ListItemText'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport TagView from '../controls/TagView'\nimport ShortLongText from '../controls/ShortLongText'\nimport DateControl from '../controls/DateControl'\nimport UserListItem from '../controls/UserListItem'\nimport TagClass from '../../../../lib/Tags'\nimport BigTextEdit from '../dialogs/BigTextEdit'\nimport BigText from '../dialogs/BigText'\nimport TagEdit from '../dialogs/TagEdit'\n\nimport { SeriesContext } from '../../contexts'\nimport DateView from '../controls/DateView'\n\nconst style = theme => ({\n  root: {\n    height: '90%',\n    width: '85%'\n  },\n  dlgTitleContainer: {\n    display: 'flex',\n    padding: 0\n  },\n  catTagTitle: {\n    marginTop: theme.spacing(2)\n  },\n  dlgTitle: {\n    flexGrow: 1,\n    paddingTop: theme.spacing(2),\n    paddingBottom: theme.spacing(1),\n    paddingLeft: theme.spacing(3)\n  },\n  field: {\n    marginBottom: theme.spacing(2)\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst DIALOGS = {\n  NOTEEDIT: 'noteEdit',\n  NOTEVIEW: 'noteView',\n  PHOTOTAKEN: 'taken',\n  TAGEDIT: 'tag',\n  CANCEL: 'cancel'\n}\n\nconst PhotoInfo = ({ canEdit, photo, delta, onChange }) => {\n  const classes = useStyles()\n  const { seriesConfig } = useContext(SeriesContext)\n  const [{ activeDialog, activeDialogContext }, setActiveDialog] = useState({})\n\n  const tagInst = new TagClass(seriesConfig, delta.tags || photo.tags)\n\n  let metaKeys = []\n  try {\n    metaKeys = photo.meta ? Object.keys(JSON.parse(photo.meta)) : []\n  }\n  catch (e) {\n    console.error(e)\n  }\n  return (\n    <div>\n      {photo.createdUser && (\n        <React.Fragment>\n          <UserListItem\n            user={photo.createdUser}\n            onAvatarClick={() => seriesConfig.onAvatarClick(photo.createdUser.username)}\n            secondary='uploaded this photo'\n          />\n          <Divider />\n        </React.Fragment>\n      )}\n      {canEdit ? (\n        <DateControl\n          className={classes.field}\n          label='Photo taken on'\n          value={delta.takenOn || photo.takenOn}\n          onChange={takenOn => onChange({ takenOn })}\n          canEdit={canEdit}\n        />\n      )\n        : (\n          <DateView\n            label='Photo taken on'\n            value={delta.takenOn || photo.takenOn}\n          />\n        )}\n\n      {(canEdit || photo.note) && (\n        <ShortLongText\n          label='Photo Note'\n          text={delta.note || photo.note}\n          onClick={() => {\n            if (canEdit) setActiveDialog({ activeDialog: DIALOGS.NOTEEDIT })\n            else setActiveDialog({ activeDialog: DIALOGS.NOTEVIEW })\n          }}\n        />\n      )}\n      <Typography variant='subtitle1' className={classes.catTagTitle}>Category tags</Typography>\n      <Divider />\n      {tagInst.seriesConfig.getNonXYTagTypes().map((tt, idx) => (\n        <div\n          key={`tagtype-${idx}`}\n          onClick={() => canEdit ? setActiveDialog({ activeDialog: DIALOGS.TAGEDIT, activeDialogContext: tt }) : null}\n        >\n          <TagView\n            className={classes.field}\n            label={tt.label}\n            tags={delta.tags || photo.tags}\n            tagConfig={tt}\n          />\n        </div>\n      ))}\n\n      {metaKeys.length > 0 && Object.keys(seriesConfig.meta).length > 0 && (\n        <React.Fragment>\n          <Typography className={classes.heading}>Metadata</Typography>\n          <Divider />\n          <List className={classes.list}>\n            {metaKeys.map((key, idx) => seriesConfig.meta[key] ? (\n              <ListItem key={`metadata${idx}`}>\n                <ListItemText\n                  primary={seriesConfig.meta[key].label}\n                  secondary={seriesConfig.meta[key].render(photo.meta[key])}\n                />\n              </ListItem>\n            ) : null\n            )}\n          </List>\n        </React.Fragment>\n      )}\n      {activeDialog && activeDialog === DIALOGS.NOTEEDIT && (\n        <BigTextEdit\n          open\n          multiline\n          onOk={note => {\n            onChange({ note })\n            setActiveDialog({})\n          }}\n          title='Edit Photo Note'\n          body={delta.note || photo.note}\n        />\n      )}\n      {activeDialog && activeDialog === DIALOGS.NOTEVIEW && (\n        <BigText\n          open\n          multiline\n          onClose={() => setActiveDialog({})}\n          title='Photo Note'\n          body={delta.note || photo.note}\n        />\n      )}\n      {activeDialog && activeDialog === DIALOGS.TAGEDIT && (\n        <TagEdit\n          open\n          title={`Edit Tags: ${activeDialogContext.label}`}\n          onOk={tags => {\n            setActiveDialog({})\n            onChange({ tags })\n          }}\n          onCancel={() => setActiveDialog({})}\n          tags={delta.tags || photo.tags}\n          tagConfig={activeDialogContext}\n        />\n      )}\n    </div>\n  )\n}\n\nPhotoInfo.propTypes = {\n  canEdit: PropTypes.bool,\n  onChange: PropTypes.func.isRequired,\n  photo: PropTypes.object.isRequired,\n  delta: PropTypes.object.isRequired\n}\n\nexport default PhotoInfo\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\n\nimport Button from '@material-ui/core/Button'\nimport Dialog from '@material-ui/core/Dialog'\nimport IconButton from '@material-ui/core/IconButton'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport Typography from '@material-ui/core/Typography'\nimport DialogActions from '@material-ui/core/DialogActions'\n\nimport CloseIcon from '@material-ui/icons/Close'\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport CancelConfirm from '../dialogs/CancelConfirm'\n\nimport PhotoInfoInner from './PhotoInfoInner'\n\nconst style = theme => ({\n  root: {\n    height: '90%',\n    width: '85%'\n  },\n  dlgTitleContainer: {\n    display: 'flex',\n    padding: 0\n  },\n  dlgTitle: {\n    flexGrow: 1,\n    paddingTop: theme.spacing(2),\n    paddingBottom: theme.spacing(1),\n    paddingLeft: theme.spacing(3)\n  },\n  field: {\n    marginBottom: theme.spacing(2)\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst DIALOGS = {\n  NOTEEDIT: 'noteEdit',\n  NOTEVIEW: 'noteView',\n  PHOTOTAKEN: 'taken',\n  TAGEDIT: 'tag',\n  CANCEL: 'cancel'\n}\n\nconst PhotoInfo = ({ canEdit, photo, onCancel, onOk, open }) => {\n  const classes = useStyles()\n  const [activeDialog, setActiveDialog] = useState(null)\n  const [delta, setDelta] = useState({})\n\n  const dirty = delta && Object.keys(delta).length > 0\n\n  return (\n    <Dialog\n      fullScreen\n      fullWidth\n      onClose={() => {\n        if (dirty) setActiveDialog(DIALOGS.CANCEL)\n        else onCancel()\n      }}\n      aria-labelledby='customized-dialog-title'\n      open={open}\n    >\n      <DialogTitle disableTypography className={classes.dlgTitleContainer}>\n        <Typography variant='h5' className={classes.dlgTitle}>\n          Photo Properties\n        </Typography>\n        <IconButton onClick={onCancel}>\n          <CloseIcon />\n        </IconButton>\n      </DialogTitle>\n      <DialogContent>\n        <PhotoInfoInner\n          photo={photo}\n          delta={delta}\n          onChange={newDelta => setDelta({ ...delta, ...newDelta })}\n          canEdit={canEdit}\n        />\n      </DialogContent>\n\n      <DialogActions>\n        {!canEdit && (\n          <Button onClick={onCancel} color='primary'>\n            Ok\n          </Button>\n        )}\n        {canEdit && !dirty && (\n          <Button onClick={onCancel} color='primary'>\n            Back\n          </Button>\n        )}\n        {canEdit && dirty && (\n          <React.Fragment>\n            <Button onClick={() => setActiveDialog(DIALOGS.CANCEL)} color='primary'>\n              Cancel\n            </Button>\n            <Button onClick={() => setDelta({})} color='primary'>\n              Reset\n            </Button>\n            <Button onClick={() => onOk(delta)} color='primary'>\n              Ok\n            </Button>\n          </React.Fragment>\n        )}\n      </DialogActions>\n      {activeDialog && activeDialog === DIALOGS.CANCEL && (\n        <CancelConfirm\n          open\n          title='Lose unsaved changes?'\n          message='You will lose any changes you made to this form'\n          onConfirm={confirm => {\n            setActiveDialog(null)\n            if (confirm) onCancel()\n          }}\n        />\n      )}\n    </Dialog>\n  )\n}\n\nPhotoInfo.propTypes = {\n  canEdit: PropTypes.bool,\n  onCancel: PropTypes.func.isRequired,\n  onOk: PropTypes.func.isRequired,\n  open: PropTypes.bool,\n  photo: PropTypes.object.isRequired\n}\n\nexport default PhotoInfo\n","import React, { useState, useContext } from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\n\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport Button from '@material-ui/core/Button'\nimport MobileStepper from '@material-ui/core/MobileStepper'\nimport Typography from '@material-ui/core/Typography'\nimport AppBar from '@material-ui/core/AppBar'\nimport Toolbar from '@material-ui/core/Toolbar'\nimport IconButton from '@material-ui/core/IconButton'\nimport Badge from '@material-ui/core/Badge'\nimport Chip from '@material-ui/core/Chip'\n\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack'\nimport InfoIcon from '@material-ui/icons/Info'\nimport LabelIcon from '@material-ui/icons/Label'\n\nimport { makeStyles, useTheme } from '@material-ui/core/styles'\n\nimport PhotoInfo from './subViews/PhotoInfo'\nimport Photo from './subViews/Photo'\n\nimport { formatDate } from '../../../lib/datelib'\nimport Tags from '../../../lib/Tags'\nimport SwipeableViews from 'react-swipeable-views'\nimport { SeriesContext } from '../contexts'\n\nimport style from './PhotoViewTool.style'\nconst useStyles = makeStyles(style)\n\nconst STATES = {\n  VIEWPIC: 0,\n  SHOWINFO: 1,\n  SHOWTAGS: 2,\n  EDITTAGS: 3,\n  FIRSTAGEDIT: 4\n}\n\nconst PhotoViewTool = ({ photos, initPhotoId, onMenuBack, onUpdatePhoto, newPhoto }) => {\n  const classes = useStyles()\n  const theme = useTheme()\n  const { series, seriesConfig, ac } = useContext(SeriesContext)\n  const sortedPhotos = [...photos]\n  sortedPhotos.sort((a, b) => parseInt(b.takenOn, 10) - parseInt(a.takenOn, 10))\n  const [activePhoto, setActivePhoto] = useState(initPhotoId ? sortedPhotos.findIndex(p => p.id === initPhotoId) : 0)\n  // This is a special copy of the photo so we can play around with the XY tags and undo\n  // if we need to\n  const photo = photos[activePhoto]\n  const [delta, setDelta] = useState(newPhoto ? photo : {})\n  const [mode, setMode] = useState({\n    current: newPhoto ? STATES.FIRSTAGEDIT : STATES.VIEWPIC,\n    last: null\n  })\n\n  const tagsClass = new Tags(seriesConfig, delta.tags || photo.tags)\n\n  const changeMode = (desired) => {\n    setMode({ current: desired, last: mode.current })\n  }\n\n  const onCommitTags = () => {\n    changeMode(STATES.SHOWTAGS)\n    onUpdatePhoto(photo, { id: photo.id, ...delta })\n  }\n\n  const onCommitTagsFirst = () => {\n    onUpdatePhoto(photo, { id: photo.id, ...delta })\n    onMenuBack()\n  }\n\n  const onCancelTagEdit = () => {\n    changeMode(STATES.SHOWTAGS)\n    setDelta(photo)\n  }\n\n  const photoClick = (e) => {\n    if (mode.current === STATES.VIEWPIC) {\n      e.preventDefault()\n      e.stopPropagation()\n      changeMode(STATES.SHOWINFO)\n    }\n  }\n\n  const can = {\n    update: ac.canUser('update', series, 'series') ||\n            ac.canUser('update', photo, 'photo')\n  }\n\n  return (\n    <div className={classes.root}>\n      <CssBaseline /> {/* You only need this in a root element. Don't put it anywhere else in the dom */}\n      <AppBar position='static' className={classNames(classes.appBar, mode.current !== STATES.VIEWPIC ? classes.appBarEdit : null)}>\n        <Toolbar>\n          {mode.current !== STATES.FIRSTAGEDIT && (\n            <IconButton\n              className={classes.menuButton}\n              color='inherit'\n              aria-label='Menu'\n              onClick={() => onMenuBack()}\n            >\n              <ArrowBackIcon />\n            </IconButton>\n          )}\n          <div className={classes.grow}>\n            <Typography variant='subtitle2' color='inherit' >\n              {newPhoto ? 'Add Tags' : `Photo View (${activePhoto + 1}/${photos.length})`}\n            </Typography>\n            <Typography variant='subtitle2' color='inherit'>\n              {formatDate(photo.takenOn, 'lll')}\n            </Typography>\n          </div>\n\n          { mode.current === STATES.EDITTAGS &&\n          <Button color='inherit' onClick={onCancelTagEdit}>\n            Cancel\n          </Button>\n          }\n\n          { mode.current === STATES.EDITTAGS &&\n          <Button color='inherit' onClick={onCommitTags}>\n            Save\n          </Button>\n          }\n          { mode.current === STATES.FIRSTAGEDIT &&\n          <Button color='inherit' onClick={onCommitTagsFirst}>\n            Next\n          </Button>\n          }\n\n          { can.update && mode.current === STATES.SHOWTAGS &&\n          <Button color='inherit' onClick={() => changeMode(STATES.EDITTAGS)}>\n            Edit\n          </Button>\n          }\n\n          { (mode.current !== STATES.EDITTAGS && mode.current !== STATES.FIRSTAGEDIT) &&\n          <IconButton color='inherit'\n            className={classNames(classes.tagButton, mode.current === STATES.SHOWTAGS && classes.activeButton)}\n            onClick={() => changeMode(mode.current === STATES.SHOWTAGS ? STATES.VIEWPIC : STATES.SHOWTAGS)}\n          >\n            <Badge className={classes.margin} badgeContent={tagsClass.getXYTags().length} color='primary'>\n              <LabelIcon color='inherit' />\n            </Badge>\n          </IconButton>\n          }\n\n          { (mode.current !== STATES.EDITTAGS && mode.current !== STATES.FIRSTAGEDIT) &&\n          <IconButton color='inherit'\n            className={classNames(classes.infoButton, mode.current === STATES.SHOWINFO && classes.activeButton)}\n            onClick={() => changeMode(mode.current === STATES.SHOWINFO ? STATES.VIEWPIC : STATES.SHOWINFO)}\n          >\n            <InfoIcon />\n          </IconButton>\n          }\n\n        </Toolbar>\n      </AppBar>\n      <div className={classes.inner} onClick={photoClick}>\n        <SwipeableViews\n          axis={theme.direction === 'rtl' ? 'x-reverse' : 'x'}\n          index={activePhoto}\n          containerStyle={{ height: '100%' }}\n          style={{ height: '100%' }}\n          disabled={mode.current !== STATES.VIEWPIC}\n          onChangeIndex={(val) => setActivePhoto(val)}\n          enableMouseEvents\n        >\n          {sortedPhotos.map((photoidx, idx) => (\n            <div className={classes.photoWrapper} key={`swipeshowpic-${idx}`}>\n              <Photo\n                showTags={mode.current === STATES.SHOWTAGS}\n                photo={{ ...photoidx, ...delta }}\n                edit={can.update && (mode.current === STATES.EDITTAGS || mode.current === STATES.FIRSTAGEDIT)}\n                onChange={setDelta}\n                onCommitTags={onCommitTags}\n              />\n            </div>\n          ))}\n        </SwipeableViews>\n\n        {mode.current === STATES.VIEWPIC && (\n          <MobileStepper\n            steps={sortedPhotos.length}\n            position='bottom'\n            activeStep={activePhoto}\n            classes={{\n              root: classes.mobileStepper,\n              dots: classes.dots,\n              dot: classes.dot,\n              dotActive: classes.dotActive\n            }}\n          />\n        )}\n      </div>\n      <PhotoInfo\n        open={mode.current === STATES.SHOWINFO}\n        photo={photo}\n        canEdit={can.update}\n        onOk={(newDelta) => {\n          onUpdatePhoto(photo, { id: photo.id, ...newDelta })\n          changeMode(mode.last)\n        }}\n        onCancel={() => changeMode(mode.last)}\n      />\n      { (mode.current === STATES.EDITTAGS || mode.current === STATES.FIRSTAGEDIT) && (\n        <Chip\n          label='Tap to tag features...'\n          onClick={() => {}}\n          className={classes.tipChip}\n        />\n      )}\n    </div>\n  )\n}\n\nPhotoViewTool.propTypes = {\n  photos: PropTypes.array.isRequired,\n  initPhotoId: PropTypes.string,\n  newPhoto: PropTypes.bool,\n  // Now some action functions\n  onMenuBack: PropTypes.func.isRequired,\n  onUpdatePhoto: PropTypes.func.isRequired\n}\n\nexport default PhotoViewTool\n","export default theme => ({\n  root: {\n    display: 'flex',\n    height: '100%',\n    flexDirection: 'column',\n    overflow: 'hidden'\n  },\n  appBar: {\n    flexGrow: 0\n  },\n  appBarEdit: {\n    color: theme.palette.secondary.contrastText,\n    background: theme.palette.secondary.main\n  },\n  grow: {\n    flexGrow: 1\n  },\n  photoWrapper: {\n    height: '100%'\n  },\n  inner: {\n    flex: '1 1',\n    position: 'relative'\n  },\n  tabMenu: {\n    marginTop: theme.spacing(7)\n  },\n  tipChip: {\n    position: 'absolute',\n    zIndex: 11,\n    bottom: 20,\n    left: '50%',\n    opacity: 0.6,\n    transform: 'translateX(-50%)'\n  },\n  mobileStepper: {\n    background: 'none'\n  },\n  dots: {\n    margin: '0 auto'\n  },\n  dot: {\n    border: '1px solid #FFFFFF77'\n  },\n  dotActive: {\n    background: theme.palette.secondary.main\n  },\n  // tagButton: {\n  //   zIndex: 10,\n  //   color: 'white',\n  //   position: 'absolute',\n  //   fontSize: '2.5rem',\n  //   top: 10,\n  //   left: 10,\n  //   opacity: 0.8\n  // },\n  // infoButton: {\n  //   zIndex: 10,\n  //   color: 'white',\n  //   position: 'absolute',\n  //   top: 10,\n  //   right: 10,\n  //   opacity: 0.8\n  // },\n  activeButton: {\n    color: theme.palette.primary.main,\n    opacity: 1\n  }\n})\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport Slider from '@material-ui/lab/Slider'\n// import { Menu as MenuIcon } from '@material-ui/icons'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n    color: 'white',\n    zIndex: 10,\n    display: 'flex',\n    flexDirection: 'column',\n    position: 'absolute',\n    height: '50%',\n    top: '45%',\n    left: '0',\n    transform: 'translateY(-50%)'\n  },\n  sliderLabel: {\n    display: 'block',\n    flexGrow: 1,\n    textAlign: 'center',\n    padding: theme.spacing(3, 0, 3, 0),\n    textShadow: '0 0 5px black, 0 0 5px black'\n  },\n  vertical: {\n    padding: '0px 31px!important',\n    width: '4px!important'\n  },\n  rail: {\n    width: `4px!important`,\n    background: theme.palette.primary.dark,\n    boxShadow: '0 0 10px 5px black'\n  },\n  track: {\n    width: `4px!important`,\n    background: theme.palette.primary.main\n  },\n  thumb: {\n    // transform: 'translate(50%, -50%)',\n    background: theme.palette.primary.main,\n    border: `1px solid ${theme.palette.primary.dark}`,\n    marginLeft: '-8px !important',\n    width: 20,\n    height: 20\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst PhotoFadeSlider = ({ defaultValue, onChange }) => {\n  const classes = useStyles()\n  // we control the state internally so we get a smooth experience\n  const [slider, setSlider] = useState(defaultValue)\n\n  const onSliderMove = (event, value) => {\n    setSlider(value)\n    // send it back if we need to\n    onChange(value)\n  }\n\n  return (\n    <div className={classes.root}>\n      <Typography className={classes.sliderLabel} color='inherit' variant='caption'>New</Typography>\n      <Slider\n        classes={{\n          vertical: classes.vertical,\n          rail: classes.rail,\n          track: classes.track,\n          thumb: classes.thumb\n        }}\n        value={slider}\n        aria-labelledby='label'\n        onChange={onSliderMove}\n        orientation='vertical'\n      />\n      <Typography className={classes.sliderLabel} color='inherit' variant='caption'>Reference</Typography>\n    </div>\n  )\n}\n\nPhotoFadeSlider.propTypes = {\n  defaultValue: PropTypes.number,\n  onChange: PropTypes.func\n}\n\nPhotoFadeSlider.defaultProps = {\n  defaultValue: 100,\n  onChange: () => {}\n}\n\nexport default PhotoFadeSlider\n","import React, { useState, useContext } from 'react'\nimport PropTypes from 'prop-types'\n\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport Snackbar from '@material-ui/core/Snackbar'\nimport Button from '@material-ui/core/Button'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport Photo from './subViews/Photo'\nimport PhotoFadeSlider from './controls/PhotoFadeSlider'\nimport style from './PhotoReviewTool.style'\n\nimport { SeriesContext } from '../contexts'\nconst useStyles = makeStyles(style)\n\nconst PhotoReviewTool = ({\n  captured, defaultRefPhotoId,\n  onConfirm, onCancel, onRetry, dataUrl\n}) => {\n  const { series } = useContext(SeriesContext)\n  const photos = series && series.photos ? series.photos : null\n  const classes = useStyles()\n\n  const newRefPhoto = defaultRefPhotoId\n    ? photos.find(p => p.id === defaultRefPhotoId)\n    : photos && photos.length > 0 ? photos[0] : null\n\n  const [refPhoto, setRefPhoto] = useState(newRefPhoto)\n  const [slider, setSlider] = useState(100)\n\n  if (!captured) return 'Loading...'\n\n  return (\n    <div className={classes.root}>\n      <CssBaseline />\n      { Boolean(refPhoto) && (\n        <PhotoFadeSlider defaultValue={100} onChange={setSlider} />\n      )}\n\n      <div className={classes.captured}>\n        <Photo\n          opacity={slider / 100}\n          className={classes.capturedContainer}\n          photo={captured}\n          dataUrl={dataUrl}\n        />\n      </div>\n      { Boolean(refPhoto) && (\n        <div className={classes.reference} >\n          <Photo\n            className={classes.referenceContainer}\n            photo={refPhoto}\n          />\n        </div>\n      )}\n      <Snackbar\n        open\n        autoHideDuration={null}\n        ContentProps={{\n          'aria-describedby': 'snackbar-fab-message-id',\n          className: classes.snackbarContent\n        }}\n        message={<span id='snackbar-fab-message-id'>Keep this photo?</span>}\n        action={<div>\n          <Button color='inherit' size='small' onClick={onCancel}>\n                Cancel\n          </Button>\n          {Boolean(onRetry) && (\n            <Button color='inherit' size='small' onClick={onRetry}>\n          Retry\n            </Button>\n          )}\n\n          <Button color='inherit' size='small' onClick={onConfirm}>\n                Keep\n          </Button>\n        </div>\n        }\n        className={classes.snackbar}\n      />\n    </div>\n  )\n}\n\nPhotoReviewTool.propTypes = {\n  defaultRefPhotoId: PropTypes.string,\n  captured: PropTypes.object,\n  dataUrl: PropTypes.string.isRequired,\n  // Now some functions\n  onConfirm: PropTypes.func.isRequired,\n  onCancel: PropTypes.func.isRequired,\n  onRetry: PropTypes.func // only for camera\n\n}\n\nexport default PhotoReviewTool\n","export default theme => ({\n  root: {\n    background: 'rgb(150,150, 150)',\n    // border: '5px solid red',\n    height: '100%',\n    width: '100%'\n  },\n  capturedContainer: {\n    position: 'absolute',\n    zIndex: 1,\n    height: '100%',\n    width: '100%'\n  },\n  referenceContainer: {\n    position: 'absolute',\n    zIndex: 0,\n    height: '100%',\n    width: '100%'\n  },\n  captured: {\n\n  },\n  reference: {\n\n  },\n  referenceTextContainer: {\n    width: '100%',\n    display: 'flex',\n    color: 'white',\n    background: 'rgba(0,0,0,0.5)',\n    padding: theme.spacing(3),\n    position: 'absolute',\n    zIndex: 4,\n    top: 0\n  },\n  newText: {\n    flexGrow: 1,\n    color: 'white',\n    textShadow: '1 1 1 black',\n    textAlign: 'right'\n  },\n  refText: {\n    flexGrow: 1,\n    color: 'white',\n    textShadow: '1 1 1 black'\n  }\n})\n","import { useState, useEffect, useRef } from 'react'\n\nexport const useCamera = (onCapture, width, height) => {\n  const [cameraError, setCameraError] = useState(false)\n  const [cameraOnline, setCameraOnline] = useState(false)\n  const camRef = useRef()\n\n  useEffect(() => {\n    camRef.current = new Webcam(\n      document.getElementById('webcam'),\n      document.createElement('canvas')\n    )\n    camRef.current.setup(\n      height || window.innerWidth, // width\n      width || window.innerHeight // height\n    )\n      .then((data) => {\n        setCameraOnline(true)\n      })\n      .catch((e) => {\n        console.error(e)\n        setCameraError(true)\n      })\n  }, [width, height])\n\n  const captureImage = () => {\n    if (camRef.current && cameraOnline) {\n      const capturedData = camRef.current.takeBlobPhoto({ type: 'jpeg', quality: 1 })\n      onCapture({ ...capturedData, name: 'upload.jpg', ext: 'jpg' })\n    }\n  }\n\n  const captureRawData = () => {\n    if (camRef.current && cameraOnline) {\n      const capturedData = camRef.current.takeImageData()\n      onCapture(capturedData)\n    }\n  }\n\n  return { cameraError, captureImage, cameraOnline, captureRawData }\n}\n\nclass Webcam {\n  constructor (webcamElement, canvasElement) {\n    this.webcamElement = webcamElement\n    this.canvasElement = canvasElement\n\n    if (window.location.protocol !== 'https:' && window.location.hostname !== 'localhost') {\n      console.warn('getUserMedia() must be run from a secure origin: https or localhost.\\nChanging protocol to https.')\n    }\n\n    if (!navigator.mediaDevices && !navigator.getUserMedia) {\n      console.warn(`Your browser doesn't support navigator.mediaDevices.getUserMedia and navigator.getUserMedia.`)\n    }\n  }\n\n  adjustVideoSize (width, height) {\n    const aspectRatio = width / height\n    if (width >= height) {\n      this.webcamElement.width = aspectRatio * this.webcamElement.height\n    }\n    else if (width < height) {\n      this.webcamElement.height = this.webcamElement.width / aspectRatio\n    }\n  }\n\n  async destroy () {\n    try {\n      this.webcamElement.srcObject.getTracks()[0].stop()\n      this.webcamElement = null\n      this.canvasElement = null\n    }\n    catch (e) {\n      console.error(e)\n    }\n  }\n\n  async setup (width, height) {\n    return new Promise((resolve, reject) => {\n      if (navigator.mediaDevices.getUserMedia !== undefined) {\n        navigator.mediaDevices.getUserMedia({ audio: false, video: { facingMode: 'environment', width, height } })\n          .then((mediaStream) => {\n            if ('srcObject' in this.webcamElement) {\n              this.webcamElement.srcObject = mediaStream\n            }\n            else {\n              // For older browsers withouth the srcObject.\n              this.webcamElement.src = window.URL.createObjectURL(mediaStream)\n            }\n            this.webcamElement.onloadedmetadata = (e) => {\n              this.webcamElement.play()\n            }\n            this.webcamElement.onplaying = (e) => {\n              resolve()\n            }\n          })\n          .catch(err => reject(err))\n      }\n      else {\n        reject(new Error('Error accessing camera'))\n      }\n    })\n  }\n\n  _drawImage () {\n    const imageWidth = this.webcamElement.videoWidth\n    const imageHeight = this.webcamElement.videoHeight\n\n    const context = this.canvasElement.getContext('2d')\n    this.canvasElement.width = imageWidth\n    this.canvasElement.height = imageHeight\n\n    context.drawImage(this.webcamElement, 0, 0, imageWidth, imageHeight)\n\n    return { imageHeight, imageWidth }\n  }\n\n  takeImageData () {\n    const { imageHeight, imageWidth } = this._drawImage()\n    const data = { data: null, imageHeight, imageWidth }\n    try {\n      data.data = this.canvasElement\n        .getContext('2d')\n        .getImageData(\n          0,\n          0,\n          imageWidth,\n          imageHeight\n        ).data\n    }\n    catch (e) {}\n\n    return data\n  }\n\n  takeBlobPhoto () {\n    const { imageWidth, imageHeight } = this._drawImage()\n    return new Promise((resolve, reject) => {\n      this.canvasElement.toBlob((fileBlob) => {\n        resolve({ fileBlob, imageHeight, imageWidth })\n      })\n    })\n  }\n\n  takeDataURLPhoto ({ type, quality } = { type: 'jpeg', quality: 1 }) {\n    const { imageHeight, imageWidth } = this._drawImage()\n    const dataUrl = this.canvasElement.toDataURL('image/' + type, quality)\n    return { dataUrl, imageHeight, imageWidth, type: 'image/' + type }\n  }\n}\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\n\nimport Fab from '@material-ui/core/Fab'\nimport SwipeableDrawer from '@material-ui/core/SwipeableDrawer'\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport Typography from '@material-ui/core/Typography'\n\nimport CameraIcon from '@material-ui/icons/Camera'\nimport CancelIcon from '@material-ui/icons/Cancel'\nimport PhotoLibraryIcon from '@material-ui/icons/PhotoLibrary'\n\nimport PhotoFadeSlider from './controls/PhotoFadeSlider'\nimport PhotoGrid from './subViews/PhotoGrid'\nimport Photo from './subViews/Photo'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport style from './CameraTool.style'\nimport { useCamera } from '../../../lib/useCamera'\n\nconst useStyles = makeStyles(style)\n\n// https://googlechrome.github.io/samples/image-capture/grab-frame-take-photo.html\nconst CameraTool = ({ photos, onCancel, onShutter, defaultRefPhotoId }) => {\n  const classes = useStyles()\n  const [slider, setSlider] = useState(50)\n  const newRefPhoto = defaultRefPhotoId\n    ? photos.find(p => p.id === defaultRefPhotoId)\n    : photos && photos.length > 0 ? photos[0] : null\n\n  const [refPhoto, setRefPhoto] = useState(newRefPhoto)\n  const [drawerOpen, setDrawerOpen] = useState(false)\n  const { cameraError, captureImage, cameraOnline } = useCamera((data) => onShutter(data, refPhoto ? refPhoto.id : null))\n\n  const handleTileClick = (id) => {\n    setRefPhoto(photos.find(p => p.id === id))\n    setDrawerOpen(false)\n  }\n\n  return (\n    <div className={classes.root}>\n      <CssBaseline />\n      { !cameraError && Boolean(refPhoto) && (\n        <PhotoFadeSlider defaultValue={slider} onChange={setSlider} />\n      )}\n\n      { cameraError && (\n        <div className={classes.cameraErrorText}>\n          <Typography variant='subtitle1' color='inherit'>No Camera Access</Typography>\n          <Typography variant='body2' color='inherit'>Please enabled access in your settings.</Typography>\n        </div>\n      )}\n\n      <div className={classes.captured}>\n        { Boolean(refPhoto) && (\n          <div className={classes.reference} >\n            <Photo\n              className={classes.referenceContainer}\n              opacity={(100 - slider) / 100}\n              photo={refPhoto}\n            />\n          </div>\n        )}\n        { !cameraError && (\n          <video\n            autoPlay\n            playsInline\n            muted\n            id='webcam'\n            width={window.innerWidth}\n            height={window.innerHeight}\n            className={classes.video}\n          />\n        )}\n      </div>\n\n      <Fab\n        color='primary'\n        aria-label='Take Photo'\n        classes={{\n          disabled: classes.disabledFab\n        }}\n        disabled={cameraError || !cameraOnline}\n        className={classNames(classes.cameraFab, classes.buttonFab)}\n        onClick={captureImage}\n      >\n        <CameraIcon className={classes.cameraIcon} />\n      </Fab>\n\n      <Fab\n        color='secondary'\n        aria-label='cancel'\n        onClick={onCancel}\n        classes={{\n          disabled: classes.disabledFab\n        }}\n        className={classNames(classes.cancelFab, classes.buttonFab)}\n      >\n        <CancelIcon className={classes.cancelIcon} />\n      </Fab>\n\n      <Fab\n        aria-label='cancel'\n        className={classNames(classes.libraryFab, classes.buttonFab)}\n        classes={{\n          disabled: classes.disabledFab\n        }}\n        disabled={!photos || photos.length === 0}\n        onClick={() => setDrawerOpen(true)}\n      >\n        <PhotoLibraryIcon className={classes.libraryIcon} />\n      </Fab>\n\n      <SwipeableDrawer\n        anchor='left'\n        open={drawerOpen}\n        classes={{\n          paperAnchorLeft: classes.swipeDrawer\n        }}\n        onClose={() => setDrawerOpen(false)}\n        onOpen={() => setDrawerOpen(true)}\n      >\n        <div\n          tabIndex={0}\n          className={classes.swipeDrawerContainer}\n          role='button'\n          onClick={() => setDrawerOpen(false)}\n          onKeyDown={() => setDrawerOpen(false)}\n        >\n          <PhotoGrid\n            multiSelect={false}\n            columns={1}\n            photos={photos}\n            onTileClick={handleTileClick}\n          />\n        </div>\n      </SwipeableDrawer>\n\n    </div>\n  )\n}\n\nCameraTool.propTypes = {\n  photos: PropTypes.array,\n  defaultRefPhotoId: PropTypes.string, // id of the reference photo\n  onCancel: PropTypes.func.isRequired,\n  onShutter: PropTypes.func.isRequired\n}\n\nexport default CameraTool\n","export default theme => ({\n  root: {\n    background: 'black',\n    // border: '5px solid red',\n    height: '100%',\n    width: '100%'\n  },\n  cameraErrorText: {\n    color: 'white',\n    position: 'absolute',\n    top: '50%',\n    left: '50%',\n    width: '90%',\n    transform: 'translateY(-50%) translateX(-50%)',\n    textAlign: 'center'\n  },\n  disabledFab: {\n    color: '#AAAAA!important',\n    background: '#DDDDDD!important',\n    opacity: 0.2\n  },\n  cameraFab: {\n    position: 'absolute',\n    zIndex: 10,\n    '@media (orientation: landscape)': {\n      right: '20px',\n      top: '50%',\n      transform: 'translateY(-50%)',\n      height: '25vh',\n      width: '25vh'\n    },\n    '@media (orientation: portrait)': {\n      bottom: '20px',\n      left: '50%',\n      transform: 'translateX(-50%)',\n      height: '25vw',\n      width: '25vw'\n    }\n  },\n  cameraIcon: {\n    height: '100%',\n    width: '100%'\n  },\n  cancelFab: {\n    position: 'absolute',\n    zIndex: 10,\n    '@media (orientation: landscape)': {\n      right: '15px',\n      top: '15px',\n      height: '15vh',\n      width: '15vh'\n    },\n    '@media (orientation: portrait)': {\n      right: '15px',\n      bottom: '15px',\n      height: '15vw',\n      width: '15vw'\n    }\n  },\n  cancelIcon: {\n    height: '100%',\n    width: '100%'\n  },\n\n  swipeDrawer: {\n    width: '50%'\n  },\n\n  libraryFab: {\n    position: 'absolute',\n    zIndex: 10,\n    '@media (orientation: landscape)': {\n      left: '15px',\n      top: '15px',\n      height: '15vh',\n      width: '15vh'\n    },\n    '@media (orientation: portrait)': {\n      left: '15px',\n      top: '15px',\n      height: '15vw',\n      width: '15vw'\n    }\n  },\n\n  myLocationFab: {\n    position: 'absolute',\n    zIndex: 10,\n    '@media (orientation: landscape)': {\n      right: '15px',\n      bottom: '15px',\n      height: '15vh',\n      width: '15vh'\n    },\n    '@media (orientation: portrait)': {\n      left: '15px',\n      bottom: '15px',\n      height: '15vw',\n      width: '15vw'\n    }\n  },\n  myLocationIcon: {\n    height: '80%',\n    width: '80%'\n  },\n  capturedContainer: {\n    position: 'absolute',\n    zIndex: 1,\n    height: '100%',\n    width: '100%'\n  },\n  referenceContainer: {\n    position: 'absolute',\n    zIndex: 2,\n    height: '100%',\n    width: '100%'\n  },\n  captured: {\n\n  },\n  reference: {\n\n  },\n  video: {\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    height: '100vh',\n    width: '100vw',\n    zIndex: 1\n    // '@media (orientation: portrait)': {\n    //   transform: 'rotate(90)'\n    // }\n  }\n  // overlayImage: {\n  //   position: 'absolute',\n  //   top: 0,\n  //   left: 0,\n  //   zIndex: 3,\n  //   height: '100vh',\n  //   width: '100vw',\n  //   textAlign: 'center'\n  // },\n  // overlayImageInner: {\n  //   '@media (orientation: landscape)': {\n  //     height: '100%',\n  //     width: 'auto'\n  //   },\n  //   '@media (orientation: portrait)': {\n  //     width: '100%',\n  //     height: 'auto'\n  //   }\n  // },\n  // newImage: {\n  //   position: 'absolute',\n  //   top: 0,\n  //   left: 0,\n  //   zIndex: 2\n  // }\n})\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport Typography from '@material-ui/core/Typography'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport DialogActions from '@material-ui/core/DialogActions'\nimport Button from '@material-ui/core/Button'\n\nimport SeriesEditInner from './subViews/SeriesEditInner'\n\n// import { SeriesContext } from '../contexts'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport style from './NewPhotoInfo.style'\nimport PhotoInfoInner from './subViews/PhotoInfoInner'\n\nconst useStyles = makeStyles(style)\n\nconst NewPhotoInfo = ({ photo, newSeries, onCancel, onSave }) => {\n  const classes = useStyles()\n  // const { series } = useContext(SeriesContext)\n  const [seriesDelta, setSeriesDelta] = useState(newSeries || {})\n  const [photoDelta, setPhotoDelta] = useState(photo)\n\n  return (\n    <div className={classes.root}>\n      <CssBaseline /> {/* You only need this in a root element. Don't put it anywhere else in the dom */}\n      <Dialog\n        fullScreen\n        fullWidth\n        scroll='paper'\n        disableBackdropClick\n        disableEscapeKeyDown\n        onClose={onCancel}\n        aria-labelledby='customized-dialog-title'\n        open\n      >\n        <DialogTitle disableTypography className={classes.dlgTitleContainer}>\n          <Typography variant='h5' className={classes.dlgTitle}>\n          New Photo Properties\n          </Typography>\n        </DialogTitle>\n        <DialogContent>\n\n          {!!newSeries && (\n            <SeriesEditInner\n              series={newSeries}\n              delta={seriesDelta}\n              onChange={setSeriesDelta}\n            />\n          )}\n\n          <PhotoInfoInner\n            photo={photo}\n            canEdit\n            delta={photoDelta}\n            onChange={(newAttr) => setPhotoDelta({ ...photoDelta, ...newAttr })}\n          />\n\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={onCancel} color='primary'>\n            Cancel\n          </Button>\n          <Button onClick={() => onSave(seriesDelta, photoDelta)} color='primary'>\n            Next\n          </Button>\n        </DialogActions>\n      </Dialog>\n    </div>\n  )\n}\n\nNewPhotoInfo.propTypes = {\n  photo: PropTypes.object.isRequired,\n  newSeries: PropTypes.object,\n  // Standard functions\n  onCancel: PropTypes.func.isRequired,\n  onSave: PropTypes.func\n}\n\nexport default NewPhotoInfo\n","export default theme => ({\n  root: {\n\n  },\n  formLabel: {\n    color: theme.palette.text.secondary\n  },\n  mapFormLabel: {\n    marginTop: theme.spacing(2),\n    marginBottom: theme.spacing(1),\n    color: theme.palette.text.secondary\n  },\n  map: {\n    marginBottom: theme.spacing(2)\n  },\n  mapWrapper: {\n    marginBottom: theme.spacing(2)\n  },\n  field: {\n    marginBottom: theme.spacing(2)\n  }\n})\n","import React, { useEffect, useRef } from 'react'\n\nconst useFileInput = (onChange = () => {}, anyFile = false) => {\n  const inputRef = useRef()\n  const clickRef = useRef()\n\n  const element = (\n    <input style={{ display: 'none' }} ref={inputRef} type='file' accept={!anyFile ? 'image/*' : null} />\n  )\n\n  const forceClick = () => {\n    if (inputRef.current) inputRef.current.click()\n  }\n\n  useEffect(() => {\n    const handleChange = evt => {\n      const [file] = [...inputRef.current.files]\n      if (file) {\n        console.log('file', file)\n        const reader = new FileReader()\n        reader.onloadend = () => {\n          const { type, name, size } = file\n          onChange({ dataUrl: reader.result, type, name, size, ext: getExtFromFile(file) })\n        }\n        reader.readAsDataURL(file)\n      }\n      inputRef.current.value = null\n    }\n\n    if (inputRef.current) {\n      inputRef.current.addEventListener('change', handleChange)\n      if (!clickRef.current) {\n        inputRef.current.click()\n        clickRef.current = true\n      }\n    }\n    return () => {\n      if (inputRef.current) {\n        inputRef.current.removeEventListener('change', handleChange)\n      }\n    }\n  }, [inputRef.current])\n\n  return { fileClickEl: element, forceClick }\n}\n\nexport default useFileInput\n\nconst getExtFromFile = (fileBlob) => {\n  switch (fileBlob.type) {\n    case 'image/jpeg':\n      return 'jpeg'\n    case 'image/jpg':\n      return 'jpeg'\n    case 'image/png':\n      return 'png'\n    default:\n      return 'jpg'\n  }\n}\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport PhotoLibraryIcon from '@material-ui/icons/PhotoLibrary'\nimport { makeStyles } from '@material-ui/core/styles'\nimport useFileInput from '../../../../lib/useFileInput'\nimport { Button } from '@material-ui/core'\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    height: '100%',\n    display: 'flex',\n    flexDirection: 'column',\n    textAlign: 'center',\n    color: theme.palette.grey[600],\n    border: `20px solid ${theme.palette.grey[400]}`\n  },\n  icon: {\n    color: theme.palette.grey[600],\n    margin: 'auto',\n    flex: '1 1 50%',\n    height: '70%',\n    width: '70%'\n  },\n  button: {\n    margin: theme.spacing(2)\n  }\n}))\n\nconst LibraryFilePicker = ({ onLibraryAdd, onCancel }) => {\n  const classes = useStyles()\n  const { fileClickEl, forceClick } = useFileInput(onLibraryAdd)\n  return (\n    <div className={classes.root}>\n      {fileClickEl}\n      <PhotoLibraryIcon className={classes.icon}color='inherit' onClick={forceClick} />\n      <Button variant='contained' className={classes.button} color='primary' onClick={forceClick}>\n        Import from Library\n      </Button>\n      <Button variant='outlined' className={classes.button} color='secondary' onClick={onCancel}>\n        Cancel\n      </Button>\n    </div>\n  )\n}\n\nLibraryFilePicker.propTypes = {\n  onLibraryAdd: PropTypes.func.isRequired,\n  onCancel: PropTypes.func.isRequired\n}\n\nexport default LibraryFilePicker\n","import SeriesConfig from './SeriesConfig'\nimport uuidv4 from 'uuid/v4'\n\nclass Series {\n  constructor (seriesConfig, series) {\n    this.config = new SeriesConfig(seriesConfig)\n    if (series) this.series = series\n    else {\n      this.series = this.newSeries()\n    }\n  }\n\n  setMeta = () => {\n    this.meta = JSON.stringify(this.config.getSeriesMeta())\n  }\n\n  newSeries = () => ({\n    id: `__LOCAL_SERIES::${uuidv4()}`,\n    meta: JSON.stringify(this.config.getSeriesMeta()),\n    photos: []\n  })\n}\n\nexport default Series\n","import React, { useState, useContext } from 'react'\nimport PropTypes from 'prop-types'\n\nimport PhotoReviewTool from './PhotoReviewTool'\nimport CameraTool from './CameraTool'\nimport NewPhotoInfo from './NewPhotoInfo'\nimport LibraryFilePicker from './controls/LibraryFilePicker'\n\nimport PhotoClass, { getExif } from '../../../lib/Photo'\nimport SeriesClass from '../../../lib/Series'\nimport { useDeviceOrientation, useGeolocation } from '../../../lib/sensors'\n\nimport { SeriesContext } from '../contexts'\n\nconst MODES = {\n  CAMERA: 'camera',\n  FILEPICKER: 'library',\n  PHOTOREVIEW: 'photoreview',\n  PHOTOINFOEDIT: 'photoinfoedit'\n}\n\nconst NewPhoto = ({ inputMethod, onCreate, onCancel, isNewSeries }) => {\n  const { seriesConfig, series } = useContext(SeriesContext)\n\n  // This will hold our urlData base64-encoded image\n  const [newPhotoData, setNewPhotoData] = useState(null)\n\n  // Instantiate common-sense empty objects.\n  const [newSeries, setNewSeries] = useState(isNewSeries ? new SeriesClass(seriesConfig).series : series)\n  const [newPhoto, setNewPhoto] = useState(new PhotoClass(seriesConfig).photo)\n\n  const [photoRefId, setPhotoRefId] = useState(null)\n  const [mode, _changeMode] = useState({ current: inputMethod, history: [] })\n  const orientation = useDeviceOrientation()\n  const geo = useGeolocation()\n\n  const photos = !isNewSeries && series && series.photos ? series.photos : []\n\n  const changeMode = (newModeName) => {\n    console.log('NEWPHOTO changeMode', mode, newModeName)\n    _changeMode({\n      current: newModeName,\n      history: [...mode.history, mode.current]\n    })\n  }\n  const lastMode = () => {\n    if (mode.history.length > 0) {\n      const oldHistory = [...mode.history]\n      const oldMode = oldHistory.pop()\n      _changeMode({\n        current: oldMode,\n        history: oldHistory\n      })\n    }\n    else {\n      onCancel()\n    }\n  }\n\n  const onLibraryAdd = (data) => {\n    console.log('onLibraryAdd Debug GOT DATA', { data, isNewSeries })\n    setNewPhotoData(data)\n    // Ok, now try to get the datetime off the EXIF\n    const { exif, exifDateTime, exifGPS } = getExif(data.dataUrl)\n    let coords = exifGPS\n    const date = exifDateTime || String(Date.now())\n    if (!coords) {\n      if (geo && geo.latitude && geo.longitude) {\n        const { latitude, longitude } = geo\n        coords = [longitude, latitude]\n      }\n      else {\n        // Stanley park as a fallback if we can't get the geo or exif data\n        coords = [-123.1398254, 49.3050394]\n      }\n    }\n\n    if (isNewSeries) setNewSeries({ ...newSeries, coords })\n\n    console.log('LATLONG FOR LIB PICK', { coords, exifGPS, geo })\n\n    const _newPhoto = {\n      ...newPhoto,\n      takenOn: date,\n      rawData: JSON.stringify({\n        exif,\n        sensors: {\n          orientation,\n          geo\n        }\n      })\n    }\n    setNewPhoto(_newPhoto)\n    console.log('onLibraryAdd', _newPhoto)\n    changeMode(MODES.PHOTOREVIEW)\n    console.log('onLibraryAdd FINISHED', _newPhoto)\n  }\n\n  const onShutter = (data, refId) => {\n    setNewPhotoData(data)\n    console.log('onShutter Debug GOT DATA', { data })\n    const { exif, exifGPS } = getExif(data.dataUrl)\n\n    const date = String(Date.now())\n    // with the camera we prioritize the geoLocation over EXIF gps data\n    let coords = geo\n    if (!coords) {\n      if (geo && exifGPS) {\n        coords = exifGPS\n      }\n      else {\n        // Stanley park as a fallback if we can't get the geo or exif data\n        coords = [-123.1398254, 49.3050394]\n      }\n    }\n\n    if (isNewSeries) setNewSeries({ ...newSeries, coords })\n\n    const _newPhoto = {\n      ...newPhoto,\n      takenOn: date,\n      rawData: JSON.stringify({\n        exif,\n        sensors: {\n          orientation,\n          geo\n        }\n      })\n    }\n    setNewPhoto(_newPhoto)\n    console.log('onShutter', _newPhoto)\n    setPhotoRefId(refId)\n    changeMode(MODES.PHOTOREVIEW)\n  }\n\n  const onFinalCreate = (seriesDelta, photoDelta) => onCreate(seriesDelta, photoDelta, newPhotoData)\n\n  let component = null\n  switch (mode.current) {\n    case MODES.CAMERA:\n      component = (\n        <CameraTool\n          photos={photos}\n          onShutter={onShutter}\n          onCancel={onCancel}\n        />\n      )\n      break\n    case MODES.FILEPICKER:\n      component = <LibraryFilePicker\n        onCancel={onCancel}\n        onLibraryAdd={onLibraryAdd}\n      />\n      // fileClick() // move this to useEffect to help with click handling\n      break\n    case MODES.PHOTOREVIEW:\n      component = (\n        <PhotoReviewTool\n          defaultRefPhotoId={photoRefId}\n          photos={photos}\n          captured={newPhoto}\n          dataUrl={newPhotoData.dataUrl}\n          onConfirm={() => changeMode(MODES.PHOTOINFOEDIT)}\n          onCancel={onCancel}\n          onRetry={lastMode}\n        />\n      )\n      break\n    case MODES.PHOTOINFOEDIT:\n      component = (\n        <NewPhotoInfo\n          photo={newPhoto}\n          newSeries={newSeries}\n          onSave={onFinalCreate}\n          onCancel={onCancel}\n        />\n      )\n      break\n    default:\n      console.log('NEWPHOTO: default state. you should NEVER see this', mode)\n      onCancel()\n  }\n\n  return component\n}\n\nNewPhoto.propTypes = {\n  inputMethod: PropTypes.oneOf(['camera', 'library']),\n  onCreate: PropTypes.func.isRequired,\n  onCancel: PropTypes.func.isRequired,\n  isNewSeries: PropTypes.bool,\n  seriesConfig: PropTypes.object,\n  // This might be a new series so we might have\n  // actions to work on that\n  // This will be provided EITHER photos or onSeriesCreate\n  photos: PropTypes.array\n}\n\nexport default NewPhoto\n","import AccessControl from 'accesscontrol'\n\nclass AccessHelper {\n  constructor (userSub, role, permissionObj) {\n    this.userSub = userSub\n    this.role = role\n    this.permissionObj = permissionObj\n    this.ac = new AccessControl(permissionObj)\n  }\n\n  // Return the string 'Own' or the string 'Any'\n  ownOrAny = (obj) => {\n    if (!obj || !obj.createdUser || !obj.createdUser.id) throw new Error(`No Created user found`)\n    try {\n      return obj.createdUser.id === this.userSub ? 'Own' : 'Any'\n    }\n    catch (e) {\n      return 'Any'\n    }\n  }\n\n  isOwner = (obj) => {\n    if (!obj || !obj.createdUser || !obj.createdUser.id) throw new Error(`No Created user found`)\n    try {\n      return obj.createdUser.id === this.userSub\n    }\n    catch (e) {\n      return false\n    }\n  }\n\n  toString () {\n    console.log('AccessHelper:', { sub: this.userSub, role: this.role })\n  }\n\n  canUser = (action, obj, type, attrs) => {\n    if (['series', 'photo'].indexOf(type) < 0) throw new Error(`canUser: type not supported ${type}`)\n\n    try {\n      const ownAny = this.ownOrAny(obj)\n\n      const perm = this.ac.can(this.role)[`${action}${ownAny}`](type)\n      let otherPerm = null\n      if (type === 'series') {\n        if (obj.access === 'PUBLIC') otherPerm = this.ac.can(this.role)[`${action}${ownAny}`]('series_public')\n        else if (obj.access === 'OPEN') otherPerm = this.ac.can(this.role)[`${action}${ownAny}`]('series_open')\n      }\n\n      // Trying to recreate the form `can(role).readAny`\n      if (attrs) {\n        if (otherPerm) {\n          return !!perm.attributes.find(p => p === '*' || attrs.indexOf(p) > -1) ||\n           !!otherPerm.attributes.find(p => p === '*' || attrs.indexOf(p) > -1)\n        }\n        else return !!perm.attributes.find(p => p === '*' || attrs.indexOf(p) > -1)\n      }\n      else {\n        if (otherPerm) return perm.granted || otherPerm.granted\n        else return perm.granted\n      }\n    }\n    catch (e) {\n      console.error(e)\n      return false\n    }\n  }\n}\n\nexport default AccessHelper\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport AppBar from '@material-ui/core/AppBar'\nimport Toolbar from '@material-ui/core/Toolbar'\nimport IconButton from '@material-ui/core/IconButton'\nimport Typography from '@material-ui/core/Typography'\n\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport style from './SeriesView.style'\nconst useStyles = makeStyles(style)\n\nconst SeriesNotFound = ({ onMenuBack }) => {\n  const classes = useStyles()\n\n  return (\n    <div className={classes.root}>\n      <CssBaseline />\n      <AppBar position='static' className={classes.appBar}>\n        <Toolbar disableGutters>\n          <IconButton className={classes.menuButton} color='inherit' onClick={onMenuBack} aria-label='Menu'>\n            <ArrowBackIcon />\n          </IconButton>\n          <Typography variant='subtitle1' color='inherit' className={classes.toolbarTitle}>\n            Series\n          </Typography>\n        </Toolbar>\n      </AppBar>\n\n      <div className={classes.placeholderInner}>\n        <div className={classes.grow} />\n        <Typography className={classes.placeholderText} variant='h3'>\n            Series not found\n        </Typography>\n        <div className={classes.grow} />\n      </div>\n    </div>\n  )\n}\n\nSeriesNotFound.propTypes = {\n  // Action functions\n  onMenuBack: PropTypes.func.isRequired\n}\n\nexport default SeriesNotFound\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport AppBar from '@material-ui/core/AppBar'\nimport Toolbar from '@material-ui/core/Toolbar'\nimport IconButton from '@material-ui/core/IconButton'\nimport Typography from '@material-ui/core/Typography'\nimport CircularProgress from '@material-ui/core/CircularProgress'\n\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport style from './SeriesView.style'\nconst useStyles = makeStyles(style)\n\nconst SeriesLoading = ({ onMenuBack }) => {\n  const classes = useStyles()\n\n  return (\n    <div className={classes.root}>\n      <CssBaseline />\n      <AppBar position='static' className={classes.appBar}>\n        <Toolbar disableGutters>\n          <IconButton className={classes.menuButton} color='inherit' onClick={onMenuBack} aria-label='Menu'>\n            <ArrowBackIcon />\n          </IconButton>\n          <Typography variant='subtitle1' color='inherit' className={classes.toolbarTitle}>\n            Series\n          </Typography>\n        </Toolbar>\n      </AppBar>\n\n      <div className={classes.placeholderInner}>\n        <div className={classes.grow} />\n        <div className={classes.progressWrapper}>\n          <CircularProgress className={classes.progress} color='inherit' size={150} thickness={5} />\n        </div>\n        <Typography className={classes.placeholderText} variant='h4'>\n            Loading...\n        </Typography>\n        <div className={classes.grow} />\n      </div>\n    </div>\n  )\n}\n\nSeriesLoading.propTypes = {\n  // Action functions\n  onMenuBack: PropTypes.func.isRequired\n}\n\nexport default SeriesLoading\n","import React, { useState, useEffect } from 'react'\nimport PropTypes from 'prop-types'\n\nimport SeriesView from './views/SeriesView'\nimport SeriesEdit from './views/SeriesEdit'\nimport Slideshow from './views/Slideshow'\nimport PhotoViewTool from './views/PhotoViewTool'\nimport NewPhoto from './views/NewPhoto'\nimport AccesHelper from '../../lib/AccessHelper'\n\nimport { SeriesContext } from './contexts'\nimport SeriesNotFound from './views/SeriesNotFound'\nimport SeriesLoading from './views/SeriesLoading'\n\nexport const MODES = {\n  SERIES_VIEW: 'series',\n  SERIES_EDIT: 'editseries',\n  NEWPHOTO: 'newphoto',\n  NEWSERIES: 'newseries',\n  REVIEW: 'review',\n  PHOTO_VIEW: 'photoviewer',\n  PHOTO_VIEW_NEW: 'newphotoviewer',\n  SLIDESHOW: 'slideshow'\n}\nconst VIEW_ONLY_MODES = [MODES.SERIES_VIEW, MODES.PHOTO_VIEW, MODES.SLIDESHOW]\nconst VALID_STARTMODES = [MODES.SERIES_VIEW, MODES.NEWPHOTO, MODES.NEWSERIES, MODES.PHOTO_REVIEW, MODES.PHOTO_VIEW]\n\n/**\n * This component ties all the Repeat Photo components together\n */\nconst RepeatablePhotos = ({\n  modeName, series, seriesConfig, inputMethod: inputMethodINIT,\n  currentUserId, currentUserRole, accessControl, initialPhoto,\n  onChange, onClose, onDelete, onNewSeries, onChangePhoto,\n  onNewPhoto, onDeletePhoto, loading,\n  onWatch, onUnWatch, watching, owned\n}) => {\n  // Manage view modes separately\n  // This is a pretty normal pattern for context\n  const [seriesState, setState] = useState({\n    series,\n    seriesConfig,\n    ac: accessControl ? new AccesHelper(currentUserId, currentUserRole, accessControl) : null\n  })\n\n  const [mode, setMode] = useState({\n    current: {\n      name: modeName || MODES.SERIES_VIEW,\n      pid: initialPhoto,\n      inputMethod: inputMethodINIT\n    },\n    history: []\n  })\n\n  useEffect(() => {\n    setState({ ...seriesState, series })\n    setMode({\n      current: {\n        name: modeName || MODES.SERIES_VIEW,\n        pid: initialPhoto,\n        inputMethod: inputMethodINIT\n      },\n      history: []\n    })\n  }, [series])\n\n  // When anything changes about a photo\n  const onUpdatePhoto = (photo, photoDelta) => {\n    const newSeries = { ...seriesState.series }\n    newSeries.photos = newSeries.photos.map(ph => ph.id === photoDelta.id ? { ...ph, ...photoDelta } : ph)\n    onChangePhoto(photo, { ...photoDelta, seriesId: newSeries.id })\n  }\n\n  const onApprovePhoto = async (newSeries, newPhoto, newPhotoData) => {\n    // Pass this all back so that graphQl can handle it\n    console.log('RepeatablePhotos: waiting for photo ID', { newSeries, newPhoto, newPhotoData })\n    await onNewPhoto(newPhoto, newPhotoData)\n\n    setState({\n      ...seriesState,\n      series: {\n        ...series,\n        photos: [...series.photos, newPhoto]\n      }\n    })\n    changeMode(MODES.PHOTO_VIEW_NEW, newPhoto.id)\n  }\n\n  // const onCreateSeries = async (newSeries, newPhoto, newPhotoData) => {\n  //   console.log('RepeatablePhotos: waiting for series ID', { newSeries, newPhoto, newPhotoData })\n\n  //   await onNewSeries(newSeries, newPhoto, newPhotoData)\n  //   console.log('RepeatablePhotos done. showing the series')\n  //   changeMode(MODES.SERIES_VIEW)\n  // }\n\n  // When a photo is removed\n  const onDeletePhotos = (photoIdArr) => {\n    series.photos.filter(sp => photoIdArr.indexOf(sp.id) > -1).forEach(p => onDeletePhoto(p))\n  }\n\n  // Here's our modeChanger. My guess it will get a lot more complicated\n  // once the reducers get in and working\n  const changeMode = (newModeName, newPid, newInputMethod) => {\n    const canUpdate = seriesState.ac.canUser('update', series, 'series')\n    if (seriesState === null) onClose()\n    if (!canUpdate && VIEW_ONLY_MODES.indexOf(newModeName) < 0) {\n      console.error('ILLEGAL MODE CHANGE!!!!!', { from: mode.current, to: newModeName, canUpdate })\n    }\n    else {\n      // console.log('CHANGING MODE TO', newModeName)\n      setMode({\n        current: {\n          name: newModeName,\n          pid: newPid,\n          inputMethod: newInputMethod\n        },\n        history: [...mode.history, mode.current]\n      })\n    }\n  }\n  const lastMode = () => {\n    // console.log('REPEATABLEPHOTOS lastMode', mode)\n    if (mode.history.length > 0) {\n      const oldHistory = [...mode.history]\n      const oldMode = oldHistory.pop()\n      setMode({\n        current: oldMode,\n        history: oldHistory\n      })\n    }\n    else {\n      onClose()\n    }\n  }\n\n  // The action to initiate the photo viewer\n  const viewPhoto = (pid) => {\n    // console.log('DEBUG', mode, series.photos.find(p => p.id === pid))\n    changeMode(MODES.PHOTO_VIEW, pid)\n  }\n\n  let component = null\n\n  if (loading) return <SeriesLoading onMenuBack={onClose} />\n  else if (!seriesState.series && mode.current.name !== MODES.NEWSERIES) return <SeriesNotFound onMenuBack={onClose} />\n\n  switch (mode.current.name) {\n    case MODES.SERIES_VIEW:\n      component = (\n        <SeriesView\n          // This one has lots of functionsgit add\n          onSlideshowStart={() => changeMode(MODES.SLIDESHOW)}\n          onChange={() => {\n            console.log('onChange NOT IMPLEMENTED')\n          }}\n          watching={watching}\n          owned={owned}\n          initialPhoto={initialPhoto}\n          onDeletePhotos={onDeletePhotos}\n          onDeleteSeries={onDelete}\n          onCameraAdd={() => changeMode(MODES.NEWPHOTO, null, 'camera')}\n          onEditSeries={() => changeMode(MODES.SERIES_EDIT)}\n          onLibraryAdd={() => changeMode(MODES.NEWPHOTO, null, 'library')}\n          onTileClick={viewPhoto}\n          onMenuBack={onClose}\n          onWatch={onWatch}\n          onUnWatch={onUnWatch}\n        />\n      )\n      break\n    case MODES.SERIES_EDIT:\n      component = (\n        <SeriesEdit\n          onCancel={() => changeMode(MODES.SERIES_VIEW)}\n          onOk={(seriesDelta) => {\n            onChange(series, { ...seriesDelta, id: series.id })\n            changeMode(MODES.SERIES_VIEW)\n          }}\n        />\n      )\n      break\n    case MODES.PHOTO_VIEW:\n      component = (\n        <PhotoViewTool\n          photos={seriesState.series.photos}\n          initPhotoId={mode.current.pid}\n          onMenuBack={lastMode}\n          onUpdatePhoto={onUpdatePhoto}\n        />\n      )\n      break\n    case MODES.PHOTO_VIEW_NEW:\n      component = (\n        <PhotoViewTool\n          photos={seriesState.series.photos}\n          initPhotoId={mode.current.pid}\n          newPhoto\n          onMenuBack={() => changeMode(MODES.SERIES_VIEW)}\n          onUpdatePhoto={onUpdatePhoto}\n        />\n      )\n      break\n    case MODES.SLIDESHOW:\n      component = (\n        <Slideshow photos={seriesState.series.photos} onCancel={lastMode} />\n      )\n      break\n    case MODES.NEWPHOTO:\n      component = (\n        <NewPhoto\n          inputMethod={mode.current.inputMethod}\n          photos={series ? series.photos : null}\n          onCreate={onApprovePhoto}\n          onCancel={lastMode}\n        />\n      )\n      break\n    case MODES.NEWSERIES:\n      component = (\n        <NewPhoto\n          inputMethod={mode.current.inputMethod}\n          isNewSeries\n          onCreate={onNewSeries}\n          onCancel={lastMode}\n        />\n      )\n      break\n    default:\n      console.log('REPEATABLEPHOTO: default state. you should NEVER see this', seriesState)\n      component = null\n  }\n\n  return (\n    <SeriesContext.Provider value={seriesState}>\n      {component}\n    </SeriesContext.Provider>\n  )\n}\n\nRepeatablePhotos.propTypes = {\n  modeName: PropTypes.oneOf(VALID_STARTMODES),\n  seriesConfig: PropTypes.object.isRequired,\n  watching: PropTypes.bool,\n  owned: PropTypes.bool,\n\n  currentUserId: PropTypes.string,\n  currentUserRole: PropTypes.string,\n  accessControl: PropTypes.object,\n\n  inputMethod: PropTypes.oneOf(['camera', 'library']),\n  series: PropTypes.object,\n  initialPhoto: PropTypes.string,\n  loading: PropTypes.bool,\n\n  // Now some functions to handle actions we might take\n  onChange: PropTypes.func.isRequired,\n  onChangePhoto: PropTypes.func.isRequired,\n  onDeletePhoto: PropTypes.func.isRequired,\n  onNewPhoto: PropTypes.func.isRequired,\n  onNewSeries: PropTypes.func.isRequired,\n  onDelete: PropTypes.func.isRequired,\n  onClose: PropTypes.func.isRequired,\n  onWatch: PropTypes.func,\n  onUnWatch: PropTypes.func\n\n}\nRepeatablePhotos.defaultProps = {\n  mode: MODES.SERIES_VIEW\n}\n\nexport default RepeatablePhotos\n","import React, { useContext } from 'react'\nimport PropTypes from 'prop-types'\nimport { home, tagColors } from '../config'\nimport permissions from '../permissions'\nimport { graphql, compose } from 'react-apollo'\nimport { connect } from 'react-redux'\nimport actions from '../redux/actions'\nimport { getWholeSeries, allSeries, getUser, getMyFeed } from './queries'\nimport { deletePhoto, deleteSeries, updateSeries, createPhoto, createSeries, updatePhoto, watchSeries, unWatchSeries } from './mutations'\nimport RepeatablePhotos, { MODES } from '../components/PhotoSeries'\nimport { AppContext } from '../contexts'\nimport { imgStore } from '../storage'\n// import { getExtFromBlob } from '../lib/Photo'\n\nimport { ThemeProvider } from '@material-ui/styles'\nimport themes from '../themes'\n\nconst SeriesConnect = ({\n  series, loading, domain, activeSeries, initialPhoto,\n  onAfterSeriesDelete, onBack, queueUpload,\n  createSeriesMutation, createPhotoMutation,\n  updateSeriesMutation, updatePhotoMutation,\n  deleteSeriesMutation, deletePhotoMutation,\n  watchSeriesMutation, unWatchSeriesMutation\n}) => {\n  const { role, currentUser, user, signedIn, isIos, onAvatarClick, getPhotoUrl } = useContext(AppContext)\n  let inputMethod = 'camera'\n  // Hack until we can get good loading object sorted\n  if (domain === home.AppStateTypes.NEW_SERIES_CAMERA) inputMethod = 'camera'\n  else if (domain === home.AppStateTypes.NEW_SERIES_LIBRARY) inputMethod = 'library'\n\n  // console.log('SeriesConnect', { series, loading, currentState, activeSeries, role, currentUser })\n  let modeName = MODES.SERIES_VIEW\n  if (domain !== home.AppStateTypes.SERIES) modeName = MODES.NEWSERIES\n\n  // Series config is the object that series needs to know how to process things outside itself (like lookup urls etc.)\n  const seriesConfig = {\n    meta: {},\n    tags: [\n      {\n        isIos,\n        id: 'freeBothType',\n        label: null,\n        color: tagColors[0],\n        allowXY: true,\n        allowNonXY: true,\n        allowAdditions: true,\n        // This one returns a promise\n        getValues: () => Promise.resolve(['a', 'b', 'c']),\n        imgStore,\n        values: []\n      }\n    ],\n    onAvatarClick,\n    getPhotoUrl\n  }\n\n  console.log('[SERIESCONNECT]', { series, loading })\n  return (\n    <ThemeProvider theme={themes.series}>\n      <RepeatablePhotos\n        modeName={modeName}\n        inputMethod={inputMethod}\n\n        owned={signedIn && user && series && user.id === series.id}\n        watching={signedIn && user && user.watching && user.watching.indexOf(activeSeries) > -1}\n\n        // Everything we need to determine access\n        currentUserId={signedIn ? currentUser.attributes.sub : null}\n        currentUserRole={role}\n        accessControl={permissions}\n        loading={loading}\n        series={series}\n        initialPhoto={initialPhoto}\n        seriesConfig={seriesConfig}\n\n        // Now some functions to handle actions we might take\n        onNewPhoto={async (newPhoto, newPhotoData) => {\n          console.log('onNewPhoto::', { newPhoto, newPhotoData })\n          // Write this blob to the imgStore so we can use it later\n          await imgStore.setItem(newPhoto.uploadToken, newPhotoData)\n          return createPhotoMutation(series, newPhoto, newPhotoData.ext)\n            .then(({ data }) => {\n              // Don't start an upload until you get back a proper id\n              const photo = data.createPhoto.photo\n              if (data.createPhoto.preAuth) {\n                const preAuth = JSON.parse(data.createPhoto.preAuth)\n                // console.log('PREAUTH::', data.createPhoto.preAuth)\n                queueUpload({\n                  id: photo.id,\n                  uploadToken: photo.uploadToken,\n                  seriesId: photo.seriesId,\n                  preAuth\n                })\n              }\n            })\n            .catch(err => {\n              console.log('onNewPhoto:: Graphql Error', err.stack)\n              console.error(err)\n            })\n        }}\n        onChangePhoto={(photo, photoDelta) => updatePhotoMutation(photo, photoDelta)\n          .catch(err => {\n            console.log('onChangePhoto:: Graphql Error', err.stack)\n            console.error(err)\n          })\n        }\n        onDeletePhoto={(photo) => deletePhotoMutation(photo.id)\n          .then((...data) => {\n            console.log('onDeletePhoto:: photo deleted', data)\n          })\n          .catch(err => {\n            console.log('onDeletePhoto:: Graphql Error', err.stack)\n            console.error(err)\n          })\n        }\n        onChange={(series, seriesDelta) => updateSeriesMutation(series, seriesDelta)\n          .catch(err => {\n            console.log('onChange:: Graphql Error', err.stack)\n            console.error(err)\n          })\n        }\n        onNewSeries={async (newSeries, newPhoto, newPhotoData) => {\n          console.log('Series.connect:: onNewSeries starting', { newSeries, newPhoto, newPhotoData })\n          await imgStore.setItem(newPhoto.uploadToken, newPhotoData)\n          return createSeriesMutation(newSeries, newPhoto, newPhotoData.ext)\n            .then(async ({ data }) => {\n              if (data.createSeries.preAuth) {\n                const photo = data.createSeries.series.photos[0]\n                console.log('Series.connect:: done createSeriesMutation', data)\n                const preAuth = JSON.parse(data.createSeries.preAuth)\n                // console.log('Series.connect:: PREAUTH', data.createSeries.preAuth)\n                queueUpload({\n                  id: photo.id,\n                  uploadToken: photo.uploadToken,\n                  seriesId: photo.seriesId,\n                  preAuth\n                })\n              }\n            })\n            .catch(err => {\n              console.log('onNewSeries:: Graphql Error', err.stack)\n              console.error(err)\n            })\n        }}\n        onDelete={() => deleteSeriesMutation()\n          .then(onAfterSeriesDelete)\n          .catch(err => {\n            console.log('onDelete:: Graphql Error', err.stack)\n            console.error(err)\n          })\n        }\n        onClose={onBack}\n        onWatch={signedIn ? watchSeriesMutation : null}\n        onUnWatch={signedIn ? unWatchSeriesMutation : null}\n      />\n    </ThemeProvider>\n  )\n}\nSeriesConnect.propTypes = {\n  domain: PropTypes.string,\n  activeSeries: PropTypes.string,\n  initialPhoto: PropTypes.string,\n\n  // From Redux\n  onAfterSeriesDelete: PropTypes.func,\n  queueUpload: PropTypes.func,\n  onBack: PropTypes.func,\n\n  // Data from apollo\n  series: PropTypes.object,\n\n  // Functions From Apollo\n  loading: PropTypes.bool,\n  updateSeriesMutation: PropTypes.func,\n  updatePhotoMutation: PropTypes.func,\n  deleteSeriesMutation: PropTypes.func,\n  deletePhotoMutation: PropTypes.func,\n  createSeriesMutation: PropTypes.func,\n  createPhotoMutation: PropTypes.func,\n  watchSeriesMutation: PropTypes.func,\n  unWatchSeriesMutation: PropTypes.func\n}\n\n/**\n * Here's the graphql HOC that gets an individual series\n */\nconst withGetSelectedQuery = graphql(getWholeSeries, {\n  props: ({ data }) => {\n    if (data.error) console.error(data.error)\n    console.log('getWholeSeries:: ', { data })\n    let series = null\n    try {\n      if (!data.loading && !data.error) series = data.series\n    }\n    catch (e) {\n      console.log('getWholeSeries:: error', { data, e })\n      console.error(e)\n    }\n    return {\n      data,\n      loading: data.loading,\n      series\n    }\n  },\n  skip: ({ activeSeries, isNewSeries }) => !activeSeries || isNewSeries,\n  options: ({ activeSeries }) => ({\n    variables: {\n      id: activeSeries\n    }\n  })\n})\n\nconst withUpdateSeriesMutation = graphql(updateSeries, {\n  props: ({ mutate, ownProps }) => ({\n    // We turn this into a thunk so we can handle the business logic here and not in a JSX region\n    updateSeriesMutation: (series, seriesDelta) => mutate({\n\n      variables: { series: sanitizeUpdateParams(seriesDelta, ['id', 'name', 'access', 'note', 'coords', 'direction']) },\n      optimisticResponse: {\n        updateSeries: {\n          ...series,\n          ...seriesDelta,\n          __typename: 'Series'\n        }\n      },\n      update: (store, { data }) => {\n        // console.log('withUpdateSeriesMutation start Manip:', JSON.stringify(data, null, 2))\n        const qdata = store.readQuery({ query: getWholeSeries, variables: { id: ownProps.activeSeries } })\n        qdata.series = { ...qdata.series, ...seriesDelta }\n        store.writeQuery({ query: getWholeSeries, data: qdata })\n        // console.log('withUpdateSeriesMutation Done Manip:', qdata)\n\n        // Update: allSeries\n        // We might not have called this query yet so let it throw if it wants\n        try {\n          const qdataAll = store.readQuery({ query: allSeries, variables: { limit: 100 } })\n          // console.log('withUpdateSeriesMutation qdataAll:', qdataAll)\n          const summary = sanitizeUpdateParams(seriesDelta, ['id', 'name', 'access', 'coords', 'direction'])\n          qdataAll.allSeries.seriesSummaries = qdataAll.allSeries.seriesSummaries.map(s => s.id !== summary.id\n            ? s\n            : { ...s, ...summary }\n          )\n          store.writeQuery({ query: allSeries, data: qdataAll })\n          // console.log('withUpdateSeriesMutation qdataAll WRITE:', qdataAll)\n        }\n        catch (e) { }\n      }\n    })\n  })\n})\n\nconst withUpdatePhotoMutation = graphql(updatePhoto, {\n  props: ({ mutate, ownProps }) => ({\n    // We turn this into a thunk so we can handle the business logic here and not in a JSX region\n    updatePhotoMutation: (photo, photoDelta) => {\n      const sanitizedPhotoDelta = sanitizeUpdateParams(\n        photoDelta,\n        [ 'id', 'seriesId', 'takenOn', 'tags', 'note' ]\n      )\n      if (sanitizedPhotoDelta.tags && sanitizedPhotoDelta.tags.length > 0) {\n        sanitizedPhotoDelta.tags = sanitizedPhotoDelta.tags.map(t => {\n          const newT = sanitizeUpdateParams(t, [ 'label', 'typeId', 'coords' ])\n          if (newT.coords) newT.coords = sanitizeUpdateParams(newT.coords, [ 'x', 'y' ])\n          return newT\n        })\n      }\n      // console.log('withUpdatePhotoMutation', sanitizedPHoto)\n      return mutate({\n\n        variables: { photo: sanitizedPhotoDelta },\n        optimisticResponse: {\n          updatePhoto: {\n            ...photo,\n            ...sanitizedPhotoDelta,\n            __typename: 'Photo'\n          }\n        },\n        update: (store, { data }) => {\n          // console.log('updatePhotoMutation start Manip:', JSON.stringify(data, null, 2))\n          const qdata = store.readQuery({ query: getWholeSeries, variables: { id: ownProps.activeSeries } })\n          // Gotta add Typenames\n          const updatedPhoto = {\n            ...sanitizedPhotoDelta,\n            tags: sanitizedPhotoDelta.tags ? sanitizedPhotoDelta.tags.map(t => {\n              const newT = { ...t, __typename: 'Tag' }\n              newT.coords = newT.coords ? { ...newT.coords, __typename: 'ImageCoords' } : null\n              return newT\n            }) : []\n          }\n          // console.log('updatePhotoMutation', updatedPhoto)\n          qdata.series.photos = qdata.series.photos.map(photo => photo.id !== photoDelta.id ? photo : { ...photo, ...updatedPhoto })\n\n          store.writeQuery({ query: getWholeSeries, data: qdata })\n          // console.log('updatePhotoMutation Manip:', { qdata })\n        }\n      })\n    }\n  })\n})\n\nconst withDeleteSeriesDeleteMutation = graphql(deleteSeries, {\n  props: ({ mutate, ownProps }) => {\n    return {\n      deleteSeriesMutation: () => mutate({\n        variables: { id: ownProps.activeSeries },\n        optimisticResponse: {\n          deleteSeries: ownProps.activeSeries\n        },\n        update: (store, { data }) => {\n          try {\n            const qdataAll = store.readQuery({ query: allSeries, variables: { limit: 100 } })\n            qdataAll.allSeries.seriesSummaries = qdataAll.allSeries.seriesSummaries.filter(s => s.id !== data.deleteSeries)\n            store.writeQuery({ query: allSeries, data: qdataAll })\n          }\n          catch (e) { }\n        }\n      })\n    }\n  }\n})\n\nconst withDeletePhotoMutation = graphql(deletePhoto, {\n  props: ({ mutate, ownProps }) => ({\n    // We turn this into a thunk so we can handle the business logic here and not in a JSX region\n    deletePhotoMutation: (photoId) => mutate({\n      variables: { seriesId: ownProps.series.id, photoId },\n      optimisticResponse: {\n        deletePhoto: photoId\n      },\n      update: (store, { data }) => {\n        console.log('deletePhotoMutation start Manip:', JSON.stringify(data, null, 2))\n        let finalCount = null\n\n        const qdata = store.readQuery({ query: getWholeSeries, variables: { id: ownProps.activeSeries } })\n        qdata.series.photos = qdata.series.photos.filter(photo => photo.id !== data.deletePhoto)\n\n        finalCount = qdata.series.photos.length\n        qdata.series.photoCount = finalCount\n        store.writeQuery({ query: getWholeSeries, data: qdata })\n        console.log('deletePhotoMutation start Manip WRITE:', qdata)\n\n        // Update: allSeries\n        // We might not have called this query yet so let it throw if it wants\n        try {\n          const qdataAll = store.readQuery({ query: allSeries, variables: { limit: 100 } })\n          console.log('deletePhotoMutation qdataAll:', qdataAll)\n          qdataAll.allSeries.seriesSummaries = qdataAll.allSeries.seriesSummaries.map(s => s.id !== data.deletePhoto\n            ? s\n            : { ...s, photoCount: finalCount !== null ? finalCount : s.photoCount }\n          )\n          store.writeQuery({ query: allSeries, data: qdataAll })\n          console.log('deletePhotoMutation qdataAll WRITE:', qdataAll)\n        }\n        catch (e) { }\n\n        console.log('Done Manip:', qdata.series.photos)\n      }\n    })\n  })\n})\n\nconst withCreateNewSeries = graphql(createSeries, {\n  props: ({ mutate, ownProps }) => {\n    return {\n      createSeriesMutation: (newSeries, newPhoto, ext) => {\n        const { id, gravatar, gravatarProfile, username } = ownProps.user\n        const meUserSummary = { id, gravatar, gravatarProfile, username, __typename: 'UserSummary' }\n        if (!newSeries.access) newSeries.access = 'PRIVATE'\n        return mutate({\n          variables: {\n            series: sanitizeUpdateParams(newSeries, ['name', 'note', 'access', 'coords', 'direction', 'meta']),\n            photo: sanitizeUpdateParams(newPhoto, [ 'seriesId', 'takenOn', 'meta', 'rawData', 'coords', 'tags', 'note', 'uploadToken' ]),\n            ext\n          },\n          optimisticResponse: {\n            createSeries: {\n              series: {\n                id: newSeries.id,\n                name: newSeries.name,\n                note: newSeries.note || null,\n                access: newSeries.access,\n                meta: newSeries.meta || null,\n                featured: null,\n                latest: null,\n                coords: newSeries.coords || null,\n                direction: newSeries.direction || null,\n                photoCount: 1,\n                createdUser: meUserSummary,\n                updatedUser: meUserSummary,\n                createdBy: meUserSummary.id,\n                updatedBy: meUserSummary.id,\n                createdOn: Date.now().toString(),\n                updatedOn: Date.now().toString(),\n                watchers: 0,\n                photos: [{\n                  id: newPhoto.id,\n                  meta: newPhoto.meta || null,\n                  seriesId: newSeries.id,\n                  createdOn: Date.now().toString(),\n                  createdUser: meUserSummary,\n                  updatedUser: meUserSummary,\n                  createdBy: meUserSummary.id,\n                  updatedBy: meUserSummary.id,\n                  uploadToken: newPhoto.uploadToken,\n                  updatedOn: Date.now().toString(),\n                  seriesCreatedBy: meUserSummary.id, // we can't answer this yet\n                  takenOn: newPhoto.takenOn,\n                  coords: newPhoto.coords || null,\n                  tags: newPhoto.tags || [],\n                  paths: {\n                    base: null,\n                    large: null,\n                    orig: null,\n                    thumb: null,\n                    medium: null,\n                    __typename: 'Paths'\n                  },\n                  __typename: 'Photo'\n                }],\n                __typename: 'Series'\n              },\n              preAuth: null,\n              __typename: 'NewSeries'\n            }\n          },\n          update: (store, { data }) => {\n            // We need to write this query from scratch\n            console.log('createSeriesMutation:: STARTING TO CREATE THE SERIES', { data, store, ownProps })\n            // dumpLog(store.data, '##CACHE-NEW_SERIES_BEFORE')\n            // try {\n            //   store.writeQuery({ query: getWholeSeries,\n            //     data: { series: data.createSeries }\n            //   })\n            //   console.log('createSeriesMutation:: Series write getWholeSeries', { series: data.createSeries })\n            // }\n            // catch (e) {\n            //   console.log('ERROR: createSeriesMutation:: updating getWholeSeries failed')\n            // }\n\n            try {\n              const qdataAll = store.readQuery({ query: allSeries, variables: { limit: 100 } })\n              // console.log('createSeriesMutation qdataAll:', qdataAll)\n              const newAllSeriesEntry = sanitizeUpdateParams(data.createSeries.series, [\n                'id', 'name', 'access', 'updatedOn', 'updatedOn', 'createdUser', 'createdOn', 'featured',\n                'latest', 'coords', 'photoCount', 'seriesStatus', 'direction', 'watchers'\n              ])\n              qdataAll.allSeries.seriesSummaries.push(newAllSeriesEntry)\n              store.writeQuery({ query: allSeries, data: qdataAll })\n              // console.log('createSeriesMutation qdataAll WRITE:', qdataAll)\n            }\n\n            catch (e) {\n              // dumpLog(store.data, '##CACHE-NEW_SERIES_ERROR')\n              console.log('ERROR: createSeriesMutation:: updating allSeries failed')\n            }\n\n            console.log('Series.connect: createSeriesMutation:: Setting new series id:', data.createSeries)\n            ownProps.doneCreatingSeries(data.createSeries.series.id)\n          }\n        })\n      }\n    }\n  }\n})\n\nconst withCreateNewPhoto = graphql(createPhoto, {\n  props: ({ mutate, ownProps }) => {\n    return {\n      createPhotoMutation: (series, newPhoto, ext) => {\n        // When we're not creating a series the seriesId isn't passed in\n        // so we add it now\n        const { fileBlob, ...newPhotoInput } = newPhoto\n        if (!newPhotoInput.seriesId && ownProps.activeSeries) {\n          newPhotoInput.seriesId = ownProps.activeSeries\n        }\n        const { id, gravatar, gravatarProfile, username } = ownProps.user\n        const meUserSummary = { id, gravatar, gravatarProfile, username, __typename: 'UserSummary' }\n\n        // Unfortunately we need to pass a token up to the server and back so we know what's been done\n        console.log('createPhotoMutation::', { newPhotoInput, series, ext })\n        return mutate({\n          variables: {\n            photo: sanitizeUpdateParams(newPhotoInput, [ 'seriesId', 'takenOn', 'meta', 'rawData', 'coords', 'tags', 'note', 'uploadToken' ]),\n            ext\n          },\n          optimisticResponse: {\n            createPhoto: {\n              photo: {\n                id: newPhotoInput.id,\n                meta: newPhotoInput.meta || null,\n                seriesId: newPhotoInput.seriesId,\n                createdOn: Date.now().toString(),\n                createdUser: meUserSummary,\n                updatedUser: meUserSummary,\n                createdBy: meUserSummary.id,\n                updatedBy: meUserSummary.id,\n                uploadToken: newPhotoInput.uploadToken,\n                updatedOn: Date.now().toString(),\n                seriesCreatedBy: series.createdUser.id, // we can't answer this yet\n                takenOn: newPhotoInput.takenOn,\n                coords: newPhotoInput.coords || null,\n                tags: newPhotoInput.tags || [],\n                paths: {\n                  base: null,\n                  large: null,\n                  orig: null,\n                  thumb: null,\n                  medium: null,\n                  __typename: 'Paths'\n                },\n                __typename: 'Photo'\n              },\n              preAuth: null,\n              __typename: 'NewPhoto'\n            }\n          },\n          update: async (store, { data }) => {\n            try {\n              const qdata = store.readQuery({ query: getWholeSeries, variables: { id: data.createPhoto.photo.seriesId } })\n              qdata.series.photos = qdata.series.photos = [...qdata.series.photos, data.createPhoto.photo]\n\n              store.writeQuery({ query: getWholeSeries, data: qdata })\n            }\n            catch (e) {\n              // This won't fire on new series and that's ok for now.\n              console.log('createPhotoMutation:: getWholeSeries ERROR')\n            }\n\n            // Update: allSeries\n            // We might not have called this query yet so let it throw if it wants\n            let qdataAll = null\n            try {\n              qdataAll = store.readQuery({ query: allSeries, variables: { limit: 100 } })\n              console.log('createPhotoMutation:: qdataAll:', qdataAll)\n              qdataAll.allSeries.seriesSummaries = qdataAll.allSeries.seriesSummaries.map(s => s.id !== data.createPhoto.photo.seriesId\n                ? s\n                : {\n                  ...s,\n                  photoCount: s.photoCount + 1,\n                  latest: sanitizeUpdateParams(data.createPhoto.photo, [ 'id', 'takenOn', 'seriesCreatedBy', 'updatedOn', 'createdOn', 'seriesId', 'createdUser', 'paths' ])\n                }\n              )\n              store.writeQuery({ query: allSeries, data: qdataAll })\n              console.log('createPhotoMutation:: qdataAll: WRITE', qdataAll)\n            }\n            catch (e) {\n              console.log('createPhotoMutation:: allSeries ERROR')\n            }\n          }\n        })\n      }\n    }\n  }\n})\n\nconst withWatchSeriesMutation = graphql(watchSeries, {\n  props: ({ mutate, ownProps }) => {\n    return {\n      watchSeriesMutation: () => mutate({\n        variables: { seriesId: ownProps.activeSeries },\n        optimisticResponse: {\n          watchSeries: ownProps.activeSeries\n        },\n        update: (store, { data }) => {\n          // TODO: modify the getuser query to add this to the list of favourites\n          // try {\n          const qdataAll = store.readQuery({ query: getUser })\n          qdataAll.user.watching = [...new Set([...qdataAll.user.watching || [], data.watchSeries])]\n          store.writeQuery({ query: getUser, data: qdataAll })\n\n          const qFeedData = store.readQuery({ query: getMyFeed })\n          console.log('DEBUG', qFeedData)\n          // qdataAll.user.watching = [...new Set([...qdataAll.user.watching || [], data.watchSeries])]\n          // store.writeQuery({ query: getUser, data: qdataAll })\n          // }\n          // catch (e) { }\n        }\n      })\n    }\n  }\n})\n\nconst withUnWatchSeriesMutation = graphql(unWatchSeries, {\n  props: ({ mutate, ownProps }) => {\n    return {\n      unWatchSeriesMutation: () => mutate({\n        variables: { seriesId: ownProps.activeSeries },\n        optimisticResponse: {\n          unWatchSeries: ownProps.activeSeries\n        },\n        update: (store, { data }) => {\n          // try {\n          const qdataAll = store.readQuery({ query: getUser })\n          qdataAll.user.watching = qdataAll.user.watching.filter(sid => sid !== data.unWatchSeries)\n          store.writeQuery({ query: getUser, data: qdataAll })\n          // }\n          // catch (e) { }\n        }\n      })\n    }\n  }\n})\n\n/**\n * Compose all our queries together\n */\nconst connectedWithApollo = compose(\n  withGetSelectedQuery,\n  withCreateNewSeries,\n  withCreateNewPhoto,\n  withUpdateSeriesMutation,\n  withUpdatePhotoMutation,\n  withDeleteSeriesDeleteMutation,\n  withDeletePhotoMutation,\n  withWatchSeriesMutation,\n  withUnWatchSeriesMutation\n)(SeriesConnect)\n\n/**\n * Map our redux state and functions\n */\nconst mapStateToProps = (state, props) => {\n  const { current: { activeSeries, initialPhoto, domain } } = state.home\n  return { activeSeries, initialPhoto, domain }\n}\n\nconst mapDispatchToProps = dispatch => ({\n  onBack: () => {\n    dispatch(actions.homeStateBack())\n  },\n  onAfterSeriesDelete: (key, newProgress) => {\n    dispatch(actions.setHomeState(home.AppStateTypes.FEED))\n  },\n  queueUpload: (uploadObj) => {\n    dispatch(actions.queueUpload(uploadObj))\n  },\n  doneCreatingSeries: (activeSeries) => {\n    dispatch(actions.setHomeState(home.AppStateTypes.SERIES, { activeSeries }))\n  }\n})\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(connectedWithApollo)\n\n/**\n * We need to filter out null values and params we don't desire\n */\nfunction sanitizeUpdateParams (inputObj, desiredParams) {\n  const newDesiredParams = [...desiredParams, '__typename']\n  const remainder = Object.keys(inputObj).filter(key => newDesiredParams.indexOf(key) > -1)\n  console.log('sanitizeUpdateParams', { orig: Object.keys(inputObj), remainder })\n  return remainder.reduce((acc, key) => ({ ...acc, [key]: inputObj[key] }), {})\n}\n","import { useState, useEffect, useCallback } from 'react'\nimport uuid from 'uuid/v4'\nimport WebMercatorViewport from 'viewport-mercator-project'\nimport rbush from 'rbush'\nimport { point, centroid, featureCollection } from '@turf/turf'\nimport { debounce } from './util'\n\nconst useClusteredData = (data, filterBounds, currentZoom, viewport, sizeScale, queryVersion) => {\n  const [clusteredData, setClusteredData] = useState([])\n  const [filteredData, setFilteredData] = useState({ single: [], cluster: [] })\n  const [version, setVersion] = useState(0)\n\n  // We promisify and debounce the expensive stuff so it runs outside our render loop\n  const updateDataDebounce = useCallback(debounce(async (...innerArgs) => {\n    const updatedData = await updateData(...innerArgs)\n    setClusteredData(updatedData)\n    // setClusteredData(updatedData)\n    setVersion(version + 1)\n  }, 1000), [])\n\n  const filterDataDebounce = useCallback(debounce(async (...innerArgs) => {\n    const filtered = await filterData(...innerArgs)\n    setFilteredData(filtered)\n  }, 300), [])\n\n  // Here's the really expensive call. Make sure this only runs when the data changes\n  useEffect(() => {\n    updateDataDebounce(data, sizeScale, viewport)\n  }, [data.length, queryVersion])\n\n  useEffect(() => {\n    filterDataDebounce(clusteredData, filterBounds, currentZoom)\n  }, [clusteredData, currentZoom, filterBounds, version])\n\n  return { filteredClusteredData: filteredData }\n}\n\nexport default useClusteredData\n\n// Compute icon clusters\n// We use the projected positions instead of longitude and latitude to build\n// the spatial index, because this particular dataset is distributed all over\n// the world, we can't use some fixed deltaLon and deltaLat\nconst updateData = (data, sizeScale, viewport) => {\n  // console.log('----------------------------------UPDATE CLUSTER----------------------------------', { data, sizeScale, viewport })\n\n  if (!data) {\n    return []\n  }\n  const tree = rbush(9, ['.x', '.y', '.x', '.y'])\n\n  const transform = new WebMercatorViewport({\n    ...viewport,\n    zoom: 0\n  })\n\n  // console.log('DATA', data)\n  // The root of this is GeoJSON so that's what we have to build\n  const newData = data.map(p => {\n    // Create some GeoJSON that we can render as a dot\n    let screenCoords = [0, 0]\n    try {\n      screenCoords = transform.project(p.coords)\n    }\n    catch (e) {\n      console.error(e)\n    }\n    const { longitude, latitude, ...properties } = p\n    return {\n      x: screenCoords[0],\n      y: screenCoords[1],\n      photoCount: properties.photoCount,\n      zoomLevels: [],\n      geoJSON: p.coords ? point(p.coords, { ...properties }) : null\n    }\n  })\n\n  tree.clear()\n  tree.load(newData)\n\n  for (let z = 0; z <= 20; z++) {\n    const radius = sizeScale / Math.sqrt(2) / Math.pow(2, z)\n    // const radius = 60 / Math.sqrt(2) / Math.pow(2, z)\n\n    newData.forEach(p => {\n      if (p.zoomLevels[z] === undefined) {\n        // this point does not belong to a cluster\n        const { x, y } = p\n\n        // find all points within radius that do not belong to a cluster\n        const neighbors = tree\n          .search({\n            minX: x - radius,\n            minY: y - radius,\n            maxX: x + radius,\n            maxY: y + radius\n          })\n          .filter(neighbor => neighbor.zoomLevels[z] === undefined)\n\n        // only show the center point at this zoom level\n        neighbors.forEach(neighbor => {\n          if (neighbor === p) {\n            const newGeoJSON = neighbors.length === 1\n              ? p.geoJSON\n              : centroid(featureCollection(neighbors.map(n => n.geoJSON)))\n\n            newGeoJSON.properties = {\n              ...newGeoJSON.properties,\n              id: newGeoJSON.properties.id || uuid(),\n              count: neighbors.length,\n              reducedPhotoCount: neighbors.reduce((acc, { photoCount }) => photoCount ? acc + photoCount : acc, 0),\n              points: neighbors.map(n => n.geoJSON)\n            }\n            p.zoomLevels[z] = newGeoJSON\n          }\n          else {\n            neighbor.zoomLevels[z] = null\n          }\n        })\n      }\n    })\n  }\n\n  // console.log('----------------------------------UPDATE CLUSTER DONE----------------------------------')\n  return newData.map(({ zoomLevels }) => zoomLevels)\n}\n\nfunction filterData (clusteredData, filterBounds, newZ) {\n  // console.log('----------------------------------FILTER CLUSTER----------------------------------', { clusteredData, filterBounds, newZ })\n\n  return clusteredData\n    // Filter out anything not relevant to this zoom level\n    .filter(d => !!d[newZ])\n    // Restructure the object to be a little more JSON-friendly\n    .reduce((acc, zoomLevels) => {\n      const geoJSON = zoomLevels[newZ]\n      const coords = geoJSON.geometry.coordinates\n      const { count } = geoJSON.properties\n\n      if (!filterBounds || filterBounds.length < 4 || (\n        filterBounds[0] < coords[0] && filterBounds[1] < coords[1] &&\n        filterBounds[2] > coords[0] && filterBounds[3] > coords[1]\n      )) {\n        if (count > 1) acc.cluster.push(geoJSON)\n        else acc.single.push(geoJSON)\n      }\n      return acc\n    }, {\n      single: [],\n      cluster: []\n    })\n}\n","export default theme => ({\n  root: {\n    position: 'relative',\n    height: '100%',\n    '& .myPosMarker': {\n      zIndex: 1\n    },\n    '& .singleMarker': {\n      zIndex: 3\n    },\n    '& .clusterMarker': {\n      zIndex: 2\n    }\n  },\n  fab: {\n    background: theme.palette.secondary.main,\n    color: theme.palette.secondary.contrastText\n  },\n  topBar: {\n    position: 'absolute',\n    zIndex: 1000,\n    top: 0\n  },\n  loadingWrapper: {\n    position: 'absolute',\n    color: theme.palette.text.primary,\n    opacity: 0.5,\n    zIndex: 3000,\n    textAlign: 'center',\n    top: '50%',\n    left: '50%',\n    transform: 'translateY(-50%) translateX(-50%)'\n  },\n  zoomOutFab: {\n    margin: theme.spacing(0.5),\n    padding: theme.spacing(0.5),\n    border: '2px solid',\n    borderRadius: theme.spacing(1),\n    background: theme.palette.common.white,\n    fontSize: 20,\n    position: 'absolute',\n    zIndex: 100,\n    bottom: theme.spacing(2),\n    right: theme.spacing(10)\n  },\n  selectedPopup: {\n    // padding: theme.spacing(0, 1, 0, 1),\n    width: '90%',\n    maxWidth: 400,\n    zIndex: 2000,\n    position: 'absolute',\n    bottom: theme.spacing(1),\n    left: '50%',\n    transformOrigin: '0% 50%',\n    transform: 'translateY(0%) translateX(-50%)'\n  }\n})\n","import React from 'react'\nimport createSvgIcon from '@material-ui/icons/utils/createSvgIcon'\n\nexport default createSvgIcon(\n  <React.Fragment>\n    <path d='M16.432,6.104c-2.671,-1.06 -6.842,4.123 -6.572,5.826c-3.78,-7.611 2.788,-8.409 3.682,-10.699c0.64,1.255 5.18,2.608 2.89,4.873Z' />\n    <path d='M9.159,5.228c-2.254,1.782 0.149,7.986 1.76,8.604c-8.482,-0.532 -5.889,-6.619 -7.425,-8.538c1.407,0.073 4.848,-3.183 5.665,-0.066Z' />\n    <path d='M4.727,11.059c0.417,2.844 6.991,3.864 8.331,2.779c-4.701,7.079 -8.676,1.79 -11.106,2.161c0.766,-1.183 -0.332,-5.791 2.775,-4.94Z' />\n    <path d='M7.561,17.813c2.671,1.061 6.842,-4.122 6.572,-5.826c3.781,7.611 -2.788,8.409 -3.681,10.699c-0.641,-1.255 -5.181,-2.607 -2.891,-4.873Z' />\n    <path d='M14.828,18.736c2.254,-1.783 -0.149,-7.987 -1.76,-8.605c8.482,0.532 5.889,6.619 7.425,8.538c-1.407,-0.072 -4.849,3.183 -5.665,0.067Z' />\n    <path d='M19.26,12.904c-0.417,-2.843 -6.991,-3.864 -8.331,-2.778c4.701,-7.08 8.676,-1.791 11.106,-2.162c-0.767,1.183 0.332,5.791 -2.775,4.94Z' />\n  </React.Fragment>, 'AppLogoSimple')\n","// https://commons.wikimedia.org/wiki/File:Apple_logo_black.svg\n\nimport React from 'react'\nimport createSvgIcon from '@material-ui/icons/utils/createSvgIcon'\n\nexport default createSvgIcon(\n  <React.Fragment>\n    <path d='M21.229,18.388c-0.346,0.799 -0.756,1.535 -1.23,2.211c-0.647,0.922 -1.176,1.56 -1.584,1.914c-0.632,0.582 -1.31,0.88 -2.036,0.897c-0.521,0 -1.149,-0.148 -1.88,-0.449c-0.734,-0.299 -1.408,-0.448 -2.025,-0.448c-0.646,0 -1.34,0.149 -2.081,0.448c-0.743,0.301 -1.342,0.457 -1.799,0.473c-0.696,0.03 -1.39,-0.277 -2.082,-0.921c-0.442,-0.385 -0.995,-1.046 -1.657,-1.982c-0.71,-0.999 -1.294,-2.158 -1.752,-3.48c-0.49,-1.427 -0.735,-2.809 -0.735,-4.147c0,-1.533 0.331,-2.855 0.994,-3.963c0.521,-0.89 1.215,-1.591 2.083,-2.107c0.868,-0.515 1.806,-0.778 2.816,-0.794c0.553,0 1.278,0.17 2.179,0.506c0.898,0.338 1.474,0.509 1.727,0.509c0.189,0 0.83,-0.2 1.916,-0.599c1.027,-0.369 1.894,-0.522 2.604,-0.462c1.924,0.155 3.37,0.914 4.331,2.28c-1.721,1.043 -2.572,2.503 -2.555,4.377c0.016,1.459 0.545,2.674 1.585,3.638c0.472,0.447 0.999,0.793 1.584,1.039c-0.127,0.368 -0.261,0.721 -0.403,1.06Zm-4.413,-17.366c0,1.144 -0.418,2.212 -1.251,3.2c-1.005,1.176 -2.221,1.855 -3.54,1.748c-0.017,-0.138 -0.026,-0.282 -0.026,-0.434c0,-1.098 0.478,-2.273 1.327,-3.234c0.423,-0.486 0.962,-0.891 1.616,-1.214c0.652,-0.318 1.269,-0.493 1.85,-0.523c0.016,0.152 0.024,0.305 0.024,0.457l0,0Z' />\n  </React.Fragment>, 'Apple')\n","\nimport React from 'react'\nimport PropTypes from 'prop-types'\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport Button from '@material-ui/core/Button'\nimport Typography from '@material-ui/core/Typography'\nimport DialogActions from '@material-ui/core/DialogActions'\n\nimport AppleIcon from '../../icons/Apple'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n\n  },\n  icon: {\n    height: 50,\n    width: '100%',\n    margin: '0 auto',\n    color: theme.palette.error.main\n  },\n  title: {\n\n  }\n})\n\nconst useStyles = makeStyles(style)\n\nconst FeatureDisabled = ({ title, message, onClose, open, icon }) => {\n  const classes = useStyles()\n  const IconComp = icon || AppleIcon\n  return (\n    <Dialog\n      className={classes.root}\n      disableBackdropClick\n      fullWidth\n      open={open}\n      disableEscapeKeyDown\n      maxWidth='xl'\n      aria-labelledby='confirmation-dialog-title'\n    >\n      <DialogTitle id='confirmation-dialog-title' className={classes.title}>{title}</DialogTitle>\n      <DialogContent>\n        <IconComp className={classes.icon} />\n        <Typography component='div'>\n          {message}\n        </Typography>\n\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={onClose} color='primary'>\n      Ok\n        </Button>\n      </DialogActions>\n    </Dialog>\n  )\n}\n\nFeatureDisabled.propTypes = {\n  open: PropTypes.bool,\n  title: PropTypes.string.isRequired,\n  icon: PropTypes.any,\n  message: PropTypes.string.isRequired,\n  onClose: PropTypes.func.isRequired\n}\n\nexport default FeatureDisabled\n","import React, { useContext } from 'react'\nimport PropTypes from 'prop-types'\nimport { makeStyles } from '@material-ui/core/styles'\nimport SwipeableDrawer from '@material-ui/core/SwipeableDrawer'\nimport Avatar from '@material-ui/core/Avatar'\n\nimport List from '@material-ui/core/List'\nimport Divider from '@material-ui/core/Divider'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemIcon from '@material-ui/core/ListItemIcon'\nimport ListItemText from '@material-ui/core/ListItemText'\nimport CloudDownload from '@material-ui/icons/CloudDownload'\nimport { AppContext } from '../contexts'\n\nimport ExitToAppIcon from '@material-ui/icons/ExitToApp'\nimport QRCodeIcon from '../icons/QRCode'\nimport AccountCircleIcon from '@material-ui/icons/AccountCircle'\n\nconst useStyles = makeStyles(theme => ({\n  drawerInner: {\n    width: 250,\n    display: 'flex',\n    flexDirection: 'column',\n    height: '100%'\n  },\n  disableListItem: {\n    color: 'rgba(0, 0, 0, 0.26)'\n  },\n  avatar: {\n    height: theme.spacing(7),\n    width: theme.spacing(7),\n    border: `3px solid ${theme.palette.primary.main}`,\n    margin: theme.spacing(0, 1)\n  },\n  gravatarImg: {\n    width: '100%'\n  },\n  spacer: {\n    flexGrow: 1\n  },\n  fullList: {\n    width: 'auto'\n  }\n}))\n\nconst SideDrawer = ({ open, onOpen, onClose, onDisabledClick }) => {\n  const classes = useStyles()\n  const { signOut, signedIn, forceSignIn, user, onQRClick, addToHomeScreen, isIos } = useContext(AppContext)\n  return (\n    <SwipeableDrawer\n      open={open}\n      onClose={onClose}\n      onOpen={onOpen}\n    >\n      <div\n        className={classes.drawerInner}\n        role='presentation'\n        onClick={onClose}\n        onKeyDown={onClose}\n      >\n        {user && user.username && (\n          <List>\n            <ListItem className={classes.root} onClick={() => {}} disableGutters>\n              <Avatar className={classes.avatar}>\n                {signedIn && user\n                  ? <img alt='profile' className={classes.gravatarImg} src={user.gravatar} />\n                  : <AccountCircleIcon color='inherit' className={classes.loginButton} />\n                }\n              </Avatar>\n            </ListItem>\n            <ListItem className={classes.root} onClick={() => {}}>\n              <ListItemText\n                primary={user.username}\n              />\n            </ListItem>\n          </List>\n\n        )}\n        <Divider />\n        <List>\n          <ListItem\n            className={isIos ? classes.disableListItem : null}\n            button\n            onClick={isIos ? onDisabledClick : onQRClick}\n          >\n            <ListItemIcon>\n              <QRCodeIcon />\n            </ListItemIcon>\n            <ListItemText primary={'Scan QR Code'} />\n          </ListItem>\n          {addToHomeScreen && (\n            <ListItem button onClick={addToHomeScreen}>\n              <ListItemIcon>\n                <CloudDownload />\n              </ListItemIcon>\n              <ListItemText primary={'Install this app'} secondary={'It works better!'} />\n            </ListItem>\n          )}\n        </List>\n        <div className={classes.spacer} />\n        <Divider />\n        <List>\n          {signedIn\n            ? (\n              <ListItem button onClick={signOut}>\n                <ListItemIcon>\n                  <ExitToAppIcon />\n                </ListItemIcon>\n                <ListItemText primary={'Sign Out'} />\n              </ListItem>\n            )\n            : (\n              <ListItem button onClick={forceSignIn}>\n                <ListItemIcon>\n                  <AccountCircleIcon />\n                </ListItemIcon>\n                <ListItemText primary={'Sign In'} />\n              </ListItem>\n            )}\n\n        </List>\n      </div>\n    </SwipeableDrawer>\n  )\n}\n\nSideDrawer.propTypes = {\n  open: PropTypes.bool,\n  onOpen: PropTypes.func,\n  onClose: PropTypes.func,\n  onDisabledClick: PropTypes.func\n}\n\nexport default SideDrawer\n\n//         {/*\n// <ContextMenu\n//             anchorEl={contextEl}\n//             onClose={() => setContextEl(null)}\n//             menuItems={[\n//               ...finalMenuItems,\n//               {\n//                 text: 'Sign Out',\n//                 icon: ExitToAppIcon,\n//                 action: signOut\n//               }\n//             ]}\n\n//                       {!signedIn && (\n//             <IconButton\n//               color='inherit'\n//               className={classes.iconButton}\n//               aria-label='Menu'\n//               onClick={forceSignIn}\n//             >\n//               <AccountCircleIcon color='inherit' className={classes.loginButton} />\n//             </IconButton>\n//           )}\n//           /> */}\n","import React, { useState, useContext } from 'react'\nimport classNames from 'classnames'\nimport PropTypes from 'prop-types'\n\nimport Toolbar from '@material-ui/core/Toolbar'\nimport AppBar from '@material-ui/core/AppBar'\nimport IconButton from '@material-ui/core/IconButton'\nimport AppLogoSimple from '../icons/AppLogoSimple'\nimport FeatureDisabled from './misc/FeatureDisabled'\nimport { AppContext } from '../contexts'\n\nimport QRCodeIcon from '../icons/QRCode'\nimport SideDrawer from './SideDrawer'\n\n// import MenuIcon from '@material-ui/core/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { ThemeProvider } from '@material-ui/styles'\nimport themes from '../themes'\nimport { Typography } from '@material-ui/core'\n\nconst style = theme => ({\n  root: {\n    display: 'flex',\n    alignItems: 'center',\n    width: '100%',\n    padding: theme.spacing(0, 1),\n    backgroundColor: theme.palette.primary.main,\n    color: theme.palette.primary.contrastText,\n    borderBottom: `2px solid ${theme.palette.primary}`,\n    background: `linear-gradient(90deg, ${theme.palette.secondary.main} 0%, ${theme.palette.primary.main} 100%)`\n  },\n  searchIcon: {\n    opacity: 0.3,\n    marginRight: theme.spacing(1)\n  },\n  transparent: {\n    backgroundColor: 'transparent',\n    background: 'none',\n    color: theme.palette.text.primary\n    // borderBottom: `2px transparent`\n  },\n  iOsIcon: {\n    color: 'rgba(0, 0, 0, 0.26)'\n  },\n  logo: {\n    padding: theme.spacing(0, 0),\n    height: 40,\n    width: 40\n  },\n  transparentLogo: {\n    background: `linear-gradient(90deg, ${theme.palette.secondary.main} 0%, ${theme.palette.primary.main} 100%)`,\n    padding: theme.spacing(0.5, 0.5)\n  },\n  transparentLogoIcon: {\n    color: 'white',\n    height: 35,\n    width: 35\n  },\n  children: {\n    flexGrow: 1,\n    padding: theme.spacing(0, 1)\n  },\n  qrButton: {\n    padding: theme.spacing(0, 0)\n  },\n  qrButtonTransparent: {\n    background: 'white',\n    padding: theme.spacing(0.5, 0.5)\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst TopBar = ({ className, children, isTransparent, menuItems, hideLogo }) => {\n  const classes = useStyles()\n  const [appleDlg, setAppleDlg] = useState(false)\n  const [drawerOpen, setDrawerOpen] = useState(false)\n  const { onQRClick, isIos } = useContext(AppContext)\n\n  return (\n    <React.Fragment>\n      <AppBar position='static'>\n        <Toolbar className={classNames(classes.root, className, isTransparent ? classes.transparent : null)} disableGutters>\n          {!hideLogo && (\n            <IconButton\n              className={isTransparent ? classes.transparentLogo : classes.logo}\n              color='inherit'\n              onClick={() => setDrawerOpen(true)}\n            >\n              <AppLogoSimple className={isTransparent ? classes.transparentLogoIcon : classes.logo} />\n            </IconButton>\n          )}\n          <div className={classes.children}>\n            {children}\n          </div>\n          <IconButton\n            color='inherit'\n            className={classNames(\n              isIos ? classes.iOsIcon : null,\n              isTransparent ? classes.qrButtonTransparent : classes.qrButton\n            )}\n            aria-label='Menu'\n            onClick={isIos ? () => setAppleDlg(true) : onQRClick}\n          >\n            <QRCodeIcon color='inherit' />\n          </IconButton>\n        </Toolbar>\n      </AppBar>\n      <SideDrawer\n        open={drawerOpen}\n        onClose={() => setDrawerOpen(false)}\n        onOpen={() => setDrawerOpen(true)}\n        onDisabledClick={() => setAppleDlg(true)}\n      />\n      {isIos && (\n        <FeatureDisabled\n          open={appleDlg}\n          title='iOS Feature Disabled'\n          message={<Typography variant='body2' component='div'>\n            <p>This feature cannot function due to a bug in iOS 12 that prevents <strong>direct\n            camera access from progressive web apps</strong>.</p>\n            <p>There is good evidence iOS 13 has things sorted. ETA from Apple is mid-September 2019.</p>\n          </Typography>}\n          onClose={() => setAppleDlg(false)}\n        />\n      )}\n    </React.Fragment>\n  )\n}\n\nTopBar.propTypes = {\n  className: PropTypes.string,\n  children: PropTypes.any,\n  isTransparent: PropTypes.bool,\n  hideLogo: PropTypes.bool,\n  menuItems: PropTypes.arrayOf(PropTypes.shape({\n    callback: PropTypes.func,\n    text: PropTypes.string,\n    icon: PropTypes.any,\n    color: PropTypes.string\n  }))\n}\n\nexport default (props) => <ThemeProvider theme={themes.topbar}><TopBar {...props} /></ThemeProvider>\n","import React, { useRef, useLayoutEffect, useCallback } from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport { fade } from '@material-ui/core/styles/colorManipulator'\nimport InputBase from '@material-ui/core/InputBase'\n\nimport SearchIcon from '@material-ui/icons/Search'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { debounce } from '../../lib/util'\n\nconst useSearchBarStyles = makeStyles(theme => ({\n  root: {\n    position: 'relative',\n    borderRadius: theme.shape.borderRadius,\n    backgroundColor: fade(theme.palette.common.white, 0.3),\n    '&:hover': {\n      backgroundColor: fade(theme.palette.common.white, 0.5)\n    },\n    marginRight: theme.spacing(2),\n    marginLeft: 0,\n    width: '100%',\n    [theme.breakpoints.up('sm')]: {\n      marginLeft: theme.spacing(3),\n      width: 'auto'\n    }\n  },\n  transparent: {\n    backgroundColor: fade(theme.palette.common.white, 0.7),\n    '&:hover': {\n      backgroundColor: fade(theme.palette.common.white, 0.9)\n    }\n  },\n  inputRoot: {\n    color: 'inherit',\n    width: '100%'\n  },\n  inputInput: {\n    padding: theme.spacing(1, 1, 1, 4),\n    transition: theme.transitions.create('width'),\n    width: '100%',\n    [theme.breakpoints.up('md')]: {\n      width: 200\n    }\n  },\n  searchIcon: {\n    width: theme.spacing(4),\n    height: '100%',\n    position: 'absolute',\n    pointerEvents: 'none',\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center'\n  }\n}))\n\n/**\n *\n */\nexport const SearchInput = ({ autoFocus, disabled, onChange, onClick, defaultValue, isTransparent }) => {\n  const inputRef = useRef()\n  const classes = useSearchBarStyles()\n\n  const debounceSearchText = useCallback(\n    debounce(onChange, 500),\n    [onChange]\n  )\n\n  useLayoutEffect(() => {\n    if (inputRef.current && !autoFocus) {\n      console.log('Setting blur')\n      inputRef.current.blur()\n    }\n  }, [autoFocus])\n  return (\n    <div className={classNames(classes.root, isTransparent ? classes.transparent : null)} onClick={onClick}>\n      <div className={classes.searchIcon}>\n        <SearchIcon />\n      </div>\n      <InputBase\n        autoFocus={!disabled && autoFocus}\n        inputProps={{\n          onBlur: () => {\n            // console.log('onBlur')\n            // inputRef.current.focus()\n          }\n        }}\n        onChange={(e) => {\n          // console.log('onChange', e.target.value)\n          debounceSearchText(e.target.value)\n        }}\n        placeholder='Search…'\n        disabled={disabled}\n        defaultValue={defaultValue}\n\n        inputRef={inputRef}\n        classes={{\n          root: classes.inputRoot,\n          input: classes.inputInput\n        }}\n      />\n    </div>\n  )\n}\n\nSearchInput.propTypes = {\n  autoFocus: PropTypes.bool,\n  isTransparent: PropTypes.bool,\n  disabled: PropTypes.bool,\n  onChange: PropTypes.func,\n  defaultValue: PropTypes.string,\n  onClick: PropTypes.func\n}\n\nexport default SearchInput\n","import React, { useContext } from 'react'\nimport PropTypes from 'prop-types'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemText from '@material-ui/core/ListItemText'\nimport List from '@material-ui/core/List'\nimport classNames from 'classnames'\nimport Typography from '@material-ui/core/Typography'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { formatDate } from '../../lib/datelib'\n\nimport { ACCESS } from '../../config'\nimport { AppContext } from '../../contexts'\n\nconst style = theme => ({\n  root: {\n    margin: 0,\n    padding: theme.spacing(1)\n  },\n  chipContainer: {\n    display: 'flex',\n    width: '100%'\n  },\n  grow: { flexGrow: 1 },\n  accessLabel: {\n    padding: theme.spacing(0.5, 0.5)\n  },\n  accessPUBLIC: {\n    color: 'white',\n    background: ACCESS.PUBLIC.color[900]\n  },\n  accessPRIVATE: {\n    color: 'white',\n    background: ACCESS.PRIVATE.color[900]\n  },\n  accessOPEN: {\n    color: 'white',\n    background: ACCESS.OPEN.color[900]\n  },\n  img: {\n    verticalAlign: 'top',\n    objectFit: 'cover',\n    height: '100%',\n    width: '100%'\n  },\n  text: {\n    height: '115px',\n    margin: 0,\n    padding: theme.spacing(0, 1),\n    alignSelf: 'flex-start',\n    display: 'flex',\n    flexDirection: 'column'\n  },\n  titleText: {\n    textOverflow: 'ellipsis',\n    whiteSpace: 'nowrap',\n    overflow: 'hidden'\n  },\n  dateContainer: {\n    display: 'flex'\n  },\n  dateLabel: {\n    fontWeight: 'bold',\n    flex: '1 1 50px'\n  },\n  dateText: {\n\n  },\n  imgFiller: {\n    flexGrow: 1,\n    background: theme.palette.text.primary\n  },\n  imgContainer: {\n    flex: '0 0 115px',\n    alignSelf: 'flex-start',\n    height: '100%',\n    minHeight: 115,\n    display: 'flex',\n    flexDirection: 'column'\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst SeriesListItem = ({ series, loading, onClick, children, showCreatedOn, showLastPhoto }) => {\n  const classes = useStyles()\n  const { seriesConfig } = useContext(AppContext)\n  if (loading || !series) return 'LOADING...'\n  let thumb = null\n  let accessLabel = ACCESS.PRIVATE.label\n  try {\n    thumb = seriesConfig.getPhotoUrl(series.featured, 'thumb')\n    accessLabel = series.access ? ACCESS[series.access].label : ACCESS.PRIVATE.label\n  }\n  catch (e) {\n    console.error(e)\n  }\n  return (\n    <ListItem className={classes.root} button component='div' disableGutters>\n      <div className={classes.imgContainer} onClick={onClick}>\n        <div className={classes.imgFiller}>\n          <img alt='thumbnail' src={thumb} className={classes.img} />\n        </div>\n        {series.access && (\n          <Typography className={classNames(classes.accessLabel, classes[`access${series.access}`])}\n            variant='caption'\n            component='div'\n          >\n            {`${series.photoCount || 0} Photos`} <em>({accessLabel})</em>\n          </Typography>\n        )}\n      </div>\n      <ListItemText className={classes.text} disableTypography onClick={onClick}>\n        <Typography variant='body1' component='div' className={classes.titleText}>\n          {series.name || loading}\n        </Typography>\n        <Typography variant='body2' component='div'>\n          <strong>Created by:</strong> {series.createdUser.username}\n        </Typography>\n        <div className={classes.grow} />\n        {showCreatedOn && <div className={classes.dateContainer}>\n          <Typography variant='caption' className={classes.dateLabel}>Created:</Typography>\n          <Typography variant='caption' className={classes.dateText}>{formatDate(series.createdOn, 'lll')}</Typography>\n        </div>}\n        {showLastPhoto && <div className={classes.dateContainer}>\n          <Typography variant='caption' className={classes.dateLabel}>Last Photo:</Typography>\n          <Typography variant='caption' className={classes.dateText}>{formatDate(series.latest.takenOn, 'lll')}</Typography>\n        </div>}\n      </ListItemText>\n      {/*  <TinyChip label='Watching' color='secondary' /> */}\n      {children}\n    </ListItem>\n  )\n}\n\nSeriesListItem.propTypes = {\n  series: PropTypes.object,\n  loading: PropTypes.bool,\n  showCreatedOn: PropTypes.bool,\n  showLastPhoto: PropTypes.bool,\n  onClick: PropTypes.func,\n  children: PropTypes.array\n}\n\nexport default SeriesListItem\n\n// const useCosmosStyles = makeStyles(theme => ({\n//   root: {\n\n//   }\n// }))\n\nexport const SeriesListItemCosmos = (props) => {\n  // const classes = useCosmosStyles()\n  return (\n    <List disablePadding dense>\n      <SeriesListItem {...props} />\n    </List>\n  )\n}\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemText from '@material-ui/core/ListItemText'\nimport List from '@material-ui/core/List'\n// import IconButton from '@material-ui/core/IconButton'\n// import ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction'\nimport ZoomOutMapIcon from '@material-ui/icons/ZoomOutMap'\n// import CancelIcon from '@material-ui/icons/Cancel'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { ListItemIcon } from '@material-ui/core'\n\nconst style = theme => ({\n  root: {\n\n  }\n})\n\nconst useStyles = makeStyles(style)\n\nconst ClusterSelected = ({ seriesCount, reducedPhotoCount, onZoomTo, onClose }) => {\n  const classes = useStyles()\n  console.log('cluster selected', { seriesCount, reducedPhotoCount })\n  return (\n    <List>\n      <ListItem className={classes.root}>\n        <ListItemIcon onClick={onZoomTo}>\n          <ZoomOutMapIcon />\n        </ListItemIcon>\n        <ListItemText\n          onClick={onZoomTo}\n          primary={`${seriesCount} Photo series`}\n          secondary={`containing ${reducedPhotoCount} individual photo${reducedPhotoCount === 1 ? '' : 's'}`}\n        />\n        {/* <ListItemSecondaryAction>\n          <IconButton aria-label='Close' onClick={onClose}>\n            <CancelIcon />\n          </IconButton>\n        </ListItemSecondaryAction> */}\n\n      </ListItem>\n    </List>\n  )\n}\n\nClusterSelected.propTypes = {\n  seriesCount: PropTypes.number.isRequired,\n  reducedPhotoCount: PropTypes.number.isRequired,\n  onZoomTo: PropTypes.func.isRequired,\n  onClose: PropTypes.func.isRequired\n}\n\nexport default ClusterSelected\n","import React from 'react'\nimport classNames from 'classnames'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport Badge from '@material-ui/core/Badge'\nimport Avatar from '@material-ui/core/Avatar'\nimport Camera from '@material-ui/icons/Camera'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { ACCESS } from '../../../config'\n\nconst style = theme => ({\n  root: {\n    color: theme.palette.primary.main,\n    width: 150,\n    position: 'absolute',\n    top: '50%',\n    left: '50%',\n    textAlign: 'center',\n    transformOrigin: '50% 50%',\n    transform: 'translateY(-50%) translateX(-50%)'\n  },\n  rootActive: {\n    zIndex: 1000\n  },\n  icon: {\n    // height: 16,\n    // width: 16\n  },\n  avatar: {\n    position: 'relative',\n    margin: '0 auto',\n    background: 'green',\n    color: 'white',\n    border: '2px solid white',\n    height: 40,\n    width: 40,\n    zIndex: 120,\n    '&.PUBLIC': { background: ACCESS.PUBLIC.color },\n    '&.PRIVATE': { background: ACCESS.PRIVATE.color },\n    '&.OPEN': { background: ACCESS.OPEN.color }\n  },\n  avatarActive: {\n    background: '#FFFF00',\n    color: 'black',\n    border: `2px solid black`,\n    '&.PUBLIC': { background: '#FFFF00' },\n    '&.PRIVATE': { background: '#FFFF00' },\n    '&.OPEN': { background: '#FFFF00' }\n  },\n  badge: {\n    zIndex: 124,\n    color: theme.palette.secondary.contrastText,\n    background: theme.palette.secondary.main,\n    transform: 'scale(1) translate(30%, -30%)'\n  },\n  badgeActive: {\n    color: theme.palette.primary.contrastText,\n    background: theme.palette.primary.main\n  },\n  directionIndicator: {\n    position: 'absolute',\n    top: 20,\n    left: '50%',\n    // transformOrigin: '50% 50%',\n    // transform: 'translateY(-50%) translateX(-50%)',\n    zIndex: 100\n  },\n  name: {\n    color: 'white',\n    fontWeight: 'bold',\n    textShadow: `\n        0px 0px 4px #000000, \n        0px 0px 4px #000000 \n    `,\n    zIndex: 122,\n    position: 'relative'\n    // textStroke: '1px white'\n  },\n  nameActive: {\n    color: 'black',\n    textShadow: `\n    0px 0px 2px #FFFFFF, \n    0px 0px 2px #FFFFFF,\n    0px 0px 4px #FFFFFF \n`\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst Single = ({ name, access, onClick, active, photoCount, direction }) => {\n  const classes = useStyles()\n  return (\n    <div className={classNames(classes.root, active ? classes.rootActive : null, access)}>\n      <Badge classes={{ badge: classNames(classes.badge, active ? classes.badgeActive : null, access) }} badgeContent={photoCount}>\n        <Avatar className={classNames(classes.avatar, active ? classes.avatarActive : null, access)} onClick={onClick}>\n          <Camera className={classes.icon} color='inherit' />\n        </Avatar>\n      </Badge>\n      {direction && direction >= 0 ? (\n        <div className={classes.directionIndicator}>\n          <svg className={classes.svgArc}\n            version='1.1'\n            width='100'\n            height='100'\n            viewBox='0, 0, 100, 100'\n            style={{ transform: `translateY(-50%) translateX(-50%) rotateZ(${direction}deg)` }}>\n            <path d='M50,0 C60.946,0.151 72.136,3.514 80.675,10.56 L50,50 L19.325,10.56 C27.938,3.461 39,0.278 50,0 z'\n              fill='#009DC1'\n              fillOpacity='0.444'\n              strokeWidth='1'\n              strokeOpacity='0.6'\n              stroke='#FFFFFF'\n            />\n          </svg>\n        </div>\n      ) : null}\n      <Typography variant='body1' className={classNames(classes.name, active ? classes.nameActive : null)}>\n        {name}\n      </Typography>\n    </div>\n  )\n}\n\nSingle.propTypes = {\n  access: PropTypes.string,\n  name: PropTypes.string,\n  photoCount: PropTypes.number,\n  onClick: PropTypes.func.isRequired,\n  direction: PropTypes.number,\n  active: PropTypes.bool\n}\n\nexport default Single\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport Avatar from '@material-ui/core/Avatar'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport numeral from 'numeral'\n\nconst style = theme => ({\n  avatar: {\n    background: theme.palette.grey[900],\n    border: `2px solid ${theme.palette.grey[100]}`,\n    color: theme.palette.grey[100]\n  },\n  avatarActive: {\n    background: '#FFFF00',\n    border: `2px solid black`,\n    color: 'black',\n    zIndex: 1000\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst Cluster = ({ seriesCount, active, onClick }) => {\n  const classes = useStyles()\n  return (\n    <Avatar onClick={onClick} className={classNames(classes.avatar, active ? classes.avatarActive : null)}>\n      {numeral(seriesCount).format('0,0')}\n    </Avatar>\n  )\n}\n\nCluster.propTypes = {\n  seriesCount: PropTypes.number,\n  onClick: PropTypes.func.isRequired,\n  active: PropTypes.bool\n}\n\nexport default Cluster\n","\nimport React, { useState, useMemo, useRef, useEffect } from 'react'\nimport PropTypes from 'prop-types'\nimport Paper from '@material-ui/core/Paper'\n// import Typography from '@material-ui/core/Typography'\nimport { FlyToInterpolator, LinearInterpolator, Marker } from 'react-map-gl'\nimport { easeCubic } from 'd3-ease'\nimport { CircularProgress } from '@material-ui/core'\nimport MapStyles from '../../mapStyles'\n\nimport BaseMap from './BaseMap'\nimport useClusteredData from '../../lib/useClusteredData'\nimport { bbox, featureCollection, buffer, point } from '@turf/turf'\nimport { makeStyles } from '@material-ui/core/styles'\n// import { debounce } from '../../lib/util'\nimport style from './HomeMap.style'\n\nimport TopBar from '../TopBar'\nimport SearchInput from '../Search/SearchInput'\nimport SeriesListItem from '../misc/SeriesListItem'\nimport ClusterSelected from '../misc/ClusterSelected'\n\nimport SingleMarker from './markers/Single'\nimport ClusterMarker from './markers/Cluster'\n\nconst useStyles = makeStyles(style)\n\nconst defaultView = {\n  zoom: 4,\n  latitude: 44.629701,\n  longitude: -120.333379\n}\n\nconst SIZESCALE = 80\n\nconst HomeMap = ({\n  seriesList, initViewport, loading, activeSeries, queryVersion,\n  onSeriesClick, onSearchClick,\n  popMapHistory, pushMapHistory, clearMapHistory\n}) => {\n  const [mapViewObj, setMapViewObj] = useState({\n    viewport: { ...defaultView, ...initViewport.viewport },\n    bounds: initViewport.bounds,\n    filterBounds: null\n  })\n  // console.log('INITVIEW', initViewport)\n  const classes = useStyles()\n  const mapViewRef = useRef()\n  const [isTransitioning, setIsTransitioning] = useState(false)\n  const homeMapContainerRef = useRef()\n\n  const [currentZoom, setCurrentZoom] = useState(0)\n  const [transitions, setTransitions] = useState(null)\n  const [selectedItem, setSelectedItem] = useState()\n\n  // This custom hook is heavily debounced\n  const { filteredClusteredData } = useClusteredData(\n    seriesList || [],\n    mapViewObj.filterBounds,\n    currentZoom,\n    mapViewObj.viewport,\n    SIZESCALE,\n    queryVersion\n  )\n\n  // If we're coming back to the map with something aleady selected then we need to\n  // reselect the series we had before\n  useEffect(() => {\n    if (!activeSeries || !seriesList || selectedItem) return\n    try {\n      const selected = seriesList.find(s => s.id === activeSeries)\n      // if (selected && homeMapContainerRef.current) setSelectedItem(selected)\n      if (selected && selected.coords) {\n        const bufferPts = buffer(point(selected.coords), 10, { units: 'meters' })\n        const bounds = bbox(bufferPts)\n        setMapViewObj({ ...mapViewObj, bounds })\n      }\n    }\n    catch (e) {\n      console.error(e)\n    }\n  }, [seriesList])\n  // Once we have the zoom in place we might need to select an initial series\n  useEffect(() => {\n    if (!activeSeries || !filteredClusteredData.single || selectedItem) return\n    try {\n      const selected = filteredClusteredData.single.find(s => s.properties.id === activeSeries)\n      if (selected && homeMapContainerRef.current) setSelectedItem(selected)\n    }\n    catch (e) {\n      console.error(e)\n    }\n  }, [filteredClusteredData.single])\n\n  const saveMap = () => {\n    const { latitude, longitude, zoom, bearing, pitch, altitude } = mapViewRef.current ? mapViewRef.current : mapViewObj.viewport\n    setTimeout(() => pushMapHistory({\n      viewport: { latitude, longitude, zoom, bearing, pitch, altitude }\n    }), 2000)\n  }\n  // const saveMapDebounced = debounce(saveMap, 2000)\n\n  const updateSelectedItem = (item) => {\n    // regardless, set the map selected Item\n    setSelectedItem(item)\n    saveMap()\n  }\n\n  const onZoomTo = (object) => {\n    try {\n      const pts = featureCollection(object.properties.points)\n      const bounds = bbox(pts)\n      // buffer a further 10%\n      const lngBuff = (bounds[2] - bounds[0]) * 0.2\n      const latBuff = (bounds[3] - bounds[1]) * 0.2\n      const buffBounds = [\n        bounds[0] - lngBuff,\n        bounds[1] - latBuff,\n        bounds[2] + lngBuff,\n        bounds[3] + latBuff\n      ]\n\n      setTransitions({\n        transitionDuration: 2000,\n        transitionInterpolator: new FlyToInterpolator(),\n        transitionEasing: easeCubic\n      })\n      setMapViewObj({ ...mapViewObj, bounds: buffBounds })\n      if (object.properties.count > 1) setTimeout(() => updateSelectedItem(null), 2000)\n    }\n    catch (e) {\n      console.error(e)\n    }\n  }\n\n  const onViewportChange = ({ viewport, map }) => {\n    mapViewRef.current = viewport\n    // mapViewObj\n    // {\n    //   \"_sw\": {\n    //     \"lng\": -120.40788003760076,\n    //     \"lat\": 44.609051464438835\n    //   },\n    //   \"_ne\": {\n    //     \"lng\": -120.25887796240545,\n    //     \"lat\": 44.65034319161438\n    //   }\n    // minX, minY, maxX, maxY\n    // [W-122.87948116236043, S26.15346805640254, E-82.00799782432676, N47.3795453070757]\n    const viewZoom = Math.floor(viewport.zoom)\n    if (!isTransitioning && map && map.getBounds) {\n      // console.log('onViewportChange', isTransitioning)\n      const { _sw: { lng: minLng, lat: minLat }, _ne: { lng: maxLng, lat: maxLat } } = map.getBounds()\n      const [oldMinLng, oldMinLat, oldMaxLng, oldMaxLat] = mapViewObj.filterBounds || [minLng, minLat, maxLng, maxLat]\n      if (viewZoom !== currentZoom ||\n        oldMinLng >= minLng || oldMinLat >= minLat ||\n        oldMaxLng <= maxLng || oldMaxLat <= maxLat\n      ) {\n        // console.log('RECALCING filterBounds')\n        const filterBounds = [\n          minLng - (maxLng - minLng) / 2,\n          minLat - (maxLat - minLat) / 2,\n          maxLng + (maxLng - minLng) / 2,\n          maxLat + (maxLat - minLat) / 2\n        ]\n        setMapViewObj({ ...mapViewObj, filterBounds })\n      }\n    }\n    if (viewZoom !== currentZoom) {\n      setCurrentZoom(viewZoom)\n    }\n  }\n  // Debounce this to improve performance\n  // const onViewportChangeDebounced = useCallback(debounce(onViewportChange, 300), [])\n\n  const lock = {}\n\n  const onMarkerClick = (obj) => {\n    // Second click zooms\n    if (selectedItem && selectedItem.properties.id === obj.properties.id) {\n      // console.log('onMarkerClick SECOND CLICK')\n      onZoomTo(selectedItem)\n    }\n    else {\n      // console.log('onMarkerClick First click')\n      setTransitions({\n        transitionDuration: 500,\n        transitionInterpolator: new LinearInterpolator(),\n        transitionEasing: easeCubic\n      })\n      setMapViewObj({\n        viewport: {\n          longitude: obj.geometry.coordinates[0],\n          latitude: obj.geometry.coordinates[1]\n        }\n      })\n    }\n    updateSelectedItem(obj)\n  }\n\n  // This one should be debounced by filteredClusteredData\n  const markersRendered = useMemo(() => ([\n    ...filteredClusteredData.single.map(obj => (\n      <Marker\n        className={'singleMarker'}\n        key={`single-${obj.properties.id}`}\n        latitude={obj.geometry.coordinates[1]}\n        longitude={obj.geometry.coordinates[0]}\n        offsetLeft={0}\n        offsetTop={-20}\n      >\n        <SingleMarker name={obj.properties.name}\n          access={obj.properties.access}\n          photoCount={obj.properties.photoCount}\n          onClick={() => onMarkerClick(obj)}\n          direction={currentZoom > 10 && obj.properties.direction ? obj.properties.direction : null}\n          active={selectedItem && selectedItem.properties.id === obj.properties.id}\n        />\n      </Marker>\n    )),\n    ...filteredClusteredData.cluster.map(obj => (\n      <Marker\n        className='clusterMarker'\n        key={`cluster-${obj.properties.id}`}\n        latitude={obj.geometry.coordinates[1]}\n        longitude={obj.geometry.coordinates[0]}\n        offsetLeft={-20}\n        offsetTop={-20}\n      >\n        <ClusterMarker\n          seriesCount={obj.properties.count}\n          photoCount={obj.properties.reducedPhotoCount}\n          onClick={() => onMarkerClick(obj)}\n          active={\n            selectedItem &&\n            selectedItem.properties.id === obj.properties.id &&\n            selectedItem.properties.count === obj.properties.count\n          }\n        />\n      </Marker>\n    ))\n  ]), [filteredClusteredData, selectedItem])\n\n  const selectedItemRender = useMemo(() => !!selectedItem && (\n    <Paper className={classes.selectedPopup}>\n      {selectedItem.properties.count === 1\n        ? <SeriesListItem\n          series={selectedItem.properties}\n          showCreatedOn\n          showLastPhoto\n          onClick={() => onSeriesClick(selectedItem.properties.id)}\n        />\n        : <ClusterSelected\n          seriesCount={selectedItem.properties.count}\n          reducedPhotoCount={selectedItem.properties.reducedPhotoCount}\n          onClose={() => updateSelectedItem(null)}\n          onZoomTo={() => onZoomTo(selectedItem)}\n        />\n      }\n    </Paper>\n  ), [selectedItem])\n\n  return (\n    <div className={classes.root} ref={homeMapContainerRef}>\n      <TopBar isTransparent className={classes.topBar}>\n        <SearchInput\n          isTransparent\n          onClick={onSearchClick}\n          defaultValue={''}\n        />\n      </TopBar>\n      {loading && (\n        <div className={classes.loadingWrapper}>\n          <CircularProgress size={80} thickness={7} color='inherit' />\n          {/* <Typography variant='h3' color='inherit'>Loading...</Typography> */}\n        </div>\n      )}\n\n      <BaseMap\n        showMe\n        // This should only change on INIT or transition events\n        viewport={mapViewObj.viewport}\n        transitions={transitions}\n        mapStyles={MapStyles}\n        controlPadding={{ top: 56 }}\n        initStyle={MapStyles.length > 1 ? 1 : 0}\n        {...lock}\n        onTransitionStart={() => {\n          // console.log('handletransitionStart')\n          setIsTransitioning(true)\n        }}\n        onTransitionEnd={() => {\n          // console.log('handletransitionEnd')\n          setIsTransitioning(false)\n          setTransitions(null)\n        }}\n        bounds={mapViewObj.bounds}\n        maxZoom={20}\n        minZoom={1}\n        onViewportChange={onViewportChange}\n        onNativeClick={() => {\n          if (selectedItem) updateSelectedItem(null)\n        }}\n      >\n        {markersRendered}\n      </BaseMap>\n\n      {selectedItemRender}\n    </div>\n  )\n}\n\nHomeMap.propTypes = {\n  seriesList: PropTypes.array,\n  queryVersion: PropTypes.number,\n  activeSeries: PropTypes.string,\n  initViewport: PropTypes.object,\n  loading: PropTypes.bool,\n  // These all get loaded up through mapFuncs in HomeMap.connect\n  onSearchClick: PropTypes.func,\n  onSeriesClick: PropTypes.func,\n  popMapHistory: PropTypes.func,\n  pushMapHistory: PropTypes.func,\n  clearMapHistory: PropTypes.func\n}\n\nexport default HomeMap\n\n// function getInitialState (initViewport) {\n//   return {\n//     viewport: { ...defaultView, ...initViewport.viewport },\n//     bounds: initViewport.bounds,\n//     filterBounds: null\n//   }\n// }\n","import React, { useEffect, useState, useRef, useMemo } from 'react'\nimport PropTypes from 'prop-types'\nimport { connect } from 'react-redux'\nimport { graphql } from 'react-apollo'\nimport { allSeries, pollQuery } from './queries'\nimport actions from '../redux/actions'\nimport { home } from '../config'\nimport HomeMap from '../components/maps/HomeMap'\n\nconst POLL_INTERVAL = 20 // (seconds)\n\n/**\n * The outer component handles the lastCheck variable which, when changed will\n * cause the poll event\n */\nconst HomeMapConnector = ({ initViewport, activeSeries, mapFuncs }) => {\n  const [seriesProps, setSeriesProps] = useState()\n  const [queryVersion, setVersion] = useState(0)\n  const updateIncrement = () => setVersion(queryVersion + 1)\n  const timerRef = useRef()\n  const [lastCheck, setLastCheck] = useState(null)\n  timerRef.current = lastCheck\n\n  // These are expensive queries so we render them memoized to prevent erroneous re-renders\n  const allSeriesQUERY = useMemo(() => <AllSeriesConnect setSeriesProps={setSeriesProps} />, [])\n  const pollSeriesQUERY = useMemo(() => <PollQueryConnect lastCheck={lastCheck} seriesProps={seriesProps} updateIncrement={updateIncrement} />, [lastCheck])\n\n  // Initiate the polling process. We simply update the timestamp every N seconds\n  useEffect(() => {\n    if (!seriesProps) return\n    function ping () {\n      if (timerRef.current) setLastCheck(String(Date.now() - POLL_INTERVAL * 1000))\n    }\n    if (!timerRef.current && seriesProps.readyForPolling) timerRef.current = setInterval(ping, POLL_INTERVAL * 1000)\n    return () => {\n      if (timerRef.current) {\n        console.log('clear poll timer')\n        clearInterval(timerRef.current)\n        timerRef.current = null\n      }\n    }\n  }, [seriesProps])\n\n  return (\n    <React.Fragment>\n      {allSeriesQUERY}\n      {pollSeriesQUERY}\n      <HomeMap\n        queryVersion={queryVersion}\n        seriesList={seriesProps && seriesProps.allSeries ? seriesProps.allSeries.seriesSummaries : []}\n        activeSeries={activeSeries}\n        initViewport={initViewport}\n        loading={seriesProps && seriesProps.loading}\n        {...mapFuncs}\n      />\n    </React.Fragment>\n  )\n}\nHomeMapConnector.propTypes = {\n  activeSeries: PropTypes.string, // from redux\n  initViewport: PropTypes.object, // from redux\n  mapFuncs: PropTypes.object // from redux passed straight through to the map\n\n}\n\nconst withAllSeries = graphql(allSeries, {\n  props: ({ data, ownProps }) => {\n    // If there's more data to load we should go get another batch\n    if (!data.loading && !data.error && data.allSeries && data.allSeries.seriesSummaries.length > 0 && data.allSeries.nextToken) {\n      data.fetchMore({\n        variables: { ...data.variables, nextToken: data.allSeries.nextToken },\n        // How do we mush the new query with the old one\n        updateQuery: (prev, { fetchMoreResult }) => {\n          return {\n            allSeries: {\n              ...fetchMoreResult.allSeries,\n              seriesSummaries: [ ...prev.allSeries.seriesSummaries, ...fetchMoreResult.allSeries.seriesSummaries ]\n            }\n          }\n        }\n      })\n    }\n    else if (data.loading || data.error) {\n      ownProps.setSeriesProps(data)\n    }\n    else {\n      ownProps.setSeriesProps({ ...data, readyForPolling: true })\n    }\n    return null\n  },\n  options: {\n    variables: { limit: 100 }\n  }\n})\n\n/**\n * Here's the graphql HOC that gets an individual series\n */\nconst withPollQuery = graphql(pollQuery, {\n  skip: ({ lastCheck }) => !lastCheck,\n  props: ({ data, ownProps: { seriesProps, updateIncrement } }) => {\n    if (data.error) {\n      console.log('POLL FAIL', data.error, data)\n      console.error(data.error)\n    }\n    if (!data.loading && data.changedSeries && data.changedSeries.seriesSummaries) {\n      // console.log('POLLING', { data, seriesProps })\n      const newData = data.changedSeries.seriesSummaries\n      const oldList = seriesProps.allSeries.seriesSummaries\n      console.log('DEBUG', seriesProps)\n      // If the polling has begun and we have some good polling data back then\n      // Process it and decide if we need to incorporate it\n      if (data.changedSeries) {\n        let newSeriesSummaries = seriesProps.allSeries.seriesSummaries\n        newData.forEach(({ seriesStatus, ...polledSeries }) => {\n          if (seriesStatus === 'deleted') {\n            console.log('Polling found a series to delete: ', polledSeries.id)\n            newSeriesSummaries = oldList.filter(s => s.id !== polledSeries.id)\n          }\n          else {\n            const idx = oldList.findIndex(ds => ds.id === polledSeries.id)\n            if (idx >= 0) {\n              console.log('Polling found a series to Update: ', polledSeries.id)\n              newSeriesSummaries = oldList.map((oldSeries, oldId) => oldId === idx ? polledSeries : oldSeries)\n            }\n            else {\n              console.log('Polling found a series to add: ', polledSeries.id)\n              newSeriesSummaries = [...oldList, polledSeries]\n            }\n          }\n          seriesProps.updateQuery((data, options) => {\n            try {\n              const newData = { ...data }\n              newData.allSeries.seriesSummaries = newSeriesSummaries\n              updateIncrement()\n              return data\n            }\n            catch (e) {\n              console.error(e)\n              return data\n            }\n          })\n        })\n      }\n    }\n    return null\n  },\n  options: ({ lastCheck }) => ({\n    variables: {\n      limit: 100,\n      lastCheck\n    }\n  })\n})\n\n// We're using graphql() HOC because it's convenient but it doesn't need to render anything\nconst AllSeriesConnect = withAllSeries(() => null)\nconst PollQueryConnect = withPollQuery(() => null)\n\n// The only part of the state the main view caes about is teh window\nconst mapStateToProps = (state, props) => {\n  const { current: { activeSeries } } = state.home\n  const initViewport = state.map.slice(-1).pop()\n  return { activeSeries, initViewport }\n}\n\n// There are a few presentational actions the main window can use\nconst mapDispatchToProps = dispatch => ({\n  mapFuncs: {\n    onSeriesClick: (activeSeries) => {\n      dispatch(actions.setHomeState(home.AppStateTypes.SERIES, { activeSeries }))\n    },\n    onSearchClick: () => {\n      dispatch(actions.setHomeState(home.AppStateTypes.SEARCH, { search: { tab: home.SEARCH_TABS.LOCATION, text: '' } }))\n    },\n    popMapHistory: () => {\n      dispatch(actions.popMapHistory())\n    },\n    pushMapHistory: (viewportSave) => {\n      dispatch(actions.pushMapHistory(viewportSave))\n    },\n    clearMapHistory: () => {\n      dispatch(actions.clearMapHistory())\n    }\n  }\n})\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(HomeMapConnector)\n","import React from 'react'\nimport classNames from 'classnames'\nimport PropTypes from 'prop-types'\nimport List from '@material-ui/core/List'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemAvatar from '@material-ui/core/ListItemAvatar'\nimport ListItemText from '@material-ui/core/ListItemText'\nimport ListItemIcon from '@material-ui/core/ListItemIcon'\nimport IconButton from '@material-ui/core/IconButton'\nimport Avatar from '@material-ui/core/Avatar'\n\nimport PlaceIcon from '@material-ui/icons/Place'\nimport PersonIcon from '@material-ui/icons/Person'\nimport LabelIcon from '@material-ui/icons/Label'\nimport CancelIcon from '@material-ui/icons/Cancel'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport { Typography } from '@material-ui/core'\nconst useStyles = makeStyles(theme => ({\n  root: {\n\n  },\n  chosenItem: {\n    color: theme.palette.primary.contrastText,\n    background: theme.palette.primary.dark\n  },\n  avatar: {\n    background: theme.palette.primary.main\n  },\n  closeIcon: {\n    color: theme.palette.primary.contrastText,\n    paddingRight: 0\n  },\n  avatarImg: {\n    height: '100%',\n    width: '100%',\n    objectFit: 'cover'\n  }\n}))\n\nconst SearchContextItem = ({ className, variant, name, description, gravatar, onClick, onCancel }) => {\n  const classes = useStyles()\n  let TheIcon = PlaceIcon\n\n  const getAvatar = (src) => () => (\n    <Avatar className={classes.avatar}>\n      <img className={classes.avatarImg} alt='profile' src={src} />\n    </Avatar>\n  )\n\n  switch (variant) {\n    case 'tag':\n      TheIcon = LabelIcon\n      break\n    case 'location':\n      TheIcon = PlaceIcon\n      break\n    case 'user':\n      TheIcon = gravatar ? getAvatar(gravatar) : PersonIcon\n      break\n    default:\n      break\n  }\n  return (\n    <ListItem\n      className={classNames(className, classes.root, onCancel ? classes.chosenItem : null)}\n      button={!!onClick}\n      onClick={onClick}\n    >\n      <ListItemAvatar>\n        <Avatar className={classes.avatar}>\n          <TheIcon color='inherit' />\n        </Avatar>\n      </ListItemAvatar>\n      <ListItemText disableTypography>\n        <Typography variant='body1' color='inherit'>{name}</Typography>\n        <Typography variant='body2' color='inherit'>{description}</Typography>\n      </ListItemText>\n      {onCancel && (\n        <ListItemIcon>\n          <IconButton onClick={onCancel} className={classes.closeIcon}>\n            <CancelIcon color='inherit' />\n          </IconButton>\n        </ListItemIcon>\n      )}\n    </ListItem>\n  )\n}\n\nSearchContextItem.propTypes = {\n  variant: PropTypes.oneOf(['tag', 'location', 'user']),\n  onClick: PropTypes.func,\n  gravatar: PropTypes.string,\n  className: PropTypes.string,\n  name: PropTypes.string.isRequired,\n  description: PropTypes.string,\n  onCancel: PropTypes.func\n}\n\nexport default SearchContextItem\n\nexport const SearchContexItemCosmos = () => {\n  return (\n    <List>\n      <SearchContextItem variant='tag' name='SomeTag' description='Some description of what I am' />\n      <SearchContextItem variant='location' name='Some Location' description='Some description of what I am' />\n      <SearchContextItem variant='user' name='User McUserSon' description='Some description of what I am' />\n    </List>\n  )\n}\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport List from '@material-ui/core/List'\nimport Typography from '@material-ui/core/Typography'\n\nimport SearchContextItem from './SearchContextItem'\n// import MenuIcon from '@material-ui/icons/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    height: '100%',\n    backgroundColor: theme.palette.background.paper,\n    position: 'relative',\n    overflowX: 'hidden',\n    overflowY: 'scroll',\n    flexGrow: 1\n  },\n  listSection: {\n    backgroundColor: 'inherit'\n  },\n  placeholderText: {\n    textAlign: 'center',\n    padding: theme.spacing(3, 1),\n    color: theme.palette.grey[400]\n  },\n  ul: {\n    backgroundColor: 'inherit',\n    padding: 0\n  }\n}))\n\nconst SearchContextResults = ({ variant, loading, contextResults, setContextChoice }) => {\n  const classes = useStyles()\n  if (loading) {\n    return <Typography className={classes.placeholderText} variant='h3'>Searching...</Typography>\n  }\n  else if (!contextResults || contextResults.length === 0) {\n    return <Typography className={classes.placeholderText} variant='h4'>No {variant} results</Typography>\n  }\n\n  return (\n    <List className={classes.root}>\n      {contextResults.map((cr, idx) => (\n        <SearchContextItem\n          key={`scr-${idx}`}\n          variant={variant}\n          onClick={() => setContextChoice(cr)}\n          {...cr}\n        />\n      ))}\n    </List>\n  )\n}\n\nSearchContextResults.propTypes = {\n  variant: PropTypes.oneOf(['tag', 'location', 'user']),\n  loading: PropTypes.bool,\n  contextResults: PropTypes.array.isRequired,\n  setContextChoice: PropTypes.func.isRequired\n}\n\nexport default SearchContextResults\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\n// import MenuIcon from '@material-ui/icons/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nconst useStyles = makeStyles(theme => ({\n  root: {\n    textAlign: 'center',\n    fontStyle: 'italic',\n    padding: theme.spacing(2, 1)\n  }\n}))\n\nconst SearchEnder = ({ style, icon, text }) => {\n  const classes = useStyles()\n  return (\n    <Typography className={classes.root} variant='subtitle1' color='textSecondary' component='div' style={style}>\n      {icon}\n      {text}\n    </Typography>\n  )\n}\n\nSearchEnder.propTypes = {\n  style: PropTypes.object,\n  icon: PropTypes.any,\n  text: PropTypes.string\n}\n\nexport default SearchEnder\n","import React, { useRef, useEffect } from 'react'\nimport PropTypes from 'prop-types'\nimport List from '@material-ui/core/List'\nimport Typography from '@material-ui/core/Typography'\n\nimport SearchContextItem from './SearchContextItem'\nimport SearchEnder from './SearchEnder'\n// import MenuIcon from '@material-ui/icons/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nimport SeriesListItem from '../misc/SeriesListItem'\nimport { debounce } from '../../lib/util'\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    height: '100%',\n    flexGrow: 1,\n    display: 'flex',\n    flexDirection: 'column',\n    overflow: 'hidden'\n  },\n  ctxItem: {\n    flexGrow: 0\n  },\n  list: {\n    flexGrow: 1,\n    backgroundColor: theme.palette.background.paper,\n    position: 'relative',\n    overflowX: 'hidden',\n    overflowY: 'scroll'\n  },\n  placeholderText: {\n    textAlign: 'center',\n    padding: theme.spacing(3, 1),\n    color: theme.palette.grey[400]\n  },\n  listSection: {\n    backgroundColor: 'inherit'\n  },\n  ul: {\n    backgroundColor: 'inherit',\n    padding: 0\n  }\n}))\n\nconst SearchResults = ({ variant, loading, seriesList, contextChoice, onCancel, onResultClick, fetchMore }) => {\n  const classes = useStyles()\n  const listRef = useRef()\n  const enderRef = useRef()\n\n  const handleScroll = debounce(() => {\n    if (!loading && fetchMore && enderRef.current && listRef.current) {\n      const { offsetTop } = enderRef.current\n      const { scrollTop, offsetHeight } = listRef.current\n      const scrollBottom = offsetHeight + scrollTop\n      if (offsetTop < scrollBottom * 2) {\n        console.log('SCROLL', { offsetHeight, scrollTop, offsetTop })\n        fetchMore()\n      }\n    }\n  }, 500)\n\n  useEffect(handleScroll, [seriesList])\n\n  let content = null\n  if (loading) {\n    content = (\n      <Typography className={classes.placeholderText} variant='h3'>Searching...</Typography>\n    )\n  }\n  else if (seriesList && seriesList.length > 0) {\n    content = seriesList.map((series, idx) => (\n      <SeriesListItem\n        key={`series-${idx}`}\n        series={series}\n        onClick={() => onResultClick(series.id)}\n        showCreatedOn\n        showLastPhoto\n      />\n    ))\n    content.push(\n      <div key='ender' ref={enderRef}>\n        <SearchEnder text={fetchMore ? 'Loading...' : 'No More Results'} />\n      </div>\n    )\n  }\n  else {\n    content = (\n      <Typography className={classes.placeholderText} variant='h4'>No series found</Typography>\n    )\n  }\n\n  return (\n    <div className={classes.root}>\n      <SearchContextItem className={classes.ctxItem} {...contextChoice} variant={variant} onCancel={onCancel} />\n      <List className={classes.list} subheader={<li />} onScroll={handleScroll} innerRef={listRef}>\n        {content}\n      </List>\n    </div>\n  )\n}\n\nSearchResults.propTypes = {\n  variant: PropTypes.oneOf(['tag', 'location', 'user']),\n  seriesList: PropTypes.array.isRequired,\n  loading: PropTypes.bool,\n  contextChoice: PropTypes.object.isRequired,\n  onResultClick: PropTypes.func.isRequired,\n  onCancel: PropTypes.func.isRequired,\n  fetchMore: PropTypes.func\n}\n\nexport default SearchResults\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\nimport Typography from '@material-ui/core/Typography'\n// import MenuIcon from '@material-ui/icons/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nconst useStyles = makeStyles(theme => ({\n  root: {\n    flexGrow: 1,\n    padding: '10%',\n    display: 'flex',\n    flexDirection: 'column',\n    opacity: 0.3,\n    textAlign: 'center'\n  },\n  icon: {\n    width: '100%',\n    flex: '1 1 40%',\n    color: theme.palette.primary.light,\n    opacity: 0.5\n  },\n  primary: {\n    flex: '1 1 30%',\n    width: '100%'\n  },\n  secondary: {\n    flex: '1 1 30%',\n    width: '100%'\n  }\n}))\n\nconst SearchPlaceholder = ({ icon, primary, secondary }) => {\n  const classes = useStyles()\n  const PlaceholderIcon = icon\n  return (\n    <div className={classes.root}>\n      <PlaceholderIcon className={classes.icon} />\n      {primary && (\n        <Typography className={classes.primary} variant='h3'>\n          {primary}\n        </Typography>\n      )}\n      {secondary && (\n        <Typography className={classes.secondary} variant='h4'>\n          {secondary}\n        </Typography>\n      )}\n    </div>\n  )\n}\n\nSearchPlaceholder.propTypes = {\n  icon: PropTypes.object,\n  primary: PropTypes.string,\n  secondary: PropTypes.string\n}\n\nexport default SearchPlaceholder\n","import React, { useEffect } from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport Tabs from '@material-ui/core/Tabs'\nimport Tab from '@material-ui/core/Tab'\n\nimport SearchContextResults from './SearchContextResults'\nimport SearchResults from './SearchResults'\nimport SearchPlaceholder from './SearchPlaceholder'\nimport TopBar from '../TopBar'\nimport SearchInput from './SearchInput'\nimport useOnline from '../../lib/useOnline'\nimport { home } from '../../config'\nimport PortableWifiOffIcon from '@material-ui/icons/PortableWifiOff'\nimport LabelIcon from '@material-ui/icons/Label'\nimport PlaceIcon from '@material-ui/icons/Place'\nimport PersonIcon from '@material-ui/icons/Person'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst TABS = home.SEARCH_TABS\n\nconst style = theme => ({\n  root: {\n    height: '100%',\n    display: 'flex',\n    overflow: 'hidden',\n    flexDirection: 'column'\n  },\n  tabs: {\n    // backgroundColor: theme.palette.primary.main,\n    // color: theme.palette.primary.contrastText,\n    // background: `linear-gradient(90deg, ${theme.palette.primary.dark} 0%, ${theme.palette.secondary.dark} 100%)`\n\n  },\n  ListWrapper: {\n    flexGrow: 1,\n    overflow: 'hidden',\n    display: 'flex',\n    flexDirection: 'column'\n  },\n  tab: {\n    flexGrow: 1\n  },\n  grow: {\n    flexGrow: 1\n  }\n})\n\nconst useStyles = makeStyles(style)\n\nconst Search = ({\n  onMenuBack, currentTab, setCurrentTab, defaultText, searchText,\n  setSearchText, contextResults, searchResults, contextChoice,\n  loading, setContextChoice, onMapClick, onResultClick, fetchMore\n}) => {\n  const classes = useStyles()\n\n  const { online } = useOnline()\n\n  // If there's only one thing then use it\n  useEffect(() => {\n    if (contextResults && !searchResults && contextResults.length === 1) {\n      setContextChoice(contextResults[0])\n    }\n  }, [contextResults])\n\n  let placeholder = {}\n  switch (currentTab) {\n    case TABS.TAG:\n      placeholder = { primary: 'Tag search', secondary: 'example: \\'beaver...\\'', icon: LabelIcon }\n      break\n    case TABS.USER:\n      placeholder = { primary: 'User search', secondary: 'example: \\'SuperGreg123...\\'', icon: PersonIcon }\n      break\n    case TABS.LOCATION:\n      placeholder = { primary: 'Location Search', secondary: 'example: \\'Vancouver...\\'', icon: PlaceIcon }\n      break\n\n    default:\n      break\n  }\n\n  let content = null\n  if (!online) {\n    content = (\n      <SearchPlaceholder\n        primary='Search Disabled'\n        secondary='(Offline)'\n        icon={PortableWifiOffIcon}\n      />\n    )\n  }\n  else if (contextChoice && searchResults) {\n    content = (\n      <SearchResults\n        variant={currentTab}\n        loading={loading}\n        onResultClick={onResultClick}\n        fetchMore={fetchMore}\n        seriesList={searchResults}\n        contextChoice={contextChoice}\n        onCancel={() => setContextChoice(null)}\n      />\n    )\n  }\n  else if (contextResults) {\n    content = (\n      <SearchContextResults\n        loading={loading}\n        variant={currentTab}\n        contextResults={contextResults}\n        setContextChoice={currentTab === TABS.LOCATION ? onMapClick : setContextChoice}\n      />\n    )\n  }\n  else if (defaultText.length > 0) {\n    content = (\n      <Typography>Searching for {`'${searchText}'` || '...'}</Typography>\n    )\n  }\n  else {\n    content = <SearchPlaceholder {...placeholder} />\n  }\n\n  return (\n    <div className={classes.root}>\n      <TopBar>\n        <SearchInput\n          disabled={!online}\n          // autoFocus\n          onChange={setSearchText}\n          defaultValue={searchText}\n        />\n      </TopBar>\n      {online && (\n        <Tabs\n          value={currentTab}\n          disabled={!online}\n          onChange={(e, val) => setCurrentTab(val)}\n          indicatorColor='primary'\n          classes={{ flexContainer: classes.tabs }}\n          centered\n        >\n          <Tab className={classes.tab} value={TABS.TAG} label='Tags' />\n          <Tab className={classes.tab} value={TABS.LOCATION} label='Places' />\n          <Tab className={classes.tab} value={TABS.USER} label='Users' />\n        </Tabs>\n      )}\n      <div className={classes.ListWrapper} >\n        {content}\n      </div>\n    </div>\n  )\n}\n\nSearch.propTypes = {\n  onMenuBack: PropTypes.func.isRequired,\n  loading: PropTypes.bool,\n  currentTab: PropTypes.string.isRequired,\n  setCurrentTab: PropTypes.func.isRequired,\n  searchText: PropTypes.string.isRequired,\n  setSearchText: PropTypes.func.isRequired,\n  fetchMore: PropTypes.func,\n  contextResults: PropTypes.array,\n  searchResults: PropTypes.array,\n  contextChoice: PropTypes.object,\n  setContextChoice: PropTypes.func.isRequired,\n  onMapClick: PropTypes.func.isRequired,\n  onResultClick: PropTypes.func.isRequired\n}\nSearch.defaultProps = {\n  currentTab: TABS.TAGS,\n  defaultText: ''\n}\n\nexport default Search\n","import React, { useState, useMemo } from 'react'\nimport PropTypes from 'prop-types'\nimport { home } from '../config'\n// import { smallestHash } from 'geotilehash'\nimport { graphql, compose } from 'react-apollo'\nimport { point, bbox as bboxFunc, buffer } from '@turf/turf'\n\nimport { connect } from 'react-redux'\nimport actions from '../redux/actions'\nimport { tagSearch, seriesWithTag, userSearch, userSeries, geocode } from './queries'\nimport Search from '../components/Search/Search'\n// import { AppContext } from '../contexts'\n// import { debounce } from '../lib/util'\nimport { formatDatAgo } from '../lib/datelib'\n\nconst SearchConnect = ({\n  jumpToMap, jumpToSeries, defaultTab, defaultText, fetchMore\n}) => {\n  // const { role, user } = useContext(AppContext)\n\n  const [currentTab, setCurrentTab] = useState(defaultTab || home.SEARCH_TABS.TAG)\n  // We separate these because one of them needs to be immediate and the\n  const [searchText, setSearchText] = useState(defaultText || '')\n  const [contextChoice, setContextChoice] = useState(null)\n\n  const handleTabChange = (newTab) => {\n    setContextChoice(null)\n    setCurrentTab(newTab)\n  }\n  const handleContextChoiceChange = (newContextChoice) => {\n    setContextChoice(newContextChoice)\n  }\n  const handleSearchTextChange = (text) => {\n    setSearchText(text)\n    setContextChoice(null)\n  }\n\n  let withContextQuery = null\n  let withSearchQuery = null\n\n  switch (currentTab) {\n    case home.SEARCH_TABS.TAG:\n      withContextQuery = withTagSearch\n      withSearchQuery = withTagSeries\n      break\n    case home.SEARCH_TABS.LOCATION:\n      withContextQuery = withGeoCode\n      // withSearchQuery = withGeoSearch\n      break\n    case home.SEARCH_TABS.USER:\n      withContextQuery = withUserSearch\n      withSearchQuery = withUserSeries\n      break\n    default:\n      break\n  }\n\n  const ComposedSearch = useMemo(() => withSearchQuery\n    ? compose(\n      withContextQuery,\n      withSearchQuery\n    )(Search)\n    : withContextQuery(Search), [withContextQuery, withSearchQuery])\n\n  return <ComposedSearch {...{ currentTab, searchText, contextChoice }}\n    onMenuBack={() => {}}\n    onMapClick={jumpToMap}\n    onResultClick={jumpToSeries}\n    setContextChoice={handleContextChoiceChange}\n    fetchMore={fetchMore}\n    setCurrentTab={handleTabChange}\n    setSearchText={handleSearchTextChange}\n  />\n}\nSearchConnect.propTypes = {\n  searchResults: PropTypes.array,\n  contextResults: PropTypes.array,\n  loading: PropTypes.bool,\n  jumpToMap: PropTypes.func,\n  jumpToSeries: PropTypes.func,\n  fetchMore: PropTypes.func\n}\n/*****************************************************************\n *  PART 1: SEARCH QUERIES\n *****************************************************************/\n\n/**\n * Here's the graphql HOC that gets an individual series\n */\nconst withTagSearch = graphql(tagSearch, {\n  props: ({ data }) => {\n    if (data.error) console.error(data.error)\n    // console.log('withTagSearch', data)\n    let series = null\n    try {\n      if (!data.loading && !data.error) series = data.series\n    }\n    catch (e) {\n      console.error(data)\n      console.error(e)\n    }\n    const contextResults = data.tags ? data.tags.map(({ name, count }) => ({\n      name,\n      description: `~ ${count < 10 ? count : Math.ceil(count / 10) * 10} Photo series tagged`\n    })) : []\n\n    return {\n      contextResults,\n      loading: data.loading,\n      series\n    }\n  },\n  // skip: ({ searchText }) => !searchText || searchText.length < 3,\n  options: ({ searchText }) => ({\n    variables: {\n      tag: !searchText || searchText.length < 3 ? '' : searchText,\n      limit: 10\n    }\n  })\n})\n\nconst withUserSearch = graphql(userSearch, {\n  props: ({ data }) => {\n    if (data.error) console.error(data.error)\n    // console.log('withUserSearch', data)\n    let series = null\n    try {\n      if (!data.loading && !data.error) series = data.series\n    }\n    catch (e) {\n      console.error(data)\n      console.error(e)\n    }\n\n    const contextResults = data.userSearch ? data.userSearch.map(({ username, gravatar, createdOn, id }) => ({\n      name: username,\n      id,\n      description: `Joined ${formatDatAgo(createdOn)}`,\n      gravatar\n    })) : []\n\n    return {\n      contextResults,\n      loading: data.loading,\n      series\n    }\n  },\n  skip: ({ searchText }) => !searchText || searchText.length < 3,\n  options: ({ searchText }) => ({\n    variables: {\n      searchStr: searchText,\n      limit: 10\n    }\n  })\n})\n\nconst withGeoCode = graphql(geocode, {\n  props: ({ data }) => {\n    if (data.error) console.error(data.error)\n    // console.log('withGeoCode', data)\n    let series = null\n    try {\n      if (!data.loading && !data.error) series = data.series\n    }\n    catch (e) {\n      console.error(data)\n      console.error(e)\n    }\n\n    const contextResults = data.geocoder ? data.geocoder.map(({ relevance, text, placeName, bbox, center }) => ({\n      name: text,\n      description: placeName,\n      bbox,\n      center,\n      relevance\n    })) : []\n\n    return {\n      contextResults,\n      loading: data.loading,\n      series\n    }\n  },\n  skip: ({ searchText }) => !searchText || searchText.length < 3,\n  options: ({ searchText }) => ({\n    variables: {\n      search: searchText\n      // limit: 10\n    }\n  })\n})\n\n/*****************************************************************\n * PART 2: SERIES SEARCH QUERIES\n *****************************************************************/\n\nconst withTagSeries = graphql(seriesWithTag, {\n  props: ({ data }) => {\n    if (data.error) console.error(data.error)\n    // console.log('withTagSeries', data)\n    let series = null\n    try {\n      if (!data.loading && !data.error) series = data.series\n    }\n    catch (e) {\n      console.error(data)\n      console.error(e)\n    }\n\n    // A second Thunk function designed to get more elements in the feed history\n    const fetchMore = data.loading || !data.tagSeries || !data.tagSeries.nextToken ? null : () => {\n      console.log('fetchMore', data)\n      data.fetchMore({\n        variables: { ...data.variables, nextToken: data.tagSeries.nextToken },\n        // How do we mush the new query with the old one\n        updateQuery: (prev, { fetchMoreResult }) => {\n          return {\n            tagSeries: {\n              ...fetchMoreResult.tagSeries,\n              seriesSummaries: [ ...prev.tagSeries.seriesSummaries, ...fetchMoreResult.tagSeries.seriesSummaries ]\n            }\n          }\n        }\n      })\n    }\n\n    const searchResults = data.tagSeries && data.tagSeries.seriesSummaries\n      ? data.tagSeries.seriesSummaries\n      : []\n\n    return {\n      searchResults,\n      fetchMore,\n      loading: data.loading,\n      series\n    }\n  },\n  skip: ({ contextChoice }) => !contextChoice,\n  options: ({ contextChoice }) => ({\n    variables: {\n      tag: contextChoice.name,\n      limit: 10\n    }\n  })\n})\n\nconst withUserSeries = graphql(userSeries, {\n  props: ({ data }) => {\n    if (data.error) console.error(data.error)\n    // console.log('withUserSeries', data)\n    let series = null\n    try {\n      if (!data.loading && !data.error) series = data.series\n    }\n    catch (e) {\n      console.error(data)\n      console.error(e)\n    }\n\n    // A second Thunk function designed to get more elements in the feed history\n    const fetchMore = data.loading || !data.userSeries || !data.userSeries.nextToken ? null : () => {\n      console.log('fetchMore', data)\n      data.fetchMore({\n        variables: { ...data.variables, nextToken: data.userSeries.nextToken },\n        // How do we mush the new query with the old one\n        updateQuery: (prev, { fetchMoreResult }) => {\n          return {\n            userSeries: {\n              ...fetchMoreResult.userSeries,\n              seriesSummaries: [ ...prev.userSeries.seriesSummaries, ...fetchMoreResult.userSeries.seriesSummaries ]\n            }\n          }\n        }\n      })\n    }\n\n    const searchResults = data.userSeries && data.userSeries.seriesSummaries\n      ? data.userSeries.seriesSummaries\n      : []\n\n    return {\n      searchResults,\n      fetchMore,\n      loading: data.loading,\n      series\n    }\n  },\n  skip: ({ contextChoice }) => !contextChoice,\n  options: ({ contextChoice }) => ({\n    variables: {\n      createdBy: contextChoice.id,\n      limit: 10\n    }\n  })\n})\n\n// const withGeoSearch = graphql(geoSeries, {\n//   props: ({ data }) => {\n//     if (data.error) console.error(data.error)\n//     // console.log('HERE', data)\n//     let series = null\n//     try {\n//       if (!data.loading && !data.error) series = data.series\n//     }\n//     catch (e) {\n//       console.error(data)\n//       console.error(e)\n//     }\n//     return {\n//       data,\n//       loading: data.loading,\n//       series\n//     }\n//   },\n//   skip: ({ contextChoice }) => !contextChoice,\n//   options: ({ contextChoice }) => ({\n//     variables: {\n//       bounds: contextChoice.bbox\n//       // limit: 10\n//       // nextToken\n//     }\n//   })\n// })\n\n/**\n * Map our redux state and functions\n */\nconst mapStateToProps = (state, props) => {\n  const { current: { search, activeSeries, domain } } = state.home\n  return {\n    defaultTab: search ? search.tab : null,\n    defaultText: search ? search.text : null,\n    activeSeries,\n    domain\n  }\n}\n\nconst mapDispatchToProps = dispatch => ({\n  onBack: () => {\n    dispatch(actions.homeStateBack())\n  },\n  queueUpload: (uploadObj) => {\n    dispatch(actions.queueUpload(uploadObj))\n  },\n  jumpToSeries: (seriesId) => {\n    dispatch(actions.setHomeState(home.AppStateTypes.SERIES, { activeSeries: seriesId }))\n  },\n\n  jumpToMap: ({ bbox, center }) => {\n    let bounds = bbox\n    if (!bounds && center) {\n      const bufferPts = buffer(point(center), 500, { units: 'meters' })\n      bounds = bboxFunc(bufferPts)\n    }\n\n    if (bounds) {\n      dispatch(actions.pushMapHistory({\n        mode: home.MapModeTypes.FREE,\n        bounds: bounds\n      }))\n      dispatch(actions.setHomeState(home.AppStateTypes.MAP, { activeSeries: null, initialPhoto: null }))\n    }\n  }\n})\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(SearchConnect)\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemText from '@material-ui/core/ListItemText'\nimport ListItemIcon from '@material-ui/core/ListItemIcon'\n// import MenuIcon from '@material-ui/icons/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { formatDate } from '../../lib/datelib'\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n  },\n  imgContainer: {\n    flex: '0 0 100px',\n    // alignSelf: 'flex-start',\n    // height: '100%',\n    margin: theme.spacing(1, 1, 0, 2)\n  },\n  gravatarImg: {\n    verticalAlign: 'top'\n    // objectFit: 'cover',\n    // height: '100%',\n    // width: '100%'\n  }\n}))\n\nconst MeCard = ({ user, loading, onAvatarClick }) => {\n  const classes = useStyles()\n\n  if (loading || !user) return 'LOADING...'\n  // console.log('USER', user)\n\n  return (\n    <ListItem className={classes.root} onClick={onAvatarClick} disableGutters>\n      <ListItemIcon className={classes.imgContainer}>\n        <img alt='profile' className={classes.gravatarImg} src={user.gravatar} />\n      </ListItemIcon>\n      <ListItemText\n        primary={user.username}\n        secondary={`Member since: ${formatDate(user.createdOn, 'LL')}`}\n      />\n    </ListItem>\n  )\n}\n\nMeCard.propTypes = {\n  user: PropTypes.object,\n  loading: PropTypes.bool,\n  onAvatarClick: PropTypes.func\n}\n\nexport default MeCard\n","import React, { useState, useContext } from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport Divider from '@material-ui/core/Divider'\nimport Tabs from '@material-ui/core/Tabs'\nimport Tab from '@material-ui/core/Tab'\n\nimport SeriesListItem from '../misc/SeriesListItem'\nimport { makeStyles } from '@material-ui/core/styles'\nimport TopBar from '../TopBar'\nimport MeCard from './MeCard'\nimport { Button } from '@material-ui/core'\n\nimport { AppContext } from '../../contexts'\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    background: theme.palette.background.paper,\n    display: 'flex',\n    flexDirection: 'column',\n    height: '100%'\n  },\n  filterContainer: {\n    color: theme.palette.primary.secondary,\n    background: theme.palette.background.default,\n    textAlign: 'center',\n    padding: theme.spacing(1, 1)\n  },\n  filterChip: {\n\n  },\n  seriesListItemWrap: {\n    margin: theme.spacing(1, 0.5)\n  },\n  seriesList: {\n    height: '100%',\n    overflowX: 'hidden',\n    overflowY: 'scroll'\n  },\n  tabs: {\n    // background: theme.palette.background.default\n  },\n  noneFound: {\n    color: theme.palette.text.secondary,\n    textAlign: 'center',\n    padding: theme.spacing(2)\n  }\n}))\n\nconst SORT = {\n  ACTIVITY: 'Last Photo',\n  CREATED: 'Created',\n  NAME: 'Name'\n}\n\nconst MyProfile = ({ mySeries, watchingSeries, loading, jumpToSeries, jumpToMap }) => {\n  const classes = useStyles()\n  const [currentTab, setCurrentTab] = useState(0)\n  const [sortVal, setSort] = useState(SORT.ACTIVITY)\n  const [sortAsc, setSortAsc] = useState(false)\n\n  const { user } = useContext(AppContext)\n\n  const sortSetter = (newSort) => {\n    if (newSort === sortVal) setSortAsc(!sortAsc)\n    else setSort(newSort)\n  }\n\n  let tabFeed = currentTab === 0 ? mySeries : watchingSeries\n\n  switch (sortVal) {\n    case SORT.ACTIVITY:\n      if (sortAsc) tabFeed.sort((a, b) => a.latest.takenOn - b.latest.takenOn)\n      else tabFeed.sort((a, b) => b.latest.takenOn - a.latest.takenOn)\n      break\n    case SORT.CREATED:\n      if (sortAsc) tabFeed.sort((a, b) => a.createdOn - b.createdOn)\n      else tabFeed.sort((a, b) => b.createdOn - a.createdOn)\n      break\n    case SORT.NAME:\n      if (sortAsc) {\n        tabFeed.sort((a, b) => {\n          if (a.name < b.name) {\n            return -1\n          }\n          if (a.name > b.firstname) {\n            return 1\n          }\n          return 0\n        })\n      }\n      else {\n        tabFeed.sort((a, b) => {\n          if (b.name < a.name) {\n            return -1\n          }\n          if (b.name > a.name) {\n            return 1\n          }\n          return 0\n        })\n      }\n      break\n    default:\n      break\n  }\n\n  return (\n    <div className={classes.root}>\n      <TopBar>\n        <Typography>My Profile</Typography>\n      </TopBar>\n      <MeCard user={user} />\n      {/* <Divider /> */}\n      <Tabs\n        value={currentTab}\n        onChange={(e, val) => setCurrentTab(val)}\n        indicatorColor='primary'\n        centered\n        classes={{ flexContainer: classes.tabs }}\n      >\n        <Tab className={classes.tab} value={0} label='My Series' />\n        <Tab className={classes.tab} value={1} label='Watching' />\n      </Tabs>\n      <Divider />\n      <div className={classes.filterContainer}>\n        <FilterSortItem asc={sortAsc} active={sortVal === SORT.NAME} onClick={() => sortSetter(SORT.NAME)} label={SORT.NAME} />\n        |\n        <FilterSortItem asc={sortAsc} active={sortVal === SORT.ACTIVITY} onClick={() => sortSetter(SORT.ACTIVITY)} label={SORT.ACTIVITY} />\n        |\n        <FilterSortItem asc={sortAsc} active={sortVal === SORT.CREATED} onClick={() => sortSetter(SORT.CREATED)} label={SORT.CREATED} />\n      </div>\n      <Divider />\n      <div className={classes.seriesList}>\n        {!loading && (!tabFeed || tabFeed.length === 0) && (\n          <Typography className={classes.noneFound} component='div'>No Series Found</Typography>\n        )}\n        {loading && (\n          <Typography className={classes.noneFound} component='div'>Loading...</Typography>\n        )}\n        {tabFeed.map((series, idx) => (\n          <SeriesListItem\n            key={`seriesListItem${idx}`}\n            series={series}\n            showCreatedOn\n            showLastPhoto\n            onClick={() => jumpToSeries(series.id)}\n          />\n        ))}\n      </div>\n    </div>\n  )\n}\n\nMyProfile.propTypes = {\n  loading: PropTypes.bool,\n  mySeries: PropTypes.array.isRequired,\n  watchingSeries: PropTypes.array.isRequired,\n  jumpToSeries: PropTypes.func.isRequired,\n  jumpToMap: PropTypes.func.isRequired\n}\n\nexport default MyProfile\n\nconst useFilterStyles = makeStyles(theme => ({\n  root: {\n    margin: theme.spacing(0, 1, 0, 1)\n  }\n}))\n\nconst FilterSortItem = ({ active, asc, onClick, label }) => {\n  const classes = useFilterStyles()\n\n  const arrow = asc === true ? '▲' : '▼'\n\n  return (\n    <Button\n      size='small'\n      className={classes.root}\n      onClick={onClick}\n      // variant='caption'\n      color={active ? 'secondary' : 'inherit'}\n    >\n      {label}\n      <span style={{ opacity: active ? 1 : 0 }}>\n        {arrow}\n      </span>\n    </Button>\n  )\n}\n\nFilterSortItem.propTypes = {\n  active: PropTypes.bool,\n  asc: PropTypes.bool,\n  onClick: PropTypes.func.isRequired,\n  label: PropTypes.string.isRequired\n}\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport { graphql, compose } from 'react-apollo'\nimport actions from '../redux/actions'\nimport { connect } from 'react-redux'\nimport { home } from '../config'\n\nimport { userSeries, seriesFromList } from './queries'\nimport MyProfile from '../components/MyProfile/MyProfile'\n\nconst ProfileConnect = ({ data, jumpToSeries, jumpToMap }) => {\n  const { seriesQ, watchedSeriesQ } = data\n\n  const mySeries = seriesQ && seriesQ.userSeries && seriesQ.userSeries.seriesSummaries ? seriesQ.userSeries.seriesSummaries : []\n  const watchingSeries = watchedSeriesQ && watchedSeriesQ.arraySeries ? watchedSeriesQ.arraySeries : []\n  // console.log('ProfileConnect', { mySeries, watchedSeriesQ, watchingSeries })\n\n  const loading = Boolean(\n    (seriesQ && seriesQ.loading) ||\n    (watchedSeriesQ && watchedSeriesQ.loading)\n  )\n\n  return <MyProfile {...{ loading, mySeries, watchingSeries, jumpToSeries, jumpToMap }} />\n}\n\nProfileConnect.propTypes = {\n  data: PropTypes.object, // from graphql\n  jumpToSeries: PropTypes.func, // from redux\n  jumpToMap: PropTypes.func // from redux\n}\n\nconst withuserSeriesQuery = graphql(userSeries, {\n  props: ({ data, ownProps }) => {\n    // console.log('ProfileConnect withuserSeriesQuery', { data, ownProps })\n    return { data: { ...ownProps.data, seriesQ: data } }\n  }\n})\n\nconst withMyWatchedSeriesQuery = graphql(seriesFromList, {\n  props: ({ data, ownProps }) => {\n    // console.log('ProfileConnect withMyWatchedSeriesQuery', { data, ownProps })\n    return { data: { ...ownProps.data, watchedSeriesQ: data } }\n  },\n  skip: ({ data, user }) => {\n    try {\n      return user.watching.length < 1\n    }\n    catch (e) {\n      return true\n    }\n  },\n  options: ({ data, user }) => {\n    return {\n      variables: { seriesList: user.watching }\n    }\n  }\n})\n\n/**\n * Compose all our queries together\n */\nconst queryWrapped = compose(\n  withuserSeriesQuery,\n  // withMyPhotosQuery,\n  withMyWatchedSeriesQuery\n)(ProfileConnect)\n\n/**\n * Map our redux state and functions\n */\nconst mapStateToProps = (state, props) => {\n  return { }\n}\n\nconst mapDispatchToProps = dispatch => ({\n  jumpToSeries: (seriesId) => {\n    dispatch(actions.setHomeState(home.AppStateTypes.SERIES, { activeSeries: seriesId }))\n  },\n  jumpToMap: (seriesId) => {\n    dispatch(actions.setHomeState(home.AppStateTypes.MAP, { activeSeries: seriesId }))\n  }\n})\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(queryWrapped)\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\n// import MenuIcon from '@material-ui/icons/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nconst useStyles = makeStyles(theme => ({\n  root: {\n    display: 'flex',\n    alignItems: 'center'\n  },\n  grow: { flexGrow: 1 },\n  text: {\n    textAlign: 'center',\n    fontStyle: 'italic',\n    padding: theme.spacing(2, 1)\n  }\n}))\n\nconst FeedEnder = ({ style, icon, text }) => {\n  const classes = useStyles()\n  return (\n    <div className={classes.root}>\n      <div className={classes.grow} />\n      {icon}\n      <Typography className={classes.text} variant='subtitle1' color='textSecondary' component='div' style={style}>\n        {text}\n      </Typography>\n      <div className={classes.grow} />\n    </div>\n  )\n}\n\nFeedEnder.propTypes = {\n  style: PropTypes.object,\n  icon: PropTypes.any,\n  text: PropTypes.string\n}\n\nexport default FeedEnder\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Avatar from '@material-ui/core/Avatar'\nimport IconButton from '@material-ui/core/IconButton'\n\nimport PlaceIcon from '@material-ui/icons/Place'\nimport { makeStyles } from '@material-ui/core/styles'\nconst useStyles = makeStyles(theme => ({\n  root: {\n    textAlign: 'center'\n  },\n  placeAvatar: {\n    color: theme.palette.primary.contrastText,\n    border: `2px solid ${theme.palette.primary.contrastText}`,\n    background: theme.palette.text.primary,\n    margin: 'auto'\n  },\n  placeIcon: {\n  }\n}))\n\nconst FindOnMapButton = ({ onClick }) => {\n  const classes = useStyles()\n  return (\n    <div className={classes.root}>\n      <Avatar className={classes.placeAvatar}>\n        <IconButton color='inherit' onClick={e => {\n          e.preventDefault()\n          e.stopPropagation()\n          onClick()\n        }}>\n          <PlaceIcon color='inherit' />\n        </IconButton>\n      </Avatar>\n      {/* <Typography variant='caption' component='div'>MAP</Typography> */}\n    </div>\n  )\n}\n\nFindOnMapButton.propTypes = {\n  onClick: PropTypes.func.isRequired\n}\n\nexport default FindOnMapButton\n","import React, { useContext } from 'react'\nimport PropTypes from 'prop-types'\nimport Paper from '@material-ui/core/Paper'\nimport Typography from '@material-ui/core/Typography'\n// import MenuIcon from '@material-ui/icons/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nimport FindOnMapButton from '../misc/FindOnMapButton'\n// import StarIcon from '@material-ui/icons/Star'\n// import StarBorderIcon from '@material-ui/icons/StarBorder'\nimport { Avatar } from '@material-ui/core'\nimport { AppContext } from '../../contexts'\nimport { formatDate } from '../../lib/datelib'\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    height: '100%',\n    // borderTop: `4px solid ${theme.palette.grey[700]}`\n    padding: theme.spacing(0.5, 1)\n  },\n  imgContainer: {\n    overflow: 'hidden',\n    height: '100%',\n    position: 'relative'\n  },\n  findOnMapButtonContainer: {\n    position: 'absolute',\n    opacity: 0.8,\n    bottom: theme.spacing(1),\n    right: theme.spacing(1)\n  },\n  titleContainer: {\n    background: '#444444AA',\n    textShadow: '1px 1px 10px black',\n    color: 'white',\n    position: 'absolute',\n    alignItems: 'center',\n    display: 'flex',\n    top: 0,\n    width: '100%',\n    paddingRight: theme.spacing(1)\n  },\n  avatar: {\n    border: '1px solid white',\n    margin: theme.spacing(0, 1)\n  },\n  title: {\n    flex: '1 1 50%',\n    overflow: 'hidden'\n  },\n  seriesName: {\n    textOverflow: 'ellipsis',\n    whiteSpace: 'nowrap',\n    overflow: 'hidden'\n  },\n  img: {\n    objectFit: 'cover',\n    height: '100%',\n    width: '100%'\n  },\n  gravatarImg: {\n    width: '100%'\n  }\n}))\n\nconst EVENT_VERBS = {\n  DELETE: 'Deleted',\n  ADD: 'Added'\n}\n\nconst FeedItem = ({ event, onMapClick, onImageClick, onProfileClick, onSeriesClick }) => {\n  const { series, photo } = event\n  // console.log('EVENT', { series, relation, photo })\n  const classes = useStyles()\n  const { getPhotoUrl } = useContext(AppContext)\n  return (\n    <div className={classes.root}>\n      <Paper className={classes.imgContainer}>\n        <img\n          alt='medium'\n          className={classes.img}\n          src={getPhotoUrl(photo, 'medium')}\n          onClick={() => onImageClick(series.id, photo.id)}\n        />\n        <div className={classes.titleContainer}>\n          <Avatar onClick={() => onProfileClick(photo.createdUser.username)} className={classes.avatar}>\n            <img alt='profile' className={classes.gravatarImg} src={photo.createdUser.gravatar} />\n          </Avatar>\n          <div className={classes.title}>\n            <Typography className={classes.seriesName} variant='body1' color='inherit'>{series.name}</Typography>\n            <Typography variant='body2' color='inherit'>{photo.createdUser.username} {EVENT_VERBS.ADD} a photo</Typography>\n            <Typography variant='caption' color='inherit'>{formatDate(photo.updatedOn)}</Typography>\n          </div>\n          <FindOnMapButton onClick={() => onMapClick(series.id, photo.id)} />\n        </div>\n      </Paper>\n    </div>\n  )\n}\n\nFeedItem.propTypes = {\n  // TODO: THIS IS NOT THE SHAPE WE WANT. NEED TO HASH THIS OUT\n  event: PropTypes.object.isRequired,\n  onSeriesClick: PropTypes.func.isRequired,\n  onImageClick: PropTypes.func.isRequired,\n  onProfileClick: PropTypes.func.isRequired,\n  onMapClick: PropTypes.func.isRequired\n}\n\nexport default FeedItem\n\nexport const FeedItemCosmos = (props) => {\n  return (\n    <div>\n      <FeedItem {...props} />\n      <FeedItem {...props} />\n      <FeedItem {...props} />\n      <FeedItem {...props} />\n      <FeedItem {...props} />\n      <FeedItem {...props} />\n      <FeedItem {...props} />\n      <FeedItem {...props} />\n      <FeedItem {...props} />\n      <FeedItem {...props} />\n      <FeedItem {...props} />\n    </div>\n  )\n}\nFeedItemCosmos.propTypes = {\n  // TODO: THIS IS NOT THE SHAPE WE WANT. NEED TO HASH THIS OUT\n  event: PropTypes.object.isRequired\n}\n","import React, { useRef } from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\n\nimport { List } from 'react-virtualized' // InfiniteLoader\nimport useOnline from '../../lib/useOnline'\nimport FeedEnder from './FeedEnder'\n\nimport ErrorIcon from '@material-ui/icons/Error'\nimport { makeStyles } from '@material-ui/core/styles'\nimport FeedItem from './FeedItem'\n\nimport TopBar from '../TopBar'\n\nimport useComponentSize from '../../lib/useComponentSize'\nimport { CircularProgress } from '@material-ui/core'\n\nconst ROWHEIGHT = 300\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    display: 'flex',\n    flexDirection: 'column',\n    height: '100%'\n  },\n  listContainer: {\n    flexGrow: 1,\n    overflow: 'hidden'\n  },\n  vList: {\n    height: '100%',\n    width: '100%'\n  },\n  feedContainer: {\n    flexGrow: 1,\n    // Promote the list into his own layer on Chrome. This cost memory but helps keeping high FPS.\n    transform: 'translateZ(0)'\n  },\n  grow: {\n    flexGrow: 1\n  }\n}))\n\nconst MyFeed = ({\n  events, loading, onMapClick, onImageClick, onProfileClick,\n  onSeriesClick, fetchNewest, fetchMore, window\n}) => {\n  const classes = useStyles()\n  const listRef = useRef()\n  const { size } = useComponentSize(listRef)\n  const { online } = useOnline()\n\n  const rowRenderer = ({\n    index, // Index of row\n    isScrolling, // The List is currently being scrolled\n    isVisible, // This row is visible within the List (eg it is not an overscanned row)\n    key, // Unique key within array of rendered rows\n    parent, // Reference to the parent List (instance)\n    style // Style object to be applied to row (to position it);\n    // This must be passed through to the rendered row element.\n  }) => {\n    const row = events[index]\n    let content\n    if (index < events.length && row) {\n      content = <FeedItem\n        event={events[index]}\n        onSeriesClick={onSeriesClick}\n        onImageClick={onImageClick}\n        onProfileClick={onProfileClick}\n        onMapClick={onMapClick}\n      />\n    }\n    else if (index === events.length) {\n      // content = <div className={classes.placeholder} style={{ width: row.size }} />\n      const wEnd = window && window[0] === 0\n      content = <FeedEnder icon={<CircularProgress size={30} thickness={2} color='inherit' />} text='Loading...' />\n\n      const almostAtEnd = ROWHEIGHT * 4 + parent.state.scrollTop > style.top\n\n      if (!online) {\n        content = <FeedEnder icon={<ErrorIcon />} text='Cannot Refresh Offline' />\n      }\n      else if (wEnd) {\n        content = <FeedEnder text='End of feed' />\n      }\n      // Only if we're online, not loading and visible\n      else if (!loading && almostAtEnd) {\n        fetchMore()\n      }\n    }\n\n    return (\n      <div className={classes.row} key={key} style={style}>\n        {content}\n      </div>\n    )\n  }\n  rowRenderer.propTypes = {\n    index: PropTypes.any,\n    key: PropTypes.any,\n    style: PropTypes.any,\n    isScrolling: PropTypes.any,\n    isVisible: PropTypes.any,\n    parent: PropTypes.any\n  }\n\n  // console.log('DEBUGLIST', size)\n\n  return (\n    <div className={classes.root}>\n      <TopBar>\n        <Typography className={classes.grow}>Home Feed</Typography>\n      </TopBar>\n      <div className={classes.listContainer} ref={listRef}>\n        <List\n          height={size.height}\n          width={size.width}\n          className={classes.vList}\n          rowCount={events.length + 1}\n          rowHeight={ROWHEIGHT}\n          rowRenderer={rowRenderer}\n        />\n      </div>\n    </div>\n  )\n}\n\nMyFeed.propTypes = {\n  events: PropTypes.array.isRequired,\n  loading: PropTypes.bool,\n  window: PropTypes.arrayOf(PropTypes.number),\n  onSeriesClick: PropTypes.func.isRequired,\n  onImageClick: PropTypes.func.isRequired,\n  onProfileClick: PropTypes.func.isRequired,\n  onMapClick: PropTypes.func.isRequired,\n  fetchNewest: PropTypes.func.isRequired,\n  fetchMore: PropTypes.func.isRequired\n}\n\nexport default MyFeed\n","import React, { useRef, useState, useEffect } from 'react'\nimport PropTypes from 'prop-types'\nimport { graphql } from 'react-apollo'\nimport { home } from '../config'\nimport actions from '../redux/actions'\nimport { connect } from 'react-redux'\nimport { getMyFeed } from './queries'\nimport MyFeed from '../components/MyFeed/MyFeed'\nimport useOnline from '../lib/useOnline'\n\nconst POLL_INTERVAL = 20 // (seconds)\nconst FEED_LIMIT = 5 // (items to load)\n\nconst FeedConnect = ({\n  data, loading, fetchMore, fetchNewest,\n  loadingNewest,\n  loadingMore,\n  jumpToSeries,\n  jumpToMap,\n  jumpToUser\n}) => {\n  const timerRef = useRef()\n  const { online } = useOnline()\n  const [lastCheck, setLastCheck] = useState(null)\n  timerRef.current = lastCheck\n\n  // Initiate the polling process. We simply update the timestamp every N seconds\n  useEffect(() => {\n    function ping () {\n      if (!loading && online) fetchNewest()\n      if (timerRef.current) setLastCheck(String(Date.now() - POLL_INTERVAL * 1000))\n    }\n    if (!timerRef.current) timerRef.current = setInterval(ping, POLL_INTERVAL * 1000)\n    return () => {\n      if (timerRef.current) {\n        console.log('clear poll timer')\n        clearInterval(timerRef.current)\n        timerRef.current = null\n      }\n    }\n  }, [])\n\n  const events = data.myFeed ? data.myFeed.feed || [] : []\n  const window = data.myFeed ? data.myFeed.window.map(v => parseInt(v, 10)) || [null, null] : [null, null]\n\n  return (\n    <MyFeed {...{ events, loading, window, fetchMore, fetchNewest, jumpToSeries }}\n      onSeriesClick={() => {}}\n      onImageClick={jumpToSeries}\n      onProfileClick={jumpToUser}\n      onMapClick={jumpToMap}\n    />\n  )\n}\n\nFeedConnect.propTypes = {\n  data: PropTypes.object, // from graphql\n  loading: PropTypes.bool, // from graphql\n  loadingNewest: PropTypes.bool, // from graphql\n  loadingMore: PropTypes.bool, // from graphql\n  fetchMore: PropTypes.func,\n  fetchNewest: PropTypes.func,\n  jumpToSeries: PropTypes.func,\n  jumpToMap: PropTypes.func,\n  jumpToUser: PropTypes.func\n}\n\nconst withFeedQuery = graphql(getMyFeed, {\n  props: ({ data }) => {\n    if (data.error) console.error(data.error)\n\n    // TODO: Not sure this will propagate correctly. Test it.\n    let loadingNewest = false\n    let loadingMore = false\n\n    // console.log('withFeedQuery', data)\n\n    // One Thunk function designed for getting everything since the last check\n    const fetchNewest = () => {\n      loadingNewest = true\n      console.log('fetchNewest', data)\n      if (data.myFeed) {\n        data.fetchMore({\n          variables: { ...data.variables, start: data.myFeed.window[1] },\n          // How do we mush the new query with the old one\n          updateQuery: (prev, { fetchMoreResult }) => {\n            loadingNewest = false\n            return {\n              myFeed: {\n                ...fetchMoreResult.myFeed,\n                // put the newest stuff first\n                feed: [ ...fetchMoreResult.myFeed.feed, ...prev.myFeed.feed ],\n                window: [prev.myFeed.window[0], fetchMoreResult.myFeed.window[1]]\n              }\n            }\n          }\n        })\n      }\n    }\n\n    // A second Thunk function designed to get more elements in the feed history\n    const fetchMore = () => {\n      loadingMore = true\n      console.log('fetchMore', data)\n      if (data.myFeed) {\n        data.fetchMore({\n          variables: { ...data.variables, end: data.myFeed.window[0] },\n          // How do we mush the new query with the old one\n          updateQuery: (prev, { fetchMoreResult }) => {\n            loadingMore = false\n            return {\n              myFeed: {\n                ...fetchMoreResult.myFeed,\n                feed: [ ...prev.myFeed.feed, ...fetchMoreResult.myFeed.feed ],\n                window: [fetchMoreResult.myFeed.window[0], prev.myFeed.window[1]]\n              }\n            }\n          }\n        })\n      }\n    }\n\n    return {\n      data,\n      loadingNewest,\n      loadingMore,\n      fetchNewest, // This is the poll we do every n seconds\n      fetchMore, // This is when we scroll to the bottom of the list\n      loading: data.loading\n    }\n  },\n  // skip: ({ activeSeries, isNewSeries }) => !activeSeries || isNewSeries,\n  options: ({ activeSeries }) => ({\n    variables: {\n      limit: FEED_LIMIT\n    }\n  })\n})\n\n/**\n * Map our redux state and functions\n */\nconst mapStateToProps = (state, props) => {\n  return { }\n}\n\n// We're using graphql() HOC because it's convenient but it doesn't need to render anything\n// const FeedQueryConnect = withFeedQuery(() => null)\nconst mapDispatchToProps = dispatch => ({\n  jumpToSeries: (seriesId, photoId) => {\n    dispatch(actions.setHomeState(home.AppStateTypes.SERIES, { activeSeries: seriesId, initialPhoto: photoId }))\n  },\n  jumpToUser: (username) => {\n    dispatch(actions.setHomeState(home.AppStateTypes.SEARCH, { search: { tab: home.SEARCH_TABS.USER, text: username } }))\n  },\n  jumpToMap: (seriesId, photoId) => {\n    dispatch(actions.pushMapHistory({\n      mode: home.MapModeTypes.FREE\n    }))\n    dispatch(actions.setHomeState(home.AppStateTypes.MAP, { activeSeries: seriesId, initialPhoto: photoId }))\n  }\n})\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(\n  withFeedQuery(FeedConnect)\n)\n","import React, { useState, useEffect, useCallback } from 'react'\nimport PropTypes from 'prop-types'\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport AppBar from '@material-ui/core/AppBar'\nimport Toolbar from '@material-ui/core/Toolbar'\nimport Snackbar from '@material-ui/core/Snackbar'\nimport SnackbarContent from '@material-ui/core/SnackbarContent'\nimport IconButton from '@material-ui/core/IconButton'\nimport Typography from '@material-ui/core/Typography'\nimport QRcodeIcon from '../../../icons/QRCode'\nimport jsQR from 'jsqr'\nimport { debounce } from '../../../lib/util'\nimport {\n  green, red\n} from '@material-ui/core/colors'\n\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack'\nimport Paper from '@material-ui/core/Paper'\n// import MenuIcon from '@material-ui/icons/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { useCamera } from '../../../lib/useCamera'\n\nconst CAMERAWIDTH = 400\nconst CAMERAHEIGHT = 400\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    display: 'flex',\n    height: '100%',\n    flexDirection: 'column'\n  },\n  qrIcon: {\n    border: '5px solid red',\n    padding: theme.spacing(2),\n    position: 'absolute',\n    color: 'white',\n    opacity: 0.4,\n    zIndex: 2,\n    width: '70%',\n    height: '70%',\n    top: '50%',\n    left: '50%',\n    transformOrigin: '50% 50%',\n    transform: 'translateY(-50%) translateX(-50%)'\n  },\n  appBar: {\n\n  },\n  inner: {\n    padding: theme.spacing(2),\n    height: '100%',\n    flexGrow: 1,\n    overflow: 'hidden'\n  },\n  tipPaper: {\n    padding: theme.spacing(2),\n    margin: theme.spacing(2)\n  },\n  docContainer: {\n    flexGrow: 1,\n    padding: theme.spacing(2)\n  },\n  cameraContainer: {\n    width: '80%',\n    margin: '0 auto',\n    position: 'relative',\n    // this is a CSS trick: https://spin.atomicobject.com/2015/07/14/css-responsive-square/\n    '&::before': {\n      content: ' ',\n      display: 'block',\n      paddingTop: '100%'\n    }\n  },\n  snackErr: {\n    background: red[500],\n    color: 'white'\n  },\n  snackSuccess: {\n    background: green[500],\n    color: 'white'\n  },\n  snackMsg: {\n\n  },\n  video: {\n    height: '100%',\n    width: '100%',\n    verticalAlign: 'top'\n    // display: 'none'\n    // position: 'absolute'\n    // top: 0,\n    // left: 0,\n    // zIndex: 1\n    // '@media (orientation: portrait)': {\n    //   transform: 'rotate(90)'\n    // }\n  }\n}))\n\nconst QRReader = ({ onMenuBack, onCapture }) => {\n  const classes = useStyles()\n  const [capturedImg, setCapturedImg] = useState()\n  const [err, setErr] = useState(null)\n  const [code, setCode] = useState(null)\n\n  const { cameraError, captureRawData, cameraOnline } = useCamera(setCapturedImg, CAMERAWIDTH, CAMERAHEIGHT)\n  // limit to 10 frames per second\n  const captureFunc = useCallback(debounce(captureRawData, 100), [cameraOnline, cameraError])\n\n  useEffect(() => {\n    if (cameraOnline && !cameraError && !err && !code) {\n      if (!capturedImg || !capturedImg.data) captureFunc()\n      else {\n        const scan = async () => {\n          let scannedCode = null\n          try {\n            scannedCode = await jsQRFromBase64(capturedImg)\n          }\n          catch (e) {\n            console.error(e)\n          }\n          try {\n            if (scannedCode) {\n              const find = '?fromqr='\n              const foundIdx = scannedCode.data.indexOf(find) + find.length\n              const newData = scannedCode.data.slice(foundIdx)\n              console.log('DEBUG', { data: scannedCode.data, newData })\n              const decodedUrl = JSON.parse(decodeURI(newData))\n              if (!decodedUrl.type || !decodedUrl.id) throw new Error('Type or ID missing from QR Code')\n              setCode(decodedUrl)\n              setErr(null)\n              console.log('QRCODE', scannedCode)\n            }\n            captureFunc()\n          }\n          catch (e) {\n            setErr('Not a valid QR Code')\n            console.error(e)\n            captureFunc()\n          }\n        }\n        scan()\n      }\n    }\n  }, [cameraOnline, capturedImg, err, code])\n\n  // console.log(capturedImg)\n  return (\n    <div className={classes.root}>\n      <CssBaseline /> {/* You only need this in a root element. Don't put it anywhere else in the dom */}\n      <AppBar position='static' className={classes.appBar}>\n        <Toolbar disableGutters>\n          <IconButton className={classes.menuButton} color='inherit' onClick={onMenuBack} aria-label='Menu'>\n            <ArrowBackIcon />\n          </IconButton>\n          <Typography variant='subtitle1' color='inherit' className={classes.toolbarTitle}>\n            Capture QR Code\n          </Typography>\n        </Toolbar>\n      </AppBar>\n      <div className={classes.inner}>\n        <Paper className={classes.cameraContainer}>\n          <QRcodeIcon className={classes.qrIcon} />\n          <video\n            autoPlay\n            playsInline\n            muted\n            id='webcam'\n            className={classes.video}\n          />\n        </Paper>\n        <Paper className={classes.tipPaper}>\n          <Typography>TIP: You can find the QR code for a series in the SHARE tab of that series</Typography>\n        </Paper>\n      </div>\n      <Snackbar\n        anchorOrigin={{ vertical: 'bottom', horizontal: 'center' }}\n        open={!!err}\n        autoHideDuration={2000}\n        onClose={() => setErr(null)}\n      >\n        <SnackbarContent\n          className={classes.snackErr}\n          message={<span className={classes.snackMsg}>{err}</span>}\n        />\n      </Snackbar>\n      <Snackbar\n        anchorOrigin={{ vertical: 'bottom', horizontal: 'center' }}\n        open={cameraError}\n      >\n        <SnackbarContent\n          className={classes.snackErr}\n          message={<span className={classes.snackMsg}>Camera Error. Check your device's permissions</span>}\n        />\n      </Snackbar>\n      <Snackbar\n        anchorOrigin={{ vertical: 'bottom', horizontal: 'center' }}\n        open={!!code}\n        autoHideDuration={500}\n        onClose={() => onCapture(code.type, code.id)}\n      >\n        <SnackbarContent\n          className={classes.snackSuccess}\n          message={<span className={classes.snackMsg}>Valid QR Code found!</span>}\n        />\n      </Snackbar>\n\n    </div>\n  )\n}\n\nQRReader.propTypes = {\n  onMenuBack: PropTypes.func.isRequired,\n  onCapture: PropTypes.func.isRequired\n}\n\nexport default QRReader\n\nconst jsQRFromBase64 = ({ data, imageHeight, imageWidth }) => {\n  return new Promise((resolve, reject) => {\n    try {\n      // console.log(imageHeight, imageWidth)\n      const qrCode = jsQR(data, imageWidth, imageHeight)\n      resolve(qrCode)\n    }\n    catch (e) {\n      reject(e)\n    }\n  })\n}\n","import React, { useRef, useEffect, useState, useContext } from 'react'\nimport Typography from '@material-ui/core/Typography'\n// import MenuIcon from '@material-ui/icons/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nimport moment from 'moment'\nimport { AppContext } from '../../contexts'\n\nconst CHECKINTERVAL = 5000\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    background: 'black',\n    color: 'white',\n    textAlign: 'center'\n  }\n}))\n\nconst OfflineBar = () => {\n  const classes = useStyles()\n  const { online, offlineSince } = useContext(AppContext)\n  const [sinceStr, setSinceStr] = useState()\n  const timerRef = useRef()\n\n  const calcSinceStr = () => {\n    const newText = moment(offlineSince, 'x').fromNow()\n    // console.log('OFFLINE SINCE', since, newText)\n    setSinceStr(newText)\n  }\n  const clearTimer = () => {\n    if (timerRef.current) {\n      clearInterval(timerRef.current)\n      timerRef.current = null\n    }\n  }\n\n  useEffect(() => {\n    if (offlineSince && !timerRef.current) {\n      calcSinceStr()\n      timerRef.current = setInterval(calcSinceStr, CHECKINTERVAL)\n    }\n    else if (!offlineSince)clearTimer()\n    return () => {\n      clearTimer()\n    }\n  }, [offlineSince])\n\n  if (online) return null\n  return (\n    <Typography className={classes.root} variant='caption' component='div'>\n      Offline ({sinceStr})\n    </Typography>\n  )\n}\n\nexport default OfflineBar\n","import React, { useContext } from 'react'\nimport classNames from 'classnames'\nimport PropTypes from 'prop-types'\n\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport AppBar from '@material-ui/core/AppBar'\nimport Paper from '@material-ui/core/Paper'\nimport Typography from '@material-ui/core/Typography'\nimport Toolbar from '@material-ui/core/Toolbar'\nimport Button from '@material-ui/core/Button'\n// import Fab from '@material-ui/core/Fab'\n\nimport HomeIcon from '@material-ui/icons/HomeOutlined'\nimport MapIcon from '@material-ui/icons/MapOutlined'\nimport SearchIcon from '@material-ui/icons/SearchOutlined'\nimport AddIcon from '@material-ui/icons/Add'\nimport PersonOutline from '@material-ui/icons/PersonOutline'\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport AddFab from '../components/PhotoSeries/views/controls/AddFab'\nimport OfflineBar from './misc/OfflineBar'\n\nimport { AppContext } from '../contexts'\n\nimport { home as homeConfig } from '../config'\n\nconst STATES = homeConfig.AppStateTypes\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    borderTop: `2px solid ${theme.palette.secondary.main}`\n  },\n  text: {\n    padding: theme.spacing(2, 2, 0)\n  },\n  paper: {\n    paddingBottom: 50\n  },\n  list: {\n    marginBottom: theme.spacing(2)\n  },\n  subheader: {\n    backgroundColor: theme.palette.background.paper\n  },\n  grow: {\n    flexGrow: 1\n  },\n  addFab: {\n    position: 'absolute',\n    bottom: 0,\n    left: '50%',\n    transformOrigin: '0% 100%',\n    // Promote the list into his own layer on Chrome. This cost memory but helps keeping high FPS.\n    transform: 'translateY(-25%) translateX(-50%) translateZ(0)',\n    zIndex: 3000\n  },\n  spacer: {\n    width: 40,\n    flexGrow: 1\n  }\n}))\n\nconst BottomBar = ({ className, domain, signedIn, onHomeClick, onMapClick, onSearchClick, onProfileClick, onCameraClick, onLibraryClick }) => {\n  const classes = useStyles()\n  const { isIos, online } = useContext(AppContext)\n  return (\n    <AppBar position='static' className={classNames(classes.root, className)}>\n      <Toolbar>\n        {signedIn && (\n          <Button\n            edge='start'\n            className={classes.grow}\n            color={domain === STATES.FEED ? 'secondary' : 'inherit'}\n            onClick={onHomeClick}\n          >\n            <HomeIcon />\n          </Button>\n        )}\n        <Button\n          edge='start'\n          className={classes.grow}\n          color={domain === STATES.MAP ? 'secondary' : 'inherit'}\n          onClick={onMapClick}\n        >\n          <MapIcon />\n        </Button>\n        {signedIn && (\n          <AddFab\n            isIos={isIos}\n            className={classes.addFab}\n            onCameraClick={onCameraClick}\n            onLibraryClick={onLibraryClick}\n          >\n            <AddIcon />\n          </AddFab>\n        )}\n        <div className={classes.spacer} />\n        <Button\n          color={domain === STATES.SEARCH ? 'secondary' : 'inherit'}\n          className={classes.grow}\n          disabled={!online}\n          onClick={onSearchClick}\n        >\n          <SearchIcon />\n        </Button>\n        {signedIn && (\n          <Button\n            edge='end'\n            color={domain === STATES.PROFILE ? 'secondary' : 'inherit'}\n            className={classes.grow}\n            onClick={onProfileClick}\n          >\n            <PersonOutline />\n          </Button>\n        )}\n      </Toolbar>\n    </AppBar>\n  )\n}\n\nBottomBar.propTypes = {\n  className: PropTypes.string,\n  domain: PropTypes.string,\n  signedIn: PropTypes.bool,\n  // Here are our button handlers\n  onHomeClick: PropTypes.func.isRequired,\n  onMapClick: PropTypes.func.isRequired,\n  onSearchClick: PropTypes.func.isRequired,\n  onProfileClick: PropTypes.func.isRequired,\n  onCameraClick: PropTypes.func.isRequired,\n  onLibraryClick: PropTypes.func.isRequired\n}\n\nexport default BottomBar\n\nexport const BottomBarCosmosWrapper = (props) => {\n  // const [someStateItem, setSomeStateItem] = useState()\n  const classes = useWrapperStyles()\n  return (\n    <div className={classes.root}>\n      <OfflineBar />\n      <CssBaseline /> {/* You only need this in a root element. Don't put it anywhere else in the dom */}\n      <Paper className={classes.paper}>\n        <Typography variant='h5'>\n          This is a dummy component.\n        </Typography>\n      </Paper>\n      <BottomBar {...props} />\n    </div>\n  )\n}\n\nconst wrapperStyle = theme => ({\n  root: {\n    height: '100%',\n    display: 'flex',\n    flexDirection: 'column'\n  },\n  paper: {\n    flexGrow: 1\n  }\n})\n\nconst useWrapperStyles = makeStyles(wrapperStyle)\n","import React, { useContext, useEffect } from 'react'\nimport PropTypes from 'prop-types'\n\nimport CssBaseline from '@material-ui/core/CssBaseline'\n\nimport UploaderConnect from './graphql/Uploader.connect'\nimport SeriesConnect from './graphql/Series.connect'\nimport MapConnect from './graphql/Map.connect'\nimport SearchConnect from './graphql/Search.connect'\nimport ProfileConnect from './graphql/Profile.connect'\nimport FeedConnect from './graphql/Feed.connect'\nimport QRReader from './components/PhotoSeries/views/QRReader'\n\nimport OfflineBar from './components/misc/OfflineBar'\nimport BottomBar from './components/BottomBar'\nimport { AppContext } from './contexts'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport { home as homeConfig } from './config'\n\nimport { ThemeProvider } from '@material-ui/styles'\nimport themes from './themes'\n// import { DesktopWindowsTwoTone } from '@material-ui/icons'\n\nconst STATES = homeConfig.AppStateTypes\n\nconst useStyles = makeStyles(theme => ({\n  outerRoot: {\n    height: '100%',\n    overflow: 'hidden'\n  },\n  root: {\n    height: '100%',\n    overflow: 'hidden',\n    display: 'flex',\n    flexDirection: 'column'\n  },\n  offlineBar: {\n    flex: '0 0'\n  },\n  activeWrapper: {\n    overflow: 'hidden',\n    flexGrow: 1,\n    flexShrink: 1,\n    height: '100%'\n  },\n  uploaderContainer: {\n    zIndex: 2000,\n    flex: '0 0'\n  }\n}))\n\n/**\n * This is the over-arching wrapper for the app. It combines all the\n * same place. Time will tell if that's a good strategy.\n */\nconst App = ({ domain, onQRCapture, onMenuBack, setHomeState, onCameraClick, onLibraryClick, children }) => {\n  const classes = useStyles()\n  const { signedIn, user, windowSize } = useContext(AppContext)\n\n  useEffect(() => {\n    // Anonymous Users are only allowed home and search\n    if (!signedIn && [STATES.MAP, STATES.SEARCH, STATES.SERIES, STATES.QRCAPTURE].indexOf(domain) < 0) setHomeState(STATES.MAP)\n  }, [domain])\n\n  let showBottomBar = true\n  let activeProps = {}\n  let ActiveComponent = FeedConnect\n  switch (domain) {\n    case STATES.FEED:\n      ActiveComponent = FeedConnect\n      break\n    case STATES.MAP:\n      ActiveComponent = MapConnect\n      break\n    case STATES.PROFILE:\n      ActiveComponent = ProfileConnect\n      activeProps = { user }\n      break\n    case STATES.SEARCH:\n      ActiveComponent = SearchConnect\n      break\n    case STATES.SERIES:\n      ActiveComponent = SeriesConnect\n      activeProps = { user }\n      showBottomBar = false\n      break\n    case STATES.NEW_SERIES_CAMERA:\n      activeProps = { user }\n      ActiveComponent = SeriesConnect\n      showBottomBar = false\n      break\n    case STATES.NEW_SERIES_LIBRARY:\n      activeProps = { user }\n      ActiveComponent = SeriesConnect\n      showBottomBar = false\n      break\n    case STATES.QRCAPTURE:\n      ActiveComponent = QRReader\n      showBottomBar = false\n      activeProps = { onCapture: onQRCapture, onMenuBack }\n      break\n    default:\n      break\n  }\n\n  return (\n    <div className={classes.outerRoot}>\n      <div className={classes.root} style={{ width: windowSize.width, height: windowSize.height }}>\n        <CssBaseline /> {/* You only need this in a root element. Don't put it anywhere else in the dom */}\n        <OfflineBar className={classes.offlineBar} />\n        <div className={classes.activeWrapper}>\n          <ActiveComponent {...activeProps} />\n        </div>\n        { showBottomBar && (\n          <ThemeProvider theme={themes.bottombar}>\n            <BottomBar\n              signedIn={signedIn}\n              domain={domain}\n              onHomeClick={() => setHomeState(STATES.FEED)}\n              onMapClick={() => setHomeState(STATES.MAP)}\n              onSearchClick={() => setHomeState(STATES.SEARCH, { search: null })}\n              onProfileClick={() => setHomeState(STATES.PROFILE)}\n              onCameraClick={onCameraClick}\n              onLibraryClick={onLibraryClick}\n            />\n          </ThemeProvider>\n        )}\n        {/* Uploader is persistent across all views */}\n        <UploaderConnect className={classes.uploaderContainer} />\n        {children}\n      </div>\n    </div>\n  )\n}\n\nApp.propTypes = {\n  // All of this comes in from From Redux\n  domain: PropTypes.string.isRequired,\n  children: PropTypes.any,\n  setHomeState: PropTypes.func.isRequired,\n  onCameraClick: PropTypes.func.isRequired,\n  onLibraryClick: PropTypes.func.isRequired,\n  onQRCapture: PropTypes.func.isRequired,\n  onMenuBack: PropTypes.func.isRequired\n}\n\nexport default App\n","import React, { useEffect } from 'react'\nimport { Query, ApolloProvider, compose } from 'react-apollo'\nimport { IntlWrapper } from './translations'\nimport { getUser } from './graphql/queries'\nimport themes from './themes'\nimport { AppContext } from './contexts'\nimport Loading from './components/auth/Loading'\nimport ErrorBoundary from './lib/ErrorBoundary'\nimport ErrorConnect from './graphql/Error.connect'\nimport useGraphQL from './lib/useGraphQL'\nimport useAuthentication from './lib/useAuthentication'\nimport useShowAddToHome from './lib/useShowAddToHome'\nimport useOnline from './lib/useOnline'\nimport useResponsive from './lib/useResponsive'\nimport withReduxProvider from './redux/withReduxProvider'\nimport { connect } from 'react-redux'\nimport actions from './redux/actions'\nimport { home as homeConfig } from './config'\n\nimport App from './App'\nimport { ThemeProvider } from '@material-ui/styles'\n\n/**\n * HOC for AppContext and ApolloProvider\n */\nexport const withApolloAuthProvider = Wrapped => ({\n  onQRClick, onAvatarClick, setUseOffline, dismissInstall, flags, ...props\n}) => {\n  // console.log('withApolloAuthProvider', props)\n  const { isGod, signedIn, authData, signOut, authScreen, forceSignIn } = useAuthentication(flags.useLoggedOut, setUseOffline)\n\n  const { client: apolloClient, loaded: apolloLoaded } = useGraphQL()\n\n  // This triggers all the PWA Goodness\n  const { online, offlineSince } = useOnline()\n  const { installPrompt, addToHomeScreen } = useShowAddToHome(flags.install, dismissInstall)\n  const responsive = useResponsive()\n\n  // If the user hasn't decided to be anonymous or sign in yet show them the login screen\n  // console.log('Rendering AppConnect', { flags, responsive, props, signedIn, isGod, authData })\n  useEffect(() => {\n    if (signedIn === true && flags.useLoggedOut) setUseOffline(false)\n    else if (signedIn === false && !flags.useLoggedOut) setUseOffline(true)\n  }, [signedIn])\n\n  if (!apolloLoaded) return <Loading message='DBStore' />\n\n  if (signedIn === null && !flags.useLoggedOut) return authScreen\n\n  // These are the things the rest of the app needs to find:\n  const appContext = {\n    signOut,\n    forceSignIn: () => {\n      setUseOffline(false)\n      forceSignIn()\n    },\n    getPhotoUrl: (photo, size) => {\n      try {\n        return `${photo.paths.base}${photo.paths[size]}`\n      }\n      catch (e) {\n        return null\n      }\n    },\n    onAvatarClick,\n    online,\n    offlineSince,\n    ...responsive,\n    signedIn: Boolean(signedIn),\n    role: !signedIn\n      ? 'nonuser'\n      : isGod\n        ? 'admin'\n        : 'user',\n    currentUser: authData, // TODO: Need this supported by a graphql query\n    onQRClick,\n    addToHomeScreen\n  }\n\n  return (\n  // We wrap the outside in an error handler\n    <ThemeProvider theme={themes.home}>\n      <ApolloProvider client={apolloClient}>\n        <Query query={getUser} skip={!signedIn}>\n          {({ loading, error, data }) => {\n            if (loading) return <Loading message='UserData' />\n            if (error) {\n              console.error(error)\n            }\n            if (signedIn) appContext.user = data.user\n            return (\n              <AppContext.Provider value={appContext}>\n                <IntlWrapper>\n                  <Wrapped {...props}>\n                    {installPrompt}\n                  </Wrapped>\n                </IntlWrapper>\n              </AppContext.Provider>\n            )\n          }}\n        </Query>\n      </ApolloProvider>\n    </ThemeProvider>\n  )\n}\n\n/**\n * Map our redux state and functions\n */\nconst mapStateToProps = (state, props) => {\n  const { domain } = state.home.current\n  return { domain, flags: state.flags }\n}\n\nconst mapDispatchToProps = dispatch => ({\n  setHomeState: (newDomain, newParams) => {\n    dispatch(actions.setHomeState(newDomain, newParams))\n  },\n  onCameraClick: () => {\n    dispatch(actions.setHomeState(homeConfig.AppStateTypes.NEW_SERIES_CAMERA))\n  },\n  onLibraryClick: () => {\n    dispatch(actions.setHomeState(homeConfig.AppStateTypes.NEW_SERIES_LIBRARY))\n  },\n  dismissInstall: () => {\n    dispatch(actions.setFlag('install', false))\n  },\n  setUseOffline: (bVal) => {\n    dispatch(actions.setFlag('useLoggedOut', bVal))\n  },\n  onQRClick: () => {\n    dispatch(actions.setHomeState(homeConfig.AppStateTypes.QRCAPTURE))\n  },\n  onMenuBack: () => {\n    dispatch(actions.homeStateBack())\n  },\n  onAvatarClick: (username) => {\n    dispatch(actions.setHomeState(homeConfig.AppStateTypes.SEARCH, {\n      search: { tab: homeConfig.SEARCH_TABS.USER, text: username }\n    }))\n  },\n  onQRCapture: (type, activeSeries) => {\n    switch (type) {\n      case 'series':\n        dispatch(actions.setHomeState(homeConfig.AppStateTypes.SERIES, { activeSeries }))\n        break\n      default:\n        break\n    }\n  }\n})\n\nconst withErrorBoundary = (Wrapped) => (props) => (\n  <ErrorBoundary fallback={ErrorConnect}>\n    <Wrapped {...props} />\n  </ErrorBoundary>\n)\n\n/**\n * Nearly everything we do depends on who you are as a user so we commit this to state\n */\n\n// The order we compose things here matters a lot\nexport default compose(\n  // ORDER IS CRITICAL HERE\n  withReduxProvider,\n  connect(\n    mapStateToProps,\n    mapDispatchToProps\n  ),\n  withApolloAuthProvider,\n  withErrorBoundary\n)(App)\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n)\n\nexport function register (config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href)\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config)\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\n          )\n        })\n      }\n      else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config)\n      }\n    })\n  }\n}\n\nfunction registerValidSW (swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing\n        if (installingWorker == null) {\n          return\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n              )\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration)\n              }\n            }\n            else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.')\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration)\n              }\n            }\n          }\n        }\n      }\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error)\n    })\n}\n\nfunction checkValidServiceWorker (swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type')\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload()\n          })\n        })\n      }\n      else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config)\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      )\n    })\n}\n\nexport function unregister () {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister()\n    })\n  }\n}\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport AppConnect from './App.connect'\nimport * as serviceWorker from './serviceWorker'\n// Here's our global overrides css\nimport './index.css'\n// This is the font we need\nrequire('typeface-roboto')\n\nconsole.log('Rendering Main App')\nReactDOM.render(<AppConnect />, document.getElementById('root'))\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.register()\n"],"sourceRoot":""}