{"version":3,"sources":["lib/useComponentSize.js","lib/SeriesConfig.js","components/PhotoSeries/views/tags/TagChip.jsx","components/PhotoSeries/views/controls/ShortLongText.jsx","lib/Tags.js","components/maps/markers/Dot.jsx","components/maps/BaseStaticMap.jsx","components/maps/MapDot.jsx","components/maps/MapDot.style.js","config.js","mapStyles/index.js","lib/sensors.js","components/maps/controls/StyleButtons.jsx","components/PhotoSeries/views/dialogs/BigText.jsx","components/PhotoSeries/views/dialogs/DeleteDialog.jsx","components/PhotoSeries/views/dialogs/BigTextEdit.jsx","components/PhotoSeries/views/controls/PhotoFadeSlider.jsx","components/PhotoSeries/views/controls/TagControl.style.js","components/PhotoSeries/views/controls/TagView.jsx","components/PhotoSeries/views/controls/DateControl.jsx","components/PhotoSeries/views/controls/TagControl.jsx","components/PhotoSeries/views/dialogs/TagEdit.jsx","components/PhotoSeries/views/controls/DateView.jsx","components/PhotoSeries/views/subViews/PhotoInfoInner.jsx","components/maps/markers/MyLocation.jsx","components/maps/controls/MyLocationButton.jsx","components/maps/BaseMap.jsx","components/PhotoSeries/views/dialogs/MapDirPicker.jsx","components/PhotoSeries/views/subViews/SeriesEditInner.jsx","components/PhotoSeries/views/subViews/SeriesEditInner.style.js","components/PhotoSeries/views/subViews/PhotoGrid.jsx","components/PhotoSeries/views/subViews/PhotoGrid.style.js","components/PhotoSeries/views/NewPhoto.jsx","lib/util.js","lib/Photo.js","lib/Series.js","lib/useFileInput.js","lib/useCamera.js","components/PhotoSeries/views/CameraTool.jsx","components/PhotoSeries/views/CameraTool.style.js","components/PhotoSeries/views/PhotoReviewTool.jsx","components/PhotoSeries/views/PhotoReviewTool.style.js","components/PhotoSeries/views/NewPhotoInfo.jsx","components/PhotoSeries/views/NewPhotoInfo.style.js","components/PhotoSeries/contexts.js","lib/datelib.js","icons/AppLogo.jsx","components/TopBar.jsx","contexts.js","views/Home.jsx","views/Home.style.js","redux/actions.js","components/UploadControl.jsx","lib/s3upload.js","graphql/Uploader.connect.js","graphql/queries.js","graphql/mutations.js","components/PhotoSeries/views/controls/AddFab.jsx","components/PhotoSeries/views/controls/ContextMenu.jsx","components/PhotoSeries/views/subViews/SeriesInfo.jsx","components/PhotoSeries/views/subViews/SeriesInfo.style.js","components/PhotoSeries/views/subViews/SwipeShow.jsx","components/PhotoSeries/views/subViews/SwipeShow.style.js","components/PhotoSeries/views/SeriesView.jsx","components/PhotoSeries/views/SeriesView.style.js","components/PhotoSeries/views/SeriesEdit.jsx","components/PhotoSeries/views/SeriesEdit.style.js","components/PhotoSeries/views/Slideshow.jsx","components/PhotoSeries/views/Slideshow.style.js","components/PhotoSeries/views/dialogs/CancelConfirm.jsx","components/PhotoSeries/views/subViews/PhotoInfo.jsx","components/PhotoSeries/views/PhotoViewTool.jsx","components/PhotoSeries/views/PhotoViewTool.style.js","components/PhotoSeries/index.jsx","lib/localdb.js","graphql/Series.connect.js","lib/useClusteredData.js","components/maps/selection/SeriesSelected.jsx","components/maps/selection/ClusterSelected.jsx","components/maps/markers/Single.jsx","components/maps/markers/Cluster.jsx","components/maps/HomeMap.jsx","components/maps/HomeMap.style.js","graphql/HomeMap.connect.js","lib/useGraphQL.js","translations.js","components/auth/auth.style.js","components/auth/useAuthCommon.js","components/auth/AuthContainer.jsx","components/auth/SignIn.jsx","components/auth/ConfirmSignIn.jsx","components/auth/RequireNewPassword.jsx","components/auth/SignUp.jsx","components/auth/Loading.jsx","components/auth/ConfirmSignUp.jsx","components/auth/ForgotPassword.jsx","lib/useAuthentication.js","App.jsx","serviceWorker.js","index.js","redux/reducers/map.js","redux/reducers/home.js","redux/reducers/uploader.js","redux/reducers/index.js","redux/store.js","components/PhotoSeries/views/tags/XYTagChip.style.js","components/PhotoSeries/views/tags/XYTagChip.jsx","components/PhotoSeries/views/tags/XYTagSelect.jsx","components/PhotoSeries/views/tags/XYTagSelect.style.js","components/PhotoSeries/views/tags/XYTagChooser.jsx","components/PhotoSeries/views/tags/XYTagChooser.style.js","components/PhotoSeries/views/tags/useXYTags.js","components/PhotoSeries/views/subViews/Photo.jsx","components/PhotoSeries/views/subViews/Photo.style.js"],"names":["require","useCallback","useState","useLayoutEffect","useRef","getSize","el","minSize","width","Math","max","offsetWidth","height","offsetHeight","useComponentSize","ref","resizeActiveRef","_useState","_useState2","Object","_Users_matt_Work_Git_PBR_PhotoMonitoring_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__","resizeActive","setResizeActive","current","_useState3","_useState4","size","setComponentSize","handleResize","ResizeObserver","resizeObserver","observe","disconnect","window","addEventListener","removeEventListener","TYPES","SeriesConfig","seriesConfig","_this","this","_Users_matt_Work_Git_PBR_PhotoMonitoring_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_2__","getTagType","typeId","config","tags","find","tt","id","getTagTypeIndex","findIndex","getXYTagTypes","filter","allowXY","getNonXYTagTypes","allowNonXY","getSeriesMeta","keys","meta","key","type","reduce","acc","_Users_matt_Work_Git_PBR_PhotoMonitoring_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_1__","_Users_matt_Work_Git_PBR_PhotoMonitoring_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__","default","getPhotoMeta","Error","tagChips","withStyles","theme","root","fontSize","marginRight","spacing","unit","marginTop","deleteIcon","chipAvatar","withTheme","_ref","classes","edit","tag","color","onDelete","props","_Users_matt_Work_Git_PBR_PhotoMonitoring_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_0__","react__WEBPACK_IMPORTED_MODULE_1___default","a","createElement","_material_ui_core_Chip__WEBPACK_IMPORTED_MODULE_2___default","assign","style","background","concat","palette","getContrastText","label","data","_material_ui_icons_Cancel__WEBPACK_IMPORTED_MODULE_3___default","className","onClick","e","console","log","opacity","react__WEBPACK_IMPORTED_MODULE_0__","__webpack_require__","react__WEBPACK_IMPORTED_MODULE_0___default","n","classnames__WEBPACK_IMPORTED_MODULE_1__","classnames__WEBPACK_IMPORTED_MODULE_1___default","_material_ui_core_Typography__WEBPACK_IMPORTED_MODULE_2__","_material_ui_core_Typography__WEBPACK_IMPORTED_MODULE_2___default","_material_ui_core_FormLabel__WEBPACK_IMPORTED_MODULE_3__","_material_ui_core_FormLabel__WEBPACK_IMPORTED_MODULE_3___default","_material_ui_core_styles__WEBPACK_IMPORTED_MODULE_4__","ShortLongText","text","formLabel","variant","classNames","defaultProps","position","display","overflow","whiteSpace","&::before","content","bottom","paper","Tags","_Users_matt_Work_Git_PBR_PhotoMonitoring_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_1__","findTagById","tagId","values","getXYTags","xyTagIds","map","indexOf","coords","x","getNonXYTags","NonXYTagIds","createNewTagObj","uuid","createExistingTagObj","_Users_matt_Work_Git_PBR_PhotoMonitoring_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_0__","createNewXYTagObj","createExistingXYTagObj","getRelXYTags","multiplier","group","relCoords","y","primary","main","top","left","textAlign","transformOrigin","transform","zIndex","rootActive","svgDot","dot","stroke","secondary","contrastText","strokeWidth","fill","directionIndicator","name","fontWeight","textShadow","nameActive","dark","direction","react_default","version","viewBox","cx","cy","r","svgArc","d","fillOpacity","strokeOpacity","BaseStaticMap","controlPadding","viewport","children","mapStyles","onMapDataEvent","passthroughProps","objectWithoutProperties","mapRef","slicedToArray","currStyle","setCurrStyle","projection","setProjection","recalcProjection","getDistanceScales","error","useMemo","esm","mapStyle","onData","mapboxApiAccessToken","mapConfig","mapBoxToken","length","StyleButtons","Array","isArray","c","handleChild","child","stylechooser","initStyle","styles","mapWrapper","staticMap","editable","onChange","Map","BaseMap","mapProps","touchRotate","dragRotate","showMe","lockPan","onViewportChange","Dot","__webpack_exports__","home","endpoints","localDb","aws","_mapStyles__WEBPACK_IMPORTED_MODULE_0__","tagColors","process","MapStyles","baseurl","REACT_APP_BASEURL","AppStateTypes","MAP","LIST","USER","SERIES","NEW_SERIES_CAMERA","NEW_SERIES_LIBRARY","MapModeTypes","FREE","TAG","graphql","cdn","imgStore","Auth","region","userPoolId","userPoolWebClientId","mandatorySignIn","cookieStorage","domain","expires","secure","_Satellite_json__WEBPACK_IMPORTED_MODULE_0__","_TopoMap_json__WEBPACK_IMPORTED_MODULE_1__","_material_ui_icons__WEBPACK_IMPORTED_MODULE_2__","toolTip","Icon","SatelliteOutlined","ActiveIcon","SatIcon","Satellite","TerrainOutlined","Terrain","TopoMap","useGeolocation","watchId","accuracy","altitude","altitudeAccuracy","heading","latitude","longitude","speed","timestamp","Date","now","state","setState","mounted","onEvent","event","useEffect","navigator","geolocation","getCurrentPosition","watchPosition","clearWatch","useDeviceOrientation","absolute","alpha","beta","gamma","deviceOrientation","setDeviceOrientation","handleDeviceOrientation","open","setOpen","noEventSetOpen","preventDefault","stopPropagation","right","_material_ui_lab_SpeedDial__WEBPACK_IMPORTED_MODULE_2___default","ariaLabel","speedDial","fab","speedDialFab","icon","onClose","_ref2","idx","_material_ui_lab_SpeedDialAction__WEBPACK_IMPORTED_MODULE_3___default","speedDialIcon","tooltipPlacement","ButtonProps","speedDialAction","TooltipClasses","tooltip","speedDialLabel","tooltipTitle","tooltipOpen","border","marginBottom","_material_ui_core_Typography__WEBPACK_IMPORTED_MODULE_1__","_material_ui_core_Typography__WEBPACK_IMPORTED_MODULE_1___default","_material_ui_core_DialogContent__WEBPACK_IMPORTED_MODULE_2__","_material_ui_core_DialogContent__WEBPACK_IMPORTED_MODULE_2___default","_material_ui_core_Dialog__WEBPACK_IMPORTED_MODULE_3__","_material_ui_core_Dialog__WEBPACK_IMPORTED_MODULE_3___default","_material_ui_core_IconButton__WEBPACK_IMPORTED_MODULE_4__","_material_ui_core_IconButton__WEBPACK_IMPORTED_MODULE_4___default","_material_ui_core_DialogTitle__WEBPACK_IMPORTED_MODULE_5__","_material_ui_core_DialogTitle__WEBPACK_IMPORTED_MODULE_5___default","_material_ui_icons_Close__WEBPACK_IMPORTED_MODULE_6__","_material_ui_icons_Close__WEBPACK_IMPORTED_MODULE_6___default","_material_ui_core_styles__WEBPACK_IMPORTED_MODULE_7__","body","paddingBottom","title","margin","padding","closeButton","grey","scroll","aria-labelledby","_material_ui_core_Dialog__WEBPACK_IMPORTED_MODULE_1__","_material_ui_core_Dialog__WEBPACK_IMPORTED_MODULE_1___default","_material_ui_core_DialogTitle__WEBPACK_IMPORTED_MODULE_2__","_material_ui_core_DialogTitle__WEBPACK_IMPORTED_MODULE_2___default","_material_ui_core_DialogContent__WEBPACK_IMPORTED_MODULE_3__","_material_ui_core_DialogContent__WEBPACK_IMPORTED_MODULE_3___default","_material_ui_core_Button__WEBPACK_IMPORTED_MODULE_4__","_material_ui_core_Button__WEBPACK_IMPORTED_MODULE_4___default","_material_ui_core_Typography__WEBPACK_IMPORTED_MODULE_5__","_material_ui_core_Typography__WEBPACK_IMPORTED_MODULE_5___default","_material_ui_core_DialogActions__WEBPACK_IMPORTED_MODULE_6__","_material_ui_core_DialogActions__WEBPACK_IMPORTED_MODULE_6___default","message","onConfirm","disableBackdropClick","disableEscapeKeyDown","maxWidth","onOk","multiline","value","setValue","fullWidth","_material_ui_core_DialogTitle__WEBPACK_IMPORTED_MODULE_7___default","_material_ui_core_TextField__WEBPACK_IMPORTED_MODULE_5___default","rows","rowsMax","target","defaultValue","_material_ui_core_DialogActions__WEBPACK_IMPORTED_MODULE_4___default","_material_ui_core_Button__WEBPACK_IMPORTED_MODULE_6___default","flexGrow","PhotoFadeSlider","slider","setSlider","sliderLabel","_material_ui_lab_Slider__WEBPACK_IMPORTED_MODULE_3___default","container","track","thumb","vertical","flexDirection","TagControl_style","tagContainer","formControl","actionButtons","noOptionsMessage","singleValue","placeholder","input","valueContainer","flexWrap","flex","alignItems","tagConfig","tagValues","Typography_default","fieldTitle","TagChip","rootEdit","textBody","hint","index_es","timestampToHTML5Input","textField","HTML5InputToTimestamp","onSelectChange","inputValue","action","removedValue","option","val","newVal","objectSpread","tcv","toConsumableArray","newCreateVal","v","__isNew__","selectOptions","remainingTags","t","allowAdditions","react_select_esm","options","isFocused","components","Control","Menu","NoOptionsMessage","Option","Placeholder","ValueContainer","deleteRemoves","isClearable","isMulti","isSearchable","Creatable_default","TextField_default","InputProps","inputComponent","inputProps","selectProps","inputRef","innerRef","onMouseDown","innerProps","onTouchEnd","textFieldProps","_ref5","_ref6","Paper_default","square","_ref7","_ref8","isSelected","MenuItem_default","buttonRef","selected","component","_ref9","dlgContent","overflowY","onCancel","Dialog_default","fullScreen","DialogTitle_default","IconButton_default","Close_default","DialogContent_default","controls_TagControl","field","DialogActions_default","Button_default","formatDate","DIALOGS","dlgTitleContainer","catTagTitle","dlgTitle","paddingTop","paddingLeft","allowEdit","photo","delta","useContext","SeriesContext","_useState2$","activeDialog","activeDialogContext","setActiveDialog","tagInst","TagClass","metaKeys","JSON","parse","controls_DateControl","takenOn","controls_DateView","note","Divider_default","TagView","Fragment","List_default","list","ListItem_default","ListItemText_default","render","BigTextEdit","BigText","dialogs_TagEdit","svgAccuracyDot","accHeight","pixelsPerMeter","accWidth","disabled","Fab_default","aria-label","MyLocation_default","initViewport","bounds","lockToBounds","incomingOnViewportChange","incomingOnTransitionStart","onTransitionStart","incomingOnTransitionEnd","onTransitionEnd","transitions","mapContainerRef","mapBoxRef","isTransitioning","setIsTransitioning","_useState5","defaultViewVals","_useState6","setViewport","_useState7","_useState8","innerTransitions","setInnerTransitions","_useState9","_useState10","myPosition","geoMarker","markers_MyLocation","zoom","viewportChange","newViewport","getMap","_bounds","minlng","minlat","maxlng","maxlat","_fitBounds","WebMercatorViewport","fitBounds","offset","dragPan","React","cloneElement","hideNavControls","showZoom","touchZoom","scrollZoom","showCompass","controls_MyLocationButton","transitionDuration","transitionInterpolator","FlyToInterpolator","transitionEasing","easeCubic","bearing","pitch","sliderWrapper","sliderRoor","initLat","initLong","initDir","setCoords","setRotation","disableTypography","MapDot","_ref2$viewport","FormLabel_default","mapFormLabel","Slider_default","min","step","inner","grow","paddingRight","marginLeft","mapInnerWrap","minHeight","minWidth","chips","series","dialogs_MapDirPicker","newNote","PhotoGrid","photos","columns","multiSelect","onTileClick","selectMode","setSelectMode","urls","setUrls","urlsRef","selectedItems","setSelectedItems","deleteConfirm","setDeleteConfirm","forEach","base64","defineProperty","getPhotoUrl","then","url","handleCancelSelection","toggleListItem","remaining","arrId","sortedPhotos","sort","b","parseInt","GridList_default","cols","cellHeight","GridListTile_default","handlePhotoTap","tile","unSelectedTile","selectedTile","src","alt","img","addFab","handleAddToSelection","Remove_default","Add_default","GridListTileBar_default","Snackbar_default","autoHideDuration","ContentProps","aria-describedby","snackbarContent","snackbar","DeleteDialog","confirmation","& img","MODES","NewPhoto","inputMethod","onCreate","isNewSeries","_useContext","_Users_matt_Work_Git_PBR_PhotoMonitoring_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_2__","newPhoto","setNewPhoto","SeriesClass","newSeries","setNewSeries","photoRefId","setPhotoRefId","history","mode","_changeMode","orientation","geo","fileClickEl","useFileInput","exif","foundIdx","newData","slice","parser","exifParser","create","Buffer","from","stringify","err","date","String","DateTimeOriginal","GPSLatitude","isNumeric","GPSLongitude","photoInitObj","PhotoClass","fullNewPhotoObject","rawData","changeMode","newModeName","_Users_matt_Work_Git_PBR_PhotoMonitoring_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__","react__WEBPACK_IMPORTED_MODULE_3___default","_CameraTool__WEBPACK_IMPORTED_MODULE_7__","onShutter","refId","orient","geolocate","_PhotoReviewTool__WEBPACK_IMPORTED_MODULE_6__","defaultRefPhotoId","captured","onRetry","oldHistory","oldMode","pop","_NewPhotoInfo__WEBPACK_IMPORTED_MODULE_8__","onSave","num","isNaN","parseFloat","isFinite","Photo","_Users_matt_Work_Git_PBR_PhotoMonitoring_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__","setMeta","convertJSDatetoTimestamp","Series","arguments","undefined","clickRef","element","handleChange","evt","file","files","reader","FileReader","onload","result","readAsDataURL","click","Webcam","webcamElement","canvasElement","classCallCheck","location","protocol","hostname","warn","mediaDevices","getUserMedia","aspectRatio","srcObject","getTracks","stop","Promise","resolve","reject","audio","video","facingMode","mediaStream","URL","createObjectURL","onloadedmetadata","play","onplaying","catch","imageWidth","videoWidth","imageHeight","videoHeight","context","getContext","drawImage","_this2","_this$_drawImage","_drawImage","toBlob","blob","quality","_this$_drawImage2","toDataURL","cameraErrorText","disabledFab","cameraFab","@media (orientation: landscape)","@media (orientation: portrait)","cameraIcon","cancelFab","cancelIcon","swipeDrawer","libraryFab","myLocationFab","myLocationIcon","capturedContainer","referenceContainer","reference","newRefPhoto","p","refPhoto","setRefPhoto","drawerOpen","setDrawerOpen","_useCamera","onCapture","cameraError","setCameraError","cameraOnline","setCameraOnline","camRef","initCamera","document","getElementById","setup","innerWidth","innerHeight","captureImage","asyncToGenerator","regenerator_default","mark","_callee","capturedData","wrap","_context","prev","next","takeBase64Photo","apply","delayedOrientationChange","setTimeout","destroy","useCamera","CssBaseline_default","Boolean","autoPlay","playsInline","muted","buttonFab","Camera_default","Cancel_default","PhotoLibrary_default","libraryIcon","SwipeableDrawer_default","anchor","paperAnchorLeft","onOpen","tabIndex","swipeDrawerContainer","role","onKeyDown","referenceTextContainer","newText","refText","seriesDelta","setSeriesDelta","photoDelta","setPhotoDelta","SeriesEditInner","PhotoInfoInner","newAttr","createContext","moment__WEBPACK_IMPORTED_MODULE_0__","moment__WEBPACK_IMPORTED_MODULE_0___default","utctimestamp","format","moment","jsDate","utc","isoStr","AppLogo","createSvgIcon","strokeLinecap","strokeDasharray","strokeMiterlimit","vectorEffect","strokeLinejoin","searchIcon","borderRadius","iconButton","divider","signOut","Toolbar_default","disableGutters","InputBase_default","endAdornment","InputAdornment_default","Search_default","Menu_default","Drawer_default","fullList","index","button","ListItemIcon_default","MoveToInbox_default","Mail_default","ExitToApp_default","AppContext","mapContainer","topBar","currentState","setHomeState","components_TopBar","BottomNavigation_default","newState","showLabels","bottomNav","BottomNavigationAction_default","Place_default","FormatListBulleted_default","Person_default","Actions","actions","seriesId","viewportSave","uploadObj","newProgress","UploadControl","msgText","spacer","messageInner","progress","LinearProgress_default","UploadControlCOSMOSWrapper","displayName","activeUpload","updateUploadProgress","completeActiveUpload","formData","FormData","preAuth","fields","fieldkey","append","dataURLtoFile","headers","Content-Type","onUploadProgress","progressEvent","loaded","total","floor","axios","post","stack","dataurl","filename","arr","split","mime","match","bstr","atob","u8arr","Uint8Array","charCodeAt","File","interceptors","request","use","response","connect","uploader","dispatch","uploadingRef","_x","_x2","_x3","_doUpload","s3Upload","components_UploadControl","allSeries","gql","_templateObject","pollQuery","_templateObject2","getWholeSeries","_templateObject3","_templateObject4","_templateObject5","_templateObject6","_templateObject7","deletePhoto","mutations_templateObject","deleteSeries","mutations_templateObject2","updateSeries","mutations_templateObject3","updatePhoto","mutations_templateObject4","createPhoto","mutations_templateObject5","createSeries","mutations_templateObject6","onCameraClick","onLibraryClick","down","setDown","downRef","onDown","currentTarget","block","SpeedDial_default","onBlur","onTouchStart","SpeedDialAction_default","AddAPhoto_default","ContextMenu","anchorEl","menuItems","item","backgroundColor","tagListItem","chip","seriesConfigInst","SeriesConfigClass","newTags","existing","count","tagKey","idtk","subheading","SwipeShow","onImageSelect","onSlideshowStart","activePhoto","setActivePhoto","showTags","setShowTags","singular","lib_default","axis","onChangeIndex","enableMouseEvents","photoWrapper","manualBack","KeyboardArrowRight_default","KeyboardArrowLeft_default","manualForward","subtitle","actionIcon","slideshowButton","Slideshow_default","tagButton","Badge_default","badgeContent","Label_default","RemoveRedEye_default","MobileStepper_default","steps","activeStep","mobileStepper","dots","transition","isFullScreen","slides","dateCaption","appBar","-webkit-overflow-scrolling","tabMenu","mapWrap","AddFab","gridList","titleBar","titleText","menuButton","onEditSeries","onDeletePhotos","onCameraAdd","onDeleteSeries","onLibraryAdd","onMenuBack","contextEl","setContextEl","listTypeTab","setListTypeTab","AppBar_default","ArrowBack_default","aria-haspopup","MoreVert_default","controls_ContextMenu","Tabs_default","Tab_default","subViews_SwipeShow","subViews_SeriesInfo","controls_AddFab","setDelta","Slideshow","_useStepper","useStepper","lastStep","handleForward","handleBack","paused","pause","showXYTags","setShowXYTags","refImgWrap","_useComponentSize$siz","slideContainer","slide","active","last","duration","labelBadge","titlePosition","PlayCircleFilled_default","PauseCircleFilled_default","dotActive","nextButton","backButton","swipeAble","tagChip","xyTagChip","interval","setActiveStep","setPaused","setLastStep","timerRef","createTimer","setInterval","oldStep","destroyTimer","clearInterval","dirty","newDelta","dialogs_CancelConfirm","confirm","STATES","tipChip","activeButton","onUpdatePhoto","setMode","tagsClass","desired","onCommitTags","infoButton","Info_default","infoWindow","subViews_PhotoInfo","Chip_default","VIEW_ONLY_MODES","RepeatablePhotos","modeName","inputMethodINIT","onNewSeries","onChangePhoto","onNewPhoto","onDeletePhoto","pid","ph","onApprovePhoto","_ref3","onCreateSeries","_callee2","_ref4","onNewSeriesReturn","_context2","sent","newPid","newInputMethod","to","lastMode","views_SeriesView","photoIdArr","sp","views_SeriesEdit","views_PhotoViewTool","views_Slideshow","contexts","Provider","canEdit","localUUID","openDb","upgradeDB","store","createObjectStore","prefix","uuidv4","withGetSelectedQuery","loading","skip","activeSeries","variables","withUpdateSeriesMutation","_ref10","mutate","ownProps","updateSeriesMutation","sanitizeUpdateParams","optimisticResponse","update","_ref11","qdata","readQuery","query","writeQuery","qdataAll","limit","summary","seriesSummaries","s","withUpdatePhotoMutation","_ref12","updatePhotoMutation","sanitizedPHoto","newT","_ref13","updatedPhoto","__typename","withDeleteSeriesDeleteMutation","_ref14","deleteSeriesMutation","_ref15","withDeletePhotoMutation","_ref16","deletePhotoMutation","photoId","_ref17","finalCount","photoCount","withCreateNewSeries","_ref18","createSeriesMutation","featured","_ref19","newAllSeriesEntry","push","withCreateNewPhoto","_ref20","createPhotoMutation","ext","newPhotoInput","createdOn","toString","createdBy","authData","attributes","sub","updatedBy","updatedOn","paths","large","orig","medium","_ref21","connectedWithApollo","compose","onAfterSeriesDelete","onBack","queueUpload","doneCreatingSeries","PhotoSeries","getValues","_len","_key","photoNoId","photoData","abrupt","_state$home","inputObj","desiredParams","newDesiredParams","remainder","useClusteredData","filterBounds","currentZoom","sizeScale","queryVersion","clusteredData","setClusteredData","setVersion","_updateData","filteredClusteredData","newZ","zoomLevels","geoJSON","geometry","coordinates","properties","cluster","single","filterData","tree","rbush","screenCoords","project","point","clear","load","_loop","z","radius","sqrt","pow","neighbors","search","minX","minY","maxX","maxY","neighbor","newGeoJSON","centroid","featureCollection","reducedPhotoCount","points","imgContainer","onZoomTo","disablePadding","dense","ListItemSecondaryAction_default","ZoomIn_default","seriesCount","ZoomOutMap_default","avatar","avatarActive","badge","badgeActive","Avatar_default","PhotoCamera_default","numeral","defaultView","& .myPosMarker","& .singleMarker","& .clusterMarker","zoomOutFab","common","white","seriesList","setActiveSeries","onSeriesClick","pushMapHistory","popMapHistory","clearMapHistory","mapViewObj","setMapViewObj","mapViewRef","homeMapContainerRef","setCurrentZoom","setTransitions","selectedItem","setSelectedItem","obj","updateSelectedItem","object","pts","bufferPts","buffer","units","bbox","lngBuff","latBuff","buffBounds","onMarkerClick","LinearInterpolator","markers","offsetLeft","offsetTop","markers_Single","markers_Cluster","maxZoom","minZoom","viewZoom","getBounds","_map$getBounds","_map$getBounds$_sw","_sw","minLng","lng","minLat","lat","_map$getBounds$_ne","_ne","maxLng","maxLat","oldMinLng","oldMinLat","oldMaxLng","oldMaxLat","onNativeClick","selection_SeriesSelected","selectedSeries","selection_ClusterSelected","POLL_INTERVAL","withAllSeries","nextToken","fetchMore","updateQuery","fetchMoreResult","setSeriesProps","readyForPolling","withPollQuery","lastCheck","_ref5$ownProps","seriesProps","updateIncrement","changedSeries","oldList","newSeriesSummaries","seriesStatus","polledSeries","ds","oldSeries","oldId","AllSeriesConnect","PollQueryConnect","mapFuncs","setLastCheck","allSeriesQUERY","pollSeriesQUERY","maps_HomeMap","LOCAL_STORAGE_TOKEN","addLocaleData","frLocaleData","IntlWrapper","lib_index_es","locale","auth_style","forgotPassword","switch","switchButton","&:last-child","&:first-child","phoneNumInner","phoneNumDropdown","useAuthCommon","containerRef","handleKeyPress","found","getElementsByClassName","bgSwoosh","bgSwooshFill","light","xmlns","preserveAspectRatio","handleSignup","signIn","handleForgotPassword","federated","handleInputChange","handleSignIn","auth_AuthContainer","autoFocus","autoComplete","Link_default","handleConfirm","change","requiredAttributes","placeholders","attribute","signUpFields","signUpFieldLabels","signUpFieldPlaceholders","countryDialCodes","defaultDialCode","selectVal","setSelectVal","handleDialCodeChange","f","FormControl_default","InputLabel_default","htmlFor","shrink","required","Select_default","dialCode","handleResend","resendCode","handleSubmit","handleSendCode","setSent","Amplify","configure","lib_useAuthentication","authState","setAuth","signedIn","authScreen","dist","onStateChange","hideDefault","useAuthentication_SignIn","useAuthentication_Loading","useAuthentication_RequireNewPassword","useAuthentication_ConfirmSignIn","useAuthentication_ConfirmSignUp","useAuthentication_ForgotPassword","useAuthentication_SignUp","accessToken","signInUserSession","jwtToken","SignIn","newProps","changeState","auth_SignIn","SignInOrig","SignUp","hide","includes","checkCustomSignUpFields","signUpConfig","sortFields","getDefaultDialCode","I18n","get","signUp","auth_SignUp","SignUpOrig","ConfirmSignIn","_this3","auth_ConfirmSignIn","ConfirmSignInOrig","ConfirmSignUp","_this4","resend","auth_ConfirmSignUp","ConfirmSignUpOrig","RequireNewPassword","challengeParam","part","charAt","toUpperCase","substr","toLowerCase","join","auth_RequireNewPassword","RequireNewPasswordOrig","Loading","auth_Loading","LoadingOrig","ForgotPassword","_this5","send","submit","auth_ForgotPassword","ForgotPasswordOrig","Logger","_useAuthentication","useAuthentication","apolloClient","token","cache","InMemoryCache","authLink","setContext","_","authorization","httpLink","createHttpLink","uri","ApolloClient","link","ApolloLink","tokenName","connectToDevTools","createApolloClient","appContext","currentUser","react_apollo_esm","client","translations_IntlWrapper","homeConfig","views_Home","HomeMap_connect","Series_connect","Uploader_connect","isLocalhost","registerValidSW","swUrl","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","onUpdate","onSuccess","deferredPrompt","mapInit","homeInit","stateHistory","initState","combineReducers","newStateHistory","newCurrentState","newHistory","newStore","newActive","preloadedState","createStore","rootReducer","applyMiddleware","thunk","addToHomeScreen","querySelector","prompt","userChoice","choiceResult","outcome","ReactDOM","es","reduxStore","src_App_0","href","origin","fetch","contentType","status","ready","unregister","reload","checkValidServiceWorker","a2hsBtn","showAddToHomeScreen","userAgent","test","isIos","standalone","cursor","editing","reversedChip","chipAvatarIcon","reversedDelete","chipBucket","reversedChipBucket","newSize","onTagDragOver","onTagDragStop","onTagDelete","onNewTag","isReversed","newWidth","stopBadness","react_draggable_default","newHeight","onDrag","onStop","tc","blurInputOnSelect","header","listItem","dlgBody","xyTags","paperScrollPaper","tagType","tags_XYTagSelect","useXYTags","isDragging","setIsDragging","newTagDialog","setNewTagDialog","tagClass","addTag","updateTagLocation","oldTag","newX","newY","onAddTagTrigger","pageX","pageY","TagChooser","tags_XYTagChooser","setNewSize","setUrl","urlRetryCounter","setURLRetryCounter","_getURL","newUrl","getURL","_useComponentSize","urlWithRetries","_useXYTags","tags_XYTagChip","onError","onLoad","_event$target","naturalHeight","naturalWidth"],"mappings":"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","file":"static/js/main.56315ab3.chunk.js","sourcesContent":["let { useCallback, useState, useLayoutEffect, useRef } = require('react')\n\nconst getSize = (el, minSize) => {\n  if (!el) return minSize || { width: 0, height: 0 }\n\n  if (minSize) {\n    return {\n      width: Math.max(minSize.width, el.offsetWidth),\n      height: Math.max(minSize.height, el.offsetHeight)\n    }\n  }\n  else {\n    return {\n      width: el.offsetWidth,\n      height: el.offsetHeight\n    }\n  }\n}\n\nconst useComponentSize = (ref, minSize) => {\n  const resizeActiveRef = useRef()\n  const [resizeActive, setResizeActive] = useState(true)\n  resizeActiveRef.current = resizeActive\n  const [size, setComponentSize] = useState(\n    getSize(ref ? ref.current : {}, minSize)\n  )\n\n  const handleResize = useCallback(() => {\n    if (!resizeActiveRef.current) return\n    if (ref.current) setComponentSize(getSize(ref.current, minSize))\n  }, [ref])\n\n  useLayoutEffect(() => {\n    if (!ref.current) return\n\n    handleResize()\n\n    if (typeof ResizeObserver === 'function') {\n      let resizeObserver = new ResizeObserver(() => handleResize())\n      resizeObserver.observe(ref.current)\n\n      return () => {\n        resizeObserver.disconnect(ref.current)\n        resizeObserver = null\n      }\n    }\n    else {\n      window.addEventListener('resize', handleResize)\n\n      return () => {\n        window.removeEventListener('resize', handleResize)\n      }\n    }\n  },\n  [ref.current])\n\n  return { size, setResizeActive }\n}\n\nexport default useComponentSize\n","const TYPES = {\n  // Series meta gets appended automatically to the seriees\n  SERIES: 'SERIES',\n  // Same but now only gets appended to the photo\n  PHOTO: 'PHOTO'\n}\nclass SeriesConfig {\n  constructor (seriesConfig) {\n    if (!seriesConfig) throw new Error('No seriesConfig object provided to SeriesConfig class')\n    this.config = seriesConfig\n  }\n\n  getTagType = (typeId) => this.config.tags.find(tt => tt.id === typeId)\n  // getTagTypeIndex = (typeId) => this.config.tags.findIndex(tt => tt.id === typeId)\n  getTagTypeIndex = (typeId) => {\n    // console.log('HERE', typeId)\n    return this.config.tags.findIndex(tt => tt.id === typeId)\n  }\n\n  getXYTagTypes = () => this.config.tags.filter(tt => tt.allowXY)\n  getNonXYTagTypes = () => this.config.tags.filter(tt => tt.allowNonXY)\n\n  getSeriesMeta = () => Object.keys(this.config.meta)\n    .filter(key => this.config.meta[key].type === TYPES.SERIES)\n    .reduce((acc, key) => ({\n      ...acc,\n      [key]: this.config.meta[key].default\n    }), {})\n\n  getPhotoMeta = () => Object.keys(this.config.meta)\n    .filter(key => this.config.meta[key].type === TYPES.PHOTO)\n    .reduce((acc, key) => ({\n      ...acc,\n      [key]: this.config.meta[key].default\n    }), {})\n}\n\nexport default SeriesConfig\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Chip from '@material-ui/core/Chip'\nimport CancelIcon from '@material-ui/icons/Cancel'\nimport { withStyles } from '@material-ui/core/styles'\n\nexport const tagChips = {\n  height: 20\n}\n\nconst style = theme => ({\n  root: {\n    fontSize: '0.6em',\n    height: tagChips.height,\n    marginRight: theme.spacing.unit / 2,\n    marginTop: theme.spacing.unit / 2\n  },\n  deleteIcon: {\n    width: tagChips.height - 1,\n    height: tagChips.height - 1\n  },\n  chipAvatar: {\n    width: tagChips.height,\n    height: tagChips.height\n  }\n})\n\nconst TagChip = ({ classes, theme, edit, tag, color, onDelete, ...props }) => {\n  return (\n    <Chip\n      style={{\n        background: color || null,\n        color: color ? `${theme.palette.getContrastText(color)}` : null\n      }}\n      label={tag.label}\n      data={tag.id}\n      onDelete={edit ? () => onDelete(tag) : null}\n      deleteIcon={(\n        <CancelIcon\n          className={classes.deleteIcon}\n          onClick={e => {\n            console.log('this click')\n          }}\n          style={{\n            opacity: 0.5,\n            color: color ? `${theme.palette.getContrastText(color)}` : null\n          }}\n        />\n      )}\n      className={classes.root}\n      {...props}\n    />\n  )\n}\n\nTagChip.propTypes = {\n  classes: PropTypes.object.isRequired,\n  theme: PropTypes.object.isRequired,\n  color: PropTypes.string.isRequired,\n  edit: PropTypes.bool,\n  tag: PropTypes.object.isRequired,\n  onDelete: PropTypes.func\n}\n\nexport default withStyles(style, { withTheme: true })(TagChip)\n","import React from 'react'\nimport classNames from 'classnames'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport FormLabel from '@material-ui/core/FormLabel'\nimport { withStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n    position: 'relative',\n    display: 'block',\n    overflow: 'hidden',\n    whiteSpace: 'pre-line',\n    '&::before': {\n      content: '\"  \"',\n      display: 'block',\n      position: 'absolute',\n      bottom: 0,\n      width: '100%',\n      height: 100,\n      background: `linear-gradient(180deg, rgba(255,255,255,0) 0%, ${theme.palette.background.paper} 100%)`\n    }\n  }\n})\n\nconst ShortLongText = ({ classes, label, text, height, onClick }) => {\n  return (\n    <div onClick={onClick}>\n      {label && (\n        <FormLabel className={classes.formLabel}>\n          {label}\n        </FormLabel>\n      )}\n      <Typography\n\n        variant='body1'\n        color='inherit'\n        style={{ height }}\n        className={classNames(classes.root)}\n      >\n        {text}\n      </Typography>\n    </div>\n  )\n}\n\nShortLongText.propTypes = {\n  classes: PropTypes.object.isRequired,\n  label: PropTypes.string,\n  text: PropTypes.string,\n  height: PropTypes.number,\n  onClick: PropTypes.func\n}\nShortLongText.defaultProps = {\n  height: 100\n}\n\nexport default withStyles(style)(ShortLongText)\n","import uuid from 'uuid/v4'\nimport SeriesConfig from './SeriesConfig'\n\nclass Tags {\n  constructor (seriesConfig, tags) {\n    this.tags = tags\n    this.seriesConfig = new SeriesConfig(seriesConfig)\n  }\n\n  findTagById = (typeId, tagId) => {\n    return this.seriesConfig.getTagType(typeId).values\n      .find(tt => tt.id === tagId)\n  }\n\n  // Filter the list of tags to those that are XY tags\n  getXYTags = () => {\n    const xyTagIds = this.seriesConfig.getXYTagTypes().map(tt => tt.id)\n    return this.tags.filter(tag => xyTagIds.indexOf(tag.typeId) > -1 && tag.coords && tag.coords.x)\n  }\n\n  getNonXYTags = () => {\n    const NonXYTagIds = this.seriesConfig.getNonXYTagTypes().map(tt => tt.id)\n    return this.tags.filter(tag => NonXYTagIds.indexOf(tag.typeId) > -1)\n  }\n\n  createNewTagObj = (label, typeId) => (\n    { id: uuid(), label, typeId }\n  )\n\n  createExistingTagObj = (id, typeId) => ({\n    ...this.findTagById(typeId, id),\n    typeId\n  })\n\n  createNewXYTagObj = (label, typeId, coords) => ({\n    id: uuid(),\n    label,\n    typeId,\n    coords\n  })\n\n  createExistingXYTagObj = (id, typeId, coords) => ({\n    ...this.findTagById(typeId, id),\n    typeId,\n    coords\n  })\n\n  // Get tags in a way that's easy to render them\n  // We augment these tags with relative positions\n  // and a group number for coloring.\n  getRelXYTags = (multiplier) => this.getXYTags().map(tag => ({\n    ...tag,\n    group: this.seriesConfig.getTagTypeIndex(tag.typeId),\n    relCoords: {\n      x: tag.coords.x * multiplier,\n      y: tag.coords.y * multiplier\n    }\n  }))\n}\n\nexport default Tags\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport { withStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n    color: theme.palette.primary.main,\n    position: 'absolute',\n    top: '50%',\n    left: '50%',\n    textAlign: 'center',\n    transformOrigin: '50% 50%',\n    transform: 'translateY(-50%) translateX(-50%)',\n    zIndex: 1\n  },\n  rootActive: {\n    zIndex: 1000\n  },\n  svgDot: {\n    zIndex: 102,\n    width: 20,\n    height: 20,\n    position: 'absolute',\n    top: '50%',\n    left: '50%',\n    textAlign: 'center',\n    transformOrigin: '50% 50%',\n    transform: 'translateY(-50%) translateX(-50%)'\n  },\n  dot: {\n    stroke: theme.palette.secondary.contrastText,\n    strokeWidth: '1',\n    fill: theme.palette.secondary.main\n  },\n  directionIndicator: {\n    position: 'absolute',\n    left: '50%',\n    // transformOrigin: '50% 50%',\n    // transform: 'translateY(-50%) translateX(-50%)',\n    zIndex: 100\n  },\n  name: {\n    color: 'white',\n    fontWeight: 'bold',\n    textShadow: `\n        0px 0px 4px #000000, \n        0px 0px 4px #000000 \n    `,\n    zIndex: 122,\n    position: 'relative'\n    // textStroke: '1px white'\n  },\n  nameActive: {\n    color: theme.palette.secondary.dark,\n    textShadow: `\n    0px 0px 2px #FFFFFF, \n    0px 0px 2px #FFFFFF,\n    0px 0px 4px #FFFFFF \n`\n  }\n})\n\nconst Single = ({ classes, direction }) => {\n  return (\n    <div className={classes.root}>\n      <svg className={classes.svgDot} version='1.1' viewBox='0, 0, 10, 10' >\n        <circle cx='5' cy='5' r='4' className={classes.dot} />\n      </svg>\n      {direction && direction >= 0 ? (\n        <div className={classes.directionIndicator}>\n          <svg className={classes.svgArc}\n            version='1.1'\n            width='100'\n            height='100'\n            viewBox='0, 0, 100, 100'\n            style={{ transform: `translateY(-50%) translateX(-50%) rotateZ(${direction}deg)` }}>\n            <path d='M50,0 C60.946,0.151 72.136,3.514 80.675,10.56 L50,50 L19.325,10.56 C27.938,3.461 39,0.278 50,0 z'\n              fill='#009DC1'\n              fillOpacity='0.444'\n              strokeWidth='0.5'\n              strokeOpacity='0.6'\n              stroke='#FFFFFF'\n            />\n          </svg>\n        </div>\n      ) : null}\n    </div>\n  )\n}\n\nSingle.propTypes = {\n  classes: PropTypes.object.isRequired,\n  direction: PropTypes.number\n}\n\nexport default withStyles(style)(Single)\n","import React, { useState, useRef, useMemo } from 'react'\nimport { StaticMap } from 'react-map-gl'\nimport PropTypes from 'prop-types'\nimport { getDistanceScales } from 'viewport-mercator-project'\nimport useComponentSize from '../../lib/useComponentSize'\nimport StyleButtons from './controls/StyleButtons'\nimport { mapConfig } from '../../config'\nimport classNames from 'classnames'\nimport 'mapbox-gl/dist/mapbox-gl.css'\nimport './BaseMap.css'\n\n/**\n * Note that this component technically has state but it is designed to be functionally stateless\n */\nconst BaseStaticMap = (props) => {\n  const {\n    controlPadding,\n    viewport,\n    children,\n    mapStyles,\n    onMapDataEvent,\n    ...passthroughProps\n  } = props\n\n  const mapRef = useRef(null)\n  const { size } = useComponentSize(mapRef, { width: 100, height: 50 })\n\n  const [currStyle, setCurrStyle] = useState(0)\n  const [projection, setProjection] = useState(null)\n\n  const recalcProjection = () => {\n    if (!size || size.width < 10 || size.height < 10) return\n    try {\n      const projection = getDistanceScales(viewport)\n      // console.log('recalcProjection', { projection, size })\n      setProjection(projection)\n    }\n    catch (e) {\n      // Sometimes we don't have a valid bound. Don't make a big deal out of it.\n      console.error(e)\n    }\n  }\n\n  if (!projection) recalcProjection()\n  useMemo(recalcProjection, [size])\n\n  return (\n    <div className={classNames('BaseMap', props.className)} ref={mapRef} style={{ height: '100%', width: '100%' }}>\n      <StaticMap\n        {...viewport}\n        height={size.height}\n        width={size.width}\n        mapStyle={mapStyles[currStyle].style}\n        onData={onMapDataEvent}\n        mapboxApiAccessToken={mapConfig.mapBoxToken}\n        {...passthroughProps}\n      >\n        { mapStyles && mapStyles.length > 1 ? (\n          <StyleButtons\n            controlPadding={controlPadding}\n            currStyle={currStyle}\n            mapStyles={mapStyles}\n            setCurrStyle={setCurrStyle}\n          />\n        ) : null }\n        {\n          children && Array.isArray(children)\n            ? children.map(c => handleChild(c, viewport, size.height, size.width, projection))\n            : handleChild(children, viewport, size.height, size.width, projection)\n        }\n      </StaticMap>\n    </div>\n  )\n}\n\nfunction handleChild (child, viewport, height, width, projection) {\n  return typeof child === 'function'\n    ? child(viewport, height, width, projection)\n    : child\n}\n\nBaseStaticMap.propTypes = {\n  // Anything else we want to add to the map\n  children: PropTypes.any,\n  deckelements: PropTypes.array,\n  data: PropTypes.array,\n  // Maybe we want map controls to be padded\n  controlPadding: PropTypes.object,\n\n  minPitch: PropTypes.number,\n  maxPitch: PropTypes.number,\n  pitch: PropTypes.number,\n\n  // Lock the bounds of a map to a rectangle [minlng, minlat], [maxlng, maxlat]\n  bounds: PropTypes.array,\n  // Lock the possible zoom levels to a range: [minZoom, maxZoom]\n  zoomBounds: PropTypes.array,\n  // InitialBounds of the map.\n  InnerBounds: PropTypes.array,\n\n  // List of valid styles that will get picker buttons\n  mapStyles: PropTypes.array,\n\n  // Just some default props we probably won't set.\n  latitude: PropTypes.number,\n  longitude: PropTypes.number,\n  zoom: PropTypes.number,\n\n  onMapDataEvent: PropTypes.func\n}\nBaseStaticMap.defaultProps = {\n  controlPadding: {},\n  stylechooser: true,\n  // viewport: {\n  //   zoom: 12,\n  //   latitude: 49.3050394,\n  //   longitude: -123.1398254\n  // },\n  initStyle: 0,\n  mapStyles: mapConfig.styles\n}\n\nexport default BaseStaticMap\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport { withStyles } from '@material-ui/core/styles'\nimport BaseMap from './BaseMap'\nimport Dot from './markers/Dot'\nimport BaseStaticMap from './BaseStaticMap'\nimport style from './MapDot.style'\n\nconst MapDot = ({ classes, staticMap, editable, onChange, direction, ...props }) => {\n  const Map = staticMap ? BaseStaticMap : BaseMap\n  const mapProps = staticMap ? {} : {\n    touchRotate: false,\n    dragRotate: false,\n    showMe: editable,\n    lockPan: !editable,\n    onViewportChange: onChange\n  }\n\n  return (\n    <Map\n      {...mapProps}\n      {...props}\n    >\n      <Dot direction={direction} />\n    </Map>\n  )\n}\n\nMapDot.propTypes = {\n  classes: PropTypes.object.isRequired,\n  direction: PropTypes.number,\n  editable: PropTypes.bool,\n  staticMap: PropTypes.bool,\n  onChange: PropTypes.func\n}\n\nexport default withStyles(style)(MapDot)\n","export default theme => ({\n  mapWrapper: {\n    width: '100%'\n  },\n  svgDot: {\n    zIndex: 2,\n    position: 'absolute',\n    width: '5%',\n    height: '5%',\n    top: '50%',\n    left: '50%',\n    transformOrigin: '50% 50%',\n    transform: 'translateY(-50%) translateX(-50%)'\n  },\n  svgArc: {\n    zIndex: 1,\n    position: 'absolute',\n    width: '85%',\n    height: '85%',\n    top: '50%',\n    left: '50%',\n    transformOrigin: '50% 50%'\n  }\n})\n","import MapStyles from './mapStyles'\n\nexport default {\n  // Bright Pastel\n  tagColors: [\n    '#418CF0', '#FCB441', '#E0400A', '#056492', '#BFBFBF', '#1A3B69', '#FFE382', '#129CDD', '#CA6B4B',\n    '#005CDB', '#F3D288', '#506381', '#F1B9A8', '#E0830A', '#7893BE'\n  ]\n}\n\nexport const mapConfig = {\n  mapBoxToken: process.env.REACT_APP_MAPBOX_TOKEN,\n  styles: MapStyles\n}\n\nlet baseurl = process.env.REACT_APP_BASEURL\nlet basename = process.env.REACT_APP_BASENAME\nlet domain = process.env.REACT_APP_DOMAIN\nif (process.env.NODE_ENV && process.env.NODE_ENV === 'development') {\n  domain = 'localhost'\n  basename = ''\n}\nconsole.log('config: ', baseurl, basename)\n\nexport const home = {\n  AppStateTypes: {\n    MAP: 'map', // Looking at the map\n    LIST: 'list', // Looking at the list\n    USER: 'user', // Looking at user information\n    SERIES: 'series', // Looking at one particular sereis\n    NEW_SERIES_CAMERA: 'new_series_camera', // Looking at one particular sereis\n    NEW_SERIES_LIBRARY: 'new_series_library' // Looking at one particular sereis\n  },\n  MapModeTypes: {\n    FREE: 'free', //\n    USER: 'user', // filtered to a given user\n    TAG: 'tag' // filtered to a given tag\n  }\n}\n\nexport const federated = {\n  // oauth_config: {\n\n  // },\n  // google_client_id: process.env.REACT_APP_GOOGLE_APP_ID\n}\n\nexport const endpoints = {\n  graphql: process.env.REACT_APP_GRAPHQL,\n  cdn: process.env.REACT_APP_CDN\n}\n\nexport const localDb = {\n  imgStore: 'imgStore'\n}\n\nexport const aws = {\n  Auth: {\n    // REQUIRED - Amazon Cognito Identity Pool ID\n    // identityPoolId: process.env.REACT_APP_COGNITO_IDPOOLID, // XX-XXXX-X:XXXXXXXX-XXXX-1234-abcd-1234567890ab\n    // REQUIRED - Amazon Cognito Region\n    region: process.env.REACT_APP_AWS_REGION,\n    // OPTIONAL - Amazon Cognito User Pool ID\n    userPoolId: process.env.REACT_APP_COGNITO_USER_POOL_ID,\n    // OPTIONAL - Amazon Cognito Web Client ID (26-char alphanumeric string)\n    userPoolWebClientId: process.env.REACT_APP_COGNITO_CLIENT_ID,\n    // OPTIONAL - Enforce user authentication prior to accessing AWS resources or not\n    mandatorySignIn: true,\n    // OPTIONAL - Configuration for cookie storage\n    cookieStorage: {\n      // REQUIRED - Cookie domain (only required if cookieStorage is provided)\n      domain: `${domain}`,\n      // OPTIONAL - Cookie path\n      // path: `/${basename}`,\n      // OPTIONAL - Cookie expiration in days\n      expires: 20,\n      // OPTIONAL - Cookie secure flag\n      secure: false\n    }\n\n  }\n\n}\n","import Satellite from './Satellite.json'\n// import BasicMap from './BasicMap.json'\nimport TopoMap from './TopoMap.json'\n\nimport {\n  Satellite as SatIcon,\n  SatelliteOutlined,\n  // DirectionsCar,\n  // DirectionsCarOutlined,\n  Terrain,\n  TerrainOutlined\n} from '@material-ui/icons'\n\nexport default [\n  {\n    toolTip: 'Sat',\n    Icon: SatelliteOutlined,\n    ActiveIcon: SatIcon,\n    color: 'green',\n    style: Satellite\n  },\n  {\n    toolTip: 'Topo',\n    Icon: TerrainOutlined,\n    ActiveIcon: Terrain,\n    color: 'blue',\n    style: TopoMap\n  }\n]\n","import { useState, useEffect } from 'react'\n\nexport const useGeolocation = () => {\n  const [state, setState] = useState({\n    accuracy: null,\n    altitude: null,\n    altitudeAccuracy: null,\n    heading: null,\n    latitude: null,\n    longitude: null,\n    speed: null,\n    timestamp: Date.now()\n  })\n  let mounted = true\n  let watchId\n\n  const onEvent = event => {\n    if (mounted) {\n      setState({\n        accuracy: event.coords.accuracy,\n        altitude: event.coords.altitude,\n        altitudeAccuracy: event.coords.altitudeAccuracy,\n        heading: event.coords.heading,\n        latitude: event.coords.latitude,\n        longitude: event.coords.longitude,\n        speed: event.coords.speed,\n        timestamp: event.timestamp\n      })\n    }\n  }\n\n  useEffect(\n    () => {\n      navigator.geolocation.getCurrentPosition(onEvent)\n      watchId = navigator.geolocation.watchPosition(onEvent)\n\n      return () => {\n        mounted = false\n        navigator.geolocation.clearWatch(watchId)\n      }\n    },\n    [0]\n  )\n\n  return state\n}\n\nexport function useDeviceOrientation () {\n  const [deviceOrientation, setDeviceOrientation] = useState({ absolute: false, alpha: null, beta: null, gamma: null })\n\n  function handleDeviceOrientation (event) {\n    setDeviceOrientation({\n      absolute: event.absolute,\n      alpha: event.alpha,\n      beta: event.beta,\n      gamma: event.gamma\n    })\n  }\n\n  useEffect(() => {\n    window.addEventListener('deviceorientation', handleDeviceOrientation, true)\n\n    return () => {\n      window.removeEventListener('deviceorientation', handleDeviceOrientation)\n    }\n  }, [])\n\n  return deviceOrientation\n}\n\nexport function playClickAudio (clickSound) {\n  let audio = new Audio('data:audio/mp3;base64,' + clickSound.base64)\n  audio.play()\n}\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\nimport SpeedDial from '@material-ui/lab/SpeedDial'\nimport SpeedDialAction from '@material-ui/lab/SpeedDialAction'\n// import MapLayersIcon from '@material-ui/icons/Layers'\nimport { withStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n    zIndex: 10,\n    position: 'absolute'\n  },\n  speedDialFab: {\n    border: '2px solid',\n    background: theme.palette.secondary.main,\n    color: theme.palette.secondary.contrastText,\n    width: 40,\n    height: 40\n  },\n  speedDialAction: {\n    border: '2px solid',\n    background: theme.palette.primary.main,\n    color: theme.palette.primary.contrastText,\n    marginTop: 0,\n    marginBottom: 0\n  },\n  speedDialIcon: {\n    // border: '1px solid red'\n  },\n  speedDialLabel: {\n    background: 'black',\n    color: 'white'\n  }\n})\n\nconst StyleButtons = ({ classes, theme, controlPadding, currStyle, mapStyles, setCurrStyle }) => {\n  const [open, setOpen] = useState(false)\n\n  const noEventSetOpen = (e, state) => {\n    console.log('noEventSetOpen', e, state)\n    e.preventDefault()\n    e.stopPropagation()\n    setOpen(state)\n  }\n\n  if (!mapStyles || !Array.isArray(mapStyles) || mapStyles.length < 2 || !mapStyles[currStyle]) return null\n\n  const currStyleObj = mapStyles[currStyle]\n  const ActiveIcon = currStyleObj.ActiveIcon\n\n  return (\n    <div className={classes.root} style={{\n      top: controlPadding.top ? controlPadding.top : theme.spacing.unit * 2,\n      right: controlPadding.right ? controlPadding.right : theme.spacing.unit * 2\n    }}>\n      {mapStyles.length > 1 && (\n        <SpeedDial\n          ariaLabel='SpeedDial example'\n          className={classes.speedDial}\n          classes={{\n            fab: classes.speedDialFab\n          }}\n          icon={<ActiveIcon className={classes.icon} />}\n          // onBlur={(e) => noEventSetOpen(e, false)}\n          onClick={(e) => noEventSetOpen(e, !open)}\n          onClose={(e) => noEventSetOpen(e, false)}\n          // onFocus={(e) => noEventSetOpen(e, true)}\n          // onMouseEnter={(e) => noEventSetOpen(e, true)}\n          // onMouseLeave={(e) => noEventSetOpen(e, false)}\n          open={open}\n          direction='left'\n        >\n\n          {mapStyles.map(({ Icon, ActiveIcon, toolTip }, idx) => (\n            <SpeedDialAction\n              key={`stylebutton${idx}`}\n              // Bit of a hack here. This function isn't quite ready for primetime\n              icon={<Icon className={classes.speedDialIcon} />}\n              tooltipPlacement='bottom'\n              ButtonProps={{\n                classes: {\n                  root: classes.speedDialAction\n                }\n              }}\n              TooltipClasses={{\n                tooltip: classes.speedDialLabel\n              }}\n              tooltipTitle={toolTip}\n              tooltipOpen\n              onClick={() => {\n                console.log('SET', idx)\n                setCurrStyle(idx)\n                setOpen(false)\n              }}\n            />\n          ))}\n\n        </SpeedDial>\n      ) }\n    </div>\n  )\n}\n\nStyleButtons.propTypes = {\n  classes: PropTypes.object.isRequired,\n  theme: PropTypes.object.isRequired,\n  // controlPadding: {top, right, bottom, left}\n  controlPadding: PropTypes.object,\n  currStyle: PropTypes.number,\n  mapStyles: PropTypes.array,\n  setCurrStyle: PropTypes.func\n}\nStyleButtons.defaultProps = {\n  controlPadding: {}\n}\n\nexport default withStyles(style, { withTheme: true })(StyleButtons)\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport Dialog from '@material-ui/core/Dialog'\nimport IconButton from '@material-ui/core/IconButton'\nimport DialogTitle from '@material-ui/core/DialogTitle'\n\nimport CloseIcon from '@material-ui/icons/Close'\nimport { withStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n\n  },\n  body: {\n    overflow: 'hidden',\n    whiteSpace: 'pre-line',\n    paddingBottom: theme.spacing.unit\n  },\n  title: {\n    margin: 0,\n    padding: theme.spacing.unit * 2\n  },\n  closeButton: {\n    position: 'absolute',\n    right: theme.spacing.unit,\n    top: theme.spacing.unit,\n    color: theme.palette.grey[500]\n  }\n})\n\nconst BigText = ({ classes, open, onClose, title, body }) => (\n  <Dialog\n    scroll='paper'\n    open={open}\n    onClose={onClose}\n    aria-labelledby='simple-dialog-title'\n  >\n    <DialogTitle className={classes.title}>\n      {title}\n      <IconButton className={classes.closeButton} onClick={onClose}>\n        <CloseIcon />\n      </IconButton>\n    </DialogTitle>\n    <DialogContent>\n      <Typography variant='body1' className={classes.body}>{body}</Typography>\n    </DialogContent>\n  </Dialog>\n)\n\nBigText.propTypes = {\n  classes: PropTypes.object.isRequired,\n  open: PropTypes.bool,\n  onClose: PropTypes.func,\n  title: PropTypes.string,\n  body: PropTypes.string\n}\n\nexport default withStyles(style)(BigText)\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport Button from '@material-ui/core/Button'\nimport Typography from '@material-ui/core/Typography'\nimport DialogActions from '@material-ui/core/DialogActions'\n\nimport { withStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n\n})\n\nconst DeleteDialog = ({ classes, title, message, onConfirm, open }) => (\n  <Dialog\n    className={classes.root}\n    disableBackdropClick\n    open={open}\n    disableEscapeKeyDown\n    maxWidth='xl'\n    aria-labelledby='confirmation-dialog-title'\n  >\n    <DialogTitle id='confirmation-dialog-title'>{title}</DialogTitle>\n    <DialogContent>\n      <Typography>\n        {message}\n      </Typography>\n\n    </DialogContent>\n    <DialogActions>\n      <Button onClick={() => onConfirm(false)} color='primary'>\n      No\n      </Button>\n      <Button onClick={() => onConfirm(true)} color='primary'>\n      Yes\n      </Button>\n    </DialogActions>\n  </Dialog>\n)\n\nDeleteDialog.propTypes = {\n  classes: PropTypes.object.isRequired,\n  open: PropTypes.bool,\n  title: PropTypes.string.isRequired,\n  message: PropTypes.string.isRequired,\n  onConfirm: PropTypes.func.isRequired\n}\n\nexport default withStyles(style)(DeleteDialog)\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\n// import Typography from '@material-ui/core/Typography'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogActions from '@material-ui/core/DialogActions'\nimport TextField from '@material-ui/core/TextField'\nimport Button from '@material-ui/core/Button'\nimport DialogTitle from '@material-ui/core/DialogTitle'\n\nimport { withStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n\n  },\n  body: {\n    overflow: 'hidden',\n    whiteSpace: 'pre-line',\n    paddingBottom: theme.spacing.unit\n  },\n  title: {\n    margin: 0,\n    padding: theme.spacing.unit * 2\n  },\n  closeButton: {\n    position: 'absolute',\n    right: theme.spacing.unit,\n    top: theme.spacing.unit,\n    color: theme.palette.grey[500]\n  }\n})\n\nconst BigTextEdit = ({ classes, open, onOk, title, body, multiline }) => {\n  const [value, setValue] = useState(body || '')\n  return (\n    <Dialog\n      scroll='paper'\n      open={open}\n      fullWidth\n      onClose={() => onOk(value)}\n    >\n      <DialogTitle className={classes.title}>\n        {title}\n      </DialogTitle>\n      <DialogContent>\n        <TextField\n          className={classes.body}\n          multiline={multiline}\n          fullWidth\n          rows={6}\n          rowsMax={20}\n          onChange={e => setValue(e.target.value)}\n          defaultValue={body}\n        />\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={() => onOk(body)}>Cancel</Button>\n        <div style={{ flexGrow: 1 }} />\n        <Button onClick={() => onOk(value)}>Ok</Button>\n      </DialogActions>\n    </Dialog>\n  )\n}\n\nBigTextEdit.propTypes = {\n  classes: PropTypes.object.isRequired,\n  open: PropTypes.bool,\n  multiline: PropTypes.bool,\n  onOk: PropTypes.func,\n  title: PropTypes.string,\n  body: PropTypes.string\n}\n\nexport default withStyles(style)(BigTextEdit)\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport Slider from '@material-ui/lab/Slider'\n// import { Menu as MenuIcon } from '@material-ui/icons'\nimport { withStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n    color: 'white',\n    zIndex: 10,\n    display: 'flex',\n    flexDirection: 'column',\n    position: 'absolute',\n    height: '50%',\n    top: '45%',\n    left: '0',\n    transform: 'translateY(-50%)'\n  },\n  sliderLabel: {\n    display: 'block',\n    flexGrow: 1,\n    textAlign: 'center',\n    padding: theme.spacing.unit\n  },\n  container: {\n    padding: '10px 36px'\n  },\n  track: {\n    width: `4px!important`,\n    background: 'white'\n  },\n  thumb: {\n    background: 'white',\n    width: 30,\n    height: 30\n\n  }\n})\n\nconst PhotoFadeSlider = ({ classes, defaultValue, onChange }) => {\n  // we control the state internally so we get a smooth experience\n  const [slider, setSlider] = useState(defaultValue)\n\n  const onSliderMove = (event, value) => {\n    setSlider(value)\n    // send it back if we need to\n    onChange(value)\n  }\n\n  return (\n    <div className={classes.root}>\n      <Typography className={classes.sliderLabel} color='inherit' variant='caption'>New</Typography>\n      <Slider\n        classes={{\n          container: classes.container,\n          track: classes.track,\n          thumb: classes.thumb\n        }}\n        value={slider}\n        aria-labelledby='label'\n        onChange={onSliderMove}\n        vertical\n      />\n      <Typography className={classes.sliderLabel} color='inherit' variant='caption'>Reference</Typography>\n    </div>\n  )\n}\n\nPhotoFadeSlider.propTypes = {\n  classes: PropTypes.object.isRequired,\n  defaultValue: PropTypes.number,\n  onChange: PropTypes.func\n}\n\nPhotoFadeSlider.defaultProps = {\n  defaultValue: 100,\n  onChange: () => {}\n}\n\nexport default withStyles(style)(PhotoFadeSlider)\n","export default theme => ({\n  root: {\n    width: '100%'\n  },\n  tagContainer: {\n  },\n  formControl: {\n\n  },\n  actionButtons: {\n    textAlign: 'right'\n  },\n  noOptionsMessage: {\n    padding: `${theme.spacing.unit}px ${theme.spacing.unit * 2}px`\n  },\n  singleValue: {\n    fontSize: 16\n  },\n  placeholder: {\n    position: 'absolute',\n    left: 2,\n    fontSize: 16\n  },\n  input: {\n    display: 'flex',\n    padding: 0\n  },\n  valueContainer: {\n    display: 'flex',\n    flexWrap: 'wrap',\n    flex: 1,\n    alignItems: 'center',\n    overflow: 'hidden'\n  },\n  paper: {\n    position: 'absolute',\n    zIndex: 1,\n    marginTop: theme.spacing.unit,\n    left: 0,\n    right: 0\n  }\n})\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport Typography from '@material-ui/core/Typography'\nimport { withStyles } from '@material-ui/core/styles'\n\nimport TagChip from '../tags/TagChip'\nimport style from './TagControl.style'\n\n/**\n * Just to be clear: the state here is being stored as []\n */\nconst TagControl = ({\n  classes, tags, label, tagConfig, className\n}) => {\n  // Filter to just this tag type\n  const tagValues = tags.filter(tag => tag.typeId === tagConfig.id && !tag.coords)\n\n  return (\n    <div className={classNames(classes.root, className)}>\n      <Typography variant='overline' className={classes.fieldTitle}>\n        {tagConfig.label}\n      </Typography>\n      <div className={classes.tagContainer}>\n        {tagValues.map((tag, idx) => (\n          <TagChip tag={tag} key={`tagchip${idx}`} color={tagConfig.color} />\n        ))}\n      </div>\n\n    </div>\n  )\n}\n\nTagControl.propTypes = {\n  classes: PropTypes.object.isRequired,\n  className: PropTypes.string,\n  label: PropTypes.string,\n  tags: PropTypes.array,\n  tagConfig: PropTypes.object\n}\n\nexport default withStyles(style)(TagControl)\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport {\n  TextField,\n  Typography\n} from '@material-ui/core'\nimport { withStyles } from '@material-ui/core/styles'\nimport { timestampToHTML5Input, HTML5InputToTimestamp } from '../../../../lib/datelib'\n\nconst style = theme => ({\n  root: {\n  },\n  rootEdit: {\n  },\n  formControl: {\n    width: '100%'\n  },\n  textBody: {\n    whiteSpace: 'pre-line'\n  },\n  actionButtons: {\n    textAlign: 'right'\n  }\n})\n\nconst DateControl = ({\n  classes,\n  label,\n  value,\n  hint,\n  onChange,\n  className\n}) => {\n  return (\n    <div className={classNames(classes.root, className)}>\n      <Typography variant='overline' className={classes.fieldTitle}>\n        {label}\n      </Typography>\n      <TextField\n        type='datetime-local'\n        fullWidth\n        value={timestampToHTML5Input(value)}\n        className={classes.textField}\n        onChange={(e) => onChange(HTML5InputToTimestamp(e.target.value))}\n      />\n      {hint && <Typography variant='caption' className={classes.hint}>{hint}</Typography>}\n    </div>\n  )\n}\n\nDateControl.propTypes = {\n  classes: PropTypes.object.isRequired,\n  className: PropTypes.string,\n  label: PropTypes.string.isRequired,\n  hint: PropTypes.string,\n  value: PropTypes.string, // all timestamps come in as integerstrings\n  onChange: PropTypes.func.isRequired\n}\n\nexport default withStyles(style)(DateControl)\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport uuid from 'uuid/v4'\nimport Paper from '@material-ui/core/Paper'\nimport TextField from '@material-ui/core/TextField'\nimport Typography from '@material-ui/core/Typography'\nimport MenuItem from '@material-ui/core/MenuItem'\n\nimport Select from 'react-select'\nimport CreatableSelect from 'react-select/lib/Creatable'\nimport { withStyles } from '@material-ui/core/styles'\n\nimport TagChip from '../tags/TagChip'\nimport style from './TagControl.style'\n\n/**\n * Just to be clear: the state here is being stored as []\n */\nconst TagControl = ({\n  classes, tags, onChange,\n  hint, tagConfig, className\n}) => {\n  // console.log('TagControl Rnder', { tags, tagConfig })\n  const onSelectChange = (inputValue, { action, removedValue, option }) => {\n    // If this was the last tag then close the menu\n    switch (action) {\n      case 'clear':\n        onChange([])\n        break\n      case 'remove-value':\n        // Remember we need to potentially remove it from the old AND the new\n        onChange(tags.filter(val => val.id !== removedValue.value))\n        break\n      case 'select-option':\n        const newVal = {\n          ...tagConfig.values.find(tcv => tcv.id === option.value),\n          typeId: tagConfig.id\n        }\n        onChange([...tags, newVal])\n        break\n      case 'create-option':\n        const newLabel = inputValue.find(v => v.__isNew__).value\n        const newCreateVal = {\n          label: newLabel,\n          id: uuid(),\n          typeId: tagConfig.id\n        }\n        onChange([...tags, newCreateVal])\n        break\n      default:\n        break\n    }\n  }\n\n  const SingleValue = ({ removeProps, innerProps, data, ...props }) => {\n    // console.log('SingleValue PROPS', { removeProps, innerProps, data, props })\n    return (\n      <TagChip tag={data} onDelete={(e) => {\n        // console.log('EVENT', e)\n        removeProps.onClick()\n      }} color={tagConfig.color} edit />\n    )\n  }\n  SingleValue.propTypes = {\n    removeProps: PropTypes.any,\n    innerProps: PropTypes.any,\n    data: PropTypes.any\n  }\n\n  const MultiValue = ({ removeProps, innerProps, data, ...props }) => {\n    // console.log('MultiValue PROPS', { removeProps, innerProps, data, props })\n    return (\n      <TagChip tag={data} onDelete={(e) => {\n        // console.log('EVENT', e)\n        removeProps.onClick()\n      }} color={tagConfig.color} edit />\n    )\n  }\n  MultiValue.propTypes = {\n    removeProps: PropTypes.any,\n    innerProps: PropTypes.any,\n    data: PropTypes.any\n  }\n\n  // Filter to just this tag type\n  const tagValues = tags.filter(tag => tag.typeId === tagConfig.id && !tag.coords)\n  // Now format it as {label, value: id} for react-select\n  const selectOptions = tagValues.map(val => ({ label: val.label, value: val.id }))\n\n  // Filter out things we haven't chosen yet\n  // Also transform the options into a label/value pair for react-select\n  const remainingTags = tagConfig.values\n    .filter(val => tagValues.map(t => t.id).indexOf(val.id) === -1)\n    .map(val => ({ label: val.label, value: val.id }))\n\n  // console.log('TAG DEBUG', { value, tagValues, tagConfig })\n\n  return (\n    <div className={classNames(classes.root, className)}>\n      <Typography variant='overline' className={classes.fieldTitle}>\n        {tagConfig.label}\n      </Typography>\n      {!tagConfig.allowAdditions && (\n        <Select\n          options={remainingTags}\n          classes={classes}\n          isFocused\n          components={{\n            Control,\n            Menu,\n            //   MultiValue,\n            NoOptionsMessage,\n            Option,\n            Placeholder,\n            //   SingleValue,\n            ValueContainer\n          }}\n          deleteRemoves\n          value={selectOptions}\n          isClearable={false}\n          onChange={onSelectChange}\n          placeholder='Select Tags'\n          isMulti\n          isSearchable\n        />\n      ) }\n      { tagConfig.allowAdditions && (\n        <CreatableSelect\n          options={remainingTags}\n          classes={classes}\n          isFocused\n          deleteRemoves\n          components={{\n            Control,\n            Menu,\n            //   MultiValue,\n            NoOptionsMessage,\n            Option,\n            Placeholder,\n            //   SingleValue,\n            ValueContainer\n          }}\n          value={selectOptions}\n          isClearable={false}\n          onChange={onSelectChange}\n          placeholder='Select Tags'\n          isMulti\n          isSearchable\n        />\n      )}\n      {hint && <Typography variant='caption' className={classes.hint}>{hint}</Typography>}\n    </div>\n  )\n}\n\nTagControl.propTypes = {\n  classes: PropTypes.object.isRequired,\n  className: PropTypes.string,\n  hint: PropTypes.string,\n  tags: PropTypes.array,\n  onChange: PropTypes.func.isRequired,\n  tagConfig: PropTypes.object\n}\n\nexport default withStyles(style)(TagControl)\n\nfunction Control (props) {\n  // console.log('CONTROL PROPS', props)\n  return (\n    <TextField\n      fullWidth\n      InputProps={{\n        inputComponent,\n        inputProps: {\n          className: props.selectProps.classes.input,\n          inputRef: props.innerRef,\n          children: props.children,\n          // innerProps: {\n          onMouseDown: (e) => {\n            props.innerProps.onMouseDown(e)\n          },\n          onTouchEnd: (e) => {\n            props.innerProps.onTouchEnd(e)\n          }\n          // }\n          // ...props.innerProps\n        }\n      }}\n      {...props.selectProps.textFieldProps}\n    />\n  )\n}\n\nconst NoOptionsMessage = ({ innerProps, selectProps, children }) => (\n  <Typography\n    color='textSecondary'\n    className={selectProps.classes.noOptionsMessage}\n    {...innerProps}\n  >\n    {children}\n  </Typography>\n)\n\nconst Menu = ({ selectProps, innerProps, children }) => (\n  <Paper square className={selectProps.classes.paper} {...innerProps}>\n    {children}\n    {/* {console.log('MENU PROPS', { selectProps, innerProps, children })} */}\n  </Paper>\n)\n\nconst inputComponent = ({ inputRef, ...props }) => <div ref={inputRef} {...props} />\n\nconst Placeholder = (props) => (\n  <Typography\n    color='textSecondary'\n    className={props.selectProps.classes.placeholder}\n    {...props.innerProps}\n  >\n    {props.children}\n  </Typography>\n)\n\nconst Option = ({ innerRef, isFocused, isSelected, innerProps, children }) => (\n  <MenuItem\n    buttonRef={innerRef}\n    selected={isFocused}\n    component='div'\n    style={{ fontWeight: isSelected ? 500 : 400 }}\n    {...innerProps}\n  >\n    {children}\n  </MenuItem>\n)\n\nconst ValueContainer = ({ selectProps, children }) => (\n  <div className={selectProps.classes.valueContainer}>{children}</div>\n)\nValueContainer.propTypes = {\n  selectProps: PropTypes.any,\n  children: PropTypes.any\n}\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\n// import Typography from '@material-ui/core/Typography'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogActions from '@material-ui/core/DialogActions'\nimport Button from '@material-ui/core/Button'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport IconButton from '@material-ui/core/IconButton'\n\nimport CloseIcon from '@material-ui/icons/Close'\nimport TagControl from '../controls/TagControl'\n\nimport { withStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n  },\n  dlgContent: {\n    // position: 'relative',\n    // maxWidth: '200px',\n    overflowY: 'visible!important',\n    paddingBottom: 300\n    // overflowX: 'hidden'\n  },\n  title: {\n    // margin: 0,\n    // padding: theme.spacing.unit * 2\n  },\n  closeButton: {\n    position: 'absolute',\n    right: theme.spacing.unit,\n    top: theme.spacing.unit,\n    color: theme.palette.grey[500]\n  }\n})\n\nconst TagEdit = ({ classes, open, title, onOk, onCancel, tags, tagConfig }) => {\n  const [value, setValue] = useState(tags)\n  return (\n    <Dialog\n      className={classes.root}\n      scroll='body'\n      fullScreen\n      open={open}\n      onClose={() => onOk(value)}\n    >\n      <DialogTitle className={classes.title}>\n        {title}\n        <IconButton className={classes.closeButton} onClick={onCancel}>\n          <CloseIcon />\n        </IconButton>\n      </DialogTitle>\n      <DialogContent className={classes.dlgContent}>\n        <TagControl\n          className={classes.field}\n          tags={value}\n          tagConfig={tagConfig}\n          onChange={setValue}\n        />\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={onCancel}>Cancel</Button>\n        <div style={{ flexGrow: 1 }} />\n        <Button onClick={() => setValue(tags)}>Reset</Button>\n        <Button onClick={() => onOk(value)}>Ok</Button>\n      </DialogActions>\n    </Dialog>\n  )\n}\n\nTagEdit.propTypes = {\n  classes: PropTypes.object.isRequired,\n  open: PropTypes.bool,\n  title: PropTypes.string,\n  onOk: PropTypes.func,\n  onCancel: PropTypes.func,\n  tags: PropTypes.array.isRequired,\n  tagConfig: PropTypes.object.isRequired\n}\n\nexport default withStyles(style)(TagEdit)\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport Typography from '@material-ui/core/Typography'\nimport { withStyles } from '@material-ui/core/styles'\nimport { formatDate } from '../../../../lib/datelib'\n\nconst style = theme => ({\n  root: { },\n  rootEdit: { },\n  formControl: {\n    width: '100%'\n  },\n  textBody: {\n    whiteSpace: 'pre-line'\n  },\n  actionButtons: {\n    textAlign: 'right'\n  }\n})\n\nconst DateView = ({\n  classes,\n  label,\n  value,\n  className\n}) => {\n  return (\n    <div className={classNames(classes.root, className)}>\n      <Typography variant='overline' className={classes.fieldTitle}>\n        {label}\n      </Typography>\n      <Typography variant='body1' className={classes.hint}>{value ? formatDate(value) : ''}</Typography>\n    </div>\n  )\n}\n\nDateView.propTypes = {\n  classes: PropTypes.object.isRequired,\n  className: PropTypes.string,\n  label: PropTypes.string.isRequired,\n  value: PropTypes.string\n}\n\nexport default withStyles(style)(DateView)\n","import React, { useContext, useState } from 'react'\nimport PropTypes from 'prop-types'\n\nimport Typography from '@material-ui/core/Typography'\nimport Divider from '@material-ui/core/Divider'\nimport List from '@material-ui/core/List'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemText from '@material-ui/core/ListItemText'\n\nimport { withStyles } from '@material-ui/core/styles'\n\nimport TagView from '../controls/TagView'\nimport ShortLongText from '../controls/ShortLongText'\nimport DateControl from '../controls/DateControl'\nimport TagClass from '../../../../lib/Tags'\nimport BigTextEdit from '../dialogs/BigTextEdit'\nimport BigText from '../dialogs/BigText'\nimport TagEdit from '../dialogs/TagEdit'\n\nimport { SeriesContext } from '../../contexts'\nimport DateView from '../controls/DateView'\n\nconst style = theme => ({\n  root: {\n    height: '90%',\n    width: '85%'\n  },\n  dlgTitleContainer: {\n    display: 'flex',\n    padding: 0\n  },\n  catTagTitle: {\n    marginTop: theme.spacing.unit * 2\n  },\n  dlgTitle: {\n    flexGrow: 1,\n    paddingTop: theme.spacing.unit * 2,\n    paddingBottom: theme.spacing.unit,\n    paddingLeft: theme.spacing.unit * 3\n  },\n  field: {\n    marginBottom: theme.spacing.unit * 2\n  }\n})\n\nconst DIALOGS = {\n  NOTEEDIT: 'noteEdit',\n  NOTEVIEW: 'noteView',\n  PHOTOTAKEN: 'taken',\n  TAGEDIT: 'tag',\n  CANCEL: 'cancel'\n}\n\nconst PhotoInfo = ({ classes, allowEdit, photo, delta, onChange }) => {\n  const { seriesConfig } = useContext(SeriesContext)\n  const [{ activeDialog, activeDialogContext }, setActiveDialog] = useState({})\n\n  const tagInst = new TagClass(seriesConfig, delta.tags || photo.tags)\n\n  let metaKeys = []\n  try {\n    metaKeys = photo.meta ? Object.keys(JSON.parse(photo.meta)) : []\n  }\n  catch (e) {\n    console.error(e)\n  }\n  return (\n    <div>\n      {allowEdit ? (\n        <DateControl\n          className={classes.field}\n          label='Photo taken on'\n          value={delta.takenOn || photo.takenOn}\n          onChange={takenOn => onChange({ takenOn })}\n          allowEdit={allowEdit}\n        />\n      )\n        : (\n          <DateView\n            label='Photo taken on'\n            value={delta.takenOn || photo.takenOn}\n          />\n        )}\n\n      {(allowEdit || photo.note) && (\n        <ShortLongText\n          label='Photo Note'\n          text={delta.note || photo.note}\n          onClick={() => {\n            if (allowEdit) setActiveDialog({ activeDialog: DIALOGS.NOTEEDIT })\n            else setActiveDialog({ activeDialog: DIALOGS.NOTEVIEW })\n          }}\n        />\n      )}\n      <Typography variant='subtitle1' className={classes.catTagTitle}>Category tags</Typography>\n      <Divider />\n      {tagInst.seriesConfig.getNonXYTagTypes().map((tt, idx) => (\n        <div\n          key={`tagtype-${idx}`}\n          onClick={() => allowEdit ? setActiveDialog({ activeDialog: DIALOGS.TAGEDIT, activeDialogContext: tt }) : null}\n        >\n          <TagView\n            className={classes.field}\n            label={tt.label}\n            tags={delta.tags || photo.tags}\n            tagConfig={tt}\n          />\n        </div>\n      ))}\n\n      {metaKeys.length > 0 && Object.keys(seriesConfig.meta).length > 0 && (\n        <React.Fragment>\n          <Typography className={classes.heading}>Metadata</Typography>\n          <Divider />\n          <List className={classes.list}>\n            {metaKeys.map((key, idx) => seriesConfig.meta[key] ? (\n              <ListItem key={`metadata${idx}`}>\n                <ListItemText\n                  primary={seriesConfig.meta[key].label}\n                  secondary={seriesConfig.meta[key].render(photo.meta[key])}\n                />\n              </ListItem>\n            ) : null\n            )}\n          </List>\n        </React.Fragment>\n      )}\n      {activeDialog && activeDialog === DIALOGS.NOTEEDIT && (\n        <BigTextEdit\n          open\n          multiline\n          onOk={note => {\n            onChange({ note })\n            setActiveDialog({})\n          }}\n          title='Edit Photo Note'\n          body={delta.note || photo.note}\n        />\n      )}\n      {activeDialog && activeDialog === DIALOGS.NOTEVIEW && (\n        <BigText\n          open\n          multiline\n          onClose={() => setActiveDialog({})}\n          title='Photo Note'\n          body={delta.note || photo.note}\n        />\n      )}\n      {activeDialog && activeDialog === DIALOGS.TAGEDIT && (\n        <TagEdit\n          open\n          title={`Edit Tags: ${activeDialogContext.label}`}\n          onOk={tags => {\n            setActiveDialog({})\n            onChange({ tags })\n          }}\n          onCancel={() => setActiveDialog({})}\n          tags={delta.tags || photo.tags}\n          tagConfig={activeDialogContext}\n        />\n      )}\n    </div>\n  )\n}\n\nPhotoInfo.propTypes = {\n  classes: PropTypes.object.isRequired,\n  allowEdit: PropTypes.bool,\n  onChange: PropTypes.func.isRequired,\n  photo: PropTypes.object.isRequired,\n  delta: PropTypes.object.isRequired\n}\n\nexport default withStyles(style)(PhotoInfo)\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport { withStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n    width: 1,\n    height: 1,\n    zIndex: 1\n  },\n  svgDot: {\n    width: 20,\n    height: 20,\n    position: 'absolute',\n    top: '50%',\n    left: '50%',\n    textAlign: 'center',\n    transformOrigin: '50% 50%',\n    transform: 'translateY(-50%) translateX(-50%)'\n  },\n  svgAccuracyDot: {\n    position: 'absolute',\n    top: '50%',\n    left: '50%',\n    textAlign: 'center',\n    transformOrigin: '50% 50%',\n    transform: 'translateY(-50%) translateX(-50%)'\n  }\n})\n\nconst MyLocation = ({ classes, position, projection }) => {\n  const accuracy = 20 // assume 20m to start\n  // metersPerPixel [12, 12, 12]\n  // pixelsPerMeter [0: 0.08029229250399847, 1: -0.08029229250399847, 2: 0.08029229250399847]\n  // console.log('POSITION', { position, projection })\n  const accHeight = projection.pixelsPerMeter[0] * (accuracy)\n  const accWidth = projection.pixelsPerMeter[1] * (accuracy)\n  return (\n    <div className={classes.root}>\n      {/* This is the accuracy radius */}\n      <svg\n        style={{ height: accHeight, width: accWidth }}\n        className={classes.svgAccuracyDot}\n        version='1.1'\n        viewBox='0, 0, 100, 100'\n      >\n        <circle cx='50' cy='50' r={49}\n          stroke='#8888FF'\n          fillOpacity='0.4'\n          strokeWidth='1'\n          fill='#AAAAFF'\n        />\n      </svg>\n      {/* This is the dot */}\n      <svg className={classes.svgDot} version='1.1' viewBox='0, 0, 10, 10'>\n        <circle cx='5' cy='5' r='4'\n          stroke='#FFFFFF'\n          strokeWidth='1'\n          fill='#4444FF'\n        />\n      </svg>\n    </div>\n  )\n}\n\nMyLocation.propTypes = {\n  classes: PropTypes.object.isRequired,\n  position: PropTypes.object,\n  projection: PropTypes.object\n}\n\nexport default withStyles(style)(MyLocation)\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Fab from '@material-ui/core/Fab'\nimport MyLocationIcon from '@material-ui/icons/MyLocation'\n\nimport { withStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n    border: '1px solid',\n    background: theme.palette.grey[100],\n    color: 'black',\n    width: 40,\n    height: 40,\n    zIndex: 10,\n    position: 'absolute'\n    // margin: theme.spacing.unit / 2,\n    // padding: theme.spacing.unit / 2,\n    // border: '2px solid',\n    // borderRadius: theme.spacing.unit,\n    // background: theme.palette.common.white,\n    // fontSize: 20,\n    // position: 'absolute',\n    // zIndex: 100,\n    // bottom: theme.spacing.unit * 10,\n    // right: theme.spacing.unit * 2\n  }\n})\n\nconst MyLocationButton = ({ classes, theme, onClick, controlPadding, disabled }) => {\n  return (\n    <Fab\n      disabled={disabled}\n      style={{\n        top: 56 + (controlPadding.top ? controlPadding.top : theme.spacing.unit * 2),\n        right: controlPadding.right ? controlPadding.right : theme.spacing.unit * 2\n      }}\n      aria-label='myLocation'\n      className={classes.root}\n      onClick={onClick}\n    >\n      <MyLocationIcon />\n    </Fab>\n  )\n}\n\nMyLocationButton.propTypes = {\n  classes: PropTypes.object.isRequired,\n  theme: PropTypes.object.isRequired,\n  controlPadding: PropTypes.object,\n  onClick: PropTypes.func.isRequired,\n  disabled: PropTypes.bool\n}\n\nexport default withStyles(style, { withTheme: true })(MyLocationButton)\n","import React, { useState, useRef, useMemo, useEffect } from 'react'\nimport ReactMapGL, { NavigationControl, Marker, FlyToInterpolator } from 'react-map-gl'\nimport PropTypes from 'prop-types'\nimport { easeCubic } from 'd3-ease'\nimport WebMercatorViewport, { getDistanceScales } from 'viewport-mercator-project'\nimport useComponentSize from '../../lib/useComponentSize'\nimport MyLocation from './markers/MyLocation'\nimport { useGeolocation } from '../../lib/sensors'\nimport StyleButtons from './controls/StyleButtons'\nimport MyLocationButton from './controls/MyLocationButton'\nimport { mapConfig } from '../../config'\nimport classNames from 'classnames'\nimport 'mapbox-gl/dist/mapbox-gl.css'\nimport './BaseMap.css'\n\n/**\n * Note that this component technically has state but it is designed to be functionally stateless\n */\nconst BaseMap = (props) => {\n  // pull what we need out of the props\n  const {\n    showMe,\n    children,\n    mapStyles,\n    controlPadding,\n    viewport: initViewport,\n    bounds,\n    lockToBounds,\n    lockPan,\n    initStyle,\n    onViewportChange: incomingOnViewportChange,\n    onTransitionStart: incomingOnTransitionStart,\n    onTransitionEnd: incomingOnTransitionEnd,\n    transitions,\n    onMapDataEvent,\n    stylechooser,\n    ...passthroughProps\n  } = props\n\n  const mapContainerRef = useRef(null)\n  const mapBoxRef = useRef(null)\n  const { size } = useComponentSize(mapContainerRef, { width: 100, height: 50 })\n\n  const [currStyle, setCurrStyle] = useState(initStyle)\n  const [isTransitioning, setIsTransitioning] = useState(false)\n\n  // This is the truth of the viewport!!\n  const [viewport, setViewport] = useState({ ...defaultViewVals, ...initViewport })\n  const [innerTransitions, setInnerTransitions] = useState(null)\n  const [projection, setProjection] = useState(null)\n\n  let myPosition = {}\n  if (showMe) {\n    myPosition = useGeolocation()\n  }\n  const geoMarker = (myPosition.latitude && myPosition.longitude)\n    ? (\n      <Marker key='myPos' className='myPosMarker' latitude={myPosition.latitude} longitude={myPosition.longitude} style={{ zIndex: 1 }}>\n        <MyLocation position={myPosition} projection={projection} />\n      </Marker>\n    ) : null\n\n  // Recalculate the projection if we need to but only when zoom changes\n  useMemo(() => {\n    if (!size || size.width < 10 || size.height < 10) return\n    if (mapStyles.length <= currStyle) setCurrStyle(initStyle)\n    try {\n      const projection = getDistanceScales(viewport)\n      // console.log('recalcProjection', { projection, size })\n      setProjection(projection)\n    }\n    catch (e) {\n      console.log('ERROR', viewport)\n      console.error(e)\n    }\n  }, [viewport.zoom, size])\n\n  const flyToMe = () => {\n    if (!myPosition.latitude || !myPosition.longitude) return\n\n    setInnerTransitions({\n      transitionDuration: 2000,\n      transitionInterpolator: new FlyToInterpolator(),\n      transitionEasing: easeCubic\n    })\n    setViewport({\n      ...viewport,\n      latitude: myPosition.latitude,\n      longitude: myPosition.longitude\n    })\n  }\n\n  /**\n   * Callback fired when the user changes the viewport object\n   * @param {*} viewport\n   */\n  const onViewportChange = (viewportChange) => {\n    const newViewport = { ...viewportChange }\n    // Here we set/reset the bounds\n    if (bounds && lockToBounds) {\n      if (newViewport.longitude < bounds[0]) newViewport.longitude = bounds[0]\n      else if (newViewport.longitude > bounds[2]) newViewport.longitude = bounds[2]\n\n      if (newViewport.latitude < bounds[1]) newViewport.latitude = bounds[1]\n      else if (newViewport.latitude > bounds[3]) newViewport.latitude = bounds[3]\n    }\n    if (lockPan) {\n      newViewport.latitude = viewport.latitude\n      newViewport.longitude = viewport.longitude\n    }\n\n    // console.log('onViewportChange', newViewport)\n    // Fire the external callback so parent components can track viewport if they need to\n    if (!isTransitioning && typeof incomingOnViewportChange === 'function') {\n      incomingOnViewportChange({\n        viewport: newViewport,\n        size,\n        projection,\n        map: mapBoxRef.current && mapBoxRef.current.getMap()\n      })\n    }\n    setViewport(newViewport)\n  }\n\n  const recalcZoomBounds = () => {\n    // console.log('Should I recalc viewbounds?')\n    if (!bounds || !size || size.width < 10 || size.height < 10 || isTransitioning) return\n    // On the first run we're going to try to center the bounds.\n    const [minlng, minlat, maxlng, maxlat] = bounds\n    // console.log('yes, yesI should')\n    try {\n      const { longitude, latitude, zoom } = new WebMercatorViewport(viewport).fitBounds(\n        [ [minlng, minlat], [maxlng, maxlat] ],\n        { padding: 40, offset: [0, 0] }\n      )\n      console.log('Changing Zoom ', bounds, viewport.zoom, zoom, viewport)\n\n      // console.log('recalcZoomBounds')\n      setViewport({ ...viewport, longitude, latitude, zoom })\n    }\n    catch (e) {\n      // Sometimes we don't have a valid bound. Don't make a big deal out of it.\n      console.error(e)\n    }\n  }\n\n  const handleTransitionStart = () => {\n    setIsTransitioning(true)\n    // console.log('handleTransitionStart (internal)')\n    if (incomingOnTransitionStart) incomingOnTransitionStart()\n  }\n  const handleTransitionEnd = () => {\n    setIsTransitioning(false)\n    setInnerTransitions(null)\n    // console.log('handleTransitionEnd (internal)')\n    if (incomingOnTransitionEnd) incomingOnTransitionEnd()\n    if (typeof incomingOnViewportChange === 'function') {\n      incomingOnViewportChange({\n        viewport,\n        size,\n        projection,\n        map: mapBoxRef.current && mapBoxRef.current.getMap()\n      })\n    }\n  }\n\n  // RecalcZoombounds should only be done sparingly\n  useMemo(recalcZoomBounds, [size, bounds])\n\n  useEffect(() => {\n    // console.log('SOMETHING CHANGED')\n    setViewport({ ...viewport, ...initViewport })\n  }\n  , [initViewport])\n\n  return (\n    <div className={classNames('BaseMap', props.className)} ref={mapContainerRef} style={{ height: '100%', width: '100%' }}>\n      <ReactMapGL\n        {...viewport}\n        {...(innerTransitions || transitions)}\n        ref={map => {\n          mapBoxRef.current = map\n        }}\n        height={size.height}\n        width={size.width}\n        mapStyle={currStyle < mapStyles.length ? mapStyles[currStyle].style : mapStyles[0].style}\n        onData={onMapDataEvent}\n        onTransitionStart={handleTransitionStart}\n        onTransitionEnd={handleTransitionEnd}\n        dragPan={!lockPan}\n        onViewportChange={onViewportChange}\n        mapboxApiAccessToken={mapConfig.mapBoxToken}\n        {...passthroughProps}\n      >\n        {\n          children && Array.isArray(children)\n            ? children.map((c, idx) => c ? React.cloneElement(\n              handleChild(c, viewport, size.height, size.width, projection),\n              { key: `mapChild-${idx}` }\n            ) : null)\n            : handleChild(children, viewport, size.height, size.width, projection)\n        }\n        {/* Make sure the controls are above everything else */}\n        { stylechooser && (\n          <StyleButtons\n            controlPadding={controlPadding}\n            currStyle={currStyle}\n            mapStyles={mapStyles}\n            setCurrStyle={setCurrStyle}\n          />\n        )}\n        {/* Augment children with some props they need to survive in this harsh world */}\n        { !props.hideNavControls && (\n          <NavigationControl\n            onViewportChange={viewport => onViewportChange({ ...viewport, ...size })}\n            showZoom={!props.touchZoom === false && !props.scrollZoom === false}\n            showCompass={!props.touchRotate === false && !props.dragRotate === false}\n          />\n        )}\n        {showMe && (\n          <React.Fragment>\n            {geoMarker}\n            <MyLocationButton disabled={!myPosition || !myPosition.latitude} controlPadding={controlPadding} onClick={flyToMe} />\n          </React.Fragment>\n        )}\n      </ReactMapGL>\n    </div>\n  )\n}\n\nBaseMap.propTypes = {\n  // Anything else we want to add to the map\n  children: PropTypes.any,\n  deckelements: PropTypes.array,\n  data: PropTypes.array,\n  // Maybe we want map controls to be padded\n  controlPadding: PropTypes.object,\n\n  showMe: PropTypes.bool,\n\n  // Separate transitions from viewport so we can set them independently\n  transitions: PropTypes.object,\n  initStyle: PropTypes.number,\n\n  // Some switches to make things easier\n  stylechooser: PropTypes.bool,\n  lockPan: PropTypes.bool,\n  lockRotation: PropTypes.bool,\n  lockZoom: PropTypes.bool,\n  lockToBounds: PropTypes.bool,\n  hideNavControls: PropTypes.bool,\n\n  // bounds of the map. may be locked or not [minlng, minlat], [maxlng, maxlat]\n  bounds: PropTypes.array,\n\n  // List of valid styles that will get picker buttons\n  mapStyles: PropTypes.array,\n\n  onMapDataEvent: PropTypes.func,\n  onViewportChange: PropTypes.func\n\n  // We get these props from calculating the window size at a higher level\n  // size: PropTypes.shape({\n  //   width: PropTypes.number.isRequired,\n  //   height: PropTypes.number.isRequired\n  // })\n}\n\nBaseMap.defaultProps = {\n  controlPadding: {},\n  stylechooser: true,\n  // viewport: {\n  //   zoom: 12,\n  //   latitude: 49.3050394,\n  //   longitude: -123.1398254\n  // },\n  initStyle: 0,\n  mapStyles: mapConfig.styles,\n  lockToBounds: false\n}\n\nexport default BaseMap\n\nconst defaultViewVals = {\n  latitude: 49.3050394,\n  longitude: -123.1398254,\n  bearing: 0,\n  pitch: 0,\n  zoom: 12\n}\n\nfunction handleChild (child, viewport, height, width, projection) {\n  return typeof child === 'function'\n    ? child(viewport, height, width, projection)\n    : child\n}\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogActions from '@material-ui/core/DialogActions'\nimport Button from '@material-ui/core/Button'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport FormLabel from '@material-ui/core/FormLabel'\nimport Slider from '@material-ui/lab/Slider'\n\nimport MapDot from '../../../maps/MapDot'\nimport { withStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n\n  },\n  dlgContent: {\n    display: 'flex',\n    flexDirection: 'column',\n    padding: 0\n  },\n  mapWrapper: {\n    flexGrow: 1\n  },\n  sliderWrapper: {\n    padding: '20px'\n  },\n  slider: {\n    padding: '22px 0px'\n  },\n  sliderRoor: {\n    padding: '0 20px'\n  },\n  body: {\n    overflow: 'hidden',\n    whiteSpace: 'pre-line',\n    paddingBottom: theme.spacing.unit\n  },\n  title: {\n    background: theme.palette.primary.main,\n    color: theme.palette.primary.contrastText,\n    margin: 0,\n    padding: theme.spacing.unit * 2\n  },\n  closeButton: {\n    position: 'absolute',\n    right: theme.spacing.unit,\n    top: theme.spacing.unit,\n    color: theme.palette.grey[500]\n  }\n})\n\nconst MapDirPicker = ({ classes, open, onOk, onCancel, title, latitude: initLat, longitude: initLong, direction: initDir }) => {\n  const [{ longitude, latitude }, setCoords] = useState({ longitude: initLong, latitude: initLat })\n  const [direction, setRotation] = useState(initDir)\n\n  const viewport = { zoom: 18 }\n  if ((latitude || initLat) && (longitude || initLong)) {\n    viewport.latitude = latitude || initLat\n    viewport.longitude = longitude || initLong\n  }\n\n  return (\n    <Dialog\n      scroll='paper'\n      open={open}\n      fullWidth\n      fullScreen\n      onClose={onCancel}\n    >\n      <DialogTitle className={classes.title} disableTypography>\n        <Typography color='inherit'>{title}</Typography>\n      </DialogTitle>\n      <DialogContent className={classes.dlgContent}>\n        <div className={classes.mapWrapper}>\n          <MapDot\n            editable\n            className={classes.map}\n            direction={direction > 0 ? direction : null}\n            viewport={viewport}\n            onChange={({ viewport: { longitude, latitude } }) => setCoords({ longitude, latitude })}\n          />\n        </div>\n        <div className={classes.sliderWrapper}>\n          <FormLabel className={classes.mapFormLabel}>Direction {direction > -1 ? '' : '(off)'}</FormLabel>\n          <Slider\n            classes={{ root: classes.sliderRoor, container: classes.slider }}\n            value={direction || -1}\n            min={-1}\n            max={360}\n            step={1}\n            onChange={(e, value) => setRotation(value)}\n          />\n        </div>\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={onCancel}>Cancel</Button>\n        <div style={{ flexGrow: 1 }} />\n        <Button onClick={() => onOk({ longitude, latitude, direction })}>Ok</Button>\n      </DialogActions>\n    </Dialog>\n  )\n}\n\nMapDirPicker.propTypes = {\n  classes: PropTypes.object.isRequired,\n  open: PropTypes.bool,\n  latitude: PropTypes.number,\n  longitude: PropTypes.number,\n  direction: PropTypes.number,\n  onOk: PropTypes.func,\n  onCancel: PropTypes.func,\n  title: PropTypes.string\n}\n\nexport default withStyles(style)(MapDirPicker)\n","\nimport React, { useState } from 'react'\nimport PropTypes from 'prop-types'\n\nimport TextField from '@material-ui/core/TextField'\nimport FormLabel from '@material-ui/core/FormLabel'\n\nimport { withStyles } from '@material-ui/core/styles'\nimport MapDot from '../../../maps/MapDot'\n\nimport MapDirPicker from '../dialogs/MapDirPicker'\nimport BigTextEdit from '../dialogs/BigTextEdit'\n\nimport style from './SeriesEditInner.style'\nimport ShortLongText from '../controls/ShortLongText'\n\nconst DIALOGS = {\n  MAPPICK: 'mapPicker',\n  NOTEEDIT: 'noteEdit'\n}\n\n/**\n * SeriesEdit appears in two places so we need this to be a bit reusable\n */\nconst SeriesEdit = ({ classes, series, delta, onChange }) => {\n  const [activeDialog, setActiveDialog] = useState(null)\n\n  const viewport = { zoom: 18 }\n  if ((delta.latitude || series.latitude) && (delta.longitude || series.longitude)) {\n    viewport.latitude = delta.latitude || series.latitude\n    viewport.longitude = delta.longitude || series.longitude\n  }\n\n  return (\n    <div>\n      <TextField\n        label='Series Name'\n        fullWidth\n        placeholder='New Series'\n        className={classes.field}\n        value={delta.name || series.name || ''}\n        onChange={e => onChange({ ...delta, name: e.target.value })}\n      />\n      <div className={classes.mapWrapper} onClick={() => setActiveDialog(DIALOGS.MAPPICK)}>\n        <FormLabel className={classes.mapFormLabel}>Location</FormLabel>\n        <div className={classes.mapInnerWrap}>\n          <MapDot\n            staticMap\n            className={classes.map}\n            direction={delta.direction || series.direction}\n            viewport={viewport}\n          />\n        </div>\n      </div>\n      <ShortLongText\n        onClick={() => setActiveDialog(DIALOGS.NOTEEDIT)}\n        className={classes.field}\n        label='Series Note'\n        text={delta.note || series.note}\n      />\n      {activeDialog === DIALOGS.MAPPICK && (\n        <MapDirPicker\n          open\n          title='Series Location & Direction'\n          latitude={delta.latitude || series.latitude}\n          longitude={delta.longitude || series.longitude}\n          direction={delta.direction || series.direction}\n          onOk={(data) => {\n            onChange({ ...delta, ...data })\n            setActiveDialog(null)\n          }}\n          onCancel={() => setActiveDialog(null)}\n        />\n      )}\n      {activeDialog === DIALOGS.NOTEEDIT && (\n        <BigTextEdit\n          open\n          title='Series Note'\n          body={delta.note || series.note}\n          multiline\n          onOk={(newNote) => {\n            onChange({ ...delta, note: newNote })\n            setActiveDialog(null)\n          }}\n          onCancel={() => setActiveDialog(null)}\n        />\n      )}\n    </div>\n  )\n}\n\nSeriesEdit.propTypes = {\n  classes: PropTypes.object.isRequired,\n  // now some functions\n  series: PropTypes.object.isRequired,\n  delta: PropTypes.object.isRequired,\n  onChange: PropTypes.func.isRequired\n}\n\nexport default withStyles(style)(SeriesEdit)\n","export default theme => ({\n  root: {\n\n  },\n  inner: {\n    display: 'flex',\n    flexDirection: 'column'\n    // padding: theme.spacing.unit\n  },\n  dlgTitle: {\n    background: theme.palette.primary.main,\n    color: theme.palette.primary.contrastText\n  },\n  grow: {\n    flexGrow: 1\n  },\n  field: {\n    flexGrow: 0,\n    marginBottom: theme.spacing.unit * 2\n  },\n  slider: {\n    paddingLeft: theme.spacing.unit,\n    paddingRight: theme.spacing.unit\n  },\n  textField: {\n    marginLeft: theme.spacing.unit,\n    marginRight: theme.spacing.unit,\n    width: '100%'\n  },\n  formLabel: {\n    display: 'block',\n    marginTop: theme.spacing.unit,\n    marginBottom: theme.spacing.unit\n  },\n  mapFormLabel: {\n    display: 'block',\n    marginTop: theme.spacing.unit,\n    marginBottom: theme.spacing.unit\n  },\n  mapInnerWrap: {\n    flexGrow: 1,\n    height: '200px',\n    minHeight: '200px'\n  },\n  mapWrapper: {\n    flexGrow: 1,\n    display: 'flex',\n    flexDirection: 'column',\n    paddingBottom: theme.spacing.unit * 2\n  },\n  formControl: {\n    margin: theme.spacing.unit,\n    minWidth: 120\n  },\n  chips: {\n    display: 'flex',\n    flexWrap: 'wrap'\n  }\n})\n","import React, { useState, useEffect, useContext, useRef } from 'react'\nimport classNames from 'classnames'\nimport PropTypes from 'prop-types'\n\nimport GridList from '@material-ui/core/GridList'\nimport GridListTile from '@material-ui/core/GridListTile'\nimport GridListTileBar from '@material-ui/core/GridListTileBar'\nimport Snackbar from '@material-ui/core/Snackbar'\nimport Button from '@material-ui/core/Button'\nimport Fab from '@material-ui/core/Fab'\n\nimport AddIcon from '@material-ui/icons/Add'\nimport RemoveIcon from '@material-ui/icons/Remove'\n\nimport { SeriesContext } from '../../contexts'\n\nimport { withStyles } from '@material-ui/core/styles'\nimport style from './PhotoGrid.style'\nimport DeleteDialog from '../dialogs/DeleteDialog'\nimport { formatDate } from '../../../../lib/datelib'\n\nconst PhotoGrid = ({ classes, photos, columns, multiSelect, onDelete, onTileClick, allowEdit }) => {\n  const [selectMode, setSelectMode] = useState(false)\n  const [urls, setUrls] = useState({})\n  const urlsRef = useRef()\n  urlsRef.current = urls\n  const [selectedItems, setSelectedItems] = useState([])\n  const [deleteConfirm, setDeleteConfirm] = useState(false)\n\n  const { seriesConfig } = useContext(SeriesContext)\n  useEffect(() => {\n    photos.forEach(photo => {\n      if (!photo.base64) {\n        seriesConfig.getPhotoUrl(photo, 'thumb').then(url => {\n          setUrls({ ...urlsRef.current, [photo.id]: url })\n        })\n      }\n      else {\n        setUrls({ ...urlsRef.current, [photo.id]: photo.base64 })\n      }\n    })\n  }, [photos])\n\n  const handleAddToSelection = (e, id) => {\n    e.preventDefault()\n    e.stopPropagation()\n\n    setSelectMode(true)\n    toggleListItem(id)\n  }\n\n  const handleCancelSelection = () => {\n    setSelectMode(false)\n    setSelectedItems([])\n  }\n\n  const onDeleteConfirm = (confirmation) => {\n    setDeleteConfirm(false)\n    if (confirmation === true && selectedItems.length < photos.length) onDelete(selectedItems)\n    handleCancelSelection()\n  }\n\n  const toggleListItem = (id) => {\n    const index = selectedItems.indexOf(id)\n    if (index < 0) setSelectedItems([...selectedItems, id])\n    else {\n      const remaining = selectedItems.filter(arrId => arrId !== id)\n      if (remaining.length === 0) handleCancelSelection()\n      setSelectedItems(remaining)\n    }\n  }\n\n  const handlePhotoTap = (e, photo) => {\n    e.preventDefault()\n    e.stopPropagation()\n    // Select / deselect the item in edit mode\n    if (selectMode) toggleListItem(photo.id)\n    // navigate if tileClick selected\n    else onTileClick(photo.id)\n  }\n\n  const sortedPhotos = [...photos]\n  sortedPhotos.sort((a, b) => parseInt(b.takenOn, 10) - parseInt(a.takenOn, 10))\n\n  return (\n    <div>\n      <GridList cols={columns} cellHeight={200} className={classes.root}>\n        {sortedPhotos.map((photo, idx) => {\n          const selected = selectedItems.indexOf(photo.id) > -1\n          return (\n            <GridListTile\n              key={`gridTile${idx}`}\n              onClick={(e) => handlePhotoTap(e, photo)}\n              className={classNames(\n                classes.tile,\n                selectMode && !selected && classes.unSelectedTile,\n                selectMode && selected && classes.selectedTile\n              )}\n            >\n              <img src={urls[photo.id]} alt={urls[photo.id]} className={classes.img} />\n              {allowEdit && multiSelect && (\n                <Fab size='small' aria-label='Add' className={classes.addFab} onClick={(e) => handleAddToSelection(e, photo.id)}>\n                  {!selectMode || !selected ? <AddIcon /> : <RemoveIcon />}\n                </Fab>\n              )}\n              <GridListTileBar\n                title={<span>{formatDate(photo.takenOn)}</span>}\n              />\n            </GridListTile>\n          )\n        })}\n      </GridList>\n      <Snackbar\n        open={selectMode}\n        autoHideDuration={null}\n        ContentProps={{\n          'aria-describedby': 'snackbar-fab-message-id',\n          className: classes.snackbarContent\n        }}\n        message={<span id='snackbar-fab-message-id'>{selectedItems.length} Photos selected</span>}\n        action={<div>\n          <Button color='inherit' disabled={selectedItems.length >= photos.length} size='small' onClick={() => setDeleteConfirm(true)}>\n                Delete\n          </Button>\n          <Button color='inherit' size='small' onClick={() => handleCancelSelection()}>\n                Cancel\n          </Button>\n        </div>\n        }\n        className={classes.snackbar}\n      />\n\n      <DeleteDialog\n        open={deleteConfirm}\n        onConfirm={onDeleteConfirm}\n        title={`Delete ${selectedItems.length} Photos`}\n        message='Are you sure you want to delete these photos?'\n      />\n    </div>\n\n  )\n}\n\nPhotoGrid.propTypes = {\n  classes: PropTypes.object.isRequired,\n  photos: PropTypes.array.isRequired,\n  columns: PropTypes.number,\n  allowEdit: PropTypes.bool,\n  multiSelect: PropTypes.bool,\n  onDelete: PropTypes.func,\n  onTileClick: PropTypes.func.isRequired\n}\nPhotoGrid.defaultProps = {\n  multiSelect: true,\n  columns: 2\n}\n\nexport default withStyles(style)(PhotoGrid)\n","\nexport default theme => ({\n  root: {\n\n  },\n  tile: {\n\n  },\n  addFab: {\n    position: 'absolute',\n    zIndex: 10,\n    top: theme.spacing.unit,\n    left: theme.spacing.unit,\n    opacity: 0.3\n  },\n  unSelectedTile: {\n    '& img': {\n      opacity: 0.3\n    }\n  },\n  selectedTile: {\n    padding: `${theme.spacing.unit * 2}px!important`,\n    '& img': {\n      opacity: 1\n    }\n  },\n  img: {\n\n  }\n})\n","import React, { useState, useContext } from 'react'\nimport PropTypes from 'prop-types'\nimport exifParser from 'exif-parser'\nimport { isNumeric } from '../../../lib/util'\n\nimport PhotoReviewTool from './PhotoReviewTool'\nimport CameraTool from './CameraTool'\nimport NewPhotoInfo from './NewPhotoInfo'\n\nimport PhotoClass from '../../../lib/Photo'\nimport SeriesClass from '../../../lib/Series'\nimport { useDeviceOrientation, useGeolocation } from '../../../lib/sensors'\nimport useFileInput from '../../../lib/useFileInput'\n\nimport { SeriesContext } from '../contexts'\n\nconst MODES = {\n  CAMERA: 'camera',\n  FILEPICKER: 'library',\n  PHOTOREVIEW: 'photoreview',\n  PHOTOINFOEDIT: 'photoinfoedit'\n}\n\nconst NewPhoto = ({ inputMethod, onCreate, onCancel, isNewSeries }) => {\n  const { seriesConfig, series } = useContext(SeriesContext)\n  const [newPhoto, setNewPhoto] = useState(null)\n  const [newSeries, setNewSeries] = useState(isNewSeries ? new SeriesClass(seriesConfig).series : null)\n\n  const [photoRefId, setPhotoRefId] = useState(null)\n  const [mode, _changeMode] = useState({ current: inputMethod, history: [] })\n  const orientation = useDeviceOrientation()\n  const geo = useGeolocation()\n\n  const photos = series && series.photos ? series.photos : []\n\n  const onLibraryAdd = (data) => {\n    console.log('onLibraryAdd Debug GOT DATA', { data })\n    const find = 'base64,'\n    let exif = {}\n    const foundIdx = data.indexOf(find) + find.length\n    const newData = data.slice(foundIdx)\n    const parser = exifParser.create(Buffer.from(newData, 'base64'))\n    console.log('onLibraryAdd Buffered')\n    try {\n      exif = parser.parse()\n      console.log('got EXIF', JSON.stringify(exif))\n    }\n    catch (err) {\n    // got invalid data, handle error\n      console.error('EXIF ERROR', err)\n    }\n    // Ok, now try to get the datetime off the EXIF\n    let date = String(Date.now())\n    try {\n      date = String(exif.tags.DateTimeOriginal)\n    }\n    catch (err) {\n      console.log('EXIF', exif)\n      console.error('ERROR GETTING TIMESTAMP', err)\n    }\n    console.log('isNewSeries', { isNewSeries })\n    if (isNewSeries) {\n      let { latitude, longitude } = geo\n      // Stanley park as a fallback if we can't get the geo\n      if (!latitude || !longitude) {\n        latitude = 49.3050394\n        longitude = -123.1398254\n      }\n      try {\n        if (exif.tags.GPSLatitude && isNumeric(exif.tags.GPSLatitude) && exif.tags.GPSLongitude && isNumeric(exif.tags.GPSLongitude)) {\n          latitude = exif.tags.GPSLatitude\n          longitude = exif.tags.GPSLongitude\n        }\n      }\n      catch (e) {\n        console.error('GPS Longitude and Latitude could not be determined')\n      }\n      console.log('LATLONG FOR LIB PICK', { geo, latitude, longitude })\n      setNewSeries({ ...newSeries, latitude, longitude })\n    }\n    const photoInitObj = new PhotoClass(seriesConfig).photo\n    const fullNewPhotoObject = {\n      ...photoInitObj,\n      takenOn: date,\n      rawData: { exif },\n      base64: data\n    }\n    setNewPhoto(fullNewPhotoObject)\n    changeMode(MODES.PHOTOREVIEW)\n    console.log('onLibraryAdd FINISHED', fullNewPhotoObject)\n  }\n\n  const fileClickEl = useFileInput(onLibraryAdd)\n\n  const changeMode = (newModeName) => {\n    console.log('NEWPHOTO changeMode', mode, newModeName)\n    _changeMode({\n      current: newModeName,\n      history: [...mode.history, mode.current]\n    })\n  }\n  const lastMode = () => {\n    if (mode.history.length > 0) {\n      const oldHistory = [...mode.history]\n      const oldMode = oldHistory.pop()\n      _changeMode({\n        current: oldMode,\n        history: oldHistory\n      })\n    }\n    else {\n      onCancel()\n    }\n  }\n\n  const onShutter = (data, refId) => {\n    const photoInitObj = new PhotoClass(seriesConfig).photo\n\n    console.log('onShutter Debug GOT DATA', { data })\n    const find = 'base64,'\n    let exif = {}\n    const foundIdx = data.base64.indexOf(find) + find.length\n    const newData = data.base64.slice(foundIdx)\n    const parser = exifParser.create(Buffer.from(newData, 'base64'))\n    console.log('onLibraryAdd Buffered')\n    try {\n      exif = parser.parse()\n      console.log('got EXIF', JSON.stringify(exif))\n    }\n    catch (err) {\n    // got invalid data, handle error\n      console.error('EXIF ERROR', err)\n    }\n\n    if (isNewSeries) {\n      let { latitude, longitude } = geo\n      // Stanley park as a fallback if we can't get the geo\n      if (!latitude || !longitude) {\n        latitude = 49.3050394\n        longitude = -123.1398254\n      }\n      setNewSeries({ ...newSeries, latitude, longitude })\n    }\n    setNewPhoto({\n      ...photoInitObj,\n      rawData: {\n        orient: orientation,\n        geolocate: geo\n      },\n      base64: data.base64\n    })\n    setPhotoRefId(refId)\n    changeMode(MODES.PHOTOREVIEW)\n  }\n\n  let component = null\n  switch (mode.current) {\n    case MODES.CAMERA:\n      component = (\n        <CameraTool\n          photos={photos}\n          onShutter={onShutter}\n          onCancel={onCancel}\n        />\n      )\n      break\n    case MODES.FILEPICKER:\n      console.log('RENDERING', fileClickEl)\n      component = fileClickEl\n      // fileClick() // move this to useEffect to help with click handling\n      break\n    case MODES.PHOTOREVIEW:\n      component = (\n        <PhotoReviewTool\n          defaultRefPhotoId={photoRefId}\n          photos={photos}\n          captured={newPhoto}\n          onConfirm={() => changeMode(MODES.PHOTOINFOEDIT)}\n          onCancel={onCancel}\n          onRetry={lastMode}\n        />\n      )\n      break\n    case MODES.PHOTOINFOEDIT:\n      component = (\n        <NewPhotoInfo\n          photo={newPhoto}\n          newSeries={newSeries}\n          onSave={onCreate}\n          onCancel={onCancel}\n        />\n      )\n      break\n    default:\n      console.log('NEWPHOTO: default state. you should NEVER see this', mode)\n      onCancel()\n  }\n\n  return component\n}\n\nNewPhoto.propTypes = {\n  inputMethod: PropTypes.oneOf(['camera', 'library']),\n  onCreate: PropTypes.func.isRequired,\n  onCancel: PropTypes.func.isRequired,\n  isNewSeries: PropTypes.bool,\n  seriesConfig: PropTypes.object,\n  // This might be a new series so we might have\n  // actions to work on that\n  // This will be provided EITHER photos or onSeriesCreate\n  photos: PropTypes.array\n}\n\nexport default NewPhoto\n","import numeral from 'numeral'\n\nexport const isNumeric = num => {\n  try {\n    return !isNaN(parseFloat(num)) && isFinite(num)\n  }\n  catch (e) {\n    return false\n  }\n}\n/**\n * This is a correction to strip === signs off of base64-encoded strings\n * @param {} x\n */\nexport const urlizeb64 = x => x.replace('+', '-').replace('/', '_').replace(/=+$/, '')\n\n/**\n * We need numbers displayed consistently. This is how we do it.\n * @param {*} num\n * @param {*} precision\n */\nexport function formatNum (num, precision) {\n  try {\n    const precstr = precision > 0 ? '.' + Array(precision + 1).join('0') : ''\n    const newprec = isNumeric(num) ? numeral(num).format(`0,0${precstr}`) : num\n    return newprec.replace(/(\\.(0{0,1}[1-9]*))0+$/, '$1')\n  }\n  catch (e) {\n    return num\n  }\n}\n\n/**\n * Magic function to clear mouse selection. Use sparingly.\n */\nexport function clearSelection () {\n  if (document.selection && document.selection.empty) {\n    document.selection.empty()\n  }\n  else if (window.getSelection) {\n    var sel = window.getSelection()\n    sel.removeAllRanges()\n  }\n}\n\nexport function isObjectWithKeys (obj) {\n  return ((typeof obj === 'object') && (obj !== null) && Object.keys(obj).length > 0)\n}\n\n/**\n * Dom node parsing is weird because it may return an array or a single element with no way to know\n * which is which.\n */\nexport function makeDomArray (domnode) {\n  if (!domnode) return []\n  const keys = Object.keys(domnode)\n  // This is not the pattern we expect\n  if (keys.length > 1 || keys.length === 0) throw Error('Expected nester domnode structure.')\n  if (!domnode) return []\n  if (!domnode[keys[0]]) return []\n  return Array.isArray(domnode[keys[0]]) ? domnode[keys[0]] : [domnode[keys[0]]]\n}\n\nexport function capitalizeFirstLetter (string) {\n  return string.charAt(0).toUpperCase() + string.slice(1)\n}\n\n/**\n * Good for comparing two purely numeric arrays\n * @param {*} arr1\n * @param {*} arr2\n */\nexport function numericArrayCompare (arr1, arr2) {\n  if (!Array.isArray(arr1) || !Array.isArray(arr2)) return false\n  if (arr1.length !== arr2.length) return false\n\n  return !arr1.some((el, idx) => el !== arr2[idx])\n}\n\n/**\n * We need a function to add the padding '=' signs back before we decode\n * @param {*} hash\n */\nexport function decodeUnbufferedBase64 (hash) {\n  const missingPadding = hash.length % 4\n  if (missingPadding !== 0) {\n    const newhash = hash + Array(4 - missingPadding).join('=')\n    return Buffer.from(newhash, 'base64').toString()\n  }\n  else {\n    return Buffer.from(hash, 'base64').toString()\n  }\n}\n\nexport function encodeUnbufferedBase64 (str) {\n  return urlizeb64(Buffer.from(str).toString('base64'))\n}\n\n/**\n *\n * @param {*} o\n */\nexport function isObject (o) {\n  return o instanceof Object && o.constructor === Object\n}\n\n/**\n * XML to JSON is a non-trivial exercise. We can make certain assumptions\n * about our incoming file\n * @param {*} data\n */\nexport function arrToObj (data) {\n  for (const key in data) {\n    // Make sure we're looping over legitimate objects\n    if (data.hasOwnProperty(key)) {\n      const keyDat = data[key]\n      if (keyDat._) {\n        keyDat.val = keyDat._\n        delete keyDat._\n      }\n      if (keyDat.$) {\n        keyDat.attr = keyDat.$\n        delete keyDat.$\n      }\n      if (typeof keyDat === 'object') {\n        data[key] = arrToObj(keyDat)\n        // There's a pattern we want to collapse\n        // It puts every single individual value into its own array. Not cool\n        if (Array.isArray(keyDat) && keyDat.length === 1 && typeof keyDat[0] === 'string') {\n          if (isNumeric(keyDat[0])) data[key] = Number(keyDat[0])\n          else data[key] = keyDat[0].replace(/\\\\/g, '/')\n        }\n        else if (Array.isArray(keyDat) && keyDat.length === 1 &&\n        // The second case is when it puts objects into its own array\n          isObject(keyDat[0]) &&\n          Object.keys(keyDat[0]).length === 1) {\n          // xml2js does a weird thing where attributes get put into the following structure\n          // [{ \"_\": \"475945.992587164,5125837.37170763\", \"$\": { \"units\": \"m\"  } }]\n          data[key] = keyDat[0][Object.keys(keyDat[0])[0]]\n        }\n        // Dynamo DB does not like empty strings\n        if (typeof data[key] && data[key].length === 0) {\n          delete data[key]\n        }\n        if (typeof data[key] === 'string' && isNumeric(data[key])) data[key] = Number(data[key])\n      }\n    }\n  }\n  return data\n}\n\n/**\n * Returns a random number between min (inclusive) and max (exclusive)\n */\nexport function getRandomArbitraryInt (min, max) {\n  return parseInt(Math.random() * (max - min) + min, 10)\n}\n","import uuid from 'uuid/v4'\nimport { convertJSDatetoTimestamp } from './datelib'\nimport SeriesConfig from './SeriesConfig'\n\nclass Photo {\n  constructor (seriesConfig, photo) {\n    this.config = new SeriesConfig(seriesConfig)\n    if (photo) this.photo = photo\n    else {\n      this.photo = this.newPhoto()\n    }\n  }\n\n  setMeta = () => {\n    this.meta = JSON.stringify(this.config.getPhotoMeta())\n  }\n\n  newPhoto = () => ({\n    id: '_' + uuid(),\n    takenOn: convertJSDatetoTimestamp(new Date()),\n    meta: JSON.stringify(this.config.getPhotoMeta()),\n    tags: []\n  })\n}\n\nexport default Photo\n","import uuid from 'uuid/v4'\nimport SeriesConfig from './SeriesConfig'\n\nclass Series {\n  constructor (seriesConfig, series) {\n    this.config = new SeriesConfig(seriesConfig)\n    if (series) this.series = series\n    else {\n      this.series = this.newSeries()\n    }\n  }\n\n  setMeta = () => {\n    this.meta = JSON.stringify(this.config.getSeriesMeta())\n  }\n\n  newSeries = () => ({\n    id: '_' + uuid(),\n    meta: JSON.stringify(this.config.getSeriesMeta()),\n    photos: []\n  })\n}\n\nexport default Series\n","import React, { useEffect, useRef } from 'react'\n\nconst useFileInput = (onChange = () => {}) => {\n  const inputRef = useRef()\n  const clickRef = useRef()\n\n  const element = (\n    <input style={{ display: 'none' }} ref={inputRef} type='file' />\n  )\n\n  useEffect(() => {\n    const handleChange = evt => {\n      const [file] = [...inputRef.current.files]\n      if (file) {\n        const reader = new FileReader()\n        reader.onload = e => {\n          onChange(e.target.result)\n        }\n        reader.readAsDataURL(file)\n      }\n      inputRef.current.value = null\n    }\n\n    if (inputRef.current) {\n      inputRef.current.addEventListener('change', handleChange)\n      if (!clickRef.current) {\n        inputRef.current.click()\n        clickRef.current = true\n      }\n    }\n    return () => {\n      if (inputRef.current) {\n        inputRef.current.removeEventListener('change', handleChange)\n      }\n    }\n  }, [inputRef.current])\n\n  return element\n}\n\nexport default useFileInput\n","import { useState, useEffect, useRef } from 'react'\n\nexport const useCamera = (onCapture) => {\n  const [cameraError, setCameraError] = useState(false)\n  const [cameraOnline, setCameraOnline] = useState(false)\n  const camRef = useRef()\n\n  const initCamera = () => {\n    if (!camRef.current) {\n      camRef.current = new Webcam(\n        document.getElementById('webcam'),\n        document.createElement('canvas')\n      )\n      camRef.current.setup(\n        window.innerWidth, // width\n        window.innerHeight // height\n      )\n        .then((data) => {\n          setCameraOnline(true)\n        })\n        .catch((e) => {\n          console.error(e)\n          setCameraError(true)\n        })\n    }\n  }\n\n  const captureImage = async () => {\n    if (camRef.current && cameraOnline) {\n      const capturedData = camRef.current.takeBase64Photo({ type: 'jpeg', quality: 1 })\n      onCapture(capturedData)\n    }\n  }\n\n  const delayedOrientationChange = () => {\n    window.setTimeout(initCamera, 1000)\n  }\n\n  useEffect(() => {\n    window.addEventListener('orientationchange', delayedOrientationChange)\n    if (!camRef.current && !cameraError) initCamera()\n    return () => {\n      window.removeEventListener('orientationchange', delayedOrientationChange)\n      if (camRef.current) {\n        camRef.current.destroy()\n        setCameraError(false)\n        setCameraOnline(false)\n      }\n      camRef.current = null\n    }\n  }, [])\n\n  return { cameraError, captureImage, cameraOnline }\n}\n\nclass Webcam {\n  constructor (webcamElement, canvasElement) {\n    this.webcamElement = webcamElement\n    this.canvasElement = canvasElement\n\n    if (window.location.protocol !== 'https:' && window.location.hostname !== 'localhost') {\n      console.warn('getUserMedia() must be run from a secure origin: https or localhost.\\nChanging protocol to https.')\n    }\n\n    if (!navigator.mediaDevices && !navigator.getUserMedia) {\n      console.warn(`Your browser doesn't support navigator.mediaDevices.getUserMedia and navigator.getUserMedia.`)\n    }\n  }\n\n  adjustVideoSize (width, height) {\n    const aspectRatio = width / height\n    if (width >= height) {\n      this.webcamElement.width = aspectRatio * this.webcamElement.height\n    }\n    else if (width < height) {\n      this.webcamElement.height = this.webcamElement.width / aspectRatio\n    }\n  }\n\n  async destroy () {\n    try {\n      this.webcamElement.srcObject.getTracks()[0].stop()\n      this.webcamElement = null\n      this.canvasElement = null\n    }\n    catch (e) {\n      console.error(e)\n    }\n  }\n\n  async setup (width, height) {\n    return new Promise((resolve, reject) => {\n      if (navigator.mediaDevices.getUserMedia !== undefined) {\n        navigator.mediaDevices.getUserMedia({ audio: false, video: { facingMode: 'environment', width, height } })\n          .then((mediaStream) => {\n            if ('srcObject' in this.webcamElement) {\n              this.webcamElement.srcObject = mediaStream\n            }\n            else {\n              // For older browsers withouth the srcObject.\n              this.webcamElement.src = window.URL.createObjectURL(mediaStream)\n            }\n            this.webcamElement.onloadedmetadata = (e) => {\n              this.webcamElement.play()\n            }\n            this.webcamElement.onplaying = (e) => {\n              resolve()\n            }\n          })\n          .catch(err => reject(err))\n      }\n      else {\n        reject(new Error('Error accessing camera'))\n      }\n    })\n  }\n\n  _drawImage () {\n    const imageWidth = this.webcamElement.videoWidth\n    const imageHeight = this.webcamElement.videoHeight\n\n    const context = this.canvasElement.getContext('2d')\n    this.canvasElement.width = imageWidth\n    this.canvasElement.height = imageHeight\n\n    context.drawImage(this.webcamElement, 0, 0, imageWidth, imageHeight)\n\n    return { imageHeight, imageWidth }\n  }\n\n  takeBlobPhoto () {\n    const { imageWidth, imageHeight } = this._drawImage()\n    return new Promise((resolve, reject) => {\n      this.canvasElement.toBlob((blob) => {\n        resolve({ blob, imageHeight, imageWidth })\n      })\n    })\n  }\n\n  takeBase64Photo ({ type, quality } = { type: 'jpeg', quality: 1 }) {\n    const { imageHeight, imageWidth } = this._drawImage()\n    const base64 = this.canvasElement.toDataURL('image/' + type, quality)\n    return { base64, imageHeight, imageWidth }\n  }\n}\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\n\nimport Fab from '@material-ui/core/Fab'\nimport SwipeableDrawer from '@material-ui/core/SwipeableDrawer'\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport Typography from '@material-ui/core/Typography'\n\nimport CameraIcon from '@material-ui/icons/Camera'\nimport CancelIcon from '@material-ui/icons/Cancel'\nimport PhotoLibraryIcon from '@material-ui/icons/PhotoLibrary'\n\nimport PhotoFadeSlider from './controls/PhotoFadeSlider'\nimport PhotoGrid from './subViews/PhotoGrid'\nimport Photo from './subViews/Photo'\n\nimport { withStyles } from '@material-ui/core/styles'\nimport style from './CameraTool.style'\nimport { useCamera } from '../../../lib/useCamera'\n\n// https://googlechrome.github.io/samples/image-capture/grab-frame-take-photo.html\nconst CameraTool = ({ classes, photos, onCancel, onShutter, defaultRefPhotoId }) => {\n  const [slider, setSlider] = useState(50)\n  const newRefPhoto = defaultRefPhotoId\n    ? photos.find(p => p.id === defaultRefPhotoId)\n    : photos && photos.length > 0 ? photos[0] : null\n\n  const [refPhoto, setRefPhoto] = useState(newRefPhoto)\n  const [drawerOpen, setDrawerOpen] = useState(false)\n  const { cameraError, captureImage, cameraOnline } = useCamera((data) => onShutter(data, refPhoto ? refPhoto.id : null))\n\n  const handleTileClick = (id) => {\n    setRefPhoto(photos.find(p => p.id === id))\n    setDrawerOpen(false)\n  }\n\n  return (\n    <div className={classes.root}>\n      <CssBaseline />\n      { !cameraError && Boolean(refPhoto) && (\n        <PhotoFadeSlider defaultValue={slider} onChange={setSlider} />\n      )}\n\n      { cameraError && (\n        <div className={classes.cameraErrorText}>\n          <Typography variant='subtitle1' color='inherit'>No Camera Access</Typography>\n          <Typography variant='body2' color='inherit'>Please enabled access in your settings.</Typography>\n        </div>\n      )}\n\n      <div className={classes.captured}>\n        { Boolean(refPhoto) && (\n          <div className={classes.reference} >\n            <Photo\n              className={classes.referenceContainer}\n              opacity={(100 - slider) / 100}\n              photo={refPhoto}\n            />\n          </div>\n        )}\n        { !cameraError && (\n          <video\n            autoPlay\n            playsInline\n            muted\n            id='webcam'\n            width={window.innerWidth}\n            height={window.innerHeight}\n            className={classes.video}\n          />\n        )}\n      </div>\n\n      <Fab\n        color='primary'\n        aria-label='Take Photo'\n        classes={{\n          disabled: classes.disabledFab\n        }}\n        disabled={cameraError || !cameraOnline}\n        className={classNames(classes.cameraFab, classes.buttonFab)}\n        onClick={captureImage}\n      >\n        <CameraIcon className={classes.cameraIcon} />\n      </Fab>\n\n      <Fab\n        color='secondary'\n        aria-label='cancel'\n        onClick={onCancel}\n        classes={{\n          disabled: classes.disabledFab\n        }}\n        className={classNames(classes.cancelFab, classes.buttonFab)}\n      >\n        <CancelIcon className={classes.cancelIcon} />\n      </Fab>\n\n      <Fab\n        aria-label='cancel'\n        className={classNames(classes.libraryFab, classes.buttonFab)}\n        classes={{\n          disabled: classes.disabledFab\n        }}\n        disabled={!photos || photos.length === 0}\n        onClick={() => setDrawerOpen(true)}\n      >\n        <PhotoLibraryIcon className={classes.libraryIcon} />\n      </Fab>\n\n      <SwipeableDrawer\n        anchor='left'\n        open={drawerOpen}\n        classes={{\n          paperAnchorLeft: classes.swipeDrawer\n        }}\n        onClose={() => setDrawerOpen(false)}\n        onOpen={() => setDrawerOpen(true)}\n      >\n        <div\n          tabIndex={0}\n          className={classes.swipeDrawerContainer}\n          role='button'\n          onClick={() => setDrawerOpen(false)}\n          onKeyDown={() => setDrawerOpen(false)}\n        >\n          <PhotoGrid\n            multiSelect={false}\n            columns={1}\n            photos={photos}\n            onTileClick={handleTileClick}\n          />\n        </div>\n      </SwipeableDrawer>\n\n    </div>\n  )\n}\n\nCameraTool.propTypes = {\n  classes: PropTypes.object.isRequired,\n  photos: PropTypes.array,\n  defaultRefPhotoId: PropTypes.string, // id of the reference photo\n  onCancel: PropTypes.func.isRequired,\n  onShutter: PropTypes.func.isRequired\n}\n\nexport default withStyles(style)(CameraTool)\n","export default theme => ({\n  root: {\n    background: 'black',\n    // border: '5px solid red',\n    height: '100%',\n    width: '100%'\n  },\n  cameraErrorText: {\n    color: 'white',\n    position: 'absolute',\n    top: '50%',\n    left: '50%',\n    width: '90%',\n    transform: 'translateY(-50%) translateX(-50%)',\n    textAlign: 'center'\n  },\n  disabledFab: {\n    color: '#AAAAA!important',\n    background: '#DDDDDD!important',\n    opacity: 0.2\n  },\n  cameraFab: {\n    position: 'absolute',\n    zIndex: 10,\n    '@media (orientation: landscape)': {\n      right: '20px',\n      top: '50%',\n      transform: 'translateY(-50%)',\n      height: '25vh',\n      width: '25vh'\n    },\n    '@media (orientation: portrait)': {\n      bottom: '20px',\n      left: '50%',\n      transform: 'translateX(-50%)',\n      height: '25vw',\n      width: '25vw'\n    }\n  },\n  cameraIcon: {\n    height: '100%',\n    width: '100%'\n  },\n  cancelFab: {\n    position: 'absolute',\n    zIndex: 10,\n    '@media (orientation: landscape)': {\n      right: '15px',\n      top: '15px',\n      height: '15vh',\n      width: '15vh'\n    },\n    '@media (orientation: portrait)': {\n      right: '15px',\n      bottom: '15px',\n      height: '15vw',\n      width: '15vw'\n    }\n  },\n  cancelIcon: {\n    height: '100%',\n    width: '100%'\n  },\n\n  swipeDrawer: {\n    width: '50%'\n  },\n\n  libraryFab: {\n    position: 'absolute',\n    zIndex: 10,\n    '@media (orientation: landscape)': {\n      left: '15px',\n      top: '15px',\n      height: '15vh',\n      width: '15vh'\n    },\n    '@media (orientation: portrait)': {\n      left: '15px',\n      top: '15px',\n      height: '15vw',\n      width: '15vw'\n    }\n  },\n\n  myLocationFab: {\n    position: 'absolute',\n    zIndex: 10,\n    '@media (orientation: landscape)': {\n      right: '15px',\n      bottom: '15px',\n      height: '15vh',\n      width: '15vh'\n    },\n    '@media (orientation: portrait)': {\n      left: '15px',\n      bottom: '15px',\n      height: '15vw',\n      width: '15vw'\n    }\n  },\n  myLocationIcon: {\n    height: '80%',\n    width: '80%'\n  },\n  capturedContainer: {\n    position: 'absolute',\n    zIndex: 1,\n    height: '100%',\n    width: '100%'\n  },\n  referenceContainer: {\n    position: 'absolute',\n    zIndex: 2,\n    height: '100%',\n    width: '100%'\n  },\n  captured: {\n\n  },\n  reference: {\n\n  },\n  video: {\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    height: '100vh',\n    width: '100vw',\n    zIndex: 1\n    // '@media (orientation: portrait)': {\n    //   transform: 'rotate(90)'\n    // }\n  }\n  // overlayImage: {\n  //   position: 'absolute',\n  //   top: 0,\n  //   left: 0,\n  //   zIndex: 3,\n  //   height: '100vh',\n  //   width: '100vw',\n  //   textAlign: 'center'\n  // },\n  // overlayImageInner: {\n  //   '@media (orientation: landscape)': {\n  //     height: '100%',\n  //     width: 'auto'\n  //   },\n  //   '@media (orientation: portrait)': {\n  //     width: '100%',\n  //     height: 'auto'\n  //   }\n  // },\n  // newImage: {\n  //   position: 'absolute',\n  //   top: 0,\n  //   left: 0,\n  //   zIndex: 2\n  // }\n})\n","import React, { useState, useContext } from 'react'\nimport PropTypes from 'prop-types'\n\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport Snackbar from '@material-ui/core/Snackbar'\nimport Button from '@material-ui/core/Button'\n\nimport { withStyles } from '@material-ui/core/styles'\n\nimport Photo from './subViews/Photo'\nimport PhotoFadeSlider from './controls/PhotoFadeSlider'\nimport style from './PhotoReviewTool.style'\n\nimport { SeriesContext } from '../contexts'\n\nconst PhotoReviewTool = ({\n  classes, captured, defaultRefPhotoId,\n  onConfirm, onCancel, onRetry\n}) => {\n  const { series } = useContext(SeriesContext)\n  const photos = series && series.photos ? series.photos : null\n\n  const newRefPhoto = defaultRefPhotoId\n    ? photos.find(p => p.id === defaultRefPhotoId)\n    : photos && photos.length > 0 ? photos[0] : null\n\n  const [refPhoto, setRefPhoto] = useState(newRefPhoto)\n  const [slider, setSlider] = useState(100)\n\n  if (!captured) return 'Loading...'\n\n  return (\n    <div className={classes.root}>\n      <CssBaseline />\n      { Boolean(refPhoto) && (\n        <PhotoFadeSlider defaultValue={100} onChange={setSlider} />\n      )}\n\n      <div className={classes.captured}>\n        <Photo\n          opacity={slider / 100}\n          className={classes.capturedContainer}\n          photo={captured}\n        />\n      </div>\n      { Boolean(refPhoto) && (\n        <div className={classes.reference} >\n          <Photo\n            className={classes.referenceContainer}\n            photo={refPhoto}\n          />\n        </div>\n      )}\n      <Snackbar\n        open\n        autoHideDuration={null}\n        ContentProps={{\n          'aria-describedby': 'snackbar-fab-message-id',\n          className: classes.snackbarContent\n        }}\n        message={<span id='snackbar-fab-message-id'>Keep this photo?</span>}\n        action={<div>\n          <Button color='inherit' size='small' onClick={onCancel}>\n                Cancel\n          </Button>\n          {Boolean(onRetry) && (\n            <Button color='inherit' size='small' onClick={onRetry}>\n          Retry\n            </Button>\n          )}\n\n          <Button color='inherit' size='small' onClick={onConfirm}>\n                Keep\n          </Button>\n        </div>\n        }\n        className={classes.snackbar}\n      />\n    </div>\n  )\n}\n\nPhotoReviewTool.propTypes = {\n  classes: PropTypes.object.isRequired,\n  defaultRefPhotoId: PropTypes.string,\n  captured: PropTypes.object,\n  // Now some functions\n  onConfirm: PropTypes.func.isRequired,\n  onCancel: PropTypes.func.isRequired,\n  onRetry: PropTypes.func // only for camera\n\n}\n\nexport default withStyles(style)(PhotoReviewTool)\n","export default theme => ({\n  root: {\n    background: 'rgb(150,150, 150)',\n    // border: '5px solid red',\n    height: '100%',\n    width: '100%'\n  },\n  capturedContainer: {\n    position: 'absolute',\n    zIndex: 1,\n    height: '100%',\n    width: '100%'\n  },\n  referenceContainer: {\n    position: 'absolute',\n    zIndex: 0,\n    height: '100%',\n    width: '100%'\n  },\n  captured: {\n\n  },\n  reference: {\n\n  },\n  referenceTextContainer: {\n    width: '100%',\n    display: 'flex',\n    color: 'white',\n    background: 'rgba(0,0,0,0.5)',\n    padding: theme.spacing.unit * 3,\n    position: 'absolute',\n    zIndex: 4,\n    top: 0\n  },\n  newText: {\n    flexGrow: 1,\n    color: 'white',\n    textShadow: '1 1 1 black',\n    textAlign: 'right'\n  },\n  refText: {\n    flexGrow: 1,\n    color: 'white',\n    textShadow: '1 1 1 black'\n  }\n})\n","import React, { useState, useContext } from 'react'\nimport PropTypes from 'prop-types'\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport Typography from '@material-ui/core/Typography'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport DialogActions from '@material-ui/core/DialogActions'\nimport Button from '@material-ui/core/Button'\n\nimport SeriesEditInner from './subViews/SeriesEditInner'\n\nimport { SeriesContext } from '../contexts'\n\nimport { withStyles } from '@material-ui/core/styles'\nimport style from './NewPhotoInfo.style'\nimport PhotoInfoInner from './subViews/PhotoInfoInner'\n\nconst NewPhotoInfo = ({ classes, photo, newSeries, onCancel, onSave }) => {\n  const { series } = useContext(SeriesContext)\n  const [seriesDelta, setSeriesDelta] = useState(newSeries || {})\n  const [photoDelta, setPhotoDelta] = useState(photo)\n\n  // console.log('NewPhotoInfo', {\n  //   seriesDelta,\n  //   photoDelta,\n  //   photo,\n  //   series,\n  //   newSeries,\n  //   onCancel,\n  //   onSave\n  // })\n  // console.log('NewPhotoInfo', { series, seriesDelta, photoDelta })\n\n  return (\n    <div className={classes.root}>\n      <CssBaseline /> {/* You only need this in a root element. Don't put it anywhere else in the dom */}\n      <Dialog\n        fullScreen\n        fullWidth\n        scroll='paper'\n        disableBackdropClick\n        disableEscapeKeyDown\n        onClose={onCancel}\n        aria-labelledby='customized-dialog-title'\n        open\n      >\n        <DialogTitle disableTypography className={classes.dlgTitleContainer}>\n          <Typography variant='h5' className={classes.dlgTitle}>\n          New Photo Properties\n          </Typography>\n        </DialogTitle>\n        <DialogContent>\n\n          {!!newSeries && (\n            <SeriesEditInner\n              series={newSeries}\n              delta={seriesDelta}\n              onChange={setSeriesDelta}\n            />\n          )}\n\n          <PhotoInfoInner\n            photo={photo}\n            allowEdit\n            delta={photoDelta}\n            onChange={(newAttr) => setPhotoDelta({ ...photoDelta, ...newAttr })}\n          />\n\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={onCancel} color='primary'>\n            Cancel\n          </Button>\n          <Button onClick={() => onSave({ series: seriesDelta, photo: photoDelta })} color='primary'>\n            Next\n          </Button>\n        </DialogActions>\n      </Dialog>\n    </div>\n  )\n}\n\nNewPhotoInfo.propTypes = {\n  classes: PropTypes.object.isRequired,\n  photo: PropTypes.object.isRequired,\n  newSeries: PropTypes.object,\n  // Standard functions\n  onCancel: PropTypes.func.isRequired,\n  onSave: PropTypes.func\n}\n\nexport default withStyles(style)(NewPhotoInfo)\n","export default theme => ({\n  root: {\n\n  },\n  formLabel: {\n    color: theme.palette.text.secondary\n  },\n  mapFormLabel: {\n    marginTop: theme.spacing.unit * 2,\n    marginBottom: theme.spacing.unit,\n    color: theme.palette.text.secondary\n  },\n  map: {\n    marginBottom: theme.spacing.unit * 2\n  },\n  mapWrapper: {\n    marginBottom: theme.spacing.unit * 2\n  },\n  field: {\n    marginBottom: theme.spacing.unit * 2\n  }\n})\n","import React from 'react'\n\nexport const SeriesContext = React.createContext({})\n","import moment from 'moment'\n\n/**\n * Takes a UTC unix timestamp integer or string (milliseconds)\n * and a valid moment format string and returns a formatted\n * date string\n * @param {*} utctimestamp\n * @param {*} format\n */\nexport const formatDate = (utctimestamp, format = 'LLLL') => {\n  return moment(utctimestamp, 'x').format(format)\n}\n\n/**\n * Takes a UTC timestamp and returns a moment object in LOCAL mode\n * @param {*} utctimestamp\n */\nexport const parseDate = (utctimestamp) => {\n  return moment(utctimestamp, 'x')\n}\n\n/**\n * This returns the object in LOCAL mode\n * @param {*} jsDate\n */\nexport const convertJSDatetoTimestamp = (jsDate) => {\n  return moment\n    .utc(jsDate)\n    .format('x')\n}\n\n/**\n *\n * @param {*} utctimestamp\n */\nexport function timestampToHTML5Input (utctimestamp) {\n  // // trim the Z and milliseconds + seconds\n  return moment(utctimestamp, 'x').format('YYYY-MM-DDTkk:mm')\n}\n\n/**\n * Returns an integer timestamp\n * @param {*} isoStr\n */\nexport function HTML5InputToTimestamp (isoStr) {\n  return moment(new Date(isoStr), 'YYYY-MM-DDTkk:mm').format('x')\n}\n","import React from 'react'\nimport createSvgIcon from '@material-ui/icons/utils/createSvgIcon'\n\nexport default createSvgIcon(\n  <React.Fragment>\n    <path d='M 5.4 0 L 18.6 0 C 21.58 0 24 2.42 24 5.4 L 24 18.6 C 24 21.58 21.58 24 18.6 24 L 5.4 24 C 2.42 24 0 21.58 0 18.6 L 0 5.4 C 0 2.42 2.42 0 5.4 0 Z'\n      style={{\n        fill: 'none',\n        stroke: '#000000',\n        strokeWidth: 2,\n        strokeLinecap: 'square',\n        strokeDasharray: '0.1,3',\n        strokeMiterlimit: 5\n      }} />\n    <path d=' M 12 1.333 L 15.135 7.685 L 22.145 8.704 L 17.072 13.648 L 18.27 20.63 L 12 17.333 L 5.73 20.63 L 6.928 13.648 L 1.855 8.704 L 8.865 7.685 L 12 1.333 Z ' fill='rgb(235,235,235)' vectorEffect='non-scaling-stroke'\n      strokeWidth='1'\n      stroke='rgb(0,0,0)'\n      strokeLinejoin='miter'\n      strokeLinecap='square'\n      strokeMiterlimit='3' />\n  </React.Fragment>, 'AppLogo')\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\nimport Toolbar from '@material-ui/core/Toolbar'\nimport InputBase from '@material-ui/core/InputBase'\nimport Drawer from '@material-ui/core/Drawer'\nimport InputAdornment from '@material-ui/core/InputAdornment'\nimport Divider from '@material-ui/core/Divider'\nimport IconButton from '@material-ui/core/IconButton'\nimport List from '@material-ui/core/List'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemIcon from '@material-ui/core/ListItemIcon'\nimport ListItemText from '@material-ui/core/ListItemText'\nimport MenuIcon from '@material-ui/icons/Menu'\nimport SearchIcon from '@material-ui/icons/Search'\nimport AppLogo from '../icons/AppLogo'\n\nimport InboxIcon from '@material-ui/icons/MoveToInbox'\nimport ExitToAppIcon from '@material-ui/icons/ExitToApp'\nimport MailIcon from '@material-ui/icons/Mail'\n\n// import MenuIcon from '@material-ui/core/Menu'\nimport { withStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n    padding: '2px 4px',\n    display: 'flex',\n    alignItems: 'center',\n    width: '100%'\n  },\n  searchIcon: {\n    opacity: 0.3,\n    marginRight: theme.spacing.unit\n  },\n  input: {\n    background: '#FFFFFF',\n    border: '1px solid #AAAAAA',\n    borderRadius: theme.spacing.unit * 2,\n    paddingLeft: theme.spacing.unit,\n    marginLeft: 0,\n    flex: 1\n  },\n  iconButton: {\n    padding: 10\n  },\n  divider: {\n    width: 1,\n    height: 28,\n    margin: 4\n  }\n})\n\nconst TopBar = ({ classes, signOut }) => {\n  const [drawerOpen, setDrawerOpen] = useState(false)\n  return (\n    <Toolbar className={classes.root} disableGutters>\n      <IconButton className={classes.iconButton}>\n        <AppLogo />\n      </IconButton>\n      <InputBase\n        className={classes.input}\n        placeholder='Search...'\n        endAdornment={\n          <InputAdornment position='end'>\n            <SearchIcon className={classes.searchIcon} />\n          </InputAdornment>\n        }\n      />\n\n      <Divider className={classes.divider} />\n      <IconButton className={classes.iconButton} aria-label='Menu' onClick={() => setDrawerOpen(!drawerOpen)}>\n        <MenuIcon />\n      </IconButton>\n      <Drawer anchor='top' open={drawerOpen} onClose={() => setDrawerOpen(false)}>\n        <div\n          tabIndex={0}\n          role='button'\n          onClick={() => setDrawerOpen(false)}\n          onKeyDown={() => setDrawerOpen(false)}\n        >\n          <div className={classes.fullList}>\n            <List>\n              {['Menu Item', 'Menu Item', 'Menu Item', 'Menu Item'].map((text, index) => (\n                <ListItem button key={`index-${index}`}>\n                  <ListItemIcon>{index % 2 === 0 ? <InboxIcon /> : <MailIcon />}\n                  </ListItemIcon>\n                  <ListItemText primary={text} />\n                </ListItem>\n              ))}\n            </List>\n            {/* <Divider /> */}\n            <List>\n              <ListItem button onClick={signOut}>\n                <ListItemIcon>\n                  <ExitToAppIcon />\n                </ListItemIcon>\n                <ListItemText primary='Sign Out' />\n              </ListItem>\n            </List>\n          </div>\n\n        </div>\n      </Drawer>\n    </Toolbar>\n  )\n}\n\nTopBar.propTypes = {\n  classes: PropTypes.object.isRequired,\n  signOut: PropTypes.func.isRequired\n}\n\nexport default withStyles(style)(TopBar)\n","import React from 'react'\n\nexport const AppContext = React.createContext({})\n","import React, { useContext } from 'react'\nimport PropTypes from 'prop-types'\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport BottomNavigation from '@material-ui/core/BottomNavigation'\nimport BottomNavigationAction from '@material-ui/core/BottomNavigationAction'\n\nimport { withStyles } from '@material-ui/core/styles'\nimport style from './Home.style'\nimport TopBar from '../components/TopBar'\n\nimport { AppContext } from '../contexts'\nimport { home } from '../config'\n\nimport PlaceIcon from '@material-ui/icons/Place'\nimport FormatListBulletedIcon from '@material-ui/icons/FormatListBulleted'\nimport PersonIcon from '@material-ui/icons/Person'\n\nconst Home = ({ classes, currentState, setHomeState, children }) => {\n  const { signOut } = useContext(AppContext)\n\n  return (\n    <div className={classes.root}>\n      <CssBaseline /> {/* You only need this in a root element. Don't put it anywhere else in the dom */}\n      <div className={classes.topBar} >\n        <TopBar signOut={signOut} />\n      </div>\n      <div className={classes.mapContainer}>\n        {children}\n      </div>\n      <BottomNavigation\n        value={currentState}\n        onChange={(e, newState) => setHomeState(newState)}\n        showLabels\n        className={classes.bottomNav}\n      >\n        <BottomNavigationAction value={home.AppStateTypes.MAP} label='Map' icon={<PlaceIcon />} />\n        <BottomNavigationAction value={home.AppStateTypes.LIST} label='List' icon={<FormatListBulletedIcon />} />\n        <BottomNavigationAction value={home.AppStateTypes.USER} label='Profile' icon={<PersonIcon />} />\n      </BottomNavigation>\n    </div>\n  )\n}\n\nHome.propTypes = {\n  classes: PropTypes.object.isRequired,\n  children: PropTypes.any.isRequired,\n  // From Redux\n  setHomeState: PropTypes.func,\n  currentState: PropTypes.string\n}\n\nexport default withStyles(style)(Home)\n","export default theme => ({\n  root: {\n    height: '100%',\n    display: 'flex',\n    flexDirection: 'column'\n  },\n  mapContainer: {\n    position: 'relative',\n    // height: '100%',\n    flexGrow: 1,\n    // overflow: auto;\n    width: '100%'\n  },\n  topBar: {\n    zIndex: 1000,\n    width: '100%',\n    position: 'fixed',\n    top: 0\n  }\n})\n","/**\n * We put our action types at the top to keep them straight\n *\n * This is just a handy enumeration we use everywhere to make sure we're\n * all talking about the same ations\n */\nexport const Actions = {\n\n  HOME_CHANGE_STATE: 'HOME_CHANGE_STATE',\n  HOME_CHANGE_ACTIVE_SERIES: 'HOME_CHANGE_ACTIVE_SERIES',\n  HOME_STATE_BACK: 'HOME_STATE_BACK',\n\n  MAP_HISTORY_POP: 'MAP_HISTORY_POP',\n  MAP_HISTORY_PUSH: 'MAP_HISTORY_PUSH',\n  MAP_HISTORY_CLEAR: 'MAP_HISTORY_CLEAR',\n\n  UPLOADER_START: 'UPLOADER_START',\n  UPLOADER_COMPLETE: 'UPLOADER_COMPLETE',\n  UPLOADER_UPDATE_PROGRESS: 'UPLOADER_UPDATE_PROGRESS'\n\n}\n\n/**\n * Now here are the actual action functions we will be dispatching\n * The actions have arguments related to what they do but they action they\n * dispatch consists only of a type and data3\n */\nexport default {\n  setHomeState: (newState) => ({ type: Actions.HOME_CHANGE_STATE, data: newState }),\n  homeStateBack: () => ({ type: Actions.HOME_STATE_BACK }),\n  setActiveSeries: (seriesId) => ({ type: Actions.HOME_CHANGE_ACTIVE_SERIES, data: seriesId }),\n\n  popMapHistory: () => ({ type: Actions.MAP_HISTORY_POP }),\n  pushMapHistory: (viewportSave) => ({ type: Actions.MAP_HISTORY_PUSH, data: viewportSave }),\n  clearMapHistory: () => ({ type: Actions.MAP_HISTORY_CLEAR }),\n\n  queueUpload: (uploadObj) => ({ type: Actions.UPLOADER_START, data: uploadObj }),\n  // startActiveUpload: () => ({ type: Actions.UPLOADER_START }),\n  completeActiveUpload: () => ({ type: Actions.UPLOADER_COMPLETE }),\n  updateUploadProgress: (newProgress) => ({ type: Actions.UPLOADER_UPDATE_PROGRESS, data: newProgress })\n\n}\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Paper from '@material-ui/core/Paper'\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport LinearProgress from '@material-ui/core/LinearProgress'\nimport Typography from '@material-ui/core/Typography'\nimport { withStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n    background: 'black',\n    color: theme.palette.primary.contrastText,\n    padding: theme.spacing.unit * 2\n  },\n  message: {\n    // width: '100%'\n  },\n  msgText: {\n    display: 'flex'\n  },\n  spacer: {\n    flexGrow: 1\n  },\n  messageInner: {\n  }\n})\n\nconst UploadControlUnstyled = ({ classes, text, progress }) => {\n  if (!text) return null\n  const message = `Uploading: ${text}`\n  return (\n    <div className={classes.root}>\n      <div className={classes.messageInner}>\n        <div className={classes.msgText}>\n          <Typography color='inherit'>{message}</Typography>\n          <div className={classes.spacer} />\n          <Typography color='inherit'>{progress}%</Typography>\n        </div>\n        <LinearProgress color='secondary' variant='determinate' value={progress} />\n      </div>\n    </div>\n  )\n}\n\nUploadControlUnstyled.propTypes = {\n  classes: PropTypes.object.isRequired,\n  text: PropTypes.string,\n  progress: PropTypes.number\n}\n\nconst UploadControl = withStyles(style)(UploadControlUnstyled)\nexport default UploadControl\n\nexport const UploadControlCOSMOSWrapper = ({ classes, text, progress }) => {\n  // const [someStateItem, setSomeStateItem] = useState()\n  return (\n    <div className={classes.root}>\n      <CssBaseline /> {/* You only need this in a root element. Don't put it anywhere else in the dom */}\n      <Paper className={classes.paper}>\n        <Typography variant='h5'>\n          This is a sheet of paper.\n        </Typography>\n      </Paper>\n      <UploadControl text={text} progress={progress} />\n    </div>\n  )\n}\n\nUploadControlCOSMOSWrapper.propTypes = {\n  classes: PropTypes.object.isRequired,\n  text: PropTypes.string,\n  progress: PropTypes.number\n}\nconst wrapperStyle = theme => ({\n  root: {\n    height: '100%',\n    display: 'flex',\n    flexDirection: 'column'\n  },\n  paper: {\n    flexGrow: 1\n  }\n})\nUploadControlCOSMOSWrapper.displayName = UploadControl.displayName\nexport const UploadControlTest = withStyles(wrapperStyle)(UploadControlCOSMOSWrapper)\n","import axios from 'axios'\nimport FormData from 'form-data'\n\n/**\n * DEbuggers for AXIOS\n */\naxios.interceptors.request.use(\n  request => {\n    console.log('AXIOS:::: Starting Request', request)\n    return request\n  },\n  err => {\n    console.log('AXIOS:::: Starting Request ERROR', err)\n    return Promise.reject(err)\n  }\n)\n\naxios.interceptors.response.use(\n  response => {\n    console.log('AXIOS:::: Response', response)\n    return response\n  },\n  err => {\n    console.log('AXIOS:::: Starting Response ERROR', err)\n    return Promise.reject(err)\n  }\n)\n\nexport default async function doUpload (activeUpload, updateUploadProgress, completeActiveUpload) {\n  console.log('UploadConntect: upload start', activeUpload)\n\n  // Initialising the HTML POST form for posting to S3 directly\n  let formData = new FormData()\n  // Take the auth credentials that we got from the backend and add them to our S3 POST\n  Object.keys(activeUpload.preAuth.fields).forEach(fieldkey => {\n    console.log('APPEND', fieldkey, activeUpload.preAuth.fields[fieldkey])\n    formData.append(fieldkey, activeUpload.preAuth.fields[fieldkey])\n  })\n  const file = dataURLtoFile(activeUpload.base64, 'a.png')\n  formData.append('file', file)\n\n  const config = {\n    headers: {\n      'Content-Type': 'multipart/form-data'\n    },\n    onUploadProgress: progressEvent => {\n      const { loaded, total } = progressEvent\n      // Do something with the progress details\n      console.log('PROGRESSEVENT', loaded, total, Math.floor(100 * loaded / total))\n      updateUploadProgress({ progress: Math.floor(100 * loaded / total) })\n    }\n  }\n\n  console.log('FORMDATA', formData)\n  // Upload file to S3\n  await axios.post(\n    activeUpload.preAuth.url,\n    formData,\n    config\n  ).catch(err => {\n    console.error(err)\n    console.log(err.stack)\n  })\n  console.log('UploadConntect: upload done')\n  completeActiveUpload()\n}\n\nfunction dataURLtoFile (dataurl, filename) {\n  var arr = dataurl.split(','); var mime = arr[0].match(/:(.*?);/)[1]\n\n  var bstr = atob(arr[1]); var n = bstr.length; var u8arr = new Uint8Array(n)\n  while (n--) {\n    u8arr[n] = bstr.charCodeAt(n)\n  }\n  return new File([u8arr], filename, { type: mime })\n}\n","import React, { useRef, useEffect } from 'react'\nimport PropTypes from 'prop-types'\nimport { connect } from 'react-redux'\nimport actions from '../redux/actions'\nimport UploadControl from '../components/UploadControl'\nimport s3Upload from '../lib/s3upload'\n\nconst UploadConntect = ({\n  activeUpload,\n  completeActiveUpload, updateUploadProgress\n}) => {\n  const uploadingRef = useRef()\n  useEffect(() => {\n    uploadingRef.current = uploadingRef.current && !!activeUpload\n\n    if (activeUpload && !uploadingRef.current) {\n      s3Upload(activeUpload, updateUploadProgress, completeActiveUpload)\n    }\n  }, [Boolean(activeUpload)])\n\n  if (!activeUpload) return null\n  return <UploadControl text={'Uploading thing'} progress={activeUpload.progress || 0} />\n}\nUploadConntect.propTypes = {\n  // All from redux\n  activeUpload: PropTypes.object,\n  completeActiveUpload: PropTypes.func.isRequired,\n  updateUploadProgress: PropTypes.func.isRequired\n}\n\n/**\n * Map our redux state and functions\n */\nconst mapStateToProps = (state, props) => {\n  const { activeUpload } = state.uploader\n  return { activeUpload }\n}\n\nconst mapDispatchToProps = dispatch => ({\n  completeActiveUpload: () => {\n    dispatch(actions.completeActiveUpload())\n  },\n  updateUploadProgress: (newProgress) => {\n    dispatch(actions.updateUploadProgress(newProgress))\n  }\n})\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(UploadConntect)\n","import gql from 'graphql-tag'\n\nexport const allSeries = gql`\n  query allSeries($limit: Int, $nextToken: String) {\n    allSeries(limit: $limit, nextToken: $nextToken) {\n      seriesSummaries {\n        id\n        name\n        photoCount\n        latitude\n        longitude\n        direction\n        featured {\n          paths {\n            thumb\n          }\n        }\n      }\n      nextToken\n    }\n  }\n`\n\nexport const pollQuery = gql`\n  query pollQuery($lastCheck: String!, $limit: Int, $nextToken: String) {\n    changedSeries(lastCheck: $lastCheck, limit: $limit, nextToken: $nextToken){\n      seriesSummaries {\n        id\n        name\n        photoCount\n        latitude\n        longitude\n        direction\n        seriesStatus\n        featured {\n          paths {\n            thumb\n          }\n        }\n      }\n    }\n  }\n`\n\nexport const userSeries = gql`\n  query userSeries($createdBy: String!, $limit: Int, $nextToken: String) {\n    userSeries(createdBy: $createdBy, limit: $limit, nextToken: $nextToken) {\n      id\n      name\n      photoCount\n      latitude\n      longitude\n      direction\n      createdBy\n    }\n  }\n`\n\nexport const seriesFromList = gql`\n  query seriesFromList($seriesList: [ID]) {\n    arraySeries(seriesIds: $seriesList) {\n      id\n      name\n      photoCount\n      latitude\n      longitude\n      direction\n      createdBy\n    }\n  }\n`\n\nexport const seriesWithTag = gql`\n  query seriesWithTag($tag: String!, $limit: Int) {\n    tagSeries(tag: $tag, limit: $limit) {\n      arraySeries {\n        id\n        name\n        photoCount\n        latitude\n        longitude\n        direction\n        createdBy\n      }\n      nextToken\n    }\n  }\n`\n\nexport const tagSearch = gql`\n  query tagSearch($returnNum: Int, $tag: String) {\n    tags(returnNum: $returnNum, tag: $tag ){\n      name\n      count\n    }\n  }\n`\n\nexport const getWholeSeries = gql`\n  query getWholeSeries($id: ID!) {\n    series(id: $id) {\n      id\n      name\n      note\n      meta\n      # createdOn\n      # updatedOn\n      latitude\n      longitude\n      direction\n      photoCount\n      featured {\n        id\n        takenOn\n        paths {\n          thumb\n        }\n      }\n      # latest {\n      #   id\n      #   paths {\n      #     thumb\n      #   }\n      #   createdBy\n      #   createdOn\n      #   takenOn\n      #   updatedOn\n      # }\n      photos {\n        id\n        meta\n        createdBy\n        # createdOn\n        takenOn\n        # updatedOn\n        tags {\n          label\n          typeId\n          coords {\n            x\n            y\n          }\n        }\n        paths {\n          large\n          orig\n          thumb\n          medium\n        }\n      }\n    }\n  }\n`\n","import gql from 'graphql-tag'\n\nexport const deletePhoto = gql`\n  mutation deletePhoto($seriesId: ID!, $photoId: ID!) {\n    deletePhoto(seriesId: $seriesId, photoId: $photoId)\n  }\n`\n\nexport const deleteSeries = gql`\n  mutation deleteSeries($id: ID!) {\n    deleteSeries(id: $id)\n  }\n`\n\nexport const updateSeries = gql`\n  mutation updateSeries($series: UpdateSeries!) {\n    updateSeries(series: $series)\n  }\n`\n\nexport const updatePhoto = gql`\n  mutation updatePhoto($photo: UpdatePhoto!) {\n    updatePhoto(photo: $photo)\n  }\n`\n\nexport const createPhoto = gql`\n  mutation createPhoto($photo: NewPhotoInput!, $ext: String!) {\n    createPhoto(photo: $photo, ext: $ext) {\n      photo {\n        id\n        meta\n        createdBy\n        seriesId\n        # createdOn\n        takenOn\n        # updatedOn\n        tags {\n          label\n          typeId\n          coords {\n            x\n            y\n          }\n        }\n        paths {\n          large\n          orig\n          thumb\n          medium\n        }\n      }\n      preAuth\n    }\n  }\n`\n\nexport const createSeries = gql`\n  mutation createSeries($series: NewSeriesInput!) {\n    createSeries(series: $series) {\n      id\n      name\n      note\n      meta\n      # createdOn\n      # updatedOn\n      latitude\n      longitude\n      direction\n      photoCount\n      featured {\n        id\n        takenOn\n        paths {\n          thumb\n        }\n      }\n      # latest {\n      #   id\n      #   paths {\n      #     thumb\n      #   }\n      #   createdBy\n      #   createdOn\n      #   takenOn\n      #   updatedOn\n      # }\n      photos {\n        id\n        meta\n        createdBy\n        # createdOn\n        takenOn\n        # updatedOn\n        tags {\n          label\n          typeId\n          coords {\n            x\n            y\n          }\n        }\n        paths {\n          large\n          orig\n          thumb\n          medium\n        }\n      }\n    }\n  }\n`\n","import React, { useState, useRef } from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport SpeedDial from '@material-ui/lab/SpeedDial'\nimport SpeedDialAction from '@material-ui/lab/SpeedDialAction'\nimport { withStyles } from '@material-ui/core/styles'\n// import useNewImageMenu from '../PhotoSeries/views/controls/useNewImageMenu'\nimport AddCameraIcon from '@material-ui/icons/AddAPhoto'\nimport PhotoLibraryIcon from '@material-ui/icons/PhotoLibrary'\n\nconst style = theme => ({\n  root: {\n\n  }\n})\n\nconst AddFab = ({ classes, className, theme, children, onCameraClick, onLibraryClick }) => {\n  const [open, setOpen] = useState(false)\n  const [down, setDown] = useState(false)\n  const downRef = useRef(down)\n  downRef.current = down\n\n  const startTimer = (el) => {\n    setDown(true)\n    if (!open) {\n      setTimeout(() => {\n        if (downRef.current) setOpen(true)\n      }, 300)\n    }\n  }\n\n  // const onUp = (e) => {\n  //   // console.log('onUp', e.currentTarget)\n  //   // setSeries(series)\n  //   setDown(false)\n  //   setOpen(false)\n  //   // onCameraClick()\n  // }\n\n  const onDown = (e) => {\n    // console.log('onDown', e.currentTarget)\n    // setSeries(series)\n    startTimer(e.currentTarget)\n  }\n\n  const block = (e) => {\n    if (e && e.stopPropagation) {\n      e.stopPropagation()\n      e.preventDefault()\n    }\n  }\n\n  return (\n    <SpeedDial\n      ariaLabel='SpeedDial photo adder'\n      className={classes.root}\n      style={{\n        zIndex: 1000,\n        position: 'absolute',\n        bottom: theme.spacing.unit * 2,\n        right: theme.spacing.unit * 2\n      }}\n      onBlur={(e) => {\n        setTimeout(() => setOpen(false), 250)\n      }}\n      classes={{\n        fab: classNames(classes.speedDialFab, className)\n      }}\n      icon={children}\n      onClick={(e) => {\n        block(e)\n        setDown(false)\n        if (!open) {\n          console.log('cameraclick MAIN')\n          onCameraClick()\n        }\n      }}\n      onMouseDown={onDown}\n      // onMouseUp={onUp}\n      onTouchStart={onDown}\n      // onTouchEnd={onUp}\n\n      open={open}\n      direction='up'\n    >\n      <SpeedDialAction\n        // Bit of a hack here. This function isn't quite ready for primetime\n        icon={<AddCameraIcon className={classes.speedDialIcon} />}\n        tooltipPlacement='right'\n        tooltipTitle='From Camera'\n        tooltipOpen\n        onClick={(e) => {\n          console.log('cameraclick')\n          setOpen(false)\n          setDown(false)\n          onCameraClick()\n          block(e)\n        }}\n      />\n      <SpeedDialAction\n        // Bit of a hack here. This function isn't quite ready for primetime\n        icon={<PhotoLibraryIcon className={classes.speedDialIcon} />}\n        tooltipPlacement='right'\n        tooltipTitle='From Photo Library'\n        tooltipOpen\n        onClick={(e) => {\n          console.log('libraryClick')\n          setOpen(false)\n          setDown(false)\n          onLibraryClick()\n          block(e)\n        }}\n      />\n    </SpeedDial>\n  )\n}\n\nAddFab.propTypes = {\n  classes: PropTypes.object.isRequired,\n  className: PropTypes.string,\n  theme: PropTypes.object.isRequired,\n  children: PropTypes.any,\n  onCameraClick: PropTypes.func.isRequired,\n  onLibraryClick: PropTypes.func.isRequired\n}\n\nexport default withStyles(style, { withTheme: true })(AddFab)\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport { Menu, MenuItem } from '@material-ui/core'\n// import { Menu as MenuIcon } from '@material-ui/icons'\n\nconst ContextMenu = ({ anchorEl, onClose, menuItems }) => (\n  <Menu\n    anchorEl={anchorEl}\n    open={!!anchorEl}\n    onClose={onClose}\n  >\n    {menuItems.map((item, idx) => (\n      <MenuItem\n        key={`contextMenu-${idx}`}\n        onClick={() => {\n          onClose()\n          item.action()\n        }}>\n        {item.text}\n      </MenuItem>\n    ))}\n  </Menu>\n)\n\nContextMenu.propTypes = {\n  anchorEl: PropTypes.object,\n  onClose: PropTypes.func,\n  menuItems: PropTypes.array\n}\n\nexport default ContextMenu\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\n\nimport Divider from '@material-ui/core/Divider'\nimport List from '@material-ui/core/List'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemText from '@material-ui/core/ListItemText'\nimport Typography from '@material-ui/core/Typography'\nimport FormLabel from '@material-ui/core/FormLabel'\n\nimport { withStyles } from '@material-ui/core/styles'\n\nimport TagChip from '../tags/TagChip'\nimport style from './SeriesInfo.style'\n\nimport ShortLongText from '../controls/ShortLongText'\nimport BigText from '../dialogs/BigText'\nimport { formatDate } from '../../../../lib/datelib'\nimport SeriesConfigClass from '../../../../lib/SeriesConfig'\n\nconst DIALOGS = {\n  NOTEVIEW: 'NOTEVIEW'\n}\n\nconst SeriesInfo = ({ classes, seriesConfig, series }) => {\n  const seriesConfigInst = new SeriesConfigClass(seriesConfig)\n  const [activeDialog, setActiveDialog] = useState(null)\n  const newTags = series.photos.reduce((acc, { tags }) => {\n    tags.forEach(tag => {\n      if (!acc[tag.typeId]) {\n        acc[tag.typeId] = {\n          [tag.label]: { ...tag, count: 1 }\n        }\n      }\n      else if (acc[tag.typeId][tag.label]) {\n        const existing = acc[tag.typeId][tag.label]\n        acc[tag.typeId][tag.label] = { ...existing, count: existing.count + 1 }\n      }\n      else acc[tag.typeId][tag.label] = { ...tag, count: 1 }\n    })\n    return acc\n  }, {})\n\n  let metaKeys = []\n  try {\n    metaKeys = series.meta ? Object.keys(JSON.parse(series.meta)) : []\n  }\n  catch (e) {\n    console.error(e)\n  }\n\n  return (\n    <div className={classes.root}>\n      <div className={classes.field}>\n        <FormLabel className={classes.formLabel}>\n      Series Name\n        </FormLabel>\n        <Typography variant='body1' color='inherit'>\n          {series.name}\n        </Typography>\n      </div>\n      {series.note && (\n        <ShortLongText\n          label='Series Note'\n          text={series.note}\n          onClick={() => setActiveDialog(DIALOGS.NOTEVIEW)}\n        />\n      )}\n\n      <Typography className={classes.heading} variant='subtitle1'>Series Summary</Typography>\n      <Divider />\n      <List className={classes.list}>\n        <ListItem disableGutters>\n          <ListItemText\n            primary={`Photos: ${series.photos.length}`}\n            secondary={series.photos.length > 0 && (\n              <span>\n             First: {formatDate(series.photos[series.photos.length - 1].takenOn, 'lll')}\n                <br />\n             Latest: {formatDate(series.photos[0].takenOn, 'lll')}\n              </span>\n            )}\n          />\n        </ListItem>\n\n        <ListItem disableGutters>\n          <ListItemText>\n            <FormLabel className={classes.formLabel}>\n              Tags in use (across all photos)\n            </FormLabel>\n            <Divider />\n            {Object.keys(newTags).length === 0 && (\n              <Typography variant='caption'>No photos in this series have tags</Typography>\n            )}\n            {Object.keys(newTags).map((tagKey, idtk) => (\n              <div key={`tagchipkey${idtk}`} className={classes.tagListItem}>\n                <Typography className={classes.subheading} variant='overline'>{seriesConfigInst.getTagType(tagKey).label}</Typography>\n                <Divider />\n                {Object.values(newTags[tagKey]).length > 0\n                  ? (\n                    Object.values(newTags[tagKey]).map((tag, idx) => (\n                      <TagChip\n                        key={`tagchip-${idtk}-${idx}`}\n                        tag={tag}\n                        color={seriesConfigInst.getTagType(tagKey).color}\n                      />\n                    ))\n                  )\n                  : (\n                    <Typography variant='caption'>No photos in this series have tags</Typography>\n                  )\n                }\n              </div>\n            ))}\n          </ListItemText>\n        </ListItem>\n\n      </List>\n\n      {metaKeys.length > 0 && Object.keys(seriesConfig.meta).length > 0 && (\n        <React.Fragment>\n          <FormLabel className={classes.formLabel}>\n            Metadata\n          </FormLabel>\n          <Divider />\n          <List className={classes.list}>\n            {metaKeys.map((key, idx) => seriesConfig.meta[key] ? (\n              <ListItem key={`metadata${idx}`}>\n                <ListItemText\n                  primary={seriesConfig.meta[key].label}\n                  secondary={seriesConfig.meta[key].render(series.meta[key])}\n                />\n              </ListItem>\n            ) : null\n            )}\n          </List>\n        </React.Fragment>\n      )}\n      {activeDialog === DIALOGS.NOTEVIEW && (\n        <BigText\n          open\n          multiline\n          onClose={() => setActiveDialog(null)}\n          title='Series Note'\n          body={series.note}\n        />\n      )}\n    </div>\n  )\n}\n\nSeriesInfo.propTypes = {\n  classes: PropTypes.object.isRequired,\n  seriesConfig: PropTypes.object.isRequired,\n  series: PropTypes.object.isRequired\n}\n\nexport default withStyles(style)(SeriesInfo)\n","export default theme => ({\n  root: {\n    margin: theme.spacing.unit,\n    backgroundColor: theme.palette.background.paper,\n    marginBottom: 60 // a little extra room for the FAB\n\n  },\n  field: {\n    marginBottom: theme.spacing.unit\n  },\n  list: {\n    padding: theme.spacing.unit\n  },\n  heading: {\n    marginTop: theme.spacing.unit\n  },\n  tagListItem: {\n    marginTop: theme.spacing.unit,\n    marginBottom: theme.spacing.unit * 2\n  },\n  chip: {\n    margin: theme.spacing.unit / 2\n  }\n})\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\n\nimport MobileStepper from '@material-ui/core/MobileStepper'\nimport IconButton from '@material-ui/core/IconButton'\nimport GridListTileBar from '@material-ui/core/GridListTileBar'\nimport Badge from '@material-ui/core/Badge'\n\nimport LabelIcon from '@material-ui/icons/Label'\nimport RemoveRedEye from '@material-ui/icons/RemoveRedEye'\nimport KeyboardArrowLeft from '@material-ui/icons/KeyboardArrowLeft'\nimport KeyboardArrowRight from '@material-ui/icons/KeyboardArrowRight'\nimport SlideshowIcon from '@material-ui/icons/Slideshow'\n\nimport SwipeableViews from 'react-swipeable-views'\nimport Photo from './Photo'\nimport { formatDate } from '../../../../lib/datelib'\nimport { withStyles } from '@material-ui/core/styles'\nimport style from './SwipeShow.style'\n\nconst SwipeShow = ({ classes, theme, photos, onImageSelect, onSlideshowStart }) => {\n  const [activePhoto, setActivePhoto] = useState(0)\n  const [showTags, setShowTags] = useState(false)\n  const singular = photos.length < 2\n\n  const sortedPhotos = [...photos]\n  sortedPhotos.sort((a, b) => parseInt(b.takenOn, 10) - parseInt(a.takenOn, 10))\n\n  const handleForward = () => setActivePhoto(activePhoto >= sortedPhotos.length ? 0 : activePhoto + 1)\n  const handleBack = () => setActivePhoto(activePhoto <= 0 ? sortedPhotos.length - 1 : activePhoto - 1)\n\n  return (\n    <div className={classes.root}>\n      <div className={classes.inner}>\n        <SwipeableViews\n          axis={theme.direction === 'rtl' ? 'x-reverse' : 'x'}\n          index={activePhoto}\n          onChangeIndex={(val) => setActivePhoto(val)}\n          enableMouseEvents\n        >\n          {sortedPhotos.map((photo, idx) => (\n            <div className={classes.photoWrapper} key={`swipeshowpic-${idx}`}>\n              <Photo photo={photo} className={classes.photo} showTags={showTags} />\n            </div>\n          ))}\n        </SwipeableViews>\n        <IconButton size='small' className={classes.manualBack} onClick={handleBack} color='inherit' disabled={activePhoto === 0}>\n          {theme.direction === 'rtl' ? <KeyboardArrowRight /> : <KeyboardArrowLeft />}\n        </IconButton>\n        <IconButton size='small' className={classes.manualForward} onClick={handleForward} color='inherit' disabled={activePhoto === photos.length - 1}>\n          {theme.direction === 'rtl' ? <KeyboardArrowLeft /> : <KeyboardArrowRight />}\n        </IconButton>\n        <GridListTileBar\n          title={singular ? 'Photo' : `Photo (${activePhoto + 1}/${sortedPhotos.length})`}\n          subtitle={sortedPhotos.length > 0 && (\n            <span>{formatDate(sortedPhotos[activePhoto].takenOn)}</span>\n          )}\n          actionIcon={\n            <React.Fragment>\n              <IconButton\n                className={classes.slideshowButton}\n                disabled={!photos || photos.length === 0}\n                onClick={onSlideshowStart}\n              >\n                <SlideshowIcon />\n              </IconButton>\n              <IconButton className={classes.tagButton} onClick={() => setShowTags(!showTags)}>\n                <Badge color={showTags ? 'primary' : 'secondary'} badgeContent={sortedPhotos[activePhoto].tags ? sortedPhotos[activePhoto].tags.filter(tag => tag.coords).length : null}>\n                  <LabelIcon />\n                </Badge>\n              </IconButton>\n              <IconButton className={classes.tagButton} onClick={() => onImageSelect(sortedPhotos[activePhoto].id)}>\n                <RemoveRedEye />\n              </IconButton>\n            </React.Fragment>\n          }\n        />\n      </div>\n      {!singular &&\n      <MobileStepper\n        steps={sortedPhotos.length}\n        position='static'\n        activeStep={activePhoto}\n        classes={{\n          root: classes.mobileStepper,\n          dots: classes.dots\n        }}\n      />\n      }\n    </div>\n  )\n}\n\nSwipeShow.propTypes = {\n  // These two come from Material UI\n  classes: PropTypes.object.isRequired,\n  theme: PropTypes.object.isRequired,\n  // This is just the basic shape of the photo object\n  photos: PropTypes.arrayOf(PropTypes.shape({\n    img: PropTypes.string,\n    tags: PropTypes.array,\n    date: PropTypes.date\n  })),\n  transition: PropTypes.number,\n  onImageSelect: PropTypes.func.isRequired,\n  onSlideshowStart: PropTypes.func.isRequired\n}\n\nSwipeShow.defaultProps = {\n  transition: 5000,\n  isFullScreen: false,\n  slides: []\n}\n\nexport default withStyles(style, { withTheme: true })(SwipeShow)\n","export default theme => ({\n  root: {\n    position: 'relative'\n  },\n  inner: {\n    position: 'relative'\n  },\n  photoWrapper: {\n    minHeight: 250,\n    height: 250\n  },\n  dateCaption: {\n    padding: theme.spacing.unit,\n    background: 'black',\n    color: 'white',\n    textAlign: 'center'\n  },\n  mobileStepper: {\n    // position: 'absolute',\n    // bottom: theme.spacing.unit,\n    // right: theme.spacing.unit\n  },\n  manualBack: {\n    color: 'white',\n    zIndex: 10,\n    position: 'absolute',\n    transform: 'translateY(-50%)',\n    left: 0,\n    top: '50%'\n  },\n  manualForward: {\n    color: 'white',\n    zIndex: 10,\n    position: 'absolute',\n    transform: 'translateY(-50%)',\n    right: 0,\n    top: '50%'\n  },\n  tagButton: {\n    color: 'rgba(255, 255, 255, 0.54)'\n  },\n  slideshowButton: {\n    color: 'rgba(255, 255, 255, 0.54)'\n  },\n  dots: {\n    margin: '0 auto'\n  }\n})\n","import React, { useState, useContext } from 'react'\nimport PropTypes from 'prop-types'\n\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport AppBar from '@material-ui/core/AppBar'\nimport Toolbar from '@material-ui/core/Toolbar'\nimport IconButton from '@material-ui/core/IconButton'\nimport Typography from '@material-ui/core/Typography'\nimport Tabs from '@material-ui/core/Tabs'\nimport Tab from '@material-ui/core/Tab'\n\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack'\n\nimport AddCameraIcon from '@material-ui/icons/AddAPhoto'\nimport MoreIcon from '@material-ui/icons/MoreVert'\n\nimport { withStyles } from '@material-ui/core/styles'\n\nimport MapDot from '../../maps/MapDot'\nimport AddFab from './controls/AddFab'\n\nimport ContextMenu from './controls/ContextMenu'\n\nimport SeriesInfo from './subViews/SeriesInfo'\nimport SwipeShow from './subViews/SwipeShow'\nimport PhotoGrid from './subViews/PhotoGrid'\n\nimport DeleteDialog from './dialogs/DeleteDialog'\n\nimport { SeriesContext } from '../contexts'\n\nimport style from './SeriesView.style'\n\nconst SeriesView = ({\n  classes, onSlideshowStart, onChange, allowEdit,\n  onEditSeries, onDeletePhotos, onCameraAdd,\n  onDeleteSeries, onLibraryAdd, onTileClick, onMenuBack\n}) => {\n  const [contextEl, setContextEl] = useState()\n  const [deleteConfirm, setDeleteConfirm] = useState(false)\n\n  const { series, seriesConfig } = useContext(SeriesContext)\n\n  const onDeleteConfirm = (confirmation) => {\n    setDeleteConfirm(false)\n    if (confirmation === true) onDeleteSeries(series.id)\n  }\n\n  const viewport = { zoom: 16 }\n  if (series.longitude && series.latitude) {\n    viewport.longitude = series.longitude\n    viewport.latitude = series.latitude\n  }\n\n  const [listTypeTab, setListTypeTab] = useState(0)\n  return (\n    <div className={classes.root}>\n      <CssBaseline />\n      <AppBar position='static' className={classes.appBar}>\n        <Toolbar>\n          <IconButton className={classes.menuButton} color='inherit' onClick={onMenuBack} aria-label='Menu'>\n            <ArrowBackIcon />\n          </IconButton>\n          <Typography variant='subtitle1' color='inherit' className={classes.grow}>\n           Series\n          </Typography>\n          { allowEdit && (\n            <IconButton\n              aria-haspopup='true'\n              color='inherit'\n              onClick={event => setContextEl(event.currentTarget)}\n            >\n              <MoreIcon />\n            </IconButton>\n          )}\n\n          <ContextMenu anchorEl={contextEl} onClose={() => setContextEl(null)} menuItems={[\n            { text: 'Edit Series', action: onEditSeries },\n            { text: 'Delete Series', action: () => setDeleteConfirm(true) }\n          ]} />\n        </Toolbar>\n        <Tabs variant='fullWidth'\n          value={listTypeTab}\n          onChange={(e, value) => setListTypeTab(value)}\n        >\n          <Tab label='Info' />\n          <Tab label='Map' />\n          <Tab label='Photos' />\n        </Tabs>\n      </AppBar>\n\n      <div className={classes.inner}>\n        {listTypeTab === 0 && (\n          <React.Fragment>\n            {series.photos && series.photos.length > 0 && (\n              <SwipeShow\n                photos={series.photos}\n                onSlideshowStart={onSlideshowStart}\n                onImageSelect={onTileClick}\n              />\n            )}\n            <SeriesInfo series={series} seriesConfig={seriesConfig} onChange={onChange} />\n          </React.Fragment>\n        )}\n        {series.photos && listTypeTab === 2 && (\n          <PhotoGrid\n            photos={series.photos}\n            allowEdit={allowEdit}\n            onTileClick={onTileClick}\n            onDelete={onDeletePhotos}\n          />\n        )}\n      </div>\n\n      {listTypeTab === 1 && (\n        <MapDot\n          viewport={viewport}\n          direction={series.direction}\n        />\n      )}\n      {listTypeTab === 0 && allowEdit && (\n        <AddFab\n          className={classes.AddFab}\n          onCameraClick={onCameraAdd}\n          onLibraryClick={onLibraryAdd}\n        >\n          <AddCameraIcon />\n        </AddFab>\n      )}\n\n      <DeleteDialog\n        open={deleteConfirm}\n        onConfirm={onDeleteConfirm}\n        title='Delete Series'\n        message='Are you sure you want to delete this series? The record and all images associated with it will be gone forever.'\n      />\n    </div>\n  )\n}\n\nSeriesView.propTypes = {\n  classes: PropTypes.object.isRequired,\n  allowEdit: PropTypes.bool,\n  // Action functions\n  onSlideshowStart: PropTypes.func.isRequired,\n  onChange: PropTypes.func.isRequired,\n  onDeletePhotos: PropTypes.func.isRequired,\n  onDeleteSeries: PropTypes.func.isRequired,\n  onCameraAdd: PropTypes.func.isRequired,\n  onEditSeries: PropTypes.func.isRequired,\n  onLibraryAdd: PropTypes.func.isRequired,\n  onTileClick: PropTypes.func.isRequired,\n  onMenuBack: PropTypes.func.isRequired\n}\n\nexport default withStyles(style)(SeriesView)\n","export default theme => ({\n  root: {\n    display: 'flex',\n    height: '100%',\n    flexDirection: 'column',\n    overflow: 'hidden'\n  },\n  appBar: {\n    flexGrow: 0\n  },\n  inner: {\n    position: 'relative',\n    flexGrow: 1,\n    overflowY: 'scroll',\n    '-webkit-overflow-scrolling': 'touch'\n  },\n  tabMenu: {\n    marginTop: theme.spacing.unit * 7\n  },\n  mapWrap: {\n    position: 'absolute',\n    height: '100%',\n    width: '100%',\n    top: 0,\n    left: 0\n  },\n  AddFab: {\n    background: theme.palette.secondary.main,\n    color: theme.palette.secondary.contrastText\n  },\n  grow: {\n    flexGrow: 1\n  },\n  gridList: {\n    flexWrap: 'nowrap',\n    // Promote the list into his own layer on Chrome. This cost memory but helps keeping high FPS.\n    transform: 'translateZ(0)'\n  },\n  titleBar: {\n    display: 'flex',\n    padding: theme.spacing.unit\n  },\n  titleText: {\n    flexGrow: 1\n  },\n  menuButton: {\n    marginLeft: -12,\n    marginRight: 20\n  }\n})\n","\nimport React, { useState, useContext } from 'react'\nimport PropTypes from 'prop-types'\n\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport DialogActions from '@material-ui/core/DialogActions'\nimport Button from '@material-ui/core/Button'\nimport Typography from '@material-ui/core/Typography'\n\nimport { withStyles } from '@material-ui/core/styles'\n\nimport { SeriesContext } from '../contexts'\n\nimport style from './SeriesEdit.style'\nimport SeriesEditInner from './subViews/SeriesEditInner'\n\nconst SeriesEdit = ({ classes, onOk, onCancel }) => {\n  const { series } = useContext(SeriesContext)\n  const [delta, setDelta] = useState({})\n\n  console.log('SERIESEDIT RENDER', delta)\n\n  return (\n    <Dialog\n      scroll='paper'\n      className={classes.root}\n      fullScreen\n      open\n      fullWidth\n      onClose={onCancel}\n    >\n      <CssBaseline />\n      <DialogTitle disableTypography className={classes.dlgTitle}>\n        <Typography variant='subtitle1' color='inherit' className={classes.grow}>\n           Edit Series Details\n        </Typography>\n      </DialogTitle>\n      <DialogContent className={classes.inner}>\n        <SeriesEditInner\n          series={series}\n          delta={delta}\n          onChange={setDelta}\n        />\n      </DialogContent>\n      <DialogActions>\n        <Button className={classes.menuButton} color='inherit' onClick={() => setDelta({})} aria-label='Menu'>\n            Reset\n        </Button>\n        <Button className={classes.menuButton} color='inherit' onClick={onCancel} aria-label='Menu'>\n            Cancel\n        </Button>\n        <Button className={classes.menuButton} color='inherit' onClick={() => onOk({ id: series.id, ...delta })} aria-label='Menu'>\n            Ok\n        </Button>\n      </DialogActions>\n    </Dialog>\n  )\n}\n\nSeriesEdit.propTypes = {\n  classes: PropTypes.object.isRequired,\n  // now some functions\n  onOk: PropTypes.func.isRequired,\n  onCancel: PropTypes.func.isRequired\n}\n\nexport default withStyles(style)(SeriesEdit)\n","export default theme => ({\n  root: {\n\n  },\n  inner: {\n    display: 'flex',\n    flexDirection: 'column'\n    // padding: theme.spacing.unit\n  },\n  dlgTitle: {\n    background: theme.palette.primary.main,\n    color: theme.palette.primary.contrastText\n  },\n  grow: {\n    flexGrow: 1\n  },\n  field: {\n    flexGrow: 0,\n    marginBottom: theme.spacing.unit * 2\n  },\n  slider: {\n    paddingLeft: theme.spacing.unit,\n    paddingRight: theme.spacing.unit\n  },\n  textField: {\n    marginLeft: theme.spacing.unit,\n    marginRight: theme.spacing.unit,\n    width: '100%'\n  },\n  formLabel: {\n    display: 'block',\n    marginTop: theme.spacing.unit,\n    marginBottom: theme.spacing.unit\n  },\n  mapFormLabel: {\n    display: 'block',\n    marginTop: theme.spacing.unit,\n    marginBottom: theme.spacing.unit\n  },\n  mapInnerWrap: {\n    flexGrow: 1\n  },\n  mapWrapper: {\n    flexGrow: 1,\n    display: 'flex',\n    flexDirection: 'column',\n    paddingBottom: theme.spacing.unit * 2\n  },\n  formControl: {\n    margin: theme.spacing.unit,\n    minWidth: 120\n  },\n  chips: {\n    display: 'flex',\n    flexWrap: 'wrap'\n  }\n})\n","import React, { useState, useEffect, useRef } from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\n\nimport Badge from '@material-ui/core/Badge'\nimport Typography from '@material-ui/core/Typography'\nimport IconButton from '@material-ui/core/IconButton'\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport GridListTile from '@material-ui/core/GridListTile'\nimport GridListTileBar from '@material-ui/core/GridListTileBar'\nimport MobileStepper from '@material-ui/core/MobileStepper'\nimport Button from '@material-ui/core/Button'\n\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack'\nimport LabelIcon from '@material-ui/icons/Label'\nimport PauseIcon from '@material-ui/icons/PauseCircleFilled'\nimport PlayIcon from '@material-ui/icons/PlayCircleFilled'\nimport KeyboardArrowLeft from '@material-ui/icons/KeyboardArrowLeft'\nimport KeyboardArrowRight from '@material-ui/icons/KeyboardArrowRight'\n\nimport { withStyles } from '@material-ui/core/styles'\n\nimport Photo from './subViews/Photo'\nimport { formatDate } from '../../../lib/datelib'\nimport useComponentSize from '../../../lib/useComponentSize'\n\nimport style from './Slideshow.style'\n\nconst Slideshow = ({ classes, theme, onCancel, photos, transition }) => {\n  const { activeStep, lastStep, handleForward, handleBack, paused, pause, play } = useStepper(photos.length, transition)\n  const [showXYTags, setShowXYTags] = useState(false)\n\n  const refImgWrap = useRef(null)\n  const { size: { height, width } } = useComponentSize(refImgWrap)\n\n  return (\n    <div className={classes.root}>\n      <CssBaseline />\n      <div ref={refImgWrap} className={classes.slideContainer}>\n        {photos.map((slide, idx) => (\n          <GridListTile\n            key={`slide-${idx}`}\n            className={classNames(\n              classes.slide,\n              activeStep === idx && classes.active,\n              lastStep === idx && classes.last\n            )}\n            onClick={() => setShowXYTags(!showXYTags)}\n            style={{\n              height,\n              width,\n              transition: theme.transitions.create(['opacity'], { duration: 1 / 4 * transition })\n            }}\n          >\n            <Photo photo={slide} className={classes.photo} showTags={showXYTags} />\n            <Typography className={classes.labelBadge} >\n            Tags: {showXYTags ? 'On ' : 'Off '}\n              <Badge color='secondary' badgeContent={photos[activeStep].tags.filter(tag => tag.coords).length}>\n                <LabelIcon color='inherit' />\n              </Badge>\n            </Typography>\n\n            <GridListTileBar\n              titlePosition='top'\n              title={(\n                <Typography color='inherit' variant='caption'>\n                  <IconButton className={classes.iconButton} onClick={(e) => onCancel()}>\n                    <ArrowBackIcon />\n                  </IconButton>\n                  {formatDate(slide.takenOn)}\n                </Typography>\n              )}\n              subtitle={<em>{paused ? 'Paused' : '    '}</em>}\n              actionIcon={paused ? (\n                <IconButton className={classes.iconButton} onClick={(e) => {\n                  e.preventDefault()\n                  e.stopPropagation()\n                  play()\n                }}>\n                  <PlayIcon />\n                </IconButton>\n              ) : (\n                <IconButton className={classes.iconButton} onClick={(e) => {\n                  e.preventDefault()\n                  e.stopPropagation()\n                  pause()\n                }}>\n                  <PauseIcon />\n                </IconButton>\n              )}\n            />\n          </GridListTile>\n        ))}\n        <IconButton size='small' className={classes.manualBack} onClick={handleBack} color='inherit'>\n          {theme.direction === 'rtl' ? <KeyboardArrowRight /> : <KeyboardArrowLeft />}\n        </IconButton>\n        <IconButton size='small' className={classes.manualForward} onClick={handleForward} color='inherit'>\n          {theme.direction === 'rtl' ? <KeyboardArrowLeft /> : <KeyboardArrowRight />}\n        </IconButton>\n      </div>\n\n      <MobileStepper\n        steps={photos.length}\n        position='static'\n        activeStep={activeStep}\n        classes={{\n          root: classes.mobileStepper,\n          dotActive: classes.dotActive\n        }}\n        nextButton={\n          <Button color='inherit' size='small' onClick={handleForward} disabled={activeStep === photos.length - 1}>\n            Next\n            {theme.direction === 'rtl' ? <KeyboardArrowLeft /> : <KeyboardArrowRight />}\n          </Button>\n        }\n        backButton={\n          <Button color='inherit' size='small' onClick={handleBack} disabled={activeStep === 0}>\n            {theme.direction === 'rtl' ? <KeyboardArrowRight /> : <KeyboardArrowLeft />}\n            Back\n          </Button>\n        }\n      />\n    </div>\n  )\n}\n\nSlideshow.propTypes = {\n  // These two come from Material UI\n  classes: PropTypes.object.isRequired,\n  theme: PropTypes.object.isRequired,\n  // We might want to go full screen\n  isFullScreen: PropTypes.bool,\n  // This is just the basic shape of the photo object\n  photos: PropTypes.array,\n  transition: PropTypes.number,\n  onCancel: PropTypes.func.isRequired\n}\n\nSlideshow.defaultProps = {\n  transition: 5000,\n  isFullScreen: false,\n  slides: []\n}\n\nexport default withStyles(style, { withTheme: true })(Slideshow)\n\n/**\n * Custom React Hook for all our timer handling\n */\nconst useStepper = (num, interval) => {\n  const [activeStep, setActiveStep] = useState(0)\n  const [paused, setPaused] = useState(false)\n  const [lastStep, setLastStep] = useState(0)\n  const timerRef = useRef()\n\n  const handleForward = () => {\n    setLastStep(activeStep)\n    if (activeStep + 1 >= num) setActiveStep(0)\n    else setActiveStep(activeStep + 1)\n    if (!paused) {\n      destroyTimer()\n      createTimer()\n    }\n  }\n  const handleBack = () => {\n    setLastStep(activeStep)\n    if (activeStep - 1 < 0) setActiveStep(num - 1)\n    else setActiveStep(activeStep - 1)\n    if (!paused) {\n      destroyTimer()\n      createTimer()\n    }\n  }\n\n  const pause = () => {\n    destroyTimer()\n    setPaused(true)\n  }\n  const play = () => {\n    setPaused(false)\n    destroyTimer()\n    createTimer()\n  }\n\n  const createTimer = () => {\n    timerRef.current = window.setInterval(\n      // We need to use the alternate notation for the useState function\n      // because setInterval will only have access to the activeStep it was\n      // initialized with\n      () => setActiveStep(oldStep => {\n        setLastStep(oldStep)\n        return (oldStep + 1 >= num) ? 0 : oldStep + 1\n      })\n      , interval\n    )\n  }\n  const destroyTimer = () => {\n    if (timerRef.current) window.clearInterval(timerRef.current)\n  }\n\n  useEffect(() => {\n    createTimer()\n    return () => {\n      destroyTimer()\n    }\n  }, []) // Pass in empty array to run useEffect only on mount.\n\n  return { activeStep, lastStep, handleForward, handleBack, setActiveStep, paused, pause, play }\n}\n","// import { fade } from '@material-ui/core/styles/colorManipulator'\n\nexport default theme => ({\n  root: {\n    // maxWidth: 400,\n    height: '100%',\n    display: 'flex',\n    flexDirection: 'column'\n  },\n  swipeAble: {\n    height: '100%'\n  },\n  slideContainer: {\n    flexGrow: 1\n  },\n  mobileStepper: {\n    flexGrow: 0,\n    background: theme.palette.grey[800],\n    color: theme.palette.getContrastText(theme.palette.grey[800])\n  },\n  slide: {\n    top: 0,\n    zIndex: 0,\n    opacity: 0,\n    position: 'absolute',\n    display: 'block',\n    overflow: 'hidden',\n    width: '100%',\n    height: '100%',\n    minHeight: 300\n  },\n  dotActive: {\n    background: 'white'\n  },\n  iconButton: {\n    color: 'white'\n  },\n  active: {\n    zIndex: 5,\n    opacity: 1\n  },\n  last: {\n    opacity: 1,\n    zIndex: 4\n  },\n  tagContainer: {\n\n  },\n  labelBadge: {\n    color: 'white',\n    zIndex: 10,\n    position: 'absolute',\n    right: theme.spacing.unit * 2,\n    bottom: theme.spacing.unit,\n    opacity: 0.8\n  },\n  tagChip: {\n    // height: theme.spacing.unit * 3,\n    marginRight: theme.spacing.unit,\n    fontSize: 10,\n    height: theme.spacing.unit * 2,\n    padding: theme.spacing.unit / 2\n  },\n  xyTagChip: {\n    position: 'absolute',\n    fontSize: theme.spacing.unit,\n    height: theme.spacing.unit * 2\n  },\n  manualBack: {\n    color: 'white',\n    zIndex: 10,\n    position: 'absolute',\n    transform: 'translateY(-50%)',\n    left: 0,\n    top: '50%'\n  },\n  manualForward: {\n    color: 'white',\n    zIndex: 10,\n    position: 'absolute',\n    transform: 'translateY(-50%)',\n    right: 0,\n    top: '50%'\n  }\n})\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport Button from '@material-ui/core/Button'\nimport Typography from '@material-ui/core/Typography'\nimport DialogActions from '@material-ui/core/DialogActions'\n\n// import MenuIcon from '@material-ui/icons/MenuIcon'\nimport { withStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n\n})\n\nconst CancelConfirm = ({ classes, title, message, onConfirm, open }) => (\n  <Dialog\n    className={classes.root}\n    disableBackdropClick\n    fullWidth\n    open={open}\n    disableEscapeKeyDown\n    maxWidth='xl'\n    aria-labelledby='confirmation-dialog-title'\n  >\n    <DialogTitle id='confirmation-dialog-title'>{title}</DialogTitle>\n    <DialogContent>\n      <Typography>\n        {message}\n      </Typography>\n\n    </DialogContent>\n    <DialogActions>\n      <Button onClick={() => onConfirm(false)} color='primary'>\n      No\n      </Button>\n      <Button onClick={() => onConfirm(true)} color='secondary'>\n      Yes\n      </Button>\n    </DialogActions>\n  </Dialog>\n)\n\nCancelConfirm.propTypes = {\n  classes: PropTypes.object.isRequired,\n  open: PropTypes.bool,\n  title: PropTypes.string.isRequired,\n  message: PropTypes.string.isRequired,\n  onConfirm: PropTypes.func.isRequired\n}\n\nexport default withStyles(style)(CancelConfirm)\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\n\nimport Button from '@material-ui/core/Button'\nimport Dialog from '@material-ui/core/Dialog'\nimport IconButton from '@material-ui/core/IconButton'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport Typography from '@material-ui/core/Typography'\nimport DialogActions from '@material-ui/core/DialogActions'\n\nimport CloseIcon from '@material-ui/icons/Close'\nimport { withStyles } from '@material-ui/core/styles'\n\nimport CancelConfirm from '../dialogs/CancelConfirm'\n\nimport PhotoInfoInner from './PhotoInfoInner'\n\nconst style = theme => ({\n  root: {\n    height: '90%',\n    width: '85%'\n  },\n  dlgTitleContainer: {\n    display: 'flex',\n    padding: 0\n  },\n  dlgTitle: {\n    flexGrow: 1,\n    paddingTop: theme.spacing.unit * 2,\n    paddingBottom: theme.spacing.unit,\n    paddingLeft: theme.spacing.unit * 3\n  },\n  field: {\n    marginBottom: theme.spacing.unit * 2\n  }\n})\n\nconst DIALOGS = {\n  NOTEEDIT: 'noteEdit',\n  NOTEVIEW: 'noteView',\n  PHOTOTAKEN: 'taken',\n  TAGEDIT: 'tag',\n  CANCEL: 'cancel'\n}\n\nconst PhotoInfo = ({ classes, allowEdit, photo, onCancel, onOk, open }) => {\n  const [activeDialog, setActiveDialog] = useState(null)\n  const [delta, setDelta] = useState({})\n\n  const dirty = delta && Object.keys(delta).length > 0\n\n  return (\n    <Dialog\n      fullScreen\n      fullWidth\n      onClose={() => {\n        if (dirty) setActiveDialog(DIALOGS.CANCEL)\n        else onCancel()\n      }}\n      aria-labelledby='customized-dialog-title'\n      open={open}\n    >\n      <DialogTitle disableTypography className={classes.dlgTitleContainer}>\n        <Typography variant='h5' className={classes.dlgTitle}>\n          Photo Properties\n        </Typography>\n        <IconButton onClick={onCancel}>\n          <CloseIcon />\n        </IconButton>\n      </DialogTitle>\n      <DialogContent>\n        <PhotoInfoInner\n          photo={photo}\n          delta={delta}\n          onChange={newDelta => setDelta({ ...delta, ...newDelta })}\n          allowEdit={allowEdit}\n        />\n      </DialogContent>\n\n      <DialogActions>\n        {!allowEdit && (\n          <Button onClick={onCancel} color='primary'>\n            Ok\n          </Button>\n        )}\n        {allowEdit && !dirty && (\n          <Button onClick={onCancel} color='primary'>\n            Back\n          </Button>\n        )}\n        {allowEdit && dirty && (\n          <React.Fragment>\n            <Button onClick={() => setActiveDialog(DIALOGS.CANCEL)} color='primary'>\n              Cancel\n            </Button>\n            <Button onClick={() => setDelta({})} color='primary'>\n              Reset\n            </Button>\n            <Button onClick={() => onOk(delta)} color='primary'>\n              Ok\n            </Button>\n          </React.Fragment>\n        )}\n      </DialogActions>\n      {activeDialog && activeDialog === DIALOGS.CANCEL && (\n        <CancelConfirm\n          open\n          title='Lose unsaved changes?'\n          message='You will lose any changes you made to this form'\n          onConfirm={confirm => {\n            setActiveDialog(null)\n            if (confirm) onCancel()\n          }}\n        />\n      )}\n    </Dialog>\n  )\n}\n\nPhotoInfo.propTypes = {\n  classes: PropTypes.object.isRequired,\n  allowEdit: PropTypes.bool,\n  onCancel: PropTypes.func.isRequired,\n  onOk: PropTypes.func.isRequired,\n  open: PropTypes.bool,\n  photo: PropTypes.object.isRequired\n}\n\nexport default withStyles(style)(PhotoInfo)\n","import React, { useState, useContext } from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\n\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport Button from '@material-ui/core/Button'\nimport Typography from '@material-ui/core/Typography'\nimport AppBar from '@material-ui/core/AppBar'\nimport Toolbar from '@material-ui/core/Toolbar'\nimport IconButton from '@material-ui/core/IconButton'\nimport Badge from '@material-ui/core/Badge'\nimport Chip from '@material-ui/core/Chip'\n\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack'\nimport InfoIcon from '@material-ui/icons/Info'\nimport LabelIcon from '@material-ui/icons/Label'\n\nimport { withStyles } from '@material-ui/core/styles'\n\nimport PhotoInfo from './subViews/PhotoInfo'\nimport Photo from './subViews/Photo'\n\nimport { formatDate } from '../../../lib/datelib'\nimport Tags from '../../../lib/Tags'\n\nimport { SeriesContext } from '../contexts'\n\nimport style from './PhotoViewTool.style'\n\nconst STATES = {\n  VIEWPIC: 0,\n  SHOWINFO: 1,\n  SHOWTAGS: 2,\n  EDITTAGS: 3,\n  FIRSTAGEDIT: 4\n}\n\nconst PhotoViewTool = ({ classes, photo, onMenuBack, onUpdatePhoto, allowEdit, newPhoto }) => {\n  const { seriesConfig } = useContext(SeriesContext)\n  // This is a special copy of the photo so we can play around with the XY tags and undo\n  // if we need to\n  const [delta, setDelta] = useState(newPhoto ? photo : {})\n  const [mode, setMode] = useState({\n    current: newPhoto ? STATES.FIRSTAGEDIT : STATES.VIEWPIC,\n    last: null\n  })\n\n  const tagsClass = new Tags(seriesConfig, delta.tags || photo.tags)\n\n  const changeMode = (desired) => {\n    setMode({ current: desired, last: mode.current })\n  }\n\n  const onCommitTags = () => {\n    changeMode(STATES.SHOWTAGS)\n    onUpdatePhoto({ id: photo.id, ...delta })\n  }\n\n  const onCommitTagsFirst = () => {\n    onUpdatePhoto({ id: photo.id, ...delta })\n    onMenuBack()\n  }\n\n  const onCancelTagEdit = () => {\n    changeMode(STATES.SHOWTAGS)\n    setDelta(photo)\n  }\n\n  const photoClick = (e) => {\n    if (mode.current === STATES.VIEWPIC) {\n      e.preventDefault()\n      e.stopPropagation()\n      changeMode(STATES.SHOWINFO)\n    }\n  }\n\n  return (\n    <div className={classes.root}>\n      <CssBaseline /> {/* You only need this in a root element. Don't put it anywhere else in the dom */}\n      <AppBar position='static' className={classes.appBar}>\n        <Toolbar>\n          {mode.current !== STATES.FIRSTAGEDIT && (\n            <IconButton\n              className={classes.menuButton}\n              color='inherit'\n              aria-label='Menu'\n              onClick={() => onMenuBack()}\n            >\n              <ArrowBackIcon />\n            </IconButton>\n          )}\n          <div className={classes.grow}>\n            <Typography variant='subtitle2' color='inherit' >\n              {newPhoto ? 'Add Tags' : `Photo View`}\n            </Typography>\n            <Typography variant='subtitle2' color='inherit'>\n              {formatDate(photo.takenOn, 'lll')}\n            </Typography>\n          </div>\n\n          { mode.current === STATES.EDITTAGS &&\n          <Button color='inherit' onClick={onCancelTagEdit}>\n            Cancel\n          </Button>\n          }\n\n          { mode.current === STATES.EDITTAGS &&\n          <Button color='inherit' onClick={onCommitTags}>\n            Save\n          </Button>\n          }\n          { mode.current === STATES.FIRSTAGEDIT &&\n          <Button color='inherit' onClick={onCommitTagsFirst}>\n            Next\n          </Button>\n          }\n\n          { allowEdit && mode.current === STATES.SHOWTAGS &&\n          <Button color='inherit' onClick={() => changeMode(STATES.EDITTAGS)}>\n            Edit\n          </Button>\n          }\n\n          { (mode.current !== STATES.EDITTAGS && mode.current !== STATES.FIRSTAGEDIT) &&\n          <IconButton color='inherit'\n            className={classNames(classes.tagButton, mode.current === STATES.SHOWTAGS && classes.activeButton)}\n            onClick={() => changeMode(mode.current === STATES.SHOWTAGS ? STATES.VIEWPIC : STATES.SHOWTAGS)}\n          >\n            <Badge className={classes.margin} badgeContent={tagsClass.getXYTags().length} color='secondary'>\n              <LabelIcon />\n            </Badge>\n          </IconButton>\n          }\n\n          { (mode.current !== STATES.EDITTAGS && mode.current !== STATES.FIRSTAGEDIT) &&\n          <IconButton color='inherit'\n            className={classNames(classes.infoButton, mode.current === STATES.SHOWINFO && classes.activeButton)}\n            onClick={() => changeMode(mode.current === STATES.SHOWINFO ? STATES.VIEWPIC : STATES.SHOWINFO)}\n          >\n            <InfoIcon />\n          </IconButton>\n          }\n\n        </Toolbar>\n      </AppBar>\n      <div className={classes.inner} onClick={photoClick}>\n        <Photo\n          showTags={mode.current === STATES.SHOWTAGS}\n          photo={{ ...photo, ...delta }}\n          edit={allowEdit && (mode.current === STATES.EDITTAGS || mode.current === STATES.FIRSTAGEDIT)}\n          onChange={setDelta}\n          onCommitTags={onCommitTags}\n        />\n        {mode.current === STATES.SHOWINFO && (\n          <div className={classes.infoWindow}>\n            Esse nisi adipisicing nulla deserunt ut adipisicing officia fugiat culpa excepteur amet et mollit magna. Voluptate cupidatat deserunt est ea esse duis. Aute cillum pariatur pariatur magna consectetur excepteur. Sit pariatur nostrud labore ex mollit mollit nisi reprehenderit. Id in sint commodo commodo ipsum fugiat aliqua culpa velit ad sint ut. Magna ut nostrud non do minim. Consequat ex duis elit eu cillum pariatur in nostrud est reprehenderit.\n          </div>\n        )}\n      </div>\n      <PhotoInfo\n        open={mode.current === STATES.SHOWINFO}\n        photo={photo}\n        allowEdit={allowEdit}\n        onOk={(newDelta) => {\n          onUpdatePhoto({ id: photo.id, ...newDelta })\n          changeMode(mode.last)\n        }}\n        onCancel={() => changeMode(mode.last)}\n      />\n      { (mode.current === STATES.EDITTAGS || mode.current === STATES.FIRSTAGEDIT) && (\n        <Chip\n          label='Tap to tag features...'\n          onClick={() => {}}\n          className={classes.tipChip}\n        />\n      )}\n\n    </div>\n  )\n}\n\nPhotoViewTool.propTypes = {\n  classes: PropTypes.object.isRequired,\n  photo: PropTypes.object.isRequired,\n  allowEdit: PropTypes.bool,\n  newPhoto: PropTypes.bool,\n  // Now some action functions\n  onMenuBack: PropTypes.func.isRequired,\n  onUpdatePhoto: PropTypes.func.isRequired\n}\n\nexport default withStyles(style)(PhotoViewTool)\n","export default theme => ({\n  root: {\n    display: 'flex',\n    height: '100%',\n    flexDirection: 'column',\n    overflow: 'hidden'\n  },\n  appBar: {\n    flexGrow: 0\n  },\n  grow: {\n    flexGrow: 1\n  },\n  inner: {\n    flex: '1 1',\n    position: 'relative'\n  },\n  tabMenu: {\n    marginTop: theme.spacing.unit * 7\n  },\n  tipChip: {\n    position: 'absolute',\n    zIndex: 11,\n    bottom: 20,\n    left: '50%',\n    opacity: 0.6,\n    transform: 'translateX(-50%)'\n  },\n  // tagButton: {\n  //   zIndex: 10,\n  //   color: 'white',\n  //   position: 'absolute',\n  //   fontSize: '2.5rem',\n  //   top: 10,\n  //   left: 10,\n  //   opacity: 0.8\n  // },\n  // infoButton: {\n  //   zIndex: 10,\n  //   color: 'white',\n  //   position: 'absolute',\n  //   top: 10,\n  //   right: 10,\n  //   opacity: 0.8\n  // },\n  activeButton: {\n    color: theme.palette.secondary.main,\n    opacity: 1\n  }\n})\n","import React, { useState, useEffect } from 'react'\nimport PropTypes from 'prop-types'\n\nimport SeriesView from './views/SeriesView'\nimport SeriesEdit from './views/SeriesEdit'\nimport Slideshow from './views/Slideshow'\nimport PhotoViewTool from './views/PhotoViewTool'\nimport NewPhoto from './views/NewPhoto'\n\nimport { SeriesContext } from './contexts'\n\nconst MODES = {\n  SERIES_VIEW: 'series',\n  SERIES_EDIT: 'editseries',\n  NEWPHOTO: 'newphoto',\n  NEWSERIES: 'newseries',\n  REVIEW: 'review',\n  PHOTO_VIEW: 'photoviewer',\n  PHOTO_VIEW_NEW: 'newphotoviewer',\n  SLIDESHOW: 'slideshow'\n}\nconst VIEW_ONLY_MODES = [MODES.SERIES_VIEW, MODES.PHOTO_VIEW, MODES.SLIDESHOW]\nconst VALID_STARTMODES = [MODES.SERIES_VIEW, MODES.NEWPHOTO, MODES.NEWSERIES, MODES.PHOTO_REVIEW]\n\n/**\n * This component ties all the Repeat Photo components together\n */\nconst RepeatablePhotos = ({\n  modeName, series, seriesConfig, inputMethod: inputMethodINIT, allowEdit,\n  onChange, onClose, onDelete, onNewSeries, onChangePhoto, onNewPhoto, onDeletePhoto\n}) => {\n  // Manage view modes separately\n  // This is a pretty normal pattern for context\n  const [state, setState] = useState({ series, seriesConfig })\n  const [mode, setMode] = useState({\n    current: {\n      name: modeName || MODES.SERIES_VIEW,\n      pid: null,\n      inputMethod: inputMethodINIT\n    },\n    history: []\n  })\n  console.log('RepeatablePhotos', state)\n\n  useEffect(() => setState({ ...state, series }), [series])\n\n  // When anything changes about a photo\n  const onUpdatePhoto = (photoDelta) => {\n    const newSeries = { ...state.series }\n    newSeries.photos = newSeries.photos.map(ph => ph.id === photoDelta.id ? { ...ph, ...photoDelta } : ph)\n    onChangePhoto({ ...photoDelta, seriesId: newSeries.id })\n  }\n\n  const onApprovePhoto = async ({ photo: photoDelta, series: seriesDelta }) => {\n    const newSeries = {\n      ...series,\n      photos: [...series.photos, photoDelta]\n    }\n    await onNewPhoto(photoDelta)\n    // THIS SEEMS A LITTLE HACKY BUT GO WITH IT FOR NOW\n    setState({ ...state, series: newSeries })\n    changeMode(MODES.PHOTO_VIEW_NEW, photoDelta.id)\n  }\n\n  const onCreateSeries = async ({ photo: photoDelta, series: seriesDelta }) => {\n    console.log('RepeatablePhotos: waiting for series ID', { seriesDelta, photoDelta })\n    const onNewSeriesReturn = await onNewSeries(seriesDelta, photoDelta)\n    console.log('RepeatablePhotos: waiting for series ID DONE', onNewSeriesReturn)\n  }\n\n  // When a photo is removed\n  const onDeletePhotos = (photoIdArr) => {\n    series.photos.filter(sp => photoIdArr.indexOf(sp.id) > -1).forEach(p => onDeletePhoto(p))\n  }\n\n  // Here's our modeChanger. My guess it will get a lot more complicated\n  // once the reducers get in and working\n  const changeMode = (newModeName, newPid, newInputMethod) => {\n    if (state === null) onClose()\n    if (!allowEdit && VIEW_ONLY_MODES.indexOf(newModeName) < 0) {\n      console.error('ILLEGAL MODE CHANGE!!!!!', { from: mode.current, to: newModeName, allowEdit })\n    }\n    else {\n      // console.log('CHANGING MODE TO', newModeName)\n      setMode({\n        current: {\n          name: newModeName,\n          pid: newPid,\n          inputMethod: newInputMethod\n        },\n        history: [...mode.history, mode.current]\n      })\n    }\n  }\n  const lastMode = () => {\n    // console.log('REPEATABLEPHOTOS lastMode', mode)\n    if (mode.history.length > 0) {\n      const oldHistory = [...mode.history]\n      const oldMode = oldHistory.pop()\n      setMode({\n        current: oldMode,\n        history: oldHistory\n      })\n    }\n    else {\n      onClose()\n    }\n  }\n\n  // The action to initiate the photo viewer\n  const viewPhoto = (pid) => {\n    // console.log('DEBUG', mode, series.photos.find(p => p.id === pid))\n    changeMode(MODES.PHOTO_VIEW, pid)\n  }\n\n  let component = null\n\n  switch (mode.current.name) {\n    case MODES.SERIES_VIEW:\n      component = (\n        <SeriesView\n          allowEdit={allowEdit}\n          // This one has lots of functions\n          onSlideshowStart={() => changeMode(MODES.SLIDESHOW)}\n          onChange={() => {\n            console.log('onChange NOT IMPLEMENTED')\n          }}\n          onDeletePhotos={onDeletePhotos}\n          onDeleteSeries={onDelete}\n          onCameraAdd={() => changeMode(MODES.NEWPHOTO, null, 'camera')}\n          onEditSeries={() => changeMode(MODES.SERIES_EDIT)}\n          onLibraryAdd={() => changeMode(MODES.NEWPHOTO, null, 'library')}\n          onTileClick={viewPhoto}\n          onMenuBack={onClose}\n        />\n      )\n      break\n    case MODES.SERIES_EDIT:\n      component = (\n        <SeriesEdit\n          allowEdit={allowEdit}\n          onCancel={() => changeMode(MODES.SERIES_VIEW)}\n          onOk={(seriesDelta) => {\n            onChange({ ...seriesDelta, id: series.id })\n            changeMode(MODES.SERIES_VIEW)\n          }}\n        />\n      )\n      break\n    case MODES.PHOTO_VIEW:\n      component = (\n        <PhotoViewTool\n          photo={state.series.photos.find(p => p.id === mode.current.pid)}\n          allowEdit={allowEdit}\n          onMenuBack={lastMode}\n          onUpdatePhoto={onUpdatePhoto}\n        />\n      )\n      break\n    case MODES.PHOTO_VIEW_NEW:\n      component = (\n        <PhotoViewTool\n          photo={state.series.photos.find(p => p.id === mode.current.pid)}\n          allowEdit={allowEdit}\n          newPhoto\n          onMenuBack={() => changeMode(MODES.SERIES_VIEW)}\n          onUpdatePhoto={onUpdatePhoto}\n        />\n      )\n      break\n    case MODES.SLIDESHOW:\n      component = (\n        <Slideshow photos={state.series.photos} onCancel={lastMode} />\n      )\n      break\n    case MODES.NEWPHOTO:\n      component = (\n        <NewPhoto\n          inputMethod={mode.current.inputMethod}\n          photos={series ? series.photos : null}\n          onCreate={onApprovePhoto}\n          onCancel={lastMode}\n        />\n      )\n      break\n    case MODES.NEWSERIES:\n      component = (\n        <NewPhoto\n          inputMethod={mode.current.inputMethod}\n          isNewSeries\n          onCreate={onCreateSeries}\n          onCancel={lastMode}\n        />\n      )\n      break\n    default:\n      console.log('REPEATABLEPHOTO: default state. you should NEVER see this', state)\n      component = null\n  }\n\n  return (\n    <SeriesContext.Provider value={state}>\n      {component}\n    </SeriesContext.Provider>\n  )\n}\n\nRepeatablePhotos.propTypes = {\n  modeName: PropTypes.oneOf(VALID_STARTMODES),\n  seriesConfig: PropTypes.object.isRequired,\n  inputMethod: PropTypes.oneOf(['camera', 'library']),\n  series: PropTypes.object,\n  photos: PropTypes.object,\n  allowEdit: PropTypes.bool,\n  // Now some functions to handle actions we might take\n  onChange: PropTypes.func.isRequired,\n  onChangePhoto: PropTypes.func.isRequired,\n  onDeletePhoto: PropTypes.func.isRequired,\n  onNewPhoto: PropTypes.func.isRequired,\n  onNewSeries: PropTypes.func.isRequired,\n  onDelete: PropTypes.func.isRequired,\n  onClose: PropTypes.func.isRequired\n}\nRepeatablePhotos.defaultProps = {\n  mode: MODES.SERIES_VIEW,\n  canEdit: false\n}\n\nexport default RepeatablePhotos\n","import { openDb } from 'idb'\nimport { localDb } from '../config'\nimport uuidv4 from 'uuid/v4'\n\n/**\n * This is a leftover from the original, static RepeatablePhotos app.\n * For now it's just a decent way of storing the image data\n */\nconst dbPromise = openDb('serieslistDB', 1, upgradeDB => {\n  console.log('UPGRADE NEEDED', upgradeDB)\n  const store = upgradeDB.createObjectStore(localDb.imgStore)\n  console.log('UPGRADE NEEDED STORE', store)\n}).catch(e => {\n  console.error('ERROR', e)\n})\n\nexport const localUUID = (prefix) => {\n  return `__LOCAL_${prefix}::${uuidv4()}`\n}\n\nexport async function get (key) {\n  const db = await dbPromise\n  return db.transaction(localDb.imgStore).objectStore(localDb.imgStore).get(key)\n}\nexport async function getAll () {\n  const db = await dbPromise\n  return db.transaction(localDb.imgStore).objectStore(localDb.imgStore).getAll()\n}\nexport async function getOne () {\n  const db = await dbPromise\n  return db.transaction(localDb.imgStore).objectStore(localDb.imgStore).getAll(null, 1)\n}\nexport async function setEntry (key, val) {\n  const db = await dbPromise\n  const tx = db.transaction(localDb.imgStore, 'readwrite')\n  tx.objectStore(localDb.imgStore).put(val, key)\n  return tx.complete\n}\nexport async function deleteEntry (key) {\n  const db = await dbPromise\n  const tx = db.transaction(localDb.imgStore, 'readwrite')\n  tx.objectStore(localDb.imgStore).delete(key)\n  return tx.complete\n}\nexport async function clear () {\n  const db = await dbPromise\n  const tx = db.transaction(localDb.imgStore, 'readwrite')\n  tx.objectStore(localDb.imgStore).clear()\n  return tx.complete\n}\nexport async function keys () {\n  const db = await dbPromise\n  return db.transaction(localDb.imgStore).objectStore(localDb.imgStore).getAllKeys()\n}\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport config, { endpoints, home } from '../config'\nimport { graphql, compose } from 'react-apollo'\nimport { connect } from 'react-redux'\nimport actions from '../redux/actions'\nimport { tagSearch, getWholeSeries, allSeries } from './queries'\nimport { deletePhoto, deleteSeries, updateSeries, createPhoto, createSeries, updatePhoto } from './mutations'\nimport RepeatablePhotos from '../components/PhotoSeries'\nimport { localUUID } from '../lib/localdb'\n\nconst SeriesConnect = ({\n  series, loading, currentState, activeSeries,\n  onAfterSeriesDelete, onBack, queueUpload, doneCreatingSeries,\n  createSeriesMutation, createPhotoMutation,\n  updateSeriesMutation, updatePhotoMutation,\n  deleteSeriesMutation, deletePhotoMutation\n}) => {\n  let inputMethod = 'camera'\n  // Hack until we can get good loading object sorted\n  if (currentState === home.AppStateTypes.SERIES) {\n    if (!series && !loading) return 'No series...'\n    else if (loading) return 'Loading...'\n  }\n  else {\n    if (currentState === home.AppStateTypes.NEW_SERIES_CAMERA) inputMethod = 'camera'\n    else if (currentState === home.AppStateTypes.NEW_SERIES_LIBRARY) inputMethod = 'library'\n  }\n\n  console.log('SeriesConnect', { series, loading, currentState, activeSeries })\n\n  return <RepeatablePhotos\n    modeName={currentState !== home.AppStateTypes.SERIES ? 'newseries' : 'series'}\n    inputMethod={inputMethod}\n    allowEdit\n    series={series}\n    seriesConfig={{\n      meta: {},\n      tags: [\n        {\n          id: 'freeBothType',\n          label: null,\n          color: config.tagColors[0],\n          allowXY: true,\n          allowNonXY: true,\n          allowAdditions: true,\n          // This one returns a promise\n          getValues: () => Promise.resolve(['a', 'b', 'c']),\n          values: []\n        }\n      ],\n      getPhotoUrl: (photo, size) => Promise.resolve(`${endpoints.cdn}/${photo.paths[size]}`)\n    }}\n    // Now some functions to handle actions we might take\n    onNewPhoto={({ base64, ...newPhoto }) => {\n      console.log('onNewPhoto', { base64, ...newPhoto })\n      const ext = base64.split(';')[0].split('/')[1]\n      return createPhotoMutation(newPhoto, ext)\n        .then(({ data }) => {\n          // Don't start an upload until you get back a proper id\n          if (data.createPhoto.preAuth) {\n            const preAuth = JSON.parse(data.createPhoto.preAuth)\n            console.log('PREAUTH', data.createPhoto.preAuth)\n            queueUpload({\n              id: newPhoto.id,\n              seriesId: data.createPhoto.seriesId,\n              base64,\n              preAuth\n            })\n          }\n          return data\n        })\n        .catch(err => {\n          console.log('onNewPhoto Graphql Error', err.stack)\n          console.error(err)\n        })\n    }}\n    onChangePhoto={photoDelta => updatePhotoMutation(photoDelta)\n      .catch(err => {\n        console.log('onChangePhoto Graphql Error', err.stack)\n        console.error(err)\n      })\n    }\n    onDeletePhoto={(photo) => deletePhotoMutation(photo.id)\n      .then((...data) => {\n        console.log('photo deleted', data)\n      })\n      .catch(err => {\n        console.log('onDeletePhoto Graphql Error', err.stack)\n        console.error(err)\n      })\n    }\n    onChange={seriesDelta => updateSeriesMutation(seriesDelta)\n      .catch(err => {\n        console.log('onChange Graphql Error', err.stack)\n        console.error(err)\n      })\n    }\n    onNewSeries={(newSeries, photoNoId) => {\n      console.log('Series.connect: onNewSeries starting', newSeries)\n      return createSeriesMutation(newSeries)\n        .then(async ({ data }) => {\n          const { base64, ...newPhoto } = photoNoId\n          const ext = base64.split(';')[0].split('/')[1]\n          console.log('Series.connect: done createSeriesMutation', data)\n          const { data: photoData } = await createPhotoMutation({ ...photoNoId, seriesId: data.createSeries.id }, ext)\n\n          const preAuth = JSON.parse(photoData.createPhoto.preAuth)\n          console.log('PREAUTH', photoData.createPhoto.preAuth)\n          queueUpload({\n            id: newPhoto.id,\n            seriesId: photoData.createPhoto.seriesId,\n            base64,\n            preAuth\n          })\n          doneCreatingSeries(data.createSeries.id)\n          return data\n        })\n        .catch(err => {\n          console.log('onNewSeries Graphql Error', err.stack)\n          console.error(err)\n        })\n    }}\n    onDelete={() => deleteSeriesMutation()\n      .then(onAfterSeriesDelete)\n      .catch(err => {\n        console.log('onDelete Graphql Error', err.stack)\n        console.error(err)\n      })\n    }\n    onClose={onBack}\n  />\n}\nSeriesConnect.propTypes = {\n  currentState: PropTypes.string,\n  activeSeries: PropTypes.string,\n\n  // From Redux\n  onAfterSeriesDelete: PropTypes.func,\n  doneCreatingSeries: PropTypes.func,\n  queueUpload: PropTypes.func,\n  onBack: PropTypes.func,\n\n  // Data from apollo\n  series: PropTypes.object,\n  // Functions From Apollo\n  updateSeriesMutation: PropTypes.func,\n  updatePhotoMutation: PropTypes.func,\n  deleteSeriesMutation: PropTypes.func,\n  deletePhotoMutation: PropTypes.func,\n  createSeriesMutation: PropTypes.func,\n  createPhotoMutation: PropTypes.func,\n  loading: PropTypes.bool\n}\n\n/**\n * Here's the graphql HOC that gets an individual series\n */\nconst withGetSelectedQuery = graphql(getWholeSeries, {\n  props: ({ data }) => {\n    if (data.error) console.error(data.error)\n    // console.log('HERE', data)\n    let series = null\n    try {\n      if (!data.loading && !data.error) series = data.series\n    }\n    catch (e) {\n      console.error(data)\n      console.error(e)\n    }\n    return {\n      data,\n      loading: data.loading,\n      series\n    }\n  },\n  skip: ({ activeSeries, isNewSeries }) => !activeSeries || isNewSeries,\n  options: ({ activeSeries }) => ({\n    variables: {\n      id: activeSeries\n    }\n  })\n})\n\nconst withUpdateSeriesMutation = graphql(updateSeries, {\n  props: ({ mutate, ownProps }) => ({\n    // We turn this into a thunk so we can handle the business logic here and not in a JSX region\n    updateSeriesMutation: (seriesDelta) => mutate({\n      // input UpdateSeries {\n      //   id: ID!\n      //   name: String\n      //   note: String\n      //   latitude: Float\n      //   longitude: Float\n      //   direction: Int\n      // }\n      variables: { series: sanitizeUpdateParams(seriesDelta, ['id', 'name', 'note', 'latitude', 'longitude', 'direction']) },\n      optimisticResponse: {\n        updateSeries: seriesDelta.id\n      },\n      update: (store, { data }) => {\n        // console.log('withUpdateSeriesMutation start Manip:', JSON.stringify(data, null, 2))\n        const qdata = store.readQuery({ query: getWholeSeries, variables: { id: ownProps.activeSeries } })\n        qdata.series = { ...qdata.series, ...seriesDelta }\n        store.writeQuery({ query: getWholeSeries, data: qdata })\n        // console.log('withUpdateSeriesMutation Done Manip:', qdata)\n\n        // Update: allSeries\n        // We might not have called this query yet so let it throw if it wants\n        try {\n          const qdataAll = store.readQuery({ query: allSeries, variables: { limit: 100 } })\n          // console.log('withUpdateSeriesMutation qdataAll:', qdataAll)\n          const summary = sanitizeUpdateParams(seriesDelta, ['id', 'name', 'latitude', 'longitude', 'direction'])\n          qdataAll.allSeries.seriesSummaries = qdataAll.allSeries.seriesSummaries.map(s => s.id !== summary.id\n            ? s\n            : { ...s, ...summary }\n          )\n          store.writeQuery({ query: allSeries, data: qdataAll })\n          // console.log('withUpdateSeriesMutation qdataAll WRITE:', qdataAll)\n        }\n        catch (e) { }\n      }\n    })\n  })\n})\n\n// id: ID!\n// seriesId: ID!\n// takenOn: String\n// tags: [TagInput]\n// note: String\nconst withUpdatePhotoMutation = graphql(updatePhoto, {\n  props: ({ mutate, ownProps }) => ({\n    // We turn this into a thunk so we can handle the business logic here and not in a JSX region\n    updatePhotoMutation: (photoDelta) => {\n      const sanitizedPHoto = sanitizeUpdateParams(photoDelta, [ 'id', 'seriesId', 'takenOn', 'tags', 'note' ])\n      if (sanitizedPHoto.tags && sanitizedPHoto.tags.length > 0) {\n        // input TagInput {\n        //   label: String\n        //   typeId: String,\n        //   coords: ImageCoordsInput\n        // }\n        sanitizedPHoto.tags = sanitizedPHoto.tags.map(t => {\n          const newT = sanitizeUpdateParams(t, [ 'label', 'typeId', 'coords' ])\n          if (newT.coords) newT.coords = sanitizeUpdateParams(newT.coords, [ 'x', 'y' ])\n          return newT\n        })\n      }\n      // console.log('withUpdatePhotoMutation', sanitizedPHoto)\n      return mutate({\n      // input UpdatePhoto {\n      //   id: ID!\n      //   seriesId: ID!\n      //   takenOn: String\n      //   tags: [TagInput]\n      //   note: String\n      // }\n        variables: { photo: sanitizedPHoto },\n        optimisticResponse: {\n          updatePhoto: photoDelta.id\n        },\n        update: (store, { data }) => {\n          // console.log('updatePhotoMutation start Manip:', JSON.stringify(data, null, 2))\n          const qdata = store.readQuery({ query: getWholeSeries, variables: { id: ownProps.activeSeries } })\n          // Gotta add Typenames\n          const updatedPhoto = {\n            ...sanitizedPHoto,\n            tags: sanitizedPHoto.tags ? sanitizedPHoto.tags.map(t => {\n              const newT = { ...t, __typename: 'Tag' }\n              newT.coords = newT.coords ? { ...newT.coords, __typename: 'ImageCoords' } : null\n              return newT\n            }) : []\n          }\n          // console.log('updatePhotoMutation', updatedPhoto)\n          qdata.series.photos = qdata.series.photos.map(photo => photo.id !== photoDelta.id ? photo : { ...photo, ...updatedPhoto })\n\n          store.writeQuery({ query: getWholeSeries, data: qdata })\n          // console.log('updatePhotoMutation Manip:', { qdata })\n        }\n      })\n    }\n  })\n})\n\nconst withDeleteSeriesDeleteMutation = graphql(deleteSeries, {\n  props: ({ mutate, ownProps }) => {\n    return {\n      deleteSeriesMutation: () => mutate({\n        variables: { id: ownProps.activeSeries },\n        optimisticResponse: {\n          deleteSeries: ownProps.activeSeries\n        },\n        update: (store, { data }) => {\n          try {\n            const qdataAll = store.readQuery({ query: allSeries, variables: { limit: 100 } })\n            qdataAll.allSeries.seriesSummaries = qdataAll.allSeries.seriesSummaries.filter(s => s.id !== data.deleteSeries)\n            store.writeQuery({ query: allSeries, data: qdataAll })\n          }\n          catch (e) { }\n        }\n      })\n    }\n  }\n})\n\nconst withDeletePhotoMutation = graphql(deletePhoto, {\n  props: ({ mutate, ownProps }) => ({\n    // We turn this into a thunk so we can handle the business logic here and not in a JSX region\n    deletePhotoMutation: (photoId) => mutate({\n      variables: { seriesId: ownProps.series.id, photoId },\n      optimisticResponse: {\n        deletePhoto: photoId\n      },\n      update: (store, { data }) => {\n        console.log('deletePhotoMutation start Manip:', JSON.stringify(data, null, 2))\n        let finalCount = null\n\n        const qdata = store.readQuery({ query: getWholeSeries, variables: { id: ownProps.activeSeries } })\n        qdata.series.photos = qdata.series.photos.filter(photo => photo.id !== data.deletePhoto)\n\n        finalCount = qdata.series.photos.length\n        qdata.series.photoCount = finalCount\n        store.writeQuery({ query: getWholeSeries, data: qdata })\n        console.log('deletePhotoMutation start Manip WRITE:', qdata)\n\n        // Update: allSeries\n        // We might not have called this query yet so let it throw if it wants\n        try {\n          const qdataAll = store.readQuery({ query: allSeries, variables: { limit: 100 } })\n          console.log('deletePhotoMutation qdataAll:', qdataAll)\n          qdataAll.allSeries.seriesSummaries = qdataAll.allSeries.seriesSummaries.map(s => s.id !== data.deletePhoto\n            ? s\n            : { ...s, photoCount: finalCount !== null ? finalCount : s.photoCount }\n          )\n          store.writeQuery({ query: allSeries, data: qdataAll })\n          console.log('deletePhotoMutation qdataAll WRITE:', qdataAll)\n        }\n        catch (e) { }\n\n        console.log('Done Manip:', qdata.series.photos)\n      }\n    })\n  })\n})\n\nconst withCreateNewSeries = graphql(createSeries, {\n  props: ({ mutate, ownProps }) => {\n    return {\n      createSeriesMutation: (newSeries) => {\n        // input NewSeriesInput {\n        //   name: String!\n        //   note: String\n        //   latitude: Float!\n        //   longitude: Float!\n        //   direction: Int\n        //   meta: String\n        // }\n        return mutate({\n          variables: { series: sanitizeUpdateParams(newSeries, ['name', 'note', 'latitude', 'longitude', 'direction', 'meta']) },\n          optimisticResponse: {\n            'createSeries': {\n              'id': localUUID('SERIES'),\n              'name': newSeries.name || null,\n              'note': newSeries.note || null,\n              'meta': newSeries.meta || {},\n              'featured': newSeries.featured || null,\n              'latitude': newSeries.latitude || null,\n              'longitude': newSeries.longitude || null,\n              'direction': newSeries.direction || null,\n              'photoCount': 0,\n              'photos': [],\n              __typename: 'Series'\n            }\n          },\n          update: (store, { data }) => {\n            // We need to write this query from scratch\n            console.log('STARTING TO CREATE THE SERIES', data, store)\n            // dumpLog(store.data, '##CACHE-NEW_SERIES_BEFORE')\n            try {\n              store.writeQuery({ query: getWholeSeries,\n                data: { series: data.createSeries }\n              })\n              console.log('Series write getWholeSeries', { series: data.createSeries })\n            }\n            catch (e) {\n              console.error(e)\n            }\n\n            try {\n              const qdataAll = store.readQuery({ query: allSeries, variables: { limit: 100 } })\n              // console.log('createSeriesMutation qdataAll:', qdataAll)\n              const newAllSeriesEntry = sanitizeUpdateParams(data.createSeries, ['id', 'name', 'updatedOn', 'featured', 'longitude', 'latitude', 'photoCount', 'seriesStatus', 'direction'])\n              qdataAll.allSeries.seriesSummaries.push(newAllSeriesEntry)\n              store.writeQuery({ query: allSeries, data: qdataAll })\n              // console.log('createSeriesMutation qdataAll WRITE:', qdataAll)\n            }\n\n            catch (e) {\n              // dumpLog(store.data, '##CACHE-NEW_SERIES_ERROR')\n              console.error('createSeriesMutation allSeries error')\n              console.error(e)\n            }\n            // dumpLog(store.data, '##CACHE-NEW_SERIES_AFTER')\n          }\n        })\n      }\n    }\n  }\n})\n\nconst withCreateNewPhoto = graphql(createPhoto, {\n  props: ({ mutate, ownProps }) => {\n    return {\n      createPhotoMutation: (newPhoto, ext) => {\n        // input NewPhotoInput {\n        //   seriesId: ID!\n        //   takenOn: String\n        //   meta: String\n        //   tags: [TagInput]\n        //   note: String\n        // }\n        // When we're not creating a series the seriesId isn't passed in\n        // so we add it now\n        const { base64, ...newPhotoInput } = newPhoto\n        if (!newPhotoInput.seriesId && ownProps.activeSeries) {\n          newPhotoInput.seriesId = ownProps.activeSeries\n        }\n        return mutate({\n          variables: { photo: sanitizeUpdateParams(newPhotoInput, [ 'seriesId', 'takenOn', 'meta', 'tags', 'note' ]), ext },\n          optimisticResponse: {\n            'createPhoto': {\n              'photo': {\n                'id': localUUID('PHOTO'),\n                'meta': newPhotoInput.meta,\n                'seriesId': newPhotoInput.seriesId,\n                'createdOn': Date.now().toString(),\n                'createdBy': ownProps.authData.attributes.sub,\n                'updatedBy': ownProps.authData.attributes.sub,\n                'updatedOn': Date.now().toString(),\n                'takenOn': newPhotoInput.takenOn,\n                'tags': newPhotoInput.tags || [],\n                'paths': {\n                  large: null,\n                  orig: null,\n                  thumb: null,\n                  medium: null,\n                  __typename: 'Paths'\n                },\n                '__typename': 'Photo'\n              },\n              'preAuth': null,\n              '__typename': 'NewPhotoOutput'\n            }\n          },\n          update: (store, { data }) => {\n            // Update: getWholeSeries\n            console.log('createPhotoMutation store.readQuery:', { data, store, ownProps })\n\n            try {\n              const qdata = store.readQuery({ query: getWholeSeries, variables: { id: data.createPhoto.seriesId } })\n              qdata.series.photos = qdata.series.photos = [...qdata.series.photos, data.createPhoto]\n\n              store.writeQuery({ query: getWholeSeries, data: qdata })\n            }\n            catch (e) {\n              // This won't fire on new series and that's ok for now.\n            }\n\n            // Update: allSeries\n            // We might not have called this query yet so let it throw if it wants\n            let qdataAll = null\n            try {\n              qdataAll = store.readQuery({ query: allSeries, variables: { limit: 100 } })\n              console.log('createPhotoMutation qdataAll:', qdataAll)\n              qdataAll.allSeries.seriesSummaries = qdataAll.allSeries.seriesSummaries.map(s => s.id !== data.createPhoto.photo.seriesId\n                ? s\n                : { ...s, photoCount: s.photoCount + 1 }\n              )\n              store.writeQuery({ query: allSeries, data: qdataAll })\n              console.log('createPhotoMutation qdataAll: WRITE', qdataAll)\n            }\n            catch (e) {\n              console.error('createPhotoMutation allSeries ERROR')\n              console.error(e)\n            }\n          }\n        })\n      }\n    }\n  }\n})\n\n/**\n * Compose all our queries together\n */\nconst connectedWithApollo = compose(\n  withGetSelectedQuery,\n  withCreateNewSeries,\n  withCreateNewPhoto,\n  withUpdateSeriesMutation,\n  withUpdatePhotoMutation,\n  withDeleteSeriesDeleteMutation,\n  withDeletePhotoMutation\n)(SeriesConnect)\n\n/**\n * Map our redux state and functions\n */\nconst mapStateToProps = (state, props) => {\n  const { activeSeries, currentState } = state.home\n  return { activeSeries, currentState }\n}\n\nconst mapDispatchToProps = dispatch => ({\n  onBack: () => {\n    dispatch(actions.homeStateBack())\n  },\n  onAfterSeriesDelete: (key, newProgress) => {\n    dispatch(actions.setActiveSeries(null))\n    dispatch(actions.homeStateBack())\n  },\n  queueUpload: (uploadObj) => {\n    dispatch(actions.queueUpload(uploadObj))\n  },\n  doneCreatingSeries: (seriesId) => {\n    dispatch(actions.setActiveSeries(seriesId))\n    dispatch(actions.setHomeState(home.AppStateTypes.SERIES))\n  }\n})\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(connectedWithApollo)\n\n/**\n * We need to filter out null values and params we don't desire\n */\nfunction sanitizeUpdateParams (inputObj, desiredParams) {\n  const newDesiredParams = [...desiredParams, '__typename']\n  const remainder = Object.keys(inputObj).filter(key => newDesiredParams.indexOf(key) > -1)\n  console.log('sanitizeUpdateParams', { orig: Object.keys(inputObj), remainder })\n  return remainder.reduce((acc, key) => ({ ...acc, [key]: inputObj[key] }), {})\n}\n\nfunction dumpLog (obj, name) {\n  console.log(`${Date.now()}__${name}`, JSON.stringify(obj, null, 2))\n}\n","import { useMemo, useState, useEffect } from 'react'\nimport uuid from 'uuid/v4'\nimport WebMercatorViewport from 'viewport-mercator-project'\nimport rbush from 'rbush'\nimport { point, centroid, featureCollection } from '@turf/turf'\n\nconst useClusteredData = (data, filterBounds, currentZoom, viewport, sizeScale, queryVersion) => {\n  const [clusteredData, setClusteredData] = useState([])\n  const [version, setVersion] = useState(0)\n  // Here's the really expensive call. Make sure this only runs when the data changes\n  useEffect(() => {\n    setClusteredData(_updateData(data, sizeScale, viewport))\n    setVersion(version + 1)\n  }, [data.length, queryVersion])\n\n  // The filtering is less expensive but only needs to run when the zoom changes\n  const filteredClusteredData = useMemo(() => filterData(clusteredData, filterBounds, currentZoom), [clusteredData.length, currentZoom, filterBounds, version])\n  return { filteredClusteredData }\n}\n\nexport default useClusteredData\n\n// Compute icon clusters\n// We use the projected positions instead of longitude and latitude to build\n// the spatial index, because this particular dataset is distributed all over\n// the world, we can't use some fixed deltaLon and deltaLat\nconst _updateData = (data, sizeScale, viewport) => {\n  // console.log('----------------------------------UPDATE CLUSTER----------------------------------', data)\n\n  if (!data) {\n    return []\n  }\n  const tree = rbush(9, ['.x', '.y', '.x', '.y'])\n\n  const transform = new WebMercatorViewport({\n    ...viewport,\n    zoom: 0\n  })\n\n  // console.log('DATA', data)\n  // The root of this is GeoJSON so that's what we have to build\n  const newData = data.map(p => {\n    // Create some GeoJSON that we can render as a dot\n    let screenCoords = [0, 0]\n    try {\n      screenCoords = transform.project([p.longitude, p.latitude])\n    }\n    catch (e) {\n      console.error(e)\n    }\n    const { longitude, latitude, ...properties } = p\n    return {\n      x: screenCoords[0],\n      y: screenCoords[1],\n      photoCount: properties.photoCount,\n      zoomLevels: [],\n      geoJSON: point([p.longitude, p.latitude], { ...properties })\n    }\n  })\n\n  tree.clear()\n  tree.load(newData)\n\n  for (let z = 0; z <= 20; z++) {\n    const radius = sizeScale / Math.sqrt(2) / Math.pow(2, z)\n    // const radius = 60 / Math.sqrt(2) / Math.pow(2, z)\n\n    newData.forEach(p => {\n      if (p.zoomLevels[z] === undefined) {\n        // this point does not belong to a cluster\n        const { x, y } = p\n\n        // find all points within radius that do not belong to a cluster\n        const neighbors = tree\n          .search({\n            minX: x - radius,\n            minY: y - radius,\n            maxX: x + radius,\n            maxY: y + radius\n          })\n          .filter(neighbor => neighbor.zoomLevels[z] === undefined)\n\n        // only show the center point at this zoom level\n        neighbors.forEach(neighbor => {\n          if (neighbor === p) {\n            const newGeoJSON = neighbors.length === 1\n              ? p.geoJSON\n              : centroid(featureCollection(neighbors.map(n => n.geoJSON)))\n\n            newGeoJSON.properties = {\n              ...newGeoJSON.properties,\n              id: newGeoJSON.properties.id || uuid(),\n              count: neighbors.length,\n              reducedPhotoCount: neighbors.reduce((acc, { photoCount }) => photoCount ? acc + photoCount : acc, 0),\n              points: neighbors.map(n => n.geoJSON)\n            }\n            p.zoomLevels[z] = newGeoJSON\n          }\n          else {\n            neighbor.zoomLevels[z] = null\n          }\n        })\n      }\n    })\n  }\n\n  // console.log('----------------------------------UPDATE CLUSTER DONE----------------------------------')\n  return newData.map(({ zoomLevels }) => zoomLevels)\n}\n\nfunction filterData (clusteredData, filterBounds, newZ) {\n  return clusteredData\n    // Filter out anything not relevant to this zoom level\n    .filter(d => !!d[newZ])\n    // Restructure the object to be a little more JSON-friendly\n    .reduce((acc, zoomLevels) => {\n      const geoJSON = zoomLevels[newZ]\n      const coords = geoJSON.geometry.coordinates\n      const { count } = geoJSON.properties\n\n      if (!filterBounds || filterBounds.length < 4 || (\n        filterBounds[0] < coords[0] && filterBounds[1] < coords[1] &&\n        filterBounds[2] > coords[0] && filterBounds[3] > coords[1]\n      )) {\n        if (count > 1) acc.cluster.push(geoJSON)\n        else acc.single.push(geoJSON)\n      }\n      return acc\n    }, {\n      single: [],\n      cluster: []\n    })\n}\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemText from '@material-ui/core/ListItemText'\nimport List from '@material-ui/core/List'\nimport IconButton from '@material-ui/core/IconButton'\nimport CancelIcon from '@material-ui/icons/Cancel'\nimport { endpoints } from '../../../config'\nimport ZoomInIcon from '@material-ui/icons/ZoomIn'\nimport ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction'\n// import MenuIcon from '@material-ui/core/Menu'\nimport { withStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n\n  },\n  img: {\n    maxWidth: '100%'\n  },\n  imgContainer: {\n    width: 100\n  }\n})\n\nconst SeriesSelected = ({ classes, series, loading, onClose, onClick, onZoomTo }) => {\n  if (loading || !series) return 'LOADING...'\n  let thumb = null\n  try {\n    thumb = `${endpoints.cdn}/${series.featured.paths.thumb}`\n  }\n  catch (e) {}\n  return (\n    <List disablePadding dense>\n      <ListItem className={classes.root} button>\n        <div className={classes.imgContainer} onClick={onClick}>\n          <img alt='thumbnail' src={thumb} className={classes.img} />\n        </div>\n        <ListItemText\n          onClick={onClick}\n          primary={series.name || loading}\n          secondary={`${series.photoCount || 0} Photos`}\n        />\n        <ListItemSecondaryAction>\n          <IconButton aria-label='Close' onClick={onZoomTo}>\n            <ZoomInIcon />\n          </IconButton>\n          <IconButton aria-label='Close' onClick={onClose}>\n            <CancelIcon />\n          </IconButton>\n        </ListItemSecondaryAction>\n      </ListItem>\n    </List>\n  )\n}\n\nSeriesSelected.propTypes = {\n  classes: PropTypes.object.isRequired,\n  series: PropTypes.object,\n  loading: PropTypes.bool,\n  onClose: PropTypes.func.isRequired,\n  onClick: PropTypes.func.isRequired,\n  onZoomTo: PropTypes.func.isRequired\n}\n\nexport default withStyles(style)(SeriesSelected)\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemText from '@material-ui/core/ListItemText'\nimport List from '@material-ui/core/List'\nimport IconButton from '@material-ui/core/IconButton'\nimport ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction'\nimport ZoomOutMapIcon from '@material-ui/icons/ZoomOutMap'\nimport CancelIcon from '@material-ui/icons/Cancel'\nimport { withStyles } from '@material-ui/core/styles'\nimport { ListItemIcon } from '@material-ui/core'\n\nconst style = theme => ({\n  root: {\n\n  }\n})\n\nconst ClusterSelected = ({ classes, seriesCount, reducedPhotoCount, onZoomTo, onClose }) => {\n  console.log('cluster selected', { seriesCount, reducedPhotoCount })\n  return (\n    <List>\n      <ListItem className={classes.root}>\n        <ListItemIcon onClick={onZoomTo}>\n          <ZoomOutMapIcon />\n        </ListItemIcon>\n        <ListItemText\n          onClick={onZoomTo}\n          primary={`${seriesCount} Photo series`}\n          secondary={`containing ${reducedPhotoCount} individual photo${reducedPhotoCount === 1 ? '' : 's'}`}\n        />\n        <ListItemSecondaryAction>\n          <IconButton aria-label='Close' onClick={onClose}>\n            <CancelIcon />\n          </IconButton>\n        </ListItemSecondaryAction>\n\n      </ListItem>\n    </List>\n  )\n}\n\nClusterSelected.propTypes = {\n  classes: PropTypes.object.isRequired,\n  seriesCount: PropTypes.number.isRequired,\n  reducedPhotoCount: PropTypes.number.isRequired,\n  onZoomTo: PropTypes.func.isRequired,\n  onClose: PropTypes.func.isRequired\n}\n\nexport default withStyles(style)(ClusterSelected)\n","import React from 'react'\nimport classNames from 'classnames'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport Badge from '@material-ui/core/Badge'\nimport Avatar from '@material-ui/core/Avatar'\nimport PhotoCameraIcon from '@material-ui/icons/PhotoCamera'\nimport { withStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n    color: theme.palette.primary.main,\n    width: 150,\n    position: 'absolute',\n    top: '50%',\n    left: '50%',\n    textAlign: 'center',\n    transformOrigin: '50% 50%',\n    transform: 'translateY(-50%) translateX(-50%)'\n  },\n  rootActive: {\n    zIndex: 1000\n  },\n  icon: {\n    // height: 16,\n    // width: 16\n  },\n  avatar: {\n    position: 'relative',\n    margin: '0 auto',\n    background: 'green',\n    color: 'white',\n    border: '2px solid white',\n    height: 40,\n    width: 40,\n    zIndex: 120\n  },\n  avatarActive: {\n    background: theme.palette.secondary.main,\n    color: theme.palette.secondary.contrastText,\n    border: `2px solid ${theme.palette.secondary.contrastText}`\n  },\n  badge: {\n    zIndex: 124,\n    color: theme.palette.secondary.contrastText,\n    background: theme.palette.secondary.main,\n    transform: 'scale(1) translate(30%, -30%)'\n  },\n  badgeActive: {\n    color: theme.palette.primary.contrastText,\n    background: theme.palette.primary.main\n  },\n  directionIndicator: {\n    position: 'absolute',\n    top: 20,\n    left: '50%',\n    // transformOrigin: '50% 50%',\n    // transform: 'translateY(-50%) translateX(-50%)',\n    zIndex: 100\n  },\n  name: {\n    color: 'white',\n    fontWeight: 'bold',\n    textShadow: `\n        0px 0px 4px #000000, \n        0px 0px 4px #000000 \n    `,\n    zIndex: 122,\n    position: 'relative'\n    // textStroke: '1px white'\n  },\n  nameActive: {\n    color: theme.palette.secondary.dark,\n    textShadow: `\n    0px 0px 2px #FFFFFF, \n    0px 0px 2px #FFFFFF,\n    0px 0px 4px #FFFFFF \n`\n  }\n})\n\nconst Single = ({ classes, name, onClick, active, photoCount, direction }) => {\n  return (\n    <div className={classNames(classes.root, active ? classes.rootActive : null)}>\n      {/* <svg className={classes.icon} focusable='false' viewBox='0 0 24 24' aria-hidden='true' role='presentation'>\n        <path fill='#008800' stroke='#FFFFFF' strokeWidth={4} d='M14.4 6L14 4H5v17h2v-7h5.6l.4 2h7V6z' />\n        <path fill='#008800' stroke='#FFFFFF' strokeWidth={1} d='M14.4 6L14 4H5v17h2v-7h5.6l.4 2h7V6z' />\n      </svg> */}\n      <Badge classes={{ badge: classNames(classes.badge, active ? classes.badgeActive : null) }} badgeContent={photoCount}>\n        <Avatar className={classNames(classes.avatar, active ? classes.avatarActive : null)} onClick={onClick}>\n          <PhotoCameraIcon className={classes.icon} color='inherit' />\n        </Avatar>\n      </Badge>\n      {direction && direction >= 0 ? (\n        <div className={classes.directionIndicator}>\n          <svg className={classes.svgArc}\n            version='1.1'\n            width='100'\n            height='100'\n            viewBox='0, 0, 100, 100'\n            style={{ transform: `translateY(-50%) translateX(-50%) rotateZ(${direction}deg)` }}>\n            <path d='M50,0 C60.946,0.151 72.136,3.514 80.675,10.56 L50,50 L19.325,10.56 C27.938,3.461 39,0.278 50,0 z'\n              fill='#009DC1'\n              fillOpacity='0.444'\n              strokeWidth='0.5'\n              strokeOpacity='0.6'\n              stroke='#FFFFFF'\n            />\n          </svg>\n        </div>\n      ) : null}\n      <Typography variant='body1' className={classNames(classes.name, active ? classes.nameActive : null)}>\n        {name}\n      </Typography>\n    </div>\n  )\n}\n\nSingle.propTypes = {\n  classes: PropTypes.object.isRequired,\n  name: PropTypes.string,\n  photoCount: PropTypes.number,\n  onClick: PropTypes.func.isRequired,\n  direction: PropTypes.number,\n  active: PropTypes.bool\n}\n\nexport default withStyles(style)(Single)\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport Avatar from '@material-ui/core/Avatar'\n\nimport { withStyles } from '@material-ui/core/styles'\nimport numeral from 'numeral'\n\nconst style = theme => ({\n  avatar: {\n    background: theme.palette.primary.dark,\n    border: `2px solid ${theme.palette.primary.contrastText}`,\n    color: theme.palette.primary.contrastText\n  },\n  avatarActive: {\n    background: theme.palette.secondary.main,\n    border: `2px solid ${theme.palette.secondary.contrastText}`,\n    color: theme.palette.secondary.contrastText,\n    zIndex: 1000\n  }\n})\n\nconst Cluster = ({ classes, seriesCount, active, onClick }) => {\n  return (\n    <Avatar onClick={onClick} className={classNames(classes.avatar, active ? classes.avatarActive : null)}>\n      {numeral(seriesCount).format('0,0')}\n    </Avatar>\n  )\n}\n\nCluster.propTypes = {\n  classes: PropTypes.object.isRequired,\n  seriesCount: PropTypes.number,\n  onClick: PropTypes.func.isRequired,\n  active: PropTypes.bool\n}\n\nexport default withStyles(style)(Cluster)\n","\nimport React, { useState, useMemo, useRef, useEffect } from 'react'\nimport PropTypes from 'prop-types'\nimport { FlyToInterpolator, LinearInterpolator, Marker } from 'react-map-gl'\n// import Fab from '@material-ui/core/Fab'\nimport Drawer from '@material-ui/core/Drawer'\n// import IconButton from '@material-ui/core/IconButton'\nimport { easeCubic } from 'd3-ease'\nimport MapStyles from '../../mapStyles'\n\nimport BaseMap from './BaseMap'\nimport useClusteredData from '../../lib/useClusteredData'\nimport { bbox, featureCollection, buffer } from '@turf/turf'\n// import { home } from '../../config'\n\nimport AddIcon from '@material-ui/icons/Add'\n\n// import ZoomOutMapIcon from '@material-ui/icons/ZoomOutMap'\nimport { withStyles } from '@material-ui/core/styles'\n\nimport style from './HomeMap.style'\n\nimport SeriesSelected from './selection/SeriesSelected'\nimport ClusterSelected from './selection/ClusterSelected'\n\nimport SingleMarker from './markers/Single'\nimport ClusterMarker from './markers/Cluster'\nimport AddFab from '../PhotoSeries/views/controls/AddFab'\n\n// const ZoomJurisdictions = {\n//   SERIES: [9, 24],\n//   // REGION: [5, 11],\n//   WORLD: [0, 8]\n// }\n\nconst defaultView = {\n  zoom: 12,\n  latitude: 44.629701,\n  longitude: -120.333379\n}\n\n// const LOCK = {\n//   scrollZoom: false,\n//   dragPan: false,\n//   doubleClickZoom: false,\n//   touchZoom: false,\n//   touchRotate: false,\n//   hideNavControls: true\n// }\n\nconst sizeScale = 80\n\nconst HomeMap = ({\n  classes, seriesList, viewportSave, loading, activeSeries, queryVersion,\n  onCameraClick, onLibraryClick, setActiveSeries, onSeriesClick,\n  popMapHistory, pushMapHistory, clearMapHistory\n}) => {\n  const [mapViewObj, setMapViewObj] = useState({ viewport: { ...defaultView, ...viewportSave.viewport }, filterBounds: null })\n  const [isTransitioning, setIsTransitioning] = useState(false)\n  const mapViewRef = useRef()\n  const homeMapContainerRef = useRef()\n  const [currentZoom, setCurrentZoom] = useState(0)\n  const [transitions, setTransitions] = useState(null)\n\n  const { filteredClusteredData } = useClusteredData(\n    seriesList || [],\n    mapViewObj.filterBounds,\n    currentZoom,\n    mapViewObj.viewport,\n    sizeScale,\n    queryVersion\n  )\n\n  const saveMap = () => {\n    setTimeout(() => pushMapHistory({\n      ...viewportSave,\n      viewport: mapViewRef.current ? mapViewRef.current : mapViewObj.viewport\n    }), 2000)\n  }\n\n  const [selectedItem, setSelectedItem] = useState()\n\n  // If we're coming back to the map with something aleady selected then we need to\n  // reselect the series we had before\n  useEffect(() => {\n    if (!activeSeries || selectedItem) return\n    try {\n      const selected = filteredClusteredData.single.find(obj => obj.properties.id === activeSeries)\n      if (homeMapContainerRef.current) setSelectedItem(selected)\n    }\n    catch (e) {\n      console.error(e)\n    }\n  }, [activeSeries, filteredClusteredData.single])\n\n  const updateSelectedItem = (item) => {\n    // regardless, set the map selected Item\n    setSelectedItem(item)\n    if (item && item.properties && item.properties.count === 1) {\n      setActiveSeries(item.properties.id)\n    }\n    saveMap()\n  }\n\n  const onZoomTo = (object) => {\n    try {\n      const pts = featureCollection(object.properties.points)\n      const bufferPts = buffer(pts, 10, { units: 'meters' })\n      const bounds = bbox(bufferPts)\n      // buffer a further 10%\n      const lngBuff = (bounds[2] - bounds[0]) * 0.2\n      const latBuff = (bounds[3] - bounds[1]) * 0.2\n      const buffBounds = [\n        bounds[0] - lngBuff,\n        bounds[1] - latBuff,\n        bounds[2] + lngBuff,\n        bounds[3] + latBuff\n      ]\n\n      setTransitions({\n        transitionDuration: 2000,\n        transitionInterpolator: new FlyToInterpolator(),\n        transitionEasing: easeCubic\n      })\n      setMapViewObj({ ...mapViewObj, bounds: buffBounds })\n      if (object.properties.count > 1) setTimeout(() => updateSelectedItem(null), 2000)\n    }\n    catch (e) {\n      console.error(e)\n    }\n  }\n\n  const onViewportChange = ({ viewport, map }) => {\n    mapViewRef.current = viewport\n    // mapViewObj\n    // {\n    //   \"_sw\": {\n    //     \"lng\": -120.40788003760076,\n    //     \"lat\": 44.609051464438835\n    //   },\n    //   \"_ne\": {\n    //     \"lng\": -120.25887796240545,\n    //     \"lat\": 44.65034319161438\n    //   }\n    // minX, minY, maxX, maxY\n    // [W-122.87948116236043, S26.15346805640254, E-82.00799782432676, N47.3795453070757]\n    const viewZoom = Math.floor(viewport.zoom)\n    if (map && map.getBounds) {\n      const { _sw: { lng: minLng, lat: minLat }, _ne: { lng: maxLng, lat: maxLat } } = map.getBounds()\n      const [oldMinLng, oldMinLat, oldMaxLng, oldMaxLat] = mapViewObj.filterBounds || [minLng, minLat, maxLng, maxLat]\n      if (viewZoom !== currentZoom ||\n        oldMinLng >= minLng || oldMinLat >= minLat ||\n        oldMaxLng <= maxLng || oldMaxLat <= maxLat\n      ) {\n        // console.log('RECALCING filterBounds')\n        const filterBounds = [\n          minLng - (maxLng - minLng) / 2,\n          minLat - (maxLat - minLat) / 2,\n          maxLng + (maxLng - minLng) / 2,\n          maxLat + (maxLat - minLat) / 2\n        ]\n        setMapViewObj({ ...mapViewObj, filterBounds })\n      }\n    }\n    if (viewZoom !== currentZoom) {\n      setCurrentZoom(viewZoom)\n    }\n  }\n\n  const handleTransitionStart = () => {\n    setIsTransitioning(true)\n  }\n  const handleTransitionEnd = () => {\n    setIsTransitioning(false)\n    setTransitions(null)\n    // setMapViewObj({\n    //   ...mapViewObj,\n    //   viewport: {\n    //     // zoom: currentZoom > 12 ? currentZoom : 12,\n    //     longitude: viewport.longitude,\n    //     latitude: viewport.latitude\n    //   }\n    // })\n    console.log('handletransitionEnd')\n  }\n\n  const lock = {}\n\n  const onMarkerClick = (obj) => {\n    // Second click zooms\n    console.log('OBJ', obj)\n    if (selectedItem &&\n      obj.properties.count > 1 &&\n      selectedItem.properties.id === obj.properties.id\n    ) {\n      onZoomTo(selectedItem)\n    }\n    else {\n      setTransitions({\n        transitionDuration: 500,\n        transitionInterpolator: new LinearInterpolator(),\n        transitionEasing: easeCubic\n      })\n      setMapViewObj({\n        viewport: {\n          longitude: obj.geometry.coordinates[0],\n          latitude: obj.geometry.coordinates[1]\n        }\n      })\n    }\n    updateSelectedItem(obj)\n  }\n\n  const markers = useMemo(() => ([\n    ...filteredClusteredData.single.map(obj => (\n      <Marker\n        className='singleMarker'\n        key={`single-${obj.properties.id}`}\n        latitude={obj.geometry.coordinates[1]}\n        longitude={obj.geometry.coordinates[0]}\n        offsetLeft={0}\n        offsetTop={-20}\n      >\n        <SingleMarker name={obj.properties.name}\n          photoCount={obj.properties.photoCount}\n          onClick={() => onMarkerClick(obj)}\n          direction={currentZoom > 10 && obj.properties.direction ? obj.properties.direction : null}\n          active={selectedItem && selectedItem.properties.id === obj.properties.id}\n        />\n      </Marker>\n    )),\n    ...filteredClusteredData.cluster.map(obj => (\n      <Marker\n        className='clusterMarker'\n        key={`cluster-${obj.properties.id}`}\n        latitude={obj.geometry.coordinates[1]}\n        longitude={obj.geometry.coordinates[0]}\n        offsetLeft={-20}\n        offsetTop={-20}\n      >\n        <ClusterMarker\n          seriesCount={obj.properties.count}\n          photoCount={obj.properties.reducedPhotoCount}\n          onClick={() => onMarkerClick(obj)}\n          active={\n            selectedItem &&\n            selectedItem.properties.id === obj.properties.id &&\n            selectedItem.properties.count === obj.properties.count\n          }\n        />\n      </Marker>\n    ))\n  ]), [filteredClusteredData, selectedItem])\n\n  return (\n    <div className={classes.root} ref={homeMapContainerRef}>\n      <BaseMap\n        showMe\n        viewport={mapViewObj.viewport}\n        transitions={transitions}\n        mapStyles={MapStyles}\n        controlPadding={{ top: 56 }}\n        initStyle={MapStyles.length > 1 ? 1 : 0}\n        {...lock}\n        onTransitionStart={handleTransitionStart}\n        onTransitionEnd={handleTransitionEnd}\n        bounds={mapViewObj.bounds}\n        maxZoom={20}\n        minZoom={1}\n        onViewportChange={onViewportChange}\n        onNativeClick={() => {\n          if (selectedItem) updateSelectedItem(null)\n        }}\n      >\n        {markers}\n      </BaseMap>\n\n      {/* {!selectedItem && viewportSave && viewportSave.mode !== home.MapModeTypes.FREE && (\n        <IconButton aria-label='myLocation' className={classes.zoomOutFab}>\n          <ZoomOutMapIcon />\n        </IconButton>\n      )} */}\n      {!selectedItem && (\n        <AddFab className={classes.fab} onCameraClick={onCameraClick} onLibraryClick={onLibraryClick}>\n          <AddIcon />\n        </AddFab>\n      )}\n      <Drawer\n        anchor='bottom'\n        variant='permanent'\n        open={!!selectedItem}\n        onClose={() => {\n          console.log('onClose', selectedItem)\n        }}\n      >\n        {!!selectedItem && (\n          <div tabIndex={0} role='button'>\n            {selectedItem.properties.count === 1\n              ? <SeriesSelected\n                loading={loading.selectedSeries}\n                series={selectedItem.properties}\n                onClose={() => updateSelectedItem(null)}\n                onZoomTo={() => onZoomTo(selectedItem)}\n                onClick={() => onSeriesClick(selectedItem.properties.id)}\n              />\n              : <ClusterSelected\n                seriesCount={selectedItem.properties.count}\n                reducedPhotoCount={selectedItem.properties.reducedPhotoCount}\n                onClose={() => updateSelectedItem(null)}\n                onZoomTo={() => onZoomTo(selectedItem)}\n              />\n            }\n          </div>\n        )}\n      </Drawer>\n    </div>\n  )\n}\n\nHomeMap.propTypes = {\n  classes: PropTypes.object.isRequired,\n  seriesList: PropTypes.array,\n  queryVersion: PropTypes.number,\n  activeSeries: PropTypes.string,\n  viewportSave: PropTypes.object,\n  loading: PropTypes.object,\n  // These all get loaded up through mapFuncs in HomeMap.connect\n  onCameraClick: PropTypes.func,\n  onLibraryClick: PropTypes.func,\n  setActiveSeries: PropTypes.func,\n  onSeriesClick: PropTypes.func,\n  popMapHistory: PropTypes.func,\n  pushMapHistory: PropTypes.func,\n  clearMapHistory: PropTypes.func\n}\n\nexport default withStyles(style)(HomeMap)\n","export default theme => ({\n  root: {\n    height: '100%',\n    '& .myPosMarker': {\n      zIndex: 1\n    },\n    '& .singleMarker': {\n      zIndex: 3\n    },\n    '& .clusterMarker': {\n      zIndex: 2\n    }\n  },\n  fab: {\n    background: theme.palette.secondary.main,\n    color: theme.palette.secondary.contrastText\n  },\n  zoomOutFab: {\n    margin: theme.spacing.unit / 2,\n    padding: theme.spacing.unit / 2,\n    border: '2px solid',\n    borderRadius: theme.spacing.unit,\n    background: theme.palette.common.white,\n    fontSize: 20,\n    position: 'absolute',\n    zIndex: 100,\n    bottom: theme.spacing.unit * 2,\n    right: theme.spacing.unit * 10\n  },\n  svgDot: {\n    zIndex: 3\n    // position: 'absolute',\n    // transformOrigin: '50% 50%',\n    // transform: 'translateY(-50%) translateX(-50%)'\n  }\n})\n","import React, { useEffect, useState, useRef, useMemo } from 'react'\nimport PropTypes from 'prop-types'\nimport { connect } from 'react-redux'\nimport { graphql } from 'react-apollo'\nimport { allSeries, pollQuery } from './queries'\nimport actions from '../redux/actions'\nimport { home } from '../config'\nimport HomeMap from '../components/maps/HomeMap'\n\nconst POLL_INTERVAL = 5 // (seconds)\n\n/**\n * The outer component handles the lastCheck variable which, when changed will\n * cause the poll event\n */\nconst HomeMapConnector = ({ viewportSave, activeSeries, mapFuncs }) => {\n  const [seriesProps, setSeriesProps] = useState()\n  const [queryVersion, setVersion] = useState(0)\n  const updateIncrement = () => setVersion(queryVersion + 1)\n  const timerRef = useRef()\n  const [lastCheck, setLastCheck] = useState(null)\n  timerRef.current = lastCheck\n\n  // These are expensive queries so we render them memoized to prevent erroneous re-renders\n  const allSeriesQUERY = useMemo(() => <AllSeriesConnect setSeriesProps={setSeriesProps} />, [])\n  const pollSeriesQUERY = useMemo(() => <PollQueryConnect lastCheck={lastCheck} seriesProps={seriesProps} updateIncrement={updateIncrement} />, [lastCheck])\n\n  // Initiate the polling process. We simply update the timestamp every N seconds\n  useEffect(() => {\n    if (!seriesProps) return\n    function ping () {\n      if (timerRef.current) setLastCheck(Date.now() - POLL_INTERVAL * 1000)\n    }\n    if (!timerRef.current && seriesProps.readyForPolling) timerRef.current = setInterval(ping, POLL_INTERVAL * 1000)\n    return () => {\n      if (timerRef.current) {\n        console.log('clear poll timer')\n        clearInterval(timerRef.current)\n        timerRef.current = null\n      }\n    }\n  }, [seriesProps])\n\n  return (\n    <React.Fragment>\n      {allSeriesQUERY}\n      {pollSeriesQUERY}\n      <HomeMap\n        queryVersion={queryVersion}\n        seriesList={seriesProps && seriesProps.allSeries ? seriesProps.allSeries.seriesSummaries : []}\n        activeSeries={activeSeries}\n        viewportSave={viewportSave}\n        loading={{\n        }}\n        {...mapFuncs}\n      />\n    </React.Fragment>\n  )\n}\nHomeMapConnector.propTypes = {\n  activeSeries: PropTypes.string, // from redux\n  viewportSave: PropTypes.object, // from redux\n  mapFuncs: PropTypes.object // from redux passed straight through to the map\n\n}\n\nconst withAllSeries = graphql(allSeries, {\n  props: ({ data, ownProps }) => {\n    // If there's more data to load we should go get another batch\n    if (!data.loading && !data.error && data.allSeries && data.allSeries.seriesSummaries.length > 0 && data.allSeries.nextToken) {\n      data.fetchMore({\n        variables: { ...data.variables, nextToken: data.allSeries.nextToken },\n        // How do we mush the new query with the old one\n        updateQuery: (prev, { fetchMoreResult }) => {\n          return {\n            allSeries: {\n              ...fetchMoreResult.allSeries,\n              seriesSummaries: [ ...prev.allSeries.seriesSummaries, ...fetchMoreResult.allSeries.seriesSummaries ]\n            }\n          }\n        }\n      })\n    }\n    else if (data.loading || data.error) {\n      ownProps.setSeriesProps(data)\n    }\n    else {\n      ownProps.setSeriesProps({ ...data, readyForPolling: true })\n    }\n    return null\n  },\n  options: {\n    variables: { limit: 100 }\n  }\n})\n\n/**\n * Here's the graphql HOC that gets an individual series\n */\nconst withPollQuery = graphql(pollQuery, {\n  skip: ({ lastCheck }) => !lastCheck,\n  props: ({ data, ownProps: { seriesProps, updateIncrement } }) => {\n    if (data.error) console.error(data.error)\n    if (!data.loading && data.changedSeries && data.changedSeries.seriesSummaries) {\n      // console.log('POLLING', { data, seriesProps })\n      const newData = data.changedSeries.seriesSummaries\n      const oldList = seriesProps.allSeries.seriesSummaries\n\n      // If the polling has begun and we have some good polling data back then\n      // Process it and decide if we need to incorporate it\n      if (data.changedSeries) {\n        let newSeriesSummaries = seriesProps.allSeries.seriesSummaries\n        newData.forEach(({ seriesStatus, ...polledSeries }) => {\n          if (seriesStatus === 'deleted') {\n            console.log('Polling found a series to delete: ', polledSeries.id)\n            newSeriesSummaries = oldList.filter(s => s.id !== polledSeries.id)\n          }\n          else {\n            const idx = oldList.findIndex(ds => ds.id === polledSeries.id)\n            if (idx >= 0) {\n              console.log('Polling found a series to Update: ', polledSeries.id)\n              newSeriesSummaries = oldList.map((oldSeries, oldId) => oldId === idx ? polledSeries : oldSeries)\n            }\n            else {\n              console.log('Polling found a series to add: ', polledSeries.id)\n              newSeriesSummaries = [...oldList, polledSeries]\n            }\n          }\n          seriesProps.updateQuery((data, options) => {\n            try {\n              const newData = { ...data }\n              newData.allSeries.seriesSummaries = newSeriesSummaries\n              updateIncrement()\n              return data\n            }\n            catch (e) {\n              console.error(e)\n              return data\n            }\n          })\n        })\n      }\n    }\n    return null\n  },\n  options: ({ lastCheck }) => ({\n    variables: {\n      limit: 100,\n      lastCheck\n    }\n  })\n})\n\n// we're using graphql() HOC because it's convenient but it doesn't need to render anything\nconst AllSeriesConnect = withAllSeries(() => null)\nconst PollQueryConnect = withPollQuery(() => null)\n\n// The only part of the state the main view caes about is teh window\nconst mapStateToProps = (state, props) => {\n  const { activeSeries } = state.home\n  const viewportSave = state.map.slice(-1).pop()\n  return { activeSeries, viewportSave }\n}\n\n// There are a few presentational actions the main window can use\nconst mapDispatchToProps = dispatch => ({\n  mapFuncs: {\n    setActiveSeries: (seriesId) => {\n      dispatch(actions.setActiveSeries(seriesId))\n    },\n    onSeriesClick: () => {\n      dispatch(actions.setHomeState(home.AppStateTypes.SERIES))\n    },\n    onCameraClick: () => {\n      dispatch(actions.setHomeState(home.AppStateTypes.NEW_SERIES_CAMERA))\n      dispatch(actions.setActiveSeries(null))\n    },\n    onLibraryClick: () => {\n      dispatch(actions.setHomeState(home.AppStateTypes.NEW_SERIES_LIBRARY))\n      dispatch(actions.setActiveSeries(null))\n    },\n    popMapHistory: () => {\n      dispatch(actions.popMapHistory())\n    },\n    pushMapHistory: (viewportSave) => {\n      dispatch(actions.pushMapHistory(viewportSave))\n    },\n    clearMapHistory: () => {\n      dispatch(actions.clearMapHistory())\n    }\n  }\n})\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(HomeMapConnector)\n","import { createHttpLink } from 'apollo-link-http'\nimport { setContext } from 'apollo-link-context'\n// import PropTypes from 'prop-types'\nimport { endpoints } from '../config'\nimport { ApolloLink } from 'apollo-link'\nimport { InMemoryCache, ApolloClient } from 'apollo-boost'\n\nconst LOCAL_STORAGE_TOKEN = 'apollo-token'\n/**\n * Helper function to create our Apollo Client object\n * @param {*} token\n */\nexport function createApolloClient (token = '') {\n  // Set up our headers for authentication through graphql\n  const cache = new InMemoryCache()\n\n  // The auth link is just used to decorate our HTTP headers with authentication data\n  const authLink = setContext((_, { headers }) => ({\n    headers: {\n      ...headers,\n      authorization: token ? `Bearer ${token}` : ''\n    }\n  }))\n\n  // HTTP link creates the network connection to our graphql host\n  const httpLink = createHttpLink({ uri: endpoints.graphql })\n  console.log('Creating Apollo Client Client', endpoints.graphql, token ? 'TOKEN PROVIDED' : 'NO TOKEN')\n\n  const apolloClient = new ApolloClient({\n    link: ApolloLink.from([authLink, httpLink]),\n    tokenName: LOCAL_STORAGE_TOKEN,\n    cache,\n    connectToDevTools: true\n  })\n\n  // Now put it all together\n  return apolloClient\n}\n\n// Note: this method comes from isntructions here:\n// https://www.apollographql.com/docs/react/recipes/authentication.html\n// export const withApollo = compose(\n//   lifecycle({\n//     shouldComponentUpdate (nextProps) {\n//       const { authStore: { jwtToken: oldToken } } = nextProps\n//       const { authStore: { jwtToken: newToken } } = this.props\n//       if (newToken === oldToken) {\n//         return true\n//       }\n//       return true\n//     }\n//   }),\n//   withWrapClient\n// )\n","// https://medium.com/@shalkam/create-react-app-i18n-the-easy-way-b05536c594cb\nimport React, { useContext } from 'react'\nimport PropTypes from 'prop-types'\nimport { IntlProvider, addLocaleData } from 'react-intl'\nimport frLocaleData from 'react-intl/locale-data/fr'\n\naddLocaleData(frLocaleData)\n\nexport const IntlContext = React.createContext({})\n\n// the format message hook\nexport const useIntl = () => {\n  const intl = useContext(IntlContext)\n  return intl.formatMessage\n}\n\nexport const IntlWrapper = ({ children }) => (\n  <IntlProvider locale='en'>\n    {children}\n  </IntlProvider>\n)\nIntlWrapper.propTypes = {\n  children: PropTypes.any\n}\n","export default theme => ({\n  root: {\n  },\n  spacer: {\n    flexGrow: 1\n  },\n  forgotPassword: {\n    width: '100%',\n    textAlign: 'right'\n  },\n  switch: {\n\n  },\n  switchButton: {\n    flexGrow: 1,\n    '&:last-child': {\n      borderRadius: 0\n    },\n    '&:first-child': {\n      borderRadius: 0\n    }\n  },\n  phoneNumInner: {\n    marginTop: theme.spacing.unit,\n    display: 'flex'\n    // border: '1px solid red'\n  },\n  phoneNumDropdown: {\n    margin: theme.spacing.unit,\n    minWidth: 120\n  }\n})\n","import { useRef, useEffect } from 'react'\n\nconst useAuthCommon = () => {\n  const containerRef = useRef()\n  const handleKeyPress = (event) => {\n    if (event.key === 'Enter') {\n      if (containerRef.current) {\n        try {\n          const found = containerRef.current.getElementsByClassName('enterAction')\n          if (found && found[0]) found[0].click()\n        }\n        catch (e) {\n          console.error('useAuthCommon::handleKeyPress', e)\n        }\n      }\n    }\n  }\n  useEffect(() => {\n    if (containerRef.current) {\n      try {\n        document.addEventListener('keypress', handleKeyPress, false)\n      }\n      catch (e) {\n        console.error('useAuthCommon::useEffect', e)\n      }\n      return () => document.removeEventListener('keypress', handleKeyPress, false)\n    }\n  }, [])\n\n  return containerRef\n}\n\nexport default useAuthCommon\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport { withStyles } from '@material-ui/core/styles'\n// import style from './auth.style'\nimport useAuthCommon from './useAuthCommon'\n\nconst style = theme => ({\n  root: {\n    height: '100%'\n  },\n  bgSwoosh: {\n    width: '100%',\n    height: '100%',\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    zIndex: 0\n  },\n  inner: {\n    width: '100%',\n    minWidth: 200,\n    maxWidth: 300,\n    position: 'absolute',\n    zIndex: 2,\n    textAlign: 'center',\n    top: '50%',\n    left: '50%',\n    transformOrigin: '50% 50%',\n    transform: 'translateY(-50%) translateX(-50%)'\n  },\n  bgSwooshFill: {\n    fill: theme.palette.primary.light\n  }\n})\n\nconst AuthContainer = ({ classes, children }) => {\n  const containerRef = useAuthCommon()\n  return (\n    <div ref={containerRef} className={classes.root}>\n      <CssBaseline />\n      {/* Look for: LoginSwoosh.svg */}\n      <svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 500 500' preserveAspectRatio='none' className={classes.bgSwoosh}>\n        <path className={classes.bgSwooshFill} d=' M 0 0 L 500 0 C 500 209.782 489.956 180 250 180 C 10.044 180 0 219.954 0 370 L 0 0 Z ' />\n      </svg>\n\n      <div className={classes.inner}>\n        {/* Look for: Logo.svg */}\n        <img alt='logo' src={`${process.env.PUBLIC_URL}/icons/Logo.svg`} />\n        <Typography variant='h5'>App Name Here</Typography>\n        {children}\n      </div>\n    </div>\n  )\n}\n\nAuthContainer.propTypes = {\n  classes: PropTypes.object.isRequired,\n  children: PropTypes.any\n}\n\nexport default withStyles(style)(AuthContainer)\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport TextField from '@material-ui/core/TextField'\nimport Button from '@material-ui/core/Button'\nimport Link from '@material-ui/core/Link'\nimport Toolbar from '@material-ui/core/Toolbar'\n// import MenuIcon from '@material-ui/core/Menu'\nimport { FederatedButtons } from 'aws-amplify-react'\nimport { withStyles } from '@material-ui/core/styles'\nimport style from './auth.style'\nimport AuthContainer from './AuthContainer'\n\nconst SignIn = ({ classes, loading, signIn,\n  handleSignup, federated,\n  handleForgotPassword,\n  handleInputChange,\n  handleSignIn, ...props }) => {\n  return (\n    <AuthContainer>\n      {/* {props.federated && (\n        <FederatedButtons {...props} />\n      )} */}\n      <TextField\n        id='username'\n        fullWidth\n        key='username'\n        name='username'\n        label='Username'\n        autoFocus\n        className={classes.textField}\n        margin='normal'\n        onChange={handleInputChange}\n      />\n      <TextField\n        fullWidth\n        id='password'\n        label='Password'\n        key='password'\n        name='password'\n        type='password'\n        className={classes.textField}\n        autoComplete='current-password'\n        margin='normal'\n        onChange={handleInputChange}\n      />\n      <Link component='button' variant='body2' className={classes.forgotPassword} disabled={loading} onClick={handleForgotPassword}>\n          Forgot Password\n      </Link>\n      <Toolbar disableGutters>\n\n        <Button component='button' color='secondary' variant='contained' disabled={loading} onClick={handleSignup}>\n          New Account\n        </Button>\n        <div className={classes.spacer} />\n        <Button\n          className='enterAction'\n          component='button'\n          color='primary'\n          variant='contained'\n          disabled={loading}\n          onClick={handleSignIn}\n        >\n          Sign In\n        </Button>\n      </Toolbar>\n    </AuthContainer>\n  )\n}\n\nSignIn.propTypes = {\n  classes: PropTypes.object.isRequired,\n  loading: PropTypes.bool,\n  handleForgotPassword: PropTypes.func.isRequired,\n  handleInputChange: PropTypes.func.isRequired,\n  handleSignIn: PropTypes.func.isRequired\n}\n\nexport default withStyles(style)(SignIn)\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport TextField from '@material-ui/core/TextField'\nimport Button from '@material-ui/core/Button'\nimport Toolbar from '@material-ui/core/Toolbar'\n// import MenuIcon from '@material-ui/core/Menu'\nimport { withStyles } from '@material-ui/core/styles'\nimport style from './auth.style'\nimport AuthContainer from './AuthContainer'\n\nconst ConfirmSignIn = ({ classes, handleInputChange, handleBack, handleConfirm }) => {\n  return (\n    <AuthContainer>\n      <TextField\n        id='mfaCode'\n        fullWidth\n        autoFocus\n        label='MFA Code'\n        name='code'\n        className={classes.textField}\n        margin='normal'\n        onChange={handleInputChange}\n      />\n\n      <Toolbar disableGutters>\n        <Button color='secondary' variant='contained' onClick={handleBack}>\n          Back\n        </Button>\n        <div className={classes.spacer} />\n        <Button\n          className='enterAction'\n          color='primary'\n          variant='contained'\n          onClick={handleConfirm}\n        >\n          Confirm\n        </Button>\n      </Toolbar>\n    </AuthContainer>\n  )\n}\n\nConfirmSignIn.propTypes = {\n  classes: PropTypes.object.isRequired,\n  handleInputChange: PropTypes.func.isRequired,\n  handleBack: PropTypes.func.isRequired,\n  handleConfirm: PropTypes.func.isRequired\n}\n\nexport default withStyles(style)(ConfirmSignIn)\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport TextField from '@material-ui/core/TextField'\nimport Button from '@material-ui/core/Button'\nimport Typography from '@material-ui/core/Typography'\nimport Toolbar from '@material-ui/core/Toolbar'\n\nimport { withStyles } from '@material-ui/core/styles'\nimport style from './auth.style'\nimport AuthContainer from './AuthContainer'\n\nconst RequireNewPassword = ({ classes, change, requiredAttributes, placeholders, handleInputChange }) => {\n  return (\n    <AuthContainer>\n      <Typography>A new password is required</Typography>\n      <TextField\n        id='newassword'\n        fullWidth\n        autoFocus\n        label='New Password'\n        className={classes.textField}\n        type='password'\n        autoComplete='new-password'\n        margin='normal'\n        onChange={handleInputChange}\n      />\n      {requiredAttributes\n        .map((attribute, idx) => (\n          <TextField\n            fullWidth\n            key={attribute}\n            name={attribute}\n            className={classes.textField}\n            placeholder={placeholders[idx]}\n            type='text'\n            margin='normal'\n            onChange={handleInputChange}\n          />\n        ))}\n\n      <Toolbar disableGutters>\n\n        <Button color='secondary' variant='contained'>\n          Back\n        </Button>\n        <div className={classes.spacer} />\n        <Button\n          color='primary'\n          variant='contained'\n          onClick={change}\n          className='enterAction'\n        >\n          Change\n        </Button>\n      </Toolbar>\n    </AuthContainer>\n  )\n}\n\nRequireNewPassword.propTypes = {\n  classes: PropTypes.object.isRequired,\n  change: PropTypes.func.isRequired,\n  handleInputChange: PropTypes.func.isRequired,\n  requiredAttributes: PropTypes.array,\n  placeholders: PropTypes.array\n}\n\nexport default withStyles(style)(RequireNewPassword)\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\nimport TextField from '@material-ui/core/TextField'\nimport Button from '@material-ui/core/Button'\nimport Toolbar from '@material-ui/core/Toolbar'\nimport FormControl from '@material-ui/core/FormControl'\nimport InputLabel from '@material-ui/core/InputLabel'\nimport Select from '@material-ui/core/Select'\nimport AuthContainer from './AuthContainer'\n\n// import MenuIcon from '@material-ui/core/Menu'\nimport { withStyles } from '@material-ui/core/styles'\nimport style from './auth.style'\n// import AuthPhoneNum from './AuthPhoneNum'\n\nconst SignUp = ({ classes, handleInputChange, signUpFields, signUpFieldLabels, signUpFieldPlaceholders,\n  handleSignup, handleBack, countryDialCodes, defaultDialCode }) => {\n  console.log('SIGNUPPROPS', { defaultDialCode, countryDialCodes, signUpFields, signUpFieldLabels, signUpFieldPlaceholders })\n  const [selectVal, setSelectVal] = useState(defaultDialCode)\n\n  const handleDialCodeChange = e => {\n    handleInputChange(e)\n    setSelectVal(e.target.value)\n  }\n  return (\n    <AuthContainer>\n      {\n        signUpFields.map((field, idx) => {\n          return field.key !== 'phone_number' ? (\n            <TextField\n              fullWidth\n              autoFocus={signUpFields.findIndex(f => f.key === field.key) === 0}\n              type={field.type}\n              name={field.key}\n              key={field.key}\n              placeholder={signUpFieldPlaceholders[idx]}\n              label={signUpFieldLabels[idx]}\n              className={classes.textField}\n              margin='normal'\n              onChange={handleInputChange}\n            />\n          ) : (\n            <FormControl\n              className={classes.phoneNumDropdown}\n              fullWidth\n              key='phonenum'\n            >\n              <InputLabel htmlFor='dial_code' shrink>\n                {signUpFieldLabels[idx]}\n                {field.required ? '*' : ''}\n              </InputLabel>\n              <div className={classes.phoneNumInner}>\n                <Select\n                  value={selectVal}\n                  onChange={handleDialCodeChange}\n                  inputProps={{\n                    name: 'dial_code',\n                    id: 'dial_code'\n                  }}\n                >\n                  {countryDialCodes.map(dialCode =>\n                    <option key={dialCode} value={dialCode}>\n                      {dialCode}\n                    </option>\n                  )}\n                </Select>\n                <TextField\n                  placeholder={signUpFieldPlaceholders[idx]}\n                  type='tel'\n                  fullWidth\n                  id='phone_line_number'\n                  key='phone_line_number'\n                  name='phone_line_number'\n                  onChange={handleInputChange}\n                />\n              </div>\n            </FormControl>\n          )\n        })\n      }\n      <Toolbar disableGutters>\n        <Button color='secondary' variant='outlined' onClick={handleBack}>\n          Back\n        </Button>\n        <div className={classes.spacer} />\n        <Button\n          className='enterAction'\n          component='button'\n          color='primary'\n          variant='contained'\n          onClick={handleSignup}\n        >\n          Create Account\n        </Button>\n      </Toolbar>\n    </AuthContainer>\n  )\n}\n\nSignUp.propTypes = {\n  classes: PropTypes.object.isRequired,\n  handleInputChange: PropTypes.func.isRequired,\n  signUpFields: PropTypes.array.isRequired,\n  signUpFieldLabels: PropTypes.array.isRequired,\n  signUpFieldPlaceholders: PropTypes.array.isRequired,\n  countryDialCodes: PropTypes.array.isRequired,\n  defaultDialCode: PropTypes.string.isRequired,\n  handleSignup: PropTypes.func.isRequired,\n  handleBack: PropTypes.func.isRequired\n}\n\nexport default withStyles(style)(SignUp)\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\n// import MenuIcon from '@material-ui/core/Menu'\nimport { withStyles } from '@material-ui/core/styles'\nimport style from './auth.style'\nimport AuthContainer from './AuthContainer'\nimport { Typography } from '@material-ui/core'\n\nconst Loading = ({ classes }) => {\n  return (\n    <AuthContainer>\n      <Typography variant='h3'>Loading...</Typography>\n    </AuthContainer>\n  )\n}\n\nLoading.propTypes = {\n  classes: PropTypes.object.isRequired\n}\n\nexport default withStyles(style)(Loading)\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport TextField from '@material-ui/core/TextField'\nimport Button from '@material-ui/core/Button'\nimport Link from '@material-ui/core/Link'\nimport Toolbar from '@material-ui/core/Toolbar'\n// import MenuIcon from '@material-ui/core/Menu'\nimport { withStyles } from '@material-ui/core/styles'\nimport style from './auth.style'\nimport AuthContainer from './AuthContainer'\n\nconst ConfirmSignUp = ({ classes, handleInputChange, handleBack, handleResend, handleConfirm }) => {\n  return (\n    <AuthContainer>\n      <TextField\n        id='username'\n        fullWidth\n        autoFocus\n        name='username'\n        label='Username'\n        className={classes.textField}\n        margin='normal'\n        onChange={handleInputChange}\n      />\n      <TextField\n        id='confirmationCode'\n        fullWidth\n        name='code'\n        label='Confirmation Code'\n        className={classes.textField}\n        margin='normal'\n        onChange={handleInputChange}\n\n      />\n      <Link component='button' variant='body2' className={classes.resendCode} onClick={handleResend}>\n          Resend Code\n      </Link>\n      <Toolbar disableGutters>\n\n        <Button color='secondary' variant='outlined' onClick={handleBack}>\n          Back\n        </Button>\n        <div className={classes.spacer} />\n        <Button\n          color='primary'\n          variant='contained'\n          className='enterAction'\n          onClick={handleConfirm}\n        >\n          Sign In\n        </Button>\n      </Toolbar>\n    </AuthContainer>\n  )\n}\n\nConfirmSignUp.propTypes = {\n  classes: PropTypes.object.isRequired,\n  handleInputChange: PropTypes.func.isRequired,\n  handleBack: PropTypes.func.isRequired,\n  handleResend: PropTypes.func.isRequired,\n  handleConfirm: PropTypes.func.isRequired\n}\n\nexport default withStyles(style)(ConfirmSignUp)\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\nimport Link from '@material-ui/core/Link'\nimport TextField from '@material-ui/core/TextField'\nimport Typography from '@material-ui/core/Typography'\nimport Button from '@material-ui/core/Button'\n\nimport Toolbar from '@material-ui/core/Toolbar'\n\nimport { withStyles } from '@material-ui/core/styles'\nimport style from './auth.style'\nimport AuthContainer from './AuthContainer'\n\nconst ForgotPassword = ({ classes, handleSubmit, handleInputChange, handleSendCode, handleBack }) => {\n  const [sent, setSent] = useState(false)\n  return (\n    <AuthContainer>\n      <Typography>Forgot Password</Typography>\n      {!sent && (\n        <TextField\n          id='username'\n          autoFocus\n          fullWidth\n          label='Username'\n          name='username'\n          className={classes.textField}\n          margin='normal'\n          onChange={handleInputChange}\n        />\n      )}\n      {sent && (\n        <TextField\n          id='changecode'\n          fullWidth\n          autoFocus\n          label='Code'\n          name='code'\n          className={classes.textField}\n          margin='normal'\n          onChange={handleInputChange}\n        />\n      )}\n      {sent && (\n        <TextField\n          id='newpassword'\n          fullWidth\n          label='New Password'\n          className={classes.textField}\n          type='password'\n          name='password'\n          autoComplete='current-password'\n          margin='normal'\n          onChange={handleInputChange}\n        />\n      )}\n      {sent && (\n        <Link component='button' variant='body2' className={classes.resendCode} onClick={handleSendCode}>\n          Resend Code\n        </Link>\n\n      )}\n      <Toolbar disableGutters>\n        <Button\n          color='secondary'\n          variant='outlined'\n          onClick={() => {\n            sent ? setSent(false) : handleBack()\n          }}\n        >\n          Back\n        </Button>\n        <div className={classes.spacer} />\n        {!sent && (\n          <Button\n            color='primary'\n            variant='contained'\n            className='enterAction'\n            onClick={() => {\n              setSent(true)\n              handleSendCode()\n            }}\n          >\n          Send Code\n          </Button>\n        )}\n        {sent && (\n          <Button\n            className='enterAction'\n            color='primary'\n            variant='contained'\n            onClick={handleSubmit}\n          >\n          Submit\n          </Button>\n        )}\n      </Toolbar>\n    </AuthContainer>\n  )\n}\n\nForgotPassword.propTypes = {\n  classes: PropTypes.object.isRequired,\n  handleSubmit: PropTypes.func.isRequired,\n  handleInputChange: PropTypes.func.isRequired,\n  handleSendCode: PropTypes.func.isRequired,\n  handleBack: PropTypes.func.isRequired\n}\n\nexport default withStyles(style)(ForgotPassword)\n","import React, { useState } from 'react'\nimport Amplify, { Auth } from 'aws-amplify'\nimport { I18n, ConsoleLogger as Logger } from '@aws-amplify/core'\nimport countryDialCodes from 'aws-amplify-react/dist/Auth/common/country-dial-codes'\nimport {\n  Authenticator,\n  SignIn as SignInOrig,\n  SignUp as SignUpOrig,\n  ConfirmSignIn as ConfirmSignInOrig,\n  ConfirmSignUp as ConfirmSignUpOrig,\n  RequireNewPassword as RequireNewPasswordOrig,\n  Loading as LoadingOrig,\n  VerifyContact as VerifyContactOrig,\n  ForgotPassword as ForgotPasswordOrig\n} from 'aws-amplify-react'\n\nimport CompSignIn from '../components/auth/SignIn'\nimport CompConfirmSignIn from '../components/auth/ConfirmSignIn'\nimport CompRequireNewPassword from '../components/auth/RequireNewPassword'\nimport CompSignUp from '../components/auth/SignUp'\nimport CompLoading from '../components/auth/Loading'\nimport CompConfirmSignUp from '../components/auth/ConfirmSignUp'\n// import CompVerifyContact from '../components/auth/VerifyContact'\nimport CompForgotPassword from '../components/auth/ForgotPassword' // or 'aws-amplify-react-native';\nimport { aws } from '../config'\n\nAmplify.configure(aws)\n\nconst useAuthentication = () => {\n  const [{ authState, authData }, setAuth] = useState({ authState: 'init', authData: {} })\n\n  const signedIn = (authState === 'signedIn')\n  const handleAuthStateChange = (state, data) => {\n    setAuth({ authState: state, authData: data })\n  }\n\n  const signOut = () => Auth.signOut()\n    .then(data => console.log(data))\n    .catch(err => console.log(err))\n\n  const authScreen = signedIn ? null\n    : <Authenticator onStateChange={handleAuthStateChange} hideDefault>\n      <SignIn />\n      <Loading />\n      <RequireNewPassword />\n      {/* <RequireNewPasswordOrig /> */}\n      <ConfirmSignIn />\n      <ConfirmSignUp />\n      {/* <VerifyContact /> NOT READY */}\n      <VerifyContactOrig />\n      <ForgotPassword />\n      <SignUp />\n      {/* <SignUpOrig /> */}\n    </Authenticator>\n\n  let accessToken = null\n  try {\n    if (signedIn) accessToken = authData.signInUserSession.accessToken.jwtToken\n    // console.log(`ACCESS TOKEN ${eqSpacer}\\n${accessToken}\\n/ACCESS TOKEN ${eqSpacer}`)\n  }\n  catch (e) {\n    console.error(e)\n  }\n\n  return {\n    authState,\n    authData,\n    signOut,\n    signedIn,\n    accessToken,\n    authScreen\n  }\n}\n\nexport default useAuthentication\n\nclass SignIn extends SignInOrig {\n  showComponent () {\n    const { loading } = this.state\n    const newProps = {\n      ...this.props,\n      loading,\n      handleForgotPassword: () => this.changeState('forgotPassword'),\n      handleSignup: () => this.changeState('signUp'),\n      handleInputChange: this.handleInputChange,\n      handleSignIn: this.signIn\n    }\n    return <CompSignIn {...newProps} />\n  }\n}\n\nclass SignUp extends SignUpOrig {\n  showComponent () {\n    const { hide } = this.props\n    if (hide && hide.includes(SignUp)) {\n      return null\n    }\n    if (this.checkCustomSignUpFields()) {\n      this.signUpFields = this.props.signUpConfig.signUpFields\n    }\n    this.sortFields()\n\n    const newProps = {\n      ...this.props,\n      countryDialCodes,\n      defaultDialCode: this.getDefaultDialCode(),\n      handleInputChange: this.handleInputChange,\n      signUpFields: this.signUpFields,\n      signUpFieldLabels: this.signUpFields.map(field => I18n.get(field.label)),\n      signUpFieldPlaceholders: this.signUpFields.map(field => I18n.get(field.placeholder)),\n      handleSignup: this.signUp,\n      handleBack: () => this.changeState('signIn')\n    }\n    return <CompSignUp {...newProps} />\n  }\n}\n\nclass ConfirmSignIn extends ConfirmSignInOrig {\n  showComponent () {\n    const newProps = {\n      ...this.props,\n      handleBack: () => this.changeState('signIn'),\n      handleInputChange: this.handleInputChange,\n      handleConfirm: this.confirm\n    }\n    return <CompConfirmSignIn {...newProps} />\n  }\n}\n\nclass ConfirmSignUp extends ConfirmSignUpOrig {\n  showComponent () {\n    const newProps = {\n      ...this.props,\n      handleBack: () => this.changeState('signIn'),\n      handleInputChange: this.handleInputChange,\n      handleConfirm: this.confirm,\n      handleResend: this.resend\n    }\n    return <CompConfirmSignUp {...newProps} />\n  }\n}\n\nclass RequireNewPassword extends RequireNewPasswordOrig {\n  showComponent () {\n    const user = this.props.authData\n    const { requiredAttributes } = user.challengeParam\n    const placeholders = Array.isArray(requiredAttributes)\n      ? requiredAttributes.map(attribute => I18n.get(convertToPlaceholder(attribute)))\n      : []\n\n    const newProps = {\n      ...this.props,\n      handleInputChange: this.handleInputChange,\n      requiredAttributes,\n      placeholders,\n      change: this.change\n    }\n    return <CompRequireNewPassword {...newProps} />\n  }\n}\n\nclass Loading extends LoadingOrig {\n  showComponent () {\n    return <CompLoading {...this.props} />\n  }\n}\n// class VerifyContact extends VerifyContactOrig {\n//   showComponent () {\n//     const user = this.props.authData\n//     if (!user) {\n//       verifyLogger.debug('no user for verify')\n//       return null\n//     }\n//     const { unverified } = user\n//     if (!unverified) {\n//       verifyLogger.debug('no unverified on user')\n//       return null\n//     }\n//     const { email, phoneNumber } = unverified\n\n//     const { authData } = this.props\n//     const newProps = {\n//       ...this.props,\n//       handleInputChange: this.handleInputChange,\n//       handleSkip: () => this.changeState('signedIn', authData),\n//       handleVerify: this.verify,\n//       handleSubmit: this.submit\n//     }\n//     return <CompVerifyContact {...newProps} />\n//   }\n// }\nclass ForgotPassword extends ForgotPasswordOrig {\n  showComponent () {\n    const newProps = {\n      ...this.props,\n      handleBack: () => this.changeState('signIn'),\n      handleInputChange: this.handleInputChange,\n      handleConfirm: this.confirm,\n      handleResend: this.send,\n      handleSubmit: this.submit,\n      handleSendCode: this.send\n    }\n    return <CompForgotPassword {...newProps} />\n  }\n}\n\nconst verifyLogger = new Logger('VerifyContact')\n\nfunction convertToPlaceholder (str) {\n  return str.split('_').map(part => part.charAt(0).toUpperCase() + part.substr(1).toLowerCase()).join(' ')\n}\n\nconst eqSpacer = '==============================================================='\n","import React, { useMemo } from 'react'\nimport PropTypes from 'prop-types'\nimport Home from './views/Home'\nimport CssBaseline from '@material-ui/core/CssBaseline'\n\nimport UploaderConnect from './graphql/Uploader.connect'\nimport SeriesConnect from './graphql/Series.connect'\nimport HomeMapConnect from './graphql/HomeMap.connect'\n\nimport { connect } from 'react-redux'\nimport { ApolloProvider } from 'react-apollo'\nimport { createApolloClient } from './lib/useGraphQL'\nimport { IntlWrapper } from './translations'\n\nimport actions from './redux/actions'\nimport useAuthentication from './lib/useAuthentication'\n\nimport { AppContext } from './contexts'\nimport { home as homeConfig } from './config'\n// Here's our global overrides css\nimport './App.css'\n\n/**\n * This is the over-arching wrapper for the app. It combines all the\n * necessary pieces like authentication, context and Apollo\n *\n * Use this to set app-wide context. Hopefully we can do this and leave redux out of the loop for now.\n *\n * Also for now I'm trying to put all the HOC and top-level wrapping in the\n * same place. Time will tell if that's a good strategy.\n * @param {*} param0\n */\n\nconst App = ({ currentState, setHomeState }) => {\n  const { signedIn, authData, signOut, authScreen, accessToken } = useAuthentication()\n\n  // This is the root node that basically says \"Do a React here\"\n  const apolloClient = useMemo(() => createApolloClient(accessToken), [accessToken])\n\n  if (!signedIn) return authScreen\n\n  // These are the things the rest of the app needs to find:\n  const appContext = {\n    signOut,\n    signedIn,\n    currentUser: authData\n  }\n\n  return (\n    <ApolloProvider client={apolloClient}>\n      <IntlWrapper>\n        <AppContext.Provider value={appContext}>\n          <CssBaseline /> {/* You only need this in a root element. Don't put it anywhere else in the dom */}\n          <div style={{ height: '100%', display: 'flex', flexDirection: 'column' }}>\n            <div style={{ flexGrow: 1, overflow: 'hidden' }}>\n              {[\n                homeConfig.AppStateTypes.MAP,\n                homeConfig.AppStateTypes.LIST,\n                homeConfig.AppStateTypes.USER\n              ].indexOf(currentState) > -1 && (\n                <Home currentState={currentState} setHomeState={setHomeState}>\n                  {currentState === homeConfig.AppStateTypes.MAP && (\n                    <HomeMapConnect />\n                  )}\n                  {currentState === homeConfig.AppStateTypes.LIST && (\n                    <div>LIST</div>\n                  )}\n                  {currentState === homeConfig.AppStateTypes.USER && (\n                    <div>USER</div>\n                  )}\n                </Home>\n              )}\n              {[\n                homeConfig.AppStateTypes.SERIES,\n                homeConfig.AppStateTypes.NEW_SERIES_CAMERA,\n                homeConfig.AppStateTypes.NEW_SERIES_LIBRARY\n              ].indexOf(currentState) > -1 && (\n                <SeriesConnect authData={authData} />\n              )}\n            </div>\n            {/* Uploader is persistent across all views */}\n            <div style={{ zIndex: 2000, flexGrow: 0 }}>\n              <UploaderConnect />\n            </div>\n          </div>\n\n        </AppContext.Provider>\n      </IntlWrapper>\n    </ApolloProvider>\n\n  )\n}\n\nApp.propTypes = {\n  // From Redux\n  currentState: PropTypes.string.isRequired,\n  setHomeState: PropTypes.func.isRequired\n}\n\n/**\n * Map our redux state and functions\n */\nconst mapStateToProps = (state, props) => {\n  const { currentState } = state.home\n  return { currentState }\n}\n\nconst mapDispatchToProps = dispatch => ({\n  setHomeState: (newState) => {\n    dispatch(actions.setHomeState(newState))\n  }\n})\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(App)\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n)\n\nexport function register (config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href)\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config)\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\n          )\n        })\n      }\n      else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config)\n      }\n    })\n  }\n}\n\nfunction registerValidSW (swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing\n        if (installingWorker == null) {\n          return\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n              )\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration)\n              }\n            }\n            else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.')\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration)\n              }\n            }\n          }\n        }\n      }\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error)\n    })\n}\n\nfunction checkValidServiceWorker (swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type')\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload()\n          })\n        })\n      }\n      else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config)\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      )\n    })\n}\n\nexport function unregister () {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister()\n    })\n  }\n}\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport App from './App'\n\nimport * as serviceWorker from './serviceWorker'\n\nimport { Provider as ReduxProvider } from 'react-redux'\nimport reduxStore from './redux/store'\n\nrequire('typeface-roboto')\n\n// WE need the redux store first because our App needs its state\nReactDOM.render(\n  <ReduxProvider store={reduxStore()}>\n    <App />\n  </ReduxProvider>\n  , document.getElementById('root'))\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.register()\n\n/**\n * Everything below here is about the prompt for installing a PWA\n */\n\nfunction addToHomeScreen () {\n  const a2hsBtn = document.querySelector('.ad2hs-prompt') // hide our user interface that shows our A2HS button\n  a2hsBtn.style.display = 'none' // Show the prompt\n  deferredPrompt.prompt() // Wait for the user to respond to the prompt\n  deferredPrompt.userChoice\n    .then(choiceResult => {\n      if (choiceResult.outcome === 'accepted') console.log('User accepted the A2HS prompt')\n      else console.log('User dismissed the A2HS prompt')\n\n      deferredPrompt = null\n    })\n}\n\nfunction showAddToHomeScreen () {\n  const a2hsBtn = document.querySelector('.ad2hs-prompt')\n  a2hsBtn.style.display = 'block'\n  a2hsBtn.addEventListener('click', addToHomeScreen)\n}\n\nlet deferredPrompt\nwindow.addEventListener('beforeinstallprompt', e => {\n  // Prevent Chrome 67 and earlier from automatically showing the prompt\n  e.preventDefault()\n  // Stash the event so it can be triggered later.\n  deferredPrompt = e\n\n  showAddToHomeScreen()\n})\n\n// Detects if device is on iOS\nconst isIos = () => {\n  const userAgent = window.navigator.userAgent.toLowerCase()\n  return /iphone|ipad|ipod/.test(userAgent)\n}\n// Detects if device is in standalone mode\nconst isInStandaloneMode = () => ('standalone' in window.navigator) && (window.navigator.standalone)\n\n// Checks if should display install popup notification:\nif (isIos() && !isInStandaloneMode()) {\n  console.log('I AM on IOS and I am NOT in standalone mode.')\n  // this.setState({ showInstallMessage: true })\n}\n","import { Actions } from '../actions'\nimport { home } from '../../config'\nconst mapInit = [\n  {\n    mode: home.MapModeTypes.FREE,\n    viewport: {\n      // 'latitude': 49.2707848, // vancouver\n      // 'longitude': -123.0714866,\n      latitude: 36.80191008366581, // Grand Canyon\n      longitude: -111.63999999999784,\n      zoom: 11\n    }\n  }\n]\n\nexport default (state = mapInit, action) => {\n  const { type, data } = action\n\n  switch (type) {\n    case Actions.MAP_HISTORY_CLEAR:\n      const newClearerHistory = state.length > 0 ? [[state.length - 1]] : []\n      return newClearerHistory\n\n    case Actions.MAP_HISTORY_POP:\n      return state.slice(0, -1)\n\n    case Actions.MAP_HISTORY_PUSH:\n      return [...state, data]\n    default:\n      return state\n  }\n}\n","import { Actions } from '../actions'\nimport { home } from '../../config'\n\nconst homeInit = {\n  stateHistory: [],\n  // currentState: home.AppStateTypes.SERIES,\n  currentState: home.AppStateTypes.MAP\n  // activeSeries: 'fda17bae-0335-4f0d-9065-dc8d7aa23ed1'\n}\n\nexport default (state = homeInit, action) => {\n  const { type, data } = action\n  const { stateHistory, currentState } = state\n\n  switch (type) {\n    case Actions.HOME_STATE_BACK:\n      const newStateHistory = [...stateHistory]\n      const newCurrentState = newStateHistory > 0 ? newStateHistory.pop() : home.AppStateTypes.MAP\n      return {\n        ...state,\n        stateHistory: newStateHistory,\n        currentState: newCurrentState\n      }\n\n    case Actions.HOME_CHANGE_STATE:\n      const newHistory = [...stateHistory, currentState]\n      return {\n        ...state,\n        history: newHistory,\n        currentState: data\n      }\n\n    case Actions.HOME_CHANGE_ACTIVE_SERIES:\n      return {\n        ...state,\n        activeSeries: data\n      }\n\n    default:\n      return state\n  }\n}\n","import { Actions } from '../actions'\n\nconst initState = {\n  store: [],\n  activeUpload: null\n}\n\nexport default (state = initState, action) => {\n  const { type, data } = action\n  const { store, activeUpload } = state\n\n  switch (type) {\n    case Actions.UPLOADER_START:\n      if (!activeUpload) {\n        return {\n          ...state,\n          activeUpload: data\n        }\n      }\n      else {\n        return {\n          ...state,\n          store: [...store, data]\n        }\n      }\n    case Actions.UPLOADER_COMPLETE:\n      if (store.length === 0) {\n        return {\n          ...state,\n          activeUpload: null\n        }\n      }\n      else {\n        const newStore = [...store]\n        const newActive = newStore.pop()\n        return {\n          ...state,\n          store: newStore,\n          activeUpload: newActive\n        }\n      }\n    case Actions.UPLOADER_UPDATE_PROGRESS:\n      return {\n        ...state,\n        activeUpload: { ...activeUpload, ...data }\n      }\n    default:\n      return state\n  }\n}\n","import { combineReducers } from 'redux'\nimport map from './map'\nimport home from './home'\nimport uploader from './uploader'\n\nexport default combineReducers({ map, home, uploader })\n","import { createStore, applyMiddleware, compose } from 'redux'\nimport thunk from 'redux-thunk'\nimport rootReducer from './reducers'\n\n// import api from '../middleware/api'\n// https://github.com/reduxjs/redux/blob/master/examples/real-world/src/middleware/api.js\n\n/**\n * On Dev we want our devTools available\n */\nconst configureStoreDev = preloadedState => {\n  const { devToolsEnhancer } = require('redux-devtools-extension')\n  const { createLogger } = require('redux-logger')\n  const store = createStore(\n    rootReducer,\n    preloadedState,\n    compose(\n      devToolsEnhancer(),\n      applyMiddleware(\n        thunk,\n        //  api,\n        createLogger()\n      )\n    )\n  )\n  if (module.hot) {\n    // Enable Webpack hot module replacement for reducers\n    module.hot.accept('./reducers', () => {\n      store.replaceReducer(rootReducer)\n    })\n  }\n  return store\n}\n\n/**\n * Production gets a simpler more performant store:\n */\nconst configureStoreProd = preloadedState => createStore(\n  rootReducer,\n  preloadedState,\n  applyMiddleware(\n    thunk\n    // api\n  )\n)\n\nexport default process.env.NODE_ENV === 'production' ? configureStoreProd : configureStoreDev\n\n/**\n * Cosmos Gets its own store\n */\nexport const cosmosStore = configureStoreDev\n","const tagChips = {\n  height: 20\n}\n\nexport default theme => ({\n  xyTagChip: {\n    cursor: 'pointer',\n    color: 'white',\n    fontSize: '0.6em',\n    background: '#444444',\n    height: tagChips.height,\n    position: 'absolute',\n    left: -tagChips.height / 2,\n    top: -tagChips.height / 2\n  },\n  editing: {\n    // color: 'white',\n    // background: theme.palette.secondary.main\n  },\n  // The tag is flipped on the right side of the screen\n  reversedChip: {\n    flexDirection: 'row-reverse',\n    left: 'unset',\n    right: -tagChips.height / 2\n  },\n  deleteIcon: {\n    // color: 'white',\n    width: tagChips.height - 1,\n    height: tagChips.height - 1\n  },\n  chipAvatarIcon: {\n    color: 'white',\n    width: tagChips.height - 4,\n    height: tagChips.height - 4\n  },\n  chipAvatar: {\n    background: 'inherit',\n    width: tagChips.height,\n    height: tagChips.height\n  },\n  reversedDelete: {\n    margin: `0 -${tagChips.height / 8}px 0 ${tagChips.height / 8}px`\n  },\n  // The chip bucket is the container div for the chip and represents the\n  // Actual XY coordinates. The chip itself is offset to make the\n  chipBucket: {\n    width: 1,\n    height: 1,\n    display: 'flex',\n    flexDirection: 'row',\n    position: 'absolute'\n  },\n  reversedChipBucket: {\n    flexDirection: 'row-reverse'\n  }\n})\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport Draggable from 'react-draggable'\n\nimport Chip from '@material-ui/core/Chip'\nimport Avatar from '@material-ui/core/Avatar'\n\nimport CancelIcon from '@material-ui/icons/Cancel'\nimport MyLocation from '@material-ui/icons/MyLocation'\n\nimport { withStyles } from '@material-ui/core/styles'\nimport style from './XYTagChip.style'\n\nconst XYTagChip = ({\n  classes, theme, color, edit, tag, newSize,\n  onTagDragOver, onTagDragStop, onNewTag, onTagDelete, ...props\n}) => {\n  const isReversed = tag.relCoords.x > newSize.newWidth / 2\n\n  const stopBadness = (e) => {\n    e.preventDefault()\n    e.stopPropagation()\n  }\n\n  const handleDrag = (e, data) => {\n    stopBadness(e)\n    onTagDragOver(data, tag)\n  }\n  const handleStopDrag = (e, data) => {\n    stopBadness(e)\n    onTagDragStop(data, tag)\n  }\n\n  // Draggable chip if it is editable\n  return (\n    <Draggable\n      disabled={!edit}\n      bounds={{ left: 10, top: 10, right: newSize.newWidth - 10, bottom: newSize.newHeight - 10 }}\n      position={{ x: tag.relCoords.x, y: tag.relCoords.y }}\n      onDrag={handleDrag}\n      onStop={handleStopDrag}\n      onClick={stopBadness}\n    >\n      <div className={classNames(classes.chipBucket, isReversed && classes.reversedChipBucket)}>\n        <Chip\n          style={{\n            background: color ? `${color}!important` : null,\n            color: color ? `${theme.palette.getContrastText(color)}!important` : null\n          }}\n          color={edit ? 'secondary' : 'default'}\n          label={tag.label}\n          data={tag.id}\n          onClick={stopBadness}\n          onDelete={edit ? onTagDelete(tag) : null}\n          deleteIcon={edit ? <CancelIcon className={classNames(classes.deleteIcon, isReversed && classes.reversedDelete)} /> : <div />}\n          className={classNames(\n            classes.xyTagChip,\n            isReversed && classes.reversedChip,\n            edit && classes.editing\n          )}\n          {...props}\n          avatar={<Avatar className={classNames(classes.chipAvatar, edit && classes.editing)}>\n            <MyLocation className={classNames(classes.chipAvatarIcon, edit && classes.editing)} />\n          </Avatar>}\n        />\n      </div>\n    </Draggable>\n  )\n}\n\nXYTagChip.propTypes = {\n  classes: PropTypes.object.isRequired,\n  theme: PropTypes.object.isRequired,\n  color: PropTypes.string,\n  edit: PropTypes.bool,\n  tag: PropTypes.object.isRequired,\n  newSize: PropTypes.object,\n  onTagDragOver: PropTypes.func,\n  onTagDragStop: PropTypes.func,\n  onNewTag: PropTypes.func,\n  onTagDelete: PropTypes.func\n}\n\nexport default withStyles(style, { withTheme: true })(XYTagChip)\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\nimport Paper from '@material-ui/core/Paper'\nimport Typography from '@material-ui/core/Typography'\nimport TextField from '@material-ui/core/TextField'\nimport MenuItem from '@material-ui/core/MenuItem'\n\nimport { withStyles } from '@material-ui/core/styles'\nimport Select from 'react-select'\nimport CreatableSelect from 'react-select/lib/Creatable'\nimport style from './XYTagSelect.style'\n\nconst XYTagSelect = ({ classes, tagConfig, onChange }) => {\n  const options = tagConfig.values.map(tc => ({ label: tc.label, value: tc.id }))\n  console.log('XYTagSelect', tagConfig)\n  return (\n    <div className={classes.root}>\n      {!tagConfig.allowAdditions && (\n        <Select\n          options={options}\n          classes={classes}\n          components={{\n            Control,\n            Menu,\n            NoOptionsMessage,\n            Option,\n            Placeholder,\n            ValueContainer\n          }}\n          value={null}\n          // onBlur={e => e.preventDefault()}\n          blurInputOnSelect\n          isClearable={false}\n          onChange={onChange}\n          placeholder={tagConfig.label}\n          isSearchable\n        />\n      ) }\n      { tagConfig.allowAdditions && (\n        <CreatableSelect\n          options={options}\n          classes={classes}\n          components={{\n            Control,\n            Menu,\n            NoOptionsMessage,\n            Option,\n            Placeholder,\n            ValueContainer\n          }}\n          value={null}\n          isClearable={false}\n          // onBlur={e => e.preventDefault()}\n          blurInputOnSelect\n          onChange={onChange}\n          placeholder={tagConfig.label}\n          isSearchable\n        />\n      )}\n    </div>\n  )\n}\nXYTagSelect.propTypes = {\n  classes: PropTypes.object.isRequired,\n  tagConfig: PropTypes.object.isRequired,\n  onChange: PropTypes.func.isRequired\n}\n\nexport default withStyles(style)(XYTagSelect)\n\nfunction Control (props) {\n  return (\n    <TextField\n      fullWidth\n      InputProps={{\n        inputComponent,\n        inputProps: {\n          className: props.selectProps.classes.input,\n          inputRef: props.innerRef,\n          children: props.children,\n          ...props.innerProps\n        }\n      }}\n      {...props.selectProps.textFieldProps}\n    />\n  )\n}\n\nconst NoOptionsMessage = ({ innerProps, selectProps, children }) => (\n  <Typography\n    color='textSecondary'\n    className={selectProps.classes.noOptionsMessage}\n    {...innerProps}\n  >\n    {children}\n  </Typography>\n)\n\nconst Menu = ({ selectProps, innerProps, children }) => (\n  <Paper square className={selectProps.classes.paper} {...innerProps}>\n    {children}\n  </Paper>\n)\n\nconst inputComponent = ({ inputRef, ...props }) => <div ref={inputRef} {...props} />\n\nconst Placeholder = (props) => (\n  <Typography\n    color='textSecondary'\n    className={props.selectProps.classes.placeholder}\n    {...props.innerProps}\n  >\n    {props.children}\n  </Typography>\n)\n\nconst Option = ({ innerRef, isFocused, isSelected, innerProps, children }) => (\n  <MenuItem\n    buttonRef={innerRef}\n    selected={isFocused}\n    component='div'\n    style={{ fontWeight: isSelected ? 500 : 400 }}\n    {...innerProps}\n  >\n    {children}\n  </MenuItem>\n)\n\nconst ValueContainer = ({ selectProps, children }) => (\n  <div className={selectProps.classes.valueContainer}>{children}</div>\n)\n","export default theme => ({\n  root: {\n    width: '100%'\n  },\n  noOptionsMessage: {\n    padding: `${theme.spacing.unit}px ${theme.spacing.unit * 2}px`\n  },\n  singleValue: {\n    fontSize: 16\n  },\n  placeholder: {\n    position: 'absolute',\n    left: 2,\n    fontSize: 16\n  },\n  input: {\n    display: 'flex',\n    padding: 0\n  },\n  valueContainer: {\n    display: 'flex',\n    flexWrap: 'wrap',\n    flex: 1,\n    alignItems: 'center',\n    overflow: 'hidden'\n  },\n  paper: {\n    position: 'absolute',\n    zIndex: 100,\n    marginTop: theme.spacing.unit,\n    left: 0,\n    right: 0\n  }\n})\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport Typography from '@material-ui/core/Typography'\nimport IconButton from '@material-ui/core/IconButton'\n\nimport CloseIcon from '@material-ui/icons/Close'\n\nimport { withStyles } from '@material-ui/core/styles'\nimport XYTagSelect from './XYTagSelect'\nimport style from './XYTagChooser.style'\n\nconst XYTagChooser = ({ classes, coords, open, seriesConfig, onNewTag, onClose }) => {\n  const xyTags = seriesConfig.tags.filter(t => t.allowXY)\n  if (!coords) return null\n  return (\n    <Dialog\n      open={open}\n      scroll='paper'\n      fullScreen\n      classes={{ paperScrollPaper: classes.root }}\n      onClose={() => onClose()}\n      aria-labelledby='simple-dialog-title'\n    >\n      <DialogTitle id='simple-dialog-title' className={classes.header}>\n      New Tag:\n        <IconButton className={classes.closeButton} onClick={onClose}>\n          <CloseIcon />\n        </IconButton>\n      </DialogTitle>\n      <div className={classes.dlgBody}>\n        {xyTags.length > 1 && (\n          <Typography variant='caption'>What kind of tag would you like to create?</Typography>\n        )}\n\n        {xyTags.map((tagType, idx) => (\n          <div className={classes.listItem} key={`tagSelect${idx}`}>\n            <XYTagSelect tagConfig={tagType} onChange={onNewTag(coords, tagType)} />\n          </div>\n        ))}\n      </div>\n    </Dialog>\n  )\n}\n\nXYTagChooser.propTypes = {\n  classes: PropTypes.object.isRequired,\n  seriesConfig: PropTypes.object.isRequired,\n  open: PropTypes.bool.isRequired,\n  coords: PropTypes.object,\n  onClose: PropTypes.func.isRequired,\n  onNewTag: PropTypes.func.isRequired\n}\n\nexport default withStyles(style)(XYTagChooser)\n","export default theme => ({\n  root: {\n    overflow: 'visible'\n  },\n  header: {\n    padding: theme.spacing.unit * 2\n  },\n  listItem: {\n    flexDirection: 'column'\n  },\n  dlgBody: {\n    paddingLeft: theme.spacing.unit * 2,\n    paddingRight: theme.spacing.unit * 2,\n    paddingBottom: theme.spacing.unit * 2\n  },\n  closeButton: {\n    position: 'absolute',\n    right: theme.spacing.unit,\n    top: theme.spacing.unit,\n    color: theme.palette.grey[500]\n  }\n})\n","import React, { useState, useContext } from 'react'\nimport { SeriesContext } from '../../contexts'\nimport XYTagChooser from './XYTagChooser'\nimport Tags from '../../../../lib/Tags'\n\nconst useXYTags = (photo, newSize, onChange, setResizeActive) => {\n  const { seriesConfig } = useContext(SeriesContext)\n\n  // we hold the tags in state so that every little drag motion\n  // doesn't cause an updated state until you let go\n  const [isDragging, setIsDragging] = useState(false)\n  const [newTagDialog, setNewTagDialog] = useState(null)\n\n  const tagClass = new Tags(seriesConfig, photo.tags)\n\n  const onNewTag = (coords, tagType) => ({ value, __isNew__: isNew }) => {\n    let addTag = isNew\n      ? tagClass.createNewXYTagObj(value, tagType.id, coords)\n      : tagClass.createExistingXYTagObj(value, tagType.id, coords)\n\n    setNewTagDialog(null)\n    onChange({ ...photo, tags: [...photo.tags, addTag] })\n  }\n\n  const onTagDelete = (tag) => () => {\n    const tags = photo.tags.filter(oldTag => oldTag.id !== tag.id)\n    onChange({\n      ...photo,\n      tags\n    })\n  }\n\n  // When the photo is tapped, send the x,y coords of that tap\n  // to a dialog we will open\n  const onAddTagTrigger = (e) => {\n    if (!newTagDialog) {\n      // Turn off resizing so mobile keyboards don't complete F us.\n      setResizeActive(false)\n      setNewTagDialog({\n        x: parseInt(e.pageX - (window.innerWidth - newSize.newWidth) / 2 * newSize.multiplier, 10),\n        y: parseInt(e.pageY - (window.innerHeight - newSize.newHeight) / 2 * newSize.multiplier, 10)\n      })\n    }\n  }\n\n  // This gets used by the drag AND the stop\n  const updateTagLocation = ({ x, y }, tag) => {\n    const newTags = photo.tags.map(oldTag => {\n      if (oldTag.id !== tag.id) return oldTag\n      else {\n        let newX = parseInt(x / newSize.multiplier, 10)\n        let newY = parseInt(y / newSize.multiplier, 10)\n\n        return {\n          ...oldTag,\n          coords: { x: newX, y: newY }\n        }\n      }\n    })\n    return newTags\n  }\n\n  const onTagDragStop = (coords, tag) => {\n    const tags = updateTagLocation(coords, tag)\n    setIsDragging(false)\n    onChange({\n      ...photo,\n      tags\n    })\n  }\n\n  const onTagDragOver = (coords, tag) => {\n    updateTagLocation(coords, tag)\n    setIsDragging(true)\n  }\n  const TagChooser = () => (\n    <XYTagChooser\n      open={!isDragging && Boolean(newTagDialog)}\n      coords={newTagDialog}\n      seriesConfig={seriesConfig}\n      onNewTag={onNewTag}\n      onClose={() => {\n        setNewTagDialog(null)\n        // Turn on resizing again.\n        setResizeActive(true)\n      }}\n    />\n  )\n\n  return {\n    onNewTag,\n    onTagDelete,\n    onAddTagTrigger,\n    onTagDragOver,\n    onTagDragStop,\n    TagChooser,\n    getRelXYTags: tagClass.getRelXYTags\n  }\n}\n\nexport default useXYTags\n","import React, { useState, useRef, useContext, useEffect } from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\n\nimport { withStyles } from '@material-ui/core/styles'\n\nimport useComponentSize from '../../../../lib/useComponentSize'\n\nimport { SeriesContext } from '../../contexts'\nimport XYTagChip from '../tags/XYTagChip'\nimport useXYTags from '../tags/useXYTags'\n\nimport style from './Photo.style'\n\nconst Photo = ({ classes, photo, opacity, edit, showTags, transition, onChange, className }) => {\n  const refImgWrap = useRef(null)\n  const [newSize, setNewSize] = useState({ multiplier: 1 })\n  const [url, setUrl] = useState(null)\n  const [urlRetryCounter, setURLRetryCounter] = useState(0)\n  const { seriesConfig } = useContext(SeriesContext)\n\n  useEffect(() => {\n    async function getURL () {\n      if (!photo.base64) {\n        const newUrl = await seriesConfig.getPhotoUrl(photo, 'large')\n        if (refImgWrap.current) setUrl(newUrl)\n      }\n      else {\n        if (refImgWrap.current) setUrl(photo.base64)\n      }\n    }\n    getURL()\n  }, [photo])\n\n  const { size: { height, width }, setResizeActive } = useComponentSize(refImgWrap)\n  const urlWithRetries = urlRetryCounter > 0 ? `${url}?retry=${urlRetryCounter}` : url\n\n  // All tag-related info is put in its own hook\n  const { onAddTagTrigger, TagChooser, getRelXYTags, onTagDragOver, onTagDragStop, onTagDelete } = useXYTags(photo, { height, width }, onChange, setResizeActive)\n\n  const handleImageLoaded = event => {\n    if (refImgWrap.current) {\n      const { naturalHeight, naturalWidth } = event.target\n\n      // 4 different cases of orientation:\n      const multiplier = Math.min(\n        height / naturalHeight,\n        width / naturalWidth\n      )\n\n      const newWidth = multiplier * naturalWidth\n      const newHeight = multiplier * naturalHeight\n\n      setNewSize({ newWidth, newHeight, naturalWidth, naturalHeight, multiplier })\n    }\n  }\n\n  return (\n    <div\n      className={classNames(classes.root, className)}\n      style={{ opacity: opacity !== null ? opacity : 1 }}\n      ref={refImgWrap}\n    >\n      <div\n        className={classes.inner}\n        style={{\n          height: newSize ? newSize.newHeight : 1,\n          width: newSize ? newSize.newWidth : 1\n        }}\n        onClick={onAddTagTrigger}\n      >\n        { showTags || edit\n          ? (\n            <div className={className}>\n              { getRelXYTags(newSize.multiplier).map((tag, idx) => (\n                <XYTagChip\n                  key={`xytag-${idx}`}\n                  color={tag.color}\n                  {...{ edit, newSize, tag, onTagDragOver, onTagDragStop, onTagDelete }} />\n              ))}\n            </div>\n          ) : null\n        }\n        <img\n          className={classes.img}\n          alt={urlWithRetries}\n          onError={(err) => {\n            if (urlRetryCounter < 10) {\n              console.log('Image Retry', urlRetryCounter)\n              console.error(err)\n              setTimeout(() => {\n                if (refImgWrap.current) setURLRetryCounter(urlRetryCounter + 1)\n              }, 4000)\n            }\n          }}\n          src={urlWithRetries}\n          onLoad={handleImageLoaded}\n          style={{ height: newSize.newHeight, width: newSize.newWidth }}\n        />\n      </div>\n      {edit && <TagChooser />}\n    </div>\n  )\n}\n\nPhoto.propTypes = {\n  classes: PropTypes.object.isRequired,\n  className: PropTypes.string,\n  opacity: PropTypes.number,\n  photo: PropTypes.object.isRequired,\n  edit: PropTypes.bool,\n  showTags: PropTypes.bool,\n  transition: PropTypes.string,\n  onChange: PropTypes.func\n}\n\nexport default withStyles(style)(Photo)\n","// import { fade } from '@material-ui/core/styles/colorManipulator'\nexport default theme => ({\n  root: {\n    // maxWidth: 400,\n    display: 'block',\n    position: 'relative',\n    width: '100%',\n    height: '100%',\n    background: 'black',\n    overflow: 'hidden'\n  },\n  inner: {\n    position: 'absolute',\n    top: '50%',\n    left: '50%',\n    transform: 'translateY(-50%) translateX(-50%)',\n    overflow: 'hidden'\n  },\n  xyTags: {\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    // opacity: 0.8,\n    // border: '4px solid red',\n    height: '100%',\n    width: '100%'\n    // background: 'rgba(150, 150, 150, 0.5)'\n  },\n  img: {\n    display: 'block'\n  },\n  formControl: {\n    width: '100%'\n  }\n})\n"],"sourceRoot":""}