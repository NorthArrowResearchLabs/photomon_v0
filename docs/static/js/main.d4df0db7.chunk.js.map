{"version":3,"sources":["lib/useComponentSize.js","lib/sensors.js","config.js","lib/SeriesConfig.js","components/PhotoSeries/views/tags/TagChip.jsx","components/PhotoSeries/views/controls/ShortLongText.jsx","lib/Tags.js","components/maps/markers/Dot.jsx","components/maps/BaseStaticMap.jsx","components/maps/MapDot.jsx","mapStyles/index.js","components/maps/controls/StyleButtons.jsx","components/PhotoSeries/views/dialogs/BigText.jsx","components/PhotoSeries/views/dialogs/DeleteDialog.jsx","components/PhotoSeries/views/dialogs/BigTextEdit.jsx","components/PhotoSeries/views/controls/PhotoFadeSlider.jsx","components/PhotoSeries/views/controls/TagControl.style.js","components/PhotoSeries/views/controls/TagView.jsx","components/PhotoSeries/views/controls/DateControl.jsx","components/PhotoSeries/views/controls/TagControl.jsx","components/PhotoSeries/views/dialogs/TagEdit.jsx","components/PhotoSeries/views/controls/DateView.jsx","components/PhotoSeries/views/subViews/PhotoInfoInner.jsx","components/PhotoSeries/views/dialogs/MapDirPicker.jsx","components/PhotoSeries/views/subViews/SeriesEditInner.jsx","components/PhotoSeries/views/subViews/SeriesEditInner.style.js","components/maps/markers/MyLocation.jsx","components/maps/controls/MyLocationButton.jsx","components/maps/BaseMap.jsx","components/PhotoSeries/views/subViews/PhotoGrid.jsx","components/PhotoSeries/views/subViews/PhotoGrid.style.js","components/PhotoSeries/views/NewPhoto.jsx","lib/Photo.js","lib/Series.js","lib/datelib.js","lib/useCamera.js","components/PhotoSeries/views/CameraTool.jsx","components/PhotoSeries/views/CameraTool.style.js","lib/useFileInput.js","components/PhotoSeries/views/controls/LibraryFilePicker.jsx","components/PhotoSeries/views/NewPhotoInfo.jsx","components/PhotoSeries/views/NewPhotoInfo.style.js","components/PhotoSeries/views/PhotoReviewTool.jsx","components/PhotoSeries/views/PhotoReviewTool.style.js","components/PhotoSeries/contexts.js","lib/util.js","translations.js","graphql/queries.js","contexts.js","components/auth/useAuthCommon.js","components/auth/AuthContainer.jsx","components/auth/Loading.jsx","lib/useGraphQL.js","lib/ErrorBoundary.jsx","components/auth/auth.style.js","components/auth/SignIn.jsx","components/auth/ConfirmSignIn.jsx","components/auth/RequireNewPassword.jsx","components/auth/SignUp.jsx","components/auth/ConfirmSignUp.jsx","components/auth/ForgotPassword.jsx","lib/useAuthentication.js","lib/useShowAddToHome.js","lib/useResponsive.js","redux/actions.js","redux/reducers/map.js","redux/reducers/home.js","redux/reducers/uploader.js","redux/reducers/index.js","redux/storeConfig.js","redux/withReduxProvider.js","components/UploadControl.jsx","lib/s3upload.js","graphql/Uploader.connect.js","permissions.js","graphql/mutations.js","components/PhotoSeries/views/controls/AddFab.jsx","components/PhotoSeries/views/controls/ContextMenu.jsx","components/PhotoSeries/views/subViews/SeriesInfo.jsx","components/PhotoSeries/views/subViews/SeriesInfo.style.js","components/PhotoSeries/views/subViews/SwipeShow.jsx","components/PhotoSeries/views/subViews/SwipeShow.style.js","components/PhotoSeries/views/SeriesView.style.js","components/PhotoSeries/views/SeriesView.jsx","components/PhotoSeries/views/SeriesEdit.jsx","components/PhotoSeries/views/SeriesEdit.style.js","components/PhotoSeries/views/Slideshow.jsx","components/PhotoSeries/views/Slideshow.style.js","components/PhotoSeries/views/dialogs/CancelConfirm.jsx","components/PhotoSeries/views/subViews/PhotoInfo.jsx","components/PhotoSeries/views/PhotoViewTool.jsx","components/PhotoSeries/views/PhotoViewTool.style.js","lib/AccessHelper.js","components/PhotoSeries/views/SeriesNotFound.jsx","components/PhotoSeries/index.jsx","lib/localdb.js","graphql/Series.connect.js","lib/useClusteredData.js","components/maps/HomeMap.style.js","icons/AppLogo.jsx","components/TopBar.jsx","components/Search/SearchInput.jsx","components/misc/TinyChip.jsx","components/misc/SeriesListItem.jsx","components/misc/ClusterSelected.jsx","components/maps/markers/Single.jsx","components/maps/markers/Cluster.jsx","components/maps/HomeMap.jsx","graphql/Map.connect.js","components/Search/SearchContextItem.jsx","components/Search/SearchContextResults.jsx","components/Search/SearchEnder.jsx","components/Search/SearchResults.jsx","components/Search/SearchPlaceholder.jsx","lib/useOnline.js","components/Search/Search.jsx","graphql/Search.connect.js","components/MyProfile/MeCard.jsx","components/MyProfile/MyProfile.jsx","graphql/Profile.connect.js","components/MyFeed/FeedEnder.jsx","components/misc/FindOnMapButton.jsx","components/MyFeed/FeedItem.jsx","components/MyFeed/MyFeed.jsx","graphql/Feed.connect.js","components/misc/OfflineBar.jsx","components/BottomBar.jsx","App.jsx","components/misc/ErrorScreen.jsx","App.connect.js","serviceWorker.js","index.js","components/PhotoSeries/views/tags/XYTagChip.style.js","components/PhotoSeries/views/tags/XYTagChip.jsx","components/PhotoSeries/views/tags/XYTagSelect.jsx","components/PhotoSeries/views/tags/XYTagSelect.style.js","components/PhotoSeries/views/tags/XYTagChooser.jsx","components/PhotoSeries/views/tags/XYTagChooser.style.js","components/PhotoSeries/views/tags/useXYTags.js","components/PhotoSeries/views/subViews/BrokenImg.jsx","components/PhotoSeries/views/subViews/Photo.jsx","components/PhotoSeries/views/subViews/Photo.style.js"],"names":["getSize","el","minSize","defaultSize","width","Math","max","offsetWidth","height","offsetHeight","useComponentSize","ref","resizeActiveRef","useRef","_useState","useState","_useState2","Object","_Users_matt_Work_Git_PBR_PhotoMonitoring_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__","resizeActive","setResizeActive","current","_useState3","_useState4","size","setComponentSize","handleResize","newSize","handleResizeDebounced","useCallback","debounce","useLayoutEffect","ResizeObserver","resizeObserver","observe","disconnect","window","addEventListener","removeEventListener","useGeolocation","accuracy","altitude","altitudeAccuracy","heading","latitude","longitude","speed","timestamp","Date","now","state","setState","mountedRef","watchIdRef","onEvent","event","coords","useEffect","navigator","geolocation","getCurrentPosition","watchPosition","clearWatch","useDeviceOrientation","absolute","alpha","beta","gamma","deviceOrientation","setDeviceOrientation","handleDeviceOrientation","isIos","test","userAgent","vendor","opera","isPhone","a","substr","__webpack_require__","d","__webpack_exports__","mapConfig","home","endpoints","localDb","aws","ACCESS","_mapStyles__WEBPACK_IMPORTED_MODULE_0__","tagColors","mapBoxToken","process","styles","MapStyles","baseurl","REACT_APP_BASEURL","console","log","AppStateTypes","FEED","MAP","SEARCH","PROFILE","SERIES","NEW_SERIES_CAMERA","NEW_SERIES_LIBRARY","SEARCH_TABS","TAG","LOCATION","USER","MapModeTypes","FREE","graphql","imgStore","Auth","region","userPoolId","userPoolWebClientId","mandatorySignIn","cookieStorage","domain","concat","expires","secure","OPEN","label","description","color","PRIVATE","PUBLIC","TYPES","SeriesConfig","seriesConfig","_this","this","_Users_matt_Work_Git_PBR_PhotoMonitoring_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_2__","getTagType","typeId","config","tags","find","tt","id","getTagTypeIndex","findIndex","getXYTagTypes","filter","allowXY","getNonXYTagTypes","allowNonXY","getSeriesMeta","keys","meta","key","type","reduce","acc","_Users_matt_Work_Git_PBR_PhotoMonitoring_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_1__","_Users_matt_Work_Git_PBR_PhotoMonitoring_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__","default","getPhotoMeta","Error","tagChips","useStyles","makeStyles","theme","root","fontSize","marginRight","spacing","marginTop","deleteIcon","chipAvatar","TagChip","_ref","edit","tag","onDelete","props","_Users_matt_Work_Git_PBR_PhotoMonitoring_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_0__","classes","useTheme","react__WEBPACK_IMPORTED_MODULE_1___default","createElement","_material_ui_core_Chip__WEBPACK_IMPORTED_MODULE_2__","assign","style","background","palette","getContrastText","data","_material_ui_icons_Cancel__WEBPACK_IMPORTED_MODULE_3___default","className","onClick","e","opacity","react__WEBPACK_IMPORTED_MODULE_0__","react__WEBPACK_IMPORTED_MODULE_0___default","n","classnames__WEBPACK_IMPORTED_MODULE_1__","classnames__WEBPACK_IMPORTED_MODULE_1___default","_material_ui_core_Typography__WEBPACK_IMPORTED_MODULE_2__","_material_ui_core_FormLabel__WEBPACK_IMPORTED_MODULE_3__","_material_ui_core_styles__WEBPACK_IMPORTED_MODULE_4__","position","display","overflow","whiteSpace","&::before","content","bottom","paper","ShortLongText","text","formLabel","variant","classNames","defaultProps","Tags","_Users_matt_Work_Git_PBR_PhotoMonitoring_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_1__","findTagById","tagId","values","getXYTags","xyTagIds","map","indexOf","x","getNonXYTags","NonXYTagIds","createNewTagObj","uuid","createExistingTagObj","_Users_matt_Work_Git_PBR_PhotoMonitoring_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_0__","createNewXYTagObj","createExistingXYTagObj","getRelXYTags","multiplier","group","relCoords","y","primary","main","top","left","textAlign","transformOrigin","transform","zIndex","rootActive","svgDot","dot","stroke","secondary","contrastText","strokeWidth","fill","directionIndicator","name","fontWeight","textShadow","nameActive","dark","Single","direction","react_default","version","viewBox","cx","cy","r","svgArc","fillOpacity","strokeOpacity","BaseStaticMap","controlPadding","viewport","children","mapStyles","onMapDataEvent","passthroughProps","objectWithoutProperties","mapRef","slicedToArray","currStyle","setCurrStyle","projection","setProjection","recalcProjection","getDistanceScales","error","useMemo","esm","mapStyle","onData","mapboxApiAccessToken","length","StyleButtons","Array","isArray","c","handleChild","child","stylechooser","initStyle","MapDot","staticMap","editable","onChange","Map","BaseMap","mapProps","touchRotate","dragRotate","showMe","lockPan","onViewportChange","Dot","_Satellite_json__WEBPACK_IMPORTED_MODULE_0__","_TopoMap_json__WEBPACK_IMPORTED_MODULE_1__","_material_ui_icons__WEBPACK_IMPORTED_MODULE_2__","_material_ui_icons__WEBPACK_IMPORTED_MODULE_3__","_material_ui_icons__WEBPACK_IMPORTED_MODULE_4__","_material_ui_icons__WEBPACK_IMPORTED_MODULE_5__","toolTip","Icon","SatelliteOutlined","ActiveIcon","SatIcon","Satellite","TerrainOutlined","Terrain","TopoMap","speedDialFab","border","speedDialAction","marginBottom","speedDialIcon","speedDialLabel","open","setOpen","noEventSetOpen","preventDefault","stopPropagation","right","_material_ui_lab_SpeedDial__WEBPACK_IMPORTED_MODULE_2__","ariaLabel","speedDial","fab","icon","onClose","_ref2","idx","_material_ui_lab_SpeedDialAction__WEBPACK_IMPORTED_MODULE_3__","tooltipPlacement","ButtonProps","TooltipClasses","tooltip","tooltipTitle","tooltipOpen","_material_ui_core_Typography__WEBPACK_IMPORTED_MODULE_1__","_material_ui_core_DialogContent__WEBPACK_IMPORTED_MODULE_2__","_material_ui_core_Dialog__WEBPACK_IMPORTED_MODULE_3__","_material_ui_core_IconButton__WEBPACK_IMPORTED_MODULE_4__","_material_ui_core_DialogTitle__WEBPACK_IMPORTED_MODULE_5__","_material_ui_icons_Close__WEBPACK_IMPORTED_MODULE_6__","_material_ui_icons_Close__WEBPACK_IMPORTED_MODULE_6___default","_material_ui_core_styles__WEBPACK_IMPORTED_MODULE_7__","body","paddingBottom","title","alignSelf","margin","padding","dlgTitle","flexGrow","closeButton","grey","BigText","scroll","fullWidth","maxWidth","aria-labelledby","disableTypography","_material_ui_core_Dialog__WEBPACK_IMPORTED_MODULE_1__","_material_ui_core_DialogTitle__WEBPACK_IMPORTED_MODULE_2__","_material_ui_core_DialogContent__WEBPACK_IMPORTED_MODULE_3__","_material_ui_core_Button__WEBPACK_IMPORTED_MODULE_4__","_material_ui_core_Typography__WEBPACK_IMPORTED_MODULE_5__","_material_ui_core_DialogActions__WEBPACK_IMPORTED_MODULE_6__","DeleteDialog","message","onConfirm","disableBackdropClick","disableEscapeKeyDown","BigTextEdit","onOk","multiline","value","setValue","_material_ui_core_DialogTitle__WEBPACK_IMPORTED_MODULE_7__","_material_ui_core_TextField__WEBPACK_IMPORTED_MODULE_5__","rows","rowsMax","target","defaultValue","_material_ui_core_DialogActions__WEBPACK_IMPORTED_MODULE_4__","_material_ui_core_Button__WEBPACK_IMPORTED_MODULE_6__","flexDirection","sliderLabel","container","track","thumb","PhotoFadeSlider","slider","setSlider","_material_ui_lab_Slider__WEBPACK_IMPORTED_MODULE_3__","vertical","TagControl_style","tagContainer","formControl","actionButtons","noOptionsMessage","singleValue","placeholder","input","valueContainer","flexWrap","flex","alignItems","TagControl","tagConfig","tagValues","Typography","fieldTitle","rootEdit","textBody","DateControl","hint","TextField","timestampToHTML5Input","textField","HTML5InputToTimestamp","controls_TagControl","onSelectChange","inputValue","action","removedValue","option","val","newVal","objectSpread","tcv","toConsumableArray","newCreateVal","v","__isNew__","selectOptions","remainingTags","t","allowAdditions","react_select_esm","options","isFocused","components","Control","Menu","NoOptionsMessage","Option","Placeholder","ValueContainer","deleteRemoves","isClearable","isMulti","isSearchable","Creatable_default","InputProps","inputComponent","inputProps","selectProps","inputRef","innerRef","onMouseDown","innerProps","onTouchEnd","textFieldProps","_ref5","_ref6","Paper","square","_ref7","_ref8","isSelected","MenuItem","buttonRef","selected","component","_ref9","dlgContent","overflowY","TagEdit","onCancel","Dialog","fullScreen","DialogTitle","IconButton","Close_default","DialogContent","field","DialogActions","Button","DateView","formatDate","dlgTitleContainer","catTagTitle","paddingTop","paddingLeft","DIALOGS","PhotoInfo","canEdit","photo","delta","useContext","SeriesContext","_useState2$","activeDialog","activeDialogContext","setActiveDialog","tagInst","TagClass","metaKeys","JSON","parse","controls_DateControl","takenOn","controls_DateView","note","Divider","TagView","Fragment","List","list","ListItem","ListItemText","render","dialogs_TagEdit","mapWrapper","sliderWrapper","sliderRoor","MapDirPicker","initLat","initLong","initDir","setCoords","setRotation","initViewport","zoom","_ref2$viewport","FormLabel","mapFormLabel","Slider","min","step","inner","access","accessRadio","grow","paddingRight","marginLeft","mapInnerWrap","minHeight","minWidth","chips","SeriesEditInner","series","FormControlLabel","control","Switch","checked","disabled","dialogs_MapDirPicker","newNote","svgAccuracyDot","MyLocation","accHeight","pixelsPerMeter","accWidth","MyLocationButton","Fab","aria-label","MyLocation_default","bounds","lockToBounds","incomingOnViewportChange","incomingOnTransitionStart","onTransitionStart","incomingOnTransitionEnd","onTransitionEnd","transitions","mapContainerRef","mapBoxRef","innerTransitionsRef","defaultViewVals","setViewport","_useState5","_useState6","isTransitioning","setIsTransitioning","_useState7","_useState8","myPosition","geoMarker","markers_MyLocation","viewportChange","newViewport","getMap","_bounds","minlng","minlat","maxlng","maxlat","_fitBounds","WebMercatorViewport","fitBounds","offset","dragPan","React","cloneElement","hideNavControls","showZoom","touchZoom","scrollZoom","showCompass","controls_MyLocationButton","transitionDuration","transitionInterpolator","FlyToInterpolator","transitionEasing","easeCubic","setTimeout","bearing","pitch","tile","addFab","notDeleteable","unSelectedTile","& img","selectedTile","img","snackbarContent","backgroundColor","red","snackbar","PhotoGrid","photos","columns","multiSelect","onTileClick","selectMode","setSelectMode","selectedItems","setSelectedItems","deleteConfirm","setDeleteConfirm","_useContext","ac","handleCancelSelection","toggleListItem","remaining","arrId","sortedPhotos","sort","b","parseInt","GridList","cols","cellHeight","canDelete","canUser","photoUrl","getPhotoUrl","base64","GridListTile","handlePhotoTap","src","alt","handleAddToSelection","Remove_default","Add_default","GridListTileBar","Snackbar","autoHideDuration","ContentProps","aria-describedby","confirmation","MODES","NewPhoto","inputMethod","onCreate","isNewSeries","_Users_matt_Work_Git_PBR_PhotoMonitoring_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_2__","newPhoto","setNewPhoto","SeriesClass","newSeries","setNewSeries","photoRefId","setPhotoRefId","history","mode","_changeMode","orientation","geo","changeMode","newModeName","_Users_matt_Work_Git_PBR_PhotoMonitoring_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__","react__WEBPACK_IMPORTED_MODULE_3___default","_CameraTool__WEBPACK_IMPORTED_MODULE_7__","onShutter","refId","photoInitObj","PhotoClass","exif","foundIdx","newData","slice","parser","exifParser","create","Buffer","from","stringify","err","rawData","orient","geolocate","_controls_LibraryFilePicker__WEBPACK_IMPORTED_MODULE_9__","onLibraryAdd","date","String","DateTimeOriginal","GPSLatitude","isNumeric","GPSLongitude","fullNewPhotoObject","_PhotoReviewTool__WEBPACK_IMPORTED_MODULE_6__","defaultRefPhotoId","captured","onRetry","oldHistory","oldMode","pop","_NewPhotoInfo__WEBPACK_IMPORTED_MODULE_8__","onSave","Photo","_Users_matt_Work_Git_PBR_PhotoMonitoring_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__","setMeta","convertJSDatetoTimestamp","Series","formatDatAgo","moment__WEBPACK_IMPORTED_MODULE_0__","moment__WEBPACK_IMPORTED_MODULE_0___default","utctimestamp","format","arguments","undefined","moment","fromNow","jsDate","utc","isoStr","Webcam","webcamElement","canvasElement","classCallCheck","location","protocol","hostname","warn","mediaDevices","getUserMedia","aspectRatio","srcObject","getTracks","stop","Promise","resolve","reject","audio","video","facingMode","then","mediaStream","URL","createObjectURL","onloadedmetadata","play","onplaying","catch","imageWidth","videoWidth","imageHeight","videoHeight","context","getContext","drawImage","_this2","_this$_drawImage","_drawImage","toBlob","blob","quality","_this$_drawImage2","toDataURL","cameraErrorText","disabledFab","cameraFab","@media (orientation: landscape)","@media (orientation: portrait)","cameraIcon","cancelFab","cancelIcon","swipeDrawer","libraryFab","myLocationFab","myLocationIcon","capturedContainer","referenceContainer","reference","CameraTool","newRefPhoto","p","refPhoto","setRefPhoto","drawerOpen","setDrawerOpen","_useCamera","onCapture","cameraError","setCameraError","cameraOnline","setCameraOnline","camRef","initCamera","document","getElementById","setup","innerWidth","innerHeight","captureImage","asyncToGenerator","regenerator_default","mark","_callee","capturedData","wrap","_context","prev","next","takeBase64Photo","apply","delayedOrientationChange","destroy","useCamera","CssBaseline","Boolean","autoPlay","playsInline","muted","buttonFab","Camera_default","Cancel_default","PhotoLibrary_default","libraryIcon","SwipeableDrawer","anchor","paperAnchorLeft","onOpen","tabIndex","swipeDrawerContainer","role","onKeyDown","useFileInput","clickRef","element","handleChange","evt","file","files","reader","FileReader","onload","result","readAsDataURL","click","fileClickEl","forceClick","LibraryFilePicker","_useFileInput","NewPhotoInfo","seriesDelta","setSeriesDelta","photoDelta","setPhotoDelta","PhotoInfoInner","newAttr","referenceTextContainer","newText","refText","PhotoReviewTool","createContext","num","isNaN","parseFloat","isFinite","func","wait","immediate","timeout","_len","innerArgs","_key","callNow","clearTimeout","addLocaleData","frLocaleData","IntlWrapper","index_es","locale","allSeries","gql","_templateObject","pollQuery","_templateObject2","userSeries","_templateObject3","seriesFromList","_templateObject4","seriesWithTag","_templateObject5","tagSearch","_templateObject6","getUser","_templateObject7","_templateObject8","geocode","_templateObject9","getMyFeed","_templateObject10","userSearch","_templateObject11","getWholeSeries","_templateObject12","AppContext","useAuthCommon","containerRef","handleKeyPress","found","getElementsByClassName","bgSwoosh","bgSwooshFill","light","AuthContainer","xmlns","preserveAspectRatio","Loading","auth_AuthContainer","LOCAL_STORAGE_TOKEN","ErrorBoundary","possibleConstructorReturn","getPrototypeOf","call","hasError","_this$state","FallbackUI","fallback","Component","auth_style","spacer","forgotPassword","switch","switchButton","&:last-child","borderRadius","&:first-child","phoneNumInner","phoneNumDropdown","noSignin","SignIn","loading","handleSignup","handleForgotPassword","federated","handleInputChange","handleBeAnonymous","handleSignIn","autoFocus","autoComplete","Link","Toolbar","disableGutters","ConfirmSignIn","handleBack","handleConfirm","RequireNewPassword","change","requiredAttributes","placeholders","attribute","SignUp","signUpFields","signUpFieldLabels","signUpFieldPlaceholders","countryDialCodes","defaultDialCode","selectVal","setSelectVal","handleDialCodeChange","f","FormControl","InputLabel","htmlFor","shrink","required","Select","dialCode","ConfirmSignUp","handleResend","resendCode","ForgotPassword","handleSubmit","handleSendCode","sent","setSent","Amplify","configure","defaultAuthState","authState","authData","signedIn","lib_useAuthentication","setAuth","authScreen","dist","onStateChange","hideDefault","useAuthentication_SignIn","useAuthentication_Loading","useAuthentication_RequireNewPassword","useAuthentication_ConfirmSignIn","useAuthentication_ConfirmSignUp","useAuthentication_ForgotPassword","useAuthentication_SignUp","accessToken","signInUserSession","jwtToken","isGod","idToken","payload","signOut","forceSignIn","newProps","changeState","signIn","auth_SignIn","SignInOrig","hide","includes","checkCustomSignUpFields","signUpConfig","sortFields","getDefaultDialCode","I18n","get","signUp","auth_SignUp","SignUpOrig","_this3","confirm","auth_ConfirmSignIn","ConfirmSignInOrig","_this4","resend","auth_ConfirmSignUp","ConfirmSignUpOrig","challengeParam","split","part","charAt","toUpperCase","toLowerCase","join","auth_RequireNewPassword","RequireNewPasswordOrig","auth_Loading","LoadingOrig","_this5","send","submit","auth_ForgotPassword","ForgotPasswordOrig","useShowAddToHome","deferredPrompt","handleBeforePrompt","a2hsBtn","querySelector","addToHomeScreen","showAddToHomeScreen","prompt","userChoice","choiceResult","outcome","standalone","getState","_window","_window$screen","screen","wOrient","bIsIos","windowSize","screenSize","useResponsive","mediQueries","newState","Actions","actions","newDomain","params","seriesId","initialPhoto","viewportSave","uploadObj","newProgress","mapInit","homeInit","initState","store","activeUpload","combineReducers","newStateHistory","activeSeries","newParams","uploader","newStore","newActive","persistConfig","storage","persistedReducer","persistReducer","rootReducer","storeConfig","preloadedState","createStore","compose","applyMiddleware","thunk","persistor","persistStore","withReduxProvider","BaseComponent","_storeConfig","es","integration_react","msgText","messageInner","UploadControl","progress","LinearProgress","UploadControlCOSMOSWrapper","useWrapperStyles","displayName","updateUploadProgress","completeActiveUpload","formData","FormData","preAuth","fields","forEach","fieldkey","append","dataURLtoFile","headers","Content-Type","onUploadProgress","progressEvent","loaded","total","floor","axios","post","url","stack","dataurl","filename","arr","mime","match","bstr","atob","u8arr","Uint8Array","charCodeAt","File","interceptors","request","use","response","connect","dispatch","uploadingRef","_x","_x2","_x3","_doUpload","s3Upload","components_UploadControl","permissions","admin","create:own","read:any","update:any","delete:any","create:any","nonuser","series_public","series_open","user","read:own","update:own","delete:own","deletePhoto","mutations_templateObject","deleteSeries","mutations_templateObject2","updateSeries","mutations_templateObject3","updatePhoto","mutations_templateObject4","createPhoto","mutations_templateObject5","createSeries","mutations_templateObject6","watchSeries","mutations_templateObject7","unWatchSeries","mutations_templateObject8","mixins","toolbar","directionUp","AddFab","onCameraClick","onLibraryClick","down","setDown","downRef","onDown","currentTarget","block","SpeedDial","onBlur","onTouchStart","SpeedDialAction","AddAPhoto_default","ContextMenu","anchorEl","menuItems","divider","ListItemIcon","primaryTypographyProps","tagListItem","chip","SeriesInfo","seriesConfigInst","SeriesConfigClass","newTags","existing","count","defineProperty","tagKey","idtk","subheading","photoWrapper","dateCaption","mobileStepper","manualBack","manualForward","tagButton","slideshowButton","dots","SwipeShow","onImageSelect","initPhotoIndex","activePhoto","setActivePhoto","showTags","setShowTags","singular","react_swipeable_views_lib_default","axis","index","onChangeIndex","enableMouseEvents","KeyboardArrowRight_default","KeyboardArrowLeft_default","subtitle","actionIcon","Badge","badgeContent","Label_default","MobileStepper","steps","activeStep","transition","isFullScreen","slides","SeriesView_style","appBar","-webkit-overflow-scrolling","tabMenu","mapWrap","toolbarTitle","textOverflow","gridList","titleBar","menuButton","SeriesView","onSlideshowStart","onEditSeries","onDeletePhotos","onCameraAdd","onDeleteSeries","onMenuBack","onWatch","onUnWatch","watching","owned","contextEl","setContextEl","can","update","delete","contribute","listTypeTab","setListTypeTab","AppBar","ArrowBack_default","Slideshow_default","aria-haspopup","MoreVert_default","controls_ContextMenu","AddAlertIcon","EditIcon","DeleteIcon","Tabs","Tab","subViews_SwipeShow","subViews_SeriesInfo","controls_AddFab","SeriesEdit","setDelta","swipeAble","slideContainer","slide","dotActive","iconButton","active","last","labelBadge","tagChip","xyTagChip","Slideshow","_useStepper","useStepper","lastStep","handleForward","paused","pause","showXYTags","setShowXYTags","refImgWrap","_useComponentSize$siz","duration","titlePosition","PlayCircleFilled_default","PauseCircleFilled_default","nextButton","backButton","interval","setActiveStep","setPaused","setLastStep","timerRef","createTimer","setInterval","oldStep","destroyTimer","clearInterval","CancelConfirm","dirty","newDelta","dialogs_CancelConfirm","appBarEdit","tipChip","activeButton","STATES","PhotoViewTool","initPhotoId","onUpdatePhoto","setMode","tagsClass","desired","onCommitTags","infoButton","Info_default","containerStyle","photoidx","subViews_PhotoInfo","Chip","AccessHelper","userSub","permissionObj","ownOrAny","obj","createdUser","isOwner","attrs","ownAny","perm","otherPerm","attributes","granted","AccessControl","sub","SeriesNotFound","notFound","VIEW_ONLY_MODES","RepeatablePhotos","modeName","inputMethodINIT","currentUserId","currentUserRole","accessControl","onNewSeries","onChangePhoto","onNewPhoto","onDeletePhoto","AccesHelper","pid","ph","onApprovePhoto","_ref3","onCreateSeries","_callee2","_ref4","onNewSeriesReturn","_context2","newPid","newInputMethod","canUpdate","to","lastMode","views_SeriesNotFound","views_SeriesView","photoIdArr","sp","views_SeriesEdit","views_PhotoViewTool","views_Slideshow","contexts","Provider","localUUID","openDb","upgradeDB","createObjectStore","prefix","uuidv4","withGetSelectedQuery","skip","variables","withUpdateSeriesMutation","_ref10","mutate","ownProps","updateSeriesMutation","sanitizeUpdateParams","optimisticResponse","__typename","_ref11","qdata","readQuery","query","writeQuery","qdataAll","limit","summary","seriesSummaries","s","withUpdatePhotoMutation","_ref12","updatePhotoMutation","sanitizedPhotoDelta","newT","_ref13","updatedPhoto","withDeleteSeriesDeleteMutation","_ref14","deleteSeriesMutation","_ref15","withDeletePhotoMutation","_ref16","deletePhotoMutation","photoId","_ref17","finalCount","photoCount","withCreateNewSeries","_ref18","createSeriesMutation","featured","_ref19","newAllSeriesEntry","push","withCreateNewPhoto","_ref20","createPhotoMutation","ext","newPhotoInput","createdOn","toString","username","Username","updatedBy","updatedOn","paths","large","orig","medium","_ref21","withWatchSeriesMutation","_ref22","watchSeriesMutation","_ref23","withUnWatchSeriesMutation","_ref24","unWatchSeriesMutation","_ref25","connectedWithApollo","onAfterSeriesDelete","onBack","queueUpload","doneCreatingSeries","currentUser","PhotoSeries","photoNoId","photoData","abrupt","_state$home$current","inputObj","desiredParams","newDesiredParams","remainder","useClusteredData","filterBounds","currentZoom","sizeScale","queryVersion","clusteredData","setClusteredData","single","cluster","filteredData","setFilteredData","setVersion","updateDataDebounce","updatedData","_args","updateData","filterDataDebounce","filtered","_args2","filterData","filteredClusteredData","tree","rbush","screenCoords","project","properties","zoomLevels","geoJSON","point","clear","load","_loop","z","radius","sqrt","pow","neighbors","search","minX","minY","maxX","maxY","neighbor","newGeoJSON","centroid","featureCollection","reducedPhotoCount","points","newZ","geometry","coordinates","AppLogo","createSvgIcon","strokeLinecap","strokeDasharray","strokeMiterlimit","vectorEffect","strokeLinejoin","searchIcon","transparent","TopBar","isTransparent","Menu_default","AccountCircle_default","Drawer","fullList","callback","button","ExitToApp_default","useSearchBarStyles","shape","fade","common","white","&:hover","breakpoints","up","inputRoot","inputInput","pointerEvents","justifyContent","SearchInput","debounceSearchText","Search_default","InputBase","TinyChip","chipContainer","accessPUBLIC","accessPRIVATE","accessOPEN","objectFit","titleText","dateContainer","dateLabel","dateText","imgContainer","SeriesListItem","showCreatedOn","showLastPhoto","accessLabel","misc_TinyChip","latest","misc_SeriesListItem","ClusterSelected","seriesCount","onZoomTo","ZoomOutMap_default","avatar","&.PUBLIC","&.PRIVATE","&.OPEN","avatarActive","badge","badgeActive","Avatar","Cluster","numeral","& .myPosMarker","& .singleMarker","& .clusterMarker","topBar","zoomOutFab","selectedPopup","defaultView","HomeMap","seriesList","setActiveSeries","onSeriesClick","onSearchClick","pushMapHistory","popMapHistory","clearMapHistory","mapViewObj","setMapViewObj","mapViewRef","homeMapContainerRef","setCurrentZoom","setTransitions","_useState9","_useState10","selectedItem","setSelectedItem","bufferPts","buffer","units","bbox","saveMap","updateSelectedItem","item","object","pts","lngBuff","latBuff","buffBounds","onMarkerClick","LinearInterpolator","markersRendered","offsetLeft","offsetTop","markers_Single","markers_Cluster","selectedItemRender","selectedSeries","misc_ClusterSelected","components_TopBar","Search_SearchInput","maxZoom","minZoom","viewZoom","getBounds","_map$getBounds","_map$getBounds$_sw","_sw","minLng","lng","minLat","lat","_map$getBounds$_ne","_ne","maxLng","maxLat","oldMinLng","oldMinLat","oldMaxLng","oldMaxLat","onNativeClick","POLL_INTERVAL","withAllSeries","nextToken","fetchMore","updateQuery","fetchMoreResult","setSeriesProps","readyForPolling","withPollQuery","lastCheck","_ref5$ownProps","seriesProps","updateIncrement","changedSeries","oldList","newSeriesSummaries","seriesStatus","polledSeries","ds","oldSeries","oldId","AllSeriesConnect","PollQueryConnect","mapFuncs","tab","setLastCheck","allSeriesQUERY","pollSeriesQUERY","maps_HomeMap","chosenItem","avatarImg","SearchContextItem","gravatar","TheIcon","PlaceIcon","LabelIcon","PersonIcon","elevation","ListItemAvatar","Search_SearchContextItem","listSection","placeholderText","ul","SearchContextResults","contextResults","setContextChoice","cr","fontStyle","SearchEnder","ctxItem","overflowX","SearchResults","contextChoice","onResultClick","listRef","enderRef","handleScroll","_listRef$current","scrollTop","Search_SearchEnder","subheader","onScroll","SearchPlaceholder","PlaceholderIcon","useOnline","setOnline","setOffline","newDate","online","since","TABS","tabs","Search","currentTab","setCurrentTab","defaultText","searchText","setSearchText","searchResults","onMapClick","Search_SearchResults","Search_SearchContextResults","Search_SearchPlaceholder","PortableWifiOffIcon","indicatorColor","textColor","flexContainer","centered","TAGS","withTagSearch","ceil","withUserSearch","searchStr","withGeoCode","geocoder","relevance","placeName","center","withTagSeries","tagSeries","withUserSeries","createdBy","defaultTab","jumpToSeries","jumpToMap","bboxFunc","withContextQuery","withSearchQuery","ComposedSearch","newContextChoice","newTab","gravatarImg","MeCard","onAvatarClick","filterContainer","filterChip","FILTERS","SORT","MyProfile","feed","filterVal","setFilter","sortVal","setSort","sortAsc","setSortAsc","sortSetter","newSort","filteredFeed","fi","firstname","MyProfile_MeCard","MyProfile_FilterSortItem","asc","useFilterStyles","FilterSortItem","arrow","withGetUserQuery","userQ","withuserSeriesQuery","seriesQ","withMyWatchedSeriesQuery","watchedSeriesQ","seriesQArr","watchedSeriesQArr","arraySeries","components_MyProfile_MyProfile","FeedEnder","placeAvatar","placeIcon","FindOnMapButton","Place_default","findOnMapButtonContainer","titleContainer","EVENT_VERBS","FeedItem","onImageClick","onProfileClick","misc_FindOnMapButton","listContainer","vList","feedContainer","MyFeed","events","fetchNewest","dist_es","rowCount","rowHeight","rowRenderer","isScrolling","isVisible","parent","row","MyFeed_FeedItem","wEnd","MyFeed_FeedEnder","almostAtEnd","ROWHEIGHT","Error_default","withFeedQuery","loadingNewest","loadingMore","start","myFeed","end","jumpToUser","components_MyFeed_MyFeed","OfflineBar","_useOnline","sinceStr","setSinceStr","calcSinceStr","clearTimer","BottomBar","onHomeClick","edge","HomeOutlined_default","MapOutlined_default","SearchOutlined_default","PersonOutline_default","homeConfig","offlineBar","activeWrapper","flexShrink","uploaderContainer","App","setHomeState","isVKeyBdOn","showBottomBar","ActiveComponent","FeedConnect","MapConnect","ProfileConnect","SearchConnect","SeriesConnect","misc_OfflineBar","components_BottomBar","Uploader_connect","fontFamily","ErrorScreen","BugReport_default","withAppState","Wrapped","_useAuthentication","useAuthentication","apolloClient","token","cache","InMemoryCache","authLink","setContext","_","authorization","httpLink","createHttpLink","uri","ApolloClient","link","ApolloLink","tokenName","connectToDevTools","createApolloClient","responsive","appContext","getValues","base","lib_ErrorBoundary","react_apollo_esm","client","translations_IntlWrapper","isLocalhost","registerValidSW","swUrl","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","onUpdate","onSuccess","require","ReactDOM","App_connect","href","origin","fetch","contentType","status","ready","unregister","reload","checkValidServiceWorker","cursor","editing","reversedChip","chipAvatarIcon","reversedDelete","chipBucket","reversedChipBucket","XYTagChip","onTagDragOver","onTagDragStop","onTagDelete","onNewTag","isReversed","newWidth","stopBadness","react_draggable_default","newHeight","onDrag","onStop","XYTagSelect","tc","blurInputOnSelect","header","listItem","dlgBody","XYTagChooser","xyTags","paperScrollPaper","tagType","tags_XYTagSelect","useXYTags","isDragging","setIsDragging","newTagDialog","setNewTagDialog","tagClass","addTag","updateTagLocation","oldTag","newX","newY","onAddTagTrigger","pageX","pageY","TagChooser","tags_XYTagChooser","BrokenImg","BrokenImage_default","brokenImg","setNewSize","setUrl","broken","setBroken","urlRetryCounter","setURLRetryCounter","newUrl","getURL","_useComponentSize","urlWithRetries","_useXYTags","tags_XYTagChip","subViews_BrokenImg","onError","onLoad","_event$target","naturalHeight","naturalWidth"],"mappings":"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","file":"static/js/main.d4df0db7.chunk.js","sourcesContent":["import { useCallback, useState, useLayoutEffect, useRef } from 'react'\nimport { debounce } from './util'\n\nconst getSize = (el, minSize, defaultSize) => {\n  if (!el) return defaultSize || minSize || { width: 0, height: 0 }\n\n  if (minSize) {\n    return {\n      width: Math.max(minSize.width, el.offsetWidth),\n      height: Math.max(minSize.height, el.offsetHeight)\n    }\n  }\n  else {\n    return {\n      width: el.offsetWidth,\n      height: el.offsetHeight\n    }\n  }\n}\n\nconst useComponentSize = (ref, minSize, defaultSize) => {\n  const resizeActiveRef = useRef()\n  const [resizeActive, setResizeActive] = useState(true)\n\n  resizeActiveRef.current = resizeActive\n  const [size, setComponentSize] = useState(\n    getSize(ref ? ref.current : null, minSize, defaultSize)\n  )\n\n  const handleResize = () => {\n    if (!resizeActiveRef.current || !ref.current) return\n    const newSize = getSize(ref.current, minSize, defaultSize)\n    if (newSize.height !== size.height || newSize.width !== size.width) {\n      // console.log('handleResize Called', { newSize, size })\n      setComponentSize(newSize)\n    }\n  }\n\n  const handleResizeDebounced = useCallback(\n    debounce(handleResize, 500),\n    []\n  )\n\n  useLayoutEffect(() => {\n    if (!ref.current) return\n    handleResize()\n\n    if (typeof ResizeObserver === 'function') {\n      let resizeObserver = new ResizeObserver(handleResizeDebounced)\n      resizeObserver.observe(ref.current)\n\n      return () => {\n        resizeObserver.disconnect(ref.current)\n        resizeObserver = null\n      }\n    }\n    else {\n      window.addEventListener('resize', handleResizeDebounced)\n\n      return () => {\n        window.removeEventListener('resize', handleResizeDebounced)\n      }\n    }\n  },\n  [ref.current])\n\n  return { size, setResizeActive }\n}\n\nexport default useComponentSize\n","import { useState, useEffect, useRef } from 'react'\n\nexport const useGeolocation = () => {\n  const [state, setState] = useState({\n    accuracy: null,\n    altitude: null,\n    altitudeAccuracy: null,\n    heading: null,\n    latitude: null,\n    longitude: null,\n    speed: null,\n    timestamp: Date.now()\n  })\n  const mountedRef = useRef()\n  const watchIdRef = useRef()\n  mountedRef.current = true\n\n  const onEvent = event => {\n    if (mountedRef.current) {\n      setState({\n        accuracy: event.coords.accuracy,\n        altitude: event.coords.altitude,\n        altitudeAccuracy: event.coords.altitudeAccuracy,\n        heading: event.coords.heading,\n        latitude: event.coords.latitude,\n        longitude: event.coords.longitude,\n        speed: event.coords.speed,\n        timestamp: event.timestamp\n      })\n    }\n  }\n\n  useEffect(() => {\n    navigator.geolocation.getCurrentPosition(onEvent)\n    watchIdRef.current = navigator.geolocation.watchPosition(onEvent)\n\n    return () => {\n      mountedRef.current = false\n      navigator.geolocation.clearWatch(watchIdRef.current)\n    }\n  }, [navigator.geolocation])\n\n  return state\n}\n\nexport function useDeviceOrientation () {\n  const [deviceOrientation, setDeviceOrientation] = useState({ absolute: false, alpha: null, beta: null, gamma: null })\n\n  function handleDeviceOrientation (event) {\n    setDeviceOrientation({\n      absolute: event.absolute,\n      alpha: event.alpha,\n      beta: event.beta,\n      gamma: event.gamma\n    })\n  }\n\n  useEffect(() => {\n    window.addEventListener('deviceorientation', handleDeviceOrientation, true)\n\n    return () => {\n      window.removeEventListener('deviceorientation', handleDeviceOrientation)\n    }\n  }, [])\n\n  return deviceOrientation\n}\n\nexport function playClickAudio (clickSound) {\n  let audio = new Audio('data:audio/mp3;base64,' + clickSound.base64)\n  audio.play()\n}\n\n// Detects if device is on iOS\nexport const isIos = () => {\n  return /iphone|ipad|ipod/i.test(window.navigator.userAgent || navigator.vendor || window.opera || '')\n}\n\nexport const isPhone = () => {\n  const a = (window.navigator.userAgent || navigator.vendor || window.opera || '')\n  return /(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i\n    .test(a) ||\n  /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i\n    .test(a.substr(0, 4))\n}\n","import MapStyles from './mapStyles'\n\nexport default {\n  // Bright Pastel\n  tagColors: [\n    '#418CF0', '#FCB441', '#E0400A', '#056492', '#BFBFBF', '#1A3B69', '#FFE382', '#129CDD', '#CA6B4B',\n    '#005CDB', '#F3D288', '#506381', '#F1B9A8', '#E0830A', '#7893BE'\n  ]\n}\n\nexport const mapConfig = {\n  mapBoxToken: process.env.REACT_APP_MAPBOX_TOKEN,\n  styles: MapStyles\n}\n\nlet baseurl = process.env.REACT_APP_BASEURL\nlet basename = process.env.REACT_APP_BASENAME\nlet domain = process.env.REACT_APP_DOMAIN\nif (process.env.NODE_ENV && process.env.NODE_ENV === 'development') {\n  domain = 'localhost'\n  basename = ''\n}\nconsole.log('config: ', baseurl, basename)\n\nexport const home = {\n  AppStateTypes: {\n    FEED: 'feed', // Looking at the Home Feed\n    MAP: 'map', // Looking at the map\n    SEARCH: 'search', // looking at the search\n    PROFILE: 'profile', // Looking at user information\n    SERIES: 'series', // Looking at one particular series\n    NEW_SERIES_CAMERA: 'new_series_camera', // Looking at one particular sereis\n    NEW_SERIES_LIBRARY: 'new_series_library' // Looking at one particular sereis\n  },\n  SEARCH_TABS: {\n    TAG: 'tag',\n    LOCATION: 'location',\n    USER: 'user'\n  },\n  MapModeTypes: {\n    FREE: 'free', //\n    USER: 'user', // filtered to a given user\n    TAG: 'tag' // filtered to a given tag\n  }\n}\n\nexport const federated = {\n  // oauth_config: {\n\n  // },\n  // google_client_id: process.env.REACT_APP_GOOGLE_APP_ID\n}\n\nexport const endpoints = {\n  graphql: process.env.REACT_APP_GRAPHQL\n}\n\nexport const localDb = {\n  imgStore: 'imgStore'\n}\n\nexport const aws = {\n  Auth: {\n    // REQUIRED - Amazon Cognito Identity Pool ID\n    // identityPoolId: process.env.REACT_APP_COGNITO_IDPOOLID, // XX-XXXX-X:XXXXXXXX-XXXX-1234-abcd-1234567890ab\n    // REQUIRED - Amazon Cognito Region\n    region: process.env.REACT_APP_AWS_REGION,\n    // OPTIONAL - Amazon Cognito User Pool ID\n    userPoolId: process.env.REACT_APP_COGNITO_USER_POOL_ID,\n    // OPTIONAL - Amazon Cognito Web Client ID (26-char alphanumeric string)\n    userPoolWebClientId: process.env.REACT_APP_COGNITO_CLIENT_ID,\n    // OPTIONAL - Enforce user authentication prior to accessing AWS resources or not\n    mandatorySignIn: true,\n    // OPTIONAL - Configuration for cookie storage\n    cookieStorage: {\n      // REQUIRED - Cookie domain (only required if cookieStorage is provided)\n      domain: `${domain}`,\n      // OPTIONAL - Cookie path\n      // path: `/${basename}`,\n      // OPTIONAL - Cookie expiration in days\n      expires: 20,\n      // OPTIONAL - Cookie secure flag\n      secure: false\n    }\n\n  }\n\n}\n\nexport const ACCESS = {\n  OPEN: {\n    label: 'Open',\n    description: 'Open series can be seen and contributed to by anyone',\n    color: 'green'\n  },\n  PRIVATE: {\n    label: 'Private',\n    description: 'Private series can only be seen by their createors',\n    color: 'red'\n  },\n  PUBLIC: {\n    label: 'Public',\n    description: 'Public series can be seen by everyone',\n    color: 'blue'\n  }\n}\n","const TYPES = {\n  // Series meta gets appended automatically to the seriees\n  SERIES: 'SERIES',\n  // Same but now only gets appended to the photo\n  PHOTO: 'PHOTO'\n}\nclass SeriesConfig {\n  constructor (seriesConfig) {\n    if (!seriesConfig) throw new Error('No seriesConfig object provided to SeriesConfig class')\n    this.config = seriesConfig\n  }\n\n  getTagType = (typeId) => this.config.tags.find(tt => tt.id === typeId)\n  // getTagTypeIndex = (typeId) => this.config.tags.findIndex(tt => tt.id === typeId)\n  getTagTypeIndex = (typeId) => {\n    // console.log('HERE', typeId)\n    return this.config.tags.findIndex(tt => tt.id === typeId)\n  }\n\n  getXYTagTypes = () => this.config.tags.filter(tt => tt.allowXY)\n  getNonXYTagTypes = () => this.config.tags.filter(tt => tt.allowNonXY)\n\n  getSeriesMeta = () => Object.keys(this.config.meta)\n    .filter(key => this.config.meta[key].type === TYPES.SERIES)\n    .reduce((acc, key) => ({\n      ...acc,\n      [key]: this.config.meta[key].default\n    }), {})\n\n  getPhotoMeta = () => Object.keys(this.config.meta)\n    .filter(key => this.config.meta[key].type === TYPES.PHOTO)\n    .reduce((acc, key) => ({\n      ...acc,\n      [key]: this.config.meta[key].default\n    }), {})\n}\n\nexport default SeriesConfig\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Chip from '@material-ui/core/Chip'\nimport CancelIcon from '@material-ui/icons/Cancel'\nimport { makeStyles, useTheme } from '@material-ui/core/styles'\n\nexport const tagChips = {\n  height: 20\n}\n\nconst style = theme => ({\n  root: {\n    fontSize: '0.6em',\n    height: tagChips.height,\n    marginRight: theme.spacing(1) / 2,\n    marginTop: theme.spacing(1) / 2\n  },\n  deleteIcon: {\n    width: tagChips.height - 1,\n    height: tagChips.height - 1\n  },\n  chipAvatar: {\n    width: tagChips.height,\n    height: tagChips.height\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst TagChip = ({ edit, tag, color, onDelete, ...props }) => {\n  const classes = useStyles()\n  const theme = useTheme()\n  return (\n    <Chip\n      style={{\n        background: color || null,\n        color: color ? `${theme.palette.getContrastText(color)}` : null\n      }}\n      label={tag.label}\n      data={tag.id}\n      onDelete={edit ? () => onDelete(tag) : null}\n      deleteIcon={(\n        <CancelIcon\n          className={classes.deleteIcon}\n          onClick={e => {\n            console.log('this click')\n          }}\n          style={{\n            opacity: 0.5,\n            color: color ? `${theme.palette.getContrastText(color)}` : null\n          }}\n        />\n      )}\n      className={classes.root}\n      {...props}\n    />\n  )\n}\n\nTagChip.propTypes = {\n  color: PropTypes.string.isRequired,\n  edit: PropTypes.bool,\n  tag: PropTypes.object.isRequired,\n  onDelete: PropTypes.func\n}\n\nexport default TagChip\n","import React from 'react'\nimport classNames from 'classnames'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport FormLabel from '@material-ui/core/FormLabel'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n    position: 'relative',\n    display: 'block',\n    overflow: 'hidden',\n    whiteSpace: 'pre-line',\n    '&::before': {\n      content: '\"  \"',\n      display: 'block',\n      position: 'absolute',\n      bottom: 0,\n      width: '100%',\n      height: 100,\n      background: `linear-gradient(180deg, rgba(255,255,255,0) 0%, ${theme.palette.background.paper} 100%)`\n    }\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst ShortLongText = ({ label, text, height, onClick }) => {\n  const classes = useStyles()\n  return (\n    <div onClick={onClick}>\n      {label && (\n        <FormLabel className={classes.formLabel}>\n          {label}\n        </FormLabel>\n      )}\n      <Typography\n\n        variant='body1'\n        color='inherit'\n        style={{ height }}\n        className={classNames(classes.root)}\n      >\n        {text}\n      </Typography>\n    </div>\n  )\n}\n\nShortLongText.propTypes = {\n  label: PropTypes.string,\n  text: PropTypes.string,\n  height: PropTypes.number,\n  onClick: PropTypes.func\n}\nShortLongText.defaultProps = {\n  height: 100\n}\n\nexport default ShortLongText\n","import uuid from 'uuid/v4'\nimport SeriesConfig from './SeriesConfig'\n\nclass Tags {\n  constructor (seriesConfig, tags) {\n    this.tags = tags\n    this.seriesConfig = new SeriesConfig(seriesConfig)\n  }\n\n  findTagById = (typeId, tagId) => {\n    return this.seriesConfig.getTagType(typeId).values\n      .find(tt => tt.id === tagId)\n  }\n\n  // Filter the list of tags to those that are XY tags\n  getXYTags = () => {\n    const xyTagIds = this.seriesConfig.getXYTagTypes().map(tt => tt.id)\n    return this.tags.filter(tag => xyTagIds.indexOf(tag.typeId) > -1 && tag.coords && tag.coords.x)\n  }\n\n  getNonXYTags = () => {\n    const NonXYTagIds = this.seriesConfig.getNonXYTagTypes().map(tt => tt.id)\n    return this.tags.filter(tag => NonXYTagIds.indexOf(tag.typeId) > -1)\n  }\n\n  createNewTagObj = (label, typeId) => (\n    { id: uuid(), label, typeId }\n  )\n\n  createExistingTagObj = (id, typeId) => ({\n    ...this.findTagById(typeId, id),\n    typeId\n  })\n\n  createNewXYTagObj = (label, typeId, coords) => ({\n    id: uuid(),\n    label,\n    typeId,\n    coords\n  })\n\n  createExistingXYTagObj = (id, typeId, coords) => ({\n    ...this.findTagById(typeId, id),\n    typeId,\n    coords\n  })\n\n  // Get tags in a way that's easy to render them\n  // We augment these tags with relative positions\n  // and a group number for coloring.\n  getRelXYTags = (multiplier) => this.getXYTags().map(tag => ({\n    ...tag,\n    group: this.seriesConfig.getTagTypeIndex(tag.typeId),\n    relCoords: {\n      x: tag.coords.x * multiplier,\n      y: tag.coords.y * multiplier\n    }\n  }))\n}\n\nexport default Tags\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n    color: theme.palette.primary.main,\n    position: 'absolute',\n    top: '50%',\n    left: '50%',\n    textAlign: 'center',\n    transformOrigin: '50% 50%',\n    transform: 'translateY(-50%) translateX(-50%)',\n    zIndex: 1\n  },\n  rootActive: {\n    zIndex: 1000\n  },\n  svgDot: {\n    zIndex: 102,\n    width: 20,\n    height: 20,\n    position: 'absolute',\n    top: '50%',\n    left: '50%',\n    textAlign: 'center',\n    transformOrigin: '50% 50%',\n    transform: 'translateY(-50%) translateX(-50%)'\n  },\n  dot: {\n    stroke: theme.palette.secondary.contrastText,\n    strokeWidth: '1',\n    fill: theme.palette.secondary.main\n  },\n  directionIndicator: {\n    position: 'absolute',\n    left: '50%',\n    // transformOrigin: '50% 50%',\n    // transform: 'translateY(-50%) translateX(-50%)',\n    zIndex: 100\n  },\n  name: {\n    color: 'white',\n    fontWeight: 'bold',\n    textShadow: `\n        0px 0px 4px #000000, \n        0px 0px 4px #000000 \n    `,\n    zIndex: 122,\n    position: 'relative'\n    // textStroke: '1px white'\n  },\n  nameActive: {\n    color: theme.palette.secondary.dark,\n    textShadow: `\n    0px 0px 2px #FFFFFF, \n    0px 0px 2px #FFFFFF,\n    0px 0px 4px #FFFFFF \n`\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst Single = ({ direction }) => {\n  const classes = useStyles()\n  return (\n    <div className={classes.root}>\n      <svg className={classes.svgDot} version='1.1' viewBox='0, 0, 10, 10' >\n        <circle cx='5' cy='5' r='4' className={classes.dot} />\n      </svg>\n      {direction && direction >= 0 ? (\n        <div className={classes.directionIndicator}>\n          <svg className={classes.svgArc}\n            version='1.1'\n            width='100'\n            height='100'\n            viewBox='0, 0, 100, 100'\n            style={{ transform: `translateY(-50%) translateX(-50%) rotateZ(${direction}deg)` }}>\n            <path d='M50,0 C60.946,0.151 72.136,3.514 80.675,10.56 L50,50 L19.325,10.56 C27.938,3.461 39,0.278 50,0 z'\n              fill='#009DC1'\n              fillOpacity='0.444'\n              strokeWidth='0.5'\n              strokeOpacity='0.6'\n              stroke='#FFFFFF'\n            />\n          </svg>\n        </div>\n      ) : null}\n    </div>\n  )\n}\n\nSingle.propTypes = {\n  direction: PropTypes.number\n}\n\nexport default Single\n","import React, { useState, useRef, useMemo } from 'react'\nimport { StaticMap } from 'react-map-gl'\nimport PropTypes from 'prop-types'\nimport { getDistanceScales } from 'viewport-mercator-project'\nimport useComponentSize from '../../lib/useComponentSize'\nimport StyleButtons from './controls/StyleButtons'\nimport { mapConfig } from '../../config'\nimport classNames from 'classnames'\nimport 'mapbox-gl/dist/mapbox-gl.css'\nimport './BaseMap.css'\n\n/**\n * Note that this component technically has state but it is designed to be functionally stateless\n */\nconst BaseStaticMap = (props) => {\n  const {\n    controlPadding,\n    viewport,\n    children,\n    mapStyles,\n    onMapDataEvent,\n    ...passthroughProps\n  } = props\n\n  const mapRef = useRef(null)\n  const { size } = useComponentSize(mapRef, { width: 100, height: 50 })\n\n  const [currStyle, setCurrStyle] = useState(0)\n  const [projection, setProjection] = useState(null)\n\n  const recalcProjection = () => {\n    if (!size || size.width < 10 || size.height < 10) return\n    try {\n      const projection = getDistanceScales(viewport)\n      // console.log('recalcProjection', { projection, size })\n      setProjection(projection)\n    }\n    catch (e) {\n      // Sometimes we don't have a valid bound. Don't make a big deal out of it.\n      console.error(e)\n    }\n  }\n\n  if (!projection) recalcProjection()\n  useMemo(recalcProjection, [size])\n\n  return (\n    <div className={classNames('BaseMap', props.className)} ref={mapRef} style={{ height: '100%', width: '100%' }}>\n      <StaticMap\n        {...viewport}\n        height={size.height}\n        width={size.width}\n        mapStyle={mapStyles[currStyle].style}\n        onData={onMapDataEvent}\n        mapboxApiAccessToken={mapConfig.mapBoxToken}\n        {...passthroughProps}\n      >\n        { mapStyles && mapStyles.length > 1 ? (\n          <StyleButtons\n            controlPadding={controlPadding}\n            currStyle={currStyle}\n            mapStyles={mapStyles}\n            setCurrStyle={setCurrStyle}\n          />\n        ) : null }\n        {\n          children && Array.isArray(children)\n            ? children.map(c => handleChild(c, viewport, size.height, size.width, projection))\n            : handleChild(children, viewport, size.height, size.width, projection)\n        }\n      </StaticMap>\n    </div>\n  )\n}\n\nfunction handleChild (child, viewport, height, width, projection) {\n  return typeof child === 'function'\n    ? child(viewport, height, width, projection)\n    : child\n}\n\nBaseStaticMap.propTypes = {\n  // Anything else we want to add to the map\n  children: PropTypes.any,\n  deckelements: PropTypes.array,\n  data: PropTypes.array,\n  // Maybe we want map controls to be padded\n  controlPadding: PropTypes.object,\n\n  minPitch: PropTypes.number,\n  maxPitch: PropTypes.number,\n  pitch: PropTypes.number,\n\n  // Lock the bounds of a map to a rectangle [minlng, minlat], [maxlng, maxlat]\n  bounds: PropTypes.array,\n  // Lock the possible zoom levels to a range: [minZoom, maxZoom]\n  zoomBounds: PropTypes.array,\n  // InitialBounds of the map.\n  InnerBounds: PropTypes.array,\n\n  // List of valid styles that will get picker buttons\n  mapStyles: PropTypes.array,\n\n  // Just some default props we probably won't set.\n  latitude: PropTypes.number,\n  longitude: PropTypes.number,\n  zoom: PropTypes.number,\n\n  onMapDataEvent: PropTypes.func\n}\nBaseStaticMap.defaultProps = {\n  controlPadding: {},\n  stylechooser: true,\n  // viewport: {\n  //   zoom: 12,\n  //   latitude: 49.3050394,\n  //   longitude: -123.1398254\n  // },\n  initStyle: 0,\n  mapStyles: mapConfig.styles\n}\n\nexport default BaseStaticMap\n","import React from 'react'\nimport PropTypes from 'prop-types'\n// import { makeStyles } from '@material-ui/core/styles'\nimport { Marker } from 'react-map-gl'\nimport BaseMap from './BaseMap'\nimport Dot from './markers/Dot'\nimport BaseStaticMap from './BaseStaticMap'\n// import style from './MapDot.style'\n\n// const useStyles = makeStyles(style)\n\nconst MapDot = ({ staticMap, editable, latitude, longitude, onChange, direction, ...props }) => {\n  const Map = staticMap ? BaseStaticMap : BaseMap\n  // const classes = useStyles()\n  const mapProps = staticMap ? {} : {\n    touchRotate: false,\n    dragRotate: false,\n    showMe: editable,\n    lockPan: !editable,\n    onViewportChange: onChange\n  }\n\n  return (\n    <Map\n      {...mapProps}\n      {...props}\n    >\n      {latitude && longitude ? (\n        <Marker\n          className={'singleMarker'}\n          latitude={latitude}\n          longitude={longitude}\n        >\n          <Dot direction={direction} />\n        </Marker>\n      )\n        : <Dot direction={direction} />\n      }\n\n    </Map>\n  )\n}\n\nMapDot.propTypes = {\n  direction: PropTypes.number,\n  latitude: PropTypes.number,\n  longitude: PropTypes.number,\n  editable: PropTypes.bool,\n  staticMap: PropTypes.bool,\n  onChange: PropTypes.func\n}\n\nexport default MapDot\n","import Satellite from './Satellite.json'\n// import BasicMap from './BasicMap.json'\nimport TopoMap from './TopoMap.json'\n\nimport {\n  Satellite as SatIcon,\n  SatelliteOutlined,\n  // DirectionsCar,\n  // DirectionsCarOutlined,\n  Terrain,\n  TerrainOutlined\n} from '@material-ui/icons'\n\nexport default [\n  {\n    toolTip: 'Sat',\n    Icon: SatelliteOutlined,\n    ActiveIcon: SatIcon,\n    color: 'green',\n    style: Satellite\n  },\n  {\n    toolTip: 'Topo',\n    Icon: TerrainOutlined,\n    ActiveIcon: Terrain,\n    color: 'blue',\n    style: TopoMap\n  }\n]\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\nimport SpeedDial from '@material-ui/lab/SpeedDial'\nimport SpeedDialAction from '@material-ui/lab/SpeedDialAction'\n// import MapLayersIcon from '@material-ui/icons/Layers'\nimport { makeStyles, useTheme } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n    zIndex: 10,\n    position: 'absolute'\n  },\n  speedDialFab: {\n    border: '2px solid',\n    background: theme.palette.secondary.main,\n    color: theme.palette.secondary.contrastText,\n    width: 40,\n    height: 40\n  },\n  speedDialAction: {\n    border: '2px solid',\n    background: theme.palette.primary.main,\n    color: theme.palette.primary.contrastText,\n    marginTop: 0,\n    marginBottom: 0\n  },\n  speedDialIcon: {\n    // border: '1px solid red'\n  },\n  speedDialLabel: {\n    background: 'black',\n    color: 'white'\n  }\n})\n\nconst useStyles = makeStyles(style)\n\nconst StyleButtons = ({ controlPadding, currStyle, mapStyles, setCurrStyle }) => {\n  const [open, setOpen] = useState(false)\n  const classes = useStyles()\n  const theme = useTheme()\n  const noEventSetOpen = (e, state) => {\n    console.log('noEventSetOpen', e, state)\n    e.preventDefault()\n    e.stopPropagation()\n    setOpen(state)\n  }\n\n  if (!mapStyles || !Array.isArray(mapStyles) || mapStyles.length < 2 || !mapStyles[currStyle]) return null\n\n  const currStyleObj = mapStyles[currStyle]\n  const ActiveIcon = currStyleObj.ActiveIcon\n\n  return (\n    <div className={classes.root} style={{\n      top: controlPadding.top ? controlPadding.top : theme.spacing(2),\n      right: controlPadding.right ? controlPadding.right : theme.spacing(2)\n    }}>\n      {mapStyles.length > 1 && (\n        <SpeedDial\n          ariaLabel='SpeedDial example'\n          className={classes.speedDial}\n          classes={{\n            fab: classes.speedDialFab\n          }}\n          icon={<ActiveIcon className={classes.icon} />}\n          // onBlur={(e) => noEventSetOpen(e, false)}\n          onClick={(e) => noEventSetOpen(e, !open)}\n          onClose={(e) => noEventSetOpen(e, false)}\n          // onFocus={(e) => noEventSetOpen(e, true)}\n          // onMouseEnter={(e) => noEventSetOpen(e, true)}\n          // onMouseLeave={(e) => noEventSetOpen(e, false)}\n          open={open}\n          direction='left'\n        >\n\n          {mapStyles.map(({ Icon, ActiveIcon, toolTip }, idx) => (\n            <SpeedDialAction\n              key={`stylebutton${idx}`}\n              // Bit of a hack here. This function isn't quite ready for primetime\n              icon={<Icon className={classes.speedDialIcon} />}\n              tooltipPlacement='bottom'\n              ButtonProps={{\n                classes: {\n                  root: classes.speedDialAction\n                }\n              }}\n              TooltipClasses={{\n                tooltip: classes.speedDialLabel\n              }}\n              tooltipTitle={toolTip}\n              tooltipOpen\n              onClick={() => {\n                console.log('SET', idx)\n                setCurrStyle(idx)\n                setOpen(false)\n              }}\n            />\n          ))}\n\n        </SpeedDial>\n      ) }\n    </div>\n  )\n}\n\nStyleButtons.propTypes = {\n  // controlPadding: {top, right, bottom, left}\n  controlPadding: PropTypes.object,\n  currStyle: PropTypes.number,\n  mapStyles: PropTypes.array,\n  setCurrStyle: PropTypes.func\n}\nStyleButtons.defaultProps = {\n  controlPadding: {}\n}\n\nexport default StyleButtons\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport Dialog from '@material-ui/core/Dialog'\nimport IconButton from '@material-ui/core/IconButton'\nimport DialogTitle from '@material-ui/core/DialogTitle'\n\nimport CloseIcon from '@material-ui/icons/Close'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n\n  },\n  body: {\n    overflow: 'hidden',\n    whiteSpace: 'pre-line',\n    paddingBottom: theme.spacing(1)\n  },\n  title: {\n    alignSelf: 'flex-start',\n    width: '100%',\n    margin: 0,\n    display: 'flex',\n    padding: theme.spacing(2)\n  },\n  dlgTitle: {\n    flexGrow: 1\n  },\n  closeButton: {\n    alignSelf: 'flex-start',\n    color: theme.palette.grey[500]\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst BigText = ({ open, onClose, title, body }) => {\n  const classes = useStyles()\n  return (\n    <Dialog\n      scroll='paper'\n      open={open}\n      fullWidth\n      maxWidth='xl'\n      onClose={onClose}\n      aria-labelledby='simple-dialog-title'\n    >\n      <DialogTitle className={classes.title} disableTypography>\n        <Typography className={classes.dlgTitle}>{title}</Typography>\n        <IconButton className={classes.closeButton} onClick={onClose}>\n          <CloseIcon />\n        </IconButton>\n      </DialogTitle>\n      <DialogContent>\n        <Typography variant='body2' className={classes.body}>{body}</Typography>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nBigText.propTypes = {\n  open: PropTypes.bool,\n  onClose: PropTypes.func,\n  title: PropTypes.string,\n  body: PropTypes.string\n}\n\nexport default BigText\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport Button from '@material-ui/core/Button'\nimport Typography from '@material-ui/core/Typography'\nimport DialogActions from '@material-ui/core/DialogActions'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n\n})\nconst useStyles = makeStyles(style)\n\nconst DeleteDialog = ({ title, message, onConfirm, open }) => {\n  const classes = useStyles()\n  return (\n    <Dialog\n      className={classes.root}\n      disableBackdropClick\n      open={open}\n      disableEscapeKeyDown\n      maxWidth='xl'\n      aria-labelledby='confirmation-dialog-title'\n    >\n      <DialogTitle id='confirmation-dialog-title'>{title}</DialogTitle>\n      <DialogContent>\n        <Typography>\n          {message}\n        </Typography>\n\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={() => onConfirm(false)} color='primary'>\n      No\n        </Button>\n        <Button onClick={() => onConfirm(true)} color='primary'>\n      Yes\n        </Button>\n      </DialogActions>\n    </Dialog>\n  )\n}\n\nDeleteDialog.propTypes = {\n  open: PropTypes.bool,\n  title: PropTypes.string.isRequired,\n  message: PropTypes.string.isRequired,\n  onConfirm: PropTypes.func.isRequired\n}\n\nexport default DeleteDialog\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\n// import Typography from '@material-ui/core/Typography'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogActions from '@material-ui/core/DialogActions'\nimport TextField from '@material-ui/core/TextField'\nimport Button from '@material-ui/core/Button'\nimport DialogTitle from '@material-ui/core/DialogTitle'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n\n  },\n  body: {\n    overflow: 'hidden',\n    whiteSpace: 'pre-line',\n    paddingBottom: theme.spacing(1)\n  },\n  title: {\n    margin: 0,\n    padding: theme.spacing(2)\n  },\n  closeButton: {\n    position: 'absolute',\n    right: theme.spacing(1),\n    top: theme.spacing(1),\n    color: theme.palette.grey[500]\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst BigTextEdit = ({ open, onOk, title, body, multiline }) => {\n  const classes = useStyles()\n  const [value, setValue] = useState(body || '')\n  return (\n    <Dialog\n      scroll='paper'\n      open={open}\n      fullWidth\n      onClose={() => onOk(value)}\n    >\n      <DialogTitle className={classes.title}>\n        {title}\n      </DialogTitle>\n      <DialogContent>\n        <TextField\n          className={classes.body}\n          multiline={multiline}\n          fullWidth\n          rows={6}\n          rowsMax={20}\n          onChange={e => setValue(e.target.value)}\n          defaultValue={body}\n        />\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={() => onOk(body)}>Cancel</Button>\n        <div style={{ flexGrow: 1 }} />\n        <Button onClick={() => onOk(value)}>Ok</Button>\n      </DialogActions>\n    </Dialog>\n  )\n}\n\nBigTextEdit.propTypes = {\n  open: PropTypes.bool,\n  multiline: PropTypes.bool,\n  onOk: PropTypes.func,\n  title: PropTypes.string,\n  body: PropTypes.string\n}\n\nexport default BigTextEdit\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport Slider from '@material-ui/lab/Slider'\n// import { Menu as MenuIcon } from '@material-ui/icons'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n    color: 'white',\n    zIndex: 10,\n    display: 'flex',\n    flexDirection: 'column',\n    position: 'absolute',\n    height: '50%',\n    top: '45%',\n    left: '0',\n    transform: 'translateY(-50%)'\n  },\n  sliderLabel: {\n    display: 'block',\n    flexGrow: 1,\n    textAlign: 'center',\n    padding: theme.spacing(3, 0, 3, 0)\n  },\n  container: {\n    // padding: '10px 36px'\n  },\n  track: {\n    width: `4px!important`,\n    background: 'white'\n  },\n  thumb: {\n    transform: 'translate(50%, -50%)',\n    background: 'white',\n    width: 30,\n    height: 30\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst PhotoFadeSlider = ({ defaultValue, onChange }) => {\n  const classes = useStyles()\n  // we control the state internally so we get a smooth experience\n  const [slider, setSlider] = useState(defaultValue)\n\n  const onSliderMove = (event, value) => {\n    setSlider(value)\n    // send it back if we need to\n    onChange(value)\n  }\n\n  return (\n    <div className={classes.root}>\n      <Typography className={classes.sliderLabel} color='inherit' variant='caption'>New</Typography>\n      <Slider\n        classes={{\n          container: classes.container,\n          track: classes.track,\n          thumb: classes.thumb\n        }}\n        value={slider}\n        aria-labelledby='label'\n        onChange={onSliderMove}\n        vertical\n      />\n      <Typography className={classes.sliderLabel} color='inherit' variant='caption'>Reference</Typography>\n    </div>\n  )\n}\n\nPhotoFadeSlider.propTypes = {\n  defaultValue: PropTypes.number,\n  onChange: PropTypes.func\n}\n\nPhotoFadeSlider.defaultProps = {\n  defaultValue: 100,\n  onChange: () => {}\n}\n\nexport default PhotoFadeSlider\n","export default theme => ({\n  root: {\n    width: '100%'\n  },\n  tagContainer: {\n  },\n  formControl: {\n\n  },\n  actionButtons: {\n    textAlign: 'right'\n  },\n  noOptionsMessage: {\n    padding: theme.spacing(1, 2)\n  },\n  singleValue: {\n    fontSize: 16\n  },\n  placeholder: {\n    position: 'absolute',\n    left: 2,\n    fontSize: 16\n  },\n  input: {\n    display: 'flex',\n    padding: 0\n  },\n  valueContainer: {\n    display: 'flex',\n    flexWrap: 'wrap',\n    flex: 1,\n    alignItems: 'center',\n    overflow: 'hidden'\n  },\n  paper: {\n    position: 'absolute',\n    zIndex: 1,\n    marginTop: theme.spacing(1),\n    left: 0,\n    right: 0\n  }\n})\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport Typography from '@material-ui/core/Typography'\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport TagChip from '../tags/TagChip'\nimport style from './TagControl.style'\n\nconst useStyles = makeStyles(style)\n/**\n * Just to be clear: the state here is being stored as []\n */\nconst TagControl = ({ tags, label, tagConfig, className }) => {\n  const classes = useStyles()\n  // Filter to just this tag type\n  const tagValues = tags.filter(tag => tag.typeId === tagConfig.id && !tag.coords)\n\n  return (\n    <div className={classNames(classes.root, className)}>\n      <Typography variant='overline' className={classes.fieldTitle}>\n        {tagConfig.label}\n      </Typography>\n      <div className={classes.tagContainer}>\n        {tagValues.map((tag, idx) => (\n          <TagChip tag={tag} key={`tagchip${idx}`} color={tagConfig.color} />\n        ))}\n      </div>\n\n    </div>\n  )\n}\n\nTagControl.propTypes = {\n  className: PropTypes.string,\n  label: PropTypes.string,\n  tags: PropTypes.array,\n  tagConfig: PropTypes.object\n}\n\nexport default TagControl\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport {\n  TextField,\n  Typography\n} from '@material-ui/core'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { timestampToHTML5Input, HTML5InputToTimestamp } from '../../../../lib/datelib'\n\nconst style = theme => ({\n  root: {\n  },\n  rootEdit: {\n  },\n  formControl: {\n    width: '100%'\n  },\n  textBody: {\n    whiteSpace: 'pre-line'\n  },\n  actionButtons: {\n    textAlign: 'right'\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst DateControl = ({\n  label,\n  value,\n  hint,\n  onChange,\n  className\n}) => {\n  const classes = useStyles()\n  return (\n    <div className={classNames(classes.root, className)}>\n      <Typography variant='overline' className={classes.fieldTitle}>\n        {label}\n      </Typography>\n      <TextField\n        type='datetime-local'\n        fullWidth\n        value={timestampToHTML5Input(value)}\n        className={classes.textField}\n        onChange={(e) => onChange(HTML5InputToTimestamp(e.target.value))}\n      />\n      {hint && <Typography variant='caption' className={classes.hint}>{hint}</Typography>}\n    </div>\n  )\n}\n\nDateControl.propTypes = {\n  className: PropTypes.string,\n  label: PropTypes.string.isRequired,\n  hint: PropTypes.string,\n  value: PropTypes.string, // all timestamps come in as integerstrings\n  onChange: PropTypes.func.isRequired\n}\n\nexport default DateControl\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport uuid from 'uuid/v4'\nimport Paper from '@material-ui/core/Paper'\nimport TextField from '@material-ui/core/TextField'\nimport Typography from '@material-ui/core/Typography'\nimport MenuItem from '@material-ui/core/MenuItem'\n\nimport Select from 'react-select'\nimport CreatableSelect from 'react-select/lib/Creatable'\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport TagChip from '../tags/TagChip'\nimport style from './TagControl.style'\nconst useStyles = makeStyles(style)\n\n/**\n * Just to be clear: the state here is being stored as []\n */\nconst TagControl = ({\n  tags, onChange,\n  hint, tagConfig, className\n}) => {\n  const classes = useStyles()\n  // console.log('TagControl Rnder', { tags, tagConfig })\n  const onSelectChange = (inputValue, { action, removedValue, option }) => {\n    // If this was the last tag then close the menu\n    switch (action) {\n      case 'clear':\n        onChange([])\n        break\n      case 'remove-value':\n        // Remember we need to potentially remove it from the old AND the new\n        onChange(tags.filter(val => val.id !== removedValue.value))\n        break\n      case 'select-option':\n        const newVal = {\n          ...tagConfig.values.find(tcv => tcv.id === option.value),\n          typeId: tagConfig.id\n        }\n        onChange([...tags, newVal])\n        break\n      case 'create-option':\n        const newLabel = inputValue.find(v => v.__isNew__).value\n        const newCreateVal = {\n          label: newLabel,\n          id: uuid(),\n          typeId: tagConfig.id\n        }\n        onChange([...tags, newCreateVal])\n        break\n      default:\n        break\n    }\n  }\n\n  const SingleValue = ({ removeProps, innerProps, data, ...props }) => {\n    // console.log('SingleValue PROPS', { removeProps, innerProps, data, props })\n    return (\n      <TagChip tag={data} onDelete={(e) => {\n        // console.log('EVENT', e)\n        removeProps.onClick()\n      }} color={tagConfig.color} edit />\n    )\n  }\n  SingleValue.propTypes = {\n    removeProps: PropTypes.any,\n    innerProps: PropTypes.any,\n    data: PropTypes.any\n  }\n\n  const MultiValue = ({ removeProps, innerProps, data, ...props }) => {\n    // console.log('MultiValue PROPS', { removeProps, innerProps, data, props })\n    return (\n      <TagChip tag={data} onDelete={(e) => {\n        // console.log('EVENT', e)\n        removeProps.onClick()\n      }} color={tagConfig.color} edit />\n    )\n  }\n  MultiValue.propTypes = {\n    removeProps: PropTypes.any,\n    innerProps: PropTypes.any,\n    data: PropTypes.any\n  }\n\n  // Filter to just this tag type\n  const tagValues = tags.filter(tag => tag.typeId === tagConfig.id && !tag.coords)\n  // Now format it as {label, value: id} for react-select\n  const selectOptions = tagValues.map(val => ({ label: val.label, value: val.id }))\n\n  // Filter out things we haven't chosen yet\n  // Also transform the options into a label/value pair for react-select\n  const remainingTags = tagConfig.values\n    .filter(val => tagValues.map(t => t.id).indexOf(val.id) === -1)\n    .map(val => ({ label: val.label, value: val.id }))\n\n  // console.log('TAG DEBUG', { value, tagValues, tagConfig })\n\n  return (\n    <div className={classNames(classes.root, className)}>\n      <Typography variant='overline' className={classes.fieldTitle}>\n        {tagConfig.label}\n      </Typography>\n      {!tagConfig.allowAdditions && (\n        <Select\n          options={remainingTags}\n          classes={classes}\n          isFocused\n          components={{\n            Control,\n            Menu,\n            //   MultiValue,\n            NoOptionsMessage,\n            Option,\n            Placeholder,\n            //   SingleValue,\n            ValueContainer\n          }}\n          deleteRemoves\n          value={selectOptions}\n          isClearable={false}\n          onChange={onSelectChange}\n          placeholder='Select Tags'\n          isMulti\n          isSearchable\n        />\n      ) }\n      { tagConfig.allowAdditions && (\n        <CreatableSelect\n          options={remainingTags}\n          classes={classes}\n          isFocused\n          deleteRemoves\n          components={{\n            Control,\n            Menu,\n            //   MultiValue,\n            NoOptionsMessage,\n            Option,\n            Placeholder,\n            //   SingleValue,\n            ValueContainer\n          }}\n          value={selectOptions}\n          isClearable={false}\n          onChange={onSelectChange}\n          placeholder='Select Tags'\n          isMulti\n          isSearchable\n        />\n      )}\n      {hint && <Typography variant='caption' className={classes.hint}>{hint}</Typography>}\n    </div>\n  )\n}\n\nTagControl.propTypes = {\n  className: PropTypes.string,\n  hint: PropTypes.string,\n  tags: PropTypes.array,\n  onChange: PropTypes.func.isRequired,\n  tagConfig: PropTypes.object\n}\n\nexport default TagControl\n\nfunction Control (props) {\n  // console.log('CONTROL PROPS', props)\n  return (\n    <TextField\n      fullWidth\n      InputProps={{\n        inputComponent,\n        inputProps: {\n          className: props.selectProps.classes.input,\n          inputRef: props.innerRef,\n          children: props.children,\n          // innerProps: {\n          onMouseDown: (e) => {\n            props.innerProps.onMouseDown(e)\n          },\n          onTouchEnd: (e) => {\n            props.innerProps.onTouchEnd(e)\n          }\n          // }\n          // ...props.innerProps\n        }\n      }}\n      {...props.selectProps.textFieldProps}\n    />\n  )\n}\n\nconst NoOptionsMessage = ({ innerProps, selectProps, children }) => (\n  <Typography\n    color='textSecondary'\n    className={selectProps.classes.noOptionsMessage}\n    {...innerProps}\n  >\n    {children}\n  </Typography>\n)\n\nconst Menu = ({ selectProps, innerProps, children }) => (\n  <Paper square className={selectProps.classes.paper} {...innerProps}>\n    {children}\n    {/* {console.log('MENU PROPS', { selectProps, innerProps, children })} */}\n  </Paper>\n)\n\nconst inputComponent = ({ inputRef, ...props }) => <div ref={inputRef} {...props} />\n\nconst Placeholder = (props) => (\n  <Typography\n    color='textSecondary'\n    className={props.selectProps.classes.placeholder}\n    {...props.innerProps}\n  >\n    {props.children}\n  </Typography>\n)\n\nconst Option = ({ innerRef, isFocused, isSelected, innerProps, children }) => (\n  <MenuItem\n    buttonRef={innerRef}\n    selected={isFocused}\n    component='div'\n    style={{ fontWeight: isSelected ? 500 : 400 }}\n    {...innerProps}\n  >\n    {children}\n  </MenuItem>\n)\n\nconst ValueContainer = ({ selectProps, children }) => (\n  <div className={selectProps.classes.valueContainer}>{children}</div>\n)\nValueContainer.propTypes = {\n  selectProps: PropTypes.any,\n  children: PropTypes.any\n}\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\n// import Typography from '@material-ui/core/Typography'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport Typography from '@material-ui/core/Typography'\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogActions from '@material-ui/core/DialogActions'\nimport Button from '@material-ui/core/Button'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport IconButton from '@material-ui/core/IconButton'\n\nimport CloseIcon from '@material-ui/icons/Close'\nimport TagControl from '../controls/TagControl'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n  },\n  dlgContent: {\n    // position: 'relative',\n    // maxWidth: '200px',\n    overflowY: 'visible!important',\n    paddingBottom: 300\n    // overflowX: 'hidden'\n  },\n  title: {\n    width: '100%',\n    margin: 0,\n    display: 'flex',\n    padding: theme.spacing(2)\n  },\n  dlgTitle: {\n    flexGrow: 1\n  },\n  closeButton: {\n    color: theme.palette.grey[500]\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst TagEdit = ({ open, title, onOk, onCancel, tags, tagConfig }) => {\n  const classes = useStyles()\n  const [value, setValue] = useState(tags)\n  return (\n    <Dialog\n      className={classes.root}\n      scroll='body'\n      fullScreen\n      open={open}\n      onClose={() => onOk(value)}\n    >\n      <DialogTitle className={classes.title} disableTypography>\n        <Typography className={classes.dlgTitle}>{title}</Typography>\n        <IconButton className={classes.closeButton} onClick={onCancel}>\n          <CloseIcon />\n        </IconButton>\n      </DialogTitle>\n      <DialogContent className={classes.dlgContent}>\n        <TagControl\n          className={classes.field}\n          tags={value}\n          tagConfig={tagConfig}\n          onChange={setValue}\n        />\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={onCancel}>Cancel</Button>\n        <div style={{ flexGrow: 1 }} />\n        <Button onClick={() => setValue(tags)}>Reset</Button>\n        <Button onClick={() => onOk(value)}>Ok</Button>\n      </DialogActions>\n    </Dialog>\n  )\n}\n\nTagEdit.propTypes = {\n  open: PropTypes.bool,\n  title: PropTypes.string,\n  onOk: PropTypes.func,\n  onCancel: PropTypes.func,\n  tags: PropTypes.array.isRequired,\n  tagConfig: PropTypes.object.isRequired\n}\n\nexport default TagEdit\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport Typography from '@material-ui/core/Typography'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { formatDate } from '../../../../lib/datelib'\n\nconst style = theme => ({\n  root: { },\n  rootEdit: { },\n  formControl: {\n    width: '100%'\n  },\n  textBody: {\n    whiteSpace: 'pre-line'\n  },\n  actionButtons: {\n    textAlign: 'right'\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst DateView = ({\n  label,\n  value,\n  className\n}) => {\n  const classes = useStyles()\n  return (\n    <div className={classNames(classes.root, className)}>\n      <Typography variant='overline' className={classes.fieldTitle}>\n        {label}\n      </Typography>\n      <Typography variant='body1' className={classes.hint}>{value ? formatDate(value) : ''}</Typography>\n    </div>\n  )\n}\n\nDateView.propTypes = {\n  className: PropTypes.string,\n  label: PropTypes.string.isRequired,\n  value: PropTypes.string\n}\n\nexport default DateView\n","import React, { useContext, useState } from 'react'\nimport PropTypes from 'prop-types'\n\nimport Typography from '@material-ui/core/Typography'\nimport Divider from '@material-ui/core/Divider'\nimport List from '@material-ui/core/List'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemText from '@material-ui/core/ListItemText'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport TagView from '../controls/TagView'\nimport ShortLongText from '../controls/ShortLongText'\nimport DateControl from '../controls/DateControl'\nimport TagClass from '../../../../lib/Tags'\nimport BigTextEdit from '../dialogs/BigTextEdit'\nimport BigText from '../dialogs/BigText'\nimport TagEdit from '../dialogs/TagEdit'\n\nimport { SeriesContext } from '../../contexts'\nimport DateView from '../controls/DateView'\n\nconst style = theme => ({\n  root: {\n    height: '90%',\n    width: '85%'\n  },\n  dlgTitleContainer: {\n    display: 'flex',\n    padding: 0\n  },\n  catTagTitle: {\n    marginTop: theme.spacing(2)\n  },\n  dlgTitle: {\n    flexGrow: 1,\n    paddingTop: theme.spacing(2),\n    paddingBottom: theme.spacing(1),\n    paddingLeft: theme.spacing(3)\n  },\n  field: {\n    marginBottom: theme.spacing(2)\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst DIALOGS = {\n  NOTEEDIT: 'noteEdit',\n  NOTEVIEW: 'noteView',\n  PHOTOTAKEN: 'taken',\n  TAGEDIT: 'tag',\n  CANCEL: 'cancel'\n}\n\nconst PhotoInfo = ({ canEdit, photo, delta, onChange }) => {\n  const classes = useStyles()\n  const { seriesConfig } = useContext(SeriesContext)\n  const [{ activeDialog, activeDialogContext }, setActiveDialog] = useState({})\n\n  const tagInst = new TagClass(seriesConfig, delta.tags || photo.tags)\n\n  let metaKeys = []\n  try {\n    metaKeys = photo.meta ? Object.keys(JSON.parse(photo.meta)) : []\n  }\n  catch (e) {\n    console.error(e)\n  }\n  return (\n    <div>\n      {canEdit ? (\n        <DateControl\n          className={classes.field}\n          label='Photo taken on'\n          value={delta.takenOn || photo.takenOn}\n          onChange={takenOn => onChange({ takenOn })}\n          canEdit={canEdit}\n        />\n      )\n        : (\n          <DateView\n            label='Photo taken on'\n            value={delta.takenOn || photo.takenOn}\n          />\n        )}\n\n      {(canEdit || photo.note) && (\n        <ShortLongText\n          label='Photo Note'\n          text={delta.note || photo.note}\n          onClick={() => {\n            if (canEdit) setActiveDialog({ activeDialog: DIALOGS.NOTEEDIT })\n            else setActiveDialog({ activeDialog: DIALOGS.NOTEVIEW })\n          }}\n        />\n      )}\n      <Typography variant='subtitle1' className={classes.catTagTitle}>Category tags</Typography>\n      <Divider />\n      {tagInst.seriesConfig.getNonXYTagTypes().map((tt, idx) => (\n        <div\n          key={`tagtype-${idx}`}\n          onClick={() => canEdit ? setActiveDialog({ activeDialog: DIALOGS.TAGEDIT, activeDialogContext: tt }) : null}\n        >\n          <TagView\n            className={classes.field}\n            label={tt.label}\n            tags={delta.tags || photo.tags}\n            tagConfig={tt}\n          />\n        </div>\n      ))}\n\n      {metaKeys.length > 0 && Object.keys(seriesConfig.meta).length > 0 && (\n        <React.Fragment>\n          <Typography className={classes.heading}>Metadata</Typography>\n          <Divider />\n          <List className={classes.list}>\n            {metaKeys.map((key, idx) => seriesConfig.meta[key] ? (\n              <ListItem key={`metadata${idx}`}>\n                <ListItemText\n                  primary={seriesConfig.meta[key].label}\n                  secondary={seriesConfig.meta[key].render(photo.meta[key])}\n                />\n              </ListItem>\n            ) : null\n            )}\n          </List>\n        </React.Fragment>\n      )}\n      {activeDialog && activeDialog === DIALOGS.NOTEEDIT && (\n        <BigTextEdit\n          open\n          multiline\n          onOk={note => {\n            onChange({ note })\n            setActiveDialog({})\n          }}\n          title='Edit Photo Note'\n          body={delta.note || photo.note}\n        />\n      )}\n      {activeDialog && activeDialog === DIALOGS.NOTEVIEW && (\n        <BigText\n          open\n          multiline\n          onClose={() => setActiveDialog({})}\n          title='Photo Note'\n          body={delta.note || photo.note}\n        />\n      )}\n      {activeDialog && activeDialog === DIALOGS.TAGEDIT && (\n        <TagEdit\n          open\n          title={`Edit Tags: ${activeDialogContext.label}`}\n          onOk={tags => {\n            setActiveDialog({})\n            onChange({ tags })\n          }}\n          onCancel={() => setActiveDialog({})}\n          tags={delta.tags || photo.tags}\n          tagConfig={activeDialogContext}\n        />\n      )}\n    </div>\n  )\n}\n\nPhotoInfo.propTypes = {\n  canEdit: PropTypes.bool,\n  onChange: PropTypes.func.isRequired,\n  photo: PropTypes.object.isRequired,\n  delta: PropTypes.object.isRequired\n}\n\nexport default PhotoInfo\n","import React, { useState, useMemo } from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogActions from '@material-ui/core/DialogActions'\nimport Button from '@material-ui/core/Button'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport FormLabel from '@material-ui/core/FormLabel'\nimport Slider from '@material-ui/lab/Slider'\n\nimport MapDot from '../../../maps/MapDot'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n\n  },\n  dlgContent: {\n    display: 'flex',\n    flexDirection: 'column',\n    padding: 0\n  },\n  mapWrapper: {\n    flexGrow: 1\n  },\n  sliderWrapper: {\n    padding: '20px'\n  },\n  slider: {\n    padding: '22px 0px'\n  },\n  sliderRoor: {\n    padding: '0 20px'\n  },\n  body: {\n    overflow: 'hidden',\n    whiteSpace: 'pre-line',\n    paddingBottom: theme.spacing(1)\n  },\n  title: {\n    background: theme.palette.primary.main,\n    color: theme.palette.primary.contrastText,\n    margin: 0,\n    padding: theme.spacing(2)\n  },\n  closeButton: {\n    position: 'absolute',\n    right: theme.spacing(1),\n    top: theme.spacing(1),\n    color: theme.palette.grey[500]\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst MapDirPicker = ({ open, onOk, onCancel, title, latitude: initLat, longitude: initLong, direction: initDir }) => {\n  const classes = useStyles()\n  const [{ longitude, latitude }, setCoords] = useState({ longitude: initLong, latitude: initLat })\n  const [direction, setRotation] = useState(initDir)\n\n  const initViewport = useMemo(() => ({\n    zoom: 18,\n    latitude: initLat,\n    longitude: initLong\n  }), [initLat, initLong])\n\n  const mapChange = ({ viewport: { longitude, latitude } }) => setCoords({ longitude, latitude })\n\n  return (\n    <Dialog\n      scroll='paper'\n      open={open}\n      fullWidth\n      fullScreen\n      onClose={onCancel}\n    >\n      <DialogTitle className={classes.title} disableTypography>\n        <Typography color='inherit'>{title}</Typography>\n      </DialogTitle>\n      <DialogContent className={classes.dlgContent}>\n        <div className={classes.mapWrapper}>\n          <MapDot\n            editable\n            className={classes.map}\n            direction={direction > 0 ? direction : null}\n            viewport={initViewport}\n            onChange={mapChange}\n          />\n        </div>\n        <div className={classes.sliderWrapper}>\n          <FormLabel className={classes.mapFormLabel}>Direction {direction > -1 ? '' : '(off)'}</FormLabel>\n          <Slider\n            classes={{ root: classes.sliderRoor, container: classes.slider }}\n            value={direction || -1}\n            min={-1}\n            max={360}\n            step={1}\n            onChange={(e, value) => setRotation(value)}\n          />\n        </div>\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={onCancel}>Cancel</Button>\n        <div style={{ flexGrow: 1 }} />\n        <Button onClick={() => onOk({ longitude, latitude, direction })}>Ok</Button>\n      </DialogActions>\n    </Dialog>\n  )\n}\n\nMapDirPicker.propTypes = {\n  open: PropTypes.bool,\n  latitude: PropTypes.number,\n  longitude: PropTypes.number,\n  direction: PropTypes.number,\n  onOk: PropTypes.func,\n  onCancel: PropTypes.func,\n  title: PropTypes.string\n}\n\nexport default MapDirPicker\n","\nimport React, { useState } from 'react'\nimport PropTypes from 'prop-types'\n\nimport TextField from '@material-ui/core/TextField'\nimport FormLabel from '@material-ui/core/FormLabel'\nimport Typography from '@material-ui/core/Typography'\nimport FormControlLabel from '@material-ui/core/FormControlLabel'\nimport Switch from '@material-ui/core/Switch'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport MapDot from '../../../maps/MapDot'\n\nimport MapDirPicker from '../dialogs/MapDirPicker'\nimport BigTextEdit from '../dialogs/BigTextEdit'\n\nimport style from './SeriesEditInner.style'\nimport { ACCESS } from '../../../../config'\nimport ShortLongText from '../controls/ShortLongText'\n\nconst DIALOGS = {\n  MAPPICK: 'mapPicker',\n  NOTEEDIT: 'noteEdit'\n}\n\nconst useStyles = makeStyles(style)\n\n/**\n * SeriesEdit appears in two places so we need this to be a bit reusable\n */\nconst SeriesEditInner = ({ series, delta, onChange }) => {\n  const classes = useStyles()\n  const [activeDialog, setActiveDialog] = useState(null)\n\n  const viewport = { zoom: 18 }\n  if ((delta.latitude || series.coords[1]) && (delta.longitude || series.coords[0])) {\n    viewport.longitude = delta.longitude || series.coords[0]\n    viewport.latitude = delta.latitude || series.coords[1]\n  }\n\n  const access = delta.access || series.access || 'PRIVATE'\n  // console.log('ACESS', access)\n  return (\n    <div>\n      <TextField\n        label='Series Name'\n        fullWidth\n        placeholder='New Series'\n        className={classes.field}\n        value={delta.name || series.name || ''}\n        onChange={e => onChange({ ...delta, name: e.target.value })}\n      />\n      <div className={classes.mapWrapper} onClick={() => setActiveDialog(DIALOGS.MAPPICK)}>\n        <FormLabel className={classes.mapFormLabel}>Location</FormLabel>\n        <div className={classes.mapInnerWrap}>\n          <MapDot\n            staticMap\n            className={classes.map}\n            direction={delta.direction || series.direction}\n            viewport={viewport}\n          />\n        </div>\n      </div>\n      <div className={classes.field}>\n        <FormLabel>Series Access</FormLabel>\n        <div className={classes.access}>\n          <FormControlLabel\n            className={classes.accessRadio}\n            control={\n              <Switch\n                checked={['OPEN', 'PUBLIC'].indexOf(access) > -1}\n                onChange={(e) => {\n                  onChange({ ...delta, access: e.target.checked ? 'PUBLIC' : 'PRIVATE' })\n                }}\n                value={'PUBLIC'}\n              />\n            }\n            label={<div>\n              <Typography variant='body2' component='div'>{ACCESS.PUBLIC.label}</Typography>\n              <Typography variant='caption' component='div'>{ACCESS.PUBLIC.description}</Typography>\n            </div>}\n\n          />\n          <FormControlLabel\n            className={classes.accessRadio}\n            disabled={['PRIVATE'].indexOf(access) > -1}\n            control={\n              <Switch\n                checked={['OPEN'].indexOf(access) > -1}\n                onChange={(e) => onChange({ ...delta, access: e.target.checked ? 'OPEN' : 'PUBLIC' })}\n                value={'OPEN'}\n              />\n            }\n            label={<div>\n              <Typography variant='body2' component='div'>{ACCESS.OPEN.label}</Typography>\n              <Typography variant='caption' component='div'>{ACCESS.OPEN.description}</Typography>\n            </div>}\n          />\n        </div>\n      </div>\n\n      <ShortLongText\n        onClick={() => setActiveDialog(DIALOGS.NOTEEDIT)}\n        className={classes.field}\n        label='Series Note'\n        text={delta.note || series.note}\n      />\n      {activeDialog === DIALOGS.MAPPICK && (\n        <MapDirPicker\n          open\n          title='Series Location & Direction'\n          latitude={delta.latitude || series.coords[1]}\n          longitude={delta.longitude || series.coords[0]}\n          direction={delta.direction || series.direction}\n          onOk={(data) => {\n            onChange({ ...delta, ...data })\n            setActiveDialog(null)\n          }}\n          onCancel={() => setActiveDialog(null)}\n        />\n      )}\n      {activeDialog === DIALOGS.NOTEEDIT && (\n        <BigTextEdit\n          open\n          title='Series Note'\n          body={delta.note || series.note}\n          multiline\n          onOk={(newNote) => {\n            onChange({ ...delta, note: newNote })\n            setActiveDialog(null)\n          }}\n          onCancel={() => setActiveDialog(null)}\n        />\n      )}\n    </div>\n  )\n}\n\nSeriesEditInner.propTypes = {\n  // now some functions\n  series: PropTypes.object.isRequired,\n  delta: PropTypes.object.isRequired,\n  onChange: PropTypes.func.isRequired\n}\n\nexport default SeriesEditInner\n","export default theme => ({\n  root: {\n\n  },\n  inner: {\n    display: 'flex',\n    flexDirection: 'column'\n    // padding: theme.spacing(1)\n  },\n  dlgTitle: {\n    background: theme.palette.primary.main,\n    color: theme.palette.primary.contrastText\n  },\n  access: {\n    display: 'flex'\n  },\n  accessRadio: {\n    flex: '1 1 50%'\n  },\n  grow: {\n    flexGrow: 1\n  },\n  field: {\n    flexGrow: 0,\n    marginBottom: theme.spacing(1) * 2\n  },\n  slider: {\n    paddingLeft: theme.spacing(1),\n    paddingRight: theme.spacing(1)\n  },\n  textField: {\n    marginLeft: theme.spacing(1),\n    marginRight: theme.spacing(1),\n    width: '100%'\n  },\n  formLabel: {\n    display: 'block',\n    marginTop: theme.spacing(1),\n    marginBottom: theme.spacing(1)\n  },\n  mapFormLabel: {\n    display: 'block',\n    marginTop: theme.spacing(1),\n    marginBottom: theme.spacing(1)\n  },\n  mapInnerWrap: {\n    flexGrow: 1,\n    height: '200px',\n    minHeight: '200px'\n  },\n  mapWrapper: {\n    flexGrow: 1,\n    display: 'flex',\n    flexDirection: 'column',\n    paddingBottom: theme.spacing(1) * 2\n  },\n  formControl: {\n    margin: theme.spacing(1),\n    minWidth: 120\n  },\n  chips: {\n    display: 'flex',\n    flexWrap: 'wrap'\n  }\n})\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n    width: 1,\n    height: 1,\n    zIndex: 1\n  },\n  svgDot: {\n    width: 20,\n    height: 20,\n    position: 'absolute',\n    top: '50%',\n    left: '50%',\n    textAlign: 'center',\n    transformOrigin: '50% 50%',\n    transform: 'translateY(-50%) translateX(-50%)'\n  },\n  svgAccuracyDot: {\n    position: 'absolute',\n    top: '50%',\n    left: '50%',\n    textAlign: 'center',\n    transformOrigin: '50% 50%',\n    transform: 'translateY(-50%) translateX(-50%)'\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst MyLocation = ({ position, projection }) => {\n  const classes = useStyles()\n  const accuracy = 20 // assume 20m to start\n  // metersPerPixel [12, 12, 12]\n  // pixelsPerMeter [0: 0.08029229250399847, 1: -0.08029229250399847, 2: 0.08029229250399847]\n  // console.log('POSITION', { position, projection })\n  const accHeight = projection.pixelsPerMeter[0] * (accuracy)\n  const accWidth = projection.pixelsPerMeter[1] * (accuracy)\n  return (\n    <div className={classes.root}>\n      {/* This is the accuracy radius */}\n      <svg\n        style={{ height: accHeight, width: accWidth }}\n        className={classes.svgAccuracyDot}\n        version='1.1'\n        viewBox='0, 0, 100, 100'\n      >\n        <circle cx='50' cy='50' r={49}\n          stroke='#8888FF'\n          fillOpacity='0.4'\n          strokeWidth='1'\n          fill='#AAAAFF'\n        />\n      </svg>\n      {/* This is the dot */}\n      <svg className={classes.svgDot} version='1.1' viewBox='0, 0, 10, 10'>\n        <circle cx='5' cy='5' r='4'\n          stroke='#FFFFFF'\n          strokeWidth='1'\n          fill='#4444FF'\n        />\n      </svg>\n    </div>\n  )\n}\n\nMyLocation.propTypes = {\n  position: PropTypes.object,\n  projection: PropTypes.object\n}\n\nexport default MyLocation\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Fab from '@material-ui/core/Fab'\nimport MyLocationIcon from '@material-ui/icons/MyLocation'\n\nimport { makeStyles, useTheme } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n    border: '1px solid',\n    background: theme.palette.grey[100],\n    color: 'black',\n    width: 40,\n    height: 40,\n    zIndex: 10,\n    position: 'absolute'\n    // margin: theme.spacing(0.5),\n    // padding: theme.spacing(0.5),\n    // border: '2px solid',\n    // borderRadius: theme.spacing(1),\n    // background: theme.palette.common.white,\n    // fontSize: 20,\n    // position: 'absolute',\n    // zIndex: 100,\n    // bottom: theme.spacing(10),\n    // right: theme.spacing(2)\n  }\n})\n\nconst useStyles = makeStyles(style)\n\nconst MyLocationButton = ({ onClick, controlPadding, disabled }) => {\n  const classes = useStyles()\n  const theme = useTheme()\n  return (\n    <Fab\n      disabled={disabled}\n      style={{\n        top: 56 + (controlPadding.top ? controlPadding.top : theme.spacing(2)),\n        right: controlPadding.right ? controlPadding.right : theme.spacing(2)\n      }}\n      aria-label='myLocation'\n      className={classes.root}\n      onClick={onClick}\n    >\n      <MyLocationIcon />\n    </Fab>\n  )\n}\n\nMyLocationButton.propTypes = {\n  controlPadding: PropTypes.object,\n  onClick: PropTypes.func.isRequired,\n  disabled: PropTypes.bool\n}\n\nexport default MyLocationButton\n","import React, { useState, useRef, useMemo, useEffect } from 'react'\nimport ReactMapGL, { NavigationControl, Marker, FlyToInterpolator } from 'react-map-gl'\nimport PropTypes from 'prop-types'\nimport { easeCubic } from 'd3-ease'\nimport WebMercatorViewport, { getDistanceScales } from 'viewport-mercator-project'\nimport useComponentSize from '../../lib/useComponentSize'\nimport MyLocation from './markers/MyLocation'\nimport { useGeolocation } from '../../lib/sensors'\n// import { debounce } from '../../lib/util'\nimport StyleButtons from './controls/StyleButtons'\nimport MyLocationButton from './controls/MyLocationButton'\nimport { mapConfig } from '../../config'\nimport classNames from 'classnames'\nimport 'mapbox-gl/dist/mapbox-gl.css'\nimport './BaseMap.css'\n\n/**\n * Note that this component technically has state but it is designed to be functionally stateless\n */\nconst BaseMap = (props) => {\n  // pull what we need out of the props\n  const {\n    showMe,\n    children,\n    mapStyles,\n    controlPadding,\n    viewport: initViewport,\n    bounds,\n    lockToBounds,\n    lockPan,\n    initStyle,\n    onViewportChange: incomingOnViewportChange,\n    onTransitionStart: incomingOnTransitionStart,\n    onTransitionEnd: incomingOnTransitionEnd,\n    transitions,\n    onMapDataEvent,\n    stylechooser,\n    ...passthroughProps\n  } = props\n\n  const mapContainerRef = useRef(null)\n  const mapBoxRef = useRef(null)\n  const innerTransitionsRef = useRef(null)\n\n  const { size } = useComponentSize(mapContainerRef)\n\n  const [currStyle, setCurrStyle] = useState(initStyle)\n\n  // This is the truth of the viewport!!\n  const [viewport, setViewport] = useState({ ...defaultViewVals, ...initViewport })\n  const [isTransitioning, setIsTransitioning] = useState(false)\n  const [projection, setProjection] = useState(null)\n\n  let myPosition = {}\n  if (showMe) {\n    myPosition = useGeolocation()\n  }\n  const geoMarker = (myPosition.latitude && myPosition.longitude)\n    ? (\n      <Marker key='myPos' className='myPosMarker' latitude={myPosition.latitude} longitude={myPosition.longitude} style={{ zIndex: 1 }}>\n        <MyLocation position={myPosition} projection={projection} />\n      </Marker>\n    ) : null\n\n  // Recalculate the projection if we need to but only when zoom changes\n  useMemo(() => {\n    if (!size || size.width < 10 || size.height < 10) return\n    if (mapStyles.length <= currStyle) setCurrStyle(initStyle)\n    try {\n      const projection = getDistanceScales(viewport)\n      // console.log('recalcProjection', { projection, size })\n      setProjection(projection)\n    }\n    catch (e) {\n      console.log('ERROR', viewport)\n      console.error(e)\n    }\n  }, [viewport.zoom, size])\n\n  const flyToMe = () => {\n    if (!myPosition.latitude || !myPosition.longitude) return\n    const transitionTime = 2000\n    innerTransitionsRef.current = {\n      transitionDuration: transitionTime,\n      transitionInterpolator: new FlyToInterpolator(),\n      transitionEasing: easeCubic\n    }\n    // You get `transitionTime` ms to figure this out. then we just jump\n    setTimeout(() => {\n      if (innerTransitionsRef.current) innerTransitionsRef.current = null\n    }, transitionTime)\n    setViewport({\n      ...viewport,\n      latitude: myPosition.latitude,\n      longitude: myPosition.longitude,\n      zoom: viewport.zoom > 10 ? viewport.zoom : 12\n    })\n  }\n\n  /**\n   * Callback fired when the user changes the viewport object\n   * @param {*} viewport\n   */\n  const onViewportChange = (viewportChange) => {\n    const newViewport = { ...viewportChange }\n    // Here we set/reset the bounds\n    if (bounds && lockToBounds) {\n      if (newViewport.longitude < bounds[0]) newViewport.longitude = bounds[0]\n      else if (newViewport.longitude > bounds[2]) newViewport.longitude = bounds[2]\n\n      if (newViewport.latitude < bounds[1]) newViewport.latitude = bounds[1]\n      else if (newViewport.latitude > bounds[3]) newViewport.latitude = bounds[3]\n    }\n    if (lockPan) {\n      newViewport.latitude = viewport.latitude\n      newViewport.longitude = viewport.longitude\n    }\n\n    // console.log('onViewportChange', newViewport)\n    // Fire the external callback so parent components can track viewport if they need to\n    if (!isTransitioning && typeof incomingOnViewportChange === 'function') {\n      incomingOnViewportChange({\n        viewport: newViewport,\n        size,\n        projection,\n        map: mapBoxRef.current && mapBoxRef.current.getMap()\n      })\n    }\n    setViewport(newViewport)\n  }\n\n  const recalcZoomBounds = () => {\n    // console.log('Should I recalc viewbounds?')\n    if (!bounds || !size || size.width < 10 || size.height < 10 || isTransitioning) return\n    // On the first run we're going to try to center the bounds.\n    const [minlng, minlat, maxlng, maxlat] = bounds\n    try {\n      console.log('recalcZoomBounds')\n      const { longitude, latitude, zoom } = new WebMercatorViewport({ ...size, ...viewport }).fitBounds(\n        [ [minlng, minlat], [maxlng, maxlat] ],\n        { padding: 40, offset: [0, 0] }\n      )\n      console.log('Changing Zoom ', bounds, viewport.zoom, zoom, viewport)\n\n      // console.log('recalcZoomBounds')\n      setViewport({ ...viewport, longitude, latitude, zoom })\n    }\n    catch (e) {\n      // Sometimes we don't have a valid bound. Don't make a big deal out of it.\n      console.error(e)\n    }\n  }\n\n  const handleTransitionStart = () => {\n    console.log('handleTransitionStart (internal)')\n    setIsTransitioning(true)\n    if (typeof incomingOnTransitionStart === 'function') incomingOnTransitionStart()\n  }\n\n  const handleTransitionEnd = () => {\n    console.log('handleTransitionEnd (internal)')\n    setIsTransitioning(false)\n    innerTransitionsRef.current = null\n    if (incomingOnTransitionEnd) incomingOnTransitionEnd()\n    if (typeof incomingOnViewportChange === 'function') {\n      incomingOnViewportChange({\n        viewport,\n        size,\n        projection,\n        map: mapBoxRef.current && mapBoxRef.current.getMap()\n      })\n    }\n  }\n\n  // RecalcZoombounds should only be done sparingly\n  useMemo(recalcZoomBounds, [size, bounds])\n\n  useEffect(() => {\n    setViewport({ ...viewport, ...initViewport })\n  }\n  , [initViewport])\n\n  return (\n    <div className={classNames('mapContainer', props.className)} ref={mapContainerRef}>\n      {size.height > 0 && size.width > 0 && (\n        <ReactMapGL\n          {...viewport}\n          {...(innerTransitionsRef.current || transitions)}\n          ref={map => {\n            mapBoxRef.current = map\n          }}\n          height={size.height}\n          width={size.width}\n          mapStyle={currStyle < mapStyles.length ? mapStyles[currStyle].style : mapStyles[0].style}\n          onData={onMapDataEvent}\n          onTransitionStart={handleTransitionStart}\n          onTransitionEnd={handleTransitionEnd}\n          dragPan={!lockPan}\n          onViewportChange={onViewportChange}\n          mapboxApiAccessToken={mapConfig.mapBoxToken}\n          {...passthroughProps}\n        >\n          {\n            children && Array.isArray(children)\n              ? children.map((c, idx) => c ? React.cloneElement(\n                handleChild(c, viewport, size.height, size.width, projection),\n                { key: `mapChild-${idx}` }\n              ) : null)\n              : handleChild(children, viewport, size.height, size.width, projection)\n          }\n          {/* Make sure the controls are above everything else */}\n          { stylechooser && (\n            <StyleButtons\n              controlPadding={controlPadding}\n              currStyle={currStyle}\n              mapStyles={mapStyles}\n              setCurrStyle={setCurrStyle}\n            />\n          )}\n          {/* Augment children with some props they need to survive in this harsh world */}\n          { !props.hideNavControls && (\n            <NavigationControl\n              onViewportChange={viewport => onViewportChange({ ...viewport, ...size })}\n              showZoom={!props.touchZoom === false && !props.scrollZoom === false}\n              showCompass={!props.touchRotate === false && !props.dragRotate === false}\n            />\n          )}\n          {showMe && (\n            <React.Fragment>\n              {geoMarker}\n              <MyLocationButton disabled={!myPosition || !myPosition.latitude} controlPadding={controlPadding} onClick={flyToMe} />\n            </React.Fragment>\n          )}\n        </ReactMapGL>\n      )}\n    </div>\n  )\n}\n\nBaseMap.propTypes = {\n  // Anything else we want to add to the map\n  children: PropTypes.any,\n  data: PropTypes.array,\n  // Maybe we want map controls to be padded\n  controlPadding: PropTypes.object,\n\n  showMe: PropTypes.bool,\n\n  // Separate transitions from viewport so we can set them independently\n  transitions: PropTypes.object,\n  initStyle: PropTypes.number,\n\n  // Some switches to make things easier\n  stylechooser: PropTypes.bool,\n  lockPan: PropTypes.bool,\n  lockRotation: PropTypes.bool,\n  lockZoom: PropTypes.bool,\n  lockToBounds: PropTypes.bool,\n  hideNavControls: PropTypes.bool,\n\n  // bounds of the map. may be locked or not [minlng, minlat], [maxlng, maxlat]\n  bounds: PropTypes.array,\n\n  // List of valid styles that will get picker buttons\n  mapStyles: PropTypes.array,\n\n  onMapDataEvent: PropTypes.func,\n  onViewportChange: PropTypes.func\n}\n\nBaseMap.defaultProps = {\n  controlPadding: {},\n  stylechooser: true,\n  initStyle: 0,\n  mapStyles: mapConfig.styles,\n  lockToBounds: false\n}\n\nexport default BaseMap\n\nconst defaultViewVals = {\n  latitude: 49.3050394,\n  longitude: -123.1398254,\n  bearing: 0,\n  pitch: 0,\n  zoom: 12\n}\n\nfunction handleChild (child, viewport, height, width, projection) {\n  return typeof child === 'function'\n    ? child(viewport, height, width, projection)\n    : child\n}\n","import React, { useState, useContext } from 'react'\nimport classNames from 'classnames'\nimport PropTypes from 'prop-types'\n\nimport GridList from '@material-ui/core/GridList'\nimport GridListTile from '@material-ui/core/GridListTile'\nimport GridListTileBar from '@material-ui/core/GridListTileBar'\nimport Snackbar from '@material-ui/core/Snackbar'\nimport Button from '@material-ui/core/Button'\nimport Fab from '@material-ui/core/Fab'\n\nimport AddIcon from '@material-ui/icons/Add'\nimport RemoveIcon from '@material-ui/icons/Remove'\n\nimport { SeriesContext } from '../../contexts'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport style from './PhotoGrid.style'\nimport DeleteDialog from '../dialogs/DeleteDialog'\nimport { formatDate } from '../../../../lib/datelib'\n\nconst useStyles = makeStyles(style)\n\nconst PhotoGrid = ({ photos, columns, multiSelect, onDelete, onTileClick }) => {\n  const [selectMode, setSelectMode] = useState(false)\n  const classes = useStyles()\n  const [selectedItems, setSelectedItems] = useState([])\n  const [deleteConfirm, setDeleteConfirm] = useState(false)\n\n  const { seriesConfig, ac } = useContext(SeriesContext)\n\n  const handleAddToSelection = (e, id) => {\n    e.preventDefault()\n    e.stopPropagation()\n\n    setSelectMode(true)\n    toggleListItem(id)\n  }\n\n  const handleCancelSelection = () => {\n    setSelectMode(false)\n    setSelectedItems([])\n  }\n\n  const onDeleteConfirm = (confirmation) => {\n    setDeleteConfirm(false)\n    if (confirmation === true && selectedItems.length < photos.length) onDelete(selectedItems)\n    handleCancelSelection()\n  }\n\n  const toggleListItem = (id) => {\n    const index = selectedItems.indexOf(id)\n    if (index < 0) setSelectedItems([...selectedItems, id])\n    else {\n      const remaining = selectedItems.filter(arrId => arrId !== id)\n      if (remaining.length === 0) handleCancelSelection()\n      setSelectedItems(remaining)\n    }\n  }\n\n  const handlePhotoTap = (e, photo) => {\n    e.preventDefault()\n    e.stopPropagation()\n    // Select / deselect the item in edit mode\n    if (selectMode) toggleListItem(photo.id)\n    // navigate if tileClick selected\n    else onTileClick(photo.id)\n  }\n\n  const sortedPhotos = [...photos]\n  sortedPhotos.sort((a, b) => parseInt(b.takenOn, 10) - parseInt(a.takenOn, 10))\n\n  return (\n    <div>\n      <GridList cols={columns} cellHeight={200} className={classes.root}>\n        {sortedPhotos.map((photo, idx) => {\n          const selected = selectedItems.indexOf(photo.id) > -1\n          const canDelete = ac.canUser('delete', photo, 'photo')\n\n          let photoUrl = seriesConfig.getPhotoUrl(photo, 'thumb') || photo.base64\n\n          return (\n            <GridListTile\n              key={`gridTile${idx}`}\n              onClick={(e) => canDelete && handlePhotoTap(e, photo)}\n              className={classNames(\n                classes.tile,\n                selectMode && !canDelete && classes.notDeleteable,\n                selectMode && canDelete && !selected && classes.unSelectedTile,\n                selectMode && selected && classes.selectedTile\n              )}\n            >\n              <img src={photoUrl} alt={photoUrl} className={classes.img} />\n              {canDelete && multiSelect && (\n                <Fab size='small' aria-label='Add' className={classes.addFab} onClick={(e) => handleAddToSelection(e, photo.id)}>\n                  {!selectMode || !selected ? <AddIcon /> : <RemoveIcon />}\n                </Fab>\n              )}\n              <GridListTileBar\n                title={<span>{formatDate(photo.takenOn)}</span>}\n              />\n            </GridListTile>\n          )\n        })}\n      </GridList>\n      <Snackbar\n        open={selectMode}\n        autoHideDuration={null}\n        ContentProps={{\n          'aria-describedby': 'snackbar-fab-message-id',\n          className: classes.snackbarContent\n        }}\n        message={<span id='snackbar-fab-message-id'>{selectedItems.length} Photos selected</span>}\n        action={<div>\n          <Button color='inherit' disabled={selectedItems.length >= photos.length} size='small' onClick={() => setDeleteConfirm(true)}>\n                Delete\n          </Button>\n          <Button color='inherit' size='small' onClick={() => handleCancelSelection()}>\n                Cancel\n          </Button>\n        </div>\n        }\n        className={classes.snackbar}\n      />\n\n      <DeleteDialog\n        open={deleteConfirm}\n        onConfirm={onDeleteConfirm}\n        title={`Delete ${selectedItems.length} Photos`}\n        message='Are you sure you want to delete these photos?'\n      />\n    </div>\n\n  )\n}\n\nPhotoGrid.propTypes = {\n  photos: PropTypes.array.isRequired,\n  columns: PropTypes.number,\n\n  multiSelect: PropTypes.bool,\n  onDelete: PropTypes.func,\n  onTileClick: PropTypes.func.isRequired\n}\nPhotoGrid.defaultProps = {\n  multiSelect: true,\n  columns: 2\n}\n\nexport default PhotoGrid\n","import { red } from '@material-ui/core/colors'\nexport default theme => ({\n  root: {\n\n  },\n  tile: {\n\n  },\n  addFab: {\n    position: 'absolute',\n    zIndex: 10,\n    top: theme.spacing(1),\n    left: theme.spacing(1),\n    opacity: 0.3\n  },\n  notDeleteable: {\n    background: 'black',\n    opacity: 0.1\n    // '& img': {\n    // }\n  },\n  unSelectedTile: {\n    '& img': {\n      opacity: 0.7\n    }\n  },\n  selectedTile: {\n    padding: `${theme.spacing(2)}px!important`,\n    '& img': {\n      opacity: 1\n    }\n  },\n  img: {\n\n  },\n  snackbarContent: {\n    backgroundColor: red[700]\n  },\n  snackbar: {\n  }\n})\n","import React, { useState, useContext } from 'react'\nimport PropTypes from 'prop-types'\nimport exifParser from 'exif-parser'\nimport { isNumeric } from '../../../lib/util'\n\nimport PhotoReviewTool from './PhotoReviewTool'\nimport CameraTool from './CameraTool'\nimport NewPhotoInfo from './NewPhotoInfo'\nimport LibraryFilePicker from './controls/LibraryFilePicker'\n\nimport PhotoClass from '../../../lib/Photo'\nimport SeriesClass from '../../../lib/Series'\nimport { useDeviceOrientation, useGeolocation } from '../../../lib/sensors'\n\nimport { SeriesContext } from '../contexts'\n\nconst MODES = {\n  CAMERA: 'camera',\n  FILEPICKER: 'library',\n  PHOTOREVIEW: 'photoreview',\n  PHOTOINFOEDIT: 'photoinfoedit'\n}\n\nconst NewPhoto = ({ inputMethod, onCreate, onCancel, isNewSeries }) => {\n  const { seriesConfig, series } = useContext(SeriesContext)\n  const [newPhoto, setNewPhoto] = useState(null)\n  const [newSeries, setNewSeries] = useState(isNewSeries ? new SeriesClass(seriesConfig).series : null)\n\n  const [photoRefId, setPhotoRefId] = useState(null)\n  const [mode, _changeMode] = useState({ current: inputMethod, history: [] })\n  const orientation = useDeviceOrientation()\n  const geo = useGeolocation()\n\n  const photos = series && series.photos ? series.photos : []\n\n  const onLibraryAdd = (data) => {\n    console.log('onLibraryAdd Debug GOT DATA', { data })\n    const find = 'base64,'\n    let exif = {}\n    const foundIdx = data.indexOf(find) + find.length\n    const newData = data.slice(foundIdx)\n    const parser = exifParser.create(Buffer.from(newData, 'base64'))\n    console.log('onLibraryAdd Buffered')\n    try {\n      exif = parser.parse()\n      console.log('got EXIF', JSON.stringify(exif))\n    }\n    catch (err) {\n    // got invalid data, handle error\n      console.error('EXIF ERROR', err)\n    }\n    // Ok, now try to get the datetime off the EXIF\n    let date = String(Date.now())\n    try {\n      date = String(exif.tags.DateTimeOriginal)\n    }\n    catch (err) {\n      console.log('EXIF', exif)\n      console.error('ERROR GETTING TIMESTAMP', err)\n    }\n    console.log('isNewSeries', { isNewSeries })\n    if (isNewSeries) {\n      let { latitude, longitude } = geo\n      // Stanley park as a fallback if we can't get the geo\n      if (!latitude || !longitude) {\n        latitude = 49.3050394\n        longitude = -123.1398254\n      }\n      try {\n        if (exif.tags.GPSLatitude && isNumeric(exif.tags.GPSLatitude) && exif.tags.GPSLongitude && isNumeric(exif.tags.GPSLongitude)) {\n          latitude = exif.tags.GPSLatitude\n          longitude = exif.tags.GPSLongitude\n        }\n      }\n      catch (e) {\n        console.error('GPS Longitude and Latitude could not be determined')\n      }\n      console.log('LATLONG FOR LIB PICK', { geo, latitude, longitude })\n      setNewSeries({ ...newSeries, latitude, longitude })\n    }\n    const photoInitObj = new PhotoClass(seriesConfig).photo\n    const fullNewPhotoObject = {\n      ...photoInitObj,\n      takenOn: date,\n      rawData: { exif },\n      base64: data\n    }\n    setNewPhoto(fullNewPhotoObject)\n    changeMode(MODES.PHOTOREVIEW)\n    console.log('onLibraryAdd FINISHED', fullNewPhotoObject)\n  }\n\n  const changeMode = (newModeName) => {\n    console.log('NEWPHOTO changeMode', mode, newModeName)\n    _changeMode({\n      current: newModeName,\n      history: [...mode.history, mode.current]\n    })\n  }\n  const lastMode = () => {\n    if (mode.history.length > 0) {\n      const oldHistory = [...mode.history]\n      const oldMode = oldHistory.pop()\n      _changeMode({\n        current: oldMode,\n        history: oldHistory\n      })\n    }\n    else {\n      onCancel()\n    }\n  }\n\n  const onShutter = (data, refId) => {\n    const photoInitObj = new PhotoClass(seriesConfig).photo\n\n    console.log('onShutter Debug GOT DATA', { data })\n    const find = 'base64,'\n    let exif = {}\n    const foundIdx = data.base64.indexOf(find) + find.length\n    const newData = data.base64.slice(foundIdx)\n    const parser = exifParser.create(Buffer.from(newData, 'base64'))\n    console.log('onLibraryAdd Buffered')\n    try {\n      exif = parser.parse()\n      console.log('got EXIF', JSON.stringify(exif))\n    }\n    catch (err) {\n    // got invalid data, handle error\n      console.error('EXIF ERROR', err)\n    }\n\n    if (isNewSeries) {\n      let { latitude, longitude } = geo\n      // Stanley park as a fallback if we can't get the geo\n      if (!latitude || !longitude) {\n        latitude = 49.3050394\n        longitude = -123.1398254\n      }\n      setNewSeries({ ...newSeries, latitude, longitude })\n    }\n    setNewPhoto({\n      ...photoInitObj,\n      rawData: {\n        orient: orientation,\n        geolocate: geo\n      },\n      base64: data.base64\n    })\n    setPhotoRefId(refId)\n    changeMode(MODES.PHOTOREVIEW)\n  }\n\n  let component = null\n  switch (mode.current) {\n    case MODES.CAMERA:\n      component = (\n        <CameraTool\n          photos={photos}\n          onShutter={onShutter}\n          onCancel={onCancel}\n        />\n      )\n      break\n    case MODES.FILEPICKER:\n      component = <LibraryFilePicker onLibraryAdd={onLibraryAdd} />\n      // fileClick() // move this to useEffect to help with click handling\n      break\n    case MODES.PHOTOREVIEW:\n      component = (\n        <PhotoReviewTool\n          defaultRefPhotoId={photoRefId}\n          photos={photos}\n          captured={newPhoto}\n          onConfirm={() => changeMode(MODES.PHOTOINFOEDIT)}\n          onCancel={onCancel}\n          onRetry={lastMode}\n        />\n      )\n      break\n    case MODES.PHOTOINFOEDIT:\n      component = (\n        <NewPhotoInfo\n          photo={newPhoto}\n          newSeries={newSeries}\n          onSave={onCreate}\n          onCancel={onCancel}\n        />\n      )\n      break\n    default:\n      console.log('NEWPHOTO: default state. you should NEVER see this', mode)\n      onCancel()\n  }\n\n  return component\n}\n\nNewPhoto.propTypes = {\n  inputMethod: PropTypes.oneOf(['camera', 'library']),\n  onCreate: PropTypes.func.isRequired,\n  onCancel: PropTypes.func.isRequired,\n  isNewSeries: PropTypes.bool,\n  seriesConfig: PropTypes.object,\n  // This might be a new series so we might have\n  // actions to work on that\n  // This will be provided EITHER photos or onSeriesCreate\n  photos: PropTypes.array\n}\n\nexport default NewPhoto\n","import uuid from 'uuid/v4'\nimport { convertJSDatetoTimestamp } from './datelib'\nimport SeriesConfig from './SeriesConfig'\n\nclass Photo {\n  constructor (seriesConfig, photo) {\n    this.config = new SeriesConfig(seriesConfig)\n    if (photo) this.photo = photo\n    else {\n      this.photo = this.newPhoto()\n    }\n  }\n\n  setMeta = () => {\n    this.meta = JSON.stringify(this.config.getPhotoMeta())\n  }\n\n  newPhoto = () => ({\n    id: '_' + uuid(),\n    takenOn: convertJSDatetoTimestamp(new Date()),\n    meta: JSON.stringify(this.config.getPhotoMeta()),\n    tags: []\n  })\n}\n\nexport default Photo\n","import uuid from 'uuid/v4'\nimport SeriesConfig from './SeriesConfig'\n\nclass Series {\n  constructor (seriesConfig, series) {\n    this.config = new SeriesConfig(seriesConfig)\n    if (series) this.series = series\n    else {\n      this.series = this.newSeries()\n    }\n  }\n\n  setMeta = () => {\n    this.meta = JSON.stringify(this.config.getSeriesMeta())\n  }\n\n  newSeries = () => ({\n    id: '_' + uuid(),\n    meta: JSON.stringify(this.config.getSeriesMeta()),\n    photos: []\n  })\n}\n\nexport default Series\n","import moment from 'moment'\n\n/**\n * Takes a UTC unix timestamp integer or string (milliseconds)\n * and a valid moment format string and returns a formatted\n * date string\n * @param {*} utctimestamp\n * @param {*} format\n */\nexport const formatDate = (utctimestamp, format = 'LLLL') => {\n  return moment(utctimestamp, 'x').format(format)\n}\n\nexport const formatDatAgo = (utctimestamp) => {\n  return moment(utctimestamp, 'x').fromNow()\n}\n\n/**\n * Takes a UTC timestamp and returns a moment object in LOCAL mode\n * @param {*} utctimestamp\n */\nexport const parseDate = (utctimestamp) => {\n  return moment(utctimestamp, 'x')\n}\n\n/**\n * This returns the object in LOCAL mode\n * @param {*} jsDate\n */\nexport const convertJSDatetoTimestamp = (jsDate) => {\n  return moment\n    .utc(jsDate)\n    .format('x')\n}\n\n/**\n *\n * @param {*} utctimestamp\n */\nexport function timestampToHTML5Input (utctimestamp) {\n  // // trim the Z and milliseconds + seconds\n  return moment(utctimestamp, 'x').format('YYYY-MM-DDTkk:mm')\n}\n\n/**\n * Returns an integer timestamp\n * @param {*} isoStr\n */\nexport function HTML5InputToTimestamp (isoStr) {\n  return moment(new Date(isoStr), 'YYYY-MM-DDTkk:mm').format('x')\n}\n","import { useState, useEffect, useRef } from 'react'\n\nexport const useCamera = (onCapture) => {\n  const [cameraError, setCameraError] = useState(false)\n  const [cameraOnline, setCameraOnline] = useState(false)\n  const camRef = useRef()\n\n  const initCamera = () => {\n    if (!camRef.current) {\n      camRef.current = new Webcam(\n        document.getElementById('webcam'),\n        document.createElement('canvas')\n      )\n      camRef.current.setup(\n        window.innerWidth, // width\n        window.innerHeight // height\n      )\n        .then((data) => {\n          setCameraOnline(true)\n        })\n        .catch((e) => {\n          console.error(e)\n          setCameraError(true)\n        })\n    }\n  }\n\n  const captureImage = async () => {\n    if (camRef.current && cameraOnline) {\n      const capturedData = camRef.current.takeBase64Photo({ type: 'jpeg', quality: 1 })\n      onCapture(capturedData)\n    }\n  }\n\n  const delayedOrientationChange = () => {\n    window.setTimeout(initCamera, 1000)\n  }\n\n  useEffect(() => {\n    window.addEventListener('orientationchange', delayedOrientationChange)\n    if (!camRef.current && !cameraError) initCamera()\n    return () => {\n      window.removeEventListener('orientationchange', delayedOrientationChange)\n      if (camRef.current) {\n        camRef.current.destroy()\n        setCameraError(false)\n        setCameraOnline(false)\n      }\n      camRef.current = null\n    }\n  }, [])\n\n  return { cameraError, captureImage, cameraOnline }\n}\n\nclass Webcam {\n  constructor (webcamElement, canvasElement) {\n    this.webcamElement = webcamElement\n    this.canvasElement = canvasElement\n\n    if (window.location.protocol !== 'https:' && window.location.hostname !== 'localhost') {\n      console.warn('getUserMedia() must be run from a secure origin: https or localhost.\\nChanging protocol to https.')\n    }\n\n    if (!navigator.mediaDevices && !navigator.getUserMedia) {\n      console.warn(`Your browser doesn't support navigator.mediaDevices.getUserMedia and navigator.getUserMedia.`)\n    }\n  }\n\n  adjustVideoSize (width, height) {\n    const aspectRatio = width / height\n    if (width >= height) {\n      this.webcamElement.width = aspectRatio * this.webcamElement.height\n    }\n    else if (width < height) {\n      this.webcamElement.height = this.webcamElement.width / aspectRatio\n    }\n  }\n\n  async destroy () {\n    try {\n      this.webcamElement.srcObject.getTracks()[0].stop()\n      this.webcamElement = null\n      this.canvasElement = null\n    }\n    catch (e) {\n      console.error(e)\n    }\n  }\n\n  async setup (width, height) {\n    return new Promise((resolve, reject) => {\n      if (navigator.mediaDevices.getUserMedia !== undefined) {\n        navigator.mediaDevices.getUserMedia({ audio: false, video: { facingMode: 'environment', width, height } })\n          .then((mediaStream) => {\n            if ('srcObject' in this.webcamElement) {\n              this.webcamElement.srcObject = mediaStream\n            }\n            else {\n              // For older browsers withouth the srcObject.\n              this.webcamElement.src = window.URL.createObjectURL(mediaStream)\n            }\n            this.webcamElement.onloadedmetadata = (e) => {\n              this.webcamElement.play()\n            }\n            this.webcamElement.onplaying = (e) => {\n              resolve()\n            }\n          })\n          .catch(err => reject(err))\n      }\n      else {\n        reject(new Error('Error accessing camera'))\n      }\n    })\n  }\n\n  _drawImage () {\n    const imageWidth = this.webcamElement.videoWidth\n    const imageHeight = this.webcamElement.videoHeight\n\n    const context = this.canvasElement.getContext('2d')\n    this.canvasElement.width = imageWidth\n    this.canvasElement.height = imageHeight\n\n    context.drawImage(this.webcamElement, 0, 0, imageWidth, imageHeight)\n\n    return { imageHeight, imageWidth }\n  }\n\n  takeBlobPhoto () {\n    const { imageWidth, imageHeight } = this._drawImage()\n    return new Promise((resolve, reject) => {\n      this.canvasElement.toBlob((blob) => {\n        resolve({ blob, imageHeight, imageWidth })\n      })\n    })\n  }\n\n  takeBase64Photo ({ type, quality } = { type: 'jpeg', quality: 1 }) {\n    const { imageHeight, imageWidth } = this._drawImage()\n    const base64 = this.canvasElement.toDataURL('image/' + type, quality)\n    return { base64, imageHeight, imageWidth }\n  }\n}\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\n\nimport Fab from '@material-ui/core/Fab'\nimport SwipeableDrawer from '@material-ui/core/SwipeableDrawer'\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport Typography from '@material-ui/core/Typography'\n\nimport CameraIcon from '@material-ui/icons/Camera'\nimport CancelIcon from '@material-ui/icons/Cancel'\nimport PhotoLibraryIcon from '@material-ui/icons/PhotoLibrary'\n\nimport PhotoFadeSlider from './controls/PhotoFadeSlider'\nimport PhotoGrid from './subViews/PhotoGrid'\nimport Photo from './subViews/Photo'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport style from './CameraTool.style'\nimport { useCamera } from '../../../lib/useCamera'\n\nconst useStyles = makeStyles(style)\n\n// https://googlechrome.github.io/samples/image-capture/grab-frame-take-photo.html\nconst CameraTool = ({ photos, onCancel, onShutter, defaultRefPhotoId }) => {\n  const classes = useStyles()\n  const [slider, setSlider] = useState(50)\n  const newRefPhoto = defaultRefPhotoId\n    ? photos.find(p => p.id === defaultRefPhotoId)\n    : photos && photos.length > 0 ? photos[0] : null\n\n  const [refPhoto, setRefPhoto] = useState(newRefPhoto)\n  const [drawerOpen, setDrawerOpen] = useState(false)\n  const { cameraError, captureImage, cameraOnline } = useCamera((data) => onShutter(data, refPhoto ? refPhoto.id : null))\n\n  const handleTileClick = (id) => {\n    setRefPhoto(photos.find(p => p.id === id))\n    setDrawerOpen(false)\n  }\n\n  return (\n    <div className={classes.root}>\n      <CssBaseline />\n      { !cameraError && Boolean(refPhoto) && (\n        <PhotoFadeSlider defaultValue={slider} onChange={setSlider} />\n      )}\n\n      { cameraError && (\n        <div className={classes.cameraErrorText}>\n          <Typography variant='subtitle1' color='inherit'>No Camera Access</Typography>\n          <Typography variant='body2' color='inherit'>Please enabled access in your settings.</Typography>\n        </div>\n      )}\n\n      <div className={classes.captured}>\n        { Boolean(refPhoto) && (\n          <div className={classes.reference} >\n            <Photo\n              className={classes.referenceContainer}\n              opacity={(100 - slider) / 100}\n              photo={refPhoto}\n            />\n          </div>\n        )}\n        { !cameraError && (\n          <video\n            autoPlay\n            playsInline\n            muted\n            id='webcam'\n            width={window.innerWidth}\n            height={window.innerHeight}\n            className={classes.video}\n          />\n        )}\n      </div>\n\n      <Fab\n        color='primary'\n        aria-label='Take Photo'\n        classes={{\n          disabled: classes.disabledFab\n        }}\n        disabled={cameraError || !cameraOnline}\n        className={classNames(classes.cameraFab, classes.buttonFab)}\n        onClick={captureImage}\n      >\n        <CameraIcon className={classes.cameraIcon} />\n      </Fab>\n\n      <Fab\n        color='secondary'\n        aria-label='cancel'\n        onClick={onCancel}\n        classes={{\n          disabled: classes.disabledFab\n        }}\n        className={classNames(classes.cancelFab, classes.buttonFab)}\n      >\n        <CancelIcon className={classes.cancelIcon} />\n      </Fab>\n\n      <Fab\n        aria-label='cancel'\n        className={classNames(classes.libraryFab, classes.buttonFab)}\n        classes={{\n          disabled: classes.disabledFab\n        }}\n        disabled={!photos || photos.length === 0}\n        onClick={() => setDrawerOpen(true)}\n      >\n        <PhotoLibraryIcon className={classes.libraryIcon} />\n      </Fab>\n\n      <SwipeableDrawer\n        anchor='left'\n        open={drawerOpen}\n        classes={{\n          paperAnchorLeft: classes.swipeDrawer\n        }}\n        onClose={() => setDrawerOpen(false)}\n        onOpen={() => setDrawerOpen(true)}\n      >\n        <div\n          tabIndex={0}\n          className={classes.swipeDrawerContainer}\n          role='button'\n          onClick={() => setDrawerOpen(false)}\n          onKeyDown={() => setDrawerOpen(false)}\n        >\n          <PhotoGrid\n            multiSelect={false}\n            columns={1}\n            photos={photos}\n            onTileClick={handleTileClick}\n          />\n        </div>\n      </SwipeableDrawer>\n\n    </div>\n  )\n}\n\nCameraTool.propTypes = {\n  photos: PropTypes.array,\n  defaultRefPhotoId: PropTypes.string, // id of the reference photo\n  onCancel: PropTypes.func.isRequired,\n  onShutter: PropTypes.func.isRequired\n}\n\nexport default CameraTool\n","export default theme => ({\n  root: {\n    background: 'black',\n    // border: '5px solid red',\n    height: '100%',\n    width: '100%'\n  },\n  cameraErrorText: {\n    color: 'white',\n    position: 'absolute',\n    top: '50%',\n    left: '50%',\n    width: '90%',\n    transform: 'translateY(-50%) translateX(-50%)',\n    textAlign: 'center'\n  },\n  disabledFab: {\n    color: '#AAAAA!important',\n    background: '#DDDDDD!important',\n    opacity: 0.2\n  },\n  cameraFab: {\n    position: 'absolute',\n    zIndex: 10,\n    '@media (orientation: landscape)': {\n      right: '20px',\n      top: '50%',\n      transform: 'translateY(-50%)',\n      height: '25vh',\n      width: '25vh'\n    },\n    '@media (orientation: portrait)': {\n      bottom: '20px',\n      left: '50%',\n      transform: 'translateX(-50%)',\n      height: '25vw',\n      width: '25vw'\n    }\n  },\n  cameraIcon: {\n    height: '100%',\n    width: '100%'\n  },\n  cancelFab: {\n    position: 'absolute',\n    zIndex: 10,\n    '@media (orientation: landscape)': {\n      right: '15px',\n      top: '15px',\n      height: '15vh',\n      width: '15vh'\n    },\n    '@media (orientation: portrait)': {\n      right: '15px',\n      bottom: '15px',\n      height: '15vw',\n      width: '15vw'\n    }\n  },\n  cancelIcon: {\n    height: '100%',\n    width: '100%'\n  },\n\n  swipeDrawer: {\n    width: '50%'\n  },\n\n  libraryFab: {\n    position: 'absolute',\n    zIndex: 10,\n    '@media (orientation: landscape)': {\n      left: '15px',\n      top: '15px',\n      height: '15vh',\n      width: '15vh'\n    },\n    '@media (orientation: portrait)': {\n      left: '15px',\n      top: '15px',\n      height: '15vw',\n      width: '15vw'\n    }\n  },\n\n  myLocationFab: {\n    position: 'absolute',\n    zIndex: 10,\n    '@media (orientation: landscape)': {\n      right: '15px',\n      bottom: '15px',\n      height: '15vh',\n      width: '15vh'\n    },\n    '@media (orientation: portrait)': {\n      left: '15px',\n      bottom: '15px',\n      height: '15vw',\n      width: '15vw'\n    }\n  },\n  myLocationIcon: {\n    height: '80%',\n    width: '80%'\n  },\n  capturedContainer: {\n    position: 'absolute',\n    zIndex: 1,\n    height: '100%',\n    width: '100%'\n  },\n  referenceContainer: {\n    position: 'absolute',\n    zIndex: 2,\n    height: '100%',\n    width: '100%'\n  },\n  captured: {\n\n  },\n  reference: {\n\n  },\n  video: {\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    height: '100vh',\n    width: '100vw',\n    zIndex: 1\n    // '@media (orientation: portrait)': {\n    //   transform: 'rotate(90)'\n    // }\n  }\n  // overlayImage: {\n  //   position: 'absolute',\n  //   top: 0,\n  //   left: 0,\n  //   zIndex: 3,\n  //   height: '100vh',\n  //   width: '100vw',\n  //   textAlign: 'center'\n  // },\n  // overlayImageInner: {\n  //   '@media (orientation: landscape)': {\n  //     height: '100%',\n  //     width: 'auto'\n  //   },\n  //   '@media (orientation: portrait)': {\n  //     width: '100%',\n  //     height: 'auto'\n  //   }\n  // },\n  // newImage: {\n  //   position: 'absolute',\n  //   top: 0,\n  //   left: 0,\n  //   zIndex: 2\n  // }\n})\n","import React, { useEffect, useRef } from 'react'\n\nconst useFileInput = (onChange = () => {}) => {\n  const inputRef = useRef()\n  const clickRef = useRef()\n\n  const element = (\n    <input style={{ display: 'none' }} ref={inputRef} type='file' />\n  )\n\n  const forceClick = () => {\n    if (inputRef.current) inputRef.current.click()\n  }\n\n  useEffect(() => {\n    const handleChange = evt => {\n      const [file] = [...inputRef.current.files]\n      if (file) {\n        const reader = new FileReader()\n        reader.onload = e => {\n          onChange(e.target.result)\n        }\n        reader.readAsDataURL(file)\n      }\n      inputRef.current.value = null\n    }\n\n    if (inputRef.current) {\n      inputRef.current.addEventListener('change', handleChange)\n      if (!clickRef.current) {\n        inputRef.current.click()\n        clickRef.current = true\n      }\n    }\n    return () => {\n      if (inputRef.current) {\n        inputRef.current.removeEventListener('change', handleChange)\n      }\n    }\n  }, [inputRef.current])\n\n  return { fileClickEl: element, forceClick }\n}\n\nexport default useFileInput\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport PhotoLibraryIcon from '@material-ui/icons/PhotoLibrary'\nimport { makeStyles } from '@material-ui/core/styles'\nimport useFileInput from '../../../../lib/useFileInput'\n\nconst color = '#AAAAAA'\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    height: '100%',\n    display: 'flex',\n    flexDirection: 'column',\n    textAlign: 'center',\n    color,\n    border: `20px solid ${color}`\n  },\n  icon: {\n    margin: 'auto',\n    flex: '1 1 50%',\n    height: '70%',\n    width: '70%'\n  },\n  text: {\n    flex: '1 1 50%'\n  }\n}))\n\nconst LibraryFilePicker = ({ onLibraryAdd }) => {\n  const classes = useStyles()\n  const { fileClickEl, forceClick } = useFileInput(onLibraryAdd)\n  return (\n    <div className={classes.root} onClick={forceClick}>\n      {fileClickEl}\n      <PhotoLibraryIcon className={classes.icon}color='inherit' />\n      <Typography variant='h2' className={classes.text} color='inherit'>\n        Import from Library\n      </Typography>\n    </div>\n  )\n}\n\nLibraryFilePicker.propTypes = {\n  onLibraryAdd: PropTypes.func.isRequired\n}\n\nexport default LibraryFilePicker\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport Typography from '@material-ui/core/Typography'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport DialogActions from '@material-ui/core/DialogActions'\nimport Button from '@material-ui/core/Button'\n\nimport SeriesEditInner from './subViews/SeriesEditInner'\n\n// import { SeriesContext } from '../contexts'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport style from './NewPhotoInfo.style'\nimport PhotoInfoInner from './subViews/PhotoInfoInner'\n\nconst useStyles = makeStyles(style)\n\nconst NewPhotoInfo = ({ photo, newSeries, onCancel, onSave }) => {\n  const classes = useStyles()\n  // const { series } = useContext(SeriesContext)\n  const [seriesDelta, setSeriesDelta] = useState(newSeries || {})\n  const [photoDelta, setPhotoDelta] = useState(photo)\n\n  // console.log('NewPhotoInfo', {\n  //   seriesDelta,\n  //   photoDelta,\n  //   photo,\n  //   series,\n  //   newSeries,\n  //   onCancel,\n  //   onSave\n  // })\n  // console.log('NewPhotoInfo', { series, seriesDelta, photoDelta })\n\n  return (\n    <div className={classes.root}>\n      <CssBaseline /> {/* You only need this in a root element. Don't put it anywhere else in the dom */}\n      <Dialog\n        fullScreen\n        fullWidth\n        scroll='paper'\n        disableBackdropClick\n        disableEscapeKeyDown\n        onClose={onCancel}\n        aria-labelledby='customized-dialog-title'\n        open\n      >\n        <DialogTitle disableTypography className={classes.dlgTitleContainer}>\n          <Typography variant='h5' className={classes.dlgTitle}>\n          New Photo Properties\n          </Typography>\n        </DialogTitle>\n        <DialogContent>\n\n          {!!newSeries && (\n            <SeriesEditInner\n              series={newSeries}\n              delta={seriesDelta}\n              onChange={setSeriesDelta}\n            />\n          )}\n\n          <PhotoInfoInner\n            photo={photo}\n            canEdit\n            delta={photoDelta}\n            onChange={(newAttr) => setPhotoDelta({ ...photoDelta, ...newAttr })}\n          />\n\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={onCancel} color='primary'>\n            Cancel\n          </Button>\n          <Button onClick={() => onSave({ series: seriesDelta, photo: photoDelta })} color='primary'>\n            Next\n          </Button>\n        </DialogActions>\n      </Dialog>\n    </div>\n  )\n}\n\nNewPhotoInfo.propTypes = {\n  photo: PropTypes.object.isRequired,\n  newSeries: PropTypes.object,\n  // Standard functions\n  onCancel: PropTypes.func.isRequired,\n  onSave: PropTypes.func\n}\n\nexport default NewPhotoInfo\n","export default theme => ({\n  root: {\n\n  },\n  formLabel: {\n    color: theme.palette.text.secondary\n  },\n  mapFormLabel: {\n    marginTop: theme.spacing(2),\n    marginBottom: theme.spacing(1),\n    color: theme.palette.text.secondary\n  },\n  map: {\n    marginBottom: theme.spacing(2)\n  },\n  mapWrapper: {\n    marginBottom: theme.spacing(2)\n  },\n  field: {\n    marginBottom: theme.spacing(2)\n  }\n})\n","import React, { useState, useContext } from 'react'\nimport PropTypes from 'prop-types'\n\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport Snackbar from '@material-ui/core/Snackbar'\nimport Button from '@material-ui/core/Button'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport Photo from './subViews/Photo'\nimport PhotoFadeSlider from './controls/PhotoFadeSlider'\nimport style from './PhotoReviewTool.style'\n\nimport { SeriesContext } from '../contexts'\nconst useStyles = makeStyles(style)\n\nconst PhotoReviewTool = ({\n  captured, defaultRefPhotoId,\n  onConfirm, onCancel, onRetry\n}) => {\n  const { series } = useContext(SeriesContext)\n  const photos = series && series.photos ? series.photos : null\n  const classes = useStyles()\n\n  const newRefPhoto = defaultRefPhotoId\n    ? photos.find(p => p.id === defaultRefPhotoId)\n    : photos && photos.length > 0 ? photos[0] : null\n\n  const [refPhoto, setRefPhoto] = useState(newRefPhoto)\n  const [slider, setSlider] = useState(100)\n\n  if (!captured) return 'Loading...'\n\n  return (\n    <div className={classes.root}>\n      <CssBaseline />\n      { Boolean(refPhoto) && (\n        <PhotoFadeSlider defaultValue={100} onChange={setSlider} />\n      )}\n\n      <div className={classes.captured}>\n        <Photo\n          opacity={slider / 100}\n          className={classes.capturedContainer}\n          photo={captured}\n        />\n      </div>\n      { Boolean(refPhoto) && (\n        <div className={classes.reference} >\n          <Photo\n            className={classes.referenceContainer}\n            photo={refPhoto}\n          />\n        </div>\n      )}\n      <Snackbar\n        open\n        autoHideDuration={null}\n        ContentProps={{\n          'aria-describedby': 'snackbar-fab-message-id',\n          className: classes.snackbarContent\n        }}\n        message={<span id='snackbar-fab-message-id'>Keep this photo?</span>}\n        action={<div>\n          <Button color='inherit' size='small' onClick={onCancel}>\n                Cancel\n          </Button>\n          {Boolean(onRetry) && (\n            <Button color='inherit' size='small' onClick={onRetry}>\n          Retry\n            </Button>\n          )}\n\n          <Button color='inherit' size='small' onClick={onConfirm}>\n                Keep\n          </Button>\n        </div>\n        }\n        className={classes.snackbar}\n      />\n    </div>\n  )\n}\n\nPhotoReviewTool.propTypes = {\n  defaultRefPhotoId: PropTypes.string,\n  captured: PropTypes.object,\n  // Now some functions\n  onConfirm: PropTypes.func.isRequired,\n  onCancel: PropTypes.func.isRequired,\n  onRetry: PropTypes.func // only for camera\n\n}\n\nexport default PhotoReviewTool\n","export default theme => ({\n  root: {\n    background: 'rgb(150,150, 150)',\n    // border: '5px solid red',\n    height: '100%',\n    width: '100%'\n  },\n  capturedContainer: {\n    position: 'absolute',\n    zIndex: 1,\n    height: '100%',\n    width: '100%'\n  },\n  referenceContainer: {\n    position: 'absolute',\n    zIndex: 0,\n    height: '100%',\n    width: '100%'\n  },\n  captured: {\n\n  },\n  reference: {\n\n  },\n  referenceTextContainer: {\n    width: '100%',\n    display: 'flex',\n    color: 'white',\n    background: 'rgba(0,0,0,0.5)',\n    padding: theme.spacing(3),\n    position: 'absolute',\n    zIndex: 4,\n    top: 0\n  },\n  newText: {\n    flexGrow: 1,\n    color: 'white',\n    textShadow: '1 1 1 black',\n    textAlign: 'right'\n  },\n  refText: {\n    flexGrow: 1,\n    color: 'white',\n    textShadow: '1 1 1 black'\n  }\n})\n","import React from 'react'\n\nexport const SeriesContext = React.createContext({})\n","import numeral from 'numeral'\n\nexport const isNumeric = num => {\n  try {\n    return !isNaN(parseFloat(num)) && isFinite(num)\n  }\n  catch (e) {\n    return false\n  }\n}\n/**\n * This is a correction to strip === signs off of base64-encoded strings\n * @param {} x\n */\nexport const urlizeb64 = x => x.replace('+', '-').replace('/', '_').replace(/=+$/, '')\n\n/**\n * We need numbers displayed consistently. This is how we do it.\n * @param {*} num\n * @param {*} precision\n */\nexport function formatNum (num, precision) {\n  try {\n    const precstr = precision > 0 ? '.' + Array(precision + 1).join('0') : ''\n    const newprec = isNumeric(num) ? numeral(num).format(`0,0${precstr}`) : num\n    return newprec.replace(/(\\.(0{0,1}[1-9]*))0+$/, '$1')\n  }\n  catch (e) {\n    return num\n  }\n}\n\n/**\n * Magic function to clear mouse selection. Use sparingly.\n */\nexport function clearSelection () {\n  if (document.selection && document.selection.empty) {\n    document.selection.empty()\n  }\n  else if (window.getSelection) {\n    var sel = window.getSelection()\n    sel.removeAllRanges()\n  }\n}\n\nexport function isObjectWithKeys (obj) {\n  return ((typeof obj === 'object') && (obj !== null) && Object.keys(obj).length > 0)\n}\n\n/**\n * Dom node parsing is weird because it may return an array or a single element with no way to know\n * which is which.\n */\nexport function makeDomArray (domnode) {\n  if (!domnode) return []\n  const keys = Object.keys(domnode)\n  // This is not the pattern we expect\n  if (keys.length > 1 || keys.length === 0) throw Error('Expected nester domnode structure.')\n  if (!domnode) return []\n  if (!domnode[keys[0]]) return []\n  return Array.isArray(domnode[keys[0]]) ? domnode[keys[0]] : [domnode[keys[0]]]\n}\n\nexport function capitalizeFirstLetter (string) {\n  return string.charAt(0).toUpperCase() + string.slice(1)\n}\n\n/**\n * Good for comparing two purely numeric arrays\n * @param {*} arr1\n * @param {*} arr2\n */\nexport function numericArrayCompare (arr1, arr2) {\n  if (!Array.isArray(arr1) || !Array.isArray(arr2)) return false\n  if (arr1.length !== arr2.length) return false\n\n  return !arr1.some((el, idx) => el !== arr2[idx])\n}\n\n/**\n * We need a function to add the padding '=' signs back before we decode\n * @param {*} hash\n */\nexport function decodeUnbufferedBase64 (hash) {\n  const missingPadding = hash.length % 4\n  if (missingPadding !== 0) {\n    const newhash = hash + Array(4 - missingPadding).join('=')\n    return Buffer.from(newhash, 'base64').toString()\n  }\n  else {\n    return Buffer.from(hash, 'base64').toString()\n  }\n}\n\nexport function encodeUnbufferedBase64 (str) {\n  return urlizeb64(Buffer.from(str).toString('base64'))\n}\n\n/**\n *\n * @param {*} o\n */\nexport function isObject (o) {\n  return o instanceof Object && o.constructor === Object\n}\n\n/**\n * XML to JSON is a non-trivial exercise. We can make certain assumptions\n * about our incoming file\n * @param {*} data\n */\nexport function arrToObj (data) {\n  for (const key in data) {\n    // Make sure we're looping over legitimate objects\n    if (data.hasOwnProperty(key)) {\n      const keyDat = data[key]\n      if (keyDat._) {\n        keyDat.val = keyDat._\n        delete keyDat._\n      }\n      if (keyDat.$) {\n        keyDat.attr = keyDat.$\n        delete keyDat.$\n      }\n      if (typeof keyDat === 'object') {\n        data[key] = arrToObj(keyDat)\n        // There's a pattern we want to collapse\n        // It puts every single individual value into its own array. Not cool\n        if (Array.isArray(keyDat) && keyDat.length === 1 && typeof keyDat[0] === 'string') {\n          if (isNumeric(keyDat[0])) data[key] = Number(keyDat[0])\n          else data[key] = keyDat[0].replace(/\\\\/g, '/')\n        }\n        else if (Array.isArray(keyDat) && keyDat.length === 1 &&\n        // The second case is when it puts objects into its own array\n          isObject(keyDat[0]) &&\n          Object.keys(keyDat[0]).length === 1) {\n          // xml2js does a weird thing where attributes get put into the following structure\n          // [{ \"_\": \"475945.992587164,5125837.37170763\", \"$\": { \"units\": \"m\"  } }]\n          data[key] = keyDat[0][Object.keys(keyDat[0])[0]]\n        }\n        // Dynamo DB does not like empty strings\n        if (typeof data[key] && data[key].length === 0) {\n          delete data[key]\n        }\n        if (typeof data[key] === 'string' && isNumeric(data[key])) data[key] = Number(data[key])\n      }\n    }\n  }\n  return data\n}\n\n/**\n * Returns a random number between min (inclusive) and max (exclusive)\n */\nexport function getRandomArbitraryInt (min, max) {\n  return parseInt(Math.random() * (max - min) + min, 10)\n}\n\n/**\n * Returns a function, that, as long as it continues to be invoked, will not\n * be triggered. The function will be called after it stops being called for\n * N milliseconds. If `immediate` is passed, trigger the function on the\n * leading edge, instead of the trailing.\n * @param {*} func\n * @param {*} wait\n * @param {*} immediate\n */\nexport function debounce (func, wait, immediate) {\n  let timeout = null\n  return (...innerArgs) => {\n    const context = this\n    // const args = arguments\n    const callNow = immediate && !timeout\n    clearTimeout(timeout)\n\n    timeout = setTimeout(() => {\n      timeout = null\n      if (!immediate) {\n        // console.log('debounce', innerArgs)\n        func.apply(context, innerArgs)\n      }\n    }, wait)\n    if (callNow) {\n      // console.log('debounce', innerArgs)\n      func.apply(context, innerArgs)\n    }\n  }\n};\n\n// var myEfficientFn = debounce(function() {\n// // All the taxing stuff you do\n// }, 250);\n\n// window.addEventListener('resize', myEfficientFn);\n","// https://medium.com/@shalkam/create-react-app-i18n-the-easy-way-b05536c594cb\nimport React, { useContext } from 'react'\nimport PropTypes from 'prop-types'\nimport { IntlProvider, addLocaleData } from 'react-intl'\nimport frLocaleData from 'react-intl/locale-data/fr'\n\naddLocaleData(frLocaleData)\n\nexport const IntlContext = React.createContext({})\n\n// the format message hook\nexport const useIntl = () => {\n  const intl = useContext(IntlContext)\n  return intl.formatMessage\n}\n\nexport const IntlWrapper = ({ children }) => (\n  <IntlProvider locale='en'>\n    {children}\n  </IntlProvider>\n)\nIntlWrapper.propTypes = {\n  children: PropTypes.any\n}\n","import gql from 'graphql-tag'\n\nexport const allSeries = gql`\n  query allSeries($limit: Int, $nextToken: String) {\n    allSeries(limit: $limit, nextToken: $nextToken) {\n      seriesSummaries {\n        id\n        name\n        access\n        createdUser {\n          id\n          gravatar\n          gravatarProfile\n          username        \n        }\n        updatedOn\n        createdOn\n        photoCount\n        coords\n        direction\n        watchers\n        featured {\n          id\n          takenOn\n          paths {\n            base\n            thumb\n            medium\n            large\n          }\n        }\n        latest {\n          id\n          takenOn\n          paths {\n            base\n            thumb\n            medium\n            large\n          }\n        }\n      }\n      nextToken\n    }\n  }\n`\n\nexport const pollQuery = gql`\n  query pollQuery($lastCheck: String!, $limit: Int, $nextToken: String) {\n    changedSeries(lastCheck: $lastCheck, limit: $limit, nextToken: $nextToken){\n      seriesSummaries {\n        id\n        name\n        access\n        createdUser {\n          id\n          gravatar\n          gravatarProfile\n          username        \n        }\n        updatedOn\n        createdOn\n        photoCount\n        coords\n        direction\n        watchers\n        featured {\n          id\n          takenOn\n          paths {\n            base\n            thumb\n            medium\n            large\n          }\n        }\n        latest {\n          id\n          takenOn\n          paths {\n            base\n            thumb\n            medium\n            large\n          }\n        }\n      }\n    }\n  }\n`\n\nexport const userSeries = gql`\n  query userSeries($createdBy: ID) {\n    userSeries(createdBy: $createdBy ) {\n      seriesSummaries {\n        id\n        name\n        access\n        \n        createdUser {\n          id\n          gravatar\n          gravatarProfile\n          username        \n        }\n        updatedOn\n        createdOn\n        \n        photoCount\n        coords\n        direction\n        watchers\n        \n        featured {\n          id\n          takenOn\n          paths {\n            base\n            thumb\n            medium\n            large\n          }\n        }\n        latest {\n          id\n          takenOn\n          paths {\n            base\n            thumb\n            medium\n            large\n          }\n        }\n      }\n      nextToken\n    }\n  }\n`\n\nexport const seriesFromList = gql`\n  query seriesFromList($seriesList: [ID]) {\n    arraySeries(seriesIds: $seriesList) {\n      id\n      name\n      access\n      createdUser {\n        id\n        gravatar\n        gravatarProfile\n        username        \n      }\n      updatedOn\n      createdOn\n      photoCount\n      coords\n      direction\n      watchers\n      featured {\n        id\n        takenOn\n        paths {\n          base\n          thumb\n          medium\n          large\n        }\n      }\n      latest {\n          id\n          takenOn\n          paths {\n            base\n            thumb\n            medium\n            large\n          }\n        }\n    }\n  }\n`\n\nexport const seriesWithTag = gql`\n  query seriesWithTag($tag: String!, $limit: Int, $nextToken: String) {\n    tagSeries(tag: $tag, limit: $limit, nextToken: $nextToken) {\n      seriesSummaries{\n        id\n        name\n        access\n        createdUser {\n          id\n          gravatar\n          gravatarProfile\n          username        \n        }\n        updatedOn\n        createdOn\n        photoCount\n        coords\n        direction\n        watchers\n        featured {\n          id\n          takenOn\n          paths {\n            base\n            thumb\n            medium\n            large\n          }\n        }\n        latest {\n          id\n          takenOn\n          paths {\n            base\n            thumb\n            medium\n            large\n          }\n        }\n      }\n      nextToken\n    }\n  }\n`\n\nexport const tagSearch = gql`\n  query tagSearch($limit: Int, $tag: String) {\n    tags(limit: $limit, tag: $tag ){\n      name\n      count\n    }\n  }\n`\n\nexport const geoSeries = gql`\n  query seriesInGeoBounds($bounds: [Float], $limit: Int, $nextToken: String) {\n    seriesInGeoBounds(bounds: $bounds, limit: $limit, nextToken: $nextToken) {\n      seriesSummaries {\n        id\n        name\n        access\n        createdUser {\n          id\n          gravatar\n          gravatarProfile\n          username        \n        }\n        updatedOn\n        photoCount\n        coords\n        direction\n        watchers\n        featured {\n          id\n          takenOn\n          paths {\n            base\n            thumb\n            medium\n            large\n          }\n        }\n        latest {\n          id\n          takenOn\n          paths {\n            base\n            thumb\n            medium\n            large\n          }\n        }\n      }\n    }\n  }\n`\n\nexport const getUser = gql`\n  query getUser($userId: ID) {\n    user(id: $userId){\n      id\n      username\n      gravatar\n      gravatarProfile\n      createdOn\n      updatedOn\n      createdOn\n      watching\n    }\n  }\n`\n\nexport const geocode = gql`\n  query geocode($search: String!) {\n    geocoder(search: $search) {\n      relevance\n      text\n      placeName\n      bbox\n      center\n      # geoType\n      # context\n    }\n  }\n`\nexport const getMyFeed = gql`\n  query myFeed($start: String, $end: String, $limit: Int) {\n    myFeed(start: $start, end: $end, limit: $limit) {\n      feed {\n        series {\n          id\n          name\n          createdUser {\n            id\n            gravatar\n            username\n          }\n          updatedOn\n          createdOn\n          access\n          coords\n          watchers\n          photoCount\n        }\n        photo {\n          id\n          updatedOn\n          createdOn\n          createdUser {\n            id\n            gravatar\n            gravatarProfile\n            username\n          }\n          paths {\n            base\n            thumb\n            medium\n          }\n        }\n        relation\n      }\n      window\n    }\n  }\n`\n\nexport const userSearch = gql`\n  query userSearch($searchStr: String!, $limit: Int) {\n    userSearch(searchStr: $searchStr, limit: $limit ){\n      id\n      username\n      gravatar\n      gravatarProfile\n      createdOn\n      updatedOn\n      createdOn\n    }\n  }\n`\n\nexport const getWholeSeries = gql`\nquery getWholeSeries($id: ID!) {\n  series(id: $id) {\n    id\n    name\n    note\n    meta\n    watchers\n    createdOn\n    createdUser {\n      id\n      gravatar\n      gravatarProfile\n      username\n    }\n    updatedOn\n    createdOn\n    coords\n    direction\n    photoCount\n    featured {\n      id\n      takenOn\n      paths {\n        base\n        large\n        thumb\n        medium\n      }\n    }\n    latest {\n      id\n      paths {\n        base\n        large\n        thumb\n        medium\n      }\n      takenOn\n    }\n    photos {\n      id\n      meta\n      createdOn\n      takenOn\n      updatedOn\n      createdOn\n      createdUser {\n        id\n        gravatar\n        gravatarProfile\n        username\n      }\n      tags {\n        label\n        typeId\n        coords {\n          x\n          y\n        }\n      }\n      paths {\n        base\n        large\n        thumb\n        medium\n      }\n    }\n  }\n}\n`\n","import React from 'react'\n\nexport const AppContext = React.createContext({})\n","import { useRef, useEffect } from 'react'\n\nconst useAuthCommon = () => {\n  const containerRef = useRef()\n  const handleKeyPress = (event) => {\n    if (event.key === 'Enter') {\n      if (containerRef.current) {\n        try {\n          const found = containerRef.current.getElementsByClassName('enterAction')\n          if (found && found[0]) found[0].click()\n        }\n        catch (e) {\n          console.error('useAuthCommon::handleKeyPress', e)\n        }\n      }\n    }\n  }\n  useEffect(() => {\n    if (containerRef.current) {\n      try {\n        document.addEventListener('keypress', handleKeyPress, false)\n      }\n      catch (e) {\n        console.error('useAuthCommon::useEffect', e)\n      }\n      return () => document.removeEventListener('keypress', handleKeyPress, false)\n    }\n  }, [])\n\n  return containerRef\n}\n\nexport default useAuthCommon\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport { makeStyles } from '@material-ui/core/styles'\n// import style from './auth.style'\nimport useAuthCommon from './useAuthCommon'\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    height: '100%'\n  },\n  bgSwoosh: {\n    width: '100%',\n    height: '100%',\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    zIndex: 0\n  },\n  inner: {\n    width: '100%',\n    minWidth: 200,\n    maxWidth: 300,\n    position: 'absolute',\n    zIndex: 2,\n    textAlign: 'center',\n    top: '50%',\n    left: '50%',\n    transformOrigin: '50% 50%',\n    transform: 'translateY(-50%) translateX(-50%)'\n  },\n  bgSwooshFill: {\n    fill: theme.palette.primary.light\n  }\n}))\n\nconst AuthContainer = ({ children }) => {\n  const containerRef = useAuthCommon()\n  const classes = useStyles()\n  return (\n    <div ref={containerRef} className={classes.root}>\n      <CssBaseline />\n      {/* Look for: LoginSwoosh.svg */}\n      <svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 500 500' preserveAspectRatio='none' className={classes.bgSwoosh}>\n        <path className={classes.bgSwooshFill} d=' M 0 0 L 500 0 C 500 209.782 489.956 180 250 180 C 10.044 180 0 219.954 0 370 L 0 0 Z ' />\n      </svg>\n\n      <div className={classes.inner}>\n        {/* Look for: Logo.svg */}\n        <img alt='logo' src={`${process.env.PUBLIC_URL}/icons/Logo.svg`} />\n        <Typography variant='h5'>App Name Here</Typography>\n        {children}\n      </div>\n    </div>\n  )\n}\n\nAuthContainer.propTypes = {\n  children: PropTypes.any\n}\n\nexport default AuthContainer\n","import React from 'react'\n// import PropTypes from 'prop-types'\n// import MenuIcon from '@material-ui/core/Menu'\n// import { makeStyles } from '@material-ui/core/styles'\n// import style from './auth.style'\nimport AuthContainer from './AuthContainer'\nimport { Typography } from '@material-ui/core'\n\n// const useStyles = makeStyles(style)\n\nconst Loading = () => {\n  // const classes = useStyles()\n  return (\n    <AuthContainer>\n      <Typography variant='h3'>Loading...</Typography>\n    </AuthContainer>\n  )\n}\n\nLoading.propTypes = {\n}\n\nexport default Loading\n","import { createHttpLink } from 'apollo-link-http'\nimport { setContext } from 'apollo-link-context'\n// import PropTypes from 'prop-types'\nimport { endpoints } from '../config'\nimport { ApolloLink } from 'apollo-link'\nimport { InMemoryCache, ApolloClient } from 'apollo-boost'\n\nconst LOCAL_STORAGE_TOKEN = 'apollo-token'\n/**\n * Helper function to create our Apollo Client object\n * @param {*} token\n */\nexport function createApolloClient (token = '') {\n  // Set up our headers for authentication through graphql\n  const cache = new InMemoryCache()\n\n  // The auth link is just used to decorate our HTTP headers with authentication data\n  const authLink = setContext((_, { headers }) => {\n    const newHeaders = {\n      ...headers,\n      authorization: token ? `Bearer ${token}` : ''\n    }\n    // on Dev machines, allow us to fake a user. This will ONLY work with a complimentary\n    // Dev graphql endpoint and singin is still required.\n\n    // This was done so we can test what the App looks like from varying perspectives\n    if (process.env.NODE_ENV === 'development' && process.env.REACT_APP_FAKE_USER) {\n      newHeaders.auth_user = process.env.REACT_APP_FAKE_USER\n    }\n    return { headers: newHeaders }\n  })\n\n  // HTTP link creates the network connection to our graphql host\n  const httpLink = createHttpLink({ uri: endpoints.graphql })\n  console.log('Creating Apollo Client Client', endpoints.graphql, token ? 'TOKEN PROVIDED' : 'NO TOKEN')\n\n  const apolloClient = new ApolloClient({\n    link: ApolloLink.from([authLink, httpLink]),\n    tokenName: LOCAL_STORAGE_TOKEN,\n    cache,\n    connectToDevTools: true\n  })\n\n  // Now put it all together\n  return apolloClient\n}\n\n// Note: this method comes from isntructions here:\n// https://www.apollographql.com/docs/react/recipes/authentication.html\n// export const withApollo = compose(\n//   lifecycle({\n//     shouldComponentUpdate (nextProps) {\n//       const { authStore: { jwtToken: oldToken } } = nextProps\n//       const { authStore: { jwtToken: newToken } } = this.props\n//       if (newToken === oldToken) {\n//         return true\n//       }\n//       return true\n//     }\n//   }),\n//   withWrapClient\n// )\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\n/**\n * Note: this was one of the few components we didn't use hooks for\n * mostly because I couldn't find an easy way to do getDerivedStateFromError()\n *\n * We might revise this later\n */\nclass ErrorBoundary extends React.Component {\n  constructor (props) {\n    super(props)\n    this.state = { hasError: false }\n  }\n\n  static getDerivedStateFromError (error) {\n    // Update state so the next render will show the fallback UI.\n    console.error(error)\n    return { hasError: true, error }\n  }\n\n  // componentDidCatch (error, info) {\n  //   console.error(error)\n  //   // You can also log the error to an error reporting service\n  //   // logErrorToMyService(error, info)\n  // }\n\n  render () {\n    const { hasError, error } = this.state\n    const { fallback } = this.props\n    const FallbackUI = fallback\n    if (hasError) {\n      // You can render any custom fallback UI\n      return <FallbackUI error={error} />\n    }\n\n    return this.props.children\n  }\n}\nErrorBoundary.propTypes = {\n  fallback: PropTypes.any,\n  children: PropTypes.any\n}\n\nexport default ErrorBoundary\n","export default theme => ({\n  root: {\n  },\n  spacer: {\n    flexGrow: 1\n  },\n  forgotPassword: {\n    width: '100%',\n    textAlign: 'right'\n  },\n  switch: {\n\n  },\n  switchButton: {\n    flexGrow: 1,\n    '&:last-child': {\n      borderRadius: 0\n    },\n    '&:first-child': {\n      borderRadius: 0\n    }\n  },\n  phoneNumInner: {\n    marginTop: theme.spacing(1),\n    display: 'flex'\n    // border: '1px solid red'\n  },\n  phoneNumDropdown: {\n    margin: theme.spacing(1),\n    minWidth: 120\n  },\n  noSignin: {\n    marginTop: theme.spacing(2)\n  }\n})\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport TextField from '@material-ui/core/TextField'\nimport Button from '@material-ui/core/Button'\nimport Link from '@material-ui/core/Link'\nimport Toolbar from '@material-ui/core/Toolbar'\n// import MenuIcon from '@material-ui/core/Menu'\n// import { FederatedButtons } from 'aws-amplify-react'\nimport { makeStyles } from '@material-ui/core/styles'\nimport style from './auth.style'\nimport AuthContainer from './AuthContainer'\nimport { Typography } from '@material-ui/core'\n\nconst useStyles = makeStyles(style)\n\nconst SignIn = ({ loading,\n  handleSignup,\n  federated,\n  handleForgotPassword,\n  handleInputChange,\n  handleBeAnonymous,\n  handleSignIn, ...props }) => {\n  const classes = useStyles()\n  return (\n    <AuthContainer>\n      {/* {props.federated && (\n        <FederatedButtons {...props} />\n      )} */}\n      <TextField\n        id='username'\n        fullWidth\n        key='username'\n        name='username'\n        label='Username'\n        autoFocus\n        className={classes.textField}\n        margin='normal'\n        onChange={handleInputChange}\n      />\n      <TextField\n        fullWidth\n        id='password'\n        label='Password'\n        key='password'\n        name='password'\n        type='password'\n        className={classes.textField}\n        autoComplete='current-password'\n        margin='normal'\n        onChange={handleInputChange}\n      />\n      <Link component='button' variant='body2' className={classes.forgotPassword} disabled={loading} onClick={handleForgotPassword}>\n          Forgot Password\n      </Link>\n      <Toolbar disableGutters>\n\n        <Button component='button' color='secondary' variant='contained' disabled={loading} onClick={handleSignup}>\n          New Account\n        </Button>\n        <div className={classes.spacer} />\n        <Button\n          className='enterAction'\n          component='button'\n          color='primary'\n          variant='contained'\n          disabled={loading}\n          onClick={handleSignIn}\n        >\n          Sign In\n        </Button>\n      </Toolbar>\n\n      <div className={classes.noSignin}>\n        <Button fullWidth variant={'outlined'} onClick={handleBeAnonymous}>\n          Continue without logging in\n        </Button>\n        <Typography variant='caption'>You will not be able to add content and many features will be unavailable.</Typography>\n      </div>\n    </AuthContainer>\n  )\n}\n\nSignIn.propTypes = {\n  loading: PropTypes.bool,\n  federated: PropTypes.object,\n  handleSignup: PropTypes.func.isRequired,\n  handleForgotPassword: PropTypes.func.isRequired,\n  handleInputChange: PropTypes.func.isRequired,\n  handleBeAnonymous: PropTypes.func.isRequired,\n  handleSignIn: PropTypes.func.isRequired\n}\n\nexport default SignIn\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport TextField from '@material-ui/core/TextField'\nimport Button from '@material-ui/core/Button'\nimport Toolbar from '@material-ui/core/Toolbar'\n// import MenuIcon from '@material-ui/core/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nimport style from './auth.style'\nimport AuthContainer from './AuthContainer'\n\nconst useStyles = makeStyles(style)\n\nconst ConfirmSignIn = ({ handleInputChange, handleBack, handleConfirm }) => {\n  const classes = useStyles()\n  return (\n    <AuthContainer>\n      <TextField\n        id='mfaCode'\n        fullWidth\n        autoFocus\n        label='MFA Code'\n        name='code'\n        className={classes.textField}\n        margin='normal'\n        onChange={handleInputChange}\n      />\n\n      <Toolbar disableGutters>\n        <Button color='secondary' variant='contained' onClick={handleBack}>\n          Back\n        </Button>\n        <div className={classes.spacer} />\n        <Button\n          className='enterAction'\n          color='primary'\n          variant='contained'\n          onClick={handleConfirm}\n        >\n          Confirm\n        </Button>\n      </Toolbar>\n    </AuthContainer>\n  )\n}\n\nConfirmSignIn.propTypes = {\n  handleInputChange: PropTypes.func.isRequired,\n  handleBack: PropTypes.func.isRequired,\n  handleConfirm: PropTypes.func.isRequired\n}\n\nexport default ConfirmSignIn\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport TextField from '@material-ui/core/TextField'\nimport Button from '@material-ui/core/Button'\nimport Typography from '@material-ui/core/Typography'\nimport Toolbar from '@material-ui/core/Toolbar'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport style from './auth.style'\nimport AuthContainer from './AuthContainer'\n\nconst useStyles = makeStyles(style)\n\nconst RequireNewPassword = ({ change, requiredAttributes, placeholders, handleInputChange }) => {\n  const classes = useStyles()\n  return (\n    <AuthContainer>\n      <Typography>A new password is required</Typography>\n      <TextField\n        id='newassword'\n        fullWidth\n        autoFocus\n        label='New Password'\n        className={classes.textField}\n        type='password'\n        autoComplete='new-password'\n        margin='normal'\n        onChange={handleInputChange}\n      />\n      {requiredAttributes\n        .map((attribute, idx) => (\n          <TextField\n            fullWidth\n            key={attribute}\n            name={attribute}\n            className={classes.textField}\n            placeholder={placeholders[idx]}\n            type='text'\n            margin='normal'\n            onChange={handleInputChange}\n          />\n        ))}\n\n      <Toolbar disableGutters>\n\n        <Button color='secondary' variant='contained'>\n          Back\n        </Button>\n        <div className={classes.spacer} />\n        <Button\n          color='primary'\n          variant='contained'\n          onClick={change}\n          className='enterAction'\n        >\n          Change\n        </Button>\n      </Toolbar>\n    </AuthContainer>\n  )\n}\n\nRequireNewPassword.propTypes = {\n  change: PropTypes.func.isRequired,\n  handleInputChange: PropTypes.func.isRequired,\n  requiredAttributes: PropTypes.array,\n  placeholders: PropTypes.array\n}\n\nexport default RequireNewPassword\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\nimport TextField from '@material-ui/core/TextField'\nimport Button from '@material-ui/core/Button'\nimport Toolbar from '@material-ui/core/Toolbar'\nimport FormControl from '@material-ui/core/FormControl'\nimport InputLabel from '@material-ui/core/InputLabel'\nimport Select from '@material-ui/core/Select'\nimport AuthContainer from './AuthContainer'\n\n// import MenuIcon from '@material-ui/core/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nimport style from './auth.style'\n// import AuthPhoneNum from './AuthPhoneNum'\nconst useStyles = makeStyles(style)\n\nconst SignUp = ({ handleInputChange, signUpFields, signUpFieldLabels, signUpFieldPlaceholders,\n  handleSignup, handleBack, countryDialCodes, defaultDialCode }) => {\n  console.log('SIGNUPPROPS', { defaultDialCode, countryDialCodes, signUpFields, signUpFieldLabels, signUpFieldPlaceholders })\n  const [selectVal, setSelectVal] = useState(defaultDialCode)\n  const classes = useStyles()\n  const handleDialCodeChange = e => {\n    handleInputChange(e)\n    setSelectVal(e.target.value)\n  }\n  return (\n    <AuthContainer>\n      {\n        signUpFields.map((field, idx) => {\n          return field.key !== 'phone_number' ? (\n            <TextField\n              fullWidth\n              autoFocus={signUpFields.findIndex(f => f.key === field.key) === 0}\n              type={field.type}\n              name={field.key}\n              key={field.key}\n              placeholder={signUpFieldPlaceholders[idx]}\n              label={signUpFieldLabels[idx]}\n              className={classes.textField}\n              margin='normal'\n              onChange={handleInputChange}\n            />\n          ) : (\n            <FormControl\n              className={classes.phoneNumDropdown}\n              fullWidth\n              key='phonenum'\n            >\n              <InputLabel htmlFor='dial_code' shrink>\n                {signUpFieldLabels[idx]}\n                {field.required ? '*' : ''}\n              </InputLabel>\n              <div className={classes.phoneNumInner}>\n                <Select\n                  value={selectVal}\n                  onChange={handleDialCodeChange}\n                  inputProps={{\n                    name: 'dial_code',\n                    id: 'dial_code'\n                  }}\n                >\n                  {countryDialCodes.map(dialCode =>\n                    <option key={dialCode} value={dialCode}>\n                      {dialCode}\n                    </option>\n                  )}\n                </Select>\n                <TextField\n                  placeholder={signUpFieldPlaceholders[idx]}\n                  type='tel'\n                  fullWidth\n                  id='phone_line_number'\n                  key='phone_line_number'\n                  name='phone_line_number'\n                  onChange={handleInputChange}\n                />\n              </div>\n            </FormControl>\n          )\n        })\n      }\n      <Toolbar disableGutters>\n        <Button color='secondary' variant='outlined' onClick={handleBack}>\n          Back\n        </Button>\n        <div className={classes.spacer} />\n        <Button\n          className='enterAction'\n          component='button'\n          color='primary'\n          variant='contained'\n          onClick={handleSignup}\n        >\n          Create Account\n        </Button>\n      </Toolbar>\n    </AuthContainer>\n  )\n}\n\nSignUp.propTypes = {\n  handleInputChange: PropTypes.func.isRequired,\n  signUpFields: PropTypes.array.isRequired,\n  signUpFieldLabels: PropTypes.array.isRequired,\n  signUpFieldPlaceholders: PropTypes.array.isRequired,\n  countryDialCodes: PropTypes.array.isRequired,\n  defaultDialCode: PropTypes.string.isRequired,\n  handleSignup: PropTypes.func.isRequired,\n  handleBack: PropTypes.func.isRequired\n}\n\nexport default SignUp\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport TextField from '@material-ui/core/TextField'\nimport Button from '@material-ui/core/Button'\nimport Link from '@material-ui/core/Link'\nimport Toolbar from '@material-ui/core/Toolbar'\n// import MenuIcon from '@material-ui/core/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nimport style from './auth.style'\nimport AuthContainer from './AuthContainer'\n\nconst useStyles = makeStyles(style)\n\nconst ConfirmSignUp = ({ handleInputChange, handleBack, handleResend, handleConfirm }) => {\n  const classes = useStyles()\n  return (\n    <AuthContainer>\n      <TextField\n        id='username'\n        fullWidth\n        autoFocus\n        name='username'\n        label='Username'\n        className={classes.textField}\n        margin='normal'\n        onChange={handleInputChange}\n      />\n      <TextField\n        id='confirmationCode'\n        fullWidth\n        name='code'\n        label='Confirmation Code'\n        className={classes.textField}\n        margin='normal'\n        onChange={handleInputChange}\n\n      />\n      <Link component='button' variant='body2' className={classes.resendCode} onClick={handleResend}>\n          Resend Code\n      </Link>\n      <Toolbar disableGutters>\n\n        <Button color='secondary' variant='outlined' onClick={handleBack}>\n          Back\n        </Button>\n        <div className={classes.spacer} />\n        <Button\n          color='primary'\n          variant='contained'\n          className='enterAction'\n          onClick={handleConfirm}\n        >\n          Sign In\n        </Button>\n      </Toolbar>\n    </AuthContainer>\n  )\n}\n\nConfirmSignUp.propTypes = {\n  handleInputChange: PropTypes.func.isRequired,\n  handleBack: PropTypes.func.isRequired,\n  handleResend: PropTypes.func.isRequired,\n  handleConfirm: PropTypes.func.isRequired\n}\n\nexport default ConfirmSignUp\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\nimport Link from '@material-ui/core/Link'\nimport TextField from '@material-ui/core/TextField'\nimport Typography from '@material-ui/core/Typography'\nimport Button from '@material-ui/core/Button'\n\nimport Toolbar from '@material-ui/core/Toolbar'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport style from './auth.style'\nimport AuthContainer from './AuthContainer'\n\nconst useStyles = makeStyles(style)\n\nconst ForgotPassword = ({ handleSubmit, handleInputChange, handleSendCode, handleBack }) => {\n  const [sent, setSent] = useState(false)\n  const classes = useStyles()\n  return (\n    <AuthContainer>\n      <Typography>Forgot Password</Typography>\n      {!sent && (\n        <TextField\n          id='username'\n          autoFocus\n          fullWidth\n          label='Username'\n          name='username'\n          className={classes.textField}\n          margin='normal'\n          onChange={handleInputChange}\n        />\n      )}\n      {sent && (\n        <TextField\n          id='changecode'\n          fullWidth\n          autoFocus\n          label='Code'\n          name='code'\n          className={classes.textField}\n          margin='normal'\n          onChange={handleInputChange}\n        />\n      )}\n      {sent && (\n        <TextField\n          id='newpassword'\n          fullWidth\n          label='New Password'\n          className={classes.textField}\n          type='password'\n          name='password'\n          autoComplete='current-password'\n          margin='normal'\n          onChange={handleInputChange}\n        />\n      )}\n      {sent && (\n        <Link component='button' variant='body2' className={classes.resendCode} onClick={handleSendCode}>\n          Resend Code\n        </Link>\n\n      )}\n      <Toolbar disableGutters>\n        <Button\n          color='secondary'\n          variant='outlined'\n          onClick={() => {\n            sent ? setSent(false) : handleBack()\n          }}\n        >\n          Back\n        </Button>\n        <div className={classes.spacer} />\n        {!sent && (\n          <Button\n            color='primary'\n            variant='contained'\n            className='enterAction'\n            onClick={() => {\n              setSent(true)\n              handleSendCode()\n            }}\n          >\n          Send Code\n          </Button>\n        )}\n        {sent && (\n          <Button\n            className='enterAction'\n            color='primary'\n            variant='contained'\n            onClick={handleSubmit}\n          >\n          Submit\n          </Button>\n        )}\n      </Toolbar>\n    </AuthContainer>\n  )\n}\n\nForgotPassword.propTypes = {\n  handleSubmit: PropTypes.func.isRequired,\n  handleInputChange: PropTypes.func.isRequired,\n  handleSendCode: PropTypes.func.isRequired,\n  handleBack: PropTypes.func.isRequired\n}\n\nexport default ForgotPassword\n","import React, { useState } from 'react'\nimport Amplify, { Auth } from 'aws-amplify'\nimport { I18n } from '@aws-amplify/core' // ConsoleLogger as Logger\nimport countryDialCodes from 'aws-amplify-react/dist/Auth/common/country-dial-codes'\nimport {\n  Authenticator,\n  SignIn as SignInOrig,\n  SignUp as SignUpOrig,\n  ConfirmSignIn as ConfirmSignInOrig,\n  ConfirmSignUp as ConfirmSignUpOrig,\n  RequireNewPassword as RequireNewPasswordOrig,\n  Loading as LoadingOrig,\n  VerifyContact as VerifyContactOrig,\n  ForgotPassword as ForgotPasswordOrig\n} from 'aws-amplify-react'\n\nimport CompSignIn from '../components/auth/SignIn'\nimport CompConfirmSignIn from '../components/auth/ConfirmSignIn'\nimport CompRequireNewPassword from '../components/auth/RequireNewPassword'\nimport CompSignUp from '../components/auth/SignUp'\nimport CompLoading from '../components/auth/Loading'\nimport CompConfirmSignUp from '../components/auth/ConfirmSignUp'\n// import CompVerifyContact from '../components/auth/VerifyContact'\nimport CompForgotPassword from '../components/auth/ForgotPassword' // or 'aws-amplify-react-native';\nimport { aws } from '../config'\n\nAmplify.configure(aws)\n\nconst defaultAuthState = { authState: 'init', authData: {}, signedIn: null }\n\nconst useAuthentication = () => {\n  const [{ authState, authData, signedIn }, setAuth] = useState(defaultAuthState)\n\n  // Set up the trinary\n  // if (authState === 'signedIn') signedIn = true\n\n  const handleAuthStateChange = (state, data) => {\n    // console.log('handleAuthStateChange', { state, data })\n    setAuth({\n      authState: state,\n      authData: data,\n      // true = signedIn, false = beAnonymous, null = showLoginScreen\n      signedIn: !state || state.length === 0\n        ? null\n        : state === 'signedIn'\n          ? true\n          : signedIn\n    })\n  }\n\n  const signOut = () => Auth.signOut()\n    .then(data => console.log(data))\n    .catch(err => console.log(err))\n\n  const beAnonymous = () => {\n    setAuth({ authState, authData, signedIn: false })\n  }\n\n  const authScreen = signedIn ? null\n    : <Authenticator onStateChange={handleAuthStateChange} hideDefault>\n      <SignIn handleBeAnonymous={beAnonymous} />\n      <Loading />\n      <RequireNewPassword />\n      {/* <RequireNewPasswordOrig /> */}\n      <ConfirmSignIn />\n      <ConfirmSignUp />\n      {/* <VerifyContact /> NOT READY */}\n      <VerifyContactOrig />\n      <ForgotPassword />\n      <SignUp />\n      {/* <SignUpOrig /> */}\n    </Authenticator>\n\n  let accessToken = null\n  try {\n    if (signedIn) accessToken = authData.signInUserSession.accessToken.jwtToken\n    // console.log(`ACCESS TOKEN ${eqSpacer}\\n${accessToken}\\n/ACCESS TOKEN ${eqSpacer}`)\n  }\n  catch (e) {\n    console.error(e)\n  }\n  let isGod = false\n  try {\n    isGod = authData.signInUserSession.idToken.payload['cognito:groups'].indexOf('GodUsers') > -1\n  }\n  catch (e) {}\n\n  return {\n    authState,\n    authData,\n    isGod,\n    signOut,\n    forceSignIn: () => setAuth(defaultAuthState),\n    signedIn,\n    accessToken,\n    authScreen\n  }\n}\n\nexport default useAuthentication\n\nclass SignIn extends SignInOrig {\n  showComponent () {\n    const { loading } = this.state\n    const newProps = {\n      ...this.props,\n      loading,\n      handleForgotPassword: () => this.changeState('forgotPassword'),\n      handleSignup: () => this.changeState('signUp'),\n      handleInputChange: this.handleInputChange,\n      handleSignIn: this.signIn\n    }\n    return <CompSignIn {...newProps} />\n  }\n}\n\nclass SignUp extends SignUpOrig {\n  showComponent () {\n    const { hide } = this.props\n    if (hide && hide.includes(SignUp)) {\n      return null\n    }\n    if (this.checkCustomSignUpFields()) {\n      this.signUpFields = this.props.signUpConfig.signUpFields\n    }\n    this.sortFields()\n\n    const newProps = {\n      ...this.props,\n      countryDialCodes,\n      defaultDialCode: this.getDefaultDialCode(),\n      handleInputChange: this.handleInputChange,\n      signUpFields: this.signUpFields,\n      signUpFieldLabels: this.signUpFields.map(field => I18n.get(field.label)),\n      signUpFieldPlaceholders: this.signUpFields.map(field => I18n.get(field.placeholder)),\n      handleSignup: this.signUp,\n      handleBack: () => this.changeState('signIn')\n    }\n    return <CompSignUp {...newProps} />\n  }\n}\n\nclass ConfirmSignIn extends ConfirmSignInOrig {\n  showComponent () {\n    const newProps = {\n      ...this.props,\n      handleBack: () => this.changeState('signIn'),\n      handleInputChange: this.handleInputChange,\n      handleConfirm: this.confirm\n    }\n    return <CompConfirmSignIn {...newProps} />\n  }\n}\n\nclass ConfirmSignUp extends ConfirmSignUpOrig {\n  showComponent () {\n    const newProps = {\n      ...this.props,\n      handleBack: () => this.changeState('signIn'),\n      handleInputChange: this.handleInputChange,\n      handleConfirm: this.confirm,\n      handleResend: this.resend\n    }\n    return <CompConfirmSignUp {...newProps} />\n  }\n}\n\nclass RequireNewPassword extends RequireNewPasswordOrig {\n  showComponent () {\n    const user = this.props.authData\n    const { requiredAttributes } = user.challengeParam\n    const placeholders = Array.isArray(requiredAttributes)\n      ? requiredAttributes.map(attribute => I18n.get(convertToPlaceholder(attribute)))\n      : []\n\n    const newProps = {\n      ...this.props,\n      handleInputChange: this.handleInputChange,\n      requiredAttributes,\n      placeholders,\n      change: this.change\n    }\n    return <CompRequireNewPassword {...newProps} />\n  }\n}\n\nclass Loading extends LoadingOrig {\n  showComponent () {\n    return <CompLoading {...this.props} />\n  }\n}\n// class VerifyContact extends VerifyContactOrig {\n//   showComponent () {\n//     const user = this.props.authData\n//     if (!user) {\n//       verifyLogger.debug('no user for verify')\n//       return null\n//     }\n//     const { unverified } = user\n//     if (!unverified) {\n//       verifyLogger.debug('no unverified on user')\n//       return null\n//     }\n//     const { email, phoneNumber } = unverified\n\n//     const { authData } = this.props\n//     const newProps = {\n//       ...this.props,\n//       handleInputChange: this.handleInputChange,\n//       handleSkip: () => this.changeState('signedIn', authData),\n//       handleVerify: this.verify,\n//       handleSubmit: this.submit\n//     }\n//     return <CompVerifyContact {...newProps} />\n//   }\n// }\nclass ForgotPassword extends ForgotPasswordOrig {\n  showComponent () {\n    const newProps = {\n      ...this.props,\n      handleBack: () => this.changeState('signIn'),\n      handleInputChange: this.handleInputChange,\n      handleConfirm: this.confirm,\n      handleResend: this.send,\n      handleSubmit: this.submit,\n      handleSendCode: this.send\n    }\n    return <CompForgotPassword {...newProps} />\n  }\n}\n\n// const verifyLogger = new Logger('VerifyContact')\n\nfunction convertToPlaceholder (str) {\n  return str.split('_').map(part => part.charAt(0).toUpperCase() + part.substr(1).toLowerCase()).join(' ')\n}\n\n// const eqSpacer = '==============================================================='\n","import { useEffect } from 'react'\nimport { isIos } from './sensors'\n/**\n * Everything below here is about the prompt for installing a PWA\n */\n\n// Detects if device is in standalone mode\nconst isInStandaloneMode = () => ('standalone' in window.navigator) && (window.navigator.standalone)\n\nconst useShowAddToHome = () => {\n  const handleBeforePrompt = e => {\n    // Prevent Chrome 67 and earlier from automatically showing the prompt\n    e.preventDefault()\n    // Stash the event so it can be triggered later.\n    deferredPrompt = e\n    showAddToHomeScreen()\n  }\n\n  useEffect(() => {\n    // window.orientation [0,90,180, 270]\n    // screen\n    // Checks if should display install popup notification:\n    if (isIos() && !isInStandaloneMode()) {\n      console.log('I AM on IOS and I am NOT in standalone mode.')\n    // this.setState({ showInstallMessage: true })\n    }\n\n    window.addEventListener('beforeinstallprompt', handleBeforePrompt)\n    return () => {\n      window.removeEventListener('beforeinstallprompt', handleBeforePrompt)\n    }\n  }, [])\n\n  function addToHomeScreen () {\n    const a2hsBtn = document.querySelector('.ad2hs-prompt') // hide our user interface that shows our A2HS button\n    a2hsBtn.style.display = 'none' // Show the prompt\n    deferredPrompt.prompt() // Wait for the user to respond to the prompt\n    deferredPrompt.userChoice\n      .then(choiceResult => {\n        if (choiceResult.outcome === 'accepted') console.log('User accepted the A2HS prompt')\n        else console.log('User dismissed the A2HS prompt')\n\n        deferredPrompt = null\n      })\n  }\n\n  function showAddToHomeScreen () {\n    const a2hsBtn = document.querySelector('.ad2hs-prompt')\n    a2hsBtn.style.display = 'block'\n    a2hsBtn.addEventListener('click', addToHomeScreen)\n  }\n\n  let deferredPrompt\n}\n\nexport default useShowAddToHome\n","import { useCallback, useState, useLayoutEffect } from 'react'\nimport { debounce } from './util'\nimport { isIos, isPhone } from './sensors'\n\nconst getState = () => {\n  const { orientation, innerWidth, innerHeight, screen: { width, height } } = window\n  const wOrient = [90, 270].indexOf(orientation) !== 0 ? 'portrait' : 'landscape'\n  const bIsIos = isIos()\n  const bIsPhone = isPhone()\n  const windowSize = { width: innerWidth, height: innerHeight }\n  const screenSize = { width, height }\n\n  const returnState = {\n    isPhone: bIsPhone,\n    isIos: bIsIos,\n    orientation: wOrient,\n    windowSize,\n    screenSize\n    // This failed. the only way to handle this is to set it explicitly\n    // isVKeyBdOn: bIsPhone && windowSize.height < screenSize.height\n  }\n  return returnState\n}\n\nconst useResponsive = (mediQueries) => {\n  const [state, setState] = useState(getState())\n\n  const handleResize = (e) => {\n    if (e) {\n      e.preventDefault()\n      e.stopPropagation()\n    }\n    const newState = getState()\n    console.log('handleResize', newState)\n    setState(newState)\n  }\n\n  // const handleFlip = (e) => {\n  //   e.preventDefault()\n  //   e.stopPropagation()\n  //   const newState = getState()\n  //   console.log('handleFlip', newState)\n  //   setState(newState)\n  // }\n\n  const handleResizeDebounced = useCallback(debounce(handleResize, 500), [])\n  // const handleFlipDebounced = useCallback(debounce(handleFlip, 500), [])\n\n  useLayoutEffect(() => {\n    handleResizeDebounced()\n    window.addEventListener('resize', handleResizeDebounced)\n    // window.addEventListener('orientationchange', handleFlipDebounced)\n\n    return () => {\n      window.removeEventListener('resize', handleResizeDebounced)\n      // window.removeEventListener('orientationchange', handleFlipDebounced)\n    }\n  },\n  [])\n\n  return state\n}\n\nexport default useResponsive\n","/**\n * We put our action types at the top to keep them straight\n *\n * This is just a handy enumeration we use everywhere to make sure we're\n * all talking about the same ations\n */\nexport const Actions = {\n\n  HOME_CHANGE_STATE: 'HOME_CHANGE_STATE',\n  HOME_CHANGE_ACTIVE_SERIES: 'HOME_CHANGE_ACTIVE_SERIES',\n  HOME_STATE_BACK: 'HOME_STATE_BACK',\n\n  MAP_HISTORY_POP: 'MAP_HISTORY_POP',\n  MAP_HISTORY_PUSH: 'MAP_HISTORY_PUSH',\n  MAP_HISTORY_CLEAR: 'MAP_HISTORY_CLEAR',\n\n  UPLOADER_START: 'UPLOADER_START',\n  UPLOADER_COMPLETE: 'UPLOADER_COMPLETE',\n  UPLOADER_UPDATE_PROGRESS: 'UPLOADER_UPDATE_PROGRESS'\n\n}\n\n/**\n * Now here are the actual action functions we will be dispatching\n * The actions have arguments related to what they do but they action they\n * dispatch consists only of a type and data3\n */\nexport default {\n  setHomeState: (newDomain, params) => ({ type: Actions.HOME_CHANGE_STATE, data: { newDomain, params } }),\n  homeStateBack: () => ({ type: Actions.HOME_STATE_BACK }),\n  setActiveSeries: (seriesId, initialPhoto) => ({ type: Actions.HOME_CHANGE_ACTIVE_SERIES, data: { seriesId, initialPhoto } }),\n\n  popMapHistory: () => ({ type: Actions.MAP_HISTORY_POP }),\n  pushMapHistory: (viewportSave) => ({ type: Actions.MAP_HISTORY_PUSH, data: viewportSave }),\n  clearMapHistory: () => ({ type: Actions.MAP_HISTORY_CLEAR }),\n\n  queueUpload: (uploadObj) => ({ type: Actions.UPLOADER_START, data: uploadObj }),\n  // startActiveUpload: () => ({ type: Actions.UPLOADER_START }),\n  completeActiveUpload: () => ({ type: Actions.UPLOADER_COMPLETE }),\n  updateUploadProgress: (newProgress) => ({ type: Actions.UPLOADER_UPDATE_PROGRESS, data: newProgress })\n\n}\n","import { Actions } from '../actions'\nimport { home } from '../../config'\nconst mapInit = [\n  {\n    mode: home.MapModeTypes.FREE,\n    // selectedItem: null\n    viewport: {\n      // 'latitude': 49.2707848, // vancouver\n      // 'longitude': -123.0714866,\n      latitude: 36.80191008366581, // Grand Canyon\n      longitude: -111.63999999999784,\n      zoom: 11\n    }\n  }\n]\n\nexport default (state = mapInit, action) => {\n  const { type, data } = action\n\n  switch (type) {\n    case Actions.MAP_HISTORY_CLEAR:\n      const newClearerHistory = state.length > 0 ? [[state.length - 1]] : []\n      return newClearerHistory\n\n    case Actions.MAP_HISTORY_POP:\n      return state.slice(0, -1)\n\n    case Actions.MAP_HISTORY_PUSH:\n      return [...state, data]\n    default:\n      return state\n  }\n}\n","import { Actions } from '../actions'\nimport { home } from '../../config'\n\nconst homeInit = {\n  history: [],\n  current: {\n    domain: home.AppStateTypes.FEED\n    // search: null // { tab, text }\n    // defaultSearchTab:\n    // defaultSearchText:\n    // activeSeries: 'fda17bae-0335-4f0d-9065-dc8d7aa23ed1',\n    // initialPhoto: 'someguid'\n  }\n}\n\nexport default (state = homeInit, action) => {\n  const { type, data } = action\n  const { history, current } = state\n\n  switch (type) {\n    case Actions.HOME_STATE_BACK:\n      const newStateHistory = [...history]\n      const newCurrentState = newStateHistory.length > 0 ? newStateHistory.pop() : homeInit.current\n      return {\n        current: newCurrentState,\n        history: newStateHistory\n      }\n\n    case Actions.HOME_CHANGE_ACTIVE_SERIES:\n      const { activeSeries, initialPhoto } = current\n      return {\n        history,\n        current: {\n          ...current,\n          activeSeries: activeSeries || null,\n          initialPhoto: activeSeries && initialPhoto ? initialPhoto : null\n        }\n      }\n\n    case Actions.HOME_CHANGE_STATE:\n      const { newDomain, params } = data\n      const newParams = params || {}\n      const newHistory = [...history, current]\n      return {\n        history: newHistory,\n        current: {\n          ...current,\n          domain: newDomain,\n          ...newParams\n        }\n      }\n\n    default:\n      return state\n  }\n}\n","import { Actions } from '../actions'\n\nconst initState = {\n  store: [],\n  activeUpload: null\n}\n\nexport default (state = initState, action) => {\n  const { type, data } = action\n  const { store, activeUpload } = state\n\n  switch (type) {\n    case Actions.UPLOADER_START:\n      if (!activeUpload) {\n        return {\n          ...state,\n          activeUpload: data\n        }\n      }\n      else {\n        return {\n          ...state,\n          store: [...store, data]\n        }\n      }\n    case Actions.UPLOADER_COMPLETE:\n      if (store.length === 0) {\n        return {\n          ...state,\n          activeUpload: null\n        }\n      }\n      else {\n        const newStore = [...store]\n        const newActive = newStore.pop()\n        return {\n          ...state,\n          store: newStore,\n          activeUpload: newActive\n        }\n      }\n    case Actions.UPLOADER_UPDATE_PROGRESS:\n      return {\n        ...state,\n        activeUpload: { ...activeUpload, ...data }\n      }\n    default:\n      return state\n  }\n}\n","import { combineReducers } from 'redux'\nimport map from './map'\nimport home from './home'\nimport uploader from './uploader'\n\nexport default combineReducers({ map, home, uploader })\n","import { createStore, applyMiddleware, compose } from 'redux'\nimport thunk from 'redux-thunk'\nimport rootReducer from './reducers'\nimport { persistStore, persistReducer } from 'redux-persist'\nimport storage from 'redux-persist/lib/storage' // defaults to localStorage for web\n\n// import api from '../middleware/api'\n// https://github.com/reduxjs/redux/blob/master/examples/real-world/src/middleware/api.js\n\nconst persistConfig = {\n  key: 'root',\n  storage\n}\n\nconst persistedReducer = persistReducer(persistConfig, rootReducer)\n\n/**\n * On Dev we want our devTools available\n */\nconst configureStoreDev = preloadedState => {\n  const { devToolsEnhancer } = require('redux-devtools-extension')\n  const { createLogger } = require('redux-logger')\n  const store = createStore(\n    persistedReducer,\n    preloadedState,\n    compose(\n      devToolsEnhancer(),\n      applyMiddleware(\n        thunk,\n        createLogger()\n      )\n    )\n  )\n  if (module.hot) {\n    // Enable Webpack hot module replacement for reducers\n    module.hot.accept('./reducers', () => {\n      store.replaceReducer(rootReducer)\n    })\n  }\n  return store\n}\n\n/**\n * Production gets a simpler more performant store:\n */\nconst configureStoreProd = preloadedState => {\n  const store = createStore(\n    persistedReducer,\n    preloadedState,\n    compose(\n      applyMiddleware(\n        thunk\n      )\n    )\n  )\n  return store\n}\n\nexport default () => {\n  const store = process.env.NODE_ENV === 'production' ? configureStoreProd() : configureStoreDev()\n  return {\n    store,\n    persistor: persistStore(store)\n  }\n}\n","import React from 'react'\nimport { PersistGate } from 'redux-persist/integration/react'\nimport { Provider } from 'react-redux'\nimport storeConfig from './storeConfig'\nimport Loading from '../components/auth/Loading'\n/**\n * In this example, 'store' is the configured Redux store and\n *'persist' is a function that returns a Promise to rehydrate the\n * Redux store using redux-persist\n *\n * FROM: https://medium.com/hexient-labs/redux-store-provider-hoc-3495281905c\n */\nconst withReduxProvider = BaseComponent => (props) => {\n  const { store, persistor } = storeConfig()\n  console.log('withReduxProvider', { props, store, persistor })\n  return (\n    <Provider store={store}>\n      <PersistGate loading={<Loading />} persistor={persistor}>\n        <BaseComponent {...props} />\n      </PersistGate>\n    </Provider>\n  )\n}\n\nexport default withReduxProvider\n","import React from 'react'\nimport classNames from 'classnames'\nimport PropTypes from 'prop-types'\nimport Paper from '@material-ui/core/Paper'\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport LinearProgress from '@material-ui/core/LinearProgress'\nimport Typography from '@material-ui/core/Typography'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n    background: 'black',\n    color: theme.palette.primary.contrastText,\n    padding: theme.spacing(1) * 2\n  },\n  message: {\n    // width: '100%'\n  },\n  msgText: {\n    display: 'flex'\n  },\n  spacer: {\n    flexGrow: 1\n  },\n  messageInner: {\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst UploadControlUnstyled = ({ className, text, progress }) => {\n  const classes = useStyles()\n  if (!text) return null\n  const message = `Uploading: ${text}`\n  return (\n    <div className={classNames(classes.root, className)}>\n      <div className={classes.messageInner}>\n        <div className={classes.msgText}>\n          <Typography color='inherit'>{message}</Typography>\n          <div className={classes.spacer} />\n          <Typography color='inherit'>{progress}%</Typography>\n        </div>\n        <LinearProgress color='secondary' variant='determinate' value={progress} />\n      </div>\n    </div>\n  )\n}\n\nUploadControlUnstyled.propTypes = {\n  className: PropTypes.string,\n  text: PropTypes.string,\n  progress: PropTypes.number\n}\n\nconst UploadControl = UploadControlUnstyled\nexport default UploadControl\n\nexport const UploadControlCOSMOSWrapper = ({ text, progress }) => {\n  // const [someStateItem, setSomeStateItem] = useState()\n  const classes = useWrapperStyles()\n  return (\n    <div className={classes.root}>\n      <CssBaseline /> {/* You only need this in a root element. Don't put it anywhere else in the dom */}\n      <Paper className={classes.paper}>\n        <Typography variant='h5'>\n          This is a dummy component.\n        </Typography>\n      </Paper>\n      <UploadControl text={text} progress={progress} />\n    </div>\n  )\n}\n\nUploadControlCOSMOSWrapper.propTypes = {\n  text: PropTypes.string,\n  progress: PropTypes.number\n}\nconst wrapperStyle = theme => ({\n  root: {\n    height: '100%',\n    display: 'flex',\n    flexDirection: 'column'\n  },\n  paper: {\n    flexGrow: 1\n  }\n})\n\nconst useWrapperStyles = makeStyles(wrapperStyle)\n\nUploadControlCOSMOSWrapper.displayName = UploadControl.displayName\nexport const UploadControlTest = UploadControlCOSMOSWrapper\n","import axios from 'axios'\nimport FormData from 'form-data'\n\n/**\n * DEbuggers for AXIOS\n */\naxios.interceptors.request.use(\n  request => {\n    console.log('AXIOS:::: Starting Request', request)\n    return request\n  },\n  err => {\n    console.log('AXIOS:::: Starting Request ERROR', err)\n    return Promise.reject(err)\n  }\n)\n\naxios.interceptors.response.use(\n  response => {\n    console.log('AXIOS:::: Response', response)\n    return response\n  },\n  err => {\n    console.log('AXIOS:::: Starting Response ERROR', err)\n    return Promise.reject(err)\n  }\n)\n\nexport default async function doUpload (activeUpload, updateUploadProgress, completeActiveUpload) {\n  console.log('UploadConntect: upload start', activeUpload)\n\n  // Initialising the HTML POST form for posting to S3 directly\n  let formData = new FormData()\n  // Take the auth credentials that we got from the backend and add them to our S3 POST\n  Object.keys(activeUpload.preAuth.fields).forEach(fieldkey => {\n    console.log('APPEND', fieldkey, activeUpload.preAuth.fields[fieldkey])\n    formData.append(fieldkey, activeUpload.preAuth.fields[fieldkey])\n  })\n  const file = dataURLtoFile(activeUpload.base64, 'a.png')\n  formData.append('file', file)\n\n  const config = {\n    headers: {\n      'Content-Type': 'multipart/form-data'\n    },\n    onUploadProgress: progressEvent => {\n      const { loaded, total } = progressEvent\n      // Do something with the progress details\n      console.log('PROGRESSEVENT', loaded, total, Math.floor(100 * loaded / total))\n      updateUploadProgress({ progress: Math.floor(100 * loaded / total) })\n    }\n  }\n\n  console.log('FORMDATA', formData)\n  // Upload file to S3\n  await axios.post(\n    activeUpload.preAuth.url,\n    formData,\n    config\n  ).catch(err => {\n    console.error(err)\n    console.log(err.stack)\n  })\n  console.log('UploadConntect: upload done')\n  completeActiveUpload()\n}\n\nfunction dataURLtoFile (dataurl, filename) {\n  var arr = dataurl.split(','); var mime = arr[0].match(/:(.*?);/)[1]\n\n  var bstr = atob(arr[1]); var n = bstr.length; var u8arr = new Uint8Array(n)\n  while (n--) {\n    u8arr[n] = bstr.charCodeAt(n)\n  }\n  return new File([u8arr], filename, { type: mime })\n}\n","import React, { useRef, useEffect } from 'react'\nimport PropTypes from 'prop-types'\nimport { connect } from 'react-redux'\nimport actions from '../redux/actions'\nimport UploadControl from '../components/UploadControl'\nimport s3Upload from '../lib/s3upload'\n\nconst UploadConntect = ({\n  activeUpload,\n  completeActiveUpload,\n  updateUploadProgress,\n  ...props\n}) => {\n  const uploadingRef = useRef()\n  useEffect(() => {\n    uploadingRef.current = uploadingRef.current && !!activeUpload\n\n    if (activeUpload && !uploadingRef.current) {\n      s3Upload(activeUpload, updateUploadProgress, completeActiveUpload)\n    }\n  }, [Boolean(activeUpload)])\n\n  if (!activeUpload) return null\n  return <UploadControl text={'Uploading thing'} progress={activeUpload.progress || 0} {...props} />\n}\nUploadConntect.propTypes = {\n  // All from redux\n  activeUpload: PropTypes.object,\n  completeActiveUpload: PropTypes.func.isRequired,\n  updateUploadProgress: PropTypes.func.isRequired\n}\n\n/**\n * Map our redux state and functions\n */\nconst mapStateToProps = (state, props) => {\n  const { activeUpload } = state.uploader\n  return { activeUpload }\n}\n\nconst mapDispatchToProps = dispatch => ({\n  completeActiveUpload: () => {\n    dispatch(actions.completeActiveUpload())\n  },\n  updateUploadProgress: (newProgress) => {\n    dispatch(actions.updateUploadProgress(newProgress))\n  }\n})\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(UploadConntect)\n","/**\n * Valid Roles are: admin, user, nonuser\n *\n * Valid Resources are: series, series_public, series_open, photo\n *\n * For more see:\n * https://docs.google.com/spreadsheets/d/1oXsZrsuyOSFs_tufRluSjQiR6OSTObWiGsKDUKb5vLk/edit#gid=0\n *\n * RTFM:\n * https://onury.io/accesscontrol/?content=guide#resources-and-resource-attributes\n */\nexport default {\n  // Admin is god. Be careful who you give this to.\n  admin: {\n    series: {\n      'create:own': ['*'],\n      'read:any': ['*'],\n      'update:any': ['*'],\n      'delete:any': ['*']\n    },\n    photo: {\n      'create:any': ['*'],\n      'read:any': ['*'],\n      'update:any': ['*'],\n      'delete:any': ['*']\n    }\n  },\n  // Logged out users can see public stuff but nothing esle\n  nonuser: {\n    photo: {\n      'read:any': ['*'],\n      'update:any': ['*'],\n      'delete:any': ['*']\n    },\n    series_public: {\n      'read:any': ['*']\n    },\n    series_open: {\n      'read:any': ['*']\n    }\n  },\n  // Users are the key permissions role in V0\n  // Note: we could inherit from user but we keep it explicit for now\n  user: {\n    series: {\n      'create:own': ['*'],\n      'read:own': ['*'],\n      'update:own': ['*'],\n      'delete:own': ['*']\n    },\n    series_public: {\n      'read:any': ['*']\n    },\n    series_open: {\n      'read:any': ['*'],\n      'update:any': ['photos']\n    },\n    photo: {\n      'read:any': ['*'],\n      'create:own': ['*'],\n      'update:own': ['*'],\n      'delete:own': ['*']\n    }\n  }\n}\n","import gql from 'graphql-tag'\n\nexport const deletePhoto = gql`\n  mutation deletePhoto($seriesId: ID!, $photoId: ID!) {\n    deletePhoto(seriesId: $seriesId, photoId: $photoId)\n  }\n`\n\nexport const deleteSeries = gql`\n  mutation deleteSeries($id: ID!) {\n    deleteSeries(id: $id)\n  }\n`\n\nexport const updateSeries = gql`\n  mutation updateSeries($series: UpdateSeriesInput!) {\n    updateSeries(series: $series){\n      id\n      name\n      note\n      meta\n      latitude\n      longitude\n      direction\n      photoCount\n      featured {\n        id\n        takenOn\n        paths {\n          base\n          thumb\n          medium\n          large\n        }\n      }     \n    }\n  }\n`\n\nexport const updatePhoto = gql`\n  mutation updatePhoto($photo: UpdatePhotoInput!) {\n    updatePhoto(photo: $photo){\n      id\n    }\n  }\n`\n\nexport const createPhoto = gql`\n  mutation createPhoto($photo: NewPhotoInput!, $ext: String!) {\n    createPhoto(photo: $photo, ext: $ext) {\n      photo {\n        id\n        meta\n        createdUser {\n          id\n          gravatar\n          gravatarProfile\n          name\n        }\n        seriesId\n        # createdOn\n        takenOn\n        # updatedOn\n        tags {\n          label\n          typeId\n          coords {\n            x\n            y\n          }\n        }\n        paths {\n          base\n          thumb\n          medium\n          large\n        }\n      }\n      preAuth\n    }\n  }\n`\n\nexport const createSeries = gql`\n  mutation createSeries($series: NewSeriesInput!) {\n    createSeries(series: $series) {\n      id\n      name\n      note\n      meta\n      # createdOn\n      # updatedOn\n      latitude\n      longitude\n      direction\n      photoCount\n      featured {\n        id\n        takenOn\n        paths {\n          base\n          thumb\n          medium\n          large\n        }\n      }\n      # latest {\n      #   id\n      #   paths {\n      #     thumb\n      #   }\n      #   createdBy\n      #   createdOn\n      #   takenOn\n      #   updatedOn\n      # }\n      photos {\n        id\n        meta\n        createdUser {\n          id\n          gravatar\n          gravatarProfile\n          name\n        }   \n        # createdOn\n        takenOn\n        # updatedOn\n        tags {\n          label\n          typeId\n          coords {\n            x\n            y\n          }\n        }\n        paths {\n          base\n          thumb\n          medium\n          large\n        }\n      }\n    }\n  }\n`\n\nexport const watchSeries = gql`\n  mutation watch($seriesId: ID) {\n    watchSeries(seriesId: $seriesId)\n  }\n`\n\nexport const unWatchSeries = gql`\n  mutation unWatch($seriesId: ID) {\n    unWatchSeries(seriesId: $seriesId)\n  }\n`\n","import React, { useState, useRef } from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport SpeedDial from '@material-ui/lab/SpeedDial'\nimport SpeedDialAction from '@material-ui/lab/SpeedDialAction'\n\n// import useNewImageMenu from '../PhotoSeries/views/controls/useNewImageMenu'\nimport AddCameraIcon from '@material-ui/icons/AddAPhoto'\nimport PhotoLibraryIcon from '@material-ui/icons/PhotoLibrary'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    position: 'absolute',\n    bottom: theme.mixins.toolbar / 2,\n    left: '50%',\n    transformOrigin: '50% 50%',\n    transform: 'translateY(-50%) translateX(-50%)'\n  },\n  speedDialFab: {\n    background: theme.palette.secondary.main,\n    color: theme.palette.secondary.contrastText\n  },\n  directionUp: {\n  }\n}))\n\nconst AddFab = ({ className, children, onCameraClick, onLibraryClick }) => {\n  const [open, setOpen] = useState(false)\n  const [down, setDown] = useState(false)\n  const classes = useStyles()\n  // const theme = useTheme()\n  const downRef = useRef(down)\n  downRef.current = down\n\n  const startTimer = (el) => {\n    setDown(true)\n    if (!open) {\n      setTimeout(() => {\n        if (downRef.current) setOpen(true)\n      }, 300)\n    }\n  }\n\n  // const onUp = (e) => {\n  //   // console.log('onUp', e.currentTarget)\n  //   // setSeries(series)\n  //   setDown(false)\n  //   setOpen(false)\n  //   // onCameraClick()\n  // }\n\n  const onDown = (e) => {\n    // console.log('onDown', e.currentTarget)\n    // setSeries(series)\n    startTimer(e.currentTarget)\n  }\n\n  const block = (e) => {\n    if (e && e.stopPropagation) {\n      e.stopPropagation()\n      e.preventDefault()\n    }\n  }\n\n  return (\n    <SpeedDial\n      ariaLabel='SpeedDial photo adder'\n      onBlur={(e) => {\n        setTimeout(() => setOpen(false), 250)\n      }}\n      classes={{\n        directionUp: classes.directionUp,\n        root: classes.root,\n        fab: classNames(classes.speedDialFab, className)\n      }}\n      icon={children}\n      onClick={(e) => {\n        block(e)\n        setDown(false)\n        if (!open) {\n          console.log('cameraclick MAIN')\n          onCameraClick()\n        }\n      }}\n      onMouseDown={onDown}\n      // onMouseUp={onUp}\n      onTouchStart={onDown}\n      // onTouchEnd={onUp}\n\n      open={open}\n      direction='up'\n    >\n      <SpeedDialAction\n        // Bit of a hack here. This function isn't quite ready for primetime\n        icon={<AddCameraIcon className={classes.speedDialIcon} />}\n        tooltipPlacement='right'\n        tooltipTitle='From Camera'\n        tooltipOpen\n        onClick={(e) => {\n          console.log('cameraclick')\n          setOpen(false)\n          setDown(false)\n          onCameraClick()\n          block(e)\n        }}\n      />\n      <SpeedDialAction\n        // Bit of a hack here. This function isn't quite ready for primetime\n        icon={<PhotoLibraryIcon className={classes.speedDialIcon} />}\n        tooltipPlacement='right'\n        tooltipTitle='From Photo Library'\n        tooltipOpen\n        onClick={(e) => {\n          console.log('libraryClick')\n          setOpen(false)\n          setDown(false)\n          onLibraryClick()\n          block(e)\n        }}\n      />\n    </SpeedDial>\n  )\n}\n\nAddFab.propTypes = {\n  className: PropTypes.string,\n  children: PropTypes.any,\n  onCameraClick: PropTypes.func.isRequired,\n  onLibraryClick: PropTypes.func.isRequired\n}\n\nexport default AddFab\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Menu from '@material-ui/core/Menu'\nimport MenuItem from '@material-ui/core/MenuItem'\nimport ListItemIcon from '@material-ui/core/ListItemIcon'\nimport ListItemText from '@material-ui/core/ListItemText'\nimport Divider from '@material-ui/core/Divider'\n\n// import { Menu as MenuIcon } from '@material-ui/icons'\n\nconst ContextMenu = ({ anchorEl, onClose, menuItems }) => {\n  return (\n    <Menu\n      anchorEl={anchorEl}\n      open={!!anchorEl}\n      onClose={onClose}\n    >\n      {menuItems.map(({ icon, color, text, hide, disabled, action, divider }, idx) => {\n        const Icon = icon || null\n        if (hide) return null\n        if (divider) return <Divider key={`contextMenu-${idx}`} />\n        return (\n          <MenuItem\n            key={`contextMenu-${idx}`}\n            disabled={disabled}\n            onClick={() => {\n              onClose()\n              action()\n            }}>\n            {Icon && (\n              <ListItemIcon>\n                <Icon color={disabled ? 'disabled' : color} />\n              </ListItemIcon>\n            )}\n            <ListItemText primary={text} primaryTypographyProps={{ color }} />\n          </MenuItem>\n        )\n      })}\n    </Menu>\n  )\n}\n\nContextMenu.propTypes = {\n  anchorEl: PropTypes.object,\n  onClose: PropTypes.func,\n  menuItems: PropTypes.arrayOf(PropTypes.shape({\n    text: PropTypes.string,\n    icon: PropTypes.any,\n    divider: PropTypes.any,\n    hide: PropTypes.bool,\n    disabled: PropTypes.bool,\n    color: PropTypes.string,\n    action: PropTypes.func\n  }))\n}\n\nexport default ContextMenu\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\n\nimport Divider from '@material-ui/core/Divider'\nimport List from '@material-ui/core/List'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemText from '@material-ui/core/ListItemText'\nimport Typography from '@material-ui/core/Typography'\nimport FormLabel from '@material-ui/core/FormLabel'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport TagChip from '../tags/TagChip'\nimport style from './SeriesInfo.style'\n\nimport ShortLongText from '../controls/ShortLongText'\nimport BigText from '../dialogs/BigText'\nimport { formatDate } from '../../../../lib/datelib'\nimport SeriesConfigClass from '../../../../lib/SeriesConfig'\n\nconst DIALOGS = {\n  NOTEVIEW: 'NOTEVIEW'\n}\nconst useStyles = makeStyles(style)\n\nconst SeriesInfo = ({ seriesConfig, series }) => {\n  const classes = useStyles()\n  const seriesConfigInst = new SeriesConfigClass(seriesConfig)\n  const [activeDialog, setActiveDialog] = useState(null)\n  const newTags = series.photos.reduce((acc, { tags }) => {\n    tags.forEach(tag => {\n      if (!acc[tag.typeId]) {\n        acc[tag.typeId] = {\n          [tag.label]: { ...tag, count: 1 }\n        }\n      }\n      else if (acc[tag.typeId][tag.label]) {\n        const existing = acc[tag.typeId][tag.label]\n        acc[tag.typeId][tag.label] = { ...existing, count: existing.count + 1 }\n      }\n      else acc[tag.typeId][tag.label] = { ...tag, count: 1 }\n    })\n    return acc\n  }, {})\n\n  let metaKeys = []\n  try {\n    metaKeys = series.meta ? Object.keys(JSON.parse(series.meta)) : []\n  }\n  catch (e) {\n    console.error(e)\n  }\n\n  return (\n    <div className={classes.root}>\n      <div className={classes.field}>\n        <FormLabel className={classes.formLabel}>\n      Series Name\n        </FormLabel>\n        <Typography variant='body1' color='inherit'>\n          {series.name}\n        </Typography>\n      </div>\n      {series.note && (\n        <ShortLongText\n          label='Series Note'\n          text={series.note}\n          onClick={() => setActiveDialog(DIALOGS.NOTEVIEW)}\n        />\n      )}\n\n      <Typography className={classes.heading} variant='subtitle1'>Series Summary</Typography>\n      <Divider />\n      <List className={classes.list}>\n        <ListItem disableGutters>\n          <ListItemText\n            primary={`Photos: ${series.photos.length}`}\n            secondary={series.photos.length > 0 && (\n              <span>\n             First: {formatDate(series.photos[series.photos.length - 1].takenOn, 'lll')}\n                <br />\n             Latest: {formatDate(series.photos[0].takenOn, 'lll')}\n              </span>\n            )}\n          />\n        </ListItem>\n\n        <ListItem disableGutters>\n          <ListItemText>\n            <FormLabel className={classes.formLabel}>\n              Tags in use (across all photos)\n            </FormLabel>\n            <Divider />\n            {Object.keys(newTags).length === 0 && (\n              <Typography variant='caption'>No photos in this series have tags</Typography>\n            )}\n            {Object.keys(newTags).map((tagKey, idtk) => (\n              <div key={`tagchipkey${idtk}`} className={classes.tagListItem}>\n                <Typography className={classes.subheading} variant='overline'>{seriesConfigInst.getTagType(tagKey).label}</Typography>\n                <Divider />\n                {Object.values(newTags[tagKey]).length > 0\n                  ? (\n                    Object.values(newTags[tagKey]).map((tag, idx) => (\n                      <TagChip\n                        key={`tagchip-${idtk}-${idx}`}\n                        tag={tag}\n                        color={seriesConfigInst.getTagType(tagKey).color}\n                      />\n                    ))\n                  )\n                  : (\n                    <Typography variant='caption'>No photos in this series have tags</Typography>\n                  )\n                }\n              </div>\n            ))}\n          </ListItemText>\n        </ListItem>\n\n      </List>\n\n      {metaKeys.length > 0 && Object.keys(seriesConfig.meta).length > 0 && (\n        <React.Fragment>\n          <FormLabel className={classes.formLabel}>\n            Metadata\n          </FormLabel>\n          <Divider />\n          <List className={classes.list}>\n            {metaKeys.map((key, idx) => seriesConfig.meta[key] ? (\n              <ListItem key={`metadata${idx}`}>\n                <ListItemText\n                  primary={seriesConfig.meta[key].label}\n                  secondary={seriesConfig.meta[key].render(series.meta[key])}\n                />\n              </ListItem>\n            ) : null\n            )}\n          </List>\n        </React.Fragment>\n      )}\n      {activeDialog === DIALOGS.NOTEVIEW && (\n        <BigText\n          open\n          multiline\n          onClose={() => setActiveDialog(null)}\n          title='Series Note'\n          body={series.note}\n        />\n      )}\n    </div>\n  )\n}\n\nSeriesInfo.propTypes = {\n  seriesConfig: PropTypes.object.isRequired,\n  series: PropTypes.object.isRequired\n}\n\nexport default SeriesInfo\n","export default theme => ({\n  root: {\n    margin: theme.spacing(1),\n    backgroundColor: theme.palette.background.paper,\n    marginBottom: 60 // a little extra room for the FAB\n\n  },\n  field: {\n    marginBottom: theme.spacing(1)\n  },\n  list: {\n    padding: theme.spacing(1)\n  },\n  heading: {\n    marginTop: theme.spacing(1)\n  },\n  tagListItem: {\n    marginTop: theme.spacing(1),\n    marginBottom: theme.spacing(2)\n  },\n  chip: {\n    margin: theme.spacing(0.5)\n  }\n})\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\n\nimport MobileStepper from '@material-ui/core/MobileStepper'\nimport IconButton from '@material-ui/core/IconButton'\nimport GridListTileBar from '@material-ui/core/GridListTileBar'\nimport Badge from '@material-ui/core/Badge'\n\nimport LabelIcon from '@material-ui/icons/Label'\n// import RemoveRedEye from '@material-ui/icons/RemoveRedEye'\nimport KeyboardArrowLeft from '@material-ui/icons/KeyboardArrowLeft'\nimport KeyboardArrowRight from '@material-ui/icons/KeyboardArrowRight'\n\nimport SwipeableViews from 'react-swipeable-views'\nimport Photo from './Photo'\nimport { formatDate } from '../../../../lib/datelib'\nimport { makeStyles, useTheme } from '@material-ui/core/styles'\nimport style from './SwipeShow.style'\n\nconst useStyles = makeStyles(style)\n\nconst SwipeShow = ({ photos, initialPhoto, onImageSelect }) => {\n  const classes = useStyles()\n  const theme = useTheme()\n  const initPhotoIndex = initialPhoto ? photos.findIndex(p => p.id === initialPhoto) || 0 : 0\n  const [activePhoto, setActivePhoto] = useState(initPhotoIndex >= 0 ? initPhotoIndex : 0)\n  const [showTags, setShowTags] = useState(false)\n  const singular = photos.length < 2\n\n  const sortedPhotos = [...photos]\n  sortedPhotos.sort((a, b) => parseInt(b.takenOn, 10) - parseInt(a.takenOn, 10))\n\n  const handleForward = () => setActivePhoto(activePhoto >= sortedPhotos.length ? 0 : activePhoto + 1)\n  const handleBack = () => setActivePhoto(activePhoto <= 0 ? sortedPhotos.length - 1 : activePhoto - 1)\n\n  return (\n    <div className={classes.root}>\n      <div className={classes.inner}>\n        <SwipeableViews\n          axis={theme.direction === 'rtl' ? 'x-reverse' : 'x'}\n          index={activePhoto}\n          onChangeIndex={(val) => setActivePhoto(val)}\n          enableMouseEvents\n        >\n          {sortedPhotos.map((photo, idx) => (\n            <div className={classes.photoWrapper} key={`swipeshowpic-${idx}`} onClick={() => onImageSelect(sortedPhotos[activePhoto].id)}>\n              <Photo photo={photo} className={classes.photo} showTags={showTags} />\n            </div>\n          ))}\n        </SwipeableViews>\n        <IconButton size='small' className={classes.manualBack} onClick={handleBack} color='inherit' disabled={activePhoto === 0}>\n          {theme.direction === 'rtl' ? <KeyboardArrowRight /> : <KeyboardArrowLeft />}\n        </IconButton>\n        <IconButton size='small' className={classes.manualForward} onClick={handleForward} color='inherit' disabled={activePhoto === photos.length - 1}>\n          {theme.direction === 'rtl' ? <KeyboardArrowLeft /> : <KeyboardArrowRight />}\n        </IconButton>\n        <GridListTileBar\n          title={singular ? 'Photo' : `Photo (${activePhoto + 1}/${sortedPhotos.length})`}\n          subtitle={sortedPhotos.length > 0 && (\n            <span>{formatDate(sortedPhotos[activePhoto].takenOn)}</span>\n          )}\n          actionIcon={\n            <React.Fragment>\n              <IconButton className={classes.tagButton} onClick={() => setShowTags(!showTags)}>\n                <Badge color={showTags ? 'primary' : 'secondary'} badgeContent={sortedPhotos[activePhoto].tags ? sortedPhotos[activePhoto].tags.filter(tag => tag.coords).length : null}>\n                  <LabelIcon />\n                </Badge>\n              </IconButton>\n            </React.Fragment>\n          }\n        />\n      </div>\n      {!singular &&\n      <MobileStepper\n        steps={sortedPhotos.length}\n        position='static'\n        activeStep={activePhoto}\n        classes={{\n          root: classes.mobileStepper,\n          dots: classes.dots\n        }}\n      />\n      }\n    </div>\n  )\n}\n\nSwipeShow.propTypes = {\n  // This is just the basic shape of the photo object\n  initialPhoto: PropTypes.string,\n  photos: PropTypes.arrayOf(PropTypes.shape({\n    img: PropTypes.string,\n    tags: PropTypes.array,\n    date: PropTypes.date\n  })),\n  transition: PropTypes.number,\n  onImageSelect: PropTypes.func.isRequired\n}\n\nSwipeShow.defaultProps = {\n  transition: 5000,\n  isFullScreen: false,\n  slides: []\n}\n\nexport default SwipeShow\n","export default theme => ({\n  root: {\n    position: 'relative'\n  },\n  inner: {\n    position: 'relative'\n  },\n  photoWrapper: {\n    minHeight: 250,\n    height: 250\n  },\n  dateCaption: {\n    padding: theme.spacing(1),\n    background: 'black',\n    color: 'white',\n    textAlign: 'center'\n  },\n  mobileStepper: {\n    // position: 'absolute',\n    // bottom: theme.spacing(1),\n    // right: theme.spacing(1)\n  },\n  manualBack: {\n    color: 'white',\n    zIndex: 10,\n    position: 'absolute',\n    transform: 'translateY(-50%)',\n    left: 0,\n    top: '50%'\n  },\n  manualForward: {\n    color: 'white',\n    zIndex: 10,\n    position: 'absolute',\n    transform: 'translateY(-50%)',\n    right: 0,\n    top: '50%'\n  },\n  tagButton: {\n    color: 'rgba(255, 255, 255, 0.54)'\n  },\n  slideshowButton: {\n    color: 'rgba(255, 255, 255, 0.54)'\n  },\n  dots: {\n    margin: '0 auto'\n  }\n})\n","export default theme => ({\n  root: {\n    display: 'flex',\n    height: '100%',\n    flexDirection: 'column',\n    overflow: 'hidden'\n  },\n  appBar: {\n    flexGrow: 0\n  },\n  inner: {\n    position: 'relative',\n    flexGrow: 1,\n    overflowY: 'scroll',\n    '-webkit-overflow-scrolling': 'touch'\n  },\n  tabMenu: {\n    marginTop: theme.spacing(7)\n  },\n  mapWrap: {\n    position: 'absolute',\n    height: '100%',\n    width: '100%',\n    top: 0,\n    left: 0\n  },\n  toolbarTitle: {\n    flexGrow: 1,\n    textOverflow: 'ellipsis',\n    whiteSpace: 'nowrap',\n    overflow: 'hidden'\n  },\n  AddFab: {\n    background: theme.palette.secondary.main,\n    color: theme.palette.secondary.contrastText\n  },\n  grow: {\n    flexGrow: 1\n  },\n  gridList: {\n    flexWrap: 'nowrap',\n    // Promote the list into his own layer on Chrome. This cost memory but helps keeping high FPS.\n    transform: 'translateZ(0)'\n  },\n  titleBar: {\n    display: 'flex',\n    padding: theme.spacing(1)\n  },\n  menuButton: {\n    // marginLeft: -12,\n    // marginRight: 20\n  }\n})\n","import React, { useState, useContext } from 'react'\nimport PropTypes from 'prop-types'\n\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport AppBar from '@material-ui/core/AppBar'\nimport Toolbar from '@material-ui/core/Toolbar'\nimport IconButton from '@material-ui/core/IconButton'\nimport Typography from '@material-ui/core/Typography'\nimport Tabs from '@material-ui/core/Tabs'\nimport Tab from '@material-ui/core/Tab'\n\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack'\n\nimport AddCameraIcon from '@material-ui/icons/AddAPhoto'\nimport MoreIcon from '@material-ui/icons/MoreVert'\n\nimport AddAlertIcon from '@material-ui/icons/AddAlert'\nimport SlideshowIcon from '@material-ui/icons/Slideshow'\nimport EditIcon from '@material-ui/icons/Edit'\nimport DeleteIcon from '@material-ui/icons/Delete'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport MapDot from '../../maps/MapDot'\nimport AddFab from './controls/AddFab'\n\nimport ContextMenu from './controls/ContextMenu'\n\nimport SeriesInfo from './subViews/SeriesInfo'\nimport SwipeShow from './subViews/SwipeShow'\nimport PhotoGrid from './subViews/PhotoGrid'\n\nimport DeleteDialog from './dialogs/DeleteDialog'\n\nimport { SeriesContext } from '../contexts'\n\nimport style from './SeriesView.style'\nconst useStyles = makeStyles(style)\n\nconst SeriesView = ({\n  onSlideshowStart, onChange,\n  onEditSeries, onDeletePhotos, onCameraAdd,\n  onDeleteSeries, onLibraryAdd, onTileClick, onMenuBack,\n  onWatch, onUnWatch, initialPhoto,\n  watching, owned\n}) => {\n  const classes = useStyles()\n  const [contextEl, setContextEl] = useState()\n  const [deleteConfirm, setDeleteConfirm] = useState(false)\n\n  const { series, seriesConfig, ac } = useContext(SeriesContext)\n\n  const onDeleteConfirm = (confirmation) => {\n    setDeleteConfirm(false)\n    if (confirmation === true) onDeleteSeries(series.id)\n  }\n\n  const viewport = { zoom: 16 }\n  if (series.coords && series.coords.length === 2) {\n    viewport.longitude = series.coords[0]\n    viewport.latitude = series.coords[1]\n  }\n\n  const can = {\n    update: ac.canUser('update', series, 'series', '*'),\n    delete: ac.canUser('delete', series, 'series', '*'),\n    contribute: ac.canUser('update', series, 'series', ['photos'])\n  }\n  // console.log('FINAL DEBUG', can)\n  const [listTypeTab, setListTypeTab] = useState(0)\n  return (\n    <div className={classes.root}>\n      <CssBaseline />\n      <AppBar position='static' className={classes.appBar}>\n        <Toolbar disableGutters>\n          <IconButton className={classes.menuButton} color='inherit' onClick={onMenuBack} aria-label='Menu'>\n            <ArrowBackIcon />\n          </IconButton>\n          <Typography variant='subtitle1' color='inherit' className={classes.toolbarTitle}>\n            {series.name || 'Series'}\n          </Typography>\n\n          <IconButton className={classes.menuButton} color='inherit' onClick={onSlideshowStart} aria-label='Menu'>\n            <SlideshowIcon />\n          </IconButton>\n          <IconButton\n            aria-haspopup='true'\n            color='inherit'\n            onClick={event => setContextEl(event.currentTarget)}\n          >\n            <MoreIcon />\n          </IconButton>\n\n          <ContextMenu anchorEl={contextEl} onClose={() => setContextEl(null)} menuItems={[\n            {\n              text: 'Watch Series',\n              icon: AddAlertIcon,\n              hide: !onWatch || owned || watching,\n              action: onWatch\n            },\n            {\n              text: 'Unwatch Series',\n              icon: AddAlertIcon,\n              hide: !onUnWatch || owned || !watching,\n              action: onUnWatch\n            },\n            // {\n            //   text: 'Start Slideshow',\n            //   icon: SlideshowIcon,\n            //   hide: !onSlideshowStart,\n            //   action: onSlideshowStart\n            // },\n            { divider: true },\n            {\n              text: 'Edit Series',\n              icon: EditIcon,\n              hide: !onEditSeries || !can.update,\n              action: onEditSeries\n            },\n            {\n              text: 'Delete Series',\n              icon: DeleteIcon,\n              hide: !setDeleteConfirm || !can.delete,\n              color: 'error',\n              action: () => setDeleteConfirm(true)\n            }\n          ]} />\n        </Toolbar>\n        <Tabs variant='fullWidth'\n          value={listTypeTab}\n          onChange={(e, value) => setListTypeTab(value)}\n        >\n          <Tab label='Info' />\n          <Tab label='Map' />\n          <Tab label='Photos' />\n        </Tabs>\n      </AppBar>\n\n      <div className={classes.inner}>\n        {listTypeTab === 0 && (\n          <React.Fragment>\n            {series.photos && series.photos.length > 0 && (\n              <SwipeShow\n                photos={series.photos}\n                initialPhoto={initialPhoto}\n                onImageSelect={onTileClick}\n              />\n            )}\n            <SeriesInfo series={series} seriesConfig={seriesConfig} onChange={onChange} />\n          </React.Fragment>\n        )}\n        {series.photos && listTypeTab === 2 && (\n          <PhotoGrid\n            photos={series.photos}\n            onTileClick={onTileClick}\n            onDelete={onDeletePhotos}\n          />\n        )}\n      </div>\n\n      {listTypeTab === 1 && (\n        <MapDot\n          longitude={series.longitude}\n          latitude={series.latitude}\n          viewport={viewport}\n          direction={series.direction}\n        />\n      )}\n      {listTypeTab === 0 && can.contribute && (\n        <AddFab\n          className={classes.AddFab}\n          onCameraClick={onCameraAdd}\n          onLibraryClick={onLibraryAdd}\n        >\n          <AddCameraIcon />\n        </AddFab>\n      )}\n\n      <DeleteDialog\n        open={deleteConfirm}\n        onConfirm={onDeleteConfirm}\n        title='Delete Series'\n        message='Are you sure you want to delete this series? The record and all images associated with it will be gone forever.'\n      />\n    </div>\n  )\n}\n\nSeriesView.propTypes = {\n  initialPhoto: PropTypes.string,\n  watching: PropTypes.bool,\n  owned: PropTypes.bool,\n  // Action functions\n  onSlideshowStart: PropTypes.func.isRequired,\n  onChange: PropTypes.func.isRequired,\n  onDeletePhotos: PropTypes.func.isRequired,\n  onDeleteSeries: PropTypes.func.isRequired,\n  onCameraAdd: PropTypes.func.isRequired,\n  onEditSeries: PropTypes.func.isRequired,\n  onLibraryAdd: PropTypes.func.isRequired,\n  onTileClick: PropTypes.func.isRequired,\n  onMenuBack: PropTypes.func.isRequired,\n  onWatch: PropTypes.func.isRequired,\n  onUnWatch: PropTypes.func.isRequired\n}\n\nexport default SeriesView\n","\nimport React, { useState, useContext } from 'react'\nimport PropTypes from 'prop-types'\n\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport DialogActions from '@material-ui/core/DialogActions'\nimport Button from '@material-ui/core/Button'\nimport Typography from '@material-ui/core/Typography'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport { SeriesContext } from '../contexts'\n\nimport style from './SeriesEdit.style'\nimport SeriesEditInner from './subViews/SeriesEditInner'\n\nconst useStyles = makeStyles(style)\n\nconst SeriesEdit = ({ onOk, onCancel }) => {\n  const classes = useStyles()\n  const { series } = useContext(SeriesContext)\n  const [delta, setDelta] = useState({})\n\n  return (\n    <Dialog\n      scroll='paper'\n      className={classes.root}\n      fullScreen\n      open\n      fullWidth\n      onClose={onCancel}\n    >\n      <CssBaseline />\n      <DialogTitle disableTypography className={classes.dlgTitle}>\n        <Typography variant='subtitle1' color='inherit' className={classes.grow}>\n           Edit Series Details\n        </Typography>\n      </DialogTitle>\n      <DialogContent className={classes.inner}>\n        <SeriesEditInner\n          series={series}\n          delta={delta}\n          onChange={setDelta}\n        />\n      </DialogContent>\n      <DialogActions>\n        <Button className={classes.menuButton} color='inherit' onClick={() => setDelta({})} aria-label='Menu'>\n            Reset\n        </Button>\n        <Button className={classes.menuButton} color='inherit' onClick={onCancel} aria-label='Menu'>\n            Cancel\n        </Button>\n        <Button className={classes.menuButton} color='inherit' onClick={() => onOk({ id: series.id, ...delta })} aria-label='Menu'>\n            Ok\n        </Button>\n      </DialogActions>\n    </Dialog>\n  )\n}\n\nSeriesEdit.propTypes = {\n  // now some functions\n  onOk: PropTypes.func.isRequired,\n  onCancel: PropTypes.func.isRequired\n}\n\nexport default SeriesEdit\n","export default theme => ({\n  root: {\n\n  },\n  inner: {\n    display: 'flex',\n    flexDirection: 'column'\n    // padding: theme.spacing(1)\n  },\n  dlgTitle: {\n    background: theme.palette.primary.main,\n    color: theme.palette.primary.contrastText\n  },\n  grow: {\n    flexGrow: 1\n  },\n  field: {\n    flexGrow: 0,\n    marginBottom: theme.spacing(2)\n  },\n  slider: {\n    paddingLeft: theme.spacing(1),\n    paddingRight: theme.spacing(1)\n  },\n  textField: {\n    marginLeft: theme.spacing(1),\n    marginRight: theme.spacing(1),\n    width: '100%'\n  },\n  formLabel: {\n    display: 'block',\n    marginTop: theme.spacing(1),\n    marginBottom: theme.spacing(1)\n  },\n  mapFormLabel: {\n    display: 'block',\n    marginTop: theme.spacing(1),\n    marginBottom: theme.spacing(1)\n  },\n  mapInnerWrap: {\n    flexGrow: 1\n  },\n  mapWrapper: {\n    flexGrow: 1,\n    display: 'flex',\n    flexDirection: 'column',\n    paddingBottom: theme.spacing(2)\n  },\n  formControl: {\n    margin: theme.spacing(1),\n    minWidth: 120\n  },\n  chips: {\n    display: 'flex',\n    flexWrap: 'wrap'\n  }\n})\n","import React, { useState, useEffect, useRef } from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\n\nimport Badge from '@material-ui/core/Badge'\nimport Typography from '@material-ui/core/Typography'\nimport IconButton from '@material-ui/core/IconButton'\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport GridListTile from '@material-ui/core/GridListTile'\nimport GridListTileBar from '@material-ui/core/GridListTileBar'\nimport MobileStepper from '@material-ui/core/MobileStepper'\nimport Button from '@material-ui/core/Button'\n\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack'\nimport LabelIcon from '@material-ui/icons/Label'\nimport PauseIcon from '@material-ui/icons/PauseCircleFilled'\nimport PlayIcon from '@material-ui/icons/PlayCircleFilled'\nimport KeyboardArrowLeft from '@material-ui/icons/KeyboardArrowLeft'\nimport KeyboardArrowRight from '@material-ui/icons/KeyboardArrowRight'\n\nimport { makeStyles, useTheme } from '@material-ui/core/styles'\n\nimport Photo from './subViews/Photo'\nimport { formatDate } from '../../../lib/datelib'\nimport useComponentSize from '../../../lib/useComponentSize'\n\nimport style from './Slideshow.style'\n\nconst useStyles = makeStyles(style)\n\nconst Slideshow = ({ onCancel, photos, transition }) => {\n  const classes = useStyles()\n  const theme = useTheme()\n  const { activeStep, lastStep, handleForward, handleBack, paused, pause, play } = useStepper(photos.length, transition)\n  const [showXYTags, setShowXYTags] = useState(false)\n\n  const refImgWrap = useRef(null)\n  const { size: { height, width } } = useComponentSize(refImgWrap)\n\n  return (\n    <div className={classes.root}>\n      <CssBaseline />\n      <div ref={refImgWrap} className={classes.slideContainer}>\n        {photos.map((slide, idx) => (\n          <GridListTile\n            key={`slide-${idx}`}\n            className={classNames(\n              classes.slide,\n              activeStep === idx && classes.active,\n              lastStep === idx && classes.last\n            )}\n            onClick={() => setShowXYTags(!showXYTags)}\n            style={{\n              height,\n              width,\n              transition: theme.transitions.create(['opacity'], { duration: 1 / 4 * transition })\n            }}\n          >\n            <Photo photo={slide} className={classes.photo} showTags={showXYTags} />\n            <Typography className={classes.labelBadge} >\n            Tags: {showXYTags ? 'On ' : 'Off '}\n              <Badge color='secondary' badgeContent={photos[activeStep].tags.filter(tag => tag.coords).length}>\n                <LabelIcon color='inherit' />\n              </Badge>\n            </Typography>\n\n            <GridListTileBar\n              titlePosition='top'\n              title={(\n                <Typography color='inherit' variant='caption'>\n                  <IconButton className={classes.iconButton} onClick={(e) => onCancel()}>\n                    <ArrowBackIcon />\n                  </IconButton>\n                  {formatDate(slide.takenOn)}\n                </Typography>\n              )}\n              subtitle={<em>{paused ? 'Paused' : '    '}</em>}\n              actionIcon={paused ? (\n                <IconButton className={classes.iconButton} onClick={(e) => {\n                  e.preventDefault()\n                  e.stopPropagation()\n                  play()\n                }}>\n                  <PlayIcon />\n                </IconButton>\n              ) : (\n                <IconButton className={classes.iconButton} onClick={(e) => {\n                  e.preventDefault()\n                  e.stopPropagation()\n                  pause()\n                }}>\n                  <PauseIcon />\n                </IconButton>\n              )}\n            />\n          </GridListTile>\n        ))}\n        <IconButton size='small' className={classes.manualBack} onClick={handleBack} color='inherit'>\n          {theme.direction === 'rtl' ? <KeyboardArrowRight /> : <KeyboardArrowLeft />}\n        </IconButton>\n        <IconButton size='small' className={classes.manualForward} onClick={handleForward} color='inherit'>\n          {theme.direction === 'rtl' ? <KeyboardArrowLeft /> : <KeyboardArrowRight />}\n        </IconButton>\n      </div>\n\n      <MobileStepper\n        steps={photos.length}\n        position='static'\n        activeStep={activeStep}\n        classes={{\n          root: classes.mobileStepper,\n          dotActive: classes.dotActive\n        }}\n        nextButton={\n          <Button color='inherit' size='small' onClick={handleForward} disabled={activeStep === photos.length - 1}>\n            Next\n            {theme.direction === 'rtl' ? <KeyboardArrowLeft /> : <KeyboardArrowRight />}\n          </Button>\n        }\n        backButton={\n          <Button color='inherit' size='small' onClick={handleBack} disabled={activeStep === 0}>\n            {theme.direction === 'rtl' ? <KeyboardArrowRight /> : <KeyboardArrowLeft />}\n            Back\n          </Button>\n        }\n      />\n    </div>\n  )\n}\n\nSlideshow.propTypes = {\n  // We might want to go full screen\n  isFullScreen: PropTypes.bool,\n  // This is just the basic shape of the photo object\n  photos: PropTypes.array,\n  transition: PropTypes.number,\n  onCancel: PropTypes.func.isRequired\n}\n\nSlideshow.defaultProps = {\n  transition: 5000,\n  isFullScreen: false,\n  slides: []\n}\n\nexport default Slideshow\n\n/**\n * Custom React Hook for all our timer handling\n */\nconst useStepper = (num, interval) => {\n  const [activeStep, setActiveStep] = useState(0)\n  const [paused, setPaused] = useState(false)\n  const [lastStep, setLastStep] = useState(0)\n  const timerRef = useRef()\n\n  const handleForward = () => {\n    setLastStep(activeStep)\n    if (activeStep + 1 >= num) setActiveStep(0)\n    else setActiveStep(activeStep + 1)\n    if (!paused) {\n      destroyTimer()\n      createTimer()\n    }\n  }\n  const handleBack = () => {\n    setLastStep(activeStep)\n    if (activeStep - 1 < 0) setActiveStep(num - 1)\n    else setActiveStep(activeStep - 1)\n    if (!paused) {\n      destroyTimer()\n      createTimer()\n    }\n  }\n\n  const pause = () => {\n    destroyTimer()\n    setPaused(true)\n  }\n  const play = () => {\n    setPaused(false)\n    destroyTimer()\n    createTimer()\n  }\n\n  const createTimer = () => {\n    timerRef.current = window.setInterval(\n      // We need to use the alternate notation for the useState function\n      // because setInterval will only have access to the activeStep it was\n      // initialized with\n      () => setActiveStep(oldStep => {\n        setLastStep(oldStep)\n        return (oldStep + 1 >= num) ? 0 : oldStep + 1\n      })\n      , interval\n    )\n  }\n  const destroyTimer = () => {\n    if (timerRef.current) window.clearInterval(timerRef.current)\n  }\n\n  useEffect(() => {\n    createTimer()\n    return () => {\n      destroyTimer()\n    }\n  }, []) // Pass in empty array to run useEffect only on mount.\n\n  return { activeStep, lastStep, handleForward, handleBack, setActiveStep, paused, pause, play }\n}\n","export default theme => ({\n  root: {\n    // maxWidth: 400,\n    height: '100%',\n    display: 'flex',\n    flexDirection: 'column'\n  },\n  swipeAble: {\n    height: '100%'\n  },\n  slideContainer: {\n    flexGrow: 1\n  },\n  mobileStepper: {\n    flexGrow: 0,\n    background: theme.palette.grey[800],\n    color: theme.palette.getContrastText(theme.palette.grey[800])\n  },\n  slide: {\n    top: 0,\n    zIndex: 0,\n    opacity: 0,\n    position: 'absolute',\n    display: 'block',\n    overflow: 'hidden',\n    width: '100%',\n    height: '100%',\n    minHeight: 300\n  },\n  dotActive: {\n    background: 'white'\n  },\n  iconButton: {\n    color: 'white'\n  },\n  active: {\n    zIndex: 5,\n    opacity: 1\n  },\n  last: {\n    opacity: 1,\n    zIndex: 4\n  },\n  tagContainer: {\n\n  },\n  labelBadge: {\n    color: 'white',\n    zIndex: 10,\n    position: 'absolute',\n    right: theme.spacing(2),\n    bottom: theme.spacing(1),\n    opacity: 0.8\n  },\n  tagChip: {\n    // height: theme.spacing(3),\n    marginRight: theme.spacing(1),\n    fontSize: 10,\n    height: theme.spacing(2),\n    padding: theme.spacing(0.5)\n  },\n  xyTagChip: {\n    position: 'absolute',\n    fontSize: theme.spacing(1),\n    height: theme.spacing(2)\n  },\n  manualBack: {\n    color: 'white',\n    zIndex: 10,\n    position: 'absolute',\n    transform: 'translateY(-50%)',\n    left: 0,\n    top: '50%'\n  },\n  manualForward: {\n    color: 'white',\n    zIndex: 10,\n    position: 'absolute',\n    transform: 'translateY(-50%)',\n    right: 0,\n    top: '50%'\n  }\n})\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport Button from '@material-ui/core/Button'\nimport Typography from '@material-ui/core/Typography'\nimport DialogActions from '@material-ui/core/DialogActions'\n\n// import MenuIcon from '@material-ui/icons/MenuIcon'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n\n})\n\nconst useStyles = makeStyles(style)\n\nconst CancelConfirm = ({ title, message, onConfirm, open }) => {\n  const classes = useStyles()\n  return (\n    <Dialog\n      className={classes.root}\n      disableBackdropClick\n      fullWidth\n      open={open}\n      disableEscapeKeyDown\n      maxWidth='xl'\n      aria-labelledby='confirmation-dialog-title'\n    >\n      <DialogTitle id='confirmation-dialog-title'>{title}</DialogTitle>\n      <DialogContent>\n        <Typography>\n          {message}\n        </Typography>\n\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={() => onConfirm(false)} color='primary'>\n      No\n        </Button>\n        <Button onClick={() => onConfirm(true)} color='secondary'>\n      Yes\n        </Button>\n      </DialogActions>\n    </Dialog>\n  )\n}\n\nCancelConfirm.propTypes = {\n  open: PropTypes.bool,\n  title: PropTypes.string.isRequired,\n  message: PropTypes.string.isRequired,\n  onConfirm: PropTypes.func.isRequired\n}\n\nexport default CancelConfirm\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\n\nimport Button from '@material-ui/core/Button'\nimport Dialog from '@material-ui/core/Dialog'\nimport IconButton from '@material-ui/core/IconButton'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport Typography from '@material-ui/core/Typography'\nimport DialogActions from '@material-ui/core/DialogActions'\n\nimport CloseIcon from '@material-ui/icons/Close'\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport CancelConfirm from '../dialogs/CancelConfirm'\n\nimport PhotoInfoInner from './PhotoInfoInner'\n\nconst style = theme => ({\n  root: {\n    height: '90%',\n    width: '85%'\n  },\n  dlgTitleContainer: {\n    display: 'flex',\n    padding: 0\n  },\n  dlgTitle: {\n    flexGrow: 1,\n    paddingTop: theme.spacing(2),\n    paddingBottom: theme.spacing(1),\n    paddingLeft: theme.spacing(3)\n  },\n  field: {\n    marginBottom: theme.spacing(2)\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst DIALOGS = {\n  NOTEEDIT: 'noteEdit',\n  NOTEVIEW: 'noteView',\n  PHOTOTAKEN: 'taken',\n  TAGEDIT: 'tag',\n  CANCEL: 'cancel'\n}\n\nconst PhotoInfo = ({ canEdit, photo, onCancel, onOk, open }) => {\n  const classes = useStyles()\n  const [activeDialog, setActiveDialog] = useState(null)\n  const [delta, setDelta] = useState({})\n\n  const dirty = delta && Object.keys(delta).length > 0\n\n  return (\n    <Dialog\n      fullScreen\n      fullWidth\n      onClose={() => {\n        if (dirty) setActiveDialog(DIALOGS.CANCEL)\n        else onCancel()\n      }}\n      aria-labelledby='customized-dialog-title'\n      open={open}\n    >\n      <DialogTitle disableTypography className={classes.dlgTitleContainer}>\n        <Typography variant='h5' className={classes.dlgTitle}>\n          Photo Properties\n        </Typography>\n        <IconButton onClick={onCancel}>\n          <CloseIcon />\n        </IconButton>\n      </DialogTitle>\n      <DialogContent>\n        <PhotoInfoInner\n          photo={photo}\n          delta={delta}\n          onChange={newDelta => setDelta({ ...delta, ...newDelta })}\n          canEdit={canEdit}\n        />\n      </DialogContent>\n\n      <DialogActions>\n        {!canEdit && (\n          <Button onClick={onCancel} color='primary'>\n            Ok\n          </Button>\n        )}\n        {canEdit && !dirty && (\n          <Button onClick={onCancel} color='primary'>\n            Back\n          </Button>\n        )}\n        {canEdit && dirty && (\n          <React.Fragment>\n            <Button onClick={() => setActiveDialog(DIALOGS.CANCEL)} color='primary'>\n              Cancel\n            </Button>\n            <Button onClick={() => setDelta({})} color='primary'>\n              Reset\n            </Button>\n            <Button onClick={() => onOk(delta)} color='primary'>\n              Ok\n            </Button>\n          </React.Fragment>\n        )}\n      </DialogActions>\n      {activeDialog && activeDialog === DIALOGS.CANCEL && (\n        <CancelConfirm\n          open\n          title='Lose unsaved changes?'\n          message='You will lose any changes you made to this form'\n          onConfirm={confirm => {\n            setActiveDialog(null)\n            if (confirm) onCancel()\n          }}\n        />\n      )}\n    </Dialog>\n  )\n}\n\nPhotoInfo.propTypes = {\n  canEdit: PropTypes.bool,\n  onCancel: PropTypes.func.isRequired,\n  onOk: PropTypes.func.isRequired,\n  open: PropTypes.bool,\n  photo: PropTypes.object.isRequired\n}\n\nexport default PhotoInfo\n","import React, { useState, useContext } from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\n\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport Button from '@material-ui/core/Button'\nimport MobileStepper from '@material-ui/core/MobileStepper'\nimport Typography from '@material-ui/core/Typography'\nimport AppBar from '@material-ui/core/AppBar'\nimport Toolbar from '@material-ui/core/Toolbar'\nimport IconButton from '@material-ui/core/IconButton'\nimport Badge from '@material-ui/core/Badge'\nimport Chip from '@material-ui/core/Chip'\n\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack'\nimport InfoIcon from '@material-ui/icons/Info'\nimport LabelIcon from '@material-ui/icons/Label'\n\nimport { makeStyles, useTheme } from '@material-ui/core/styles'\n\nimport PhotoInfo from './subViews/PhotoInfo'\nimport Photo from './subViews/Photo'\n\nimport { formatDate } from '../../../lib/datelib'\nimport Tags from '../../../lib/Tags'\nimport SwipeableViews from 'react-swipeable-views'\nimport { SeriesContext } from '../contexts'\n\nimport style from './PhotoViewTool.style'\nconst useStyles = makeStyles(style)\n\nconst STATES = {\n  VIEWPIC: 0,\n  SHOWINFO: 1,\n  SHOWTAGS: 2,\n  EDITTAGS: 3,\n  FIRSTAGEDIT: 4\n}\n\nconst PhotoViewTool = ({ photos, initPhotoId, onMenuBack, onUpdatePhoto, newPhoto }) => {\n  const classes = useStyles()\n  const theme = useTheme()\n  const { series, seriesConfig, ac } = useContext(SeriesContext)\n  const [activePhoto, setActivePhoto] = useState(initPhotoId ? photos.findIndex(p => p.id === initPhotoId) : 0)\n  // This is a special copy of the photo so we can play around with the XY tags and undo\n  // if we need to\n  const photo = photos[activePhoto]\n  const [delta, setDelta] = useState(newPhoto ? photo : {})\n  const [mode, setMode] = useState({\n    current: newPhoto ? STATES.FIRSTAGEDIT : STATES.VIEWPIC,\n    last: null\n  })\n\n  const tagsClass = new Tags(seriesConfig, delta.tags || photo.tags)\n\n  const changeMode = (desired) => {\n    setMode({ current: desired, last: mode.current })\n  }\n\n  const onCommitTags = () => {\n    changeMode(STATES.SHOWTAGS)\n    onUpdatePhoto(photo, { id: photo.id, ...delta })\n  }\n\n  const onCommitTagsFirst = () => {\n    onUpdatePhoto(photo, { id: photo.id, ...delta })\n    onMenuBack()\n  }\n\n  const onCancelTagEdit = () => {\n    changeMode(STATES.SHOWTAGS)\n    setDelta(photo)\n  }\n\n  const photoClick = (e) => {\n    if (mode.current === STATES.VIEWPIC) {\n      e.preventDefault()\n      e.stopPropagation()\n      changeMode(STATES.SHOWINFO)\n    }\n  }\n\n  const can = {\n    update: ac.canUser('update', series, 'series') ||\n            ac.canUser('update', photo, 'photo')\n  }\n\n  const sortedPhotos = [...photos]\n  sortedPhotos.sort((a, b) => parseInt(b.takenOn, 10) - parseInt(a.takenOn, 10))\n\n  return (\n    <div className={classes.root}>\n      <CssBaseline /> {/* You only need this in a root element. Don't put it anywhere else in the dom */}\n      <AppBar position='static' className={classNames(classes.appBar, mode.current !== STATES.VIEWPIC ? classes.appBarEdit : null)}>\n        <Toolbar>\n          {mode.current !== STATES.FIRSTAGEDIT && (\n            <IconButton\n              className={classes.menuButton}\n              color='inherit'\n              aria-label='Menu'\n              onClick={() => onMenuBack()}\n            >\n              <ArrowBackIcon />\n            </IconButton>\n          )}\n          <div className={classes.grow}>\n            <Typography variant='subtitle2' color='inherit' >\n              {newPhoto ? 'Add Tags' : `Photo View (${activePhoto + 1}/${photos.length})`}\n            </Typography>\n            <Typography variant='subtitle2' color='inherit'>\n              {formatDate(photo.takenOn, 'lll')}\n            </Typography>\n          </div>\n\n          { mode.current === STATES.EDITTAGS &&\n          <Button color='inherit' onClick={onCancelTagEdit}>\n            Cancel\n          </Button>\n          }\n\n          { mode.current === STATES.EDITTAGS &&\n          <Button color='inherit' onClick={onCommitTags}>\n            Save\n          </Button>\n          }\n          { mode.current === STATES.FIRSTAGEDIT &&\n          <Button color='inherit' onClick={onCommitTagsFirst}>\n            Next\n          </Button>\n          }\n\n          { can.update && mode.current === STATES.SHOWTAGS &&\n          <Button color='inherit' onClick={() => changeMode(STATES.EDITTAGS)}>\n            Edit\n          </Button>\n          }\n\n          { (mode.current !== STATES.EDITTAGS && mode.current !== STATES.FIRSTAGEDIT) &&\n          <IconButton color='inherit'\n            className={classNames(classes.tagButton, mode.current === STATES.SHOWTAGS && classes.activeButton)}\n            onClick={() => changeMode(mode.current === STATES.SHOWTAGS ? STATES.VIEWPIC : STATES.SHOWTAGS)}\n          >\n            <Badge className={classes.margin} badgeContent={tagsClass.getXYTags().length} color='primary'>\n              <LabelIcon />\n            </Badge>\n          </IconButton>\n          }\n\n          { (mode.current !== STATES.EDITTAGS && mode.current !== STATES.FIRSTAGEDIT) &&\n          <IconButton color='inherit'\n            className={classNames(classes.infoButton, mode.current === STATES.SHOWINFO && classes.activeButton)}\n            onClick={() => changeMode(mode.current === STATES.SHOWINFO ? STATES.VIEWPIC : STATES.SHOWINFO)}\n          >\n            <InfoIcon />\n          </IconButton>\n          }\n\n        </Toolbar>\n      </AppBar>\n      <div className={classes.inner} onClick={photoClick}>\n        <SwipeableViews\n          axis={theme.direction === 'rtl' ? 'x-reverse' : 'x'}\n          index={activePhoto}\n          containerStyle={{ height: '100%' }}\n          style={{ height: '100%' }}\n          disabled={mode.current !== STATES.VIEWPIC}\n          onChangeIndex={(val) => setActivePhoto(val)}\n          enableMouseEvents\n        >\n          {sortedPhotos.map((photoidx, idx) => (\n            <div className={classes.photoWrapper} key={`swipeshowpic-${idx}`}>\n              <Photo\n                showTags={mode.current === STATES.SHOWTAGS}\n                photo={{ ...photoidx, ...delta }}\n                edit={can.update && (mode.current === STATES.EDITTAGS || mode.current === STATES.FIRSTAGEDIT)}\n                onChange={setDelta}\n                onCommitTags={onCommitTags}\n              />\n            </div>\n          ))}\n        </SwipeableViews>\n\n        {mode.current === STATES.VIEWPIC && (\n          <MobileStepper\n            steps={sortedPhotos.length}\n            position='bottom'\n            activeStep={activePhoto}\n            classes={{\n              root: classes.mobileStepper,\n              dots: classes.dots,\n              dot: classes.dot,\n              dotActive: classes.dotActive\n            }}\n          />\n        )}\n      </div>\n      <PhotoInfo\n        open={mode.current === STATES.SHOWINFO}\n        photo={photo}\n        canEdit={can.update}\n        onOk={(newDelta) => {\n          onUpdatePhoto(photo, { id: photo.id, ...newDelta })\n          changeMode(mode.last)\n        }}\n        onCancel={() => changeMode(mode.last)}\n      />\n      { (mode.current === STATES.EDITTAGS || mode.current === STATES.FIRSTAGEDIT) && (\n        <Chip\n          label='Tap to tag features...'\n          onClick={() => {}}\n          className={classes.tipChip}\n        />\n      )}\n    </div>\n  )\n}\n\nPhotoViewTool.propTypes = {\n  photos: PropTypes.array.isRequired,\n  initPhotoId: PropTypes.string,\n  newPhoto: PropTypes.bool,\n  // Now some action functions\n  onMenuBack: PropTypes.func.isRequired,\n  onUpdatePhoto: PropTypes.func.isRequired\n}\n\nexport default PhotoViewTool\n","export default theme => ({\n  root: {\n    display: 'flex',\n    height: '100%',\n    flexDirection: 'column',\n    overflow: 'hidden'\n  },\n  appBar: {\n    flexGrow: 0\n  },\n  appBarEdit: {\n    color: theme.palette.secondary.contrastText,\n    background: theme.palette.secondary.main\n  },\n  grow: {\n    flexGrow: 1\n  },\n  photoWrapper: {\n    height: '100%'\n  },\n  inner: {\n    flex: '1 1',\n    position: 'relative'\n  },\n  tabMenu: {\n    marginTop: theme.spacing(7)\n  },\n  tipChip: {\n    position: 'absolute',\n    zIndex: 11,\n    bottom: 20,\n    left: '50%',\n    opacity: 0.6,\n    transform: 'translateX(-50%)'\n  },\n  mobileStepper: {\n    background: 'none'\n  },\n  dots: {\n    margin: '0 auto'\n  },\n  dot: {\n    border: '1px solid #FFFFFF77'\n  },\n  dotActive: {\n    background: theme.palette.secondary.main\n  },\n  // tagButton: {\n  //   zIndex: 10,\n  //   color: 'white',\n  //   position: 'absolute',\n  //   fontSize: '2.5rem',\n  //   top: 10,\n  //   left: 10,\n  //   opacity: 0.8\n  // },\n  // infoButton: {\n  //   zIndex: 10,\n  //   color: 'white',\n  //   position: 'absolute',\n  //   top: 10,\n  //   right: 10,\n  //   opacity: 0.8\n  // },\n  activeButton: {\n    color: theme.palette.secondary.main,\n    opacity: 1\n  }\n})\n","import AccessControl from 'accesscontrol'\n\nclass AccessHelper {\n  constructor (userSub, role, permissionObj) {\n    this.userSub = userSub\n    this.role = role\n    this.permissionObj = permissionObj\n    this.ac = new AccessControl(permissionObj)\n  }\n\n  // Return the string 'Own' or the string 'Any'\n  ownOrAny = (obj) => {\n    if (!obj || !obj.createdUser || !obj.createdUser.id) throw new Error(`No Created user found`)\n    try {\n      return obj.createdUser.id === this.userSub ? 'Own' : 'Any'\n    }\n    catch (e) {\n      return 'Any'\n    }\n  }\n\n  isOwner = (obj) => {\n    if (!obj || !obj.createdUser || !obj.createdUser.id) throw new Error(`No Created user found`)\n    try {\n      return obj.createdUser.id === this.userSub\n    }\n    catch (e) {\n      return false\n    }\n  }\n\n  toString () {\n    console.log('AccessHelper:', { sub: this.userSub, role: this.role })\n  }\n\n  canUser = (action, obj, type, attrs) => {\n    if (['series', 'photo'].indexOf(type) < 0) throw new Error(`canUser: type not supported ${type}`)\n\n    try {\n      const ownAny = this.ownOrAny(obj)\n\n      const perm = this.ac.can(this.role)[`${action}${ownAny}`](type)\n      let otherPerm = null\n      if (type === 'series') {\n        if (obj.access === 'PUBLIC') otherPerm = this.ac.can(this.role)[`${action}${ownAny}`]('series_public')\n        else if (obj.access === 'OPEN') otherPerm = this.ac.can(this.role)[`${action}${ownAny}`]('series_open')\n      }\n\n      // Trying to recreate the form `can(role).readAny`\n      if (attrs) {\n        if (otherPerm) {\n          return !!perm.attributes.find(p => p === '*' || attrs.indexOf(p) > -1) ||\n           !!otherPerm.attributes.find(p => p === '*' || attrs.indexOf(p) > -1)\n        }\n        else return !!perm.attributes.find(p => p === '*' || attrs.indexOf(p) > -1)\n      }\n      else {\n        if (otherPerm) return perm.granted || otherPerm.granted\n        else return perm.granted\n      }\n    }\n    catch (e) {\n      console.error(e)\n      return false\n    }\n  }\n}\n\nexport default AccessHelper\n","import React, { useState, useContext } from 'react'\nimport PropTypes from 'prop-types'\n\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport AppBar from '@material-ui/core/AppBar'\nimport Toolbar from '@material-ui/core/Toolbar'\nimport IconButton from '@material-ui/core/IconButton'\nimport Typography from '@material-ui/core/Typography'\n\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport style from './SeriesView.style'\nconst useStyles = makeStyles(style)\n\nconst SeriesNotFound = ({ onMenuBack }) => {\n  const classes = useStyles()\n\n  return (\n    <div className={classes.root}>\n      <CssBaseline />\n      <AppBar position='static' className={classes.appBar}>\n        <Toolbar disableGutters>\n          <IconButton className={classes.menuButton} color='inherit' onClick={onMenuBack} aria-label='Menu'>\n            <ArrowBackIcon />\n          </IconButton>\n          <Typography variant='subtitle1' color='inherit' className={classes.toolbarTitle}>\n            'Not Found'\n          </Typography>\n        </Toolbar>\n      </AppBar>\n\n      <div className={classes.inner}>\n        <Typography className={classes.notFound}>Series Not Found</Typography>\n      </div>\n    </div>\n  )\n}\n\nSeriesNotFound.propTypes = {\n  // Action functions\n  onMenuBack: PropTypes.func.isRequired\n}\n\nexport default SeriesNotFound\n","import React, { useState, useEffect } from 'react'\nimport PropTypes from 'prop-types'\n\nimport SeriesView from './views/SeriesView'\nimport SeriesEdit from './views/SeriesEdit'\nimport Slideshow from './views/Slideshow'\nimport PhotoViewTool from './views/PhotoViewTool'\nimport NewPhoto from './views/NewPhoto'\n\nimport AccesHelper from '../../lib/AccessHelper'\n\nimport { SeriesContext } from './contexts'\nimport SeriesNotFound from './views/SeriesNotFound'\n\nexport const MODES = {\n  SERIES_VIEW: 'series',\n  SERIES_EDIT: 'editseries',\n  NEWPHOTO: 'newphoto',\n  NEWSERIES: 'newseries',\n  REVIEW: 'review',\n  PHOTO_VIEW: 'photoviewer',\n  PHOTO_VIEW_NEW: 'newphotoviewer',\n  SLIDESHOW: 'slideshow'\n}\nconst VIEW_ONLY_MODES = [MODES.SERIES_VIEW, MODES.PHOTO_VIEW, MODES.SLIDESHOW]\nconst VALID_STARTMODES = [MODES.SERIES_VIEW, MODES.NEWPHOTO, MODES.NEWSERIES, MODES.PHOTO_REVIEW, MODES.PHOTO_VIEW]\n\n/**\n * This component ties all the Repeat Photo components together\n */\nconst RepeatablePhotos = ({\n  modeName, series, seriesConfig, inputMethod: inputMethodINIT,\n  currentUserId, currentUserRole, accessControl, initialPhoto,\n  onChange, onClose, onDelete, onNewSeries, onChangePhoto,\n  onNewPhoto, onDeletePhoto,\n  onWatch, onUnWatch, watching, owned\n}) => {\n  // Manage view modes separately\n  // This is a pretty normal pattern for context\n  const [state, setState] = useState({\n    series,\n    seriesConfig,\n    ac: accessControl ? new AccesHelper(currentUserId, currentUserRole, accessControl) : null\n  })\n  const [mode, setMode] = useState({\n    current: {\n      name: modeName || MODES.SERIES_VIEW,\n      pid: initialPhoto,\n      inputMethod: inputMethodINIT\n    },\n    history: []\n  })\n  // console.log('RepeatablePhotos', state)\n\n  useEffect(() => setState({ ...state, series }), [series])\n\n  // When anything changes about a photo\n  const onUpdatePhoto = (photo, photoDelta) => {\n    const newSeries = { ...state.series }\n    newSeries.photos = newSeries.photos.map(ph => ph.id === photoDelta.id ? { ...ph, ...photoDelta } : ph)\n    onChangePhoto(photo, { ...photoDelta, seriesId: newSeries.id })\n  }\n\n  const onApprovePhoto = async ({ photo: photoDelta, series: seriesDelta }) => {\n    const newSeries = {\n      ...series,\n      photos: [...series.photos, photoDelta]\n    }\n    await onNewPhoto(photoDelta)\n    // THIS SEEMS A LITTLE HACKY BUT GO WITH IT FOR NOW\n    setState({ ...state, series: newSeries })\n    changeMode(MODES.PHOTO_VIEW_NEW, photoDelta.id)\n  }\n\n  const onCreateSeries = async ({ photo: photoDelta, series: seriesDelta }) => {\n    console.log('RepeatablePhotos: waiting for series ID', { seriesDelta, photoDelta })\n    const onNewSeriesReturn = await onNewSeries(seriesDelta, photoDelta)\n    console.log('RepeatablePhotos: waiting for series ID DONE', onNewSeriesReturn)\n  }\n\n  // When a photo is removed\n  const onDeletePhotos = (photoIdArr) => {\n    series.photos.filter(sp => photoIdArr.indexOf(sp.id) > -1).forEach(p => onDeletePhoto(p))\n  }\n\n  // Here's our modeChanger. My guess it will get a lot more complicated\n  // once the reducers get in and working\n  const changeMode = (newModeName, newPid, newInputMethod) => {\n    const canUpdate = state.ac.canUser('update', series, 'series')\n    if (state === null) onClose()\n    if (!canUpdate && VIEW_ONLY_MODES.indexOf(newModeName) < 0) {\n      console.error('ILLEGAL MODE CHANGE!!!!!', { from: mode.current, to: newModeName, canUpdate })\n    }\n    else {\n      // console.log('CHANGING MODE TO', newModeName)\n      setMode({\n        current: {\n          name: newModeName,\n          pid: newPid,\n          inputMethod: newInputMethod\n        },\n        history: [...mode.history, mode.current]\n      })\n    }\n  }\n  const lastMode = () => {\n    // console.log('REPEATABLEPHOTOS lastMode', mode)\n    if (mode.history.length > 0) {\n      const oldHistory = [...mode.history]\n      const oldMode = oldHistory.pop()\n      setMode({\n        current: oldMode,\n        history: oldHistory\n      })\n    }\n    else {\n      onClose()\n    }\n  }\n\n  // The action to initiate the photo viewer\n  const viewPhoto = (pid) => {\n    // console.log('DEBUG', mode, series.photos.find(p => p.id === pid))\n    changeMode(MODES.PHOTO_VIEW, pid)\n  }\n\n  let component = null\n\n  if (!series) return <SeriesNotFound onMenuBack={onClose} />\n\n  switch (mode.current.name) {\n    case MODES.SERIES_VIEW:\n      component = (\n        <SeriesView\n          // This one has lots of functionsgit add\n          onSlideshowStart={() => changeMode(MODES.SLIDESHOW)}\n          onChange={() => {\n            console.log('onChange NOT IMPLEMENTED')\n          }}\n          watching={watching}\n          owned={owned}\n          initialPhoto={initialPhoto}\n          onDeletePhotos={onDeletePhotos}\n          onDeleteSeries={onDelete}\n          onCameraAdd={() => changeMode(MODES.NEWPHOTO, null, 'camera')}\n          onEditSeries={() => changeMode(MODES.SERIES_EDIT)}\n          onLibraryAdd={() => changeMode(MODES.NEWPHOTO, null, 'library')}\n          onTileClick={viewPhoto}\n          onMenuBack={onClose}\n          onWatch={onWatch}\n          onUnWatch={onUnWatch}\n        />\n      )\n      break\n    case MODES.SERIES_EDIT:\n      component = (\n        <SeriesEdit\n          onCancel={() => changeMode(MODES.SERIES_VIEW)}\n          onOk={(seriesDelta) => {\n            onChange(series, { ...seriesDelta, id: series.id })\n            changeMode(MODES.SERIES_VIEW)\n          }}\n        />\n      )\n      break\n    case MODES.PHOTO_VIEW:\n      component = (\n        <PhotoViewTool\n          photos={state.series.photos}\n          initPhotoId={mode.current.pid}\n          onMenuBack={lastMode}\n          onUpdatePhoto={onUpdatePhoto}\n        />\n      )\n      break\n    case MODES.PHOTO_VIEW_NEW:\n      component = (\n        <PhotoViewTool\n          photos={state.series.photos}\n          initPhotoId={mode.current.pid}\n          newPhoto\n          onMenuBack={() => changeMode(MODES.SERIES_VIEW)}\n          onUpdatePhoto={onUpdatePhoto}\n        />\n      )\n      break\n    case MODES.SLIDESHOW:\n      component = (\n        <Slideshow photos={state.series.photos} onCancel={lastMode} />\n      )\n      break\n    case MODES.NEWPHOTO:\n      component = (\n        <NewPhoto\n          inputMethod={mode.current.inputMethod}\n          photos={series ? series.photos : null}\n          onCreate={onApprovePhoto}\n          onCancel={lastMode}\n        />\n      )\n      break\n    case MODES.NEWSERIES:\n      component = (\n        <NewPhoto\n          inputMethod={mode.current.inputMethod}\n          isNewSeries\n          onCreate={onCreateSeries}\n          onCancel={lastMode}\n        />\n      )\n      break\n    default:\n      console.log('REPEATABLEPHOTO: default state. you should NEVER see this', state)\n      component = null\n  }\n\n  return (\n    <SeriesContext.Provider value={state}>\n      {component}\n    </SeriesContext.Provider>\n  )\n}\n\nRepeatablePhotos.propTypes = {\n  modeName: PropTypes.oneOf(VALID_STARTMODES),\n  seriesConfig: PropTypes.object.isRequired,\n  watching: PropTypes.bool,\n  owned: PropTypes.bool,\n\n  currentUserId: PropTypes.string,\n  currentUserRole: PropTypes.string,\n  accessControl: PropTypes.object,\n\n  inputMethod: PropTypes.oneOf(['camera', 'library']),\n  series: PropTypes.object,\n  initialPhoto: PropTypes.string,\n\n  // Now some functions to handle actions we might take\n  onChange: PropTypes.func.isRequired,\n  onChangePhoto: PropTypes.func.isRequired,\n  onDeletePhoto: PropTypes.func.isRequired,\n  onNewPhoto: PropTypes.func.isRequired,\n  onNewSeries: PropTypes.func.isRequired,\n  onDelete: PropTypes.func.isRequired,\n  onClose: PropTypes.func.isRequired,\n  onWatch: PropTypes.func.isRequired,\n  onUnWatch: PropTypes.func.isRequired\n\n}\nRepeatablePhotos.defaultProps = {\n  mode: MODES.SERIES_VIEW\n}\n\nexport default RepeatablePhotos\n","import { openDb } from 'idb'\nimport { localDb } from '../config'\nimport uuidv4 from 'uuid/v4'\n\n/**\n * This is a leftover from the original, static RepeatablePhotos app.\n * For now it's just a decent way of storing the image data\n */\nconst dbPromise = openDb('serieslistDB', 1, upgradeDB => {\n  console.log('UPGRADE NEEDED', upgradeDB)\n  const store = upgradeDB.createObjectStore(localDb.imgStore)\n  console.log('UPGRADE NEEDED STORE', store)\n}).catch(e => {\n  console.error('ERROR', e)\n})\n\nexport const localUUID = (prefix) => {\n  return `__LOCAL_${prefix}::${uuidv4()}`\n}\n\nexport async function get (key) {\n  const db = await dbPromise\n  return db.transaction(localDb.imgStore).objectStore(localDb.imgStore).get(key)\n}\nexport async function getAll () {\n  const db = await dbPromise\n  return db.transaction(localDb.imgStore).objectStore(localDb.imgStore).getAll()\n}\nexport async function getOne () {\n  const db = await dbPromise\n  return db.transaction(localDb.imgStore).objectStore(localDb.imgStore).getAll(null, 1)\n}\nexport async function setEntry (key, val) {\n  const db = await dbPromise\n  const tx = db.transaction(localDb.imgStore, 'readwrite')\n  tx.objectStore(localDb.imgStore).put(val, key)\n  return tx.complete\n}\nexport async function deleteEntry (key) {\n  const db = await dbPromise\n  const tx = db.transaction(localDb.imgStore, 'readwrite')\n  tx.objectStore(localDb.imgStore).delete(key)\n  return tx.complete\n}\nexport async function clear () {\n  const db = await dbPromise\n  const tx = db.transaction(localDb.imgStore, 'readwrite')\n  tx.objectStore(localDb.imgStore).clear()\n  return tx.complete\n}\nexport async function keys () {\n  const db = await dbPromise\n  return db.transaction(localDb.imgStore).objectStore(localDb.imgStore).getAllKeys()\n}\n","import React, { useContext } from 'react'\nimport PropTypes from 'prop-types'\nimport { home } from '../config'\nimport permissions from '../permissions'\nimport { graphql, compose } from 'react-apollo'\nimport { connect } from 'react-redux'\nimport actions from '../redux/actions'\nimport Loading from '../components/auth/Loading'\nimport { getWholeSeries, allSeries } from './queries'\nimport { deletePhoto, deleteSeries, updateSeries, createPhoto, createSeries, updatePhoto, watchSeries, unWatchSeries } from './mutations'\nimport RepeatablePhotos, { MODES } from '../components/PhotoSeries'\nimport { localUUID, get, setEntry } from '../lib/localdb'\nimport { AppContext } from '../contexts'\n\nconst SeriesConnect = ({\n  series, loading, domain, activeSeries, initialPhoto,\n  onAfterSeriesDelete, onBack, queueUpload, doneCreatingSeries,\n  createSeriesMutation, createPhotoMutation,\n  updateSeriesMutation, updatePhotoMutation,\n  deleteSeriesMutation, deletePhotoMutation,\n  watchSeriesMutation, unWatchSeriesMutation\n}) => {\n  const { role, currentUser, seriesConfig, user, signedIn } = useContext(AppContext)\n  let inputMethod = 'camera'\n  // Hack until we can get good loading object sorted\n  if (domain === home.AppStateTypes.SERIES) {\n    // if (!series && !loading) return 'No series...'\n    if (loading) return <Loading />\n  }\n  else {\n    if (domain === home.AppStateTypes.NEW_SERIES_CAMERA) inputMethod = 'camera'\n    else if (domain === home.AppStateTypes.NEW_SERIES_LIBRARY) inputMethod = 'library'\n  }\n\n  // console.log('SeriesConnect', { series, loading, currentState, activeSeries, role, currentUser })\n  let modeName = MODES.SERIES_VIEW\n  if (domain !== home.AppStateTypes.SERIES) modeName = MODES.NEWSERIES\n\n  return <RepeatablePhotos\n    modeName={modeName}\n    inputMethod={inputMethod}\n\n    owned={signedIn && user && series && user.id === series.id}\n    watching={signedIn && user && user.watching && user.watching.indexOf(activeSeries) > -1}\n\n    // Everything we need to determine access\n    currentUserId={currentUser.attributes.sub}\n    currentUserRole={role}\n    accessControl={permissions}\n\n    series={series}\n    initialPhoto={initialPhoto}\n    seriesConfig={seriesConfig}\n    // Now some functions to handle actions we might take\n    onNewPhoto={({ base64, ...newPhoto }) => {\n      console.log('onNewPhoto', { base64, ...newPhoto })\n      const ext = base64.split(';')[0].split('/')[1]\n      return createPhotoMutation(newPhoto, ext)\n        .then(({ data }) => {\n          // Don't start an upload until you get back a proper id\n          if (data.createPhoto.preAuth) {\n            const preAuth = JSON.parse(data.createPhoto.preAuth)\n            console.log('PREAUTH', data.createPhoto.preAuth)\n            queueUpload({\n              id: newPhoto.id,\n              seriesId: data.createPhoto.seriesId,\n              base64,\n              preAuth\n            })\n          }\n          return data\n        })\n        .catch(err => {\n          console.log('onNewPhoto Graphql Error', err.stack)\n          console.error(err)\n        })\n    }}\n    onChangePhoto={(photo, photoDelta) => updatePhotoMutation(photo, photoDelta)\n      .catch(err => {\n        console.log('onChangePhoto Graphql Error', err.stack)\n        console.error(err)\n      })\n    }\n    onDeletePhoto={(photo) => deletePhotoMutation(photo.id)\n      .then((...data) => {\n        console.log('photo deleted', data)\n      })\n      .catch(err => {\n        console.log('onDeletePhoto Graphql Error', err.stack)\n        console.error(err)\n      })\n    }\n    onChange={(series, seriesDelta) => updateSeriesMutation(series, seriesDelta)\n      .catch(err => {\n        console.log('onChange Graphql Error', err.stack)\n        console.error(err)\n      })\n    }\n    onNewSeries={(newSeries, photoNoId) => {\n      console.log('Series.connect: onNewSeries starting', newSeries)\n      return createSeriesMutation(newSeries)\n        .then(async ({ data }) => {\n          const { base64, ...newPhoto } = photoNoId\n          const ext = base64.split(';')[0].split('/')[1]\n          console.log('Series.connect: done createSeriesMutation', data)\n          const { data: photoData } = await createPhotoMutation({ ...photoNoId, seriesId: data.createSeries.id }, ext)\n\n          const preAuth = JSON.parse(photoData.createPhoto.preAuth)\n          console.log('PREAUTH', photoData.createPhoto.preAuth)\n          queueUpload({\n            id: newPhoto.id,\n            seriesId: photoData.createPhoto.seriesId,\n            base64,\n            preAuth\n          })\n          doneCreatingSeries(data.createSeries.id)\n          return data\n        })\n        .catch(err => {\n          console.log('onNewSeries Graphql Error', err.stack)\n          console.error(err)\n        })\n    }}\n    onDelete={() => deleteSeriesMutation()\n      .then(onAfterSeriesDelete)\n      .catch(err => {\n        console.log('onDelete Graphql Error', err.stack)\n        console.error(err)\n      })\n    }\n    onClose={onBack}\n    onWatch={signedIn ? watchSeriesMutation : null}\n    onUnWatch={signedIn ? unWatchSeriesMutation : null}\n  />\n}\nSeriesConnect.propTypes = {\n  domain: PropTypes.string,\n  activeSeries: PropTypes.string,\n  initialPhoto: PropTypes.string,\n\n  // From Redux\n  onAfterSeriesDelete: PropTypes.func,\n  doneCreatingSeries: PropTypes.func,\n  queueUpload: PropTypes.func,\n  onBack: PropTypes.func,\n\n  // Data from apollo\n  series: PropTypes.object,\n\n  // Functions From Apollo\n  loading: PropTypes.bool,\n  updateSeriesMutation: PropTypes.func,\n  updatePhotoMutation: PropTypes.func,\n  deleteSeriesMutation: PropTypes.func,\n  deletePhotoMutation: PropTypes.func,\n  createSeriesMutation: PropTypes.func,\n  createPhotoMutation: PropTypes.func,\n  watchSeriesMutation: PropTypes.func,\n  unWatchSeriesMutation: PropTypes.func\n}\n\n/**\n * Here's the graphql HOC that gets an individual series\n */\nconst withGetSelectedQuery = graphql(getWholeSeries, {\n  props: ({ data }) => {\n    if (data.error) console.error(data.error)\n    // console.log('HERE', data)\n    let series = null\n    try {\n      if (!data.loading && !data.error) series = data.series\n    }\n    catch (e) {\n      console.error(data)\n      console.error(e)\n    }\n    return {\n      data,\n      loading: data.loading,\n      series\n    }\n  },\n  skip: ({ activeSeries, isNewSeries }) => !activeSeries || isNewSeries,\n  options: ({ activeSeries }) => ({\n    variables: {\n      id: activeSeries\n    }\n  })\n})\n\nconst withUpdateSeriesMutation = graphql(updateSeries, {\n  props: ({ mutate, ownProps }) => ({\n    // We turn this into a thunk so we can handle the business logic here and not in a JSX region\n    updateSeriesMutation: (series, seriesDelta) => mutate({\n      // input UpdateSeries {\n      //   id: ID!\n      //   name: String\n      //   note: String\n      //   latitude: Float\n      //   longitude: Float\n      //   direction: Int\n      // }\n      variables: { series: sanitizeUpdateParams(seriesDelta, ['id', 'name', 'access', 'note', 'latitude', 'longitude', 'direction']) },\n      optimisticResponse: {\n        updateSeries: {\n          ...series,\n          ...seriesDelta,\n          __typename: 'Series'\n        }\n      },\n      update: (store, { data }) => {\n        // console.log('withUpdateSeriesMutation start Manip:', JSON.stringify(data, null, 2))\n        const qdata = store.readQuery({ query: getWholeSeries, variables: { id: ownProps.activeSeries } })\n        qdata.series = { ...qdata.series, ...seriesDelta }\n        store.writeQuery({ query: getWholeSeries, data: qdata })\n        // console.log('withUpdateSeriesMutation Done Manip:', qdata)\n\n        // Update: allSeries\n        // We might not have called this query yet so let it throw if it wants\n        try {\n          const qdataAll = store.readQuery({ query: allSeries, variables: { limit: 100 } })\n          // console.log('withUpdateSeriesMutation qdataAll:', qdataAll)\n          const summary = sanitizeUpdateParams(seriesDelta, ['id', 'name', 'access', 'latitude', 'longitude', 'direction'])\n          qdataAll.allSeries.seriesSummaries = qdataAll.allSeries.seriesSummaries.map(s => s.id !== summary.id\n            ? s\n            : { ...s, ...summary }\n          )\n          store.writeQuery({ query: allSeries, data: qdataAll })\n          // console.log('withUpdateSeriesMutation qdataAll WRITE:', qdataAll)\n        }\n        catch (e) { }\n      }\n    })\n  })\n})\n\n// id: ID!\n// seriesId: ID!\n// takenOn: String\n// tags: [TagInput]\n// note: String\nconst withUpdatePhotoMutation = graphql(updatePhoto, {\n  props: ({ mutate, ownProps }) => ({\n    // We turn this into a thunk so we can handle the business logic here and not in a JSX region\n    updatePhotoMutation: (photo, photoDelta) => {\n      const sanitizedPhotoDelta = sanitizeUpdateParams(photoDelta, [ 'id', 'seriesId', 'takenOn', 'tags', 'note' ])\n      if (sanitizedPhotoDelta.tags && sanitizedPhotoDelta.tags.length > 0) {\n        // input TagInput {\n        //   label: String\n        //   typeId: String,\n        //   coords: ImageCoordsInput\n        // }\n        sanitizedPhotoDelta.tags = sanitizedPhotoDelta.tags.map(t => {\n          const newT = sanitizeUpdateParams(t, [ 'label', 'typeId', 'coords' ])\n          if (newT.coords) newT.coords = sanitizeUpdateParams(newT.coords, [ 'x', 'y' ])\n          return newT\n        })\n      }\n      // console.log('withUpdatePhotoMutation', sanitizedPHoto)\n      return mutate({\n      // input UpdatePhoto {\n      //   id: ID!\n      //   seriesId: ID!\n      //   takenOn: String\n      //   tags: [TagInput]\n      //   note: String\n      // }\n        variables: { photo: sanitizedPhotoDelta },\n        optimisticResponse: {\n          updatePhoto: {\n            ...photo,\n            ...sanitizedPhotoDelta,\n            __typename: 'Photo'\n          }\n        },\n        update: (store, { data }) => {\n          // console.log('updatePhotoMutation start Manip:', JSON.stringify(data, null, 2))\n          const qdata = store.readQuery({ query: getWholeSeries, variables: { id: ownProps.activeSeries } })\n          // Gotta add Typenames\n          const updatedPhoto = {\n            ...sanitizedPhotoDelta,\n            tags: sanitizedPhotoDelta.tags ? sanitizedPhotoDelta.tags.map(t => {\n              const newT = { ...t, __typename: 'Tag' }\n              newT.coords = newT.coords ? { ...newT.coords, __typename: 'ImageCoords' } : null\n              return newT\n            }) : []\n          }\n          // console.log('updatePhotoMutation', updatedPhoto)\n          qdata.series.photos = qdata.series.photos.map(photo => photo.id !== photoDelta.id ? photo : { ...photo, ...updatedPhoto })\n\n          store.writeQuery({ query: getWholeSeries, data: qdata })\n          // console.log('updatePhotoMutation Manip:', { qdata })\n        }\n      })\n    }\n  })\n})\n\nconst withDeleteSeriesDeleteMutation = graphql(deleteSeries, {\n  props: ({ mutate, ownProps }) => {\n    return {\n      deleteSeriesMutation: () => mutate({\n        variables: { id: ownProps.activeSeries },\n        optimisticResponse: {\n          deleteSeries: ownProps.activeSeries\n        },\n        update: (store, { data }) => {\n          try {\n            const qdataAll = store.readQuery({ query: allSeries, variables: { limit: 100 } })\n            qdataAll.allSeries.seriesSummaries = qdataAll.allSeries.seriesSummaries.filter(s => s.id !== data.deleteSeries)\n            store.writeQuery({ query: allSeries, data: qdataAll })\n          }\n          catch (e) { }\n        }\n      })\n    }\n  }\n})\n\nconst withDeletePhotoMutation = graphql(deletePhoto, {\n  props: ({ mutate, ownProps }) => ({\n    // We turn this into a thunk so we can handle the business logic here and not in a JSX region\n    deletePhotoMutation: (photoId) => mutate({\n      variables: { seriesId: ownProps.series.id, photoId },\n      optimisticResponse: {\n        deletePhoto: photoId\n      },\n      update: (store, { data }) => {\n        console.log('deletePhotoMutation start Manip:', JSON.stringify(data, null, 2))\n        let finalCount = null\n\n        const qdata = store.readQuery({ query: getWholeSeries, variables: { id: ownProps.activeSeries } })\n        qdata.series.photos = qdata.series.photos.filter(photo => photo.id !== data.deletePhoto)\n\n        finalCount = qdata.series.photos.length\n        qdata.series.photoCount = finalCount\n        store.writeQuery({ query: getWholeSeries, data: qdata })\n        console.log('deletePhotoMutation start Manip WRITE:', qdata)\n\n        // Update: allSeries\n        // We might not have called this query yet so let it throw if it wants\n        try {\n          const qdataAll = store.readQuery({ query: allSeries, variables: { limit: 100 } })\n          console.log('deletePhotoMutation qdataAll:', qdataAll)\n          qdataAll.allSeries.seriesSummaries = qdataAll.allSeries.seriesSummaries.map(s => s.id !== data.deletePhoto\n            ? s\n            : { ...s, photoCount: finalCount !== null ? finalCount : s.photoCount }\n          )\n          store.writeQuery({ query: allSeries, data: qdataAll })\n          console.log('deletePhotoMutation qdataAll WRITE:', qdataAll)\n        }\n        catch (e) { }\n\n        console.log('Done Manip:', qdata.series.photos)\n      }\n    })\n  })\n})\n\nconst withCreateNewSeries = graphql(createSeries, {\n  props: ({ mutate, ownProps }) => {\n    return {\n      createSeriesMutation: (newSeries) => {\n        // input NewSeriesInput {\n        //   name: String!\n        //   note: String\n        //   latitude: Float!\n        //   longitude: Float!\n        //   direction: Int\n        //   meta: String\n        // }\n        return mutate({\n          variables: { series: sanitizeUpdateParams(newSeries, ['name', 'note', 'latitude', 'longitude', 'direction', 'meta']) },\n          optimisticResponse: {\n            'createSeries': {\n              'id': localUUID('SERIES'),\n              'name': newSeries.name || null,\n              'note': newSeries.note || null,\n              'meta': newSeries.meta || {},\n              'featured': newSeries.featured || null,\n              'coords': newSeries.coords || null,\n              'direction': newSeries.direction || null,\n              'photoCount': 0,\n              'photos': [],\n              __typename: 'Series'\n            }\n          },\n          update: (store, { data }) => {\n            // We need to write this query from scratch\n            console.log('STARTING TO CREATE THE SERIES', data, store)\n            // dumpLog(store.data, '##CACHE-NEW_SERIES_BEFORE')\n            try {\n              store.writeQuery({ query: getWholeSeries,\n                data: { series: data.createSeries }\n              })\n              console.log('Series write getWholeSeries', { series: data.createSeries })\n            }\n            catch (e) {\n              console.error(e)\n            }\n\n            try {\n              const qdataAll = store.readQuery({ query: allSeries, variables: { limit: 100 } })\n              // console.log('createSeriesMutation qdataAll:', qdataAll)\n              const newAllSeriesEntry = sanitizeUpdateParams(data.createSeries, ['id', 'name', 'updatedOn', 'featured', 'longitude', 'latitude', 'photoCount', 'seriesStatus', 'direction'])\n              qdataAll.allSeries.seriesSummaries.push(newAllSeriesEntry)\n              store.writeQuery({ query: allSeries, data: qdataAll })\n              // console.log('createSeriesMutation qdataAll WRITE:', qdataAll)\n            }\n\n            catch (e) {\n              // dumpLog(store.data, '##CACHE-NEW_SERIES_ERROR')\n              console.error('createSeriesMutation allSeries error')\n              console.error(e)\n            }\n            // dumpLog(store.data, '##CACHE-NEW_SERIES_AFTER')\n          }\n        })\n      }\n    }\n  }\n})\n\nconst withCreateNewPhoto = graphql(createPhoto, {\n  props: ({ mutate, ownProps }) => {\n    return {\n      createPhotoMutation: (newPhoto, ext) => {\n        // input NewPhotoInput {\n        //   seriesId: ID!\n        //   takenOn: String\n        //   meta: String\n        //   tags: [TagInput]\n        //   note: String\n        // }\n        // When we're not creating a series the seriesId isn't passed in\n        // so we add it now\n        const { base64, ...newPhotoInput } = newPhoto\n        if (!newPhotoInput.seriesId && ownProps.activeSeries) {\n          newPhotoInput.seriesId = ownProps.activeSeries\n        }\n        return mutate({\n          variables: { photo: sanitizeUpdateParams(newPhotoInput, [ 'seriesId', 'takenOn', 'meta', 'tags', 'note' ]), ext },\n          optimisticResponse: {\n            'createPhoto': {\n              'photo': {\n                'id': localUUID('PHOTO'),\n                'meta': newPhotoInput.meta,\n                'seriesId': newPhotoInput.seriesId,\n                'createdOn': Date.now().toString(),\n                'createdUser': {\n                  'id': ownProps.authData.attributes.sub,\n                  'username': ownProps.authData.Username\n                },\n                'updatedBy': ownProps.authData.attributes.sub,\n                'updatedOn': Date.now().toString(),\n                'takenOn': newPhotoInput.takenOn,\n                'tags': newPhotoInput.tags || [],\n                'paths': {\n                  large: null,\n                  orig: null,\n                  thumb: null,\n                  medium: null,\n                  __typename: 'Paths'\n                },\n                '__typename': 'Photo'\n              },\n              'preAuth': null,\n              '__typename': 'NewPhotoOutput'\n            }\n          },\n          update: (store, { data }) => {\n            // Update: getWholeSeries\n            console.log('createPhotoMutation store.readQuery:', { data, store, ownProps })\n\n            try {\n              const qdata = store.readQuery({ query: getWholeSeries, variables: { id: data.createPhoto.seriesId } })\n              qdata.series.photos = qdata.series.photos = [...qdata.series.photos, data.createPhoto]\n\n              store.writeQuery({ query: getWholeSeries, data: qdata })\n            }\n            catch (e) {\n              // This won't fire on new series and that's ok for now.\n            }\n\n            // Update: allSeries\n            // We might not have called this query yet so let it throw if it wants\n            let qdataAll = null\n            try {\n              qdataAll = store.readQuery({ query: allSeries, variables: { limit: 100 } })\n              console.log('createPhotoMutation qdataAll:', qdataAll)\n              qdataAll.allSeries.seriesSummaries = qdataAll.allSeries.seriesSummaries.map(s => s.id !== data.createPhoto.photo.seriesId\n                ? s\n                : { ...s, photoCount: s.photoCount + 1 }\n              )\n              store.writeQuery({ query: allSeries, data: qdataAll })\n              console.log('createPhotoMutation qdataAll: WRITE', qdataAll)\n            }\n            catch (e) {\n              console.error('createPhotoMutation allSeries ERROR')\n              console.error(e)\n            }\n          }\n        })\n      }\n    }\n  }\n})\n\nconst withWatchSeriesMutation = graphql(watchSeries, {\n  props: ({ mutate, ownProps }) => {\n    return {\n      watchSeriesMutation: () => mutate({\n        variables: { id: ownProps.activeSeries },\n        optimisticResponse: {\n          watchSeries: ownProps.activeSeries\n        },\n        update: (store, { data }) => {\n          // TODO: modify the getuser query to add this to the list of favourites\n          // try {\n          //   const qdataAll = store.readQuery({ query: allSeries, variables: { limit: 100 } })\n          //   qdataAll.allSeries.seriesSummaries = qdataAll.allSeries.seriesSummaries.filter(s => s.id !== data.deleteSeries)\n          //   store.writeQuery({ query: allSeries, data: qdataAll })\n          // }\n          // catch (e) { }\n        }\n      })\n    }\n  }\n})\n\nconst withUnWatchSeriesMutation = graphql(unWatchSeries, {\n  props: ({ mutate, ownProps }) => {\n    return {\n      unWatchSeriesMutation: () => mutate({\n        variables: { id: ownProps.activeSeries },\n        optimisticResponse: {\n          unWatchSeries: ownProps.activeSeries\n        },\n        update: (store, { data }) => {\n          // try {\n          //   const qdataAll = store.readQuery({ query: allSeries, variables: { limit: 100 } })\n          //   qdataAll.allSeries.seriesSummaries = qdataAll.allSeries.seriesSummaries.filter(s => s.id !== data.deleteSeries)\n          //   store.writeQuery({ query: allSeries, data: qdataAll })\n          // }\n          // catch (e) { }\n        }\n      })\n    }\n  }\n})\n\n/**\n * Compose all our queries together\n */\nconst connectedWithApollo = compose(\n  withGetSelectedQuery,\n  withCreateNewSeries,\n  withCreateNewPhoto,\n  withUpdateSeriesMutation,\n  withUpdatePhotoMutation,\n  withDeleteSeriesDeleteMutation,\n  withDeletePhotoMutation,\n  withWatchSeriesMutation,\n  withUnWatchSeriesMutation\n)(SeriesConnect)\n\n/**\n * Map our redux state and functions\n */\nconst mapStateToProps = (state, props) => {\n  const { current: { activeSeries, initialPhoto, domain } } = state.home\n  return { activeSeries, initialPhoto, domain }\n}\n\nconst mapDispatchToProps = dispatch => ({\n  onBack: () => {\n    dispatch(actions.homeStateBack())\n  },\n  onAfterSeriesDelete: (key, newProgress) => {\n    dispatch(actions.setActiveSeries(null))\n    dispatch(actions.homeStateBack())\n  },\n  queueUpload: (uploadObj) => {\n    dispatch(actions.queueUpload(uploadObj))\n  },\n  doneCreatingSeries: (seriesId) => {\n    dispatch(actions.setActiveSeries(seriesId))\n    dispatch(actions.setHomeState(home.AppStateTypes.SERIES))\n  }\n})\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(connectedWithApollo)\n\n/**\n * We need to filter out null values and params we don't desire\n */\nfunction sanitizeUpdateParams (inputObj, desiredParams) {\n  const newDesiredParams = [...desiredParams, '__typename']\n  const remainder = Object.keys(inputObj).filter(key => newDesiredParams.indexOf(key) > -1)\n  console.log('sanitizeUpdateParams', { orig: Object.keys(inputObj), remainder })\n  return remainder.reduce((acc, key) => ({ ...acc, [key]: inputObj[key] }), {})\n}\n\nfunction dumpLog (obj, name) {\n  console.log(`${Date.now()}__${name}`, JSON.stringify(obj, null, 2))\n}\n","import { useState, useEffect, useCallback } from 'react'\nimport uuid from 'uuid/v4'\nimport WebMercatorViewport from 'viewport-mercator-project'\nimport rbush from 'rbush'\nimport { point, centroid, featureCollection } from '@turf/turf'\nimport { debounce } from './util'\n\nconst useClusteredData = (data, filterBounds, currentZoom, viewport, sizeScale, queryVersion) => {\n  const [clusteredData, setClusteredData] = useState([])\n  const [filteredData, setFilteredData] = useState({ single: [], cluster: [] })\n  const [version, setVersion] = useState(0)\n\n  // We promisify and debounce the expensive stuff so it runs outside our render loop\n  const updateDataDebounce = useCallback(debounce(async (...innerArgs) => {\n    const updatedData = await updateData(...innerArgs)\n    setClusteredData(updatedData)\n    // setClusteredData(updatedData)\n    setVersion(version + 1)\n  }, 1000), [])\n\n  const filterDataDebounce = useCallback(debounce(async (...innerArgs) => {\n    const filtered = await filterData(...innerArgs)\n    setFilteredData(filtered)\n  }, 300), [])\n\n  // Here's the really expensive call. Make sure this only runs when the data changes\n  useEffect(() => {\n    updateDataDebounce(data, sizeScale, viewport)\n  }, [data.length, queryVersion])\n\n  useEffect(() => {\n    filterDataDebounce(clusteredData, filterBounds, currentZoom)\n  }, [clusteredData, currentZoom, filterBounds, version])\n\n  return { filteredClusteredData: filteredData }\n}\n\nexport default useClusteredData\n\n// Compute icon clusters\n// We use the projected positions instead of longitude and latitude to build\n// the spatial index, because this particular dataset is distributed all over\n// the world, we can't use some fixed deltaLon and deltaLat\nconst updateData = (data, sizeScale, viewport) => {\n  // console.log('----------------------------------UPDATE CLUSTER----------------------------------', { data, sizeScale, viewport })\n\n  if (!data) {\n    return []\n  }\n  const tree = rbush(9, ['.x', '.y', '.x', '.y'])\n\n  const transform = new WebMercatorViewport({\n    ...viewport,\n    zoom: 0\n  })\n\n  // console.log('DATA', data)\n  // The root of this is GeoJSON so that's what we have to build\n  const newData = data.map(p => {\n    // Create some GeoJSON that we can render as a dot\n    let screenCoords = [0, 0]\n    try {\n      screenCoords = transform.project(p.coords)\n    }\n    catch (e) {\n      console.error(e)\n    }\n    const { longitude, latitude, ...properties } = p\n    return {\n      x: screenCoords[0],\n      y: screenCoords[1],\n      photoCount: properties.photoCount,\n      zoomLevels: [],\n      geoJSON: p.coords ? point(p.coords, { ...properties }) : null\n    }\n  })\n\n  tree.clear()\n  tree.load(newData)\n\n  for (let z = 0; z <= 20; z++) {\n    const radius = sizeScale / Math.sqrt(2) / Math.pow(2, z)\n    // const radius = 60 / Math.sqrt(2) / Math.pow(2, z)\n\n    newData.forEach(p => {\n      if (p.zoomLevels[z] === undefined) {\n        // this point does not belong to a cluster\n        const { x, y } = p\n\n        // find all points within radius that do not belong to a cluster\n        const neighbors = tree\n          .search({\n            minX: x - radius,\n            minY: y - radius,\n            maxX: x + radius,\n            maxY: y + radius\n          })\n          .filter(neighbor => neighbor.zoomLevels[z] === undefined)\n\n        // only show the center point at this zoom level\n        neighbors.forEach(neighbor => {\n          if (neighbor === p) {\n            const newGeoJSON = neighbors.length === 1\n              ? p.geoJSON\n              : centroid(featureCollection(neighbors.map(n => n.geoJSON)))\n\n            newGeoJSON.properties = {\n              ...newGeoJSON.properties,\n              id: newGeoJSON.properties.id || uuid(),\n              count: neighbors.length,\n              reducedPhotoCount: neighbors.reduce((acc, { photoCount }) => photoCount ? acc + photoCount : acc, 0),\n              points: neighbors.map(n => n.geoJSON)\n            }\n            p.zoomLevels[z] = newGeoJSON\n          }\n          else {\n            neighbor.zoomLevels[z] = null\n          }\n        })\n      }\n    })\n  }\n\n  // console.log('----------------------------------UPDATE CLUSTER DONE----------------------------------')\n  return newData.map(({ zoomLevels }) => zoomLevels)\n}\n\nfunction filterData (clusteredData, filterBounds, newZ) {\n  // console.log('----------------------------------FILTER CLUSTER----------------------------------', { clusteredData, filterBounds, newZ })\n\n  return clusteredData\n    // Filter out anything not relevant to this zoom level\n    .filter(d => !!d[newZ])\n    // Restructure the object to be a little more JSON-friendly\n    .reduce((acc, zoomLevels) => {\n      const geoJSON = zoomLevels[newZ]\n      const coords = geoJSON.geometry.coordinates\n      const { count } = geoJSON.properties\n\n      if (!filterBounds || filterBounds.length < 4 || (\n        filterBounds[0] < coords[0] && filterBounds[1] < coords[1] &&\n        filterBounds[2] > coords[0] && filterBounds[3] > coords[1]\n      )) {\n        if (count > 1) acc.cluster.push(geoJSON)\n        else acc.single.push(geoJSON)\n      }\n      return acc\n    }, {\n      single: [],\n      cluster: []\n    })\n}\n","export default theme => ({\n  root: {\n    position: 'relative',\n    height: '100%',\n    '& .myPosMarker': {\n      zIndex: 1\n    },\n    '& .singleMarker': {\n      zIndex: 3\n    },\n    '& .clusterMarker': {\n      zIndex: 2\n    }\n  },\n  fab: {\n    background: theme.palette.secondary.main,\n    color: theme.palette.secondary.contrastText\n  },\n  topBar: {\n    position: 'absolute',\n    zIndex: 1000,\n    top: 0\n  },\n  zoomOutFab: {\n    margin: theme.spacing(0.5),\n    padding: theme.spacing(0.5),\n    border: '2px solid',\n    borderRadius: theme.spacing(1),\n    background: theme.palette.common.white,\n    fontSize: 20,\n    position: 'absolute',\n    zIndex: 100,\n    bottom: theme.spacing(2),\n    right: theme.spacing(10)\n  },\n  selectedPopup: {\n    padding: theme.spacing(0, 1, 0, 1),\n    width: '90%',\n    maxWidth: 400,\n    zIndex: 2000,\n    position: 'absolute',\n    bottom: theme.spacing(1),\n    left: '50%',\n    transformOrigin: '0% 50%',\n    transform: 'translateY(0%) translateX(-50%)'\n  }\n})\n","import React from 'react'\nimport createSvgIcon from '@material-ui/icons/utils/createSvgIcon'\n\nexport default createSvgIcon(\n  <React.Fragment>\n    <path d='M 5.4 0 L 18.6 0 C 21.58 0 24 2.42 24 5.4 L 24 18.6 C 24 21.58 21.58 24 18.6 24 L 5.4 24 C 2.42 24 0 21.58 0 18.6 L 0 5.4 C 0 2.42 2.42 0 5.4 0 Z'\n      style={{\n        fill: 'none',\n        stroke: '#000000',\n        strokeWidth: 2,\n        strokeLinecap: 'square',\n        strokeDasharray: '0.1,3',\n        strokeMiterlimit: 5\n      }} />\n    <path d=' M 12 1.333 L 15.135 7.685 L 22.145 8.704 L 17.072 13.648 L 18.27 20.63 L 12 17.333 L 5.73 20.63 L 6.928 13.648 L 1.855 8.704 L 8.865 7.685 L 12 1.333 Z ' fill='rgb(235,235,235)' vectorEffect='non-scaling-stroke'\n      strokeWidth='1'\n      stroke='rgb(0,0,0)'\n      strokeLinejoin='miter'\n      strokeLinecap='square'\n      strokeMiterlimit='3' />\n  </React.Fragment>, 'AppLogo')\n","import React, { useState, useContext } from 'react'\nimport classNames from 'classnames'\nimport PropTypes from 'prop-types'\n\nimport Toolbar from '@material-ui/core/Toolbar'\nimport Drawer from '@material-ui/core/Drawer'\nimport Divider from '@material-ui/core/Divider'\nimport IconButton from '@material-ui/core/IconButton'\nimport List from '@material-ui/core/List'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemIcon from '@material-ui/core/ListItemIcon'\nimport ListItemText from '@material-ui/core/ListItemText'\nimport MenuIcon from '@material-ui/icons/Menu'\nimport AppLogo from '../icons/AppLogo'\nimport { AppContext } from '../contexts'\n\nimport ExitToAppIcon from '@material-ui/icons/ExitToApp'\nimport AccountCircleIcon from '@material-ui/icons/AccountCircle'\n\n// import MenuIcon from '@material-ui/core/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n    padding: '2px 4px',\n    display: 'flex',\n    alignItems: 'center',\n    width: '100%',\n    background: theme.palette.primary.main,\n    color: theme.palette.primary.contrastText\n  },\n  searchIcon: {\n    opacity: 0.3,\n    marginRight: theme.spacing(1)\n  },\n  transparent: {\n    background: 'none',\n    color: theme.palette.text.primary\n  },\n  input: {\n    background: '#FFFFFF',\n    border: '1px solid #AAAAAA',\n    borderRadius: theme.spacing(1) * 2,\n    paddingLeft: theme.spacing(1),\n    marginLeft: 0,\n    flex: 1\n  },\n  children: {\n    flexGrow: 1\n  },\n  iconButton: {\n    padding: 10\n  },\n  divider: {\n    width: 1,\n    height: 28,\n    margin: 4\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst TopBar = ({ className, children, isTransparent, menuItems }) => {\n  const classes = useStyles()\n  const [drawerOpen, setDrawerOpen] = useState(false)\n  const { signOut, signedIn, forceSignIn } = useContext(AppContext)\n  return (\n    <Toolbar className={classNames(classes.root, className, isTransparent ? classes.transparent : null)} disableGutters>\n      <IconButton className={classes.iconButton}>\n        <AppLogo />\n      </IconButton>\n      {/* {hasSearch && (\n        <InputBase\n          className={classes.input}\n          placeholder='Search...'\n          endAdornment={\n            <InputAdornment position='end'>\n              <SearchIcon className={classes.searchIcon} />\n            </InputAdornment>\n          }\n        />\n      )} */}\n      <div className={classes.children}>\n        {children}\n      </div>\n      {signedIn && (\n        <IconButton\n          color='inherit'\n          className={classes.iconButton}\n          aria-label='Menu'\n          onClick={() => setDrawerOpen(!drawerOpen)}>\n          <MenuIcon color='inherit' />\n        </IconButton>\n      )}\n      {!signedIn && (\n        <IconButton\n          color='primary'\n          className={classes.iconButton}\n          aria-label='Menu'\n          onClick={forceSignIn}\n        >\n          <AccountCircleIcon color='primary' />\n        </IconButton>\n      )}\n      <Drawer anchor='top' open={drawerOpen} onClose={() => setDrawerOpen(false)}>\n        <div\n          tabIndex={0}\n          role='button'\n          onClick={() => setDrawerOpen(false)}\n          onKeyDown={() => setDrawerOpen(false)}\n        >\n          <div className={classes.fullList}>\n            <List>\n              {menuItems && menuItems.map(({ callback, text, icon, color }, idx) => (\n                <ListItem button key={`top-menu-item-${idx}`} onClick={callback}>\n                  {icon && <ListItemIcon color={color}>{icon}</ListItemIcon>}\n                  <ListItemText primary={text} color={color} />\n                </ListItem>\n              ))}\n            </List>\n            {menuItems && <Divider />}\n            <List>\n              {signedIn && (\n                <ListItem button onClick={signOut}>\n                  <ListItemIcon>\n                    <ExitToAppIcon />\n                  </ListItemIcon>\n                  <ListItemText primary='Sign Out' />\n                </ListItem>\n              )}\n            </List>\n          </div>\n\n        </div>\n      </Drawer>\n    </Toolbar>\n  )\n}\n\nTopBar.propTypes = {\n  className: PropTypes.string,\n  children: PropTypes.any,\n  isTransparent: PropTypes.bool,\n  menuItems: PropTypes.arrayOf(PropTypes.shape({\n    callback: PropTypes.func,\n    text: PropTypes.string,\n    icon: PropTypes.any,\n    color: PropTypes.string\n  }))\n}\n\nexport default TopBar\n","import React, { useRef, useLayoutEffect, useCallback } from 'react'\nimport PropTypes from 'prop-types'\nimport { fade } from '@material-ui/core/styles/colorManipulator'\nimport InputBase from '@material-ui/core/InputBase'\n\nimport SearchIcon from '@material-ui/icons/Search'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { debounce } from '../../lib/util'\n\nconst useSearchBarStyles = makeStyles(theme => ({\n  root: {\n    position: 'relative',\n    borderRadius: theme.shape.borderRadius,\n    backgroundColor: fade(theme.palette.common.white, 0.3),\n    '&:hover': {\n      backgroundColor: fade(theme.palette.common.white, 0.5)\n    },\n    marginRight: theme.spacing(2),\n    marginLeft: 0,\n    width: '100%',\n    [theme.breakpoints.up('sm')]: {\n      marginLeft: theme.spacing(3),\n      width: 'auto'\n    }\n  },\n  inputRoot: {\n    color: 'inherit'\n  },\n  inputInput: {\n    padding: theme.spacing(1, 1, 1, 7),\n    transition: theme.transitions.create('width'),\n    width: '100%',\n    [theme.breakpoints.up('md')]: {\n      width: 200\n    }\n  },\n  searchIcon: {\n    width: theme.spacing(7),\n    height: '100%',\n    position: 'absolute',\n    pointerEvents: 'none',\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center'\n  }\n}))\n\n/**\n *\n */\nexport const SearchInput = ({ autoFocus, disabled, onChange, onClick, defaultValue }) => {\n  const inputRef = useRef()\n  const classes = useSearchBarStyles()\n\n  const debounceSearchText = useCallback(\n    debounce(onChange, 500),\n    [onChange]\n  )\n\n  useLayoutEffect(() => {\n    if (inputRef.current) {\n      // console.log('Setting focus')\n      // inputRef.current.focus()\n    }\n  }, [])\n  return (\n    <div className={classes.root} onClick={onClick}>\n      <div className={classes.searchIcon}>\n        <SearchIcon />\n      </div>\n      <InputBase\n        autoFocus={!disabled && autoFocus}\n        inputProps={{\n          onBlur: () => {\n            // console.log('onBlur')\n            // inputRef.current.focus()\n          }\n        }}\n        onChange={(e) => {\n          // console.log('onChange', e.target.value)\n          debounceSearchText(e.target.value)\n        }}\n        placeholder='Search…'\n        disabled={disabled}\n        defaultValue={defaultValue}\n\n        inputRef={inputRef}\n        classes={{\n          root: classes.inputRoot,\n          input: classes.inputInput\n        }}\n      />\n    </div>\n  )\n}\n\nSearchInput.propTypes = {\n  autoFocus: PropTypes.bool,\n  disabled: PropTypes.bool,\n  onChange: PropTypes.func,\n  defaultValue: PropTypes.string,\n  onClick: PropTypes.func\n}\n\nexport default SearchInput\n","import React from 'react'\nimport classNames from 'classnames'\nimport Chip from '@material-ui/core/Chip'\nimport { makeStyles } from '@material-ui/core/styles'\nconst useStyles = makeStyles(theme => ({\n  root: {\n    height: theme.spacing(2),\n    marginRight: theme.spacing(1)\n  },\n  label: {\n    padding: theme.spacing(0, 1, 0, 1),\n    borderRadius: theme.spacing(0.5)\n  }\n}))\n\nconst TinyChip = (props) => {\n  const classes = useStyles()\n  return (\n    <Chip\n      {...props}\n      classes={{\n        root: classNames(classes.root, props.className),\n        label: classes.label\n      }}\n    />\n  )\n}\n\nexport default TinyChip\n","import React, { useContext } from 'react'\nimport PropTypes from 'prop-types'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemText from '@material-ui/core/ListItemText'\nimport List from '@material-ui/core/List'\nimport TinyChip from './TinyChip'\nimport Typography from '@material-ui/core/Typography'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { formatDate } from '../../lib/datelib'\n\nimport { ACCESS } from '../../config'\nimport { AppContext } from '../../contexts'\n\nconst style = theme => ({\n  root: {\n    margin: 0,\n    padding: theme.spacing(1)\n  },\n  chipContainer: {\n    display: 'flex',\n    width: '100%'\n  },\n  grow: { flexGrow: 1 },\n  accessPUBLIC: {\n    color: 'white',\n    background: ACCESS.PUBLIC.color\n  },\n  accessPRIVATE: {\n    color: 'white',\n    background: ACCESS.PRIVATE.color\n  },\n  accessOPEN: {\n    color: 'white',\n    background: ACCESS.OPEN.color\n  },\n  img: {\n    objectFit: 'cover',\n    height: '100%',\n    width: '100%'\n  },\n  text: {\n    margin: 0,\n    padding: theme.spacing(0, 1),\n    alignSelf: 'flex-start'\n  },\n  titleText: {\n    textOverflow: 'ellipsis',\n    whiteSpace: 'nowrap',\n    overflow: 'hidden'\n  },\n  dateContainer: {\n    display: 'flex'\n  },\n  dateLabel: {\n    fontWeight: 'bold',\n    flex: '1 1 50px'\n  },\n  dateText: {\n\n  },\n  imgContainer: {\n    flex: '0 0 25%',\n    alignSelf: 'flex-start',\n    height: '100%'\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst SeriesListItem = ({ series, loading, onClick, children, showCreatedOn, showLastPhoto }) => {\n  const classes = useStyles()\n  const { seriesConfig } = useContext(AppContext)\n  if (loading || !series) return 'LOADING...'\n  let thumb = null\n  let accessLabel = ACCESS.PRIVATE.label\n  try {\n    thumb = seriesConfig.getPhotoUrl(series.featured, 'thumb')\n    accessLabel = series.access ? ACCESS[series.access].label : ACCESS.PRIVATE.label\n  }\n  catch (e) {\n    console.error(e)\n  }\n  return (\n    <ListItem className={classes.root} button component='div' disableGutters>\n      <div className={classes.imgContainer} >\n        <img alt='thumbnail' src={thumb} className={classes.img} onClick={onClick} />\n      </div>\n      <ListItemText className={classes.text} disableTypography onClick={onClick}>\n        <Typography variant='body1' component='div' className={classes.titleText}>\n          {series.name || loading}\n        </Typography>\n        <Typography variant='body2' component='div'>\n          {series.access && <TinyChip label={accessLabel} className={classes[`access${series.access}`]} />}\n          Series <strong>by:</strong> {series.createdUser.username}\n        </Typography>\n        <Typography variant='caption' component='div'>{`${series.photoCount || 0} Photos`}</Typography>\n\n        {showCreatedOn && <div className={classes.dateContainer}>\n          <Typography variant='caption' className={classes.dateLabel}>Created:</Typography>\n          <Typography variant='caption' className={classes.dateText}>{formatDate(series.createdOn, 'llll')}</Typography>\n        </div>}\n        {showLastPhoto && <div className={classes.dateContainer}>\n          <Typography variant='caption' className={classes.dateLabel}>Last Photo:</Typography>\n          <Typography variant='caption' className={classes.dateText}>{formatDate(series.latest.takenOn, 'llll')}</Typography>\n        </div>}\n      </ListItemText>\n      {/*  <TinyChip label='Watching' color='secondary' /> */}\n      {children}\n    </ListItem>\n  )\n}\n\nSeriesListItem.propTypes = {\n  series: PropTypes.object,\n  loading: PropTypes.bool,\n  showCreatedOn: PropTypes.bool,\n  showLastPhoto: PropTypes.bool,\n  onClick: PropTypes.func,\n  children: PropTypes.array\n}\n\nexport default SeriesListItem\n\n// const useCosmosStyles = makeStyles(theme => ({\n//   root: {\n\n//   }\n// }))\n\nexport const SeriesListItemCosmos = (props) => {\n  // const classes = useCosmosStyles()\n  return (\n    <List disablePadding dense>\n      <SeriesListItem {...props} />\n    </List>\n  )\n}\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemText from '@material-ui/core/ListItemText'\nimport List from '@material-ui/core/List'\n// import IconButton from '@material-ui/core/IconButton'\n// import ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction'\nimport ZoomOutMapIcon from '@material-ui/icons/ZoomOutMap'\n// import CancelIcon from '@material-ui/icons/Cancel'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { ListItemIcon } from '@material-ui/core'\n\nconst style = theme => ({\n  root: {\n\n  }\n})\n\nconst useStyles = makeStyles(style)\n\nconst ClusterSelected = ({ seriesCount, reducedPhotoCount, onZoomTo, onClose }) => {\n  const classes = useStyles()\n  console.log('cluster selected', { seriesCount, reducedPhotoCount })\n  return (\n    <List>\n      <ListItem className={classes.root}>\n        <ListItemIcon onClick={onZoomTo}>\n          <ZoomOutMapIcon />\n        </ListItemIcon>\n        <ListItemText\n          onClick={onZoomTo}\n          primary={`${seriesCount} Photo series`}\n          secondary={`containing ${reducedPhotoCount} individual photo${reducedPhotoCount === 1 ? '' : 's'}`}\n        />\n        {/* <ListItemSecondaryAction>\n          <IconButton aria-label='Close' onClick={onClose}>\n            <CancelIcon />\n          </IconButton>\n        </ListItemSecondaryAction> */}\n\n      </ListItem>\n    </List>\n  )\n}\n\nClusterSelected.propTypes = {\n  seriesCount: PropTypes.number.isRequired,\n  reducedPhotoCount: PropTypes.number.isRequired,\n  onZoomTo: PropTypes.func.isRequired,\n  onClose: PropTypes.func.isRequired\n}\n\nexport default ClusterSelected\n","import React from 'react'\nimport classNames from 'classnames'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport Badge from '@material-ui/core/Badge'\nimport Avatar from '@material-ui/core/Avatar'\nimport Camera from '@material-ui/icons/Camera'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { ACCESS } from '../../../config'\n\nconst style = theme => ({\n  root: {\n    color: theme.palette.primary.main,\n    width: 150,\n    position: 'absolute',\n    top: '50%',\n    left: '50%',\n    textAlign: 'center',\n    transformOrigin: '50% 50%',\n    transform: 'translateY(-50%) translateX(-50%)'\n  },\n  rootActive: {\n    zIndex: 1000\n  },\n  icon: {\n    // height: 16,\n    // width: 16\n  },\n  avatar: {\n    position: 'relative',\n    margin: '0 auto',\n    background: 'green',\n    color: 'white',\n    border: '2px solid white',\n    height: 40,\n    width: 40,\n    zIndex: 120,\n    '&.PUBLIC': { background: ACCESS.PUBLIC.color },\n    '&.PRIVATE': { background: ACCESS.PRIVATE.color },\n    '&.OPEN': { background: ACCESS.OPEN.color }\n  },\n  avatarActive: {\n    background: '#FFFF00',\n    color: 'black',\n    border: `2px solid black`,\n    '&.PUBLIC': { background: '#FFFF00' },\n    '&.PRIVATE': { background: '#FFFF00' },\n    '&.OPEN': { background: '#FFFF00' }\n  },\n  badge: {\n    zIndex: 124,\n    color: theme.palette.secondary.contrastText,\n    background: theme.palette.secondary.main,\n    transform: 'scale(1) translate(30%, -30%)'\n  },\n  badgeActive: {\n    color: theme.palette.primary.contrastText,\n    background: theme.palette.primary.main\n  },\n  directionIndicator: {\n    position: 'absolute',\n    top: 20,\n    left: '50%',\n    // transformOrigin: '50% 50%',\n    // transform: 'translateY(-50%) translateX(-50%)',\n    zIndex: 100\n  },\n  name: {\n    color: 'white',\n    fontWeight: 'bold',\n    textShadow: `\n        0px 0px 4px #000000, \n        0px 0px 4px #000000 \n    `,\n    zIndex: 122,\n    position: 'relative'\n    // textStroke: '1px white'\n  },\n  nameActive: {\n    color: 'black',\n    textShadow: `\n    0px 0px 2px #FFFFFF, \n    0px 0px 2px #FFFFFF,\n    0px 0px 4px #FFFFFF \n`\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst Single = ({ name, access, onClick, active, photoCount, direction }) => {\n  const classes = useStyles()\n  return (\n    <div className={classNames(classes.root, active ? classes.rootActive : null, access)}>\n      <Badge classes={{ badge: classNames(classes.badge, active ? classes.badgeActive : null, access) }} badgeContent={photoCount}>\n        <Avatar className={classNames(classes.avatar, active ? classes.avatarActive : null, access)} onClick={onClick}>\n          <Camera className={classes.icon} color='inherit' />\n        </Avatar>\n      </Badge>\n      {direction && direction >= 0 ? (\n        <div className={classes.directionIndicator}>\n          <svg className={classes.svgArc}\n            version='1.1'\n            width='100'\n            height='100'\n            viewBox='0, 0, 100, 100'\n            style={{ transform: `translateY(-50%) translateX(-50%) rotateZ(${direction}deg)` }}>\n            <path d='M50,0 C60.946,0.151 72.136,3.514 80.675,10.56 L50,50 L19.325,10.56 C27.938,3.461 39,0.278 50,0 z'\n              fill='#009DC1'\n              fillOpacity='0.444'\n              strokeWidth='1'\n              strokeOpacity='0.6'\n              stroke='#FFFFFF'\n            />\n          </svg>\n        </div>\n      ) : null}\n      <Typography variant='body1' className={classNames(classes.name, active ? classes.nameActive : null)}>\n        {name}\n      </Typography>\n    </div>\n  )\n}\n\nSingle.propTypes = {\n  access: PropTypes.string,\n  name: PropTypes.string,\n  photoCount: PropTypes.number,\n  onClick: PropTypes.func.isRequired,\n  direction: PropTypes.number,\n  active: PropTypes.bool\n}\n\nexport default Single\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport Avatar from '@material-ui/core/Avatar'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport numeral from 'numeral'\n\n\nconst style = theme => ({\n  avatar: {\n    background: theme.palette.primary.dark,\n    border: `2px solid ${theme.palette.primary.contrastText}`,\n    color: theme.palette.primary.contrastText\n  },\n  avatarActive: {\n    background: '#FFFF00',\n    border: `2px solid black`,\n    color: 'black',\n    zIndex: 1000\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst Cluster = ({ seriesCount, active, onClick }) => {\n  const classes = useStyles()\n  return (\n    <Avatar onClick={onClick} className={classNames(classes.avatar, active ? classes.avatarActive : null)}>\n      {numeral(seriesCount).format('0,0')}\n    </Avatar>\n  )\n}\n\nCluster.propTypes = {\n  seriesCount: PropTypes.number,\n  onClick: PropTypes.func.isRequired,\n  active: PropTypes.bool\n}\n\nexport default Cluster\n","\nimport React, { useState, useMemo, useRef, useEffect, useCallback } from 'react'\nimport PropTypes from 'prop-types'\nimport Paper from '@material-ui/core/Paper'\nimport { FlyToInterpolator, LinearInterpolator, Marker } from 'react-map-gl'\nimport { easeCubic } from 'd3-ease'\nimport MapStyles from '../../mapStyles'\n\nimport BaseMap from './BaseMap'\nimport useClusteredData from '../../lib/useClusteredData'\nimport { bbox, featureCollection, buffer, point } from '@turf/turf'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { debounce } from '../../lib/util'\nimport style from './HomeMap.style'\n\nimport TopBar from '../TopBar'\nimport SearchInput from '../Search/SearchInput'\nimport SeriesListItem from '../misc/SeriesListItem'\nimport ClusterSelected from '../misc/ClusterSelected'\n\nimport SingleMarker from './markers/Single'\nimport ClusterMarker from './markers/Cluster'\n\nconst useStyles = makeStyles(style)\n\nconst defaultView = {\n  zoom: 4,\n  latitude: 44.629701,\n  longitude: -120.333379\n}\n\nconst SIZESCALE = 80\n\nconst HomeMap = ({\n  seriesList, initViewport, loading, activeSeries, queryVersion,\n  setActiveSeries, onSeriesClick, onSearchClick,\n  popMapHistory, pushMapHistory, clearMapHistory\n}) => {\n  const [mapViewObj, setMapViewObj] = useState({\n    viewport: { ...defaultView, ...initViewport.viewport },\n    bounds: initViewport.bounds,\n    filterBounds: null\n  })\n  const classes = useStyles()\n  const mapViewRef = useRef()\n  const [isTransitioning, setIsTransitioning] = useState(false)\n  const homeMapContainerRef = useRef()\n\n  const [currentZoom, setCurrentZoom] = useState(0)\n  const [transitions, setTransitions] = useState(null)\n  const [selectedItem, setSelectedItem] = useState()\n\n  // This custom hook is heavily debounced\n  const { filteredClusteredData } = useClusteredData(\n    seriesList || [],\n    mapViewObj.filterBounds,\n    currentZoom,\n    mapViewObj.viewport,\n    SIZESCALE,\n    queryVersion\n  )\n\n  // If we're coming back to the map with something aleady selected then we need to\n  // reselect the series we had before\n  useEffect(() => {\n    if (!activeSeries || !seriesList || selectedItem) return\n    try {\n      const selected = seriesList.find(s => s.id === activeSeries)\n      // if (selected && homeMapContainerRef.current) setSelectedItem(selected)\n      if (selected && selected.coords) {\n        const bufferPts = buffer(point(selected.coords), 10, { units: 'meters' })\n        const bounds = bbox(bufferPts)\n        console.log('DEBUG', { bufferPts, bounds })\n        setMapViewObj({ ...mapViewObj, bounds })\n      }\n    }\n    catch (e) {\n      console.error(e)\n    }\n  }, [seriesList])\n  // Once we have the zoom in place we might need to select an initial series\n  useEffect(() => {\n    if (!activeSeries || !filteredClusteredData.single || selectedItem) return\n    try {\n      const selected = filteredClusteredData.single.find(s => s.properties.id === activeSeries)\n      if (selected && homeMapContainerRef.current) setSelectedItem(selected)\n    }\n    catch (e) {\n      console.error(e)\n    }\n  }, [filteredClusteredData.single])\n\n  const saveMap = useCallback(debounce(() => {\n    const { latitude, longitude, zoom, bearing, pitch, altitude } = mapViewRef.current ? mapViewRef.current : mapViewObj.viewport\n    setTimeout(() => pushMapHistory({\n      ...initViewport,\n      viewport: { latitude, longitude, zoom, bearing, pitch, altitude }\n    }), 2000)\n  }, 2000, true))\n\n  const updateSelectedItem = (item) => {\n    // regardless, set the map selected Item\n    setSelectedItem(item)\n    if (item && item.properties && item.properties.count === 1) {\n      setActiveSeries(item.properties.id)\n    }\n    saveMap()\n  }\n\n  const onZoomTo = (object) => {\n    try {\n      const pts = featureCollection(object.properties.points)\n      const bufferPts = buffer(pts, 100, { units: 'meters' })\n      const bounds = bbox(bufferPts)\n      // buffer a further 10%\n      const lngBuff = (bounds[2] - bounds[0]) * 0.2\n      const latBuff = (bounds[3] - bounds[1]) * 0.2\n      const buffBounds = [\n        bounds[0] - lngBuff,\n        bounds[1] - latBuff,\n        bounds[2] + lngBuff,\n        bounds[3] + latBuff\n      ]\n\n      setTransitions({\n        transitionDuration: 2000,\n        transitionInterpolator: new FlyToInterpolator(),\n        transitionEasing: easeCubic\n      })\n      setMapViewObj({ ...mapViewObj, bounds: buffBounds })\n      if (object.properties.count > 1) setTimeout(() => updateSelectedItem(null), 2000)\n    }\n    catch (e) {\n      console.error(e)\n    }\n  }\n\n  const onViewportChange = ({ viewport, map }) => {\n    mapViewRef.current = viewport\n    // mapViewObj\n    // {\n    //   \"_sw\": {\n    //     \"lng\": -120.40788003760076,\n    //     \"lat\": 44.609051464438835\n    //   },\n    //   \"_ne\": {\n    //     \"lng\": -120.25887796240545,\n    //     \"lat\": 44.65034319161438\n    //   }\n    // minX, minY, maxX, maxY\n    // [W-122.87948116236043, S26.15346805640254, E-82.00799782432676, N47.3795453070757]\n    const viewZoom = Math.floor(viewport.zoom)\n    if (!isTransitioning && map && map.getBounds) {\n      // console.log('onViewportChange', isTransitioning)\n      const { _sw: { lng: minLng, lat: minLat }, _ne: { lng: maxLng, lat: maxLat } } = map.getBounds()\n      const [oldMinLng, oldMinLat, oldMaxLng, oldMaxLat] = mapViewObj.filterBounds || [minLng, minLat, maxLng, maxLat]\n      if (viewZoom !== currentZoom ||\n        oldMinLng >= minLng || oldMinLat >= minLat ||\n        oldMaxLng <= maxLng || oldMaxLat <= maxLat\n      ) {\n        // console.log('RECALCING filterBounds')\n        const filterBounds = [\n          minLng - (maxLng - minLng) / 2,\n          minLat - (maxLat - minLat) / 2,\n          maxLng + (maxLng - minLng) / 2,\n          maxLat + (maxLat - minLat) / 2\n        ]\n        setMapViewObj({ ...mapViewObj, filterBounds })\n      }\n    }\n    if (viewZoom !== currentZoom) {\n      setCurrentZoom(viewZoom)\n    }\n  }\n  // Debounce this to improve performance\n  // const onViewportChangeDebounced = useCallback(debounce(onViewportChange, 300), [])\n\n  const lock = {}\n\n  const onMarkerClick = (obj) => {\n    // Second click zooms\n    if (selectedItem && selectedItem.properties.id === obj.properties.id) {\n      // console.log('onMarkerClick SECOND CLICK')\n      onZoomTo(selectedItem)\n    }\n    else {\n      // console.log('onMarkerClick First click')\n      setTransitions({\n        transitionDuration: 500,\n        transitionInterpolator: new LinearInterpolator(),\n        transitionEasing: easeCubic\n      })\n      setMapViewObj({\n        viewport: {\n          longitude: obj.geometry.coordinates[0],\n          latitude: obj.geometry.coordinates[1]\n        }\n      })\n    }\n    updateSelectedItem(obj)\n  }\n\n  // This one should be debounced by filteredClusteredData\n  const markersRendered = useMemo(() => ([\n    ...filteredClusteredData.single.map(obj => (\n      <Marker\n        className={'singleMarker'}\n        key={`single-${obj.properties.id}`}\n        latitude={obj.geometry.coordinates[1]}\n        longitude={obj.geometry.coordinates[0]}\n        offsetLeft={0}\n        offsetTop={-20}\n      >\n        <SingleMarker name={obj.properties.name}\n          access={obj.properties.access}\n          photoCount={obj.properties.photoCount}\n          onClick={() => onMarkerClick(obj)}\n          direction={currentZoom > 10 && obj.properties.direction ? obj.properties.direction : null}\n          active={selectedItem && selectedItem.properties.id === obj.properties.id}\n        />\n      </Marker>\n    )),\n    ...filteredClusteredData.cluster.map(obj => (\n      <Marker\n        className='clusterMarker'\n        key={`cluster-${obj.properties.id}`}\n        latitude={obj.geometry.coordinates[1]}\n        longitude={obj.geometry.coordinates[0]}\n        offsetLeft={-20}\n        offsetTop={-20}\n      >\n        <ClusterMarker\n          seriesCount={obj.properties.count}\n          photoCount={obj.properties.reducedPhotoCount}\n          onClick={() => onMarkerClick(obj)}\n          active={\n            selectedItem &&\n            selectedItem.properties.id === obj.properties.id &&\n            selectedItem.properties.count === obj.properties.count\n          }\n        />\n      </Marker>\n    ))\n  ]), [filteredClusteredData, selectedItem])\n\n  const selectedItemRender = useMemo(() => !!selectedItem && (\n    <Paper className={classes.selectedPopup}>\n      {selectedItem.properties.count === 1\n        ? <SeriesListItem\n          loading={loading.selectedSeries}\n          series={selectedItem.properties}\n          onClick={() => onSeriesClick(selectedItem.properties.id)}\n        />\n        : <ClusterSelected\n          seriesCount={selectedItem.properties.count}\n          reducedPhotoCount={selectedItem.properties.reducedPhotoCount}\n          onClose={() => updateSelectedItem(null)}\n          onZoomTo={() => onZoomTo(selectedItem)}\n        />\n      }\n    </Paper>\n  ), [selectedItem])\n\n  return (\n    <div className={classes.root} ref={homeMapContainerRef}>\n      <TopBar isTransparent className={classes.topBar}>\n        <SearchInput\n          onClick={onSearchClick}\n          defaultValue={''}\n        />\n      </TopBar>\n      <BaseMap\n        showMe\n        // This should only change on INIT or transition events\n        viewport={mapViewObj.viewport}\n        transitions={transitions}\n        mapStyles={MapStyles}\n        controlPadding={{ top: 56 }}\n        initStyle={MapStyles.length > 1 ? 1 : 0}\n        {...lock}\n        onTransitionStart={() => {\n          // console.log('handletransitionStart')\n          setIsTransitioning(true)\n        }}\n        onTransitionEnd={() => {\n          // console.log('handletransitionEnd')\n          setIsTransitioning(false)\n          setTransitions(null)\n        }}\n        bounds={mapViewObj.bounds}\n        maxZoom={20}\n        minZoom={1}\n        onViewportChange={onViewportChange}\n        onNativeClick={() => {\n          if (selectedItem) updateSelectedItem(null)\n        }}\n      >\n        {markersRendered}\n      </BaseMap>\n\n      {selectedItemRender}\n    </div>\n  )\n}\n\nHomeMap.propTypes = {\n  seriesList: PropTypes.array,\n  queryVersion: PropTypes.number,\n  activeSeries: PropTypes.string,\n  initViewport: PropTypes.object,\n  loading: PropTypes.object,\n  // These all get loaded up through mapFuncs in HomeMap.connect\n  onSearchClick: PropTypes.func,\n  setActiveSeries: PropTypes.func,\n  onSeriesClick: PropTypes.func,\n  popMapHistory: PropTypes.func,\n  pushMapHistory: PropTypes.func,\n  clearMapHistory: PropTypes.func\n}\n\nexport default HomeMap\n\n// function getInitialState (initViewport) {\n//   return {\n//     viewport: { ...defaultView, ...initViewport.viewport },\n//     bounds: initViewport.bounds,\n//     filterBounds: null\n//   }\n// }\n","import React, { useEffect, useState, useRef, useMemo } from 'react'\nimport PropTypes from 'prop-types'\nimport { connect } from 'react-redux'\nimport { graphql } from 'react-apollo'\nimport { allSeries, pollQuery } from './queries'\nimport actions from '../redux/actions'\nimport { home } from '../config'\nimport HomeMap from '../components/maps/HomeMap'\n\nconst POLL_INTERVAL = 5 // (seconds)\n\n/**\n * The outer component handles the lastCheck variable which, when changed will\n * cause the poll event\n */\nconst HomeMapConnector = ({ initViewport, activeSeries, mapFuncs }) => {\n  const [seriesProps, setSeriesProps] = useState()\n  const [queryVersion, setVersion] = useState(0)\n  const updateIncrement = () => setVersion(queryVersion + 1)\n  const timerRef = useRef()\n  const [lastCheck, setLastCheck] = useState(null)\n  timerRef.current = lastCheck\n\n  // These are expensive queries so we render them memoized to prevent erroneous re-renders\n  const allSeriesQUERY = useMemo(() => <AllSeriesConnect setSeriesProps={setSeriesProps} />, [])\n  const pollSeriesQUERY = useMemo(() => <PollQueryConnect lastCheck={lastCheck} seriesProps={seriesProps} updateIncrement={updateIncrement} />, [lastCheck])\n\n  // Initiate the polling process. We simply update the timestamp every N seconds\n  useEffect(() => {\n    if (!seriesProps) return\n    function ping () {\n      if (timerRef.current) setLastCheck(String(Date.now() - POLL_INTERVAL * 1000))\n    }\n    if (!timerRef.current && seriesProps.readyForPolling) timerRef.current = setInterval(ping, POLL_INTERVAL * 1000)\n    return () => {\n      if (timerRef.current) {\n        console.log('clear poll timer')\n        clearInterval(timerRef.current)\n        timerRef.current = null\n      }\n    }\n  }, [seriesProps])\n\n  return (\n    <React.Fragment>\n      {allSeriesQUERY}\n      {pollSeriesQUERY}\n      <HomeMap\n        queryVersion={queryVersion}\n        seriesList={seriesProps && seriesProps.allSeries ? seriesProps.allSeries.seriesSummaries : []}\n        activeSeries={activeSeries}\n        initViewport={initViewport}\n        loading={{\n        }}\n        {...mapFuncs}\n      />\n    </React.Fragment>\n  )\n}\nHomeMapConnector.propTypes = {\n  activeSeries: PropTypes.string, // from redux\n  initViewport: PropTypes.object, // from redux\n  mapFuncs: PropTypes.object // from redux passed straight through to the map\n\n}\n\nconst withAllSeries = graphql(allSeries, {\n  props: ({ data, ownProps }) => {\n    // If there's more data to load we should go get another batch\n    if (!data.loading && !data.error && data.allSeries && data.allSeries.seriesSummaries.length > 0 && data.allSeries.nextToken) {\n      data.fetchMore({\n        variables: { ...data.variables, nextToken: data.allSeries.nextToken },\n        // How do we mush the new query with the old one\n        updateQuery: (prev, { fetchMoreResult }) => {\n          return {\n            allSeries: {\n              ...fetchMoreResult.allSeries,\n              seriesSummaries: [ ...prev.allSeries.seriesSummaries, ...fetchMoreResult.allSeries.seriesSummaries ]\n            }\n          }\n        }\n      })\n    }\n    else if (data.loading || data.error) {\n      ownProps.setSeriesProps(data)\n    }\n    else {\n      ownProps.setSeriesProps({ ...data, readyForPolling: true })\n    }\n    return null\n  },\n  options: {\n    variables: { limit: 100 }\n  }\n})\n\n/**\n * Here's the graphql HOC that gets an individual series\n */\nconst withPollQuery = graphql(pollQuery, {\n  skip: ({ lastCheck }) => !lastCheck,\n  props: ({ data, ownProps: { seriesProps, updateIncrement } }) => {\n    if (data.error) {\n      console.log('POLL FAIL', data.error, data)\n      console.error(data.error)\n    }\n    if (!data.loading && data.changedSeries && data.changedSeries.seriesSummaries) {\n      // console.log('POLLING', { data, seriesProps })\n      const newData = data.changedSeries.seriesSummaries\n      const oldList = seriesProps.allSeries.seriesSummaries\n\n      // If the polling has begun and we have some good polling data back then\n      // Process it and decide if we need to incorporate it\n      if (data.changedSeries) {\n        let newSeriesSummaries = seriesProps.allSeries.seriesSummaries\n        newData.forEach(({ seriesStatus, ...polledSeries }) => {\n          if (seriesStatus === 'deleted') {\n            console.log('Polling found a series to delete: ', polledSeries.id)\n            newSeriesSummaries = oldList.filter(s => s.id !== polledSeries.id)\n          }\n          else {\n            const idx = oldList.findIndex(ds => ds.id === polledSeries.id)\n            if (idx >= 0) {\n              console.log('Polling found a series to Update: ', polledSeries.id)\n              newSeriesSummaries = oldList.map((oldSeries, oldId) => oldId === idx ? polledSeries : oldSeries)\n            }\n            else {\n              console.log('Polling found a series to add: ', polledSeries.id)\n              newSeriesSummaries = [...oldList, polledSeries]\n            }\n          }\n          seriesProps.updateQuery((data, options) => {\n            try {\n              const newData = { ...data }\n              newData.allSeries.seriesSummaries = newSeriesSummaries\n              updateIncrement()\n              return data\n            }\n            catch (e) {\n              console.error(e)\n              return data\n            }\n          })\n        })\n      }\n    }\n    return null\n  },\n  options: ({ lastCheck }) => ({\n    variables: {\n      limit: 100,\n      lastCheck\n    }\n  })\n})\n\n// We're using graphql() HOC because it's convenient but it doesn't need to render anything\nconst AllSeriesConnect = withAllSeries(() => null)\nconst PollQueryConnect = withPollQuery(() => null)\n\n// The only part of the state the main view caes about is teh window\nconst mapStateToProps = (state, props) => {\n  const { current: { activeSeries } } = state.home\n  const initViewport = state.map.slice(-1).pop()\n  return { activeSeries, initViewport }\n}\n\n// There are a few presentational actions the main window can use\nconst mapDispatchToProps = dispatch => ({\n  mapFuncs: {\n    setActiveSeries: (seriesId) => {\n      dispatch(actions.setActiveSeries(seriesId))\n    },\n    onSeriesClick: () => {\n      dispatch(actions.setHomeState(home.AppStateTypes.SERIES))\n    },\n    onSearchClick: () => {\n      dispatch(actions.setHomeState(home.AppStateTypes.SEARCH, { search: { tab: home.SEARCH_TABS.LOCATION, text: '' } }))\n    },\n    popMapHistory: () => {\n      dispatch(actions.popMapHistory())\n    },\n    pushMapHistory: (viewportSave) => {\n      dispatch(actions.pushMapHistory(viewportSave))\n    },\n    clearMapHistory: () => {\n      dispatch(actions.clearMapHistory())\n    }\n  }\n})\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(HomeMapConnector)\n","import React from 'react'\nimport classNames from 'classnames'\nimport PropTypes from 'prop-types'\nimport List from '@material-ui/core/List'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemAvatar from '@material-ui/core/ListItemAvatar'\nimport ListItemText from '@material-ui/core/ListItemText'\nimport ListItemIcon from '@material-ui/core/ListItemIcon'\nimport IconButton from '@material-ui/core/IconButton'\nimport Avatar from '@material-ui/core/Avatar'\n\nimport PlaceIcon from '@material-ui/icons/Place'\nimport PersonIcon from '@material-ui/icons/Person'\nimport LabelIcon from '@material-ui/icons/Label'\nimport CancelIcon from '@material-ui/icons/Cancel'\n\nimport { makeStyles } from '@material-ui/core/styles'\nconst useStyles = makeStyles(theme => ({\n  root: {\n\n  },\n  chosenItem: {\n    background: theme.palette.grey[300]\n  },\n  avatar: {\n\n  },\n  avatarImg: {\n    height: '100%',\n    width: '100%',\n    objectFit: 'cover'\n  }\n}))\n\nconst SearchContextItem = ({ className, variant, name, description, gravatar, onClick, onCancel }) => {\n  const classes = useStyles()\n  let TheIcon = PlaceIcon\n\n  const getAvatar = (src) => () => (\n    <Avatar className={classes.avatar}>\n      <img className={classes.avatarImg} alt='profile' src={src} />\n    </Avatar>\n  )\n\n  switch (variant) {\n    case 'tag':\n      TheIcon = LabelIcon\n      break\n    case 'location':\n      TheIcon = PlaceIcon\n      break\n    case 'user':\n      TheIcon = gravatar ? getAvatar(gravatar) : PersonIcon\n      break\n    default:\n      break\n  }\n  return (\n    <ListItem\n      className={classNames(className, classes.root, onCancel ? classes.chosenItem : null)}\n      elevation={1}\n      button={!!onClick}\n      onClick={onClick}\n    >\n      <ListItemAvatar>\n        <Avatar>\n          <TheIcon />\n        </Avatar>\n      </ListItemAvatar>\n      <ListItemText primary={name} secondary={description} />\n      {onCancel && (\n        <ListItemIcon>\n          <IconButton onClick={onCancel}>\n            <CancelIcon />\n          </IconButton>\n        </ListItemIcon>\n      )}\n    </ListItem>\n  )\n}\n\nSearchContextItem.propTypes = {\n  variant: PropTypes.oneOf(['tag', 'location', 'user']),\n  onClick: PropTypes.func,\n  gravatar: PropTypes.string,\n  className: PropTypes.string,\n  name: PropTypes.string.isRequired,\n  description: PropTypes.string,\n  onCancel: PropTypes.func\n}\n\nexport default SearchContextItem\n\nexport const SearchContexItemCosmos = () => {\n  return (\n    <List>\n      <SearchContextItem variant='tag' name='SomeTag' description='Some description of what I am' />\n      <SearchContextItem variant='location' name='Some Location' description='Some description of what I am' />\n      <SearchContextItem variant='user' name='User McUserSon' description='Some description of what I am' />\n    </List>\n  )\n}\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport List from '@material-ui/core/List'\nimport Typography from '@material-ui/core/Typography'\n\nimport SearchContextItem from './SearchContextItem'\n// import MenuIcon from '@material-ui/icons/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    width: '100%',\n    backgroundColor: theme.palette.background.paper,\n    position: 'relative',\n    overflow: 'auto'\n  },\n  listSection: {\n    backgroundColor: 'inherit'\n  },\n  placeholderText: {\n    textAlign: 'center',\n    padding: theme.spacing(3, 1),\n    color: theme.palette.grey[400]\n  },\n  ul: {\n    backgroundColor: 'inherit',\n    padding: 0\n  }\n}))\n\nconst SearchContextResults = ({ variant, loading, contextResults, setContextChoice }) => {\n  const classes = useStyles()\n  if (loading) {\n    return <Typography className={classes.placeholderText} variant='h3'>Searching...</Typography>\n  }\n  else if (!contextResults || contextResults.length === 0) {\n    return <Typography className={classes.placeholderText} variant='h4'>No {variant} results</Typography>\n  }\n\n  return (\n    <List className={classes.root}>\n      {contextResults.map((cr, idx) => (\n        <SearchContextItem\n          key={`scr-${idx}`}\n          variant={variant}\n          onClick={() => setContextChoice(cr)}\n          {...cr}\n        />\n      ))}\n    </List>\n  )\n}\n\nSearchContextResults.propTypes = {\n  variant: PropTypes.oneOf(['tag', 'location', 'user']),\n  loading: PropTypes.bool,\n  contextResults: PropTypes.array.isRequired,\n  setContextChoice: PropTypes.func.isRequired\n}\n\nexport default SearchContextResults\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\n// import MenuIcon from '@material-ui/icons/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nconst useStyles = makeStyles(theme => ({\n  root: {\n    textAlign: 'center',\n    fontStyle: 'italic',\n    padding: theme.spacing(2, 1)\n  }\n}))\n\nconst SearchEnder = ({ style, icon, text }) => {\n  const classes = useStyles()\n  return (\n    <Typography className={classes.root} variant='subtitle1' color='textSecondary' component='div' style={style}>\n      {icon}\n      {text}\n    </Typography>\n  )\n}\n\nSearchEnder.propTypes = {\n  style: PropTypes.object,\n  icon: PropTypes.any,\n  text: PropTypes.string\n}\n\nexport default SearchEnder\n","import React, { useRef, useEffect } from 'react'\nimport PropTypes from 'prop-types'\nimport List from '@material-ui/core/List'\nimport Typography from '@material-ui/core/Typography'\n\nimport SearchContextItem from './SearchContextItem'\nimport SearchEnder from './SearchEnder'\n// import MenuIcon from '@material-ui/icons/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nimport SeriesListItem from '../misc/SeriesListItem'\nimport { debounce } from '../../lib/util'\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    height: '100%',\n    display: 'flex',\n    flexDirection: 'column',\n    overflow: 'hidden'\n  },\n  ctxItem: {\n    flexGrow: 0\n  },\n  list: {\n    flexGrow: 1,\n    backgroundColor: theme.palette.background.paper,\n    position: 'relative',\n    overflowX: 'hidden',\n    overflowY: 'scroll'\n  },\n  placeholderText: {\n    textAlign: 'center',\n    padding: theme.spacing(3, 1),\n    color: theme.palette.grey[400]\n  },\n  listSection: {\n    backgroundColor: 'inherit'\n  },\n  ul: {\n    backgroundColor: 'inherit',\n    padding: 0\n  }\n}))\n\nconst SearchResults = ({ variant, loading, seriesList, contextChoice, onCancel, onResultClick, fetchMore }) => {\n  const classes = useStyles()\n  const listRef = useRef()\n  const enderRef = useRef()\n\n  const handleScroll = debounce(() => {\n    if (!loading && fetchMore && enderRef.current && listRef.current) {\n      const { offsetTop } = enderRef.current\n      const { scrollTop, offsetHeight } = listRef.current\n      const scrollBottom = offsetHeight + scrollTop\n      if (offsetTop < scrollBottom * 2) {\n        console.log('SCROLL', { offsetHeight, scrollTop, offsetTop })\n        fetchMore()\n      }\n    }\n  }, 500)\n\n  useEffect(handleScroll, [seriesList])\n\n  let content = null\n  if (loading) {\n    content = (\n      <Typography className={classes.placeholderText} variant='h3'>Searching...</Typography>\n    )\n  }\n  else if (seriesList && seriesList.length > 0) {\n    content = seriesList.map((series, idx) => (\n      <SeriesListItem\n        key={`series-${idx}`}\n        series={series}\n        onClick={() => onResultClick(series.id)}\n        showCreatedOn\n        showLastPhoto\n      />\n    ))\n    content.push(\n      <div key='ender' ref={enderRef}>\n        <SearchEnder text={fetchMore ? 'Loading...' : 'No More Results'} />\n      </div>\n    )\n  }\n  else {\n    content = (\n      <Typography className={classes.placeholderText} variant='h4'>No series found</Typography>\n    )\n  }\n\n  return (\n    <div className={classes.root}>\n      <SearchContextItem className={classes.ctxItem} {...contextChoice} variant={variant} onCancel={onCancel} />\n      <List className={classes.list} subheader={<li />} onScroll={handleScroll} innerRef={listRef}>\n        {content}\n      </List>\n    </div>\n  )\n}\n\nSearchResults.propTypes = {\n  variant: PropTypes.oneOf(['tag', 'location', 'user']),\n  seriesList: PropTypes.array.isRequired,\n  loading: PropTypes.bool,\n  contextChoice: PropTypes.object.isRequired,\n  onResultClick: PropTypes.func.isRequired,\n  onCancel: PropTypes.func.isRequired,\n  fetchMore: PropTypes.func\n}\n\nexport default SearchResults\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\nimport Typography from '@material-ui/core/Typography'\n// import MenuIcon from '@material-ui/icons/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nconst useStyles = makeStyles(theme => ({\n  root: {\n    flexGrow: 1,\n    padding: '10%',\n    display: 'flex',\n    flexDirection: 'column',\n    opacity: 0.3,\n    textAlign: 'center'\n  },\n  icon: {\n    width: '100%',\n    flex: '1 1 40%',\n    color: theme.palette.primary.light,\n    opacity: 0.5\n  },\n  primary: {\n    flex: '1 1 30%',\n    width: '100%'\n  },\n  secondary: {\n    flex: '1 1 30%',\n    width: '100%'\n  }\n}))\n\nconst SearchPlaceholder = ({ icon, primary, secondary }) => {\n  const classes = useStyles()\n  const PlaceholderIcon = icon\n  return (\n    <div className={classes.root}>\n      <PlaceholderIcon className={classes.icon} />\n      {primary && (\n        <Typography className={classes.primary} variant='h3'>\n          {primary}\n        </Typography>\n      )}\n      {secondary && (\n        <Typography className={classes.secondary} variant='h4'>\n          {secondary}\n        </Typography>\n      )}\n    </div>\n  )\n}\n\nSearchPlaceholder.propTypes = {\n  icon: PropTypes.object,\n  primary: PropTypes.string,\n  secondary: PropTypes.string\n}\n\nexport default SearchPlaceholder\n","import { useEffect, useState } from 'react'\n\nconst useOnline = () => {\n  const [state, setState] = useState(null)\n\n  const setOnline = () => {\n    console.log('ONLINE')\n    setState(null)\n  }\n  const setOffline = () => {\n    console.log('OFFLINE')\n    const newDate = Date.now()\n    setState(newDate)\n  }\n\n  useEffect(() => {\n    window.addEventListener('online', setOnline)\n    window.addEventListener('offline', setOffline)\n\n    return () => {\n      window.removeEventListener('online', setOnline)\n      window.removeEventListener('offline', setOffline)\n    }\n  }, [])\n\n  return {\n    online: state === null,\n    since: state\n  }\n}\n\nexport default useOnline\n","import React, { useEffect } from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport Tabs from '@material-ui/core/Tabs'\nimport Tab from '@material-ui/core/Tab'\n\nimport SearchContextResults from './SearchContextResults'\nimport SearchResults from './SearchResults'\nimport SearchPlaceholder from './SearchPlaceholder'\nimport TopBar from '../TopBar'\nimport SearchInput from './SearchInput'\nimport useOnline from '../../lib/useOnline'\nimport { home } from '../../config'\nimport PortableWifiOffIcon from '@material-ui/icons/PortableWifiOff'\nimport LabelIcon from '@material-ui/icons/Label'\nimport PlaceIcon from '@material-ui/icons/Place'\nimport PersonIcon from '@material-ui/icons/Person'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst TABS = home.SEARCH_TABS\n\nconst style = theme => ({\n  root: {\n    height: '100%',\n    display: 'flex',\n    overflow: 'hidden',\n    flexDirection: 'column'\n  },\n  tabs: {\n  },\n  tab: {\n    flexGrow: 1\n  },\n  grow: {\n    flexGrow: 1\n  }\n})\n\nconst useStyles = makeStyles(style)\n\nconst Search = ({\n  onMenuBack, currentTab, setCurrentTab, defaultText, searchText,\n  setSearchText, contextResults, searchResults, contextChoice,\n  loading, setContextChoice, onMapClick, onResultClick, fetchMore\n}) => {\n  const classes = useStyles()\n\n  const { online } = useOnline()\n\n  // If there's only one thing then use it\n  useEffect(() => {\n    if (contextResults && !searchResults && contextResults.length === 1) {\n      setContextChoice(contextResults[0])\n    }\n  }, [contextResults])\n\n  // TODO: How to get from search results back to context results?\n  let placeholder = {}\n  switch (currentTab) {\n    case TABS.TAG:\n      placeholder = { primary: 'Tag search', secondary: 'example: \\'beaver...\\'', icon: LabelIcon }\n      break\n    case TABS.USER:\n      placeholder = { primary: 'User search', secondary: 'example: \\'SuperGreg123...\\'', icon: PersonIcon }\n      break\n    case TABS.LOCATION:\n      placeholder = { primary: 'Location Search', secondary: 'example: \\'Vancouver...\\'', icon: PlaceIcon }\n      break\n\n    default:\n      break\n  }\n\n  let content = null\n  if (!online) {\n    content = (\n      <SearchPlaceholder\n        primary='Search Disabled'\n        secondary='(Offline)'\n        icon={PortableWifiOffIcon}\n      />\n    )\n  }\n  else if (contextChoice && searchResults) {\n    content = (\n      <SearchResults\n        variant={currentTab}\n        loading={loading}\n        onResultClick={onResultClick}\n        fetchMore={fetchMore}\n        seriesList={searchResults}\n        contextChoice={contextChoice}\n        onCancel={() => setContextChoice(null)}\n      />\n    )\n  }\n  else if (contextResults) {\n    content = (\n      <SearchContextResults\n        loading={loading}\n        variant={currentTab}\n        contextResults={contextResults}\n        setContextChoice={currentTab === TABS.LOCATION ? onMapClick : setContextChoice}\n      />\n    )\n  }\n  else if (defaultText.length > 0) {\n    content = (\n      <Typography>Searching for {`'${searchText}'` || '...'}</Typography>\n    )\n  }\n  else {\n    content = <SearchPlaceholder {...placeholder} />\n  }\n\n  return (\n    <div className={classes.root}>\n      <TopBar>\n        <SearchInput\n          disabled={!online}\n          autoFocus\n          onChange={setSearchText}\n          defaultValue={searchText}\n        />\n      </TopBar>\n      {online && (\n        <Tabs\n          value={currentTab}\n          disabled={!online}\n          onChange={(e, val) => setCurrentTab(val)}\n          indicatorColor='primary'\n          textColor='primary'\n          classes={{ flexContainer: classes.tabs }}\n          centered\n        >\n          <Tab className={classes.tab} value={TABS.TAG} label='Tags' />\n          <Tab className={classes.tab} value={TABS.LOCATION} label='Places' />\n          <Tab className={classes.tab} value={TABS.USER} label='Users' />\n        </Tabs>\n      )}\n      {content}\n    </div>\n  )\n}\n\nSearch.propTypes = {\n  onMenuBack: PropTypes.func.isRequired,\n  loading: PropTypes.bool,\n  currentTab: PropTypes.string.isRequired,\n  setCurrentTab: PropTypes.func.isRequired,\n  searchText: PropTypes.string.isRequired,\n  setSearchText: PropTypes.func.isRequired,\n  fetchMore: PropTypes.func,\n  contextResults: PropTypes.array,\n  searchResults: PropTypes.array,\n  contextChoice: PropTypes.object,\n  setContextChoice: PropTypes.func.isRequired,\n  onMapClick: PropTypes.func.isRequired,\n  onResultClick: PropTypes.func.isRequired\n}\nSearch.defaultProps = {\n  currentTab: TABS.TAGS,\n  defaultText: ''\n}\n\nexport default Search\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\nimport { home } from '../config'\n// import { smallestHash } from 'geotilehash'\nimport { graphql, compose } from 'react-apollo'\nimport { point, bbox as bboxFunc, buffer } from '@turf/turf'\n\nimport { connect } from 'react-redux'\nimport actions from '../redux/actions'\nimport { tagSearch, seriesWithTag, userSearch, userSeries, geocode } from './queries'\nimport Search from '../components/Search/Search'\n// import { AppContext } from '../contexts'\n// import { debounce } from '../lib/util'\nimport { formatDatAgo } from '../lib/datelib'\n\nconst SearchConnect = ({\n  jumpToMap, jumpToSeries, defaultTab, defaultText, fetchMore\n}) => {\n  // const { role, user } = useContext(AppContext)\n\n  const [currentTab, setCurrentTab] = useState(defaultTab || home.SEARCH_TABS.TAG)\n  // We separate these because one of them needs to be immediate and the\n  const [searchText, setSearchText] = useState(defaultText || '')\n  const [contextChoice, setContextChoice] = useState(null)\n\n  const handleTabChange = (newTab) => {\n    setContextChoice(null)\n    setCurrentTab(newTab)\n  }\n  const handleContextChoiceChange = (newContextChoice) => {\n    setContextChoice(newContextChoice)\n  }\n  const handleSearchTextChange = (text) => {\n    setSearchText(text)\n    setContextChoice(null)\n  }\n\n  let withContextQuery = null\n  let withSearchQuery = null\n\n  switch (currentTab) {\n    case home.SEARCH_TABS.TAG:\n      withContextQuery = withTagSearch\n      withSearchQuery = withTagSeries\n      break\n    case home.SEARCH_TABS.LOCATION:\n      withContextQuery = withGeoCode\n      // withSearchQuery = withGeoSearch\n      break\n    case home.SEARCH_TABS.USER:\n      withContextQuery = withUserSearch\n      withSearchQuery = withUserSeries\n      break\n    default:\n      break\n  }\n\n  const ComposedSearch = withSearchQuery\n    ? compose(\n      withContextQuery,\n      withSearchQuery\n    )(Search)\n    : withContextQuery(Search)\n\n  return <ComposedSearch {...{ currentTab, searchText, contextChoice }}\n    onMenuBack={() => {}}\n    onMapClick={jumpToMap}\n    onResultClick={jumpToSeries}\n    setContextChoice={handleContextChoiceChange}\n    fetchMore={fetchMore}\n    setCurrentTab={handleTabChange}\n    setSearchText={handleSearchTextChange}\n  />\n}\nSearchConnect.propTypes = {\n  searchResults: PropTypes.array,\n  contextResults: PropTypes.array,\n  loading: PropTypes.bool,\n  jumpToMap: PropTypes.func,\n  jumpToSeries: PropTypes.func,\n  fetchMore: PropTypes.func\n}\n/*****************************************************************\n *  PART 1: SEARCH QUERIES\n *****************************************************************/\n\n/**\n * Here's the graphql HOC that gets an individual series\n */\nconst withTagSearch = graphql(tagSearch, {\n  props: ({ data }) => {\n    if (data.error) console.error(data.error)\n    // console.log('withTagSearch', data)\n    let series = null\n    try {\n      if (!data.loading && !data.error) series = data.series\n    }\n    catch (e) {\n      console.error(data)\n      console.error(e)\n    }\n    const contextResults = data.tags ? data.tags.map(({ name, count }) => ({\n      name, description: `~ ${Math.ceil(count / 10) * 10} Photo series tagged`\n    })) : []\n\n    return {\n      contextResults,\n      loading: data.loading,\n      series\n    }\n  },\n  // skip: ({ searchText }) => !searchText || searchText.length < 3,\n  options: ({ searchText }) => ({\n    variables: {\n      tag: !searchText || searchText.length < 3 ? '' : searchText,\n      limit: 10\n    }\n  })\n})\n\nconst withUserSearch = graphql(userSearch, {\n  props: ({ data }) => {\n    if (data.error) console.error(data.error)\n    // console.log('withUserSearch', data)\n    let series = null\n    try {\n      if (!data.loading && !data.error) series = data.series\n    }\n    catch (e) {\n      console.error(data)\n      console.error(e)\n    }\n\n    const contextResults = data.userSearch ? data.userSearch.map(({ username, gravatar, createdOn, id }) => ({\n      name: username,\n      id,\n      description: `Joined ${formatDatAgo(createdOn)}`,\n      gravatar\n    })) : []\n\n    return {\n      contextResults,\n      loading: data.loading,\n      series\n    }\n  },\n  skip: ({ searchText }) => !searchText || searchText.length < 3,\n  options: ({ searchText }) => ({\n    variables: {\n      searchStr: searchText,\n      limit: 10\n    }\n  })\n})\n\nconst withGeoCode = graphql(geocode, {\n  props: ({ data }) => {\n    if (data.error) console.error(data.error)\n    // console.log('withGeoCode', data)\n    let series = null\n    try {\n      if (!data.loading && !data.error) series = data.series\n    }\n    catch (e) {\n      console.error(data)\n      console.error(e)\n    }\n\n    const contextResults = data.geocoder ? data.geocoder.map(({ relevance, text, placeName, bbox, center }) => ({\n      name: text,\n      description: placeName,\n      bbox,\n      center,\n      relevance\n    })) : []\n\n    return {\n      contextResults,\n      loading: data.loading,\n      series\n    }\n  },\n  skip: ({ searchText }) => !searchText || searchText.length < 3,\n  options: ({ searchText }) => ({\n    variables: {\n      search: searchText\n      // limit: 10\n    }\n  })\n})\n\n/*****************************************************************\n * PART 2: SERIES SEARCH QUERIES\n *****************************************************************/\n\nconst withTagSeries = graphql(seriesWithTag, {\n  props: ({ data }) => {\n    if (data.error) console.error(data.error)\n    // console.log('withTagSeries', data)\n    let series = null\n    try {\n      if (!data.loading && !data.error) series = data.series\n    }\n    catch (e) {\n      console.error(data)\n      console.error(e)\n    }\n\n    // A second Thunk function designed to get more elements in the feed history\n    const fetchMore = data.loading || !data.tagSeries || !data.tagSeries.nextToken ? null : () => {\n      console.log('fetchMore', data)\n      data.fetchMore({\n        variables: { ...data.variables, nextToken: data.tagSeries.nextToken },\n        // How do we mush the new query with the old one\n        updateQuery: (prev, { fetchMoreResult }) => {\n          return {\n            tagSeries: {\n              ...fetchMoreResult.tagSeries,\n              seriesSummaries: [ ...prev.tagSeries.seriesSummaries, ...fetchMoreResult.tagSeries.seriesSummaries ]\n            }\n          }\n        }\n      })\n    }\n\n    const searchResults = data.tagSeries && data.tagSeries.seriesSummaries\n      ? data.tagSeries.seriesSummaries\n      : []\n\n    return {\n      searchResults,\n      fetchMore,\n      loading: data.loading,\n      series\n    }\n  },\n  skip: ({ contextChoice }) => !contextChoice,\n  options: ({ contextChoice }) => ({\n    variables: {\n      tag: contextChoice.name,\n      limit: 10\n    }\n  })\n})\n\nconst withUserSeries = graphql(userSeries, {\n  props: ({ data }) => {\n    if (data.error) console.error(data.error)\n    // console.log('withUserSeries', data)\n    let series = null\n    try {\n      if (!data.loading && !data.error) series = data.series\n    }\n    catch (e) {\n      console.error(data)\n      console.error(e)\n    }\n\n    // A second Thunk function designed to get more elements in the feed history\n    const fetchMore = data.loading || !data.userSeries || !data.userSeries.nextToken ? null : () => {\n      console.log('fetchMore', data)\n      data.fetchMore({\n        variables: { ...data.variables, nextToken: data.userSeries.nextToken },\n        // How do we mush the new query with the old one\n        updateQuery: (prev, { fetchMoreResult }) => {\n          return {\n            userSeries: {\n              ...fetchMoreResult.userSeries,\n              seriesSummaries: [ ...prev.userSeries.seriesSummaries, ...fetchMoreResult.userSeries.seriesSummaries ]\n            }\n          }\n        }\n      })\n    }\n\n    const searchResults = data.userSeries && data.userSeries.seriesSummaries\n      ? data.userSeries.seriesSummaries\n      : []\n\n    return {\n      searchResults,\n      fetchMore,\n      loading: data.loading,\n      series\n    }\n  },\n  skip: ({ contextChoice }) => !contextChoice,\n  options: ({ contextChoice }) => ({\n    variables: {\n      createdBy: contextChoice.id,\n      limit: 10\n    }\n  })\n})\n\n// const withGeoSearch = graphql(geoSeries, {\n//   props: ({ data }) => {\n//     if (data.error) console.error(data.error)\n//     // console.log('HERE', data)\n//     let series = null\n//     try {\n//       if (!data.loading && !data.error) series = data.series\n//     }\n//     catch (e) {\n//       console.error(data)\n//       console.error(e)\n//     }\n//     return {\n//       data,\n//       loading: data.loading,\n//       series\n//     }\n//   },\n//   skip: ({ contextChoice }) => !contextChoice,\n//   options: ({ contextChoice }) => ({\n//     variables: {\n//       bounds: contextChoice.bbox\n//       // limit: 10\n//       // nextToken\n//     }\n//   })\n// })\n\n/**\n * Map our redux state and functions\n */\nconst mapStateToProps = (state, props) => {\n  const { current: { search, activeSeries, domain } } = state.home\n  return {\n    defaultTab: search ? search.tab : null,\n    defaultText: search ? search.text : null,\n    activeSeries,\n    domain\n  }\n}\n\nconst mapDispatchToProps = dispatch => ({\n  onBack: () => {\n    dispatch(actions.homeStateBack())\n  },\n  queueUpload: (uploadObj) => {\n    dispatch(actions.queueUpload(uploadObj))\n  },\n  jumpToSeries: (seriesId) => {\n    dispatch(actions.setHomeState(home.AppStateTypes.SERIES, { activeSeries: seriesId }))\n  },\n\n  jumpToMap: ({ bbox, center }) => {\n    let bounds = bbox\n    if (!bounds && center) {\n      const bufferPts = buffer(point(center), 500, { units: 'meters' })\n      bounds = bboxFunc(bufferPts)\n    }\n\n    if (bounds) {\n      dispatch(actions.pushMapHistory({\n        mode: home.MapModeTypes.FREE,\n        bounds: bounds\n      }))\n      dispatch(actions.setHomeState(home.AppStateTypes.MAP, { activeSeries: null, initialPhoto: null }))\n    }\n  }\n})\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(SearchConnect)\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemText from '@material-ui/core/ListItemText'\n// import MenuIcon from '@material-ui/icons/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { formatDate } from '../../lib/datelib'\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n\n  },\n  gravatarImg: {\n    display: 'block',\n    marginRight: theme.spacing(2),\n    width: '100%',\n    maxWidth: '25%',\n    height: 'auto'\n  }\n}))\n\nconst MeCard = ({ user, loading, onAvatarClick }) => {\n  const classes = useStyles()\n\n  if (loading || !user) return 'LOADING...'\n  console.log('USER', user)\n\n  return (\n    <ListItem className={classes.root} onClick={onAvatarClick} disableGutters>\n      <img alt='profile' className={classes.gravatarImg} src={user.gravatar} />\n      <ListItemText\n        primary={user.username}\n        secondary={`Since ${formatDate(user.createdOn)}`}\n      />\n    </ListItem>\n  )\n}\n\nMeCard.propTypes = {\n  user: PropTypes.object,\n  loading: PropTypes.bool,\n  onAvatarClick: PropTypes.func.isRequired\n}\n\nexport default MeCard\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport Divider from '@material-ui/core/Divider'\n\nimport SeriesListItem from '../misc/SeriesListItem'\nimport { makeStyles } from '@material-ui/core/styles'\nimport TopBar from '../TopBar'\nimport MeCard from './MeCard'\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    display: 'flex',\n    flexDirection: 'column',\n    height: '100%'\n  },\n  filterContainer: {\n    color: '#AAAAAA'\n  },\n  filterChip: {\n\n  },\n  seriesList: {\n    height: '100%',\n    overflowX: 'hidden',\n    overflowY: 'scroll'\n  }\n}))\n\nconst FILTERS = {\n  ALL: 'All',\n  OWN: 'Own',\n  CONTRIBUTED: 'Contributed',\n  WATCHING: 'Watching'\n}\n\nconst SORT = {\n  ACTIVITY: 'Last Photo',\n  CREATED: 'Created',\n  NAME: 'Name'\n}\n\nconst MyProfile = ({ user, feed, loading }) => {\n  const classes = useStyles()\n\n  const [filterVal, setFilter] = useState(FILTERS.ALL)\n  const [sortVal, setSort] = useState(SORT.ACTIVITY)\n  const [sortAsc, setSortAsc] = useState(true)\n\n  const sortSetter = (newSort) => {\n    if (newSort === sortVal) setSortAsc(!sortAsc)\n    else setSort(newSort)\n  }\n\n  let filteredFeed = []\n\n  switch (filterVal) {\n    case FILTERS.ALL:\n      filteredFeed = [...feed]\n      break\n    case FILTERS.OWN:\n      filteredFeed = feed.filter(fi => fi.createdUser.id === user.id)\n      break\n    case FILTERS.CONTRIBUTED:\n      filteredFeed = []\n      break\n    case FILTERS.WATCHING:\n      filteredFeed = feed.filter(fi => user.watching.indexOf(fi.id) > -1)\n      break\n    default:\n      break\n  }\n\n  switch (sortVal) {\n    case SORT.ACTIVITY:\n      if (sortAsc) filteredFeed.sort((a, b) => a.latest.takenOn - b.latest.takenOn)\n      else filteredFeed.sort((a, b) => b.latest.takenOn - a.latest.takenOn)\n      break\n    case SORT.CREATED:\n      if (sortAsc) filteredFeed.sort((a, b) => a.createdOn - b.createdOn)\n      else filteredFeed.sort((a, b) => b.createdOn - a.createdOn)\n      break\n    case SORT.NAME:\n      if (sortAsc) {\n        filteredFeed.sort((a, b) => {\n          if (a.name < b.name) {\n            return -1\n          }\n          if (a.name > b.firstname) {\n            return 1\n          }\n          return 0\n        })\n      }\n      else {\n        filteredFeed.sort((a, b) => {\n          if (b.name < a.name) {\n            return -1\n          }\n          if (b.name > a.name) {\n            return 1\n          }\n          return 0\n        })\n      }\n      break\n    default:\n      break\n  }\n\n  return (\n    <div className={classes.root}>\n      <TopBar>\n        <Typography>My Profile</Typography>\n      </TopBar>\n      <MeCard user={user} />\n      <Divider />\n      <div className={classes.filterContainer}>\n        <div>\n          <Typography component='span'>Filter: </Typography>\n          <FilterSortItem active={filterVal === FILTERS.ALL} onClick={() => setFilter(FILTERS.ALL)} label={FILTERS.ALL} />\n        |\n          <FilterSortItem active={filterVal === FILTERS.OWN} onClick={() => setFilter(FILTERS.OWN)} label={FILTERS.OWN} />\n        |\n          <FilterSortItem active={filterVal === FILTERS.CONTRIBUTED} onClick={() => setFilter(FILTERS.CONTRIBUTED)} label={FILTERS.CONTRIBUTED} />\n        |\n          <FilterSortItem active={filterVal === FILTERS.WATCHING} onClick={() => setFilter(FILTERS.WATCHING)} label={FILTERS.WATCHING} />\n\n        </div>\n        <div>\n          <Typography component='span'>Sort: </Typography>\n          <FilterSortItem asc={sortAsc} active={sortVal === SORT.NAME} onClick={() => sortSetter(SORT.NAME)} label={SORT.NAME} />\n        |\n          <FilterSortItem asc={sortAsc} active={sortVal === SORT.ACTIVITY} onClick={() => sortSetter(SORT.ACTIVITY)} label={SORT.ACTIVITY} />\n        |\n          <FilterSortItem asc={sortAsc} active={sortVal === SORT.CREATED} onClick={() => sortSetter(SORT.CREATED)} label={SORT.CREATED} />\n        </div>\n      </div>\n      <div className={classes.seriesList}>\n        {filteredFeed.map((series, idx) => (\n          <SeriesListItem\n            key={`seriesListItem${idx}`}\n            series={series}\n            showCreatedOn\n            showLastPhoto\n          />\n        ))}\n      </div>\n    </div>\n  )\n}\n\nMyProfile.propTypes = {\n  user: PropTypes.object,\n  loading: PropTypes.object.isRequired,\n  feed: PropTypes.array.isRequired\n}\n\nexport default MyProfile\n\nconst useFilterStyles = makeStyles(theme => ({\n  root: {\n    margin: theme.spacing(0, 1, 0, 1)\n  }\n}))\n\nconst FilterSortItem = ({ active, asc, onClick, label }) => {\n  const classes = useFilterStyles()\n\n  const arrow = active && typeof asc !== 'undefined'\n    ? asc === true ? '▲' : '▼'\n    : ' '\n\n  return (\n    <Typography\n      className={classes.root}\n      onClick={onClick}\n      variant='caption'\n      color={active ? 'textPrimary' : 'textSecondary'}\n    >\n      {label} {arrow}\n    </Typography>\n  )\n}\n\nFilterSortItem.propTypes = {\n  active: PropTypes.bool,\n  asc: PropTypes.bool,\n  onClick: PropTypes.func.isRequired,\n  label: PropTypes.string.isRequired\n}\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport { graphql, compose } from 'react-apollo'\n\nimport { getUser, userSeries, seriesFromList } from './queries'\nimport MyProfile from '../components/MyProfile/MyProfile'\n\nconst ProfileConnect = ({ data }) => {\n  const { userQ, seriesQ, watchedSeriesQ } = data\n  const user = userQ && userQ.user ? userQ.user : null\n\n  const seriesQArr = seriesQ && seriesQ.userSeries && seriesQ.userSeries.seriesSummaries ? seriesQ.userSeries.seriesSummaries : []\n  const watchedSeriesQArr = watchedSeriesQ && watchedSeriesQ.arraySeries ? watchedSeriesQ.arraySeries : []\n  console.log('ProfileConnect', { seriesQArr, watchedSeriesQ, watchedSeriesQArr })\n  const feed = [...seriesQArr, ...watchedSeriesQArr]\n  const loading = {\n    user: userQ.loading,\n    list: Boolean(\n      (seriesQ && seriesQ.loading) ||\n      (watchedSeriesQ && watchedSeriesQ.loading))\n  }\n\n  return <MyProfile user={user} loading={loading} feed={feed}\n  />\n}\n\nProfileConnect.propTypes = {\n  data: PropTypes.object // from graphql\n}\n\n// This one is really simple.\nconst withGetUserQuery = graphql(getUser, {\n  props: ({ data, ownProps }) => {\n    // console.log('ProfileConnect withGetUserQuery', { data, ownProps })\n    return { data: { userQ: data } }\n  }\n})\n\nconst withuserSeriesQuery = graphql(userSeries, {\n  skip: ({ data }) => !data.userQ.user,\n  props: ({ data, ownProps }) => {\n    // console.log('ProfileConnect withuserSeriesQuery', { data, ownProps })\n    return { data: { ...ownProps.data, seriesQ: data } }\n  }\n})\n\n// const withMyPhotosQuery = graphql(myPhotos)\n\nconst withMyWatchedSeriesQuery = graphql(seriesFromList, {\n  props: ({ data, ownProps }) => {\n    // console.log('ProfileConnect withMyWatchedSeriesQuery', { data, ownProps })\n    return { data: { ...ownProps.data, watchedSeriesQ: data } }\n  },\n  skip: ({ data }) => {\n    try {\n      return data.userQ.user.watching.length < 1\n    }\n    catch (e) {\n      return true\n    }\n  },\n  options: ({ data }) => {\n    return {\n      variables: { seriesList: data.userQ.user.watching }\n    }\n  }\n})\n\n/**\n * Compose all our queries together\n */\nexport default compose(\n  withGetUserQuery,\n  withuserSeriesQuery,\n  // withMyPhotosQuery,\n  withMyWatchedSeriesQuery\n)(ProfileConnect)\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\n// import MenuIcon from '@material-ui/icons/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nconst useStyles = makeStyles(theme => ({\n  root: {\n    textAlign: 'center',\n    fontStyle: 'italic',\n    padding: theme.spacing(2, 1)\n  }\n}))\n\nconst FeedEnder = ({ style, icon, text }) => {\n  const classes = useStyles()\n  return (\n    <Typography className={classes.root} variant='subtitle1' color='textSecondary' component='div' style={style}>\n      {icon}\n      {text}\n    </Typography>\n  )\n}\n\nFeedEnder.propTypes = {\n  style: PropTypes.object,\n  icon: PropTypes.any,\n  text: PropTypes.string\n}\n\nexport default FeedEnder\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Avatar from '@material-ui/core/Avatar'\nimport IconButton from '@material-ui/core/IconButton'\n\nimport PlaceIcon from '@material-ui/icons/Place'\nimport { makeStyles } from '@material-ui/core/styles'\nconst useStyles = makeStyles(theme => ({\n  root: {\n    textAlign: 'center'\n  },\n  placeAvatar: {\n    color: 'white',\n    background: theme.palette.primary.main,\n    margin: 'auto'\n  },\n  placeIcon: {\n  }\n}))\n\nconst FindOnMapButton = ({ onClick }) => {\n  const classes = useStyles()\n  return (\n    <div className={classes.root}>\n      <Avatar className={classes.placeAvatar}>\n        <IconButton color='inherit' onClick={e => {\n          e.preventDefault()\n          e.stopPropagation()\n          onClick()\n        }}>\n          <PlaceIcon color='inherit' />\n        </IconButton>\n      </Avatar>\n      {/* <Typography variant='caption' component='div'>MAP</Typography> */}\n    </div>\n  )\n}\n\nFindOnMapButton.propTypes = {\n  onClick: PropTypes.func.isRequired\n}\n\nexport default FindOnMapButton\n","import React, { useContext } from 'react'\nimport PropTypes from 'prop-types'\nimport Paper from '@material-ui/core/Paper'\nimport Typography from '@material-ui/core/Typography'\n// import MenuIcon from '@material-ui/icons/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nimport FindOnMapButton from '../misc/FindOnMapButton'\n// import StarIcon from '@material-ui/icons/Star'\n// import StarBorderIcon from '@material-ui/icons/StarBorder'\nimport { Avatar } from '@material-ui/core'\nimport { AppContext } from '../../contexts'\nimport { formatDate } from '../../lib/datelib'\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    height: '100%',\n    padding: theme.spacing(0, 0.5, 1, 0.5)\n  },\n  imgContainer: {\n    overflow: 'hidden',\n    height: '100%',\n    position: 'relative'\n  },\n  findOnMapButtonContainer: {\n    position: 'absolute',\n    opacity: 0.8,\n    bottom: theme.spacing(1),\n    right: theme.spacing(1)\n  },\n  titleContainer: {\n    background: '#444444AA',\n    color: 'white',\n    position: 'absolute',\n    alignItems: 'center',\n    display: 'flex',\n    top: 0,\n    width: '100%',\n    paddingRight: theme.spacing(1)\n  },\n  avatar: {\n    border: '1px solid white',\n    margin: theme.spacing(0, 1)\n  },\n  title: {\n    flexGrow: 1\n  },\n  img: {\n    objectFit: 'cover',\n    height: '100%',\n    width: '100%'\n  }\n  // gravatarImg: {\n  // }\n}))\n\nconst EVENT_VERBS = {\n  DELETE: 'Deleted',\n  ADD: 'Added'\n}\n\nconst FeedItem = ({ event, onMapClick, onImageClick, onProfileClick, onSeriesClick }) => {\n  const { series, photo } = event\n  // console.log('EVENT', { series, relation, photo })\n  const classes = useStyles()\n  const { seriesConfig } = useContext(AppContext)\n\n  // const isDelete = event.verb === 'ADD'\n  // const seriesWatching = user.watching && user.watching.indexOf(series.id) > -1\n\n  return (\n    <Paper className={classes.root} elevation={1}>\n      <div className={classes.imgContainer}>\n        {/* <div className={classes.imgContainer}> */}\n        <img\n          alt='medium'\n          className={classes.img}\n          src={seriesConfig.getPhotoUrl(photo, 'medium')}\n          onClick={() => onImageClick(series.id, photo.id)}\n        />\n        {/* </div> */}\n        {/* <div className={classes.findOnMapButtonContainer}>\n          <FindOnMapButton onClick={() => onMapClick(series)} />\n        </div> */}\n        <div className={classes.titleContainer}>\n          <Avatar onClick={() => onProfileClick(photo.createdUser.username)} className={classes.avatar}>\n            <img alt='profile' className={classes.gravatarImg} src={photo.createdUser.gravatar} />\n          </Avatar>\n          <div className={classes.title}>\n            <Typography variant='body1' color='inherit'>{series.name}</Typography>\n            <Typography variant='body2' color='inherit'>{photo.createdUser.username} {EVENT_VERBS.ADD} a photo</Typography>\n            <Typography variant='caption' color='inherit'>{formatDate(photo.updatedOn)}</Typography>\n          </div>\n          {/* <IconButton color='inherit' className={classes.watchButton} >\n            {seriesWatching ? <StarIcon color='inherit' /> : <StarBorderIcon color='inherit' />}\n          </IconButton> */}\n          <FindOnMapButton onClick={() => onMapClick(series.id, photo.id)} />\n        </div>\n      </div>\n    </Paper>\n  )\n}\n\nFeedItem.propTypes = {\n  // TODO: THIS IS NOT THE SHAPE WE WANT. NEED TO HASH THIS OUT\n  event: PropTypes.object.isRequired,\n  onSeriesClick: PropTypes.func.isRequired,\n  onImageClick: PropTypes.func.isRequired,\n  onProfileClick: PropTypes.func.isRequired,\n  onMapClick: PropTypes.func.isRequired\n}\n\nexport default FeedItem\n\nexport const FeedItemCosmos = (props) => {\n  return (\n    <div>\n      <FeedItem {...props} />\n      <FeedItem {...props} />\n      <FeedItem {...props} />\n      <FeedItem {...props} />\n      <FeedItem {...props} />\n      <FeedItem {...props} />\n      <FeedItem {...props} />\n      <FeedItem {...props} />\n      <FeedItem {...props} />\n      <FeedItem {...props} />\n      <FeedItem {...props} />\n    </div>\n  )\n}\nFeedItemCosmos.propTypes = {\n  // TODO: THIS IS NOT THE SHAPE WE WANT. NEED TO HASH THIS OUT\n  event: PropTypes.object.isRequired\n}\n","import React, { useRef } from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\n\nimport { List } from 'react-virtualized' // InfiniteLoader\nimport useOnline from '../../lib/useOnline'\nimport FeedEnder from './FeedEnder'\n\nimport ErrorIcon from '@material-ui/icons/Error'\nimport { makeStyles } from '@material-ui/core/styles'\nimport FeedItem from './FeedItem'\n\nimport TopBar from '../TopBar'\n\nimport useComponentSize from '../../lib/useComponentSize'\n\nconst ROWHEIGHT = 300\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    display: 'flex',\n    flexDirection: 'column',\n    height: '100%'\n  },\n  listContainer: {\n    flexGrow: 1,\n    overflow: 'hidden'\n  },\n  vList: {\n    height: '100%',\n    width: '100%'\n  },\n  feedContainer: {\n    flexGrow: 1,\n    // Promote the list into his own layer on Chrome. This cost memory but helps keeping high FPS.\n    transform: 'translateZ(0)'\n  },\n  grow: {\n    flexGrow: 1\n  }\n}))\n\nconst MyFeed = ({\n  events, loading, onMapClick, onImageClick, onProfileClick,\n  onSeriesClick, fetchNewest, fetchMore, window\n}) => {\n  const classes = useStyles()\n  const listRef = useRef()\n  const { size } = useComponentSize(listRef)\n  const { online } = useOnline()\n\n  const rowRenderer = ({\n    index, // Index of row\n    isScrolling, // The List is currently being scrolled\n    isVisible, // This row is visible within the List (eg it is not an overscanned row)\n    key, // Unique key within array of rendered rows\n    parent, // Reference to the parent List (instance)\n    style // Style object to be applied to row (to position it);\n    // This must be passed through to the rendered row element.\n  }) => {\n    const row = events[index]\n    let content\n    if (index < events.length && row) {\n      content = <FeedItem\n        event={events[index]}\n        onSeriesClick={onSeriesClick}\n        onImageClick={onImageClick}\n        onProfileClick={onProfileClick}\n        onMapClick={onMapClick}\n      />\n    }\n    else if (index === events.length) {\n      // content = <div className={classes.placeholder} style={{ width: row.size }} />\n      const wEnd = window && window[0] === 0\n      content = <FeedEnder text='Loading...' />\n\n      const almostAtEnd = ROWHEIGHT * 4 + parent.state.scrollTop > style.top\n\n      if (!online) {\n        content = <FeedEnder icon={<ErrorIcon />} text='Cannot Refresh Offline' />\n      }\n      else if (wEnd) {\n        content = <FeedEnder text='End' />\n      }\n      // Only if we're online, not loading and visible\n      else if (!loading && almostAtEnd) {\n        fetchMore()\n      }\n    }\n\n    return (\n      <div className={classes.row} key={key} style={style}>\n        {content}\n      </div>\n    )\n  }\n  rowRenderer.propTypes = {\n    index: PropTypes.any,\n    key: PropTypes.any,\n    style: PropTypes.any,\n    isScrolling: PropTypes.any,\n    isVisible: PropTypes.any,\n    parent: PropTypes.any\n  }\n\n  // console.log('DEBUGLIST', size)\n\n  return (\n    <div className={classes.root}>\n      <TopBar>\n        <Typography className={classes.grow}>Feed</Typography>\n      </TopBar>\n      <div className={classes.listContainer} ref={listRef}>\n        <List\n          height={size.height}\n          width={size.width}\n          className={classes.vList}\n          rowCount={events.length + 1}\n          rowHeight={ROWHEIGHT}\n          rowRenderer={rowRenderer}\n        />\n      </div>\n    </div>\n  )\n}\n\nMyFeed.propTypes = {\n  events: PropTypes.array.isRequired,\n  loading: PropTypes.bool,\n  window: PropTypes.arrayOf(PropTypes.number),\n  onSeriesClick: PropTypes.func.isRequired,\n  onImageClick: PropTypes.func.isRequired,\n  onProfileClick: PropTypes.func.isRequired,\n  onMapClick: PropTypes.func.isRequired,\n  fetchNewest: PropTypes.func.isRequired,\n  fetchMore: PropTypes.func.isRequired\n}\n\nexport default MyFeed\n","import React, { useRef, useState, useEffect } from 'react'\nimport PropTypes from 'prop-types'\nimport { graphql } from 'react-apollo'\nimport { home } from '../config'\nimport actions from '../redux/actions'\nimport { connect } from 'react-redux'\nimport { getMyFeed } from './queries'\nimport MyFeed from '../components/MyFeed/MyFeed'\nimport useOnline from '../lib/useOnline'\n\nconst POLL_INTERVAL = 20 // (seconds)\nconst FEED_LIMIT = 5 // (items to load)\n\nconst FeedConnect = ({\n  data, loading, fetchMore, fetchNewest,\n  loadingNewest,\n  loadingMore,\n  jumpToSeries,\n  jumpToMap,\n  jumpToUser\n}) => {\n  const timerRef = useRef()\n  const { online } = useOnline()\n  const [lastCheck, setLastCheck] = useState(null)\n  timerRef.current = lastCheck\n\n  // Initiate the polling process. We simply update the timestamp every N seconds\n  useEffect(() => {\n    function ping () {\n      if (!loading && online) fetchNewest()\n      if (timerRef.current) setLastCheck(String(Date.now() - POLL_INTERVAL * 1000))\n    }\n    if (!timerRef.current) timerRef.current = setInterval(ping, POLL_INTERVAL * 1000)\n    return () => {\n      if (timerRef.current) {\n        console.log('clear poll timer')\n        clearInterval(timerRef.current)\n        timerRef.current = null\n      }\n    }\n  }, [])\n\n  const events = data.myFeed ? data.myFeed.feed || [] : []\n  const window = data.myFeed ? data.myFeed.window.map(v => parseInt(v, 10)) || [null, null] : [null, null]\n\n  return (\n    <MyFeed {...{ events, loading, window, fetchMore, fetchNewest, jumpToSeries }}\n      onSeriesClick={() => {}}\n      onImageClick={jumpToSeries}\n      onProfileClick={jumpToUser}\n      onMapClick={jumpToMap}\n    />\n  )\n}\n\nFeedConnect.propTypes = {\n  data: PropTypes.object, // from graphql\n  loading: PropTypes.bool, // from graphql\n  loadingNewest: PropTypes.bool, // from graphql\n  loadingMore: PropTypes.bool, // from graphql\n  fetchMore: PropTypes.func,\n  fetchNewest: PropTypes.func,\n  jumpToSeries: PropTypes.func,\n  jumpToMap: PropTypes.func,\n  jumpToUser: PropTypes.func\n}\n\nconst withFeedQuery = graphql(getMyFeed, {\n  props: ({ data }) => {\n    if (data.error) console.error(data.error)\n\n    // TODO: Not sure this will propagate correctly. Test it.\n    let loadingNewest = false\n    let loadingMore = false\n\n    // console.log('withFeedQuery', data)\n\n    // One Thunk function designed for getting everything since the last check\n    const fetchNewest = () => {\n      loadingNewest = true\n      console.log('fetchNewest', data)\n      data.fetchMore({\n        variables: { ...data.variables, start: data.myFeed.window[1] },\n        // How do we mush the new query with the old one\n        updateQuery: (prev, { fetchMoreResult }) => {\n          loadingNewest = false\n          return {\n            myFeed: {\n              ...fetchMoreResult.myFeed,\n              // put the newest stuff first\n              feed: [ ...fetchMoreResult.myFeed.feed, ...prev.myFeed.feed ],\n              window: [prev.myFeed.window[0], fetchMoreResult.myFeed.window[1]]\n            }\n          }\n        }\n      })\n    }\n\n    // A second Thunk function designed to get more elements in the feed history\n    const fetchMore = () => {\n      loadingMore = true\n      console.log('fetchMore', data)\n      data.fetchMore({\n        variables: { ...data.variables, end: data.myFeed.window[0] },\n        // How do we mush the new query with the old one\n        updateQuery: (prev, { fetchMoreResult }) => {\n          loadingMore = false\n          return {\n            myFeed: {\n              ...fetchMoreResult.myFeed,\n              feed: [ ...prev.myFeed.feed, ...fetchMoreResult.myFeed.feed ],\n              window: [fetchMoreResult.myFeed.window[0], prev.myFeed.window[1]]\n            }\n          }\n        }\n      })\n    }\n\n    return {\n      data,\n      loadingNewest,\n      loadingMore,\n      fetchNewest, // This is the poll we do every n seconds\n      fetchMore, // This is when we scroll to the bottom of the list\n      loading: data.loading\n    }\n  },\n  // skip: ({ activeSeries, isNewSeries }) => !activeSeries || isNewSeries,\n  options: ({ activeSeries }) => ({\n    variables: {\n      limit: FEED_LIMIT\n    }\n  })\n})\n\n/**\n * Map our redux state and functions\n */\nconst mapStateToProps = (state, props) => {\n  return { }\n}\n\n// We're using graphql() HOC because it's convenient but it doesn't need to render anything\n// const FeedQueryConnect = withFeedQuery(() => null)\nconst mapDispatchToProps = dispatch => ({\n  jumpToSeries: (seriesId, photoId) => {\n    dispatch(actions.setHomeState(home.AppStateTypes.SERIES, { activeSeries: seriesId, initialPhoto: photoId }))\n  },\n  jumpToUser: (username) => {\n    dispatch(actions.setHomeState(home.AppStateTypes.SEARCH, { search: { tab: home.SEARCH_TABS.USER, text: username } }))\n  },\n  jumpToMap: (seriesId, photoId) => {\n    dispatch(actions.pushMapHistory({\n      mode: home.MapModeTypes.FREE\n    }))\n    dispatch(actions.setHomeState(home.AppStateTypes.MAP, { activeSeries: seriesId, initialPhoto: photoId }))\n  }\n})\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(\n  withFeedQuery(FeedConnect)\n)\n","import React, { useRef, useEffect, useState } from 'react'\nimport Typography from '@material-ui/core/Typography'\n// import MenuIcon from '@material-ui/icons/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nimport useOnline from '../../lib/useOnline'\nimport moment from 'moment'\n\nconst CHECKINTERVAL = 5000\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    background: 'black',\n    color: 'white',\n    textAlign: 'center'\n  }\n}))\n\nconst OfflineBar = () => {\n  const classes = useStyles()\n  const { online, since } = useOnline()\n  const [sinceStr, setSinceStr] = useState()\n  const timerRef = useRef()\n\n  const calcSinceStr = () => {\n    const newText = moment(since, 'x').fromNow()\n    // console.log('OFFLINE SINCE', since, newText)\n    setSinceStr(newText)\n  }\n  const clearTimer = () => {\n    if (timerRef.current) {\n      clearInterval(timerRef.current)\n      timerRef.current = null\n    }\n  }\n\n  useEffect(() => {\n    if (since && !timerRef.current) {\n      calcSinceStr()\n      timerRef.current = setInterval(calcSinceStr, CHECKINTERVAL)\n    }\n    else if (!since)clearTimer()\n    return () => {\n      clearTimer()\n    }\n  }, [since])\n\n  if (online) return null\n  return (\n    <Typography className={classes.root} variant='caption' component='div'>\n      Offline ({sinceStr})\n    </Typography>\n  )\n}\n\nexport default OfflineBar\n","import React from 'react'\nimport classNames from 'classnames'\nimport PropTypes from 'prop-types'\n\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport AppBar from '@material-ui/core/AppBar'\nimport Paper from '@material-ui/core/Paper'\nimport Typography from '@material-ui/core/Typography'\nimport Toolbar from '@material-ui/core/Toolbar'\nimport Button from '@material-ui/core/Button'\n// import Fab from '@material-ui/core/Fab'\n\nimport HomeIcon from '@material-ui/icons/HomeOutlined'\nimport MapIcon from '@material-ui/icons/MapOutlined'\nimport SearchIcon from '@material-ui/icons/SearchOutlined'\nimport AddIcon from '@material-ui/icons/Add'\nimport PersonOutline from '@material-ui/icons/PersonOutline'\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport useOnline from '../lib/useOnline'\nimport AddFab from '../components/PhotoSeries/views/controls/AddFab'\nimport OfflineBar from './misc/OfflineBar'\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n  },\n  text: {\n    padding: theme.spacing(2, 2, 0)\n  },\n  paper: {\n    paddingBottom: 50\n  },\n  list: {\n    marginBottom: theme.spacing(2)\n  },\n  subheader: {\n    backgroundColor: theme.palette.background.paper\n  },\n  grow: {\n    flexGrow: 1\n  },\n  spacer: {\n    width: 40,\n    flexGrow: 1\n  }\n}))\n\nconst BottomBar = ({ className, signedIn, onHomeClick, onMapClick, onSearchClick, onProfileClick, onCameraClick, onLibraryClick }) => {\n  const classes = useStyles()\n  const { online } = useOnline()\n\n  return (\n    <AppBar position='static' className={classNames(classes.root, className)}>\n      <Toolbar>\n        {signedIn && (\n          <Button\n            edge='start'\n            className={classes.grow}\n            color='inherit'\n            onClick={onHomeClick}\n          >\n            <HomeIcon />\n          </Button>\n        )}\n        <Button\n          edge='start'\n          className={classes.grow}\n          color='inherit'\n          onClick={onMapClick}\n        >\n          <MapIcon />\n        </Button>\n        {signedIn && (\n          <AddFab\n            onCameraClick={onCameraClick}\n            onLibraryClick={onLibraryClick}\n          >\n            <AddIcon />\n          </AddFab>\n        )}\n        <div className={classes.spacer} />\n        <Button\n          color='inherit'\n          className={classes.grow}\n          disabled={!online}\n          onClick={onSearchClick}\n        >\n          <SearchIcon />\n        </Button>\n        {signedIn && (\n          <Button\n            edge='end'\n            color='inherit'\n            className={classes.grow}\n            onClick={onProfileClick}\n          >\n            <PersonOutline />\n          </Button>\n        )}\n      </Toolbar>\n    </AppBar>\n  )\n}\n\nBottomBar.propTypes = {\n  className: PropTypes.string,\n  signedIn: PropTypes.bool,\n  // Here are our button handlers\n  onHomeClick: PropTypes.func.isRequired,\n  onMapClick: PropTypes.func.isRequired,\n  onSearchClick: PropTypes.func.isRequired,\n  onProfileClick: PropTypes.func.isRequired,\n  onCameraClick: PropTypes.func.isRequired,\n  onLibraryClick: PropTypes.func.isRequired\n}\n\nexport default BottomBar\n\nexport const BottomBarCosmosWrapper = (props) => {\n  // const [someStateItem, setSomeStateItem] = useState()\n  const classes = useWrapperStyles()\n  return (\n    <div className={classes.root}>\n      <OfflineBar />\n      <CssBaseline /> {/* You only need this in a root element. Don't put it anywhere else in the dom */}\n      <Paper className={classes.paper}>\n        <Typography variant='h5'>\n          This is a dummy component.\n        </Typography>\n      </Paper>\n      <BottomBar {...props} />\n    </div>\n  )\n}\n\nconst wrapperStyle = theme => ({\n  root: {\n    height: '100%',\n    display: 'flex',\n    flexDirection: 'column'\n  },\n  paper: {\n    flexGrow: 1\n  }\n})\n\nconst useWrapperStyles = makeStyles(wrapperStyle)\n","import React, { useContext, useEffect } from 'react'\nimport PropTypes from 'prop-types'\n\nimport CssBaseline from '@material-ui/core/CssBaseline'\n\nimport UploaderConnect from './graphql/Uploader.connect'\nimport SeriesConnect from './graphql/Series.connect'\nimport MapConnect from './graphql/Map.connect'\nimport SearchConnect from './graphql/Search.connect'\nimport ProfileConnect from './graphql/Profile.connect'\nimport FeedConnect from './graphql/Feed.connect'\n\nimport OfflineBar from './components/misc/OfflineBar'\nimport BottomBar from './components/BottomBar'\nimport { AppContext } from './contexts'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport { home as homeConfig } from './config'\n\nconst STATES = homeConfig.AppStateTypes\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    height: '100%',\n    overflow: 'hidden',\n    display: 'flex',\n    flexDirection: 'column'\n  },\n  offlineBar: {\n    flex: '0 0'\n  },\n  activeWrapper: {\n    overflow: 'hidden',\n    flexGrow: 1,\n    flexShrink: 1\n  },\n  uploaderContainer: {\n    zIndex: 2000,\n    flex: '0 0'\n  }\n}))\n\n/**\n * This is the over-arching wrapper for the app. It combines all the\n * same place. Time will tell if that's a good strategy.\n */\nconst App = ({ domain, setHomeState, onCameraClick, onLibraryClick }) => {\n  const classes = useStyles()\n  const { signedIn, isVKeyBdOn } = useContext(AppContext)\n\n  useEffect(() => {\n    // No home feed for anonymous users\n    if (!signedIn && domain === STATES.FEED) setHomeState(STATES.MAP)\n  }, [domain])\n\n  let showBottomBar = true\n  let ActiveComponent = FeedConnect\n  switch (domain) {\n    case STATES.FEED:\n      ActiveComponent = FeedConnect\n      break\n    case STATES.MAP:\n      ActiveComponent = MapConnect\n      break\n    case STATES.PROFILE:\n      ActiveComponent = ProfileConnect\n      break\n    case STATES.SEARCH:\n      ActiveComponent = SearchConnect\n      break\n    case STATES.SERIES:\n      ActiveComponent = SeriesConnect\n      showBottomBar = false\n      break\n    case STATES.NEW_SERIES_CAMERA:\n      ActiveComponent = SeriesConnect\n      showBottomBar = false\n      break\n    case STATES.NEW_SERIES_LIBRARY:\n      ActiveComponent = SeriesConnect\n      showBottomBar = false\n      break\n    default:\n      break\n  }\n\n  return (\n    <div className={classes.root}>\n      <CssBaseline /> {/* You only need this in a root element. Don't put it anywhere else in the dom */}\n      <OfflineBar className={classes.offlineBar} />\n      <div className={classes.activeWrapper}>\n        <ActiveComponent />\n      </div>\n      { showBottomBar && (\n        <BottomBar\n          signedIn={signedIn}\n          onHomeClick={() => setHomeState(STATES.FEED)}\n          onMapClick={() => setHomeState(STATES.MAP)}\n          onSearchClick={() => setHomeState(STATES.SEARCH, { search: null })}\n          onProfileClick={() => setHomeState(STATES.PROFILE)}\n          onCameraClick={onCameraClick}\n          onLibraryClick={onLibraryClick}\n        />\n      )}\n      {/* Uploader is persistent across all views */}\n      <UploaderConnect className={classes.uploaderContainer} />\n    </div>\n  )\n}\n\nApp.propTypes = {\n  // All of this comes in from From Redux\n  domain: PropTypes.string.isRequired,\n  setHomeState: PropTypes.func.isRequired,\n  onCameraClick: PropTypes.func.isRequired,\n  onLibraryClick: PropTypes.func.isRequired\n}\n\nexport default App\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport Button from '@material-ui/core/Button'\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport BugReportIcon from '@material-ui/icons/BugReport'\nimport ErrorIcon from '@material-ui/icons/Error'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    height: '100%',\n    overflow: 'hidden',\n    padding: theme.spacing(1),\n    display: 'flex',\n    flexDirection: 'column',\n    textAlign: 'center',\n    color: theme.palette.text.primary,\n    border: `20px solid ${theme.palette.text.secondary}`\n  },\n  icon: {\n    margin: 'auto',\n    flex: '1 1 20%',\n    height: '70%',\n    width: '70%'\n  },\n  text: {\n  },\n  stack: {\n    padding: theme.spacing(2),\n    marginBottom: theme.spacing(2),\n    fontSize: '8px',\n    flexGrow: 1,\n    textAlign: 'left',\n    whiteSpace: 'pre-wrap',\n    overflow: 'scroll',\n    color: theme.palette.error.main,\n    fontFamily: 'Consolas, monaco, monospace'\n  }\n}))\n\nconst ErrorScreen = ({ error }) => {\n  const classes = useStyles()\n\n  let stackEl = null\n  try {\n    if (process.env.NODE_ENV === 'development') {\n      stackEl = (\n        <Typography className={classes.stack}>\n          {error.stack}\n        </Typography>\n      )\n    }\n  }\n  catch (e) {}\n\n  return (\n    <div className={classes.root}>\n      <CssBaseline />\n      <ErrorIcon className={classes.icon}color='inherit' />\n      <Typography variant='subtitle1' className={classes.text} color='inherit'>\n        Something went wrong\n      </Typography>\n      {error && error.message && <Typography variant='body1' className={classes.text} color='inherit'>\n        {error.message}\n      </Typography>}\n      {stackEl}\n      <Button variant='outlined' disabled>\n        <BugReportIcon />\n        File a bug report\n      </Button>\n    </div>\n  )\n}\n\nErrorScreen.propTypes = {\n  error: PropTypes.object\n}\n\nexport default ErrorScreen\n","import React, { useMemo } from 'react'\nimport { Query, ApolloProvider, compose } from 'react-apollo'\nimport { IntlWrapper } from './translations'\nimport { getUser } from './graphql/queries'\nimport { AppContext } from './contexts'\nimport Loading from './components/auth/Loading'\nimport { createApolloClient } from './lib/useGraphQL'\nimport ErrorBoundary from './lib/ErrorBoundary'\nimport useAuthentication from './lib/useAuthentication'\nimport useShowAddToHome from './lib/useShowAddToHome'\nimport useResponsive from './lib/useResponsive'\nimport withReduxProvider from './redux/withReduxProvider'\nimport { connect } from 'react-redux'\nimport actions from './redux/actions'\nimport config, { home as homeConfig } from './config'\n\nimport App from './App'\nimport ErrorScreen from './components/misc/ErrorScreen'\n\n/**\n * HOC for AppContext and ApolloProvider\n */\nexport const withApolloAuthProvider = Wrapped => (props) => {\n  // console.log('withApolloAuthProvider', props)\n  const { signedIn, isGod, authData, signOut, authScreen, accessToken, forceSignIn } = useAuthentication()\n  const apolloClient = useMemo(() => createApolloClient(accessToken), [accessToken])\n\n  // This triggers all the PWA Goodness\n  useShowAddToHome()\n  const responsive = useResponsive()\n\n  // If the user hasn't decided to be anonymous or sign in yet show them the login screen\n  console.log('Rendering AppConnect', { responsive, props, signedIn, isGod, authData })\n  if (signedIn === null) return authScreen\n\n  // These are the things the rest of the app needs to find:\n  const appContext = {\n    signOut,\n    forceSignIn,\n    ...responsive,\n    signedIn,\n    role: !signedIn\n      ? 'anonymous'\n      : isGod\n        ? 'admin'\n        : 'user',\n    currentUser: authData, // TODO: Need this supported by a graphql query\n    seriesConfig: {\n      meta: {},\n      tags: [\n        {\n          id: 'freeBothType',\n          label: null,\n          color: config.tagColors[0],\n          allowXY: true,\n          allowNonXY: true,\n          allowAdditions: true,\n          // This one returns a promise\n          getValues: () => Promise.resolve(['a', 'b', 'c']),\n          values: []\n        }\n      ],\n      getPhotoUrl: (photo, size) => {\n        try {\n          return `${photo.paths.base}${photo.paths[size]}`\n        }\n        catch (e) {\n          return null\n        }\n      }\n    }\n  }\n\n  return (\n    // We wrap the outside in an error handler\n    <ErrorBoundary fallback={ErrorScreen}>\n      <ApolloProvider client={apolloClient}>\n        <Query query={getUser} skip={!signedIn}>\n          {({ loading, error, data }) => {\n            if (loading) return <Loading />\n            if (error) {\n              console.error(error)\n            }\n            if (signedIn) appContext.user = data.user\n            return (\n              <AppContext.Provider value={appContext}>\n                <IntlWrapper>\n                  <Wrapped {...props} />\n                </IntlWrapper>\n              </AppContext.Provider>\n            )\n          }}\n        </Query>\n      </ApolloProvider>\n    </ErrorBoundary>\n  )\n}\n\n/**\n * Map our redux state and functions\n */\nconst mapStateToProps = (state, props) => {\n  const { domain } = state.home.current\n  return { domain }\n}\n\nconst mapDispatchToProps = dispatch => ({\n  setHomeState: (newDomain, newParams) => {\n    dispatch(actions.setHomeState(newDomain, newParams))\n  },\n  onCameraClick: () => {\n    dispatch(actions.setHomeState(homeConfig.AppStateTypes.NEW_SERIES_CAMERA))\n  },\n  onLibraryClick: () => {\n    dispatch(actions.setHomeState(homeConfig.AppStateTypes.NEW_SERIES_LIBRARY))\n  }\n})\n\n/**\n * Nearly everything we do depends on who you are as a user so we commit this to state\n */\n\n// The order we compose things here matters a lot\nconst withAppState = connect(\n  mapStateToProps,\n  mapDispatchToProps\n)\n\nexport default compose(\n  // ORDER IS CRITICAL HERE\n  withReduxProvider,\n  withApolloAuthProvider,\n  withAppState\n)(App)\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n)\n\nexport function register (config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href)\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config)\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\n          )\n        })\n      }\n      else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config)\n      }\n    })\n  }\n}\n\nfunction registerValidSW (swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing\n        if (installingWorker == null) {\n          return\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n              )\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration)\n              }\n            }\n            else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.')\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration)\n              }\n            }\n          }\n        }\n      }\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error)\n    })\n}\n\nfunction checkValidServiceWorker (swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type')\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload()\n          })\n        })\n      }\n      else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config)\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      )\n    })\n}\n\nexport function unregister () {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister()\n    })\n  }\n}\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport AppConnect from './App.connect'\n\nimport * as serviceWorker from './serviceWorker'\n// Here's our global overrides css\nimport './index.css'\n// This is the font we need\nrequire('typeface-roboto')\n\nconsole.log('Rendering Main App')\nReactDOM.render(<AppConnect />, document.getElementById('root'))\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.register()\n","const tagChips = {\n  height: 20\n}\n\nexport default theme => ({\n  xyTagChip: {\n    cursor: 'pointer',\n    color: 'white',\n    fontSize: '0.6em',\n    background: '#444444',\n    height: tagChips.height,\n    position: 'absolute',\n    left: -tagChips.height / 2,\n    top: -tagChips.height / 2\n  },\n  editing: {\n    // color: 'white',\n    // background: theme.palette.secondary.main\n  },\n  // The tag is flipped on the right side of the screen\n  reversedChip: {\n    flexDirection: 'row-reverse',\n    left: 'unset',\n    right: -tagChips.height / 2\n  },\n  deleteIcon: {\n    // color: 'white',\n    width: tagChips.height - 1,\n    height: tagChips.height - 1\n  },\n  chipAvatarIcon: {\n    color: 'white',\n    width: tagChips.height - 4,\n    height: tagChips.height - 4\n  },\n  chipAvatar: {\n    background: 'inherit',\n    width: tagChips.height,\n    height: tagChips.height\n  },\n  reversedDelete: {\n    margin: `0 -${tagChips.height / 8}px 0 ${tagChips.height / 8}px`\n  },\n  // The chip bucket is the container div for the chip and represents the\n  // Actual XY coordinates. The chip itself is offset to make the\n  chipBucket: {\n    width: 1,\n    height: 1,\n    display: 'flex',\n    flexDirection: 'row',\n    position: 'absolute'\n  },\n  reversedChipBucket: {\n    flexDirection: 'row-reverse'\n  }\n})\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport Draggable from 'react-draggable'\n\nimport Chip from '@material-ui/core/Chip'\nimport Avatar from '@material-ui/core/Avatar'\n\nimport CancelIcon from '@material-ui/icons/Cancel'\nimport MyLocation from '@material-ui/icons/MyLocation'\n\nimport { makeStyles, useTheme } from '@material-ui/core/styles'\nimport style from './XYTagChip.style'\n\nconst useStyles = makeStyles(style)\n\nconst XYTagChip = ({\n  color, edit, tag, newSize,\n  onTagDragOver, onTagDragStop, onNewTag, onTagDelete, ...props\n}) => {\n  const isReversed = tag.relCoords.x > newSize.newWidth / 2\n  const classes = useStyles()\n  const theme = useTheme()\n  const stopBadness = (e) => {\n    e.preventDefault()\n    e.stopPropagation()\n  }\n\n  const handleDrag = (e, data) => {\n    stopBadness(e)\n    onTagDragOver(data, tag)\n  }\n  const handleStopDrag = (e, data) => {\n    stopBadness(e)\n    onTagDragStop(data, tag)\n  }\n\n  // Draggable chip if it is editable\n  return (\n    <Draggable\n      disabled={!edit}\n      bounds={{ left: 10, top: 10, right: newSize.newWidth - 10, bottom: newSize.newHeight - 10 }}\n      position={{ x: tag.relCoords.x, y: tag.relCoords.y }}\n      onDrag={handleDrag}\n      onStop={handleStopDrag}\n      onClick={stopBadness}\n    >\n      <div className={classNames(classes.chipBucket, isReversed && classes.reversedChipBucket)}>\n        <Chip\n          style={{\n            background: color ? `${color}!important` : null,\n            color: color ? `${theme.palette.getContrastText(color)}!important` : null\n          }}\n          color={edit ? 'secondary' : 'default'}\n          label={tag.label}\n          data={tag.id}\n          onClick={stopBadness}\n          onDelete={edit ? onTagDelete(tag) : null}\n          deleteIcon={edit ? <CancelIcon className={classNames(classes.deleteIcon, isReversed && classes.reversedDelete)} /> : <div />}\n          className={classNames(\n            classes.xyTagChip,\n            isReversed && classes.reversedChip,\n            edit && classes.editing\n          )}\n          {...props}\n          avatar={<Avatar className={classNames(classes.chipAvatar, edit && classes.editing)}>\n            <MyLocation className={classNames(classes.chipAvatarIcon, edit && classes.editing)} />\n          </Avatar>}\n        />\n      </div>\n    </Draggable>\n  )\n}\n\nXYTagChip.propTypes = {\n  color: PropTypes.string,\n  edit: PropTypes.bool,\n  tag: PropTypes.object.isRequired,\n  newSize: PropTypes.object,\n  onTagDragOver: PropTypes.func,\n  onTagDragStop: PropTypes.func,\n  onNewTag: PropTypes.func,\n  onTagDelete: PropTypes.func\n}\n\nexport default XYTagChip\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\nimport Paper from '@material-ui/core/Paper'\nimport Typography from '@material-ui/core/Typography'\nimport TextField from '@material-ui/core/TextField'\nimport MenuItem from '@material-ui/core/MenuItem'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport Select from 'react-select'\nimport CreatableSelect from 'react-select/lib/Creatable'\nimport style from './XYTagSelect.style'\n\nconst useStyles = makeStyles(style)\n\nconst XYTagSelect = ({ tagConfig, onChange }) => {\n  const classes = useStyles()\n  const options = tagConfig.values.map(tc => ({ label: tc.label, value: tc.id }))\n  console.log('XYTagSelect', tagConfig)\n  return (\n    <div className={classes.root}>\n      {!tagConfig.allowAdditions && (\n        <Select\n          options={options}\n          classes={classes}\n          components={{\n            Control,\n            Menu,\n            NoOptionsMessage,\n            Option,\n            Placeholder,\n            ValueContainer\n          }}\n          value={null}\n          // onBlur={e => e.preventDefault()}\n          blurInputOnSelect\n          isClearable={false}\n          onChange={onChange}\n          placeholder={tagConfig.label}\n          isSearchable\n        />\n      ) }\n      { tagConfig.allowAdditions && (\n        <CreatableSelect\n          options={options}\n          classes={classes}\n          components={{\n            Control,\n            Menu,\n            NoOptionsMessage,\n            Option,\n            Placeholder,\n            ValueContainer\n          }}\n          value={null}\n          isClearable={false}\n          // onBlur={e => e.preventDefault()}\n          blurInputOnSelect\n          onChange={onChange}\n          placeholder={tagConfig.label}\n          isSearchable\n        />\n      )}\n    </div>\n  )\n}\nXYTagSelect.propTypes = {\n  tagConfig: PropTypes.object.isRequired,\n  onChange: PropTypes.func.isRequired\n}\n\nexport default XYTagSelect\n\nfunction Control (props) {\n  return (\n    <TextField\n      fullWidth\n      InputProps={{\n        inputComponent,\n        inputProps: {\n          className: props.selectProps.classes.input,\n          inputRef: props.innerRef,\n          children: props.children,\n          ...props.innerProps\n        }\n      }}\n      {...props.selectProps.textFieldProps}\n    />\n  )\n}\n\nconst NoOptionsMessage = ({ innerProps, selectProps, children }) => (\n  <Typography\n    color='textSecondary'\n    className={selectProps.classes.noOptionsMessage}\n    {...innerProps}\n  >\n    {children}\n  </Typography>\n)\n\nconst Menu = ({ selectProps, innerProps, children }) => (\n  <Paper square className={selectProps.classes.paper} {...innerProps}>\n    {children}\n  </Paper>\n)\n\nconst inputComponent = ({ inputRef, ...props }) => <div ref={inputRef} {...props} />\n\nconst Placeholder = (props) => (\n  <Typography\n    color='textSecondary'\n    className={props.selectProps.classes.placeholder}\n    {...props.innerProps}\n  >\n    {props.children}\n  </Typography>\n)\n\nconst Option = ({ innerRef, isFocused, isSelected, innerProps, children }) => (\n  <MenuItem\n    buttonRef={innerRef}\n    selected={isFocused}\n    component='div'\n    style={{ fontWeight: isSelected ? 500 : 400 }}\n    {...innerProps}\n  >\n    {children}\n  </MenuItem>\n)\n\nconst ValueContainer = ({ selectProps, children }) => (\n  <div className={selectProps.classes.valueContainer}>{children}</div>\n)\nValueContainer.propTypes = {\n  selectProps: PropTypes.object.isRequired,\n  children: PropTypes.any\n}\n","export default theme => ({\n  root: {\n    width: '100%'\n  },\n  noOptionsMessage: {\n    padding: `${theme.spacing(1)}px ${theme.spacing(1) * 2}px`\n  },\n  singleValue: {\n    fontSize: 16\n  },\n  placeholder: {\n    position: 'absolute',\n    left: 2,\n    fontSize: 16\n  },\n  input: {\n    display: 'flex',\n    padding: 0\n  },\n  valueContainer: {\n    display: 'flex',\n    flexWrap: 'wrap',\n    flex: 1,\n    alignItems: 'center',\n    overflow: 'hidden'\n  },\n  paper: {\n    position: 'absolute',\n    zIndex: 100,\n    marginTop: theme.spacing(1),\n    left: 0,\n    right: 0\n  }\n})\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport Typography from '@material-ui/core/Typography'\nimport IconButton from '@material-ui/core/IconButton'\n\nimport CloseIcon from '@material-ui/icons/Close'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport XYTagSelect from './XYTagSelect'\nimport style from './XYTagChooser.style'\n\nconst useStyles = makeStyles(style)\n\nconst XYTagChooser = ({ coords, open, seriesConfig, onNewTag, onClose }) => {\n  const classes = useStyles()\n  const xyTags = seriesConfig.tags.filter(t => t.allowXY)\n  if (!coords) return null\n  return (\n    <Dialog\n      open={open}\n      scroll='paper'\n      fullScreen\n      classes={{ paperScrollPaper: classes.root }}\n      onClose={() => onClose()}\n      aria-labelledby='simple-dialog-title'\n    >\n      <DialogTitle id='simple-dialog-title' className={classes.header}>\n      New Tag:\n        <IconButton className={classes.closeButton} onClick={onClose}>\n          <CloseIcon />\n        </IconButton>\n      </DialogTitle>\n      <div className={classes.dlgBody}>\n        {xyTags.length > 1 && (\n          <Typography variant='caption'>What kind of tag would you like to create?</Typography>\n        )}\n\n        {xyTags.map((tagType, idx) => (\n          <div className={classes.listItem} key={`tagSelect${idx}`}>\n            <XYTagSelect tagConfig={tagType} onChange={onNewTag(coords, tagType)} />\n          </div>\n        ))}\n      </div>\n    </Dialog>\n  )\n}\n\nXYTagChooser.propTypes = {\n  seriesConfig: PropTypes.object.isRequired,\n  open: PropTypes.bool.isRequired,\n  coords: PropTypes.object,\n  onClose: PropTypes.func.isRequired,\n  onNewTag: PropTypes.func.isRequired\n}\n\nexport default XYTagChooser\n","export default theme => ({\n  root: {\n    overflow: 'visible'\n  },\n  header: {\n    padding: theme.spacing(1) * 2\n  },\n  listItem: {\n    flexDirection: 'column'\n  },\n  dlgBody: {\n    paddingLeft: theme.spacing(1) * 2,\n    paddingRight: theme.spacing(1) * 2,\n    paddingBottom: theme.spacing(1) * 2\n  },\n  closeButton: {\n    position: 'absolute',\n    right: theme.spacing(1),\n    top: theme.spacing(1),\n    color: theme.palette.grey[500]\n  }\n})\n","import React, { useState, useContext } from 'react'\nimport { SeriesContext } from '../../contexts'\nimport XYTagChooser from './XYTagChooser'\nimport Tags from '../../../../lib/Tags'\n\nconst useXYTags = (photo, newSize, onChange, setResizeActive) => {\n  const { seriesConfig } = useContext(SeriesContext)\n\n  // we hold the tags in state so that every little drag motion\n  // doesn't cause an updated state until you let go\n  const [isDragging, setIsDragging] = useState(false)\n  const [newTagDialog, setNewTagDialog] = useState(null)\n\n  const tagClass = new Tags(seriesConfig, photo.tags)\n\n  const onNewTag = (coords, tagType) => ({ value, __isNew__: isNew }) => {\n    let addTag = isNew\n      ? tagClass.createNewXYTagObj(value, tagType.id, coords)\n      : tagClass.createExistingXYTagObj(value, tagType.id, coords)\n\n    setNewTagDialog(null)\n    onChange({ ...photo, tags: [...photo.tags, addTag] })\n  }\n\n  const onTagDelete = (tag) => () => {\n    const tags = photo.tags.filter(oldTag => oldTag.id !== tag.id)\n    onChange({\n      ...photo,\n      tags\n    })\n  }\n\n  // When the photo is tapped, send the x,y coords of that tap\n  // to a dialog we will open\n  const onAddTagTrigger = (e) => {\n    if (!newTagDialog) {\n      // Turn off resizing so mobile keyboards don't complete F us.\n      setResizeActive(false)\n      setNewTagDialog({\n        x: parseInt(e.pageX - (window.innerWidth - newSize.newWidth) / 2 * newSize.multiplier, 10),\n        y: parseInt(e.pageY - (window.innerHeight - newSize.newHeight) / 2 * newSize.multiplier, 10)\n      })\n    }\n  }\n\n  // This gets used by the drag AND the stop\n  const updateTagLocation = ({ x, y }, tag) => {\n    const newTags = photo.tags.map(oldTag => {\n      if (oldTag.id !== tag.id) return oldTag\n      else {\n        let newX = parseInt(x / newSize.multiplier, 10)\n        let newY = parseInt(y / newSize.multiplier, 10)\n\n        return {\n          ...oldTag,\n          coords: { x: newX, y: newY }\n        }\n      }\n    })\n    return newTags\n  }\n\n  const onTagDragStop = (coords, tag) => {\n    const tags = updateTagLocation(coords, tag)\n    setIsDragging(false)\n    onChange({\n      ...photo,\n      tags\n    })\n  }\n\n  const onTagDragOver = (coords, tag) => {\n    updateTagLocation(coords, tag)\n    setIsDragging(true)\n  }\n  const TagChooser = () => (\n    <XYTagChooser\n      open={!isDragging && Boolean(newTagDialog)}\n      coords={newTagDialog}\n      seriesConfig={seriesConfig}\n      onNewTag={onNewTag}\n      onClose={() => {\n        setNewTagDialog(null)\n        // Turn on resizing again.\n        setResizeActive(true)\n      }}\n    />\n  )\n\n  return {\n    onNewTag,\n    onTagDelete,\n    onAddTagTrigger,\n    onTagDragOver,\n    onTagDragStop,\n    TagChooser,\n    getRelXYTags: tagClass.getRelXYTags\n  }\n}\n\nexport default useXYTags\n","import React from 'react'\nimport Typography from '@material-ui/core/Typography'\nimport BrokenImageIcon from '@material-ui/icons/BrokenImage'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    flexGrow: 1,\n    padding: '10%',\n    display: 'flex',\n    flexDirection: 'column',\n    opacity: 0.3,\n    textAlign: 'center',\n    color: theme.palette.grey[100]\n  },\n  icon: {\n    width: '100%',\n    flex: '1 1 40%',\n    color: theme.palette.grey[100],\n    opacity: 0.5\n  },\n  primary: {\n    color: theme.palette.grey[100],\n    textAlign: 'center',\n    flex: '1 1 30%',\n    width: '100%'\n  },\n  secondary: {\n    flex: '1 1 30%',\n    width: '100%'\n  }\n}))\n\nconst BrokenImg = () => {\n  const classes = useStyles()\n  return (\n    <div className={classes.root}>\n      <BrokenImageIcon className={classes.icon} />\n      <Typography className={classes.primary}>Img not found</Typography>\n    </div>\n  )\n}\n\nexport default BrokenImg\n","import React, { useState, useRef, useContext, useEffect } from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport useComponentSize from '../../../../lib/useComponentSize'\n\nimport { SeriesContext } from '../../contexts'\nimport XYTagChip from '../tags/XYTagChip'\nimport useXYTags from '../tags/useXYTags'\nimport BrokenImg from './BrokenImg'\nimport style from './Photo.style'\n\nconst useStyles = makeStyles(style)\n\nconst Photo = ({ photo, opacity, edit, showTags, transition, onChange, className }) => {\n  const classes = useStyles()\n  const refImgWrap = useRef(null)\n  const [newSize, setNewSize] = useState({ multiplier: 1 })\n  const [url, setUrl] = useState(null)\n  const [broken, setBroken] = useState(false)\n  const [urlRetryCounter, setURLRetryCounter] = useState(0)\n  const { seriesConfig } = useContext(SeriesContext)\n\n  useEffect(() => {\n    function getURL () {\n      if (!photo.base64) {\n        const newUrl = seriesConfig.getPhotoUrl(photo, 'large')\n        if (refImgWrap.current) setUrl(newUrl)\n      }\n      else {\n        if (refImgWrap.current) setUrl(photo.base64)\n      }\n    }\n    getURL()\n  }, [photo])\n\n  const { size: { height, width }, setResizeActive } = useComponentSize(refImgWrap)\n  const urlWithRetries = urlRetryCounter > 0 ? `${url}?retry=${urlRetryCounter}` : url\n\n  // All tag-related info is put in its own hook\n  const { onAddTagTrigger, TagChooser, getRelXYTags, onTagDragOver, onTagDragStop, onTagDelete } = useXYTags(photo, { height, width }, onChange, setResizeActive)\n\n  const handleImageLoaded = event => {\n    if (refImgWrap.current) {\n      setBroken(false)\n      const { naturalHeight, naturalWidth } = event.target\n      // 4 different cases of orientation:\n      const multiplier = Math.min(\n        height / naturalHeight,\n        width / naturalWidth\n      )\n\n      const newWidth = multiplier * naturalWidth\n      const newHeight = multiplier * naturalHeight\n      setNewSize({ newWidth, newHeight, naturalWidth, naturalHeight, multiplier })\n    }\n  }\n\n  return (\n    <div className={classNames(classes.root, className)}\n      style={{ opacity: opacity !== null ? opacity : 1 }}\n      ref={refImgWrap}\n    >\n      <div className={classes.inner}\n        style={{\n          height: newSize ? newSize.newHeight : 1,\n          width: newSize ? newSize.newWidth : 1\n        }}\n        onClick={onAddTagTrigger}\n      >\n        { showTags || edit\n          ? (\n            <div className={className}>\n              { getRelXYTags(newSize.multiplier).map((tag, idx) => (\n                <XYTagChip\n                  key={`xytag-${idx}`}\n                  color={tag.color}\n                  {...{ edit, newSize, tag, onTagDragOver, onTagDragStop, onTagDelete }} />\n              ))}\n            </div>\n          ) : null\n        }\n        {broken && <BrokenImg />}\n        <img className={classNames(broken ? classes.brokenImg : classes.img)}\n          alt={urlWithRetries}\n          onError={(err) => {\n            if (urlRetryCounter < 10) {\n              setBroken(true)\n              console.log('Image Retry', urlRetryCounter)\n              console.error(err)\n              setTimeout(() => {\n                if (refImgWrap.current) setURLRetryCounter(urlRetryCounter + 1)\n              }, 4000)\n            }\n          }}\n          src={urlWithRetries}\n          onLoad={handleImageLoaded}\n          style={{ height: newSize.newHeight, width: newSize.newWidth }}\n        />\n      </div>\n      {edit && <TagChooser />}\n    </div>\n  )\n}\n\nPhoto.propTypes = {\n  className: PropTypes.string,\n  opacity: PropTypes.number,\n  photo: PropTypes.object.isRequired,\n  edit: PropTypes.bool,\n  showTags: PropTypes.bool,\n  transition: PropTypes.string,\n  onChange: PropTypes.func\n}\n\nexport default Photo\n","// import { fade } from '@material-ui/core/styles/colorManipulator'\nexport default theme => ({\n  root: {\n    // maxWidth: 400,\n    display: 'block',\n    position: 'relative',\n    width: '100%',\n    height: '100%',\n    background: 'black',\n    overflow: 'hidden'\n  },\n  inner: {\n    position: 'absolute',\n    top: '50%',\n    left: '50%',\n    transform: 'translateY(-50%) translateX(-50%)',\n    overflow: 'hidden'\n  },\n  xyTags: {\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    // opacity: 0.8,\n    // border: '4px solid red',\n    height: '100%',\n    width: '100%'\n    // background: 'rgba(150, 150, 150, 0.5)'\n  },\n  img: {\n    display: 'block'\n  },\n  brokenImg: {\n    display: 'none'\n  },\n  formControl: {\n    width: '100%'\n  }\n})\n"],"sourceRoot":""}