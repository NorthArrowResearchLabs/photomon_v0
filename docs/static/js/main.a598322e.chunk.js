(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{10:function(e,t,a){"use strict";a.d(t,"g",function(){return o}),a.d(t,"e",function(){return i}),a.d(t,"d",function(){return l}),a.d(t,"f",function(){return s}),a.d(t,"b",function(){return c}),a.d(t,"a",function(){return u});var n=a(242);t.c={tagColors:["#418CF0","#FCB441","#E0400A","#056492","#BFBFBF","#1A3B69","#FFE382","#129CDD","#CA6B4B","#005CDB","#F3D288","#506381","#F1B9A8","#E0830A","#7893BE"]};var o={mapBoxToken:"pk.eyJ1IjoicmF5Y2hhc2VyIiwiYSI6IlFHWHVMSW8ifQ.emd44Ibp4cmT9YXitY1ziw",styles:n.a},r=Object({NODE_ENV:"production",PUBLIC_URL:"/photomon_v0",REACT_APP_MAPBOX_TOKEN:"pk.eyJ1IjoicmF5Y2hhc2VyIiwiYSI6IlFHWHVMSW8ifQ.emd44Ibp4cmT9YXitY1ziw",REACT_APP_GRAPHQL:"https://11w2bia702.execute-api.us-west-2.amazonaws.com/prod/api",REACT_APP_AWS_REGION:"us-west-2",REACT_APP_COGNITO_IDPOOLID:"us-west-2:ab544d6d-6ea9-430d-8c8f-d895ce172d0f",REACT_APP_COGNITO_USER_POOL_ID:"us-west-2_ninoe7B9g",REACT_APP_COGNITO_CLIENT_ID:"ndtqsua64n6qqp9hef5fh4560",REACT_APP_DOMAIN:"northarrowresearchlabs.github.io",REACT_APP_BASENAME:"photomon_v0"}).REACT_APP_BASEURL;console.log("config: ",r,"photomon_v0");var i={AppStateTypes:{FEED:"feed",MAP:"map",SEARCH:"search",PROFILE:"profile",SERIES:"series",NEW_SERIES_CAMERA:"new_series_camera",NEW_SERIES_LIBRARY:"new_series_library"},SEARCH_TABS:{TAG:"tag",LOCATION:"location",USER:"user"},MapModeTypes:{FREE:"free",USER:"user",TAG:"tag"}},l={graphql:"https://11w2bia702.execute-api.us-west-2.amazonaws.com/prod/api"},s={imgStore:"imgStore"},c={Auth:{region:"us-west-2",userPoolId:"us-west-2_ninoe7B9g",userPoolWebClientId:"ndtqsua64n6qqp9hef5fh4560",mandatorySignIn:!0,cookieStorage:{domain:"".concat("northarrowresearchlabs.github.io"),expires:20,secure:!1}}},u={OPEN:{label:"Open",description:"Open series can be seen and contributed to by anyone",color:"green"},PRIVATE:{label:"Private",description:"Private series can only be seen by their createors",color:"red"},PUBLIC:{label:"Public",description:"Public series can be seen by everyone",color:"blue"}}},102:function(e,t,a){"use strict";var n=a(7),o=a(0),r=a(77),i=function(e,t,a){return e?t?{width:Math.max(t.width,e.offsetWidth),height:Math.max(t.height,e.offsetHeight)}:{width:e.offsetWidth,height:e.offsetHeight}:a||t||{width:0,height:0}};t.a=function(e,t,a){var l=Object(o.useRef)(),s=Object(o.useState)(!0),c=Object(n.a)(s,2),u=c[0],d=c[1];l.current=u;var p=Object(o.useState)(i(e?e.current:null,t,a)),m=Object(n.a)(p,2),h=m[0],g=m[1],b=function(){if(l.current&&e.current){var n=i(e.current,t,a);n.height===h.height&&n.width===h.width||g(n)}},f=Object(o.useCallback)(Object(r.a)(b,500),[]);return Object(o.useLayoutEffect)(function(){if(e.current){if(b(),"function"===typeof ResizeObserver){var t=new ResizeObserver(f);return t.observe(e.current),function(){t.disconnect(e.current),t=null}}return window.addEventListener("resize",f),function(){window.removeEventListener("resize",f)}}},[e.current]),{size:h,setResizeActive:d}}},105:function(e,t,a){"use strict";a.d(t,"d",function(){return r}),a.d(t,"c",function(){return i}),a.d(t,"a",function(){return l}),a.d(t,"b",function(){return s});var n=a(7),o=a(0),r=function(){var e=Object(o.useState)({accuracy:null,altitude:null,altitudeAccuracy:null,heading:null,latitude:null,longitude:null,speed:null,timestamp:Date.now()}),t=Object(n.a)(e,2),a=t[0],r=t[1],i=Object(o.useRef)(),l=Object(o.useRef)();i.current=!0;var s=function(e){i.current&&r({accuracy:e.coords.accuracy,altitude:e.coords.altitude,altitudeAccuracy:e.coords.altitudeAccuracy,heading:e.coords.heading,latitude:e.coords.latitude,longitude:e.coords.longitude,speed:e.coords.speed,timestamp:e.timestamp})};return Object(o.useEffect)(function(){return navigator.geolocation.getCurrentPosition(s),l.current=navigator.geolocation.watchPosition(s),function(){i.current=!1,navigator.geolocation.clearWatch(l.current)}},[navigator.geolocation]),a};function i(){var e=Object(o.useState)({absolute:!1,alpha:null,beta:null,gamma:null}),t=Object(n.a)(e,2),a=t[0],r=t[1];function i(e){r({absolute:e.absolute,alpha:e.alpha,beta:e.beta,gamma:e.gamma})}return Object(o.useEffect)(function(){return window.addEventListener("deviceorientation",i,!0),function(){window.removeEventListener("deviceorientation",i)}},[]),a}var l=function(){return/iphone|ipad|ipod/i.test(window.navigator.userAgent||navigator.vendor||window.opera||"")},s=function(){var e=window.navigator.userAgent||navigator.vendor||window.opera||"";return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i.test(e.substr(0,4))}},127:function(e,t,a){"use strict";var n=a(91),o=a(8),r=a(48),i="SERIES",l="PHOTO";t.a=function e(t){var a=this;if(Object(r.a)(this,e),this.getTagType=function(e){return a.config.tags.find(function(t){return t.id===e})},this.getTagTypeIndex=function(e){return a.config.tags.findIndex(function(t){return t.id===e})},this.getXYTagTypes=function(){return a.config.tags.filter(function(e){return e.allowXY})},this.getNonXYTagTypes=function(){return a.config.tags.filter(function(e){return e.allowNonXY})},this.getSeriesMeta=function(){return Object.keys(a.config.meta).filter(function(e){return a.config.meta[e].type===i}).reduce(function(e,t){return Object(o.a)({},e,Object(n.a)({},t,a.config.meta[t].default))},{})},this.getPhotoMeta=function(){return Object.keys(a.config.meta).filter(function(e){return a.config.meta[e].type===l}).reduce(function(e,t){return Object(o.a)({},e,Object(n.a)({},t,a.config.meta[t].default))},{})},!t)throw new Error("No seriesConfig object provided to SeriesConfig class");this.config=t}},191:function(e,t){},227:function(e,t,a){"use strict";var n=a(46),o=a(0),r=a.n(o),i=a(968),l=a(125),s=a.n(l),c=a(916),u=a(934),d=20,p=Object(c.a)(function(e){return{root:{fontSize:"0.6em",height:d,marginRight:e.spacing(1)/2,marginTop:e.spacing(1)/2},deleteIcon:{width:d-1,height:d-1},chipAvatar:{width:d,height:d}}});t.a=function(e){var t=e.edit,a=e.tag,o=e.color,l=e.onDelete,c=Object(n.a)(e,["edit","tag","color","onDelete"]),d=p(),m=Object(u.a)();return r.a.createElement(i.a,Object.assign({style:{background:o||null,color:o?"".concat(m.palette.getContrastText(o)):null},label:a.label,data:a.id,onDelete:t?function(){return l(a)}:null,deleteIcon:r.a.createElement(s.a,{className:d.deleteIcon,onClick:function(e){console.log("this click")},style:{opacity:.5,color:o?"".concat(m.palette.getContrastText(o)):null}}),className:d.root},c))}},234:function(e,t,a){"use strict";var n=a(0),o=a.n(n),r=a(19),i=a.n(r),l=a(919),s=a(923),c=a(916),u=Object(c.a)(function(e){return{root:{position:"relative",display:"block",overflow:"hidden",whiteSpace:"pre-line","&::before":{content:'"  "',display:"block",position:"absolute",bottom:0,width:"100%",height:100,background:"linear-gradient(180deg, rgba(255,255,255,0) 0%, ".concat(e.palette.background.paper," 100%)")}}}}),d=function(e){var t=e.label,a=e.text,n=e.height,r=e.onClick,c=u();return o.a.createElement("div",{onClick:r},t&&o.a.createElement(s.a,{className:c.formLabel},t),o.a.createElement(l.a,{variant:"body1",color:"inherit",style:{height:n},className:i()(c.root)},a))};d.defaultProps={height:100},t.a=d},235:function(e,t,a){"use strict";var n=a(8),o=a(48),r=a(74),i=a.n(r),l=a(127);t.a=function e(t,a){var r=this;Object(o.a)(this,e),this.findTagById=function(e,t){return r.seriesConfig.getTagType(e).values.find(function(e){return e.id===t})},this.getXYTags=function(){var e=r.seriesConfig.getXYTagTypes().map(function(e){return e.id});return r.tags.filter(function(t){return e.indexOf(t.typeId)>-1&&t.coords&&t.coords.x})},this.getNonXYTags=function(){var e=r.seriesConfig.getNonXYTagTypes().map(function(e){return e.id});return r.tags.filter(function(t){return e.indexOf(t.typeId)>-1})},this.createNewTagObj=function(e,t){return{id:i()(),label:e,typeId:t}},this.createExistingTagObj=function(e,t){return Object(n.a)({},r.findTagById(t,e),{typeId:t})},this.createNewXYTagObj=function(e,t,a){return{id:i()(),label:e,typeId:t,coords:a}},this.createExistingXYTagObj=function(e,t,a){return Object(n.a)({},r.findTagById(t,e),{typeId:t,coords:a})},this.getRelXYTags=function(e){return r.getXYTags().map(function(t){return Object(n.a)({},t,{group:r.seriesConfig.getTagTypeIndex(t.typeId),relCoords:{x:t.coords.x*e,y:t.coords.y*e}})})},this.tags=a,this.seriesConfig=new l.a(t)}},237:function(e,t,a){"use strict";var n=a(46),o=a(0),r=a.n(o),i=a(81),l=a(274),s=a(916),c=Object(s.a)(function(e){return{root:{color:e.palette.primary.main,position:"absolute",top:"50%",left:"50%",textAlign:"center",transformOrigin:"50% 50%",transform:"translateY(-50%) translateX(-50%)",zIndex:1},rootActive:{zIndex:1e3},svgDot:{zIndex:102,width:20,height:20,position:"absolute",top:"50%",left:"50%",textAlign:"center",transformOrigin:"50% 50%",transform:"translateY(-50%) translateX(-50%)"},dot:{stroke:e.palette.secondary.contrastText,strokeWidth:"1",fill:e.palette.secondary.main},directionIndicator:{position:"absolute",left:"50%",zIndex:100},name:{color:"white",fontWeight:"bold",textShadow:"\n        0px 0px 4px #000000, \n        0px 0px 4px #000000 \n    ",zIndex:122,position:"relative"},nameActive:{color:e.palette.secondary.dark,textShadow:"\n    0px 0px 2px #FFFFFF, \n    0px 0px 2px #FFFFFF,\n    0px 0px 4px #FFFFFF \n"}}}),u=function(e){var t=e.direction,a=c();return r.a.createElement("div",{className:a.root},r.a.createElement("svg",{className:a.svgDot,version:"1.1",viewBox:"0, 0, 10, 10"},r.a.createElement("circle",{cx:"5",cy:"5",r:"4",className:a.dot})),t&&t>=0?r.a.createElement("div",{className:a.directionIndicator},r.a.createElement("svg",{className:a.svgArc,version:"1.1",width:"100",height:"100",viewBox:"0, 0, 100, 100",style:{transform:"translateY(-50%) translateX(-50%) rotateZ(".concat(t,"deg)")}},r.a.createElement("path",{d:"M50,0 C60.946,0.151 72.136,3.514 80.675,10.56 L50,50 L19.325,10.56 C27.938,3.461 39,0.278 50,0 z",fill:"#009DC1",fillOpacity:"0.444",strokeWidth:"0.5",strokeOpacity:"0.6",stroke:"#FFFFFF"}))):null)},d=a(7),p=a(209),m=a(102),h=a(256),g=a(10),b=a(19),f=a.n(b),y=(a(407),a(408),function(e){var t=e.controlPadding,a=e.viewport,l=e.children,s=e.mapStyles,c=e.onMapDataEvent,u=Object(n.a)(e,["controlPadding","viewport","children","mapStyles","onMapDataEvent"]),b=Object(o.useRef)(null),y=Object(m.a)(b,{width:100,height:50}).size,w=Object(o.useState)(0),x=Object(d.a)(w,2),E=x[0],O=x[1],k=Object(o.useState)(null),S=Object(d.a)(k,2),j=S[0],C=S[1],N=function(){if(!(!y||y.width<10||y.height<10))try{var e=Object(p.a)(a);C(e)}catch(t){console.error(t)}};return j||N(),Object(o.useMemo)(N,[y]),r.a.createElement("div",{className:f()("BaseMap",e.className),ref:b,style:{height:"100%",width:"100%"}},r.a.createElement(i.e,Object.assign({},a,{height:y.height,width:y.width,mapStyle:s[E].style,onData:c,mapboxApiAccessToken:g.g.mapBoxToken},u),s&&s.length>1?r.a.createElement(h.a,{controlPadding:t,currStyle:E,mapStyles:s,setCurrStyle:O}):null,l&&Array.isArray(l)?l.map(function(e){return v(e,a,y.height,y.width,j)}):v(l,a,y.height,y.width,j)))});function v(e,t,a,n,o){return"function"===typeof e?e(t,a,n,o):e}y.defaultProps={controlPadding:{},stylechooser:!0,initStyle:0,mapStyles:g.g.styles};var w=y;t.a=function(e){var t=e.staticMap,a=e.editable,o=e.latitude,s=e.longitude,c=e.onChange,d=e.direction,p=Object(n.a)(e,["staticMap","editable","latitude","longitude","onChange","direction"]),m=t?w:l.a,h=t?{}:{touchRotate:!1,dragRotate:!1,showMe:a,lockPan:!a,onViewportChange:c};return r.a.createElement(m,Object.assign({},h,p),o&&s?r.a.createElement(i.c,{className:"singleMarker",latitude:o,longitude:s},r.a.createElement(u,{direction:d})):r.a.createElement(u,{direction:d}))}},242:function(e,t,a){"use strict";var n=a(446),o=a(447),r=a(883),i=a(884),l=a(885),s=a(886);t.a=[{toolTip:"Sat",Icon:r.a,ActiveIcon:i.a,color:"green",style:n},{toolTip:"Topo",Icon:l.a,ActiveIcon:s.a,color:"blue",style:o}]},256:function(e,t,a){"use strict";var n=a(7),o=a(0),r=a.n(o),i=a(963),l=a(964),s=a(916),c=a(934),u=Object(s.a)(function(e){return{root:{zIndex:10,position:"absolute"},speedDialFab:{border:"2px solid",background:e.palette.secondary.main,color:e.palette.secondary.contrastText,width:40,height:40},speedDialAction:{border:"2px solid",background:e.palette.primary.main,color:e.palette.primary.contrastText,marginTop:0,marginBottom:0},speedDialIcon:{},speedDialLabel:{background:"black",color:"white"}}}),d=function(e){var t=e.controlPadding,a=e.currStyle,s=e.mapStyles,d=e.setCurrStyle,p=Object(o.useState)(!1),m=Object(n.a)(p,2),h=m[0],g=m[1],b=u(),f=Object(c.a)(),y=function(e,t){console.log("noEventSetOpen",e,t),e.preventDefault(),e.stopPropagation(),g(t)};if(!s||!Array.isArray(s)||s.length<2||!s[a])return null;var v=s[a].ActiveIcon;return r.a.createElement("div",{className:b.root,style:{top:t.top?t.top:f.spacing(2),right:t.right?t.right:f.spacing(2)}},s.length>1&&r.a.createElement(i.a,{ariaLabel:"SpeedDial example",className:b.speedDial,classes:{fab:b.speedDialFab},icon:r.a.createElement(v,{className:b.icon}),onClick:function(e){return y(e,!h)},onClose:function(e){return y(e,!1)},open:h,direction:"left"},s.map(function(e,t){var a=e.Icon,n=(e.ActiveIcon,e.toolTip);return r.a.createElement(l.a,{key:"stylebutton".concat(t),icon:r.a.createElement(a,{className:b.speedDialIcon}),tooltipPlacement:"bottom",ButtonProps:{classes:{root:b.speedDialAction}},TooltipClasses:{tooltip:b.speedDialLabel},tooltipTitle:n,tooltipOpen:!0,onClick:function(){console.log("SET",t),d(t),g(!1)}})})))};d.defaultProps={controlPadding:{}},t.a=d},259:function(e,t,a){"use strict";var n=a(0),o=a.n(n),r=a(919),i=a(945),l=a(941),s=a(944),c=a(943),u=a(126),d=a.n(u),p=a(916),m=Object(p.a)(function(e){return{root:{},body:{overflow:"hidden",whiteSpace:"pre-line",paddingBottom:e.spacing(1)},title:{alignSelf:"flex-start",width:"100%",margin:0,display:"flex",padding:e.spacing(2)},dlgTitle:{flexGrow:1},closeButton:{alignSelf:"flex-start",color:e.palette.grey[500]}}});t.a=function(e){var t=e.open,a=e.onClose,n=e.title,u=e.body,p=m();return o.a.createElement(l.a,{scroll:"paper",open:t,fullWidth:!0,maxWidth:"xl",onClose:a,"aria-labelledby":"simple-dialog-title"},o.a.createElement(c.a,{className:p.title,disableTypography:!0},o.a.createElement(r.a,{className:p.dlgTitle},n),o.a.createElement(s.a,{className:p.closeButton,onClick:a},o.a.createElement(d.a,null))),o.a.createElement(i.a,null,o.a.createElement(r.a,{variant:"body2",className:p.body},u)))}},264:function(e,t,a){"use strict";var n=a(0),o=a.n(n),r=a(941),i=a(943),l=a(945),s=a(931),c=a(919),u=a(949),d=a(916),p=Object(d.a)(function(e){return{}});t.a=function(e){var t=e.title,a=e.message,n=e.onConfirm,d=e.open,m=p();return o.a.createElement(r.a,{className:m.root,disableBackdropClick:!0,open:d,disableEscapeKeyDown:!0,maxWidth:"xl","aria-labelledby":"confirmation-dialog-title"},o.a.createElement(i.a,{id:"confirmation-dialog-title"},t),o.a.createElement(l.a,null,o.a.createElement(c.a,null,a)),o.a.createElement(u.a,null,o.a.createElement(s.a,{onClick:function(){return n(!1)},color:"primary"},"No"),o.a.createElement(s.a,{onClick:function(){return n(!0)},color:"primary"},"Yes")))}},266:function(e,t,a){"use strict";var n=a(7),o=a(0),r=a.n(o),i=a(945),l=a(941),s=a(949),c=a(961),u=a(931),d=a(943),p=a(916),m=Object(p.a)(function(e){return{root:{},body:{overflow:"hidden",whiteSpace:"pre-line",paddingBottom:e.spacing(1)},title:{margin:0,padding:e.spacing(2)},closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]}}});t.a=function(e){var t=e.open,a=e.onOk,p=e.title,h=e.body,g=e.multiline,b=m(),f=Object(o.useState)(h||""),y=Object(n.a)(f,2),v=y[0],w=y[1];return r.a.createElement(l.a,{scroll:"paper",open:t,fullWidth:!0,onClose:function(){return a(v)}},r.a.createElement(d.a,{className:b.title},p),r.a.createElement(i.a,null,r.a.createElement(c.a,{className:b.body,multiline:g,fullWidth:!0,rows:6,rowsMax:20,onChange:function(e){return w(e.target.value)},defaultValue:h})),r.a.createElement(s.a,null,r.a.createElement(u.a,{onClick:function(){return a(h)}},"Cancel"),r.a.createElement("div",{style:{flexGrow:1}}),r.a.createElement(u.a,{onClick:function(){return a(v)}},"Ok")))}},267:function(e,t,a){"use strict";var n=a(7),o=a(0),r=a.n(o),i=a(919),l=a(971),s=a(916),c=Object(s.a)(function(e){return{root:{color:"white",zIndex:10,display:"flex",flexDirection:"column",position:"absolute",height:"50%",top:"45%",left:"0",transform:"translateY(-50%)"},sliderLabel:{display:"block",flexGrow:1,textAlign:"center",padding:e.spacing(3,0,3,0)},container:{},track:{width:"4px!important",background:"white"},thumb:{transform:"translate(50%, -50%)",background:"white",width:30,height:30}}}),u=function(e){var t=e.defaultValue,a=e.onChange,s=c(),u=Object(o.useState)(t),d=Object(n.a)(u,2),p=d[0],m=d[1];return r.a.createElement("div",{className:s.root},r.a.createElement(i.a,{className:s.sliderLabel,color:"inherit",variant:"caption"},"New"),r.a.createElement(l.a,{classes:{container:s.container,track:s.track,thumb:s.thumb},value:p,"aria-labelledby":"label",onChange:function(e,t){m(t),a(t)},vertical:!0}),r.a.createElement(i.a,{className:s.sliderLabel,color:"inherit",variant:"caption"},"Reference"))};u.defaultProps={defaultValue:100,onChange:function(){}},t.a=u},273:function(e,t,a){"use strict";var n=a(7),o=a(0),r=a.n(o),i=a(919),l=a(936),s=a(928),c=a(938),u=a(940),d=a(916),p=a(19),m=a.n(p),h=a(227),g=function(e){return{root:{width:"100%"},tagContainer:{},formControl:{},actionButtons:{textAlign:"right"},noOptionsMessage:{padding:e.spacing(1,2)},singleValue:{fontSize:16},placeholder:{position:"absolute",left:2,fontSize:16},input:{display:"flex",padding:0},valueContainer:{display:"flex",flexWrap:"wrap",flex:1,alignItems:"center",overflow:"hidden"},paper:{position:"absolute",zIndex:1,marginTop:e.spacing(1),left:0,right:0}}},b=Object(d.a)(g),f=function(e){var t=e.tags,a=(e.label,e.tagConfig),n=e.className,o=b(),l=t.filter(function(e){return e.typeId===a.id&&!e.coords});return r.a.createElement("div",{className:m()(o.root,n)},r.a.createElement(i.a,{variant:"overline",className:o.fieldTitle},a.label),r.a.createElement("div",{className:o.tagContainer},l.map(function(e,t){return r.a.createElement(h.a,{tag:e,key:"tagchip".concat(t),color:a.color})})))},y=a(234),v=a(961),w=a(47),x=Object(d.a)(function(e){return{root:{},rootEdit:{},formControl:{width:"100%"},textBody:{whiteSpace:"pre-line"},actionButtons:{textAlign:"right"}}}),E=function(e){var t=e.label,a=e.value,n=e.hint,o=e.onChange,l=e.className,s=x();return r.a.createElement("div",{className:m()(s.root,l)},r.a.createElement(i.a,{variant:"overline",className:s.fieldTitle},t),r.a.createElement(v.a,{type:"datetime-local",fullWidth:!0,value:Object(w.e)(a),className:s.textField,onChange:function(e){return o(Object(w.a)(e.target.value))}}),n&&r.a.createElement(i.a,{variant:"caption",className:s.hint},n))},O=a(235),k=a(266),S=a(259),j=a(945),C=a(941),N=a(949),I=a(931),P=a(943),A=a(944),T=a(126),L=a.n(T),_=a(46),z=a(23),R=a(8),M=a(74),D=a.n(M),F=a(926),B=a(937),U=a(261),$=a(263),W=a.n($),G=Object(d.a)(g),q=function(e){var t=e.tags,a=e.onChange,n=e.hint,o=e.tagConfig,l=e.className,s=G(),c=function(e,n){var r=n.action,i=n.removedValue,l=n.option;switch(r){case"clear":a([]);break;case"remove-value":a(t.filter(function(e){return e.id!==i.value}));break;case"select-option":var s=Object(R.a)({},o.values.find(function(e){return e.id===l.value}),{typeId:o.id});a([].concat(Object(z.a)(t),[s]));break;case"create-option":var c={label:e.find(function(e){return e.__isNew__}).value,id:D()(),typeId:o.id};a([].concat(Object(z.a)(t),[c]))}},u=t.filter(function(e){return e.typeId===o.id&&!e.coords}),d=u.map(function(e){return{label:e.label,value:e.id}}),p=o.values.filter(function(e){return-1===u.map(function(e){return e.id}).indexOf(e.id)}).map(function(e){return{label:e.label,value:e.id}});return r.a.createElement("div",{className:m()(s.root,l)},r.a.createElement(i.a,{variant:"overline",className:s.fieldTitle},o.label),!o.allowAdditions&&r.a.createElement(U.a,{options:p,classes:s,isFocused:!0,components:{Control:H,Menu:V,NoOptionsMessage:Y,Option:J,Placeholder:Q,ValueContainer:Z},deleteRemoves:!0,value:d,isClearable:!1,onChange:c,placeholder:"Select Tags",isMulti:!0,isSearchable:!0}),o.allowAdditions&&r.a.createElement(W.a,{options:p,classes:s,isFocused:!0,deleteRemoves:!0,components:{Control:H,Menu:V,NoOptionsMessage:Y,Option:J,Placeholder:Q,ValueContainer:Z},value:d,isClearable:!1,onChange:c,placeholder:"Select Tags",isMulti:!0,isSearchable:!0}),n&&r.a.createElement(i.a,{variant:"caption",className:s.hint},n))};function H(e){return r.a.createElement(v.a,Object.assign({fullWidth:!0,InputProps:{inputComponent:X,inputProps:{className:e.selectProps.classes.input,inputRef:e.innerRef,children:e.children,onMouseDown:function(t){e.innerProps.onMouseDown(t)},onTouchEnd:function(t){e.innerProps.onTouchEnd(t)}}}},e.selectProps.textFieldProps))}var Y=function(e){var t=e.innerProps,a=e.selectProps,n=e.children;return r.a.createElement(i.a,Object.assign({color:"textSecondary",className:a.classes.noOptionsMessage},t),n)},V=function(e){var t=e.selectProps,a=e.innerProps,n=e.children;return r.a.createElement(F.a,Object.assign({square:!0,className:t.classes.paper},a),n)},X=function(e){var t=e.inputRef,a=Object(_.a)(e,["inputRef"]);return r.a.createElement("div",Object.assign({ref:t},a))},Q=function(e){return r.a.createElement(i.a,Object.assign({color:"textSecondary",className:e.selectProps.classes.placeholder},e.innerProps),e.children)},J=function(e){var t=e.innerRef,a=e.isFocused,n=e.isSelected,o=e.innerProps,i=e.children;return r.a.createElement(B.a,Object.assign({buttonRef:t,selected:a,component:"div",style:{fontWeight:n?500:400}},o),i)},Z=function(e){var t=e.selectProps,a=e.children;return r.a.createElement("div",{className:t.classes.valueContainer},a)},K=Object(d.a)(function(e){return{root:{},dlgContent:{overflowY:"visible!important",paddingBottom:300},title:{width:"100%",margin:0,display:"flex",padding:e.spacing(2)},dlgTitle:{flexGrow:1},closeButton:{color:e.palette.grey[500]}}}),ee=function(e){var t=e.open,a=e.title,l=e.onOk,s=e.onCancel,c=e.tags,u=e.tagConfig,d=K(),p=Object(o.useState)(c),m=Object(n.a)(p,2),h=m[0],g=m[1];return r.a.createElement(C.a,{className:d.root,scroll:"body",fullScreen:!0,open:t,onClose:function(){return l(h)}},r.a.createElement(P.a,{className:d.title,disableTypography:!0},r.a.createElement(i.a,{className:d.dlgTitle},a),r.a.createElement(A.a,{className:d.closeButton,onClick:s},r.a.createElement(L.a,null))),r.a.createElement(j.a,{className:d.dlgContent},r.a.createElement(q,{className:d.field,tags:h,tagConfig:u,onChange:g})),r.a.createElement(N.a,null,r.a.createElement(I.a,{onClick:s},"Cancel"),r.a.createElement("div",{style:{flexGrow:1}}),r.a.createElement(I.a,{onClick:function(){return g(c)}},"Reset"),r.a.createElement(I.a,{onClick:function(){return l(h)}},"Ok")))},te=a(56),ae=Object(d.a)(function(e){return{root:{},rootEdit:{},formControl:{width:"100%"},textBody:{whiteSpace:"pre-line"},actionButtons:{textAlign:"right"}}}),ne=function(e){var t=e.label,a=e.value,n=e.className,o=ae();return r.a.createElement("div",{className:m()(o.root,n)},r.a.createElement(i.a,{variant:"overline",className:o.fieldTitle},t),r.a.createElement(i.a,{variant:"body1",className:o.hint},a?Object(w.d)(a):""))},oe=Object(d.a)(function(e){return{root:{height:"90%",width:"85%"},dlgTitleContainer:{display:"flex",padding:0},catTagTitle:{marginTop:e.spacing(2)},dlgTitle:{flexGrow:1,paddingTop:e.spacing(2),paddingBottom:e.spacing(1),paddingLeft:e.spacing(3)},field:{marginBottom:e.spacing(2)}}}),re="noteEdit",ie="noteView",le="tag";t.a=function(e){var t=e.canEdit,a=e.photo,d=e.delta,p=e.onChange,m=oe(),h=Object(o.useContext)(te.a).seriesConfig,g=Object(o.useState)({}),b=Object(n.a)(g,2),v=b[0],w=v.activeDialog,x=v.activeDialogContext,j=b[1],C=new O.a(h,d.tags||a.tags),N=[];try{N=a.meta?Object.keys(JSON.parse(a.meta)):[]}catch(I){console.error(I)}return r.a.createElement("div",null,t?r.a.createElement(E,{className:m.field,label:"Photo taken on",value:d.takenOn||a.takenOn,onChange:function(e){return p({takenOn:e})},canEdit:t}):r.a.createElement(ne,{label:"Photo taken on",value:d.takenOn||a.takenOn}),(t||a.note)&&r.a.createElement(y.a,{label:"Photo Note",text:d.note||a.note,onClick:function(){j(t?{activeDialog:re}:{activeDialog:ie})}}),r.a.createElement(i.a,{variant:"subtitle1",className:m.catTagTitle},"Category tags"),r.a.createElement(l.a,null),C.seriesConfig.getNonXYTagTypes().map(function(e,n){return r.a.createElement("div",{key:"tagtype-".concat(n),onClick:function(){return t?j({activeDialog:le,activeDialogContext:e}):null}},r.a.createElement(f,{className:m.field,label:e.label,tags:d.tags||a.tags,tagConfig:e}))}),N.length>0&&Object.keys(h.meta).length>0&&r.a.createElement(r.a.Fragment,null,r.a.createElement(i.a,{className:m.heading},"Metadata"),r.a.createElement(l.a,null),r.a.createElement(s.a,{className:m.list},N.map(function(e,t){return h.meta[e]?r.a.createElement(c.a,{key:"metadata".concat(t)},r.a.createElement(u.a,{primary:h.meta[e].label,secondary:h.meta[e].render(a.meta[e])})):null}))),w&&w===re&&r.a.createElement(k.a,{open:!0,multiline:!0,onOk:function(e){p({note:e}),j({})},title:"Edit Photo Note",body:d.note||a.note}),w&&w===ie&&r.a.createElement(S.a,{open:!0,multiline:!0,onClose:function(){return j({})},title:"Photo Note",body:d.note||a.note}),w&&w===le&&r.a.createElement(ee,{open:!0,title:"Edit Tags: ".concat(x.label),onOk:function(e){j({}),p({tags:e})},onCancel:function(){return j({})},tags:d.tags||a.tags,tagConfig:x}))}},274:function(e,t,a){"use strict";var n=a(8),o=a(7),r=a(46),i=a(0),l=a.n(i),s=a(81),c=a(246),u=a(209),d=a(880),p=a(102),m=a(916),h=Object(m.a)(function(e){return{root:{width:1,height:1,zIndex:1},svgDot:{width:20,height:20,position:"absolute",top:"50%",left:"50%",textAlign:"center",transformOrigin:"50% 50%",transform:"translateY(-50%) translateX(-50%)"},svgAccuracyDot:{position:"absolute",top:"50%",left:"50%",textAlign:"center",transformOrigin:"50% 50%",transform:"translateY(-50%) translateX(-50%)"}}}),g=function(e){e.position;var t=e.projection,a=h(),n=20*t.pixelsPerMeter[0],o=20*t.pixelsPerMeter[1];return l.a.createElement("div",{className:a.root},l.a.createElement("svg",{style:{height:n,width:o},className:a.svgAccuracyDot,version:"1.1",viewBox:"0, 0, 100, 100"},l.a.createElement("circle",{cx:"50",cy:"50",r:49,stroke:"#8888FF",fillOpacity:"0.4",strokeWidth:"1",fill:"#AAAAFF"})),l.a.createElement("svg",{className:a.svgDot,version:"1.1",viewBox:"0, 0, 10, 10"},l.a.createElement("circle",{cx:"5",cy:"5",r:"4",stroke:"#FFFFFF",strokeWidth:"1",fill:"#4444FF"})))},b=a(105),f=a(256),y=a(935),v=a(257),w=a.n(v),x=a(934),E=Object(m.a)(function(e){return{root:{border:"1px solid",background:e.palette.grey[100],color:"black",width:40,height:40,zIndex:10,position:"absolute"}}}),O=function(e){var t=e.onClick,a=e.controlPadding,n=e.disabled,o=E(),r=Object(x.a)();return l.a.createElement(y.a,{disabled:n,style:{top:56+(a.top?a.top:r.spacing(2)),right:a.right?a.right:r.spacing(2)},"aria-label":"myLocation",className:o.root,onClick:t},l.a.createElement(w.a,null))},k=a(10),S=a(19),j=a.n(S),C=(a(407),a(408),function(e){var t=e.showMe,a=e.children,m=e.mapStyles,h=e.controlPadding,y=e.viewport,v=e.bounds,w=e.lockToBounds,x=e.lockPan,E=e.initStyle,S=e.onViewportChange,C=e.onTransitionStart,P=e.onTransitionEnd,A=e.transitions,T=e.onMapDataEvent,L=e.stylechooser,_=Object(r.a)(e,["showMe","children","mapStyles","controlPadding","viewport","bounds","lockToBounds","lockPan","initStyle","onViewportChange","onTransitionStart","onTransitionEnd","transitions","onMapDataEvent","stylechooser"]),z=Object(i.useRef)(null),R=Object(i.useRef)(null),M=Object(i.useRef)(null),D=Object(p.a)(z).size,F=Object(i.useState)(E),B=Object(o.a)(F,2),U=B[0],$=B[1],W=Object(i.useState)(Object(n.a)({},N,y)),G=Object(o.a)(W,2),q=G[0],H=G[1],Y=Object(i.useState)(!1),V=Object(o.a)(Y,2),X=V[0],Q=V[1],J=Object(i.useState)(null),Z=Object(o.a)(J,2),K=Z[0],ee=Z[1],te={};t&&(te=Object(b.d)());var ae=te.latitude&&te.longitude?l.a.createElement(s.c,{key:"myPos",className:"myPosMarker",latitude:te.latitude,longitude:te.longitude,style:{zIndex:1}},l.a.createElement(g,{position:te,projection:K})):null;Object(i.useMemo)(function(){if(!(!D||D.width<10||D.height<10)){m.length<=U&&$(E);try{var e=Object(u.a)(q);ee(e)}catch(t){console.log("ERROR",q),console.error(t)}}},[q.zoom,D]);var ne=function(e){var t=Object(n.a)({},e);v&&w&&(t.longitude<v[0]?t.longitude=v[0]:t.longitude>v[2]&&(t.longitude=v[2]),t.latitude<v[1]?t.latitude=v[1]:t.latitude>v[3]&&(t.latitude=v[3])),x&&(t.latitude=q.latitude,t.longitude=q.longitude),X||"function"!==typeof S||S({viewport:t,size:D,projection:K,map:R.current&&R.current.getMap()}),H(t)};return Object(i.useMemo)(function(){if(!(!v||!D||D.width<10||D.height<10||X)){var e=Object(o.a)(v,4),t=e[0],a=e[1],r=e[2],i=e[3];try{console.log("recalcZoomBounds");var l=new d.a(Object(n.a)({},D,q)).fitBounds([[t,a],[r,i]],{padding:40,offset:[0,0]}),s=l.longitude,c=l.latitude,u=l.zoom;console.log("Changing Zoom ",v,q.zoom,u,q),H(Object(n.a)({},q,{longitude:s,latitude:c,zoom:u}))}catch(p){console.error(p)}}},[D,v]),Object(i.useEffect)(function(){H(Object(n.a)({},q,y))},[y]),l.a.createElement("div",{className:j()("mapContainer",e.className),ref:z},D.height>0&&D.width>0&&l.a.createElement(s.f,Object.assign({},q,M.current||A,{ref:function(e){R.current=e},height:D.height,width:D.width,mapStyle:U<m.length?m[U].style:m[0].style,onData:T,onTransitionStart:function(){console.log("handleTransitionStart (internal)"),Q(!0),"function"===typeof C&&C()},onTransitionEnd:function(){console.log("handleTransitionEnd (internal)"),Q(!1),M.current=null,P&&P(),"function"===typeof S&&S({viewport:q,size:D,projection:K,map:R.current&&R.current.getMap()})},dragPan:!x,onViewportChange:ne,mapboxApiAccessToken:k.g.mapBoxToken},_),a&&Array.isArray(a)?a.map(function(e,t){return e?l.a.cloneElement(I(e,q,D.height,D.width,K),{key:"mapChild-".concat(t)}):null}):I(a,q,D.height,D.width,K),L&&l.a.createElement(f.a,{controlPadding:h,currStyle:U,mapStyles:m,setCurrStyle:$}),!e.hideNavControls&&l.a.createElement(s.d,{onViewportChange:function(e){return ne(Object(n.a)({},e,D))},showZoom:!1===!e.touchZoom&&!1===!e.scrollZoom,showCompass:!1===!e.touchRotate&&!1===!e.dragRotate}),t&&l.a.createElement(l.a.Fragment,null,ae,l.a.createElement(O,{disabled:!te||!te.latitude,controlPadding:h,onClick:function(){te.latitude&&te.longitude&&(M.current={transitionDuration:2e3,transitionInterpolator:new s.a,transitionEasing:c.a},setTimeout(function(){M.current&&(M.current=null)},2e3),H(Object(n.a)({},q,{latitude:te.latitude,longitude:te.longitude,zoom:q.zoom>10?q.zoom:12})))}}))))});C.defaultProps={controlPadding:{},stylechooser:!0,initStyle:0,mapStyles:k.g.styles,lockToBounds:!1};t.a=C;var N={latitude:49.3050394,longitude:-123.1398254,bearing:0,pitch:0,zoom:12};function I(e,t,a,n,o){return"function"===typeof e?e(t,a,n,o):e}},275:function(e,t,a){"use strict";var n=a(8),o=a(7),r=a(0),i=a.n(r),l=a(961),s=a(923),c=a(919),u=a(954),d=a(967),p=a(916),m=a(237),h=a(945),g=a(941),b=a(949),f=a(931),y=a(943),v=a(971),w=Object(p.a)(function(e){return{root:{},dlgContent:{display:"flex",flexDirection:"column",padding:0},mapWrapper:{flexGrow:1},sliderWrapper:{padding:"20px"},slider:{padding:"22px 0px"},sliderRoor:{padding:"0 20px"},body:{overflow:"hidden",whiteSpace:"pre-line",paddingBottom:e.spacing(1)},title:{background:e.palette.primary.main,color:e.palette.primary.contrastText,margin:0,padding:e.spacing(2)},closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]}}}),x=function(e){var t=e.open,a=e.onOk,n=e.onCancel,l=e.title,u=e.latitude,d=e.longitude,p=e.direction,x=w(),E=Object(r.useState)({longitude:d,latitude:u}),O=Object(o.a)(E,2),k=O[0],S=k.longitude,j=k.latitude,C=O[1],N=Object(r.useState)(p),I=Object(o.a)(N,2),P=I[0],A=I[1],T=Object(r.useMemo)(function(){return{zoom:18,latitude:u,longitude:d}},[u,d]);return i.a.createElement(g.a,{scroll:"paper",open:t,fullWidth:!0,fullScreen:!0,onClose:n},i.a.createElement(y.a,{className:x.title,disableTypography:!0},i.a.createElement(c.a,{color:"inherit"},l)),i.a.createElement(h.a,{className:x.dlgContent},i.a.createElement("div",{className:x.mapWrapper},i.a.createElement(m.a,{editable:!0,className:x.map,direction:P>0?P:null,viewport:T,onChange:function(e){var t=e.viewport,a=t.longitude,n=t.latitude;return C({longitude:a,latitude:n})}})),i.a.createElement("div",{className:x.sliderWrapper},i.a.createElement(s.a,{className:x.mapFormLabel},"Direction ",P>-1?"":"(off)"),i.a.createElement(v.a,{classes:{root:x.sliderRoor,container:x.slider},value:P||-1,min:-1,max:360,step:1,onChange:function(e,t){return A(t)}}))),i.a.createElement(b.a,null,i.a.createElement(f.a,{onClick:n},"Cancel"),i.a.createElement("div",{style:{flexGrow:1}}),i.a.createElement(f.a,{onClick:function(){return a({longitude:S,latitude:j,direction:P})}},"Ok")))},E=a(266),O=a(10),k=a(234),S="mapPicker",j="noteEdit",C=Object(p.a)(function(e){return{root:{},inner:{display:"flex",flexDirection:"column"},dlgTitle:{background:e.palette.primary.main,color:e.palette.primary.contrastText},access:{display:"flex"},accessRadio:{flex:"1 1 50%"},grow:{flexGrow:1},field:{flexGrow:0,marginBottom:2*e.spacing(1)},slider:{paddingLeft:e.spacing(1),paddingRight:e.spacing(1)},textField:{marginLeft:e.spacing(1),marginRight:e.spacing(1),width:"100%"},formLabel:{display:"block",marginTop:e.spacing(1),marginBottom:e.spacing(1)},mapFormLabel:{display:"block",marginTop:e.spacing(1),marginBottom:e.spacing(1)},mapInnerWrap:{flexGrow:1,height:"200px",minHeight:"200px"},mapWrapper:{flexGrow:1,display:"flex",flexDirection:"column",paddingBottom:2*e.spacing(1)},formControl:{margin:e.spacing(1),minWidth:120},chips:{display:"flex",flexWrap:"wrap"}}});t.a=function(e){var t=e.series,a=e.delta,p=e.onChange,h=C(),g=Object(r.useState)(null),b=Object(o.a)(g,2),f=b[0],y=b[1],v={zoom:18};(a.latitude||t.coords[1])&&(a.longitude||t.coords[0])&&(v.longitude=a.longitude||t.coords[0],v.latitude=a.latitude||t.coords[1]);var w=a.access||t.access||"PRIVATE";return i.a.createElement("div",null,i.a.createElement(l.a,{label:"Series Name",fullWidth:!0,placeholder:"New Series",className:h.field,value:a.name||t.name||"",onChange:function(e){return p(Object(n.a)({},a,{name:e.target.value}))}}),i.a.createElement("div",{className:h.mapWrapper,onClick:function(){return y(S)}},i.a.createElement(s.a,{className:h.mapFormLabel},"Location"),i.a.createElement("div",{className:h.mapInnerWrap},i.a.createElement(m.a,{staticMap:!0,className:h.map,direction:a.direction||t.direction,viewport:v}))),i.a.createElement("div",{className:h.field},i.a.createElement(s.a,null,"Series Access"),i.a.createElement("div",{className:h.access},i.a.createElement(u.a,{className:h.accessRadio,control:i.a.createElement(d.a,{checked:["OPEN","PUBLIC"].indexOf(w)>-1,onChange:function(e){p(Object(n.a)({},a,{access:e.target.checked?"PUBLIC":"PRIVATE"}))},value:"PUBLIC"}),label:i.a.createElement("div",null,i.a.createElement(c.a,{variant:"body2",component:"div"},O.a.PUBLIC.label),i.a.createElement(c.a,{variant:"caption",component:"div"},O.a.PUBLIC.description))}),i.a.createElement(u.a,{className:h.accessRadio,disabled:["PRIVATE"].indexOf(w)>-1,control:i.a.createElement(d.a,{checked:["OPEN"].indexOf(w)>-1,onChange:function(e){return p(Object(n.a)({},a,{access:e.target.checked?"OPEN":"PUBLIC"}))},value:"OPEN"}),label:i.a.createElement("div",null,i.a.createElement(c.a,{variant:"body2",component:"div"},O.a.OPEN.label),i.a.createElement(c.a,{variant:"caption",component:"div"},O.a.OPEN.description))}))),i.a.createElement(k.a,{onClick:function(){return y(j)},className:h.field,label:"Series Note",text:a.note||t.note}),f===S&&i.a.createElement(x,{open:!0,title:"Series Location & Direction",latitude:a.latitude||t.coords[1],longitude:a.longitude||t.coords[0],direction:a.direction||t.direction,onOk:function(e){p(Object(n.a)({},a,e)),y(null)},onCancel:function(){return y(null)}}),f===j&&i.a.createElement(E.a,{open:!0,title:"Series Note",body:a.note||t.note,multiline:!0,onOk:function(e){p(Object(n.a)({},a,{note:e})),y(null)},onCancel:function(){return y(null)}}))}},276:function(e,t,a){"use strict";var n=a(23),o=a(7),r=a(0),i=a.n(r),l=a(19),s=a.n(l),c=a(950),u=a(951),d=a(946),p=a(962),m=a(931),h=a(935),g=a(265),b=a.n(g),f=a(461),y=a.n(f),v=a(56),w=a(916),x=a(445),E=a(264),O=a(47),k=Object(w.a)(function(e){return{root:{},tile:{},addFab:{position:"absolute",zIndex:10,top:e.spacing(1),left:e.spacing(1),opacity:.3},notDeleteable:{background:"black",opacity:.1},unSelectedTile:{"& img":{opacity:.7}},selectedTile:{padding:"".concat(e.spacing(2),"px!important"),"& img":{opacity:1}},img:{},snackbarContent:{backgroundColor:x.a[700]},snackbar:{}}}),S=function(e){var t=e.photos,a=e.columns,l=e.multiSelect,g=e.onDelete,f=e.onTileClick,w=Object(r.useState)(!1),x=Object(o.a)(w,2),S=x[0],j=x[1],C=k(),N=Object(r.useState)([]),I=Object(o.a)(N,2),P=I[0],A=I[1],T=Object(r.useState)(!1),L=Object(o.a)(T,2),_=L[0],z=L[1],R=Object(r.useContext)(v.a),M=R.seriesConfig,D=R.ac,F=function(){j(!1),A([])},B=function(e){if(P.indexOf(e)<0)A([].concat(Object(n.a)(P),[e]));else{var t=P.filter(function(t){return t!==e});0===t.length&&F(),A(t)}},U=Object(n.a)(t);return U.sort(function(e,t){return parseInt(t.takenOn,10)-parseInt(e.takenOn,10)}),i.a.createElement("div",null,i.a.createElement(c.a,{cols:a,cellHeight:200,className:C.root},U.map(function(e,t){var a=P.indexOf(e.id)>-1,n=D.canUser("delete",e,"photo"),o=M.getPhotoUrl(e,"thumb")||e.base64;return i.a.createElement(u.a,{key:"gridTile".concat(t),onClick:function(t){return n&&function(e,t){e.preventDefault(),e.stopPropagation(),S?B(t.id):f(t.id)}(t,e)},className:s()(C.tile,S&&!n&&C.notDeleteable,S&&n&&!a&&C.unSelectedTile,S&&a&&C.selectedTile)},i.a.createElement("img",{src:o,alt:o,className:C.img}),n&&l&&i.a.createElement(h.a,{size:"small","aria-label":"Add",className:C.addFab,onClick:function(t){return function(e,t){e.preventDefault(),e.stopPropagation(),j(!0),B(t)}(t,e.id)}},S&&a?i.a.createElement(y.a,null):i.a.createElement(b.a,null)),i.a.createElement(d.a,{title:i.a.createElement("span",null,Object(O.d)(e.takenOn))}))})),i.a.createElement(p.a,{open:S,autoHideDuration:null,ContentProps:{"aria-describedby":"snackbar-fab-message-id",className:C.snackbarContent},message:i.a.createElement("span",{id:"snackbar-fab-message-id"},P.length," Photos selected"),action:i.a.createElement("div",null,i.a.createElement(m.a,{color:"inherit",disabled:P.length>=t.length,size:"small",onClick:function(){return z(!0)}},"Delete"),i.a.createElement(m.a,{color:"inherit",size:"small",onClick:function(){return F()}},"Cancel")),className:C.snackbar}),i.a.createElement(E.a,{open:_,onConfirm:function(e){z(!1),!0===e&&P.length<t.length&&g(P),F()},title:"Delete ".concat(P.length," Photos"),message:"Are you sure you want to delete these photos?"}))};S.defaultProps={multiSelect:!0,columns:2};t.a=S},310:function(e,t,a){"use strict";(function(e){var n=a(23),o=a(8),r=a(7),i=a(0),l=a.n(i),s=a(311),c=a.n(s),u=a(77),d=a(494),p=a(492),m=a(493),h=a(496),g=a(312),b=a(470),f=a(105),y=a(56),v="camera",w="library",x="photoreview",E="photoinfoedit";t.a=function(t){var a=t.inputMethod,s=t.onCreate,O=t.onCancel,k=t.isNewSeries,S=Object(i.useContext)(y.a),j=S.seriesConfig,C=S.series,N=Object(i.useState)(null),I=Object(r.a)(N,2),P=I[0],A=I[1],T=Object(i.useState)(k?new b.a(j).series:null),L=Object(r.a)(T,2),_=L[0],z=L[1],R=Object(i.useState)(null),M=Object(r.a)(R,2),D=M[0],F=M[1],B=Object(i.useState)({current:a,history:[]}),U=Object(r.a)(B,2),$=U[0],W=U[1],G=Object(f.c)(),q=Object(f.d)(),H=C&&C.photos?C.photos:[],Y=function(e){console.log("NEWPHOTO changeMode",$,e),W({current:e,history:[].concat(Object(n.a)($.history),[$.current])})},V=null;switch($.current){case v:V=l.a.createElement(p.a,{photos:H,onShutter:function(t,a){var n=new g.a(j).photo;console.log("onShutter Debug GOT DATA",{data:t});var r={},i=t.base64.indexOf("base64,")+"base64,".length,l=t.base64.slice(i),s=c.a.create(e.from(l,"base64"));console.log("onLibraryAdd Buffered");try{r=s.parse(),console.log("got EXIF",JSON.stringify(r))}catch(p){console.error("EXIF ERROR",p)}if(k){var u=q.latitude,d=q.longitude;u&&d||(u=49.3050394,d=-123.1398254),z(Object(o.a)({},_,{latitude:u,longitude:d}))}A(Object(o.a)({},n,{rawData:{orient:G,geolocate:q},base64:t.base64})),F(a),Y(x)},onCancel:O});break;case w:V=l.a.createElement(h.a,{onLibraryAdd:function(t){console.log("onLibraryAdd Debug GOT DATA",{data:t});var a={},n=t.indexOf("base64,")+"base64,".length,r=t.slice(n),i=c.a.create(e.from(r,"base64"));console.log("onLibraryAdd Buffered");try{a=i.parse(),console.log("got EXIF",JSON.stringify(a))}catch(h){console.error("EXIF ERROR",h)}var l=String(Date.now());try{l=String(a.tags.DateTimeOriginal)}catch(h){console.log("EXIF",a),console.error("ERROR GETTING TIMESTAMP",h)}if(console.log("isNewSeries",{isNewSeries:k}),k){var s=q.latitude,d=q.longitude;s&&d||(s=49.3050394,d=-123.1398254);try{a.tags.GPSLatitude&&Object(u.b)(a.tags.GPSLatitude)&&a.tags.GPSLongitude&&Object(u.b)(a.tags.GPSLongitude)&&(s=a.tags.GPSLatitude,d=a.tags.GPSLongitude)}catch(b){console.error("GPS Longitude and Latitude could not be determined")}console.log("LATLONG FOR LIB PICK",{geo:q,latitude:s,longitude:d}),z(Object(o.a)({},_,{latitude:s,longitude:d}))}var p=new g.a(j).photo,m=Object(o.a)({},p,{takenOn:l,rawData:{exif:a},base64:t});A(m),Y(x),console.log("onLibraryAdd FINISHED",m)}});break;case x:V=l.a.createElement(d.a,{defaultRefPhotoId:D,photos:H,captured:P,onConfirm:function(){return Y(E)},onCancel:O,onRetry:function(){if($.history.length>0){var e=Object(n.a)($.history),t=e.pop();W({current:t,history:e})}else O()}});break;case E:V=l.a.createElement(m.a,{photo:P,newSeries:_,onSave:s,onCancel:O});break;default:console.log("NEWPHOTO: default state. you should NEVER see this",$),O()}return V}}).call(this,a(36).Buffer)},312:function(e,t,a){"use strict";var n=a(48),o=a(74),r=a.n(o),i=a(47),l=a(127);t.a=function e(t,a){var o=this;Object(n.a)(this,e),this.setMeta=function(){o.meta=JSON.stringify(o.config.getPhotoMeta())},this.newPhoto=function(){return{id:"_"+r()(),takenOn:Object(i.b)(new Date),meta:JSON.stringify(o.config.getPhotoMeta()),tags:[]}},this.config=new l.a(t),this.photo=a||this.newPhoto()}},408:function(e,t,a){},443:function(e,t){},446:function(e){e.exports={version:8,name:"TheProductMapboxGL",glyphs:"mapbox://fonts/raychaser/{fontstack}/{range}.pbf",metadata:{"mapbox:autocomposite":!0,"mapbox:type":"default"},sources:{MapBaseLayer:{url:"mapbox://mapbox.satellite",type:"raster",tileSize:256}},layers:[{id:"background",type:"background",paint:{"background-color":"rgb(0,0,0)"},interactive:!1},{id:"MapBaseLayer",type:"raster",source:"MapBaseLayer","source-layer":"MapBaseLayer",interactive:!1,paint:{"raster-opacity":1}}]}},447:function(e){e.exports={version:8,name:"Outdoors",metadata:{"mapbox:autocomposite":!0,"mapbox:type":"default","mapbox:groups":{1444934828655.3389:{name:"Aeroways",collapsed:!0},1444933322393.2852:{name:"POI labels  (scalerank 1)",collapsed:!0},1444934749452.0452:{name:"Wetlands",collapsed:!0},1444855786460.0557:{name:"Roads",collapsed:!0},1444933575858.6992:{name:"Highway shields",collapsed:!0},1444934295202.7542:{name:"Admin boundaries",collapsed:!0},1444856151690.9143:{name:"State labels",collapsed:!0},1444933721429.3076:{name:"Road labels",collapsed:!0},1444933358918.2366:{name:"POI labels (scalerank 2)",collapsed:!0},1444933808272.805:{name:"Water labels",collapsed:!0},1444855815295.714:{name:"Hillshading",collapsed:!0},1444855831248.8289:{name:"Landcover",collapsed:!0},1444933372896.5967:{name:"POI labels (scalerank 3)",collapsed:!0},1444855799204.86:{name:"Bridges",collapsed:!0},1444856087950.3635:{name:"Marine labels",collapsed:!0},1444862510685.128:{name:"City labels",collapsed:!0},1444855769305.6016:{name:"Tunnels",collapsed:!0},1444856144497.7825:{name:"Country labels",collapsed:!0},1444933456003.5437:{name:"POI labels (scalerank 4)",collapsed:!0},1444933837268.9458:{name:"Contour lines",collapsed:!0}},"mapbox:trackposition":!0},sources:{composite:{url:"mapbox://mapbox.mapbox-terrain-v2,mapbox.mapbox-streets-v7",type:"vector"}},sprite:"mapbox://sprites/pipbailey/cj66v6i8c4hnc2so16ngtlovn",glyphs:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",layers:[{id:"background",type:"background",layout:{},paint:{"background-color":{base:1,stops:[[11,"hsl(35, 32%, 91%)"],[13,"hsl(35, 12%, 89%)"]]}},interactive:!0},{id:"landcover_crop",type:"fill",metadata:{"mapbox:group":"1444855831248.8289"},source:"composite","source-layer":"landcover",maxzoom:12,filter:["==","class","crop"],layout:{},paint:{"fill-color":"hsl(75, 62%, 81%)","fill-opacity":{base:1.5,stops:[[2,.3],[12,0]]},"fill-antialias":!1},interactive:!0},{id:"landcover_grass",type:"fill",metadata:{"mapbox:group":"1444855831248.8289"},source:"composite","source-layer":"landcover",maxzoom:12,filter:["==","class","grass"],layout:{},paint:{"fill-color":"hsl(75, 62%, 81%)","fill-opacity":{base:1.5,stops:[[2,.3],[12,0]]},"fill-antialias":!1},interactive:!0},{id:"landcover_scrub",type:"fill",metadata:{"mapbox:group":"1444855831248.8289"},source:"composite","source-layer":"landcover",maxzoom:12,filter:["==","class","scrub"],layout:{},paint:{"fill-color":"hsl(75, 62%, 81%)","fill-opacity":{base:1.5,stops:[[2,.3],[12,0]]},"fill-antialias":!1},interactive:!0},{id:"landcover_wood",type:"fill",metadata:{"mapbox:group":"1444855831248.8289"},source:"composite","source-layer":"landcover",maxzoom:12,filter:["==","class","wood"],layout:{},paint:{"fill-color":"hsl(75, 62%, 81%)","fill-opacity":{base:1.5,stops:[[2,.3],[12,0]]},"fill-antialias":!1},interactive:!0},{id:"landcover_snow",type:"fill",metadata:{"mapbox:group":"1444855831248.8289"},source:"composite","source-layer":"landcover",filter:["==","class","snow"],layout:{},paint:{"fill-color":"hsl(0, 0%, 100%)","fill-opacity":.2,"fill-antialias":!1},interactive:!0},{id:"national_park",type:"fill",source:"composite","source-layer":"landuse_overlay",filter:["==","class","national_park"],layout:{},paint:{"fill-color":"hsl(100, 59%, 76%)","fill-opacity":{base:1,stops:[[5,0],[5.5,.75],[9,.75],[10,.35]]}},interactive:!0},{id:"scrub",type:"fill",source:"composite","source-layer":"landuse",minzoom:9,filter:["==","class","scrub"],layout:{},paint:{"fill-color":"hsl(75, 41%, 74%)","fill-opacity":{base:1,stops:[[9,0],[15,.2]]}},interactive:!0},{id:"grass",type:"fill",source:"composite","source-layer":"landuse",minzoom:9,filter:["==","class","grass"],layout:{},paint:{"fill-color":"hsl(75, 41%, 74%)","fill-opacity":{base:1,stops:[[9,0],[15,.4]]}},interactive:!0},{id:"wood",type:"fill",source:"composite","source-layer":"landuse",minzoom:6,filter:["==","class","wood"],layout:{},paint:{"fill-color":"hsl(75, 41%, 74%)","fill-opacity":{base:1,stops:[[7,0],[15,.5]]}},interactive:!0},{id:"agriculture",type:"fill",source:"composite","source-layer":"landuse",minzoom:11,filter:["==","class","agriculture"],layout:{},paint:{"fill-opacity":{base:1,stops:[[11,0],[14,.75]]},"fill-color":"hsl(75, 37%, 81%)","fill-outline-color":"hsl(75, 32%, 68%)"},interactive:!0},{id:"national_park-tint-band",type:"line",source:"composite","source-layer":"landuse_overlay",minzoom:9,filter:["==","class","national_park"],layout:{"line-cap":"round"},paint:{"line-color":"hsl(100, 62%, 74%)","line-width":{base:1.4,stops:[[9,1],[14,8]]},"line-offset":{base:1.4,stops:[[9,0],[14,-2.5]]},"line-opacity":{base:1,stops:[[9,0],[10,.75]]},"line-blur":3},interactive:!0},{id:"national_park-outline",type:"line",source:"composite","source-layer":"landuse_overlay",minzoom:9,filter:["==","class","national_park"],layout:{},paint:{"line-color":{base:1,stops:[[12,"hsl(100, 49%, 71%)"],[14,"hsl(100, 40%, 67%)"]]},"line-width":{base:1,stops:[[9,.75],[12,1]]},"line-offset":0,"line-opacity":{base:1,stops:[[9,0],[10,1]]}},interactive:!0},{id:"park",type:"fill",source:"composite","source-layer":"landuse",filter:["all",["!in","type","garden","golf_course","playground","zoo"],["==","class","park"]],layout:{},paint:{"fill-color":"hsl(100, 59%, 76%)","fill-opacity":{base:1,stops:[[5,0],[6,1]]}},interactive:!0},{id:"other-green-areas",type:"fill",source:"composite","source-layer":"landuse",filter:["all",["==","class","park"],["in","type","garden","golf_course","playground","zoo"]],layout:{},paint:{"fill-color":"hsl(100, 59%, 81%)","fill-opacity":{base:1,stops:[[5,0],[6,1]]}},interactive:!0},{id:"glacier",type:"fill",source:"composite","source-layer":"landuse",minzoom:9,filter:["==","class","glacier"],layout:{},paint:{"fill-color":"hsl(196, 71%, 93%)","fill-opacity":{base:1,stops:[[9,0],[10,.5]]}},interactive:!0},{id:"pitch",type:"fill",source:"composite","source-layer":"landuse",filter:["==","class","pitch"],layout:{},paint:{"fill-color":"hsl(100, 57%, 72%)"},interactive:!0},{id:"pitch-line",type:"line",source:"composite","source-layer":"landuse",minzoom:15,filter:["==","class","pitch"],layout:{"line-join":"miter"},paint:{"line-color":"hsl(75, 57%, 84%)"},interactive:!0},{id:"sand",type:"fill",source:"composite","source-layer":"landuse",filter:["==","class","sand"],layout:{},paint:{"fill-color":"hsl(60, 46%, 87%)"},interactive:!0},{id:"contour-line",type:"line",metadata:{"mapbox:group":"1444933837268.9458"},source:"composite","source-layer":"contour",minzoom:11,filter:["!in","index",10,5],layout:{},paint:{"line-opacity":{base:1,stops:[[11,.15],[12,.3]]},"line-color":"hsl(100, 100%, 20%)","line-width":{base:1,stops:[[13,.5],[16,.8]]},"line-offset":{base:1,stops:[[13,1],[16,1.6]]}},interactive:!0},{id:"contour-line-index",type:"line",metadata:{"mapbox:group":"1444933837268.9458"},source:"composite","source-layer":"contour",minzoom:11,filter:["in","index",10,5],layout:{},paint:{"line-opacity":{base:1,stops:[[11,.25],[12,.5]]},"line-color":"hsl(100, 100%, 20%)","line-width":{base:1,stops:[[13,.6],[16,1.2]]},"line-offset":{base:1,stops:[[13,.6],[16,1.2]]}},interactive:!0},{id:"hillshade_highlight_bright",type:"fill",metadata:{"mapbox:group":"1444855815295.714"},source:"composite","source-layer":"hillshade",maxzoom:18,filter:["==","level",94],layout:{},paint:{"fill-color":"hsl(0, 0%, 100%)","fill-opacity":{stops:[[15,.15],[18,0]]},"fill-antialias":!1},interactive:!0},{id:"hillshade_highlight_med",type:"fill",metadata:{"mapbox:group":"1444855815295.714"},source:"composite","source-layer":"hillshade",filter:["==","level",90],layout:{},paint:{"fill-color":"hsl(0, 0%, 100%)","fill-opacity":{stops:[[15,.15],[18,0]]},"fill-antialias":!1},interactive:!0},{id:"hillshade_shadow_faint",type:"fill",metadata:{"mapbox:group":"1444855815295.714"},source:"composite","source-layer":"hillshade",maxzoom:17,filter:["==","level",89],layout:{},paint:{"fill-color":"hsl(56, 59%, 22%)","fill-opacity":{stops:[[15,.07],[17,0]]},"fill-antialias":!1},interactive:!0},{id:"hillshade_shadow_med",type:"fill",metadata:{"mapbox:group":"1444855815295.714"},source:"composite","source-layer":"hillshade",filter:["==","level",78],layout:{},paint:{"fill-color":"hsl(56, 59%, 22%)","fill-opacity":{stops:[[15,.07],[17,0]]},"fill-antialias":!1},interactive:!0},{id:"hillshade_shadow_dark",type:"fill",metadata:{"mapbox:group":"1444855815295.714"},source:"composite","source-layer":"hillshade",filter:["==","level",67],layout:{},paint:{"fill-color":"hsl(56, 59%, 22%)","fill-opacity":{stops:[[15,.08],[17,0]]},"fill-antialias":!1},interactive:!0},{id:"hillshade_shadow_extreme",type:"fill",metadata:{"mapbox:group":"1444855815295.714"},source:"composite","source-layer":"hillshade",maxzoom:17,filter:["==","level",56],layout:{},paint:{"fill-color":"hsl(56, 59%, 22%)","fill-opacity":{stops:[[15,.08],[17,0]]},"fill-antialias":!1},interactive:!0},{id:"waterway-river-canal-shadow",type:"line",source:"composite","source-layer":"waterway",minzoom:8,filter:["in","class","canal","river"],layout:{"line-cap":{base:1,stops:[[0,"butt"],[11,"round"]]},"line-join":"round"},paint:{"line-color":"hsl(215, 84%, 69%)","line-width":{base:1.3,stops:[[8.5,.4],[20,8]]},"line-opacity":{base:1,stops:[[8,0],[8.5,1]]},"line-translate":{base:1.2,stops:[[7,[0,0]],[16,[-1,-1]]]},"line-translate-anchor":"viewport"},interactive:!0},{id:"waterway-river-canal",type:"line",source:"composite","source-layer":"waterway",minzoom:8,filter:["in","class","canal","river"],layout:{"line-cap":{base:1,stops:[[0,"butt"],[11,"round"]]},"line-join":"round"},paint:{"line-color":"hsl(205, 87%, 76%)","line-width":{base:1.3,stops:[[8.5,.4],[20,8]]},"line-opacity":{base:1,stops:[[8,0],[8.5,1]]}},interactive:!0},{id:"waterway-small",type:"line",source:"composite","source-layer":"waterway",minzoom:13,filter:["!in","class","canal","river"],layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"hsl(205, 87%, 76%)","line-width":{base:1.35,stops:[[13.5,.4],[20,3]]},"line-opacity":{base:1,stops:[[13,0],[13.5,1]]}},interactive:!0},{id:"water-shadow",type:"fill",source:"composite","source-layer":"water",layout:{},paint:{"fill-color":"hsl(215, 84%, 69%)","fill-translate":{base:1.2,stops:[[7,[0,0]],[16,[-1,-1]]]},"fill-translate-anchor":"viewport","fill-opacity":1},interactive:!0},{id:"water",type:"fill",source:"composite","source-layer":"water",layout:{},paint:{"fill-color":"hsl(196, 80%, 70%)"},interactive:!0},{id:"wetlands",type:"fill",metadata:{"mapbox:group":"1444934749452.0452"},source:"composite","source-layer":"landuse_overlay",filter:["in","class","wetland","wetland_noveg"],layout:{},paint:{"fill-color":"hsl(185, 43%, 74%)","fill-opacity":{base:1,stops:[[10,.25],[10.5,.15]]}},interactive:!0},{id:"wetlands-pattern",type:"fill",metadata:{"mapbox:group":"1444934749452.0452"},source:"composite","source-layer":"landuse_overlay",filter:["in","class","wetland","wetland_noveg"],layout:{},paint:{"fill-color":"hsl(185, 43%, 74%)","fill-opacity":{base:1,stops:[[10,0],[10.5,1]]},"fill-pattern":"wetland","fill-translate-anchor":"viewport"},interactive:!0},{id:"barrier_line-land-polygon",type:"fill",source:"composite","source-layer":"barrier_line",filter:["all",["==","$type","Polygon"],["==","class","land"]],layout:{},paint:{"fill-color":"hsl(35, 12%, 89%)"},interactive:!0},{id:"barrier_line-land-line",type:"line",source:"composite","source-layer":"barrier_line",filter:["all",["==","$type","LineString"],["==","class","land"]],layout:{"line-cap":"round"},paint:{"line-width":{base:1.99,stops:[[14,.75],[20,40]]},"line-color":"hsl(35, 12%, 89%)"},interactive:!0},{id:"tunnel-street-low",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",minzoom:11,filter:["all",["==","$type","LineString"],["all",["==","class","street"],["==","structure","tunnel"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12.5,.5],[14,2],[18,18]]},"line-color":"hsl(0, 0%, 100%)","line-opacity":{stops:[[11.5,0],[12,1],[14,1],[14.01,0]]}},interactive:!0},{id:"tunnel-street_limited-low",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",minzoom:11,filter:["all",["==","$type","LineString"],["all",["==","class","street_limited"],["==","structure","tunnel"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12.5,.5],[14,2],[18,18]]},"line-color":"hsl(0, 0%, 100%)","line-opacity":{stops:[[11.5,0],[12,1],[14,1],[14.01,0]]}},interactive:!0},{id:"tunnel-track-case",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["==","class","track"],["==","structure","tunnel"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12,.75],[20,2]]},"line-color":"hsl(50, 100%, 40%)","line-gap-width":{base:1.5,stops:[[15,1],[18,12]]},"line-dasharray":[3,3]},interactive:!0},{id:"tunnel-service-link-case",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",minzoom:14,filter:["all",["==","$type","LineString"],["all",["!=","type","trunk_link"],["==","structure","tunnel"],["in","class","link","service"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12,.75],[20,2]]},"line-color":"hsl(230, 19%, 75%)","line-gap-width":{base:1.5,stops:[[14,.5],[18,12]]},"line-dasharray":[3,3]},interactive:!0},{id:"tunnel-street_limited-case",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",minzoom:11,filter:["all",["==","$type","LineString"],["all",["==","class","street_limited"],["==","structure","tunnel"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12,.75],[20,2]]},"line-color":"hsl(230, 19%, 75%)","line-gap-width":{base:1.5,stops:[[13,0],[14,2],[18,18]]},"line-dasharray":[3,3],"line-opacity":{base:1,stops:[[13.99,0],[14,1]]}},interactive:!0},{id:"tunnel-street-case",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",minzoom:11,filter:["all",["==","$type","LineString"],["all",["==","class","street"],["==","structure","tunnel"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12,.75],[20,2]]},"line-color":"hsl(230, 19%, 75%)","line-gap-width":{base:1.5,stops:[[13,0],[14,2],[18,18]]},"line-dasharray":[3,3],"line-opacity":{base:1,stops:[[13.99,0],[14,1]]}},interactive:!0},{id:"tunnel-secondary-tertiary-case",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["==","structure","tunnel"],["in","class","secondary","tertiary"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.2,stops:[[10,.75],[18,2]]},"line-dasharray":[3,3],"line-gap-width":{base:1.5,stops:[[8.5,.5],[10,.75],[18,26]]},"line-color":"hsl(230, 19%, 75%)"},interactive:!0},{id:"tunnel-primary-case",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["==","class","primary"],["==","structure","tunnel"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[5,.75],[16,2]]},"line-dasharray":[3,3],"line-gap-width":{base:1.5,stops:[[5,.75],[18,32]]},"line-color":"hsl(230, 19%, 75%)"},interactive:!0},{id:"tunnel-trunk_link-case",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==","$type","LineString"],["all",["==","structure","tunnel"],["==","type","trunk_link"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12,.75],[20,2]]},"line-color":"hsl(0, 0%, 100%)","line-gap-width":{base:1.5,stops:[[12,.5],[14,2],[18,18]]},"line-dasharray":[3,3]},interactive:!0},{id:"tunnel-motorway_link-case",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==","$type","LineString"],["all",["==","class","motorway_link"],["==","structure","tunnel"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12,.75],[20,2]]},"line-color":"hsl(0, 0%, 100%)","line-gap-width":{base:1.5,stops:[[12,.5],[14,2],[18,18]]},"line-dasharray":[3,3]},interactive:!0},{id:"tunnel-trunk-case",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["==","structure","tunnel"],["==","type","trunk"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[5,.75],[16,2]]},"line-color":"hsl(0, 0%, 100%)","line-gap-width":{base:1.5,stops:[[5,.75],[18,32]]},"line-opacity":1,"line-dasharray":[3,3]},interactive:!0},{id:"tunnel-motorway-case",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["==","class","motorway"],["==","structure","tunnel"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[5,.75],[16,2]]},"line-color":"hsl(0, 0%, 100%)","line-gap-width":{base:1.5,stops:[[5,.75],[18,32]]},"line-opacity":1,"line-dasharray":[3,3]},interactive:!0},{id:"tunnel-construction",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",minzoom:14,filter:["all",["==","$type","LineString"],["all",["==","class","construction"],["==","structure","tunnel"]]],layout:{"line-join":"miter"},paint:{"line-width":{base:1.5,stops:[[12.5,.5],[14,2],[18,18]]},"line-color":"hsl(230, 24%, 87%)","line-opacity":{base:1,stops:[[13.99,0],[14,1]]},"line-dasharray":{base:1,stops:[[14,[.4,.8]],[15,[.3,.6]],[16,[.2,.3]],[17,[.2,.25]],[18,[.15,.15]]]}},interactive:!0},{id:"tunnel-path",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["!in","type","cycleway","piste","steps"],["==","class","path"],["==","structure","tunnel"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[15,1],[18,4]]},"line-dasharray":{base:1,stops:[[14,[4,.4]],[15,[3,.4]],[16,[3,.35]],[17,[3,.35]]]},"line-color":"hsl(35, 26%, 95%)","line-opacity":{base:1,stops:[[13,0],[13.25,1]]}},interactive:!0},{id:"tunnel-cycleway-piste",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["==","class","path"],["==","structure","tunnel"],["in","type","cycleway","piste"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[15,1],[18,4]]},"line-dasharray":{base:1,stops:[[14,[4,.4]],[15,[3,.4]],[16,[3,.35]],[17,[3,.35]]]},"line-color":"hsl(35, 26%, 95%)","line-opacity":{base:1,stops:[[13,0],[13.25,1]]}},interactive:!0},{id:"tunnel-steps",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["==","structure","tunnel"],["==","type","steps"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[15,1],[16,1.6],[18,6]]},"line-color":"hsl(35, 26%, 95%)","line-dasharray":{base:1,stops:[[14,[4,.4]],[15,[1.75,.4]],[16,[.75,.4]],[17,[.3,.3]]]},"line-opacity":{base:1,stops:[[13,0],[13.25,1]]}},interactive:!0},{id:"tunnel-trunk_link",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==","$type","LineString"],["all",["==","structure","tunnel"],["==","type","trunk_link"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12,.5],[14,2],[18,18]]},"line-color":"hsl(46, 77%, 78%)","line-opacity":1,"line-dasharray":[1,0]},interactive:!0},{id:"tunnel-motorway_link",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==","$type","LineString"],["all",["==","class","motorway_link"],["==","structure","tunnel"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12,.5],[14,2],[18,18]]},"line-color":"hsl(26, 74%, 81%)","line-opacity":1,"line-dasharray":[1,0]},interactive:!0},{id:"tunnel-pedestrian",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==","$type","LineString"],["all",["==","class","pedestrian"],["==","structure","tunnel"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[14,.5],[18,12]]},"line-color":"hsl(0, 0%, 100%)","line-opacity":1,"line-dasharray":{base:1,stops:[[14,[1,0]],[15,[1.5,.4]],[16,[1,.2]]]}},interactive:!0},{id:"tunnel-track",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["==","class","track"],["==","structure","tunnel"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[15,1],[18,12]]},"line-color":"hsl(0, 0%, 100%)"},interactive:!0},{id:"tunnel-service-link",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",minzoom:14,filter:["all",["==","$type","LineString"],["all",["!=","type","trunk_link"],["==","structure","tunnel"],["in","class","link","service"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[14,.5],[18,12]]},"line-color":"hsl(0, 0%, 100%)","line-dasharray":[1,0]},interactive:!0},{id:"tunnel-street_limited",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",minzoom:11,filter:["all",["==","$type","LineString"],["all",["==","class","street_limited"],["==","structure","tunnel"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12.5,.5],[14,2],[18,18]]},"line-color":"hsl(35, 14%, 93%)","line-opacity":{base:1,stops:[[13.99,0],[14,1]]}},interactive:!0},{id:"tunnel-street",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",minzoom:11,filter:["all",["==","$type","LineString"],["all",["==","class","street"],["==","structure","tunnel"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12.5,.5],[14,2],[18,18]]},"line-color":"hsl(0, 0%, 100%)","line-opacity":{base:1,stops:[[13.99,0],[14,1]]}},interactive:!0},{id:"tunnel-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["==","structure","tunnel"],["in","class","secondary","tertiary"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[8.5,.5],[10,.75],[18,26]]},"line-color":"hsl(0, 0%, 100%)","line-opacity":1,"line-dasharray":[1,0],"line-blur":0},interactive:!0},{id:"tunnel-primary",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["==","class","primary"],["==","structure","tunnel"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[5,.75],[18,32]]},"line-color":"hsl(0, 0%, 100%)","line-opacity":1,"line-dasharray":[1,0],"line-blur":0},interactive:!0},{id:"tunnel-oneway-arrows-blue-minor",type:"symbol",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",minzoom:16,filter:["all",["==","$type","LineString"],["all",["!=","type","trunk_link"],["==","oneway","true"],["==","structure","tunnel"],["in","class","link","path","pedestrian","service","track"]]],layout:{"symbol-placement":"line","icon-image":{base:1,stops:[[17,"oneway-small"],[18,"oneway-large"]]},"symbol-spacing":200,"icon-padding":2},paint:{},interactive:!0},{id:"tunnel-oneway-arrows-blue-major",type:"symbol",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",minzoom:15,filter:["all",["==","$type","LineString"],["all",["!=","type","trunk_link"],["==","oneway","true"],["==","structure","tunnel"],["in","class","primary","secondary","street","street_limited","tertiary"]]],layout:{"symbol-placement":"line","icon-image":{base:1,stops:[[16,"oneway-small"],[17,"oneway-large"]]},"symbol-spacing":200,"icon-padding":2},paint:{},interactive:!0},{id:"tunnel-trunk",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["==","class","trunk"],["==","structure","tunnel"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[5,.75],[18,32]]},"line-color":"hsl(46, 77%, 78%)"},interactive:!0},{id:"tunnel-motorway",type:"line",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["==","class","motorway"],["==","structure","tunnel"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[5,.75],[18,32]]},"line-dasharray":[1,0],"line-opacity":1,"line-color":"hsl(26, 74%, 81%)","line-blur":0},interactive:!0},{id:"tunnel-oneway-arrows-white",type:"symbol",metadata:{"mapbox:group":"1444855769305.6016"},source:"composite","source-layer":"road",minzoom:16,filter:["all",["==","$type","LineString"],["all",["!in","type","primary_link","secondary_link","tertiary_link"],["==","oneway","true"],["==","structure","tunnel"],["in","class","link","trunk"]]],layout:{"symbol-placement":"line","icon-image":{base:1,stops:[[16,"oneway-white-small"],[17,"oneway-white-large"]]},"symbol-spacing":200,"icon-padding":2},paint:{"icon-opacity":.5},interactive:!0},{id:"cliffs",type:"line",source:"composite","source-layer":"barrier_line",minzoom:15,filter:["==","class","cliff"],layout:{"line-cap":"round","line-join":"round"},paint:{"line-opacity":{base:1,stops:[[15,0],[15.25,1]]},"line-width":10,"line-pattern":"cliff"},interactive:!0},{id:"ferry",type:"line",source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["==","type","ferry"]],layout:{"line-join":"round"},paint:{"line-color":{base:1,stops:[[15,"hsl(205, 73%, 63%)"],[17,"hsl(230, 73%, 63%)"]]},"line-opacity":1,"line-width":{base:1.5,stops:[[14,.5],[20,1]]},"line-dasharray":{base:1,stops:[[12,[1,0]],[13,[12,4]]]}},interactive:!0},{id:"ferry-auto",type:"line",source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["==","type","ferry_auto"]],layout:{"line-join":"round"},paint:{"line-color":{base:1,stops:[[15,"hsl(205, 73%, 63%)"],[17,"hsl(230, 73%, 63%)"]]},"line-opacity":1,"line-width":{base:1.5,stops:[[14,.5],[20,1]]}},interactive:!0},{id:"road-path-bg",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["!in","structure","bridge","tunnel"],["!in","type","corridor","crossing","piste","sidewalk","steps"],["==","class","path"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[15,2.5],[18,8]]},"line-opacity":{base:1,stops:[[13,0],[13.25,1]]},"line-color":"hsl(50, 100%, 40%)","line-blur":{base:1,stops:[[14,0],[17,1]]}},interactive:!0},{id:"road-piste-bg",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["!in","structure","bridge","tunnel"],["==","class","path"],["==","type","piste"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[15,2],[18,7]]},"line-opacity":{base:1,stops:[[13,0],[13.25,1]]},"line-color":"hsl(230, 85%, 67%)","line-blur":0},interactive:!0},{id:"road-sidewalk-corridor-bg",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:16,filter:["all",["==","$type","LineString"],["all",["!in","structure","bridge","tunnel"],["in","type","corridor","crossing","sidewalk"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[15,2],[18,7]]},"line-dasharray":[1,0],"line-color":"hsl(230, 17%, 82%)","line-blur":0,"line-opacity":{base:1,stops:[[16,0],[16.25,.25]]}},interactive:!0},{id:"road-steps-bg",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["!in","structure","bridge","tunnel"],["==","type","steps"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[15,2.5],[18,8]]},"line-color":"hsl(50, 100%, 40%)","line-blur":{base:1,stops:[[14,0],[17,1]]},"line-opacity":{base:1,stops:[[13,0],[13.25,.25]]}},interactive:!0},{id:"road-pedestrian-case",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:12,filter:["all",["==","$type","LineString"],["all",["==","class","pedestrian"],["==","structure","none"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[14,2],[18,14.5]]},"line-color":"hsl(230, 24%, 87%)","line-gap-width":0,"line-opacity":{base:1,stops:[[13.99,0],[14,1]]}},interactive:!0},{id:"road-street-low",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:11,filter:["all",["==","$type","LineString"],["all",["==","class","street"],["==","structure","none"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12.5,.5],[14,2],[18,18]]},"line-color":"hsl(0, 0%, 100%)","line-opacity":{stops:[[11,0],[11.25,1],[14,1],[14.01,0]]}},interactive:!0},{id:"road-street_limited-low",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:11,filter:["all",["==","$type","LineString"],["all",["==","class","street_limited"],["==","structure","none"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12.5,.5],[14,2],[18,18]]},"line-color":"hsl(0, 0%, 100%)","line-opacity":{stops:[[11,0],[11.25,1],[14,1],[14.01,0]]}},interactive:!0},{id:"road-track-case",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["!in","structure","bridge","tunnel"],["==","class","track"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12,.75],[20,2]]},"line-color":"hsl(50, 100%, 40%)","line-gap-width":{base:1.5,stops:[[15,1],[18,12]]}},interactive:!0},{id:"road-service-link-case",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:14,filter:["all",["==","$type","LineString"],["all",["!=","type","trunk_link"],["!in","structure","bridge","tunnel"],["in","class","link","service"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12,.75],[20,2]]},"line-color":"hsl(230, 24%, 87%)","line-gap-width":{base:1.5,stops:[[14,.5],[18,12]]}},interactive:!0},{id:"road-street_limited-case",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:11,filter:["all",["==","$type","LineString"],["all",["==","class","street_limited"],["==","structure","none"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12,.75],[20,2]]},"line-color":"hsl(230, 24%, 87%)","line-gap-width":{base:1.5,stops:[[13,0],[14,2],[18,18]]},"line-opacity":{base:1,stops:[[13.99,0],[14,1]]}},interactive:!0},{id:"road-street-case",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:11,filter:["all",["==","$type","LineString"],["all",["==","class","street"],["==","structure","none"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12,.75],[20,2]]},"line-color":"hsl(230, 24%, 87%)","line-gap-width":{base:1.5,stops:[[13,0],[14,2],[18,18]]},"line-opacity":{base:1,stops:[[13.99,0],[14,1]]}},interactive:!0},{id:"road-secondary-tertiary-case",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["!in","structure","bridge","tunnel"],["in","class","secondary","tertiary"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.2,stops:[[10,.75],[18,2]]},"line-color":"hsl(230, 24%, 87%)","line-gap-width":{base:1.5,stops:[[8.5,.5],[10,.75],[18,26]]},"line-opacity":{base:1,stops:[[9.99,0],[10,1]]}},interactive:!0},{id:"road-primary-case",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["!in","structure","bridge","tunnel"],["==","class","primary"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[5,.75],[16,2]]},"line-color":"hsl(230, 24%, 87%)","line-gap-width":{base:1.5,stops:[[5,.75],[18,32]]},"line-opacity":{base:1,stops:[[9.99,0],[10,1]]}},interactive:!0},{id:"road-motorway_link-case",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:10,filter:["all",["==","$type","LineString"],["all",["!in","structure","bridge","tunnel"],["==","class","motorway_link"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12,.75],[20,2]]},"line-color":"hsl(0, 0%, 100%)","line-gap-width":{base:1.5,stops:[[12,.5],[14,2],[18,18]]},"line-opacity":{base:1,stops:[[10.99,0],[11,1]]}},interactive:!0},{id:"road-trunk_link-case",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:11,filter:["all",["==","$type","LineString"],["all",["!in","structure","bridge","tunnel"],["==","type","trunk_link"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12,.75],[20,2]]},"line-color":"hsl(0, 0%, 100%)","line-gap-width":{base:1.5,stops:[[12,.5],[14,2],[18,18]]},"line-opacity":{base:1,stops:[[10.99,0],[11,1]]}},interactive:!0},{id:"road-trunk-case",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["!in","structure","bridge","tunnel"],["==","class","trunk"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[10,1],[16,2]]},"line-color":"hsl(0, 0%, 100%)","line-gap-width":{base:1.5,stops:[[5,.75],[18,32]]},"line-opacity":{base:1,stops:[[6,0],[6.1,1]]}},interactive:!0},{id:"road-motorway-case",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["!in","structure","bridge","tunnel"],["==","class","motorway"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[10,1],[16,2]]},"line-color":"hsl(0, 0%, 100%)","line-gap-width":{base:1.5,stops:[[5,.75],[18,32]]}},interactive:!0},{id:"road-construction",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:14,filter:["all",["==","$type","LineString"],["all",["==","class","construction"],["==","structure","none"]]],layout:{"line-join":"miter"},paint:{"line-width":{base:1.5,stops:[[12.5,.5],[14,2],[18,18]]},"line-color":"hsl(230, 24%, 87%)","line-opacity":{base:1,stops:[[13.99,0],[14,1]]},"line-dasharray":{base:1,stops:[[14,[.4,.8]],[15,[.3,.6]],[16,[.2,.3]],[17,[.2,.25]],[18,[.15,.15]]]}},interactive:!0},{id:"road-sidewalk-corridor",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:16,filter:["all",["==","$type","LineString"],["all",["!in","structure","bridge","tunnel"],["in","type","corridor","crossing","sidewalk"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[15,1],[18,4]]},"line-color":"hsl(0, 0%, 100%)","line-dasharray":{base:1,stops:[[14,[4,.4]],[15,[3,.4]],[16,[3,.35]],[17,[3,.35]]]},"line-opacity":{base:1,stops:[[16,0],[16.25,1]]}},interactive:!0},{id:"road-path-smooth",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["!in","structure","bridge","tunnel"],["==","class","path"],["in","type","bridleway","footway","path"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[15,1],[18,4]]},"line-color":"hsl(0, 0%, 100%)","line-dasharray":{base:1,stops:[[14,[4,.4]],[15,[3,.4]],[16,[3,.35]],[17,[3,.35]]]},"line-opacity":{base:1,stops:[[13,0],[13.25,1]]}},interactive:!0},{id:"road-path-rough",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["!in","structure","bridge","tunnel"],["==","class","path"],["in","type","hiking","mountain_bike","trail"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[15,1],[18,4]]},"line-color":"hsl(0, 0%, 100%)","line-dasharray":{base:1,stops:[[14,[4,.4]],[15,[1.75,.4]],[16,[1,.4]],[17,[1,.35]]]},"line-opacity":{base:1,stops:[[13,0],[13.25,1]]}},interactive:!0},{id:"road-cycleway-piste",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["!in","structure","bridge","tunnel"],["==","class","path"],["in","type","cycleway","piste"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[15,1],[18,4]]},"line-color":"hsl(0, 0%, 100%)","line-opacity":{base:1,stops:[[13,0],[13.25,1]]}},interactive:!0},{id:"road-steps",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["!in","structure","bridge","tunnel"],["==","type","steps"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[15,1],[16,1.6],[18,6]]},"line-color":"hsl(0, 0%, 100%)","line-dasharray":{base:1,stops:[[14,[4,.4]],[15,[1.75,.4]],[16,[.75,.4]],[17,[.3,.3]]]},"line-opacity":{base:1,stops:[[13,0],[13.25,1]]}},interactive:!0},{id:"road-trunk_link",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:11,filter:["all",["==","$type","LineString"],["all",["!in","structure","bridge","tunnel"],["==","type","trunk_link"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12,.5],[14,2],[18,18]]},"line-color":"hsl(46, 69%, 68%)","line-opacity":1},interactive:!0},{id:"road-motorway_link",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:10,filter:["all",["==","$type","LineString"],["all",["!in","structure","bridge","tunnel"],["==","class","motorway_link"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12,.5],[14,2],[18,18]]},"line-color":"hsl(26, 67%, 70%)","line-opacity":1},interactive:!0},{id:"road-pedestrian",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:12,filter:["all",["==","$type","LineString"],["all",["==","class","pedestrian"],["==","structure","none"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[14,.5],[18,12]]},"line-color":"hsl(0, 0%, 100%)","line-opacity":1,"line-dasharray":{base:1,stops:[[14,[1,0]],[15,[1.5,.4]],[16,[1,.2]]]}},interactive:!0},{id:"road-pedestrian-polygon-fill",type:"fill",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:12,filter:["all",["==","$type","Polygon"],["all",["==","structure","none"],["in","class","path","pedestrian"]]],layout:{},paint:{"fill-color":{base:1,stops:[[16,"hsl(230, 16%, 94%)"],[16.25,"hsl(230, 50%, 98%)"]]},"fill-outline-color":"hsl(230, 26%, 88%)","fill-opacity":1},interactive:!0},{id:"road-pedestrian-polygon-pattern",type:"fill",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:12,filter:["all",["==","$type","Polygon"],["all",["==","structure","none"],["in","class","path","pedestrian"]]],layout:{},paint:{"fill-color":"hsl(0, 0%, 100%)","fill-outline-color":"hsl(35, 10%, 83%)","fill-pattern":"pedestrian-polygon","fill-opacity":{base:1,stops:[[16,0],[16.25,1]]}},interactive:!0},{id:"road-polygon",type:"fill",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:12,filter:["all",["==","$type","Polygon"],["all",["!in","class","motorway","path","pedestrian","trunk"],["!in","structure","bridge","tunnel"]]],layout:{},paint:{"fill-color":"hsl(0, 0%, 100%)","fill-outline-color":"hsl(0, 0%, 100%)"},interactive:!0},{id:"road-track",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["!in","structure","bridge","tunnel"],["==","class","track"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[15,1],[18,12]]},"line-color":"hsl(0, 0%, 100%)"},interactive:!0},{id:"road-service-link",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:14,filter:["all",["==","$type","LineString"],["all",["!=","type","trunk_link"],["!in","structure","bridge","tunnel"],["in","class","link","service"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[14,.5],[18,12]]},"line-color":"hsl(0, 0%, 100%)"},interactive:!0},{id:"road-street_limited",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:11,filter:["all",["==","$type","LineString"],["all",["==","class","street_limited"],["==","structure","none"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12.5,.5],[14,2],[18,18]]},"line-color":"hsl(35, 14%, 93%)","line-opacity":{base:1,stops:[[13.99,0],[14,1]]}},interactive:!0},{id:"road-street",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:11,filter:["all",["==","$type","LineString"],["all",["==","class","street"],["==","structure","none"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12.5,.5],[14,2],[18,18]]},"line-color":"hsl(0, 0%, 100%)","line-opacity":{base:1,stops:[[13.99,0],[14,1]]}},interactive:!0},{id:"road-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["!in","structure","bridge","tunnel"],["in","class","secondary","tertiary"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[8.5,.5],[10,.75],[18,26]]},"line-color":{base:1,stops:[[5,"hsl(35, 32%, 91%)"],[8,"hsl(0, 0%, 100%)"]]},"line-opacity":{base:1.2,stops:[[5,0],[5.5,1]]}},interactive:!0},{id:"road-primary",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["!in","structure","bridge","tunnel"],["==","class","primary"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[5,.75],[18,32]]},"line-color":{base:1,stops:[[5,"hsl(35, 32%, 91%)"],[8,"hsl(0, 0%, 100%)"]]},"line-opacity":{base:1.2,stops:[[5,0],[5.5,1]]}},interactive:!0},{id:"road-oneway-arrows-blue-minor",type:"symbol",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:16,filter:["all",["==","$type","LineString"],["all",["!=","type","trunk_link"],["!in","structure","bridge","tunnel"],["==","oneway","true"],["in","class","link","path","pedestrian","service","track"]]],layout:{"symbol-placement":"line","icon-image":{base:1,stops:[[17,"oneway-small"],[18,"oneway-large"]]},"icon-rotation-alignment":"map","icon-padding":2,"symbol-spacing":200},paint:{},interactive:!0},{id:"road-oneway-arrows-blue-major",type:"symbol",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:15,filter:["all",["==","$type","LineString"],["all",["!=","type","trunk_link"],["!in","structure","bridge","tunnel"],["==","oneway","true"],["in","class","primary","secondary","street","street_limited","tertiary"]]],layout:{"symbol-placement":"line","icon-image":{base:1,stops:[[16,"oneway-small"],[17,"oneway-large"]]},"icon-rotation-alignment":"map","icon-padding":2,"symbol-spacing":200},paint:{},interactive:!0},{id:"road-trunk",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["!in","structure","bridge","tunnel"],["==","class","trunk"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[5,.75],[18,32]]},"line-color":{base:1,stops:[[6,"hsl(0, 0%, 100%)"],[6.1,"hsl(46, 80%, 60%)"],[9,"hsl(46, 69%, 68%)"]]}},interactive:!0},{id:"road-motorway",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["!in","structure","bridge","tunnel"],["==","class","motorway"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[5,.75],[18,32]]},"line-color":{base:1,stops:[[8,"hsl(26, 87%, 62%)"],[9,"hsl(26, 67%, 70%)"]]}},interactive:!0},{id:"road-rail",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==","$type","LineString"],["all",["!in","structure","bridge","tunnel"],["in","class","major_rail","minor_rail"]]],layout:{"line-join":"round"},paint:{"line-color":{stops:[[13,"hsl(50, 17%, 82%)"],[16,"hsl(230, 10%, 74%)"]]},"line-width":{base:1.5,stops:[[14,.5],[20,1]]}},interactive:!0},{id:"road-rail-tracks",type:"line",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==","$type","LineString"],["all",["!in","structure","bridge","tunnel"],["in","class","major_rail","minor_rail"]]],layout:{"line-join":"round"},paint:{"line-color":{stops:[[13,"hsl(50, 17%, 82%)"],[16,"hsl(230, 10%, 74%)"]]},"line-width":{base:1.5,stops:[[14,4],[20,8]]},"line-dasharray":[.1,15],"line-opacity":{base:1,stops:[[13.75,0],[14,1]]}},interactive:!0},{id:"level-crossing",type:"symbol",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:16,filter:["all",["==","$type","Point"],["==","class","level_crossing"]],layout:{"icon-allow-overlap":!0,"icon-size":1,"icon-image":"level-crossing"},paint:{"icon-opacity":1},interactive:!0},{id:"road-oneway-arrows-white",type:"symbol",metadata:{"mapbox:group":"1444855786460.0557"},source:"composite","source-layer":"road",minzoom:16,filter:["all",["==","$type","LineString"],["all",["!in","structure","bridge","tunnel"],["!in","type","primary_link","secondary_link","tertiary_link"],["==","oneway","true"],["in","class","link","trunk"]]],layout:{"symbol-placement":"line","icon-image":{base:1,stops:[[16,"oneway-white-small"],[17,"oneway-white-large"]]},"icon-padding":2,"symbol-spacing":200},paint:{"icon-opacity":.5},interactive:!0},{id:"hedges",type:"line",source:"composite","source-layer":"barrier_line",minzoom:16,filter:["==","class","hedge"],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"hsl(100, 59%, 70%)","line-width":{base:1,stops:[[16,1],[20,3]]},"line-opacity":1,"line-dasharray":[1,2,5,2,1,2]},interactive:!0},{id:"fences",type:"line",source:"composite","source-layer":"barrier_line",minzoom:16,filter:["==","class","fence"],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"hsl(46, 17%, 76%)","line-width":{base:1,stops:[[16,1],[20,3]]},"line-opacity":1,"line-dasharray":[1,2,5,2,1,2]},interactive:!0},{id:"gates",type:"line",source:"composite","source-layer":"barrier_line",minzoom:17,filter:["==","class","gate"],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"hsl(46, 17%, 76%)","line-width":{base:1,stops:[[16,1],[20,3]]},"line-opacity":.5,"line-dasharray":[1,2,5,2,1,2]},interactive:!0},{id:"bridge-path-bg",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["!in","type","piste","steps"],["==","class","path"],["==","structure","bridge"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[15,2.5],[18,8]]},"line-opacity":{base:1,stops:[[13,0],[13.25,1]]},"line-color":"hsl(50, 100%, 40%)","line-blur":{base:1,stops:[[14,0],[17,1]]}},interactive:!0},{id:"bridge-piste-bg",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["==","class","path"],["==","structure","bridge"],["==","type","piste"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[15,2],[18,7]]},"line-dasharray":[1,0],"line-color":"hsl(205, 63%, 60%)","line-blur":0,"line-opacity":{base:1,stops:[[13,0],[13.25,1]]}},interactive:!0},{id:"bridge-steps-bg",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["==","structure","bridge"],["==","type","steps"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[15,2.5],[18,8]]},"line-color":"hsl(50, 100%, 40%)","line-opacity":{base:1,stops:[[13,0],[13.25,1]]},"line-blur":{base:1,stops:[[14,0],[17,1]]}},interactive:!0},{id:"bridge-pedestrian-case",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==","$type","LineString"],["all",["==","class","pedestrian"],["==","structure","bridge"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[14,2],[18,14.5]]},"line-color":"hsl(230, 24%, 87%)","line-gap-width":0,"line-opacity":{base:1,stops:[[13.99,0],[14,1]]}},interactive:!0},{id:"bridge-street-low",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:11,filter:["all",["==","$type","LineString"],["all",["==","class","street"],["==","structure","bridge"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12.5,.5],[14,2],[18,18]]},"line-color":"hsl(0, 0%, 100%)","line-opacity":{stops:[[11.5,0],[12,1],[14,1],[14.01,0]]}},interactive:!0},{id:"bridge-street_limited-low",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:11,filter:["all",["==","$type","LineString"],["all",["==","class","street_limited"],["==","structure","bridge"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12.5,.5],[14,2],[18,18]]},"line-color":"hsl(0, 0%, 100%)","line-opacity":{stops:[[11.5,0],[12,1],[14,1],[14.01,0]]}},interactive:!0},{id:"bridge-track-case",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["==","class","track"],["==","structure","bridge"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12,.75],[20,2]]},"line-color":"hsl(50, 100%, 40%)","line-gap-width":{base:1.5,stops:[[15,1],[18,12]]}},interactive:!0},{id:"bridge-service-link-case",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:14,filter:["all",["==","$type","LineString"],["all",["!=","type","trunk_link"],["==","structure","bridge"],["in","class","link","service"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12,.75],[20,2]]},"line-color":"hsl(230, 24%, 87%)","line-gap-width":{base:1.5,stops:[[14,.5],[18,12]]}},interactive:!0},{id:"bridge-street_limited-case",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:11,filter:["all",["==","$type","LineString"],["all",["==","class","street_limited"],["==","structure","bridge"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12,.75],[20,2]]},"line-color":"hsl(230, 24%, 87%)","line-gap-width":{base:1.5,stops:[[13,0],[14,2],[18,18]]}},interactive:!0},{id:"bridge-street-case",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:11,filter:["all",["==","$type","LineString"],["all",["==","class","street"],["==","structure","bridge"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12,.75],[20,2]]},"line-color":"hsl(230, 24%, 87%)","line-opacity":{base:1,stops:[[13.99,0],[14,1]]},"line-gap-width":{base:1.5,stops:[[13,0],[14,2],[18,18]]}},interactive:!0},{id:"bridge-secondary-tertiary-case",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["==","structure","bridge"],["in","class","secondary","tertiary"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.2,stops:[[10,.75],[18,2]]},"line-color":"hsl(230, 24%, 87%)","line-gap-width":{base:1.5,stops:[[8.5,.5],[10,.75],[18,26]]},"line-translate":[0,0]},interactive:!0},{id:"bridge-primary-case",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["==","class","primary"],["==","structure","bridge"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[5,.75],[16,2]]},"line-color":"hsl(230, 24%, 87%)","line-gap-width":{base:1.5,stops:[[5,.75],[18,32]]},"line-translate":[0,0]},interactive:!0},{id:"bridge-trunk_link-case",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==","$type","LineString"],["all",["!in","layer",2,3,4,5],["==","structure","bridge"],["==","type","trunk_link"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12,.75],[20,2]]},"line-color":"hsl(0, 0%, 100%)","line-gap-width":{base:1.5,stops:[[12,.5],[14,2],[18,18]]},"line-opacity":{base:1,stops:[[10.99,0],[11,1]]}},interactive:!0},{id:"bridge-motorway_link-case",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==","$type","LineString"],["all",["!in","layer",2,3,4,5],["==","class","motorway_link"],["==","structure","bridge"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12,.75],[20,2]]},"line-color":"hsl(0, 0%, 100%)","line-gap-width":{base:1.5,stops:[[12,.5],[14,2],[18,18]]},"line-opacity":1},interactive:!0},{id:"bridge-trunk-case",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["!in","layer",2,3,4,5],["==","class","trunk"],["==","structure","bridge"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[5,.75],[16,2]]},"line-color":"hsl(0, 0%, 100%)","line-gap-width":{base:1.5,stops:[[5,.75],[18,32]]}},interactive:!0},{id:"bridge-motorway-case",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["!in","layer",2,3,4,5],["==","class","motorway"],["==","structure","bridge"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[5,.75],[16,2]]},"line-color":"hsl(0, 0%, 100%)","line-gap-width":{base:1.5,stops:[[5,.75],[18,32]]}},interactive:!0},{id:"bridge-construction",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:14,filter:["all",["==","$type","LineString"],["all",["==","class","construction"],["==","structure","bridge"]]],layout:{"line-join":"miter"},paint:{"line-width":{base:1.5,stops:[[12.5,.5],[14,2],[18,18]]},"line-color":"hsl(230, 24%, 87%)","line-opacity":{base:1,stops:[[13.99,0],[14,1]]},"line-dasharray":{base:1,stops:[[14,[.4,.8]],[15,[.3,.6]],[16,[.2,.3]],[17,[.2,.25]],[18,[.15,.15]]]}},interactive:!0},{id:"bridge-path",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["!in","type","cycleway","piste","steps"],["==","class","path"],["==","structure","bridge"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[15,1],[18,4]]},"line-color":"hsl(0, 0%, 100%)","line-dasharray":{base:1,stops:[[14,[4,.4]],[15,[3,.4]],[16,[3,.35]],[17,[3,.35]]]},"line-opacity":{base:1,stops:[[13,0],[13.25,1]]}},interactive:!0},{id:"bridge-cycleway-piste",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["==","class","path"],["==","structure","bridge"],["in","type","cycleway","piste"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[15,1],[18,4]]},"line-color":"hsl(0, 0%, 100%)","line-opacity":{base:1,stops:[[13,0],[13.25,1]]}},interactive:!0},{id:"bridge-steps",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["==","structure","bridge"],["==","type","steps"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[15,1],[16,1.6],[18,6]]},"line-color":"hsl(0, 0%, 100%)","line-dasharray":{base:1,stops:[[14,[4,.4]],[15,[1.75,.4]],[16,[.75,.4]],[17,[.3,.3]]]},"line-opacity":{base:1,stops:[[13,0],[13.25,1]]}},interactive:!0},{id:"bridge-trunk_link",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==","$type","LineString"],["all",["!in","layer",2,3,4,5],["==","structure","bridge"],["==","type","trunk_link"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12,.5],[14,2],[18,18]]},"line-color":"hsl(46, 69%, 68%)"},interactive:!0},{id:"bridge-motorway_link",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==","$type","LineString"],["all",["!in","layer",2,3,4,5],["==","class","motorway_link"],["==","structure","bridge"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12,.5],[14,2],[18,18]]},"line-color":"hsl(26, 67%, 70%)"},interactive:!0},{id:"bridge-pedestrian",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==","$type","LineString"],["all",["==","class","pedestrian"],["==","structure","bridge"]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[14,.5],[18,12]]},"line-color":"hsl(0, 0%, 100%)","line-opacity":1,"line-dasharray":{base:1,stops:[[14,[1,0]],[15,[1.5,.4]],[16,[1,.2]]]}},interactive:!0},{id:"bridge-track",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["==","class","track"],["==","structure","bridge"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[15,1],[18,12]]},"line-color":"hsl(0, 0%, 100%)"},interactive:!0},{id:"bridge-service-link",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:14,filter:["all",["==","$type","LineString"],["all",["!=","type","trunk_link"],["==","structure","bridge"],["in","class","link","service","track"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[14,.5],[18,12]]},"line-color":"hsl(0, 0%, 100%)"},interactive:!0},{id:"bridge-street_limited",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:11,filter:["all",["==","$type","LineString"],["all",["==","class","street_limited"],["==","structure","bridge"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12.5,.5],[14,2],[18,18]]},"line-color":"hsl(35, 14%, 93%)","line-opacity":{base:1,stops:[[13.99,0],[14,1]]}},interactive:!0},{id:"bridge-street",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:11,filter:["all",["==","$type","LineString"],["all",["==","class","street"],["==","structure","bridge"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12.5,.5],[14,2],[18,18]]},"line-color":"hsl(0, 0%, 100%)","line-opacity":{base:1,stops:[[13.99,0],[14,1]]}},interactive:!0},{id:"bridge-secondary-tertiary",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["==","structure","bridge"],["in","type","secondary","tertiary"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[8.5,.5],[10,.75],[18,26]]},"line-color":"hsl(0, 0%, 100%)","line-opacity":{base:1.2,stops:[[5,0],[5.5,1]]}},interactive:!0},{id:"bridge-primary",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["==","structure","bridge"],["==","type","primary"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[5,.75],[18,32]]},"line-color":"hsl(0, 0%, 100%)","line-opacity":{base:1.2,stops:[[5,0],[5.5,1]]}},interactive:!0},{id:"bridge-oneway-arrows-blue-minor",type:"symbol",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:16,filter:["all",["==","$type","LineString"],["all",["==","oneway","true"],["==","structure","bridge"],["in","class","link","path","pedestrian","service","track"]]],layout:{"symbol-placement":"line","icon-image":{base:1,stops:[[17,"oneway-small"],[18,"oneway-large"]]},"symbol-spacing":200,"icon-rotation-alignment":"map","icon-padding":2},paint:{},interactive:!0},{id:"bridge-oneway-arrows-blue-major",type:"symbol",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:15,filter:["all",["==","$type","LineString"],["all",["==","oneway","true"],["==","structure","bridge"],["in","class","primary","secondary","street","street_limited","tertiary"]]],layout:{"symbol-placement":"line","icon-image":{base:1,stops:[[16,"oneway-small"],[17,"oneway-large"]]},"symbol-spacing":200,"icon-rotation-alignment":"map","icon-padding":2},paint:{},interactive:!0},{id:"bridge-trunk",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["!in","layer",2,3,4,5],["==","class","trunk"],["==","structure","bridge"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[5,.75],[18,32]]},"line-color":"hsl(46, 69%, 68%)"},interactive:!0},{id:"bridge-motorway",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["!in","layer",2,3,4,5],["==","class","motorway"],["==","structure","bridge"]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[5,.75],[18,32]]},"line-color":"hsl(26, 67%, 70%)"},interactive:!0},{id:"bridge-rail",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==","$type","LineString"],["all",["==","structure","bridge"],["in","class","major_rail","minor_rail"]]],layout:{"line-join":"round"},paint:{"line-color":{stops:[[13,"hsl(50, 17%, 82%)"],[16,"hsl(230, 10%, 74%)"]]},"line-width":{base:1.5,stops:[[14,.5],[20,1]]}},interactive:!0},{id:"bridge-rail-tracks",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==","$type","LineString"],["all",["==","structure","bridge"],["in","class","major_rail","minor_rail"]]],layout:{"line-join":"round"},paint:{"line-color":{stops:[[13,"hsl(50, 17%, 82%)"],[16,"hsl(230, 10%, 74%)"]]},"line-width":{base:1.5,stops:[[14,4],[20,8]]},"line-dasharray":[.1,15],"line-opacity":{base:1,stops:[[13.75,0],[20,1]]}},interactive:!0},{id:"bridge-trunk_link-2-case",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==","$type","LineString"],["all",["==","structure","bridge"],["==","type","trunk_link"],[">=","layer",2]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12,.75],[20,2]]},"line-color":"hsl(0, 0%, 100%)","line-gap-width":{base:1.5,stops:[[12,.5],[14,2],[18,18]]},"line-opacity":{base:1,stops:[[10.99,0],[11,1]]}},interactive:!0},{id:"bridge-motorway_link-2-case",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==","$type","LineString"],["all",["==","class","motorway_link"],["==","structure","bridge"],[">=","layer",2]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12,.75],[20,2]]},"line-color":"hsl(0, 0%, 100%)","line-gap-width":{base:1.5,stops:[[12,.5],[14,2],[18,18]]},"line-opacity":1},interactive:!0},{id:"bridge-trunk-2-case",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["==","class","trunk"],["==","structure","bridge"],[">=","layer",2]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[10,1],[16,2]]},"line-color":"hsl(0, 0%, 100%)","line-gap-width":{base:1.5,stops:[[5,.75],[18,32]]}},interactive:!0},{id:"bridge-motorway-2-case",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["==","class","motorway"],["==","structure","bridge"],[">=","layer",2]]],layout:{"line-join":"round"},paint:{"line-width":{base:1.5,stops:[[10,1],[16,2]]},"line-color":"hsl(0, 0%, 100%)","line-gap-width":{base:1.5,stops:[[5,.75],[18,32]]}},interactive:!0},{id:"bridge-trunk_link-2",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==","$type","LineString"],["all",["==","structure","bridge"],["==","type","trunk_link"],[">=","layer",2]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12,.5],[14,2],[18,18]]},"line-color":"hsl(46, 69%, 68%)"},interactive:!0},{id:"bridge-motorway_link-2",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:13,filter:["all",["==","$type","LineString"],["all",["==","class","motorway_link"],["==","structure","bridge"],[">=","layer",2]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[12,.5],[14,2],[18,18]]},"line-color":"hsl(26, 67%, 70%)"},interactive:!0},{id:"bridge-trunk-2",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["==","class","trunk"],["==","structure","bridge"],[">=","layer",2]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[5,.75],[18,32]]},"line-color":"hsl(46, 69%, 68%)"},interactive:!0},{id:"bridge-motorway-2",type:"line",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",filter:["all",["==","$type","LineString"],["all",["==","class","motorway"],["==","structure","bridge"],[">=","layer",2]]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-width":{base:1.5,stops:[[5,.75],[18,32]]},"line-color":"hsl(26, 67%, 70%)"},interactive:!0},{id:"bridge-oneway-arrows-white",type:"symbol",metadata:{"mapbox:group":"1444855799204.86"},source:"composite","source-layer":"road",minzoom:16,filter:["all",["==","$type","LineString"],["all",["!in","type","primary_link","secondary_link","tertiary_link"],["==","oneway","true"],["==","structure","bridge"],["in","class","link","trunk"]]],layout:{"symbol-placement":"line","icon-image":{base:1,stops:[[16,"oneway-white-small"],[17,"oneway-white-large"]]},"symbol-spacing":200,"icon-padding":2},paint:{"icon-opacity":.5},interactive:!0},{id:"aerialway-bg",type:"line",source:"composite","source-layer":"road",minzoom:13,filter:["all",["==","$type","LineString"],["==","class","aerialway"]],layout:{"line-join":"round"},paint:{"line-color":"hsl(0, 0%, 100%)","line-width":{base:1.5,stops:[[14,2.5],[20,3]]},"line-blur":.5},interactive:!0},{id:"aerialway",type:"line",source:"composite","source-layer":"road",minzoom:13,filter:["all",["==","$type","LineString"],["==","class","aerialway"]],layout:{"line-join":"round"},paint:{"line-color":"hsl(230, 4%, 29%)","line-width":{base:1.5,stops:[[14,.5],[20,1]]}},interactive:!0},{id:"admin-3-4-boundaries-bg",type:"line",metadata:{"mapbox:group":"1444934295202.7542"},source:"composite","source-layer":"admin",filter:["all",["==","maritime",0],[">=","admin_level",3]],layout:{"line-join":"bevel"},paint:{"line-color":{base:1,stops:[[8,"hsl(35, 12%, 89%)"],[16,"hsl(230, 49%, 90%)"]]},"line-width":{base:1,stops:[[7,3.75],[12,5.5]]},"line-opacity":{base:1,stops:[[7,0],[8,.75]]},"line-dasharray":[1,0],"line-translate":[0,0],"line-blur":{base:1,stops:[[3,0],[8,3]]}},interactive:!0},{id:"admin-2-boundaries-bg",type:"line",metadata:{"mapbox:group":"1444934295202.7542"},source:"composite","source-layer":"admin",minzoom:1,filter:["all",["==","admin_level",2],["==","maritime",0]],layout:{"line-join":"miter"},paint:{"line-width":{base:1,stops:[[3,3.5],[10,8]]},"line-color":{base:1,stops:[[6,"hsl(35, 12%, 89%)"],[8,"hsl(230, 49%, 90%)"]]},"line-opacity":{base:1,stops:[[3,0],[4,.5]]},"line-translate":[0,0],"line-blur":{base:1,stops:[[3,0],[10,2]]}},interactive:!0},{id:"admin-3-4-boundaries",type:"line",metadata:{"mapbox:group":"1444934295202.7542"},source:"composite","source-layer":"admin",filter:["all",["==","maritime",0],[">=","admin_level",3]],layout:{"line-join":"round","line-cap":"round"},paint:{"line-dasharray":{base:1,stops:[[6,[2,0]],[7,[2,2,6,2]]]},"line-width":{base:1,stops:[[7,.75],[12,1.5]]},"line-opacity":{base:1,stops:[[2,0],[3,1]]},"line-color":{base:1,stops:[[3,"hsl(230, 14%, 77%)"],[7,"hsl(230, 8%, 62%)"]]}},interactive:!0},{id:"admin-2-boundaries",type:"line",metadata:{"mapbox:group":"1444934295202.7542"},source:"composite","source-layer":"admin",minzoom:1,filter:["all",["==","admin_level",2],["==","disputed",0],["==","maritime",0]],layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"hsl(230, 8%, 51%)","line-width":{base:1,stops:[[3,.5],[10,2]]}},interactive:!0},{id:"admin-2-boundaries-dispute",type:"line",metadata:{"mapbox:group":"1444934295202.7542"},source:"composite","source-layer":"admin",minzoom:1,filter:["all",["==","admin_level",2],["==","disputed",1],["==","maritime",0]],layout:{"line-join":"round"},paint:{"line-dasharray":[1.5,1.5],"line-color":"hsl(230, 8%, 51%)","line-width":{base:1,stops:[[3,.5],[10,2]]}},interactive:!0},{id:"contour-label",type:"symbol",source:"composite","source-layer":"contour",minzoom:11,filter:["in","index",10,5],layout:{"text-field":"{ele} m","symbol-placement":"line","text-max-angle":25,"text-padding":5,"text-font":["DIN Offc Pro Medium","Arial Unicode MS Regular"],"text-size":{base:1,stops:[[15,9.5],[20,12]]}},paint:{"text-color":"hsl(100, 60%, 28%)","text-halo-width":1,"text-halo-blur":0,"text-halo-color":"hsla(0, 0%, 100%, 0.5)"},interactive:!0},{id:"waterway-label",type:"symbol",source:"composite","source-layer":"waterway_label",minzoom:12,filter:["in","class","canal","river"],layout:{"text-field":"{name_en}","text-font":["DIN Offc Pro Italic","Arial Unicode MS Regular"],"symbol-placement":"line","text-max-angle":30,"text-size":{base:1,stops:[[13,12],[18,16]]}},paint:{"text-halo-width":.5,"text-halo-color":"hsl(196, 80%, 70%)","text-color":"hsl(230, 48%, 44%)","text-halo-blur":.5},interactive:!0},{id:"poi-parks_scalerank4",type:"symbol",metadata:{"mapbox:group":"1444933456003.5437"},source:"composite","source-layer":"poi_label",minzoom:15,filter:["all",["==","scalerank",4],["in","maki","campsite","cemetery","dog-park","garden","golf","park","picnic-site","playground","zoo"]],layout:{"text-line-height":1.1,"text-size":{base:1,stops:[[16,11],[20,13]]},"icon-image":"{maki}-11","text-max-angle":38,"symbol-spacing":250,"text-font":["DIN Offc Pro Medium","Arial Unicode MS Regular"],"text-padding":1,"text-offset":[0,.65],"text-rotation-alignment":"viewport","text-anchor":"top","text-field":"{name_en}","text-letter-spacing":.01,"text-max-width":8},paint:{"text-color":"hsl(100, 100%, 20%)","text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":.5,"text-halo-blur":.5},interactive:!0},{id:"poi-scalerank3",type:"symbol",metadata:{"mapbox:group":"1444933372896.5967"},source:"composite","source-layer":"poi_label",filter:["all",["!in","maki","campsite","cemetery","dog-park","garden","golf","park","picnic-site","playground","zoo"],["==","scalerank",3]],layout:{"text-line-height":1.1,"text-size":{base:1,stops:[[16,11],[20,13]]},"icon-image":"{maki}-11","text-max-angle":38,"symbol-spacing":250,"text-font":["DIN Offc Pro Medium","Arial Unicode MS Regular"],"text-padding":1,"text-offset":[0,.65],"text-rotation-alignment":"viewport","text-anchor":"top","text-field":"{name_en}","text-letter-spacing":.01,"text-max-width":8},paint:{"text-color":"hsl(25, 25%, 32%)","text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":.5,"text-halo-blur":.5},interactive:!0},{id:"poi-parks-scalerank3",type:"symbol",metadata:{"mapbox:group":"1444933372896.5967"},source:"composite","source-layer":"poi_label",filter:["all",["==","scalerank",3],["in","maki","campsite","cemetery","dog-park","garden","golf","park","picnic-site","playground","zoo"]],layout:{"text-line-height":1.1,"text-size":{base:1,stops:[[16,11],[20,13]]},"icon-image":"{maki}-11","text-max-angle":38,"symbol-spacing":250,"text-font":["DIN Offc Pro Medium","Arial Unicode MS Regular"],"text-padding":2,"text-offset":[0,.65],"text-rotation-alignment":"viewport","text-anchor":"top","text-field":"{name_en}","text-letter-spacing":.01,"text-max-width":8},paint:{"text-color":"hsl(100, 100%, 20%)","text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":.5,"text-halo-blur":.5},interactive:!0},{id:"road-label-small",type:"symbol",metadata:{"mapbox:group":"1444933721429.3076"},source:"composite","source-layer":"road_label",minzoom:15,filter:["all",["!in","class","aerialway","link","motorway","path","pedestrian","primary","secondary","street","street_limited","tertiary","trunk"],["==","$type","LineString"]],layout:{"text-size":{base:1,stops:[[15,10],[20,13]]},"text-max-angle":30,"symbol-spacing":250,"text-font":["DIN Offc Pro Regular","Arial Unicode MS Regular"],"symbol-placement":"line","text-padding":1,"text-rotation-alignment":"map","text-field":"{name_en}","text-letter-spacing":.01},paint:{"text-color":"hsl(0, 0%, 0%)","text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":1.25,"text-halo-blur":1},interactive:!0},{id:"road-label-medium",type:"symbol",metadata:{"mapbox:group":"1444933721429.3076"},source:"composite","source-layer":"road_label",minzoom:11,filter:["all",["==","$type","LineString"],["in","class","aerialway","link","path","pedestrian","street","street_limited"]],layout:{"text-size":{base:1,stops:[[11,10],[20,14]]},"text-max-angle":30,"symbol-spacing":250,"text-font":["DIN Offc Pro Regular","Arial Unicode MS Regular"],"symbol-placement":"line","text-padding":1,"text-rotation-alignment":"map","text-field":"{name_en}","text-letter-spacing":.01},paint:{"text-color":"hsl(0, 0%, 0%)","text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":1},interactive:!0},{id:"road-label-large",type:"symbol",metadata:{"mapbox:group":"1444933721429.3076"},source:"composite","source-layer":"road_label",filter:["in","class","motorway","primary","secondary","tertiary","trunk"],layout:{"text-size":{base:1,stops:[[9,10],[20,16]]},"text-max-angle":30,"symbol-spacing":250,"text-font":["DIN Offc Pro Regular","Arial Unicode MS Regular"],"symbol-placement":"line","text-padding":1,"text-rotation-alignment":"map","text-field":"{name_en}","text-letter-spacing":.01},paint:{"text-color":"hsl(0, 0%, 0%)","text-halo-color":"rgba(255,255,255, 0.75)","text-halo-width":1,"text-halo-blur":1},interactive:!0},{id:"road-shields-black",type:"symbol",metadata:{"mapbox:group":"1444933575858.6992"},source:"composite","source-layer":"road_label",filter:["all",["!in","shield","at-expressway","at-motorway","at-state-b","bg-motorway","bg-national","ch-main","ch-motorway","cz-motorway","cz-road","de-motorway","e-road","fi-main","gr-motorway","gr-national","hr-motorway","hr-state","hu-main","hu-motorway","nz-state","pl-expressway","pl-motorway","pl-national","ro-county","ro-motorway","ro-national","rs-motorway","rs-state-1b","se-main","si-expressway","si-motorway","sk-highway","sk-road","us-interstate","us-interstate-business","us-interstate-duplex","us-interstate-truck","za-metropolitan","za-national","za-provincial","za-regional"],["<=","reflen",6]],layout:{"text-size":9,"icon-image":"{shield}-{reflen}","icon-rotation-alignment":"viewport","text-max-angle":38,"symbol-spacing":{base:1,stops:[[11,150],[14,200]]},"text-font":["DIN Offc Pro Bold","Arial Unicode MS Bold"],"symbol-placement":{base:1,stops:[[10,"point"],[11,"line"]]},"text-padding":2,"text-rotation-alignment":"viewport","text-field":"{ref}","text-letter-spacing":.05,"icon-padding":2},paint:{"text-color":"hsl(230, 21%, 37%)","icon-halo-color":"rgba(0, 0, 0, 1)","icon-halo-width":1,"text-opacity":1,"icon-color":"white","text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":0},interactive:!0},{id:"road-shields-white",type:"symbol",metadata:{"mapbox:group":"1444933575858.6992"},source:"composite","source-layer":"road_label",filter:["all",["<=","reflen",6],["in","shield","at-expressway","at-motorway","at-state-b","bg-motorway","bg-national","ch-main","ch-motorway","cz-motorway","cz-road","de-motorway","e-road","fi-main","gr-motorway","gr-national","hr-motorway","hr-state","hu-main","hu-motorway","nz-state","pl-expressway","pl-motorway","pl-national","ro-county","ro-motorway","ro-national","rs-motorway","rs-state-1b","se-main","si-expressway","si-motorway","sk-highway","sk-road","us-interstate","us-interstate-business","us-interstate-duplex","us-interstate-truck","za-metropolitan","za-national","za-provincial","za-regional"]],layout:{"text-size":9,"icon-image":"{shield}-{reflen}","icon-rotation-alignment":"viewport","text-max-angle":38,"symbol-spacing":{base:1,stops:[[11,150],[14,200]]},"text-font":["DIN Offc Pro Bold","Arial Unicode MS Bold"],"symbol-placement":{base:1,stops:[[10,"point"],[11,"line"]]},"text-padding":2,"text-rotation-alignment":"viewport","text-field":"{ref}","text-letter-spacing":.05,"icon-padding":2},paint:{"text-color":"hsl(0, 0%, 100%)","icon-halo-color":"rgba(0, 0, 0, 1)","icon-halo-width":1,"text-opacity":1,"icon-color":"white","text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":0},interactive:!0},{id:"mountain-peak-label",type:"symbol",source:"composite","source-layer":"mountain_peak_label",layout:{"text-line-height":1.1,"text-size":{base:1,stops:[[10,11],[18,14]]},"icon-image":"{maki}-15","text-font":["DIN Offc Pro Medium","Arial Unicode MS Regular"],"text-offset":[0,.65],"text-anchor":"top","text-field":"{name_en}","text-letter-spacing":.01,"text-max-width":8},paint:{"text-color":"hsl(100, 100%, 20%)","text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":.5,"text-halo-blur":.5},interactive:!0},{id:"mountain-peak-label-with-elevation",type:"symbol",source:"composite","source-layer":"mountain_peak_label",filter:[">","elevation_m",0],layout:{"text-line-height":1.1,"text-size":{base:1,stops:[[10,11],[18,14]]},"icon-image":"{maki}-15","text-font":["DIN Offc Pro Medium","Arial Unicode MS Regular"],"text-offset":[0,.65],"text-anchor":"top","text-field":"{name_en}, {elevation_m}m","text-letter-spacing":.01,"text-max-width":8},paint:{"text-color":"hsl(100, 100%, 20%)","text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":.5,"text-halo-blur":.5},interactive:!0},{id:"poi-scalerank2",type:"symbol",metadata:{"mapbox:group":"1444933358918.2366"},source:"composite","source-layer":"poi_label",filter:["all",["!in","maki","campsite","cemetery","dog-park","garden","golf","park","picnic-site","playground","zoo"],["==","scalerank",2]],layout:{"text-line-height":1.1,"text-size":{base:1,stops:[[14,11],[20,14]]},"icon-image":{stops:[[14,"{maki}-11"],[15,"{maki}-15"]]},"text-max-angle":38,"symbol-spacing":250,"text-font":["DIN Offc Pro Medium","Arial Unicode MS Regular"],"text-padding":2,"text-offset":[0,.65],"text-rotation-alignment":"viewport","text-anchor":"top","text-field":"{name_en}","text-letter-spacing":.01,"text-max-width":8},paint:{"text-color":"hsl(25, 25%, 32%)","text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":.5,"text-halo-blur":.5},interactive:!0},{id:"poi-parks-scalerank2",type:"symbol",metadata:{"mapbox:group":"1444933358918.2366"},source:"composite","source-layer":"poi_label",filter:["all",["==","scalerank",2],["in","maki","campsite","cemetery","dog-park","garden","golf","park","picnic-site","playground","zoo"]],layout:{"text-line-height":1.1,"text-size":{base:1,stops:[[14,11],[20,14]]},"icon-image":{stops:[[14,"{maki}-11"],[15,"{maki}-15"]]},"text-max-angle":38,"symbol-spacing":250,"text-font":["DIN Offc Pro Medium","Arial Unicode MS Regular"],"text-padding":2,"text-offset":[0,.65],"text-rotation-alignment":"viewport","text-anchor":"top","text-field":"{name_en}","text-letter-spacing":.01,"text-max-width":8},paint:{"text-color":"hsl(100, 100%, 20%)","text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":.5,"text-halo-blur":.5},interactive:!0},{id:"water-label-sm",type:"symbol",metadata:{"mapbox:group":"1444933808272.805"},source:"composite","source-layer":"water_label",minzoom:15,filter:["<=","area",1e4],layout:{"text-field":"{name_en}","text-font":["DIN Offc Pro Italic","Arial Unicode MS Regular"],"text-max-width":7,"text-size":{base:1,stops:[[16,13],[20,16]]}},paint:{"text-color":"hsl(230, 48%, 44%)"},interactive:!0},{id:"water-label",type:"symbol",metadata:{"mapbox:group":"1444933808272.805"},source:"composite","source-layer":"water_label",minzoom:5,filter:[">","area",1e4],layout:{"text-field":"{name_en}","text-font":["DIN Offc Pro Italic","Arial Unicode MS Regular"],"text-max-width":7,"text-size":{base:1,stops:[[13,13],[18,18]]}},paint:{"text-color":"hsl(230, 48%, 44%)"},interactive:!0},{id:"poi-parks-scalerank1",type:"symbol",metadata:{"mapbox:group":"1444933322393.2852"},source:"composite","source-layer":"poi_label",filter:["all",["<=","scalerank",1],["in","maki","campsite","cemetery","dog-park","garden","golf","park","picnic-site","playground","zoo"]],layout:{"text-line-height":1.1,"text-size":{base:1,stops:[[10,11],[18,14]]},"icon-image":{stops:[[13,"{maki}-11"],[14,"{maki}-15"]]},"text-max-angle":38,"symbol-spacing":250,"text-font":["DIN Offc Pro Medium","Arial Unicode MS Regular"],"text-padding":2,"text-offset":[0,.65],"text-rotation-alignment":"viewport","text-anchor":"top","text-field":"{name_en}","text-letter-spacing":.01,"text-max-width":8},paint:{"text-color":"hsl(100, 100%, 20%)","text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":.5,"text-halo-blur":.5},interactive:!0},{id:"poi-scalerank1",type:"symbol",metadata:{"mapbox:group":"1444933322393.2852"},source:"composite","source-layer":"poi_label",filter:["all",["!in","maki","campsite","cemetery","dog-park","garden","golf","park","picnic-site","playground","zoo"],["<=","scalerank",1]],layout:{"text-line-height":1.1,"text-size":{base:1,stops:[[10,11],[18,14]]},"icon-image":{stops:[[13,"{maki}-11"],[14,"{maki}-15"]]},"text-max-angle":38,"symbol-spacing":250,"text-font":["DIN Offc Pro Medium","Arial Unicode MS Regular"],"text-padding":2,"text-offset":[0,.65],"text-rotation-alignment":"viewport","text-anchor":"top","text-field":"{name_en}","text-letter-spacing":.01,"text-max-width":8},paint:{"text-color":"hsl(25, 25%, 32%)","text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":.5,"text-halo-blur":.5},interactive:!0},{id:"place-islet-archipelago-aboriginal",type:"symbol",source:"composite","source-layer":"place_label",maxzoom:16,filter:["in","type","aboriginal_lands","archipelago","islet"],layout:{"text-line-height":1.2,"text-size":{base:1,stops:[[10,11],[18,16]]},"text-max-angle":38,"symbol-spacing":250,"text-font":["DIN Offc Pro Regular","Arial Unicode MS Regular"],"text-padding":2,"text-offset":[0,0],"text-rotation-alignment":"viewport","text-field":"{name_en}","text-letter-spacing":.01,"text-max-width":8},paint:{"text-color":"hsl(230, 29%, 35%)","text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":1},interactive:!0},{id:"place-hamlet",type:"symbol",source:"composite","source-layer":"place_label",minzoom:10,maxzoom:16,filter:["==","type","hamlet"],layout:{"text-field":"{name_en}","text-font":["DIN Offc Pro Regular","Arial Unicode MS Regular"],"text-size":{base:1,stops:[[12,11.5],[15,16]]}},paint:{"text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":1.25,"text-color":"hsl(0, 0%, 0%)"},interactive:!0},{id:"place-village",type:"symbol",source:"composite","source-layer":"place_label",minzoom:8,maxzoom:15,filter:["==","type","village"],layout:{"text-field":"{name_en}","text-font":["DIN Offc Pro Regular","Arial Unicode MS Regular"],"text-max-width":7,"text-size":{base:1,stops:[[10,11.5],[16,18]]}},paint:{"text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":1.25,"text-color":"hsl(0, 0%, 0%)"},interactive:!0},{id:"place-town",type:"symbol",source:"composite","source-layer":"place_label",minzoom:6,maxzoom:15,filter:["==","type","town"],layout:{"icon-image":"dot-9","text-font":{base:1,stops:[[11,["DIN Offc Pro Regular","Arial Unicode MS Regular"]],[12,["DIN Offc Pro Medium","Arial Unicode MS Regular"]]]},"text-offset":{base:1,stops:[[7,[0,-.15]],[8,[0,0]]]},"text-anchor":{base:1,stops:[[7,"bottom"],[8,"center"]]},"text-field":"{name_en}","text-max-width":7,"text-size":{base:1,stops:[[7,11.5],[15,20]]}},paint:{"text-color":"hsl(0, 0%, 0%)","text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":1.25,"icon-opacity":{base:1,stops:[[7.99,1],[8,0]]}},interactive:!0},{id:"place-island",type:"symbol",source:"composite","source-layer":"place_label",maxzoom:16,filter:["==","type","island"],layout:{"text-line-height":1.2,"text-size":{base:1,stops:[[10,11],[18,16]]},"text-max-angle":38,"symbol-spacing":250,"text-font":["DIN Offc Pro Regular","Arial Unicode MS Regular"],"text-padding":2,"text-offset":[0,0],"text-rotation-alignment":"viewport","text-field":"{name_en}","text-letter-spacing":.01,"text-max-width":7},paint:{"text-color":"hsl(230, 29%, 35%)","text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":1},interactive:!0},{id:"place-city-sm",type:"symbol",metadata:{"mapbox:group":"1444862510685.128"},source:"composite","source-layer":"place_label",maxzoom:14,filter:["all",["!in","scalerank",0,1,2,3,4,5],["==","type","city"]],layout:{"text-size":{base:1,stops:[[6,12],[14,22]]},"icon-image":"dot-9","text-font":{base:1,stops:[[7,["DIN Offc Pro Regular","Arial Unicode MS Regular"]],[8,["DIN Offc Pro Medium","Arial Unicode MS Regular"]]]},"text-offset":{base:1,stops:[[7.99,[0,-.2]],[8,[0,0]]]},"text-anchor":{base:1,stops:[[7,"bottom"],[8,"center"]]},"text-field":"{name_en}","text-max-width":7},paint:{"text-color":"hsl(0, 0%, 0%)","text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":1.25,"icon-opacity":{base:1,stops:[[7.99,1],[8,0]]}},interactive:!0},{id:"place-city-md-s",type:"symbol",metadata:{"mapbox:group":"1444862510685.128"},source:"composite","source-layer":"place_label",maxzoom:14,filter:["all",["==","type","city"],["in","ldir","E","S","SE","SW"],["in","scalerank",3,4,5]],layout:{"text-field":"{name_en}","icon-image":"dot-10","text-anchor":{base:1,stops:[[7,"top"],[8,"center"]]},"text-offset":{base:1,stops:[[7.99,[0,.1]],[8,[0,0]]]},"text-font":{base:1,stops:[[7,["DIN Offc Pro Regular","Arial Unicode MS Regular"]],[8,["DIN Offc Pro Medium","Arial Unicode MS Regular"]]]},"text-size":{base:.9,stops:[[5,12],[12,22]]}},paint:{"text-halo-width":1,"text-halo-color":"hsl(0, 0%, 100%)","text-color":"hsl(0, 0%, 0%)","text-halo-blur":1,"icon-opacity":{base:1,stops:[[7.99,1],[8,0]]}},interactive:!0},{id:"place-city-md-n",type:"symbol",metadata:{"mapbox:group":"1444862510685.128"},source:"composite","source-layer":"place_label",maxzoom:14,filter:["all",["==","type","city"],["in","ldir","N","NE","NW","W"],["in","scalerank",3,4,5]],layout:{"icon-image":"dot-10","text-font":{base:1,stops:[[7,["DIN Offc Pro Regular","Arial Unicode MS Regular"]],[8,["DIN Offc Pro Medium","Arial Unicode MS Regular"]]]},"text-offset":{base:1,stops:[[7.99,[0,-.25]],[8,[0,0]]]},"text-anchor":{base:1,stops:[[7,"bottom"],[8,"center"]]},"text-field":"{name_en}","text-max-width":7,"text-size":{base:.9,stops:[[5,12],[12,22]]}},paint:{"text-color":"hsl(0, 0%, 0%)","text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":1,"icon-opacity":{base:1,stops:[[7.99,1],[8,0]]},"text-halo-blur":1},interactive:!0},{id:"place-city-lg-s",type:"symbol",metadata:{"mapbox:group":"1444862510685.128"},source:"composite","source-layer":"place_label",minzoom:1,maxzoom:14,filter:["all",["<=","scalerank",2],["==","type","city"],["in","ldir","E","S","SE","SW"]],layout:{"icon-image":"dot-11","text-font":{base:1,stops:[[7,["DIN Offc Pro Regular","Arial Unicode MS Regular"]],[8,["DIN Offc Pro Medium","Arial Unicode MS Regular"]]]},"text-offset":{base:1,stops:[[7.99,[0,.15]],[8,[0,0]]]},"text-anchor":{base:1,stops:[[7,"top"],[8,"center"]]},"text-field":"{name_en}","text-max-width":7,"text-size":{base:.9,stops:[[4,12],[10,22]]}},paint:{"text-color":"hsl(0, 0%, 0%)","text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":1,"icon-opacity":{base:1,stops:[[7.99,1],[8,0]]},"text-halo-blur":1},interactive:!0},{id:"place-city-lg-n",type:"symbol",metadata:{"mapbox:group":"1444862510685.128"},source:"composite","source-layer":"place_label",minzoom:1,maxzoom:14,filter:["all",["<=","scalerank",2],["==","type","city"],["in","ldir","N","NE","NW","W"]],layout:{"icon-image":"dot-11","text-font":{base:1,stops:[[7,["DIN Offc Pro Regular","Arial Unicode MS Regular"]],[8,["DIN Offc Pro Medium","Arial Unicode MS Regular"]]]},"text-offset":{base:1,stops:[[7.99,[0,-.25]],[8,[0,0]]]},"text-anchor":{base:1,stops:[[7,"bottom"],[8,"center"]]},"text-field":"{name_en}","text-max-width":7,"text-size":{base:.9,stops:[[4,12],[10,22]]}},paint:{"text-color":"hsl(0, 0%, 0%)","text-opacity":1,"text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":1,"icon-opacity":{base:1,stops:[[7.99,1],[8,0]]},"text-halo-blur":1},interactive:!0},{id:"marine-label-sm-ln",type:"symbol",metadata:{"mapbox:group":"1444856087950.3635"},source:"composite","source-layer":"marine_label",minzoom:3,maxzoom:10,filter:["all",["==","$type","LineString"],[">=","labelrank",4]],layout:{"text-line-height":1.1,"text-size":{base:1,stops:[[3,12],[6,16]]},"symbol-spacing":{base:1,stops:[[4,100],[6,400]]},"text-font":["DIN Offc Pro Italic","Arial Unicode MS Regular"],"symbol-placement":"line","text-field":"{name_en}","text-letter-spacing":.1,"text-max-width":5},paint:{"text-color":"hsl(205, 83%, 88%)"},interactive:!0},{id:"marine-label-sm-pt",type:"symbol",metadata:{"mapbox:group":"1444856087950.3635"},source:"composite","source-layer":"marine_label",minzoom:3,maxzoom:10,filter:["all",["==","$type","Point"],[">=","labelrank",4]],layout:{"text-field":"{name_en}","text-max-width":5,"text-letter-spacing":.1,"text-line-height":1.5,"text-font":["DIN Offc Pro Italic","Arial Unicode MS Regular"],"text-size":{base:1,stops:[[3,12],[6,16]]}},paint:{"text-color":"hsl(205, 83%, 88%)"},interactive:!0},{id:"marine-label-md-ln",type:"symbol",metadata:{"mapbox:group":"1444856087950.3635"},source:"composite","source-layer":"marine_label",minzoom:2,maxzoom:8,filter:["all",["==","$type","LineString"],["in","labelrank",2,3]],layout:{"text-line-height":1.1,"text-size":{base:1.1,stops:[[2,12],[5,20]]},"symbol-spacing":250,"text-font":["DIN Offc Pro Italic","Arial Unicode MS Regular"],"symbol-placement":"line","text-field":"{name_en}","text-letter-spacing":.15,"text-max-width":5},paint:{"text-color":"hsl(205, 83%, 88%)"},interactive:!0},{id:"marine-label-md-pt",type:"symbol",metadata:{"mapbox:group":"1444856087950.3635"},source:"composite","source-layer":"marine_label",minzoom:2,maxzoom:8,filter:["all",["==","$type","Point"],["in","labelrank",2,3]],layout:{"text-field":"{name_en}","text-max-width":5,"text-letter-spacing":.15,"text-line-height":1.5,"text-font":["DIN Offc Pro Italic","Arial Unicode MS Regular"],"text-size":{base:1.1,stops:[[2,14],[5,20]]}},paint:{"text-color":"hsl(205, 83%, 88%)"},interactive:!0},{id:"marine-label-lg-ln",type:"symbol",metadata:{"mapbox:group":"1444856087950.3635"},source:"composite","source-layer":"marine_label",minzoom:1,maxzoom:4,filter:["all",["==","$type","LineString"],["==","labelrank",1]],layout:{"text-field":"{name_en}","text-max-width":4,"text-letter-spacing":.25,"text-line-height":1.1,"symbol-placement":"line","text-font":["DIN Offc Pro Italic","Arial Unicode MS Regular"],"text-size":{base:1,stops:[[1,14],[4,30]]}},paint:{"text-color":"hsl(205, 83%, 88%)"},interactive:!0},{id:"marine-label-lg-pt",type:"symbol",metadata:{"mapbox:group":"1444856087950.3635"},source:"composite","source-layer":"marine_label",minzoom:1,maxzoom:4,filter:["all",["==","$type","Point"],["==","labelrank",1]],layout:{"text-field":"{name_en}","text-max-width":4,"text-letter-spacing":.25,"text-line-height":1.5,"text-font":["DIN Offc Pro Italic","Arial Unicode MS Regular"],"text-size":{base:1,stops:[[1,14],[4,30]]}},paint:{"text-color":"hsl(205, 83%, 88%)"},interactive:!0},{id:"state-label-sm",type:"symbol",metadata:{"mapbox:group":"1444856151690.9143"},source:"composite","source-layer":"state_label",minzoom:3,maxzoom:9,filter:["<","area",2e4],layout:{"text-size":{base:1,stops:[[6,10],[9,14]]},"text-transform":"uppercase","text-font":["DIN Offc Pro Bold","Arial Unicode MS Bold"],"text-field":{base:1,stops:[[0,"{abbr}"],[6,"{name_en}"]]},"text-letter-spacing":.15,"text-max-width":5},paint:{"text-opacity":1,"text-color":"hsl(0, 0%, 0%)","text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":1},interactive:!0},{id:"state-label-md",type:"symbol",metadata:{"mapbox:group":"1444856151690.9143"},source:"composite","source-layer":"state_label",minzoom:3,maxzoom:8,filter:["all",["<","area",8e4],[">=","area",2e4]],layout:{"text-size":{base:1,stops:[[5,10],[8,16]]},"text-transform":"uppercase","text-font":["DIN Offc Pro Bold","Arial Unicode MS Bold"],"text-field":{base:1,stops:[[0,"{abbr}"],[5,"{name_en}"]]},"text-letter-spacing":.15,"text-max-width":6},paint:{"text-opacity":1,"text-color":"hsl(0, 0%, 0%)","text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":1},interactive:!0},{id:"state-label-lg",type:"symbol",metadata:{"mapbox:group":"1444856151690.9143"},source:"composite","source-layer":"state_label",minzoom:3,maxzoom:7,filter:[">=","area",8e4],layout:{"text-size":{base:1,stops:[[4,10],[7,18]]},"text-transform":"uppercase","text-font":["DIN Offc Pro Bold","Arial Unicode MS Bold"],"text-padding":1,"text-field":{base:1,stops:[[0,"{abbr}"],[4,"{name_en}"]]},"text-letter-spacing":.15,"text-max-width":6},paint:{"text-opacity":1,"text-color":"hsl(0, 0%, 0%)","text-halo-color":"hsl(0, 0%, 100%)","text-halo-width":1},interactive:!0},{id:"country-label-sm",type:"symbol",metadata:{"mapbox:group":"1444856144497.7825"},source:"composite","source-layer":"country_label",minzoom:1,maxzoom:10,filter:[">=","scalerank",5],layout:{"text-field":"{name_en}","text-max-width":6,"text-font":["DIN Offc Pro Medium","Arial Unicode MS Regular"],"text-size":{base:.9,stops:[[5,14],[9,22]]}},paint:{"text-color":"hsl(0, 0%, 0%)","text-halo-color":{base:1,stops:[[2,"rgba(255,255,255,0.75)"],[3,"hsl(0, 0%, 100%)"]]},"text-halo-width":1.25},interactive:!0},{id:"country-label-md",type:"symbol",metadata:{"mapbox:group":"1444856144497.7825"},source:"composite","source-layer":"country_label",minzoom:1,maxzoom:8,filter:["in","scalerank",3,4],layout:{"text-field":{base:1,stops:[[0,"{code}"],[2,"{name_en}"]]},"text-max-width":6,"text-font":["DIN Offc Pro Medium","Arial Unicode MS Regular"],"text-size":{base:1,stops:[[3,10],[8,24]]}},paint:{"text-color":"hsl(0, 0%, 0%)","text-halo-color":{base:1,stops:[[2,"rgba(255,255,255,0.75)"],[3,"hsl(0, 0%, 100%)"]]},"text-halo-width":1.25},interactive:!0},{id:"country-label-lg",type:"symbol",metadata:{"mapbox:group":"1444856144497.7825"},source:"composite","source-layer":"country_label",minzoom:1,maxzoom:7,filter:["in","scalerank",1,2],layout:{"text-field":"{name_en}","text-max-width":{base:1,stops:[[0,5],[3,6]]},"text-font":["DIN Offc Pro Medium","Arial Unicode MS Regular"],"text-size":{base:1,stops:[[1,10],[6,24]]}},paint:{"text-color":"hsl(0, 0%, 0%)","text-halo-color":{base:1,stops:[[2,"rgba(255,255,255,0.75)"],[3,"hsl(0, 0%, 100%)"]]},"text-halo-width":1.25},interactive:!0}],created:"2017-08-10T19:56:21.137Z",id:"cj66v6i8c4hnc2so16ngtlovn",modified:"2017-08-10T19:56:21.137Z",owner:"pipbailey",visibility:"private",draft:!1}},47:function(e,t,a){"use strict";a.d(t,"d",function(){return r}),a.d(t,"c",function(){return i}),a.d(t,"b",function(){return l}),a.d(t,"e",function(){return s}),a.d(t,"a",function(){return c});var n=a(223),o=a.n(n),r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"LLLL";return o()(e,"x").format(t)},i=function(e){return o()(e,"x").fromNow()},l=function(e){return o.a.utc(e).format("x")};function s(e){return o()(e,"x").format("YYYY-MM-DDTkk:mm")}function c(e){return o()(new Date(e),"YYYY-MM-DDTkk:mm").format("x")}},470:function(e,t,a){"use strict";var n=a(48),o=a(74),r=a.n(o),i=a(127);t.a=function e(t,a){var o=this;Object(n.a)(this,e),this.setMeta=function(){o.meta=JSON.stringify(o.config.getSeriesMeta())},this.newSeries=function(){return{id:"_"+r()(),meta:JSON.stringify(o.config.getSeriesMeta()),photos:[]}},this.config=new i.a(t),this.series=a||this.newSeries()}},492:function(e,t,a){"use strict";var n=a(7),o=a(0),r=a.n(o),i=a(19),l=a.n(i),s=a(935),c=a(972),u=a(918),d=a(919),p=a(268),m=a.n(p),h=a(125),g=a.n(h),b=a(233),f=a.n(b),y=a(267),v=a(276),w=a(99),x=a(916),E=a(48),O=a(80),k=a(33),S=a.n(k),j=a(49),C=function(){function e(t,a){Object(E.a)(this,e),this.webcamElement=t,this.canvasElement=a,"https:"!==window.location.protocol&&"localhost"!==window.location.hostname&&console.warn("getUserMedia() must be run from a secure origin: https or localhost.\nChanging protocol to https."),navigator.mediaDevices||navigator.getUserMedia||console.warn("Your browser doesn't support navigator.mediaDevices.getUserMedia and navigator.getUserMedia.")}return Object(O.a)(e,[{key:"adjustVideoSize",value:function(e,t){var a=e/t;e>=t?this.webcamElement.width=a*this.webcamElement.height:e<t&&(this.webcamElement.height=this.webcamElement.width/a)}},{key:"destroy",value:function(){var e=Object(j.a)(S.a.mark(function e(){return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:try{this.webcamElement.srcObject.getTracks()[0].stop(),this.webcamElement=null,this.canvasElement=null}catch(t){console.error(t)}case 1:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"setup",value:function(){var e=Object(j.a)(S.a.mark(function e(t,a){var n=this;return S.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise(function(e,o){void 0!==navigator.mediaDevices.getUserMedia?navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:"environment",width:t,height:a}}).then(function(t){"srcObject"in n.webcamElement?n.webcamElement.srcObject=t:n.webcamElement.src=window.URL.createObjectURL(t),n.webcamElement.onloadedmetadata=function(e){n.webcamElement.play()},n.webcamElement.onplaying=function(t){e()}}).catch(function(e){return o(e)}):o(new Error("Error accessing camera"))}));case 1:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}()},{key:"_drawImage",value:function(){var e=this.webcamElement.videoWidth,t=this.webcamElement.videoHeight,a=this.canvasElement.getContext("2d");return this.canvasElement.width=e,this.canvasElement.height=t,a.drawImage(this.webcamElement,0,0,e,t),{imageHeight:t,imageWidth:e}}},{key:"takeBlobPhoto",value:function(){var e=this,t=this._drawImage(),a=t.imageWidth,n=t.imageHeight;return new Promise(function(t,o){e.canvasElement.toBlob(function(e){t({blob:e,imageHeight:n,imageWidth:a})})})}},{key:"takeBase64Photo",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{type:"jpeg",quality:1},t=e.type,a=e.quality,n=this._drawImage(),o=n.imageHeight,r=n.imageWidth;return{base64:this.canvasElement.toDataURL("image/"+t,a),imageHeight:o,imageWidth:r}}}]),e}(),N=Object(x.a)(function(e){return{root:{background:"black",height:"100%",width:"100%"},cameraErrorText:{color:"white",position:"absolute",top:"50%",left:"50%",width:"90%",transform:"translateY(-50%) translateX(-50%)",textAlign:"center"},disabledFab:{color:"#AAAAA!important",background:"#DDDDDD!important",opacity:.2},cameraFab:{position:"absolute",zIndex:10,"@media (orientation: landscape)":{right:"20px",top:"50%",transform:"translateY(-50%)",height:"25vh",width:"25vh"},"@media (orientation: portrait)":{bottom:"20px",left:"50%",transform:"translateX(-50%)",height:"25vw",width:"25vw"}},cameraIcon:{height:"100%",width:"100%"},cancelFab:{position:"absolute",zIndex:10,"@media (orientation: landscape)":{right:"15px",top:"15px",height:"15vh",width:"15vh"},"@media (orientation: portrait)":{right:"15px",bottom:"15px",height:"15vw",width:"15vw"}},cancelIcon:{height:"100%",width:"100%"},swipeDrawer:{width:"50%"},libraryFab:{position:"absolute",zIndex:10,"@media (orientation: landscape)":{left:"15px",top:"15px",height:"15vh",width:"15vh"},"@media (orientation: portrait)":{left:"15px",top:"15px",height:"15vw",width:"15vw"}},myLocationFab:{position:"absolute",zIndex:10,"@media (orientation: landscape)":{right:"15px",bottom:"15px",height:"15vh",width:"15vh"},"@media (orientation: portrait)":{left:"15px",bottom:"15px",height:"15vw",width:"15vw"}},myLocationIcon:{height:"80%",width:"80%"},capturedContainer:{position:"absolute",zIndex:1,height:"100%",width:"100%"},referenceContainer:{position:"absolute",zIndex:2,height:"100%",width:"100%"},captured:{},reference:{},video:{position:"absolute",top:0,left:0,height:"100vh",width:"100vw",zIndex:1}}});t.a=function(e){var t=e.photos,a=e.onCancel,i=e.onShutter,p=e.defaultRefPhotoId,h=N(),b=Object(o.useState)(50),x=Object(n.a)(b,2),E=x[0],O=x[1],k=p?t.find(function(e){return e.id===p}):t&&t.length>0?t[0]:null,I=Object(o.useState)(k),P=Object(n.a)(I,2),A=P[0],T=P[1],L=Object(o.useState)(!1),_=Object(n.a)(L,2),z=_[0],R=_[1],M=function(e){var t=Object(o.useState)(!1),a=Object(n.a)(t,2),r=a[0],i=a[1],l=Object(o.useState)(!1),s=Object(n.a)(l,2),c=s[0],u=s[1],d=Object(o.useRef)(),p=function(){d.current||(d.current=new C(document.getElementById("webcam"),document.createElement("canvas")),d.current.setup(window.innerWidth,window.innerHeight).then(function(e){u(!0)}).catch(function(e){console.error(e),i(!0)}))},m=function(){var t=Object(j.a)(S.a.mark(function t(){var a;return S.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:d.current&&c&&(a=d.current.takeBase64Photo({type:"jpeg",quality:1}),e(a));case 1:case"end":return t.stop()}},t)}));return function(){return t.apply(this,arguments)}}(),h=function(){window.setTimeout(p,1e3)};return Object(o.useEffect)(function(){return window.addEventListener("orientationchange",h),d.current||r||p(),function(){window.removeEventListener("orientationchange",h),d.current&&(d.current.destroy(),i(!1),u(!1)),d.current=null}},[]),{cameraError:r,captureImage:m,cameraOnline:c}}(function(e){return i(e,A?A.id:null)}),D=M.cameraError,F=M.captureImage,B=M.cameraOnline;return r.a.createElement("div",{className:h.root},r.a.createElement(u.a,null),!D&&Boolean(A)&&r.a.createElement(y.a,{defaultValue:E,onChange:O}),D&&r.a.createElement("div",{className:h.cameraErrorText},r.a.createElement(d.a,{variant:"subtitle1",color:"inherit"},"No Camera Access"),r.a.createElement(d.a,{variant:"body2",color:"inherit"},"Please enabled access in your settings.")),r.a.createElement("div",{className:h.captured},Boolean(A)&&r.a.createElement("div",{className:h.reference},r.a.createElement(w.a,{className:h.referenceContainer,opacity:(100-E)/100,photo:A})),!D&&r.a.createElement("video",{autoPlay:!0,playsInline:!0,muted:!0,id:"webcam",width:window.innerWidth,height:window.innerHeight,className:h.video})),r.a.createElement(s.a,{color:"primary","aria-label":"Take Photo",classes:{disabled:h.disabledFab},disabled:D||!B,className:l()(h.cameraFab,h.buttonFab),onClick:F},r.a.createElement(m.a,{className:h.cameraIcon})),r.a.createElement(s.a,{color:"secondary","aria-label":"cancel",onClick:a,classes:{disabled:h.disabledFab},className:l()(h.cancelFab,h.buttonFab)},r.a.createElement(g.a,{className:h.cancelIcon})),r.a.createElement(s.a,{"aria-label":"cancel",className:l()(h.libraryFab,h.buttonFab),classes:{disabled:h.disabledFab},disabled:!t||0===t.length,onClick:function(){return R(!0)}},r.a.createElement(f.a,{className:h.libraryIcon})),r.a.createElement(c.a,{anchor:"left",open:z,classes:{paperAnchorLeft:h.swipeDrawer},onClose:function(){return R(!1)},onOpen:function(){return R(!0)}},r.a.createElement("div",{tabIndex:0,className:h.swipeDrawerContainer,role:"button",onClick:function(){return R(!1)},onKeyDown:function(){return R(!1)}},r.a.createElement(v.a,{multiSelect:!1,columns:1,photos:t,onTileClick:function(e){T(t.find(function(t){return t.id===e})),R(!1)}}))))}},493:function(e,t,a){"use strict";var n=a(8),o=a(7),r=a(0),i=a.n(r),l=a(918),s=a(941),c=a(943),u=a(919),d=a(945),p=a(949),m=a(931),h=a(275),g=a(916),b=a(273),f=Object(g.a)(function(e){return{root:{},formLabel:{color:e.palette.text.secondary},mapFormLabel:{marginTop:e.spacing(2),marginBottom:e.spacing(1),color:e.palette.text.secondary},map:{marginBottom:e.spacing(2)},mapWrapper:{marginBottom:e.spacing(2)},field:{marginBottom:e.spacing(2)}}});t.a=function(e){var t=e.photo,a=e.newSeries,g=e.onCancel,y=e.onSave,v=f(),w=Object(r.useState)(a||{}),x=Object(o.a)(w,2),E=x[0],O=x[1],k=Object(r.useState)(t),S=Object(o.a)(k,2),j=S[0],C=S[1];return i.a.createElement("div",{className:v.root},i.a.createElement(l.a,null)," ",i.a.createElement(s.a,{fullScreen:!0,fullWidth:!0,scroll:"paper",disableBackdropClick:!0,disableEscapeKeyDown:!0,onClose:g,"aria-labelledby":"customized-dialog-title",open:!0},i.a.createElement(c.a,{disableTypography:!0,className:v.dlgTitleContainer},i.a.createElement(u.a,{variant:"h5",className:v.dlgTitle},"New Photo Properties")),i.a.createElement(d.a,null,!!a&&i.a.createElement(h.a,{series:a,delta:E,onChange:O}),i.a.createElement(b.a,{photo:t,canEdit:!0,delta:j,onChange:function(e){return C(Object(n.a)({},j,e))}})),i.a.createElement(p.a,null,i.a.createElement(m.a,{onClick:g,color:"primary"},"Cancel"),i.a.createElement(m.a,{onClick:function(){return y({series:E,photo:j})},color:"primary"},"Next"))))}},494:function(e,t,a){"use strict";var n=a(7),o=a(0),r=a.n(o),i=a(918),l=a(962),s=a(931),c=a(916),u=a(99),d=a(267),p=a(56),m=Object(c.a)(function(e){return{root:{background:"rgb(150,150, 150)",height:"100%",width:"100%"},capturedContainer:{position:"absolute",zIndex:1,height:"100%",width:"100%"},referenceContainer:{position:"absolute",zIndex:0,height:"100%",width:"100%"},captured:{},reference:{},referenceTextContainer:{width:"100%",display:"flex",color:"white",background:"rgba(0,0,0,0.5)",padding:e.spacing(3),position:"absolute",zIndex:4,top:0},newText:{flexGrow:1,color:"white",textShadow:"1 1 1 black",textAlign:"right"},refText:{flexGrow:1,color:"white",textShadow:"1 1 1 black"}}});t.a=function(e){var t=e.captured,a=e.defaultRefPhotoId,c=e.onConfirm,h=e.onCancel,g=e.onRetry,b=Object(o.useContext)(p.a).series,f=b&&b.photos?b.photos:null,y=m(),v=a?f.find(function(e){return e.id===a}):f&&f.length>0?f[0]:null,w=Object(o.useState)(v),x=Object(n.a)(w,2),E=x[0],O=(x[1],Object(o.useState)(100)),k=Object(n.a)(O,2),S=k[0],j=k[1];return t?r.a.createElement("div",{className:y.root},r.a.createElement(i.a,null),Boolean(E)&&r.a.createElement(d.a,{defaultValue:100,onChange:j}),r.a.createElement("div",{className:y.captured},r.a.createElement(u.a,{opacity:S/100,className:y.capturedContainer,photo:t})),Boolean(E)&&r.a.createElement("div",{className:y.reference},r.a.createElement(u.a,{className:y.referenceContainer,photo:E})),r.a.createElement(l.a,{open:!0,autoHideDuration:null,ContentProps:{"aria-describedby":"snackbar-fab-message-id",className:y.snackbarContent},message:r.a.createElement("span",{id:"snackbar-fab-message-id"},"Keep this photo?"),action:r.a.createElement("div",null,r.a.createElement(s.a,{color:"inherit",size:"small",onClick:h},"Cancel"),Boolean(g)&&r.a.createElement(s.a,{color:"inherit",size:"small",onClick:g},"Retry"),r.a.createElement(s.a,{color:"inherit",size:"small",onClick:c},"Keep")),className:y.snackbar})):"Loading..."}},496:function(e,t,a){"use strict";var n=a(0),o=a.n(n),r=a(919),i=a(233),l=a.n(i),s=a(916),c=a(23),u=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},t=Object(n.useRef)(),a=Object(n.useRef)(),r=o.a.createElement("input",{style:{display:"none"},ref:t,type:"file"});return Object(n.useEffect)(function(){var n=function(a){var n=Object(c.a)(t.current.files)[0];if(n){var o=new FileReader;o.onload=function(t){e(t.target.result)},o.readAsDataURL(n)}t.current.value=null};return t.current&&(t.current.addEventListener("change",n),a.current||(t.current.click(),a.current=!0)),function(){t.current&&t.current.removeEventListener("change",n)}},[t.current]),{fileClickEl:r,forceClick:function(){t.current&&t.current.click()}}},d=Object(s.a)(function(e){return{root:{height:"100%",display:"flex",flexDirection:"column",textAlign:"center",color:"#AAAAAA",border:"20px solid ".concat("#AAAAAA")},icon:{margin:"auto",flex:"1 1 50%",height:"70%",width:"70%"},text:{flex:"1 1 50%"}}});t.a=function(e){var t=e.onLibraryAdd,a=d(),n=u(t),i=n.fileClickEl,s=n.forceClick;return o.a.createElement("div",{className:a.root,onClick:s},i,o.a.createElement(l.a,{className:a.icon,color:"inherit"}),o.a.createElement(r.a,{variant:"h2",className:a.text,color:"inherit"},"Import from Library"))}},514:function(e,t,a){e.exports=a(879)},526:function(e,t){},532:function(e,t){},56:function(e,t,a){"use strict";a.d(t,"a",function(){return o});var n=a(0),o=a.n(n).a.createContext({})},77:function(e,t,a){"use strict";(function(e){a.d(t,"b",function(){return n}),a.d(t,"a",function(){return o});a(255);var n=function(e){try{return!isNaN(parseFloat(e))&&isFinite(e)}catch(t){return!1}};function o(e,t,a){var n=this,o=null;return function(){for(var r=arguments.length,i=new Array(r),l=0;l<r;l++)i[l]=arguments[l];var s=n,c=a&&!o;clearTimeout(o),o=setTimeout(function(){o=null,a||e.apply(s,i)},t),c&&e.apply(s,i)}}}).call(this,a(36).Buffer)},874:function(e,t,a){},879:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(21),i=a.n(r),l=a(8),s=a(39),c=a(316),u=a(444),d=a.n(u);Object(c.b)(d.a);o.a.createContext({});var p=function(e){var t=e.children;return o.a.createElement(c.a,{locale:"en"},t)},m=a(211),h=a(212),g=a.n(h);function b(){var e=Object(m.a)(["\nquery getWholeSeries($id: ID!) {\n  series(id: $id) {\n    id\n    name\n    note\n    meta\n    watchers\n    createdOn\n    createdUser {\n      id\n      gravatar\n      gravatarProfile\n      username\n    }\n    updatedOn\n    createdOn\n    coords\n    direction\n    photoCount\n    featured {\n      id\n      takenOn\n      paths {\n        base\n        large\n        thumb\n        medium\n      }\n    }\n    latest {\n      id\n      paths {\n        base\n        large\n        thumb\n        medium\n      }\n      takenOn\n    }\n    photos {\n      id\n      meta\n      createdOn\n      takenOn\n      updatedOn\n      createdOn\n      createdUser {\n        id\n        gravatar\n        gravatarProfile\n        username\n      }\n      tags {\n        label\n        typeId\n        coords {\n          x\n          y\n        }\n      }\n      paths {\n        base\n        large\n        thumb\n        medium\n      }\n    }\n  }\n}\n"]);return b=function(){return e},e}function f(){var e=Object(m.a)(["\n  query userSearch($searchStr: String!, $limit: Int) {\n    userSearch(searchStr: $searchStr, limit: $limit ){\n      id\n      username\n      gravatar\n      gravatarProfile\n      createdOn\n      updatedOn\n      createdOn\n    }\n  }\n"]);return f=function(){return e},e}function y(){var e=Object(m.a)(["\n  query myFeed($start: String, $end: String, $limit: Int) {\n    myFeed(start: $start, end: $end, limit: $limit) {\n      feed {\n        series {\n          id\n          name\n          createdUser {\n            id\n            gravatar\n            username\n          }\n          updatedOn\n          createdOn\n          access\n          coords\n          watchers\n          photoCount\n        }\n        photo {\n          id\n          updatedOn\n          createdOn\n          createdUser {\n            id\n            gravatar\n            gravatarProfile\n            username\n          }\n          paths {\n            base\n            thumb\n            medium\n          }\n        }\n        relation\n      }\n      window\n    }\n  }\n"]);return y=function(){return e},e}function v(){var e=Object(m.a)(["\n  query geocode($search: String!) {\n    geocoder(search: $search) {\n      relevance\n      text\n      placeName\n      bbox\n      center\n      # geoType\n      # context\n    }\n  }\n"]);return v=function(){return e},e}function w(){var e=Object(m.a)(["\n  query getUser($userId: ID) {\n    user(id: $userId){\n      id\n      username\n      gravatar\n      gravatarProfile\n      createdOn\n      updatedOn\n      createdOn\n      watching\n    }\n  }\n"]);return w=function(){return e},e}function x(){var e=Object(m.a)(["\n  query seriesInGeoBounds($bounds: [Float], $limit: Int, $nextToken: String) {\n    seriesInGeoBounds(bounds: $bounds, limit: $limit, nextToken: $nextToken) {\n      seriesSummaries {\n        id\n        name\n        access\n        createdUser {\n          id\n          gravatar\n          gravatarProfile\n          username        \n        }\n        updatedOn\n        photoCount\n        coords\n        direction\n        watchers\n        featured {\n          id\n          takenOn\n          paths {\n            base\n            thumb\n            medium\n            large\n          }\n        }\n        latest {\n          id\n          takenOn\n          paths {\n            base\n            thumb\n            medium\n            large\n          }\n        }\n      }\n    }\n  }\n"]);return x=function(){return e},e}function E(){var e=Object(m.a)(["\n  query tagSearch($limit: Int, $tag: String) {\n    tags(limit: $limit, tag: $tag ){\n      name\n      count\n    }\n  }\n"]);return E=function(){return e},e}function O(){var e=Object(m.a)(["\n  query seriesWithTag($tag: String!, $limit: Int) {\n    tagSeries(tag: $tag, limit: $limit) {\n      seriesSummaries{\n        id\n        name\n        access\n        createdUser {\n          id\n          gravatar\n          gravatarProfile\n          username        \n        }\n        updatedOn\n        createdOn\n        photoCount\n        coords\n        direction\n        watchers\n        featured {\n          id\n          takenOn\n          paths {\n            base\n            thumb\n            medium\n            large\n          }\n        }\n        latest {\n          id\n          takenOn\n          paths {\n            base\n            thumb\n            medium\n            large\n          }\n        }\n      }\n      nextToken\n    }\n  }\n"]);return O=function(){return e},e}function k(){var e=Object(m.a)(["\n  query seriesFromList($seriesList: [ID]) {\n    arraySeries(seriesIds: $seriesList) {\n      id\n      name\n      access\n      createdUser {\n        id\n        gravatar\n        gravatarProfile\n        username        \n      }\n      updatedOn\n      createdOn\n      photoCount\n      coords\n      direction\n      watchers\n      featured {\n        id\n        takenOn\n        paths {\n          base\n          thumb\n          medium\n          large\n        }\n      }\n      latest {\n          id\n          takenOn\n          paths {\n            base\n            thumb\n            medium\n            large\n          }\n        }\n    }\n  }\n"]);return k=function(){return e},e}function S(){var e=Object(m.a)(["\n  query userSeries($createdBy: ID) {\n    userSeries(createdBy: $createdBy ) {\n      seriesSummaries {\n        id\n        name\n        access\n        \n        createdUser {\n          id\n          gravatar\n          gravatarProfile\n          username        \n        }\n        updatedOn\n        createdOn\n        \n        photoCount\n        coords\n        direction\n        watchers\n        \n        featured {\n          id\n          takenOn\n          paths {\n            base\n            thumb\n            medium\n            large\n          }\n        }\n        latest {\n          id\n          takenOn\n          paths {\n            base\n            thumb\n            medium\n            large\n          }\n        }\n      }\n      nextToken\n    }\n  }\n"]);return S=function(){return e},e}function j(){var e=Object(m.a)(["\n  query pollQuery($lastCheck: String!, $limit: Int, $nextToken: String) {\n    changedSeries(lastCheck: $lastCheck, limit: $limit, nextToken: $nextToken){\n      seriesSummaries {\n        id\n        name\n        access\n        createdUser {\n          id\n          gravatar\n          gravatarProfile\n          username        \n        }\n        updatedOn\n        createdOn\n        photoCount\n        coords\n        direction\n        watchers\n        featured {\n          id\n          takenOn\n          paths {\n            base\n            thumb\n            medium\n            large\n          }\n        }\n        latest {\n          id\n          takenOn\n          paths {\n            base\n            thumb\n            medium\n            large\n          }\n        }\n      }\n    }\n  }\n"]);return j=function(){return e},e}function C(){var e=Object(m.a)(["\n  query allSeries($limit: Int, $nextToken: String) {\n    allSeries(limit: $limit, nextToken: $nextToken) {\n      seriesSummaries {\n        id\n        name\n        access\n        createdUser {\n          id\n          gravatar\n          gravatarProfile\n          username        \n        }\n        updatedOn\n        createdOn\n        photoCount\n        coords\n        direction\n        watchers\n        featured {\n          id\n          takenOn\n          paths {\n            base\n            thumb\n            medium\n            large\n          }\n        }\n        latest {\n          id\n          takenOn\n          paths {\n            base\n            thumb\n            medium\n            large\n          }\n        }\n      }\n      nextToken\n    }\n  }\n"]);return C=function(){return e},e}var N=g()(C()),I=g()(j()),P=g()(S()),A=g()(k()),T=g()(O()),L=g()(E()),_=g()(x()),z=g()(w()),R=g()(v()),M=g()(y()),D=g()(f()),F=g()(b()),B=o.a.createContext({}),U=a(919),$=a(918),W=a(916),G=function(){var e=Object(n.useRef)(),t=function(t){if("Enter"===t.key&&e.current)try{var a=e.current.getElementsByClassName("enterAction");a&&a[0]&&a[0].click()}catch(n){console.error("useAuthCommon::handleKeyPress",n)}};return Object(n.useEffect)(function(){if(e.current){try{document.addEventListener("keypress",t,!1)}catch(a){console.error("useAuthCommon::useEffect",a)}return function(){return document.removeEventListener("keypress",t,!1)}}},[]),e},q=Object(W.a)(function(e){return{root:{height:"100%"},bgSwoosh:{width:"100%",height:"100%",position:"absolute",top:0,left:0,zIndex:0},inner:{width:"100%",minWidth:200,maxWidth:300,position:"absolute",zIndex:2,textAlign:"center",top:"50%",left:"50%",transformOrigin:"50% 50%",transform:"translateY(-50%) translateX(-50%)"},bgSwooshFill:{fill:e.palette.primary.light}}}),H=function(e){var t=e.children,a=G(),n=q();return o.a.createElement("div",{ref:a,className:n.root},o.a.createElement($.a,null),o.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 500 500",preserveAspectRatio:"none",className:n.bgSwoosh},o.a.createElement("path",{className:n.bgSwooshFill,d:" M 0 0 L 500 0 C 500 209.782 489.956 180 250 180 C 10.044 180 0 219.954 0 370 L 0 0 Z "})),o.a.createElement("div",{className:n.inner},o.a.createElement("img",{alt:"logo",src:"".concat("/photomon_v0","/icons/Logo.svg")}),o.a.createElement(U.a,{variant:"h5"},"App Name Here"),t))},Y=function(){return o.a.createElement(H,null,o.a.createElement(U.a,{variant:"h3"},"Loading..."))},V=a(495),X=a(448),Q=a(10),J=a(59),Z=a(965),K=a(882),ee="apollo-token";var te=a(48),ae=a(80),ne=a(218),oe=a(216),re=a(219),ie=function(e){function t(e){var a;return Object(te.a)(this,t),(a=Object(ne.a)(this,Object(oe.a)(t).call(this,e))).state={hasError:!1},a}return Object(re.a)(t,e),Object(ae.a)(t,[{key:"render",value:function(){var e=this.state,t=e.hasError,a=e.error,n=this.props.fallback;return t?o.a.createElement(n,{error:a}):this.props.children}}],[{key:"getDerivedStateFromError",value:function(e){return console.error(e),{hasError:!0,error:e}}}]),t}(o.a.Component),le=a(7),se=a(307),ce=a.n(se),ue=a(11),de=a(303),pe=a.n(de),me=a(220),he=a(46),ge=a(961),be=a(931),fe=a(929),ye=a(930),ve=function(e){return{root:{},spacer:{flexGrow:1},forgotPassword:{width:"100%",textAlign:"right"},switch:{},switchButton:{flexGrow:1,"&:last-child":{borderRadius:0},"&:first-child":{borderRadius:0}},phoneNumInner:{marginTop:e.spacing(1),display:"flex"},phoneNumDropdown:{margin:e.spacing(1),minWidth:120},noSignin:{marginTop:e.spacing(2)}}},we=Object(W.a)(ve),xe=function(e){var t=e.loading,a=e.handleSignup,n=(e.federated,e.handleForgotPassword),r=e.handleInputChange,i=e.handleBeAnonymous,l=e.handleSignIn,s=(Object(he.a)(e,["loading","handleSignup","federated","handleForgotPassword","handleInputChange","handleBeAnonymous","handleSignIn"]),we());return o.a.createElement(H,null,o.a.createElement(ge.a,{id:"username",fullWidth:!0,key:"username",name:"username",label:"Username",autoFocus:!0,className:s.textField,margin:"normal",onChange:r}),o.a.createElement(ge.a,{fullWidth:!0,id:"password",label:"Password",key:"password",name:"password",type:"password",className:s.textField,autoComplete:"current-password",margin:"normal",onChange:r}),o.a.createElement(fe.a,{component:"button",variant:"body2",className:s.forgotPassword,disabled:t,onClick:n},"Forgot Password"),o.a.createElement(ye.a,{disableGutters:!0},o.a.createElement(be.a,{component:"button",color:"secondary",variant:"contained",disabled:t,onClick:a},"New Account"),o.a.createElement("div",{className:s.spacer}),o.a.createElement(be.a,{className:"enterAction",component:"button",color:"primary",variant:"contained",disabled:t,onClick:l},"Sign In")),o.a.createElement("div",{className:s.noSignin},o.a.createElement(be.a,{fullWidth:!0,variant:"outlined",onClick:i},"Continue without logging in"),o.a.createElement(U.a,{variant:"caption"},"You will not be able to add content and many features will be unavailable.")))},Ee=Object(W.a)(ve),Oe=function(e){var t=e.handleInputChange,a=e.handleBack,n=e.handleConfirm,r=Ee();return o.a.createElement(H,null,o.a.createElement(ge.a,{id:"mfaCode",fullWidth:!0,autoFocus:!0,label:"MFA Code",name:"code",className:r.textField,margin:"normal",onChange:t}),o.a.createElement(ye.a,{disableGutters:!0},o.a.createElement(be.a,{color:"secondary",variant:"contained",onClick:a},"Back"),o.a.createElement("div",{className:r.spacer}),o.a.createElement(be.a,{className:"enterAction",color:"primary",variant:"contained",onClick:n},"Confirm")))},ke=Object(W.a)(ve),Se=function(e){var t=e.change,a=e.requiredAttributes,n=e.placeholders,r=e.handleInputChange,i=ke();return o.a.createElement(H,null,o.a.createElement(U.a,null,"A new password is required"),o.a.createElement(ge.a,{id:"newassword",fullWidth:!0,autoFocus:!0,label:"New Password",className:i.textField,type:"password",autoComplete:"new-password",margin:"normal",onChange:r}),a.map(function(e,t){return o.a.createElement(ge.a,{fullWidth:!0,key:e,name:e,className:i.textField,placeholder:n[t],type:"text",margin:"normal",onChange:r})}),o.a.createElement(ye.a,{disableGutters:!0},o.a.createElement(be.a,{color:"secondary",variant:"contained"},"Back"),o.a.createElement("div",{className:i.spacer}),o.a.createElement(be.a,{color:"primary",variant:"contained",onClick:t,className:"enterAction"},"Change")))},je=a(921),Ce=a(922),Ne=a(960),Ie=Object(W.a)(ve),Pe=function(e){var t=e.handleInputChange,a=e.signUpFields,r=e.signUpFieldLabels,i=e.signUpFieldPlaceholders,l=e.handleSignup,s=e.handleBack,c=e.countryDialCodes,u=e.defaultDialCode;console.log("SIGNUPPROPS",{defaultDialCode:u,countryDialCodes:c,signUpFields:a,signUpFieldLabels:r,signUpFieldPlaceholders:i});var d=Object(n.useState)(u),p=Object(le.a)(d,2),m=p[0],h=p[1],g=Ie(),b=function(e){t(e),h(e.target.value)};return o.a.createElement(H,null,a.map(function(e,n){return"phone_number"!==e.key?o.a.createElement(ge.a,{fullWidth:!0,autoFocus:0===a.findIndex(function(t){return t.key===e.key}),type:e.type,name:e.key,key:e.key,placeholder:i[n],label:r[n],className:g.textField,margin:"normal",onChange:t}):o.a.createElement(je.a,{className:g.phoneNumDropdown,fullWidth:!0,key:"phonenum"},o.a.createElement(Ce.a,{htmlFor:"dial_code",shrink:!0},r[n],e.required?"*":""),o.a.createElement("div",{className:g.phoneNumInner},o.a.createElement(Ne.a,{value:m,onChange:b,inputProps:{name:"dial_code",id:"dial_code"}},c.map(function(e){return o.a.createElement("option",{key:e,value:e},e)})),o.a.createElement(ge.a,{placeholder:i[n],type:"tel",fullWidth:!0,id:"phone_line_number",key:"phone_line_number",name:"phone_line_number",onChange:t})))}),o.a.createElement(ye.a,{disableGutters:!0},o.a.createElement(be.a,{color:"secondary",variant:"outlined",onClick:s},"Back"),o.a.createElement("div",{className:g.spacer}),o.a.createElement(be.a,{className:"enterAction",component:"button",color:"primary",variant:"contained",onClick:l},"Create Account")))},Ae=Object(W.a)(ve),Te=function(e){var t=e.handleInputChange,a=e.handleBack,n=e.handleResend,r=e.handleConfirm,i=Ae();return o.a.createElement(H,null,o.a.createElement(ge.a,{id:"username",fullWidth:!0,autoFocus:!0,name:"username",label:"Username",className:i.textField,margin:"normal",onChange:t}),o.a.createElement(ge.a,{id:"confirmationCode",fullWidth:!0,name:"code",label:"Confirmation Code",className:i.textField,margin:"normal",onChange:t}),o.a.createElement(fe.a,{component:"button",variant:"body2",className:i.resendCode,onClick:n},"Resend Code"),o.a.createElement(ye.a,{disableGutters:!0},o.a.createElement(be.a,{color:"secondary",variant:"outlined",onClick:a},"Back"),o.a.createElement("div",{className:i.spacer}),o.a.createElement(be.a,{color:"primary",variant:"contained",className:"enterAction",onClick:r},"Sign In")))},Le=Object(W.a)(ve),_e=function(e){var t=e.handleSubmit,a=e.handleInputChange,r=e.handleSendCode,i=e.handleBack,l=Object(n.useState)(!1),s=Object(le.a)(l,2),c=s[0],u=s[1],d=Le();return o.a.createElement(H,null,o.a.createElement(U.a,null,"Forgot Password"),!c&&o.a.createElement(ge.a,{id:"username",autoFocus:!0,fullWidth:!0,label:"Username",name:"username",className:d.textField,margin:"normal",onChange:a}),c&&o.a.createElement(ge.a,{id:"changecode",fullWidth:!0,autoFocus:!0,label:"Code",name:"code",className:d.textField,margin:"normal",onChange:a}),c&&o.a.createElement(ge.a,{id:"newpassword",fullWidth:!0,label:"New Password",className:d.textField,type:"password",name:"password",autoComplete:"current-password",margin:"normal",onChange:a}),c&&o.a.createElement(fe.a,{component:"button",variant:"body2",className:d.resendCode,onClick:r},"Resend Code"),o.a.createElement(ye.a,{disableGutters:!0},o.a.createElement(be.a,{color:"secondary",variant:"outlined",onClick:function(){c?u(!1):i()}},"Back"),o.a.createElement("div",{className:d.spacer}),!c&&o.a.createElement(be.a,{color:"primary",variant:"contained",className:"enterAction",onClick:function(){u(!0),r()}},"Send Code"),c&&o.a.createElement(be.a,{className:"enterAction",color:"primary",variant:"contained",onClick:t},"Submit")))};ce.a.configure(Q.b);var ze={authState:"init",authData:{},signedIn:null},Re=function(){var e=Object(n.useState)(ze),t=Object(le.a)(e,2),a=t[0],r=a.authState,i=a.authData,l=a.signedIn,s=t[1],c=l?null:o.a.createElement(me.Authenticator,{onStateChange:function(e,t){s({authState:e,authData:t,signedIn:e&&0!==e.length?"signedIn"===e||l:null})},hideDefault:!0},o.a.createElement(Me,{handleBeAnonymous:function(){s({authState:r,authData:i,signedIn:!1})}}),o.a.createElement($e,null),o.a.createElement(Ue,null),o.a.createElement(Fe,null),o.a.createElement(Be,null),o.a.createElement(me.VerifyContact,null),o.a.createElement(We,null),o.a.createElement(De,null)),u=null;try{l&&(u=i.signInUserSession.accessToken.jwtToken)}catch(p){console.error(p)}var d=!1;try{d=i.signInUserSession.idToken.payload["cognito:groups"].indexOf("GodUsers")>-1}catch(p){}return{authState:r,authData:i,isGod:d,signOut:function(){return se.Auth.signOut().then(function(e){return console.log(e)}).catch(function(e){return console.log(e)})},forceSignIn:function(){return s(ze)},signedIn:l,accessToken:u,authScreen:c}},Me=function(e){function t(){return Object(te.a)(this,t),Object(ne.a)(this,Object(oe.a)(t).apply(this,arguments))}return Object(re.a)(t,e),Object(ae.a)(t,[{key:"showComponent",value:function(){var e=this,t=this.state.loading,a=Object(l.a)({},this.props,{loading:t,handleForgotPassword:function(){return e.changeState("forgotPassword")},handleSignup:function(){return e.changeState("signUp")},handleInputChange:this.handleInputChange,handleSignIn:this.signIn});return o.a.createElement(xe,a)}}]),t}(me.SignIn),De=function(e){function t(){return Object(te.a)(this,t),Object(ne.a)(this,Object(oe.a)(t).apply(this,arguments))}return Object(re.a)(t,e),Object(ae.a)(t,[{key:"showComponent",value:function(){var e=this,a=this.props.hide;if(a&&a.includes(t))return null;this.checkCustomSignUpFields()&&(this.signUpFields=this.props.signUpConfig.signUpFields),this.sortFields();var n=Object(l.a)({},this.props,{countryDialCodes:pe.a,defaultDialCode:this.getDefaultDialCode(),handleInputChange:this.handleInputChange,signUpFields:this.signUpFields,signUpFieldLabels:this.signUpFields.map(function(e){return ue.I18n.get(e.label)}),signUpFieldPlaceholders:this.signUpFields.map(function(e){return ue.I18n.get(e.placeholder)}),handleSignup:this.signUp,handleBack:function(){return e.changeState("signIn")}});return o.a.createElement(Pe,n)}}]),t}(me.SignUp),Fe=function(e){function t(){return Object(te.a)(this,t),Object(ne.a)(this,Object(oe.a)(t).apply(this,arguments))}return Object(re.a)(t,e),Object(ae.a)(t,[{key:"showComponent",value:function(){var e=this,t=Object(l.a)({},this.props,{handleBack:function(){return e.changeState("signIn")},handleInputChange:this.handleInputChange,handleConfirm:this.confirm});return o.a.createElement(Oe,t)}}]),t}(me.ConfirmSignIn),Be=function(e){function t(){return Object(te.a)(this,t),Object(ne.a)(this,Object(oe.a)(t).apply(this,arguments))}return Object(re.a)(t,e),Object(ae.a)(t,[{key:"showComponent",value:function(){var e=this,t=Object(l.a)({},this.props,{handleBack:function(){return e.changeState("signIn")},handleInputChange:this.handleInputChange,handleConfirm:this.confirm,handleResend:this.resend});return o.a.createElement(Te,t)}}]),t}(me.ConfirmSignUp),Ue=function(e){function t(){return Object(te.a)(this,t),Object(ne.a)(this,Object(oe.a)(t).apply(this,arguments))}return Object(re.a)(t,e),Object(ae.a)(t,[{key:"showComponent",value:function(){var e=this.props.authData.challengeParam.requiredAttributes,t=Array.isArray(e)?e.map(function(e){return ue.I18n.get(e.split("_").map(function(e){return e.charAt(0).toUpperCase()+e.substr(1).toLowerCase()}).join(" "))}):[],a=Object(l.a)({},this.props,{handleInputChange:this.handleInputChange,requiredAttributes:e,placeholders:t,change:this.change});return o.a.createElement(Se,a)}}]),t}(me.RequireNewPassword),$e=function(e){function t(){return Object(te.a)(this,t),Object(ne.a)(this,Object(oe.a)(t).apply(this,arguments))}return Object(re.a)(t,e),Object(ae.a)(t,[{key:"showComponent",value:function(){return o.a.createElement(Y,this.props)}}]),t}(me.Loading),We=function(e){function t(){return Object(te.a)(this,t),Object(ne.a)(this,Object(oe.a)(t).apply(this,arguments))}return Object(re.a)(t,e),Object(ae.a)(t,[{key:"showComponent",value:function(){var e=this,t=Object(l.a)({},this.props,{handleBack:function(){return e.changeState("signIn")},handleInputChange:this.handleInputChange,handleConfirm:this.confirm,handleResend:this.send,handleSubmit:this.submit,handleSendCode:this.send});return o.a.createElement(_e,t)}}]),t}(me.ForgotPassword);var Ge=a(105),qe=function(){var e,t=function(t){t.preventDefault(),e=t,function(){var e=document.querySelector(".ad2hs-prompt");e.style.display="block",e.addEventListener("click",a)}()};function a(){document.querySelector(".ad2hs-prompt").style.display="none",e.prompt(),e.userChoice.then(function(t){"accepted"===t.outcome?console.log("User accepted the A2HS prompt"):console.log("User dismissed the A2HS prompt"),e=null})}Object(n.useEffect)(function(){return!Object(Ge.a)()||"standalone"in window.navigator&&window.navigator.standalone||console.log("I AM on IOS and I am NOT in standalone mode."),window.addEventListener("beforeinstallprompt",t),function(){window.removeEventListener("beforeinstallprompt",t)}},[])},He=a(77),Ye=function(){var e=window,t=e.orientation,a=e.innerWidth,n=e.innerHeight,o=e.screen,r=o.width,i=o.height,l=0!==[90,270].indexOf(t)?"portrait":"landscape",s=Object(Ge.a)(),c=Object(Ge.b)(),u={width:a,height:n},d={width:r,height:i};return{isPhone:c,isIos:s,orientation:l,windowSize:u,screenSize:d,keyboard:c&&u.height<d.height}},Ve=function(e){var t=Object(n.useState)(Ye()),a=Object(le.a)(t,2),o=a[0],r=a[1],i=Object(n.useCallback)(Object(He.a)(function(e){e&&(e.preventDefault(),e.stopPropagation());var t=Ye();console.log("handleResize",t),r(t)},500),[]);return Object(n.useLayoutEffect)(function(){return i(),window.addEventListener("resize",i),function(){window.removeEventListener("resize",i)}},[]),o},Xe=a(451),Qe=a(76),Je=a(67),Ze=a(308),Ke=a(23),et="HOME_CHANGE_STATE",tt="HOME_CHANGE_ACTIVE_SERIES",at="HOME_STATE_BACK",nt="MAP_HISTORY_POP",ot="MAP_HISTORY_PUSH",rt="MAP_HISTORY_CLEAR",it="UPLOADER_START",lt="UPLOADER_COMPLETE",st="UPLOADER_UPDATE_PROGRESS",ct=function(e,t){return{type:et,data:{newDomain:e,params:t}}},ut=function(){return{type:at}},dt=function(e,t){return{type:tt,data:{seriesId:e,initialPhoto:t}}},pt=function(){return{type:nt}},mt=function(e){return{type:ot,data:e}},ht=function(){return{type:rt}},gt=function(e){return{type:it,data:e}},bt=function(){return{type:lt}},ft=function(e){return{type:st,data:e}},yt=[{mode:Q.e.MapModeTypes.FREE,viewport:{latitude:36.80191008366581,longitude:-111.63999999999784,zoom:11}}],vt={history:[],current:{domain:Q.e.AppStateTypes.FEED}},wt={store:[],activeUpload:null},xt=Object(Je.combineReducers)({map:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:yt,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.data;switch(a){case rt:return e.length>0?[[e.length-1]]:[];case nt:return e.slice(0,-1);case ot:return[].concat(Object(Ke.a)(e),[n]);default:return e}},home:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:vt,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.data,o=e.history,r=e.current;switch(a){case at:var i=Object(Ke.a)(o);return{current:i.length>0?i.pop():vt.current,history:i};case tt:var s=r.activeSeries,c=r.initialPhoto;return{history:o,current:Object(l.a)({},r,{activeSeries:s||null,initialPhoto:s&&c?c:null})};case et:var u=n.newDomain,d=n.params||{};return{history:[].concat(Object(Ke.a)(o),[r]),current:Object(l.a)({},r,{domain:u},d)};default:return e}},uploader:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:wt,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.data,o=e.store,r=e.activeUpload;switch(a){case it:return r?Object(l.a)({},e,{store:[].concat(Object(Ke.a)(o),[n])}):Object(l.a)({},e,{activeUpload:n});case lt:if(0===o.length)return Object(l.a)({},e,{activeUpload:null});var i=Object(Ke.a)(o),s=i.pop();return Object(l.a)({},e,{store:i,activeUpload:s});case st:return Object(l.a)({},e,{activeUpload:Object(l.a)({},r,n)});default:return e}}}),Et=a(315),Ot=a(452),kt={key:"root",storage:a.n(Ot).a},St=Object(Et.a)(kt,xt),jt=function(){var e,t=Object(Je.createStore)(St,e,Object(Je.compose)(Object(Je.applyMiddleware)(Ze.a)));return{store:t,persistor:Object(Et.b)(t)}},Ct=function(e){return function(t){var a=jt(),n=a.store,r=a.persistor;return console.log("withReduxProvider",{props:t,store:n,persistor:r}),o.a.createElement(Qe.a,{store:n},o.a.createElement(Xe.a,{loading:Y,persistor:r},o.a.createElement(e,t)))}},Nt=a(19),It=a.n(Nt),Pt=a(926),At=a(933),Tt=Object(W.a)(function(e){return{root:{background:"black",color:e.palette.primary.contrastText,padding:2*e.spacing(1)},message:{},msgText:{display:"flex"},spacer:{flexGrow:1},messageInner:{}}}),Lt=function(e){var t=e.className,a=e.text,n=e.progress,r=Tt();if(!a)return null;var i="Uploading: ".concat(a);return o.a.createElement("div",{className:It()(r.root,t)},o.a.createElement("div",{className:r.messageInner},o.a.createElement("div",{className:r.msgText},o.a.createElement(U.a,{color:"inherit"},i),o.a.createElement("div",{className:r.spacer}),o.a.createElement(U.a,{color:"inherit"},n,"%")),o.a.createElement(At.a,{color:"secondary",variant:"determinate",value:n})))},_t=Lt,zt=function(e){var t=e.text,a=e.progress,n=Rt();return o.a.createElement("div",{className:n.root},o.a.createElement($.a,null)," ",o.a.createElement(Pt.a,{className:n.paper},o.a.createElement(U.a,{variant:"h5"},"This is a dummy component.")),o.a.createElement(Lt,{text:t,progress:a}))},Rt=Object(W.a)(function(e){return{root:{height:"100%",display:"flex",flexDirection:"column"},paper:{flexGrow:1}}});zt.displayName=Lt.displayName;var Mt=a(33),Dt=a.n(Mt),Ft=a(49),Bt=a(244),Ut=a.n(Bt),$t=a(453),Wt=a.n($t);function Gt(){return(Gt=Object(Ft.a)(Dt.a.mark(function e(t,a,n){var o,r,i;return Dt.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("UploadConntect: upload start",t),o=new Wt.a,Object.keys(t.preAuth.fields).forEach(function(e){console.log("APPEND",e,t.preAuth.fields[e]),o.append(e,t.preAuth.fields[e])}),r=qt(t.base64,"a.png"),o.append("file",r),i={headers:{"Content-Type":"multipart/form-data"},onUploadProgress:function(e){var t=e.loaded,n=e.total;console.log("PROGRESSEVENT",t,n,Math.floor(100*t/n)),a({progress:Math.floor(100*t/n)})}},console.log("FORMDATA",o),e.next=9,Ut.a.post(t.preAuth.url,o,i).catch(function(e){console.error(e),console.log(e.stack)});case 9:console.log("UploadConntect: upload done"),n();case 11:case"end":return e.stop()}},e)}))).apply(this,arguments)}function qt(e,t){for(var a=e.split(","),n=a[0].match(/:(.*?);/)[1],o=atob(a[1]),r=o.length,i=new Uint8Array(r);r--;)i[r]=o.charCodeAt(r);return new File([i],t,{type:n})}Ut.a.interceptors.request.use(function(e){return console.log("AXIOS:::: Starting Request",e),e},function(e){return console.log("AXIOS:::: Starting Request ERROR",e),Promise.reject(e)}),Ut.a.interceptors.response.use(function(e){return console.log("AXIOS:::: Response",e),e},function(e){return console.log("AXIOS:::: Starting Response ERROR",e),Promise.reject(e)});var Ht=Object(Qe.b)(function(e,t){return{activeUpload:e.uploader.activeUpload}},function(e){return{completeActiveUpload:function(){e(bt())},updateUploadProgress:function(t){e(ft(t))}}})(function(e){var t=e.activeUpload,a=e.completeActiveUpload,r=e.updateUploadProgress,i=Object(he.a)(e,["activeUpload","completeActiveUpload","updateUploadProgress"]),l=Object(n.useRef)();return Object(n.useEffect)(function(){l.current=l.current&&!!t,t&&!l.current&&function(e,t,a){Gt.apply(this,arguments)}(t,r,a)},[Boolean(t)]),t?o.a.createElement(_t,Object.assign({text:"Uploading thing",progress:t.progress||0},i)):null}),Yt=a(91),Vt={admin:{series:{"create:own":["*"],"read:any":["*"],"update:any":["*"],"delete:any":["*"]},photo:{"create:any":["*"],"read:any":["*"],"update:any":["*"],"delete:any":["*"]}},nonuser:{photo:{"read:any":["*"],"update:any":["*"],"delete:any":["*"]},series_public:{"read:any":["*"]},series_open:{"read:any":["*"]}},user:{series:{"create:own":["*"],"read:own":["*"],"update:own":["*"],"delete:own":["*"]},series_public:{"read:any":["*"]},series_open:{"read:any":["*"],"update:any":["photos"]},photo:{"read:any":["*"],"create:own":["*"],"update:own":["*"],"delete:own":["*"]}}};function Xt(){var e=Object(m.a)(["\n  mutation unWatch($seriesId: ID) {\n    unWatchSeries(seriesId: $seriesId)\n  }\n"]);return Xt=function(){return e},e}function Qt(){var e=Object(m.a)(["\n  mutation watch($seriesId: ID) {\n    watchSeries(seriesId: $seriesId)\n  }\n"]);return Qt=function(){return e},e}function Jt(){var e=Object(m.a)(["\n  mutation createSeries($series: NewSeriesInput!) {\n    createSeries(series: $series) {\n      id\n      name\n      note\n      meta\n      # createdOn\n      # updatedOn\n      latitude\n      longitude\n      direction\n      photoCount\n      featured {\n        id\n        takenOn\n        paths {\n          base\n          thumb\n          medium\n          large\n        }\n      }\n      # latest {\n      #   id\n      #   paths {\n      #     thumb\n      #   }\n      #   createdBy\n      #   createdOn\n      #   takenOn\n      #   updatedOn\n      # }\n      photos {\n        id\n        meta\n        createdUser {\n          id\n          gravatar\n          gravatarProfile\n          name\n        }   \n        # createdOn\n        takenOn\n        # updatedOn\n        tags {\n          label\n          typeId\n          coords {\n            x\n            y\n          }\n        }\n        paths {\n          base\n          thumb\n          medium\n          large\n        }\n      }\n    }\n  }\n"]);return Jt=function(){return e},e}function Zt(){var e=Object(m.a)(["\n  mutation createPhoto($photo: NewPhotoInput!, $ext: String!) {\n    createPhoto(photo: $photo, ext: $ext) {\n      photo {\n        id\n        meta\n        createdUser {\n          id\n          gravatar\n          gravatarProfile\n          name\n        }\n        seriesId\n        # createdOn\n        takenOn\n        # updatedOn\n        tags {\n          label\n          typeId\n          coords {\n            x\n            y\n          }\n        }\n        paths {\n          base\n          thumb\n          medium\n          large\n        }\n      }\n      preAuth\n    }\n  }\n"]);return Zt=function(){return e},e}function Kt(){var e=Object(m.a)(["\n  mutation updatePhoto($photo: UpdatePhotoInput!) {\n    updatePhoto(photo: $photo){\n      id\n    }\n  }\n"]);return Kt=function(){return e},e}function ea(){var e=Object(m.a)(["\n  mutation updateSeries($series: UpdateSeriesInput!) {\n    updateSeries(series: $series){\n      id\n      name\n      note\n      meta\n      latitude\n      longitude\n      direction\n      photoCount\n      featured {\n        id\n        takenOn\n        paths {\n          base\n          thumb\n          medium\n          large\n        }\n      }     \n    }\n  }\n"]);return ea=function(){return e},e}function ta(){var e=Object(m.a)(["\n  mutation deleteSeries($id: ID!) {\n    deleteSeries(id: $id)\n  }\n"]);return ta=function(){return e},e}function aa(){var e=Object(m.a)(["\n  mutation deletePhoto($seriesId: ID!, $photoId: ID!) {\n    deletePhoto(seriesId: $seriesId, photoId: $photoId)\n  }\n"]);return aa=function(){return e},e}var na=g()(aa()),oa=g()(ta()),ra=g()(ea()),ia=g()(Kt()),la=g()(Zt()),sa=g()(Jt()),ca=g()(Qt()),ua=g()(Xt()),da=a(952),pa=a(944),ma=a(957),ha=a(953),ga=a(236),ba=a.n(ga),fa=a(258),ya=a.n(fa),va=a(463),wa=a.n(va),xa=a(309),Ea=a.n(xa),Oa=a(462),ka=a.n(Oa),Sa=a(464),ja=a.n(Sa),Ca=a(465),Na=a.n(Ca),Ia=a(237),Pa=a(963),Aa=a(964),Ta=a(233),La=a.n(Ta),_a=Object(W.a)(function(e){return{root:{position:"absolute",bottom:e.mixins.toolbar/2,left:"50%",transformOrigin:"50% 50%",transform:"translateY(-50%) translateX(-50%)"},speedDialFab:{background:e.palette.secondary.main,color:e.palette.secondary.contrastText},directionUp:{}}}),za=function(e){var t=e.className,a=e.children,r=e.onCameraClick,i=e.onLibraryClick,l=Object(n.useState)(!1),s=Object(le.a)(l,2),c=s[0],u=s[1],d=Object(n.useState)(!1),p=Object(le.a)(d,2),m=p[0],h=p[1],g=_a(),b=Object(n.useRef)(m);b.current=m;var f=function(e){e.currentTarget,h(!0),c||setTimeout(function(){b.current&&u(!0)},300)},y=function(e){e&&e.stopPropagation&&(e.stopPropagation(),e.preventDefault())};return o.a.createElement(Pa.a,{ariaLabel:"SpeedDial photo adder",onBlur:function(e){setTimeout(function(){return u(!1)},250)},classes:{directionUp:g.directionUp,root:g.root,fab:It()(g.speedDialFab,t)},icon:a,onClick:function(e){y(e),h(!1),c||(console.log("cameraclick MAIN"),r())},onMouseDown:f,onTouchStart:f,open:c,direction:"up"},o.a.createElement(Aa.a,{icon:o.a.createElement(ya.a,{className:g.speedDialIcon}),tooltipPlacement:"right",tooltipTitle:"From Camera",tooltipOpen:!0,onClick:function(e){console.log("cameraclick"),u(!1),h(!1),r(),y(e)}}),o.a.createElement(Aa.a,{icon:o.a.createElement(La.a,{className:g.speedDialIcon}),tooltipPlacement:"right",tooltipTitle:"From Photo Library",tooltipOpen:!0,onClick:function(e){console.log("libraryClick"),u(!1),h(!1),i(),y(e)}}))},Ra=a(881),Ma=a(937),Da=a(939),Fa=a(940),Ba=a(936),Ua=function(e){var t=e.anchorEl,a=e.onClose,n=e.menuItems;return o.a.createElement(Ra.a,{anchorEl:t,open:!!t,onClose:a},n.map(function(e,t){var n=e.icon,r=e.color,i=e.text,l=e.hide,s=e.disabled,c=e.action,u=e.divider,d=n||null;return l?null:u?o.a.createElement(Ba.a,{key:"contextMenu-".concat(t)}):o.a.createElement(Ma.a,{key:"contextMenu-".concat(t),disabled:s,onClick:function(){a(),c()}},d&&o.a.createElement(Da.a,null,o.a.createElement(d,{color:s?"disabled":r})),o.a.createElement(Fa.a,{primary:i,primaryTypographyProps:{color:r}}))}))},$a=a(928),Wa=a(938),Ga=a(923),qa=a(227),Ha=a(234),Ya=a(259),Va=a(47),Xa=a(127),Qa="NOTEVIEW",Ja=Object(W.a)(function(e){return{root:{margin:e.spacing(1),backgroundColor:e.palette.background.paper,marginBottom:60},field:{marginBottom:e.spacing(1)},list:{padding:e.spacing(1)},heading:{marginTop:e.spacing(1)},tagListItem:{marginTop:e.spacing(1),marginBottom:e.spacing(2)},chip:{margin:e.spacing(.5)}}}),Za=function(e){var t=e.seriesConfig,a=e.series,r=Ja(),i=new Xa.a(t),s=Object(n.useState)(null),c=Object(le.a)(s,2),u=c[0],d=c[1],p=a.photos.reduce(function(e,t){return t.tags.forEach(function(t){if(e[t.typeId])if(e[t.typeId][t.label]){var a=e[t.typeId][t.label];e[t.typeId][t.label]=Object(l.a)({},a,{count:a.count+1})}else e[t.typeId][t.label]=Object(l.a)({},t,{count:1});else e[t.typeId]=Object(Yt.a)({},t.label,Object(l.a)({},t,{count:1}))}),e},{}),m=[];try{m=a.meta?Object.keys(JSON.parse(a.meta)):[]}catch(h){console.error(h)}return o.a.createElement("div",{className:r.root},o.a.createElement("div",{className:r.field},o.a.createElement(Ga.a,{className:r.formLabel},"Series Name"),o.a.createElement(U.a,{variant:"body1",color:"inherit"},a.name)),a.note&&o.a.createElement(Ha.a,{label:"Series Note",text:a.note,onClick:function(){return d(Qa)}}),o.a.createElement(U.a,{className:r.heading,variant:"subtitle1"},"Series Summary"),o.a.createElement(Ba.a,null),o.a.createElement($a.a,{className:r.list},o.a.createElement(Wa.a,{disableGutters:!0},o.a.createElement(Fa.a,{primary:"Photos: ".concat(a.photos.length),secondary:a.photos.length>0&&o.a.createElement("span",null,"First: ",Object(Va.d)(a.photos[a.photos.length-1].takenOn,"lll"),o.a.createElement("br",null),"Latest: ",Object(Va.d)(a.photos[0].takenOn,"lll"))})),o.a.createElement(Wa.a,{disableGutters:!0},o.a.createElement(Fa.a,null,o.a.createElement(Ga.a,{className:r.formLabel},"Tags in use (across all photos)"),o.a.createElement(Ba.a,null),0===Object.keys(p).length&&o.a.createElement(U.a,{variant:"caption"},"No photos in this series have tags"),Object.keys(p).map(function(e,t){return o.a.createElement("div",{key:"tagchipkey".concat(t),className:r.tagListItem},o.a.createElement(U.a,{className:r.subheading,variant:"overline"},i.getTagType(e).label),o.a.createElement(Ba.a,null),Object.values(p[e]).length>0?Object.values(p[e]).map(function(a,n){return o.a.createElement(qa.a,{key:"tagchip-".concat(t,"-").concat(n),tag:a,color:i.getTagType(e).color})}):o.a.createElement(U.a,{variant:"caption"},"No photos in this series have tags"))})))),m.length>0&&Object.keys(t.meta).length>0&&o.a.createElement(o.a.Fragment,null,o.a.createElement(Ga.a,{className:r.formLabel},"Metadata"),o.a.createElement(Ba.a,null),o.a.createElement($a.a,{className:r.list},m.map(function(e,n){return t.meta[e]?o.a.createElement(Wa.a,{key:"metadata".concat(n)},o.a.createElement(Fa.a,{primary:t.meta[e].label,secondary:t.meta[e].render(a.meta[e])})):null}))),u===Qa&&o.a.createElement(Ya.a,{open:!0,multiline:!0,onClose:function(){return d(null)},title:"Series Note",body:a.note}))},Ka=a(948),en=a(946),tn=a(947),an=a(103),nn=a.n(an),on=a(226),rn=a.n(on),ln=a(225),sn=a.n(ln),cn=a(260),un=a.n(cn),dn=a(99),pn=a(934),mn=Object(W.a)(function(e){return{root:{position:"relative"},inner:{position:"relative"},photoWrapper:{minHeight:250,height:250},dateCaption:{padding:e.spacing(1),background:"black",color:"white",textAlign:"center"},mobileStepper:{},manualBack:{color:"white",zIndex:10,position:"absolute",transform:"translateY(-50%)",left:0,top:"50%"},manualForward:{color:"white",zIndex:10,position:"absolute",transform:"translateY(-50%)",right:0,top:"50%"},tagButton:{color:"rgba(255, 255, 255, 0.54)"},slideshowButton:{color:"rgba(255, 255, 255, 0.54)"},dots:{margin:"0 auto"}}}),hn=function(e){var t=e.photos,a=e.initialPhoto,r=e.onImageSelect,i=mn(),l=Object(pn.a)(),s=a&&t.findIndex(function(e){return e.id===a})||0,c=Object(n.useState)(s>=0?s:0),u=Object(le.a)(c,2),d=u[0],p=u[1],m=Object(n.useState)(!1),h=Object(le.a)(m,2),g=h[0],b=h[1],f=t.length<2,y=Object(Ke.a)(t);y.sort(function(e,t){return parseInt(t.takenOn,10)-parseInt(e.takenOn,10)});return o.a.createElement("div",{className:i.root},o.a.createElement("div",{className:i.inner},o.a.createElement(un.a,{axis:"rtl"===l.direction?"x-reverse":"x",index:d,onChangeIndex:function(e){return p(e)},enableMouseEvents:!0},y.map(function(e,t){return o.a.createElement("div",{className:i.photoWrapper,key:"swipeshowpic-".concat(t),onClick:function(){return r(y[d].id)}},o.a.createElement(dn.a,{photo:e,className:i.photo,showTags:g}))})),o.a.createElement(pa.a,{size:"small",className:i.manualBack,onClick:function(){return p(d<=0?y.length-1:d-1)},color:"inherit",disabled:0===d},"rtl"===l.direction?o.a.createElement(sn.a,null):o.a.createElement(rn.a,null)),o.a.createElement(pa.a,{size:"small",className:i.manualForward,onClick:function(){return p(d>=y.length?0:d+1)},color:"inherit",disabled:d===t.length-1},"rtl"===l.direction?o.a.createElement(rn.a,null):o.a.createElement(sn.a,null)),o.a.createElement(en.a,{title:f?"Photo":"Photo (".concat(d+1,"/").concat(y.length,")"),subtitle:y.length>0&&o.a.createElement("span",null,Object(Va.d)(y[d].takenOn)),actionIcon:o.a.createElement(o.a.Fragment,null,o.a.createElement(pa.a,{className:i.tagButton,onClick:function(){return b(!g)}},o.a.createElement(tn.a,{color:g?"primary":"secondary",badgeContent:y[d].tags?y[d].tags.filter(function(e){return e.coords}).length:null},o.a.createElement(nn.a,null))))})),!f&&o.a.createElement(Ka.a,{steps:y.length,position:"static",activeStep:d,classes:{root:i.mobileStepper,dots:i.dots}}))};hn.defaultProps={transition:5e3,isFullScreen:!1,slides:[]};var gn=hn,bn=a(276),fn=a(264),yn=a(56),vn=Object(W.a)(function(e){return{root:{display:"flex",height:"100%",flexDirection:"column",overflow:"hidden"},appBar:{flexGrow:0},inner:{position:"relative",flexGrow:1,overflowY:"scroll","-webkit-overflow-scrolling":"touch"},tabMenu:{marginTop:e.spacing(7)},mapWrap:{position:"absolute",height:"100%",width:"100%",top:0,left:0},toolbarTitle:{flexGrow:1,textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"},AddFab:{background:e.palette.secondary.main,color:e.palette.secondary.contrastText},grow:{flexGrow:1},gridList:{flexWrap:"nowrap",transform:"translateZ(0)"},titleBar:{display:"flex",padding:e.spacing(1)},menuButton:{}}}),wn=function(e){var t=e.onSlideshowStart,a=e.onChange,r=e.onEditSeries,i=e.onDeletePhotos,l=e.onCameraAdd,s=e.onDeleteSeries,c=e.onLibraryAdd,u=e.onTileClick,d=e.onMenuBack,p=e.onWatch,m=e.onUnWatch,h=e.initialPhoto,g=e.watching,b=e.owned,f=vn(),y=Object(n.useState)(),v=Object(le.a)(y,2),w=v[0],x=v[1],E=Object(n.useState)(!1),O=Object(le.a)(E,2),k=O[0],S=O[1],j=Object(n.useContext)(yn.a),C=j.series,N=j.seriesConfig,I=j.ac,P={zoom:16};C.coords&&2===C.coords.length&&(P.longitude=C.coords[0],P.latitude=C.coords[1]);var A={update:I.canUser("update",C,"series","*"),delete:I.canUser("delete",C,"series","*"),contribute:I.canUser("update",C,"series",["photos"])},T=Object(n.useState)(0),L=Object(le.a)(T,2),_=L[0],z=L[1];return o.a.createElement("div",{className:f.root},o.a.createElement($.a,null),o.a.createElement(da.a,{position:"static",className:f.appBar},o.a.createElement(ye.a,{disableGutters:!0},o.a.createElement(pa.a,{className:f.menuButton,color:"inherit",onClick:d,"aria-label":"Menu"},o.a.createElement(ba.a,null)),o.a.createElement(U.a,{variant:"subtitle1",color:"inherit",className:f.toolbarTitle},C.name||"Series"),o.a.createElement(pa.a,{className:f.menuButton,color:"inherit",onClick:t,"aria-label":"Menu"},o.a.createElement(ka.a,null)),o.a.createElement(pa.a,{"aria-haspopup":"true",color:"inherit",onClick:function(e){return x(e.currentTarget)}},o.a.createElement(wa.a,null)),o.a.createElement(Ua,{anchorEl:w,onClose:function(){return x(null)},menuItems:[{text:"Watch Series",icon:Ea.a,hide:!p||b||g,action:p},{text:"Unwatch Series",icon:Ea.a,hide:!m||b||!g,action:m},{divider:!0},{text:"Edit Series",icon:ja.a,hide:!r||!A.update,action:r},{text:"Delete Series",icon:Na.a,hide:!S||!A.delete,color:"error",action:function(){return S(!0)}}]})),o.a.createElement(ma.a,{variant:"fullWidth",value:_,onChange:function(e,t){return z(t)}},o.a.createElement(ha.a,{label:"Info"}),o.a.createElement(ha.a,{label:"Map"}),o.a.createElement(ha.a,{label:"Photos"}))),o.a.createElement("div",{className:f.inner},0===_&&o.a.createElement(o.a.Fragment,null,C.photos&&C.photos.length>0&&o.a.createElement(gn,{photos:C.photos,initialPhoto:h,onImageSelect:u}),o.a.createElement(Za,{series:C,seriesConfig:N,onChange:a})),C.photos&&2===_&&o.a.createElement(bn.a,{photos:C.photos,onTileClick:u,onDelete:i})),1===_&&o.a.createElement(Ia.a,{longitude:C.longitude,latitude:C.latitude,viewport:P,direction:C.direction}),0===_&&A.contribute&&o.a.createElement(za,{className:f.AddFab,onCameraClick:l,onLibraryClick:c},o.a.createElement(ya.a,null)),o.a.createElement(fn.a,{open:k,onConfirm:function(e){S(!1),!0===e&&s(C.id)},title:"Delete Series",message:"Are you sure you want to delete this series? The record and all images associated with it will be gone forever."}))},xn=a(945),En=a(941),On=a(943),kn=a(949),Sn=a(275),jn=Object(W.a)(function(e){return{root:{},inner:{display:"flex",flexDirection:"column"},dlgTitle:{background:e.palette.primary.main,color:e.palette.primary.contrastText},grow:{flexGrow:1},field:{flexGrow:0,marginBottom:e.spacing(2)},slider:{paddingLeft:e.spacing(1),paddingRight:e.spacing(1)},textField:{marginLeft:e.spacing(1),marginRight:e.spacing(1),width:"100%"},formLabel:{display:"block",marginTop:e.spacing(1),marginBottom:e.spacing(1)},mapFormLabel:{display:"block",marginTop:e.spacing(1),marginBottom:e.spacing(1)},mapInnerWrap:{flexGrow:1},mapWrapper:{flexGrow:1,display:"flex",flexDirection:"column",paddingBottom:e.spacing(2)},formControl:{margin:e.spacing(1),minWidth:120},chips:{display:"flex",flexWrap:"wrap"}}}),Cn=function(e){var t=e.onOk,a=e.onCancel,r=jn(),i=Object(n.useContext)(yn.a).series,s=Object(n.useState)({}),c=Object(le.a)(s,2),u=c[0],d=c[1];return o.a.createElement(En.a,{scroll:"paper",className:r.root,fullScreen:!0,open:!0,fullWidth:!0,onClose:a},o.a.createElement($.a,null),o.a.createElement(On.a,{disableTypography:!0,className:r.dlgTitle},o.a.createElement(U.a,{variant:"subtitle1",color:"inherit",className:r.grow},"Edit Series Details")),o.a.createElement(xn.a,{className:r.inner},o.a.createElement(Sn.a,{series:i,delta:u,onChange:d})),o.a.createElement(kn.a,null,o.a.createElement(be.a,{className:r.menuButton,color:"inherit",onClick:function(){return d({})},"aria-label":"Menu"},"Reset"),o.a.createElement(be.a,{className:r.menuButton,color:"inherit",onClick:a,"aria-label":"Menu"},"Cancel"),o.a.createElement(be.a,{className:r.menuButton,color:"inherit",onClick:function(){return t(Object(l.a)({id:i.id},u))},"aria-label":"Menu"},"Ok")))},Nn=a(951),In=a(468),Pn=a.n(In),An=a(467),Tn=a.n(An),Ln=a(102),_n=Object(W.a)(function(e){return{root:{height:"100%",display:"flex",flexDirection:"column"},swipeAble:{height:"100%"},slideContainer:{flexGrow:1},mobileStepper:{flexGrow:0,background:e.palette.grey[800],color:e.palette.getContrastText(e.palette.grey[800])},slide:{top:0,zIndex:0,opacity:0,position:"absolute",display:"block",overflow:"hidden",width:"100%",height:"100%",minHeight:300},dotActive:{background:"white"},iconButton:{color:"white"},active:{zIndex:5,opacity:1},last:{opacity:1,zIndex:4},tagContainer:{},labelBadge:{color:"white",zIndex:10,position:"absolute",right:e.spacing(2),bottom:e.spacing(1),opacity:.8},tagChip:{marginRight:e.spacing(1),fontSize:10,height:e.spacing(2),padding:e.spacing(.5)},xyTagChip:{position:"absolute",fontSize:e.spacing(1),height:e.spacing(2)},manualBack:{color:"white",zIndex:10,position:"absolute",transform:"translateY(-50%)",left:0,top:"50%"},manualForward:{color:"white",zIndex:10,position:"absolute",transform:"translateY(-50%)",right:0,top:"50%"}}}),zn=function(e){var t=e.onCancel,a=e.photos,r=e.transition,i=_n(),l=Object(pn.a)(),s=Mn(a.length,r),c=s.activeStep,u=s.lastStep,d=s.handleForward,p=s.handleBack,m=s.paused,h=s.pause,g=s.play,b=Object(n.useState)(!1),f=Object(le.a)(b,2),y=f[0],v=f[1],w=Object(n.useRef)(null),x=Object(Ln.a)(w).size,E=x.height,O=x.width;return o.a.createElement("div",{className:i.root},o.a.createElement($.a,null),o.a.createElement("div",{ref:w,className:i.slideContainer},a.map(function(e,n){return o.a.createElement(Nn.a,{key:"slide-".concat(n),className:It()(i.slide,c===n&&i.active,u===n&&i.last),onClick:function(){return v(!y)},style:{height:E,width:O,transition:l.transitions.create(["opacity"],{duration:.25*r})}},o.a.createElement(dn.a,{photo:e,className:i.photo,showTags:y}),o.a.createElement(U.a,{className:i.labelBadge},"Tags: ",y?"On ":"Off ",o.a.createElement(tn.a,{color:"secondary",badgeContent:a[c].tags.filter(function(e){return e.coords}).length},o.a.createElement(nn.a,{color:"inherit"}))),o.a.createElement(en.a,{titlePosition:"top",title:o.a.createElement(U.a,{color:"inherit",variant:"caption"},o.a.createElement(pa.a,{className:i.iconButton,onClick:function(e){return t()}},o.a.createElement(ba.a,null)),Object(Va.d)(e.takenOn)),subtitle:o.a.createElement("em",null,m?"Paused":"    "),actionIcon:m?o.a.createElement(pa.a,{className:i.iconButton,onClick:function(e){e.preventDefault(),e.stopPropagation(),g()}},o.a.createElement(Tn.a,null)):o.a.createElement(pa.a,{className:i.iconButton,onClick:function(e){e.preventDefault(),e.stopPropagation(),h()}},o.a.createElement(Pn.a,null))}))}),o.a.createElement(pa.a,{size:"small",className:i.manualBack,onClick:p,color:"inherit"},"rtl"===l.direction?o.a.createElement(sn.a,null):o.a.createElement(rn.a,null)),o.a.createElement(pa.a,{size:"small",className:i.manualForward,onClick:d,color:"inherit"},"rtl"===l.direction?o.a.createElement(rn.a,null):o.a.createElement(sn.a,null))),o.a.createElement(Ka.a,{steps:a.length,position:"static",activeStep:c,classes:{root:i.mobileStepper,dotActive:i.dotActive},nextButton:o.a.createElement(be.a,{color:"inherit",size:"small",onClick:d,disabled:c===a.length-1},"Next","rtl"===l.direction?o.a.createElement(rn.a,null):o.a.createElement(sn.a,null)),backButton:o.a.createElement(be.a,{color:"inherit",size:"small",onClick:p,disabled:0===c},"rtl"===l.direction?o.a.createElement(sn.a,null):o.a.createElement(rn.a,null),"Back")}))};zn.defaultProps={transition:5e3,isFullScreen:!1,slides:[]};var Rn=zn,Mn=function(e,t){var a=Object(n.useState)(0),o=Object(le.a)(a,2),r=o[0],i=o[1],l=Object(n.useState)(!1),s=Object(le.a)(l,2),c=s[0],u=s[1],d=Object(n.useState)(0),p=Object(le.a)(d,2),m=p[0],h=p[1],g=Object(n.useRef)(),b=function(){g.current=window.setInterval(function(){return i(function(t){return h(t),t+1>=e?0:t+1})},t)},f=function(){g.current&&window.clearInterval(g.current)};return Object(n.useEffect)(function(){return b(),function(){f()}},[]),{activeStep:r,lastStep:m,handleForward:function(){h(r),i(r+1>=e?0:r+1),c||(f(),b())},handleBack:function(){h(r),i(r-1<0?e-1:r-1),c||(f(),b())},setActiveStep:i,paused:c,pause:function(){f(),u(!0)},play:function(){u(!1),f(),b()}}},Dn=a(968),Fn=a(469),Bn=a.n(Fn),Un=a(126),$n=a.n(Un),Wn=Object(W.a)(function(e){return{}}),Gn=function(e){var t=e.title,a=e.message,n=e.onConfirm,r=e.open,i=Wn();return o.a.createElement(En.a,{className:i.root,disableBackdropClick:!0,fullWidth:!0,open:r,disableEscapeKeyDown:!0,maxWidth:"xl","aria-labelledby":"confirmation-dialog-title"},o.a.createElement(On.a,{id:"confirmation-dialog-title"},t),o.a.createElement(xn.a,null,o.a.createElement(U.a,null,a)),o.a.createElement(kn.a,null,o.a.createElement(be.a,{onClick:function(){return n(!1)},color:"primary"},"No"),o.a.createElement(be.a,{onClick:function(){return n(!0)},color:"secondary"},"Yes")))},qn=a(273),Hn=Object(W.a)(function(e){return{root:{height:"90%",width:"85%"},dlgTitleContainer:{display:"flex",padding:0},dlgTitle:{flexGrow:1,paddingTop:e.spacing(2),paddingBottom:e.spacing(1),paddingLeft:e.spacing(3)},field:{marginBottom:e.spacing(2)}}}),Yn="cancel",Vn=function(e){var t=e.canEdit,a=e.photo,r=e.onCancel,i=e.onOk,s=e.open,c=Hn(),u=Object(n.useState)(null),d=Object(le.a)(u,2),p=d[0],m=d[1],h=Object(n.useState)({}),g=Object(le.a)(h,2),b=g[0],f=g[1],y=b&&Object.keys(b).length>0;return o.a.createElement(En.a,{fullScreen:!0,fullWidth:!0,onClose:function(){y?m(Yn):r()},"aria-labelledby":"customized-dialog-title",open:s},o.a.createElement(On.a,{disableTypography:!0,className:c.dlgTitleContainer},o.a.createElement(U.a,{variant:"h5",className:c.dlgTitle},"Photo Properties"),o.a.createElement(pa.a,{onClick:r},o.a.createElement($n.a,null))),o.a.createElement(xn.a,null,o.a.createElement(qn.a,{photo:a,delta:b,onChange:function(e){return f(Object(l.a)({},b,e))},canEdit:t})),o.a.createElement(kn.a,null,!t&&o.a.createElement(be.a,{onClick:r,color:"primary"},"Ok"),t&&!y&&o.a.createElement(be.a,{onClick:r,color:"primary"},"Back"),t&&y&&o.a.createElement(o.a.Fragment,null,o.a.createElement(be.a,{onClick:function(){return m(Yn)},color:"primary"},"Cancel"),o.a.createElement(be.a,{onClick:function(){return f({})},color:"primary"},"Reset"),o.a.createElement(be.a,{onClick:function(){return i(b)},color:"primary"},"Ok"))),p&&p===Yn&&o.a.createElement(Gn,{open:!0,title:"Lose unsaved changes?",message:"You will lose any changes you made to this form",onConfirm:function(e){m(null),e&&r()}}))},Xn=a(235),Qn=Object(W.a)(function(e){return{root:{display:"flex",height:"100%",flexDirection:"column",overflow:"hidden"},appBar:{flexGrow:0},appBarEdit:{color:e.palette.secondary.contrastText,background:e.palette.secondary.main},grow:{flexGrow:1},photoWrapper:{height:"100%"},inner:{flex:"1 1",position:"relative"},tabMenu:{marginTop:e.spacing(7)},tipChip:{position:"absolute",zIndex:11,bottom:20,left:"50%",opacity:.6,transform:"translateX(-50%)"},mobileStepper:{background:"none"},dots:{margin:"0 auto"},dot:{border:"1px solid #FFFFFF77"},dotActive:{background:e.palette.secondary.main},activeButton:{color:e.palette.secondary.main,opacity:1}}}),Jn=0,Zn=1,Kn=2,eo=3,to=4,ao=function(e){var t=e.photos,a=e.initPhotoId,r=e.onMenuBack,i=e.onUpdatePhoto,s=e.newPhoto,c=Qn(),u=Object(pn.a)(),d=Object(n.useContext)(yn.a),p=d.series,m=d.seriesConfig,h=d.ac,g=Object(n.useState)(a?t.findIndex(function(e){return e.id===a}):0),b=Object(le.a)(g,2),f=b[0],y=b[1],v=t[f],w=Object(n.useState)(s?v:{}),x=Object(le.a)(w,2),E=x[0],O=x[1],k=Object(n.useState)({current:s?to:Jn,last:null}),S=Object(le.a)(k,2),j=S[0],C=S[1],N=new Xn.a(m,E.tags||v.tags),I=function(e){C({current:e,last:j.current})},P=function(){I(Kn),i(v,Object(l.a)({id:v.id},E))},A={update:h.canUser("update",p,"series")||h.canUser("update",v,"photo")},T=Object(Ke.a)(t);return T.sort(function(e,t){return parseInt(t.takenOn,10)-parseInt(e.takenOn,10)}),o.a.createElement("div",{className:c.root},o.a.createElement($.a,null)," ",o.a.createElement(da.a,{position:"static",className:It()(c.appBar,j.current!==Jn?c.appBarEdit:null)},o.a.createElement(ye.a,null,j.current!==to&&o.a.createElement(pa.a,{className:c.menuButton,color:"inherit","aria-label":"Menu",onClick:function(){return r()}},o.a.createElement(ba.a,null)),o.a.createElement("div",{className:c.grow},o.a.createElement(U.a,{variant:"subtitle2",color:"inherit"},s?"Add Tags":"Photo View (".concat(f+1,"/").concat(t.length,")")),o.a.createElement(U.a,{variant:"subtitle2",color:"inherit"},Object(Va.d)(v.takenOn,"lll"))),j.current===eo&&o.a.createElement(be.a,{color:"inherit",onClick:function(){I(Kn),O(v)}},"Cancel"),j.current===eo&&o.a.createElement(be.a,{color:"inherit",onClick:P},"Save"),j.current===to&&o.a.createElement(be.a,{color:"inherit",onClick:function(){i(v,Object(l.a)({id:v.id},E)),r()}},"Next"),A.update&&j.current===Kn&&o.a.createElement(be.a,{color:"inherit",onClick:function(){return I(eo)}},"Edit"),j.current!==eo&&j.current!==to&&o.a.createElement(pa.a,{color:"inherit",className:It()(c.tagButton,j.current===Kn&&c.activeButton),onClick:function(){return I(j.current===Kn?Jn:Kn)}},o.a.createElement(tn.a,{className:c.margin,badgeContent:N.getXYTags().length,color:"primary"},o.a.createElement(nn.a,null))),j.current!==eo&&j.current!==to&&o.a.createElement(pa.a,{color:"inherit",className:It()(c.infoButton,j.current===Zn&&c.activeButton),onClick:function(){return I(j.current===Zn?Jn:Zn)}},o.a.createElement(Bn.a,null)))),o.a.createElement("div",{className:c.inner,onClick:function(e){j.current===Jn&&(e.preventDefault(),e.stopPropagation(),I(Zn))}},o.a.createElement(un.a,{axis:"rtl"===u.direction?"x-reverse":"x",index:f,containerStyle:{height:"100%"},style:{height:"100%"},disabled:j.current!==Jn,onChangeIndex:function(e){return y(e)},enableMouseEvents:!0},T.map(function(e,t){return o.a.createElement("div",{className:c.photoWrapper,key:"swipeshowpic-".concat(t)},o.a.createElement(dn.a,{showTags:j.current===Kn,photo:Object(l.a)({},e,E),edit:A.update&&(j.current===eo||j.current===to),onChange:O,onCommitTags:P}))})),j.current===Jn&&o.a.createElement(Ka.a,{steps:T.length,position:"bottom",activeStep:f,classes:{root:c.mobileStepper,dots:c.dots,dot:c.dot,dotActive:c.dotActive}})),o.a.createElement(Vn,{open:j.current===Zn,photo:v,canEdit:A.update,onOk:function(e){i(v,Object(l.a)({id:v.id},e)),I(j.last)},onCancel:function(){return I(j.last)}}),(j.current===eo||j.current===to)&&o.a.createElement(Dn.a,{label:"Tap to tag features...",onClick:function(){},className:c.tipChip}))},no=a(310),oo=a(471),ro=a.n(oo),io=function(){function e(t,a,n){var o=this;Object(te.a)(this,e),this.ownOrAny=function(e){if(!e||!e.createdUser||!e.createdUser.id)throw new Error("No Created user found");try{return e.createdUser.id===o.userSub?"Own":"Any"}catch(t){return"Any"}},this.isOwner=function(e){if(!e||!e.createdUser||!e.createdUser.id)throw new Error("No Created user found");try{return e.createdUser.id===o.userSub}catch(t){return!1}},this.canUser=function(e,t,a,n){if(["series","photo"].indexOf(a)<0)throw new Error("canUser: type not supported ".concat(a));try{var r=o.ownOrAny(t),i=o.ac.can(o.role)["".concat(e).concat(r)](a),l=null;return"series"===a&&("PUBLIC"===t.access?l=o.ac.can(o.role)["".concat(e).concat(r)]("series_public"):"OPEN"===t.access&&(l=o.ac.can(o.role)["".concat(e).concat(r)]("series_open"))),n?l?!!i.attributes.find(function(e){return"*"===e||n.indexOf(e)>-1})||!!l.attributes.find(function(e){return"*"===e||n.indexOf(e)>-1}):!!i.attributes.find(function(e){return"*"===e||n.indexOf(e)>-1}):l?i.granted||l.granted:i.granted}catch(s){return console.error(s),!1}},this.userSub=t,this.role=a,this.permissionObj=n,this.ac=new ro.a(n)}return Object(ae.a)(e,[{key:"toString",value:function(){console.log("AccessHelper:",{sub:this.userSub,role:this.role})}}]),e}(),lo="series",so="editseries",co="newphoto",uo="newseries",po="photoviewer",mo="newphotoviewer",ho="slideshow",go=[lo,po,ho],bo=function(e){var t=e.modeName,a=e.series,r=e.seriesConfig,i=e.inputMethod,s=e.currentUserId,c=e.currentUserRole,u=e.accessControl,d=e.initialPhoto,p=e.onChange,m=e.onClose,h=e.onDelete,g=e.onNewSeries,b=e.onChangePhoto,f=e.onNewPhoto,y=e.onDeletePhoto,v=e.onWatch,w=e.onUnWatch,x=e.watching,E=e.owned,O=Object(n.useState)({series:a,seriesConfig:r,ac:u?new io(s,c,u):null}),k=Object(le.a)(O,2),S=k[0],j=k[1],C=Object(n.useState)({current:{name:t||lo,pid:d,inputMethod:i},history:[]}),N=Object(le.a)(C,2),I=N[0],P=N[1];Object(n.useEffect)(function(){return j(Object(l.a)({},S,{series:a}))},[a]);var A=function(e,t){var a=Object(l.a)({},S.series);a.photos=a.photos.map(function(e){return e.id===t.id?Object(l.a)({},e,t):e}),b(e,Object(l.a)({},t,{seriesId:a.id}))},T=function(){var e=Object(Ft.a)(Dt.a.mark(function e(t){var n,o;return Dt.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.photo,t.series,o=Object(l.a)({},a,{photos:[].concat(Object(Ke.a)(a.photos),[n])}),e.next=4,f(n);case 4:j(Object(l.a)({},S,{series:o})),_(mo,n.id);case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),L=function(){var e=Object(Ft.a)(Dt.a.mark(function e(t){var a,n,o;return Dt.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.photo,n=t.series,console.log("RepeatablePhotos: waiting for series ID",{seriesDelta:n,photoDelta:a}),e.next=4,g(n,a);case 4:o=e.sent,console.log("RepeatablePhotos: waiting for series ID DONE",o);case 6:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),_=function(e,t,n){var o=S.ac.canUser("update",a,"series");null===S&&m(),!o&&go.indexOf(e)<0?console.error("ILLEGAL MODE CHANGE!!!!!",{from:I.current,to:e,canUpdate:o}):P({current:{name:e,pid:t,inputMethod:n},history:[].concat(Object(Ke.a)(I.history),[I.current])})},z=function(){if(I.history.length>0){var e=Object(Ke.a)(I.history),t=e.pop();P({current:t,history:e})}else m()},R=null;switch(I.current.name){case lo:R=o.a.createElement(wn,{onSlideshowStart:function(){return _(ho)},onChange:function(){console.log("onChange NOT IMPLEMENTED")},watching:x,owned:E,initialPhoto:d,onDeletePhotos:function(e){a.photos.filter(function(t){return e.indexOf(t.id)>-1}).forEach(function(e){return y(e)})},onDeleteSeries:h,onCameraAdd:function(){return _(co,null,"camera")},onEditSeries:function(){return _(so)},onLibraryAdd:function(){return _(co,null,"library")},onTileClick:function(e){_(po,e)},onMenuBack:m,onWatch:v,onUnWatch:w});break;case so:R=o.a.createElement(Cn,{onCancel:function(){return _(lo)},onOk:function(e){p(a,Object(l.a)({},e,{id:a.id})),_(lo)}});break;case po:R=o.a.createElement(ao,{photos:S.series.photos,initPhotoId:I.current.pid,onMenuBack:z,onUpdatePhoto:A});break;case mo:R=o.a.createElement(ao,{photos:S.series.photos,initPhotoId:I.current.pid,newPhoto:!0,onMenuBack:function(){return _(lo)},onUpdatePhoto:A});break;case ho:R=o.a.createElement(Rn,{photos:S.series.photos,onCancel:z});break;case co:R=o.a.createElement(no.a,{inputMethod:I.current.inputMethod,photos:a?a.photos:null,onCreate:T,onCancel:z});break;case uo:R=o.a.createElement(no.a,{inputMethod:I.current.inputMethod,isNewSeries:!0,onCreate:L,onCancel:z});break;default:console.log("REPEATABLEPHOTO: default state. you should NEVER see this",S),R=null}return o.a.createElement(yn.a.Provider,{value:S},R)};bo.defaultProps={mode:lo};var fo=bo,yo=a(472),vo=a(74),wo=a.n(vo),xo=(Object(yo.openDb)("serieslistDB",1,function(e){console.log("UPGRADE NEEDED",e);var t=e.createObjectStore(Q.f.imgStore);console.log("UPGRADE NEEDED STORE",t)}).catch(function(e){console.error("ERROR",e)}),function(e){return"__LOCAL_".concat(e,"::").concat(wo()())});var Eo=Object(s.d)(F,{props:function(e){var t=e.data;t.error&&console.error(t.error);var a=null;try{t.loading||t.error||(a=t.series)}catch(n){console.error(t),console.error(n)}return{data:t,loading:t.loading,series:a}},skip:function(e){var t=e.activeSeries,a=e.isNewSeries;return!t||a},options:function(e){return{variables:{id:e.activeSeries}}}}),Oo=Object(s.d)(ra,{props:function(e){var t=e.mutate,a=e.ownProps;return{updateSeriesMutation:function(e,n){return t({variables:{series:Lo(n,["id","name","access","note","latitude","longitude","direction"])},optimisticResponse:{updateSeries:Object(l.a)({},e,n,{__typename:"Series"})},update:function(e,t){t.data;var o=e.readQuery({query:F,variables:{id:a.activeSeries}});o.series=Object(l.a)({},o.series,n),e.writeQuery({query:F,data:o});try{var r=e.readQuery({query:N,variables:{limit:100}}),i=Lo(n,["id","name","access","latitude","longitude","direction"]);r.allSeries.seriesSummaries=r.allSeries.seriesSummaries.map(function(e){return e.id!==i.id?e:Object(l.a)({},e,i)}),e.writeQuery({query:N,data:r})}catch(s){}}})}}}}),ko=Object(s.d)(ia,{props:function(e){var t=e.mutate,a=e.ownProps;return{updatePhotoMutation:function(e,n){var o=Lo(n,["id","seriesId","takenOn","tags","note"]);return o.tags&&o.tags.length>0&&(o.tags=o.tags.map(function(e){var t=Lo(e,["label","typeId","coords"]);return t.coords&&(t.coords=Lo(t.coords,["x","y"])),t})),t({variables:{photo:o},optimisticResponse:{updatePhoto:Object(l.a)({},e,o,{__typename:"Photo"})},update:function(e,t){t.data;var r=e.readQuery({query:F,variables:{id:a.activeSeries}}),i=Object(l.a)({},o,{tags:o.tags?o.tags.map(function(e){var t=Object(l.a)({},e,{__typename:"Tag"});return t.coords=t.coords?Object(l.a)({},t.coords,{__typename:"ImageCoords"}):null,t}):[]});r.series.photos=r.series.photos.map(function(e){return e.id!==n.id?e:Object(l.a)({},e,i)}),e.writeQuery({query:F,data:r})}})}}}}),So=Object(s.d)(oa,{props:function(e){var t=e.mutate,a=e.ownProps;return{deleteSeriesMutation:function(){return t({variables:{id:a.activeSeries},optimisticResponse:{deleteSeries:a.activeSeries},update:function(e,t){var a=t.data;try{var n=e.readQuery({query:N,variables:{limit:100}});n.allSeries.seriesSummaries=n.allSeries.seriesSummaries.filter(function(e){return e.id!==a.deleteSeries}),e.writeQuery({query:N,data:n})}catch(o){}}})}}}}),jo=Object(s.d)(na,{props:function(e){var t=e.mutate,a=e.ownProps;return{deletePhotoMutation:function(e){return t({variables:{seriesId:a.series.id,photoId:e},optimisticResponse:{deletePhoto:e},update:function(e,t){var n=t.data;console.log("deletePhotoMutation start Manip:",JSON.stringify(n,null,2));var o,r=e.readQuery({query:F,variables:{id:a.activeSeries}});r.series.photos=r.series.photos.filter(function(e){return e.id!==n.deletePhoto}),o=r.series.photos.length,r.series.photoCount=o,e.writeQuery({query:F,data:r}),console.log("deletePhotoMutation start Manip WRITE:",r);try{var i=e.readQuery({query:N,variables:{limit:100}});console.log("deletePhotoMutation qdataAll:",i),i.allSeries.seriesSummaries=i.allSeries.seriesSummaries.map(function(e){return e.id!==n.deletePhoto?e:Object(l.a)({},e,{photoCount:null!==o?o:e.photoCount})}),e.writeQuery({query:N,data:i}),console.log("deletePhotoMutation qdataAll WRITE:",i)}catch(s){}console.log("Done Manip:",r.series.photos)}})}}}}),Co=Object(s.d)(sa,{props:function(e){var t=e.mutate;e.ownProps;return{createSeriesMutation:function(e){return t({variables:{series:Lo(e,["name","note","latitude","longitude","direction","meta"])},optimisticResponse:{createSeries:{id:xo("SERIES"),name:e.name||null,note:e.note||null,meta:e.meta||{},featured:e.featured||null,coords:e.coords||null,direction:e.direction||null,photoCount:0,photos:[],__typename:"Series"}},update:function(e,t){var a=t.data;console.log("STARTING TO CREATE THE SERIES",a,e);try{e.writeQuery({query:F,data:{series:a.createSeries}}),console.log("Series write getWholeSeries",{series:a.createSeries})}catch(r){console.error(r)}try{var n=e.readQuery({query:N,variables:{limit:100}}),o=Lo(a.createSeries,["id","name","updatedOn","featured","longitude","latitude","photoCount","seriesStatus","direction"]);n.allSeries.seriesSummaries.push(o),e.writeQuery({query:N,data:n})}catch(r){console.error("createSeriesMutation allSeries error"),console.error(r)}}})}}}}),No=Object(s.d)(la,{props:function(e){var t=e.mutate,a=e.ownProps;return{createPhotoMutation:function(e,n){e.base64;var o=Object(he.a)(e,["base64"]);return!o.seriesId&&a.activeSeries&&(o.seriesId=a.activeSeries),t({variables:{photo:Lo(o,["seriesId","takenOn","meta","tags","note"]),ext:n},optimisticResponse:{createPhoto:{photo:{id:xo("PHOTO"),meta:o.meta,seriesId:o.seriesId,createdOn:Date.now().toString(),createdUser:{id:a.authData.attributes.sub,username:a.authData.Username},updatedBy:a.authData.attributes.sub,updatedOn:Date.now().toString(),takenOn:o.takenOn,tags:o.tags||[],paths:{large:null,orig:null,thumb:null,medium:null,__typename:"Paths"},__typename:"Photo"},preAuth:null,__typename:"NewPhotoOutput"}},update:function(e,t){var n=t.data;console.log("createPhotoMutation store.readQuery:",{data:n,store:e,ownProps:a});try{var o=e.readQuery({query:F,variables:{id:n.createPhoto.seriesId}});o.series.photos=o.series.photos=[].concat(Object(Ke.a)(o.series.photos),[n.createPhoto]),e.writeQuery({query:F,data:o})}catch(i){}var r=null;try{r=e.readQuery({query:N,variables:{limit:100}}),console.log("createPhotoMutation qdataAll:",r),r.allSeries.seriesSummaries=r.allSeries.seriesSummaries.map(function(e){return e.id!==n.createPhoto.photo.seriesId?e:Object(l.a)({},e,{photoCount:e.photoCount+1})}),e.writeQuery({query:N,data:r}),console.log("createPhotoMutation qdataAll: WRITE",r)}catch(i){console.error("createPhotoMutation allSeries ERROR"),console.error(i)}}})}}}}),Io=Object(s.d)(ca,{props:function(e){var t=e.mutate,a=e.ownProps;return{watchSeriesMutation:function(){return t({variables:{id:a.activeSeries},optimisticResponse:{watchSeries:a.activeSeries},update:function(e,t){t.data}})}}}}),Po=Object(s.d)(ua,{props:function(e){var t=e.mutate,a=e.ownProps;return{unWatchSeriesMutation:function(){return t({variables:{id:a.activeSeries},optimisticResponse:{unWatchSeries:a.activeSeries},update:function(e,t){t.data}})}}}}),Ao=Object(s.c)(Eo,Co,No,Oo,ko,So,jo,Io,Po)(function(e){var t=e.series,a=e.loading,r=e.domain,i=e.activeSeries,s=e.initialPhoto,c=e.onAfterSeriesDelete,u=e.onBack,d=e.queueUpload,p=e.doneCreatingSeries,m=e.createSeriesMutation,h=e.createPhotoMutation,g=e.updateSeriesMutation,b=e.updatePhotoMutation,f=e.deleteSeriesMutation,y=e.deletePhotoMutation,v=e.watchSeriesMutation,w=e.unWatchSeriesMutation,x=Object(n.useContext)(B),E=x.role,O=x.currentUser,k=x.seriesConfig,S=x.user,j=x.signedIn,C="camera";if(r===Q.e.AppStateTypes.SERIES){if(!t&&!a)return"No series...";if(a)return"Loading..."}else r===Q.e.AppStateTypes.NEW_SERIES_CAMERA?C="camera":r===Q.e.AppStateTypes.NEW_SERIES_LIBRARY&&(C="library");var N=lo;return r!==Q.e.AppStateTypes.SERIES&&(N=uo),o.a.createElement(fo,{modeName:N,inputMethod:C,owned:j&&S&&t&&S.id===t.id,watching:j&&S&&S.watching&&S.watching.indexOf(i)>-1,currentUserId:O.attributes.sub,currentUserRole:E,accessControl:Vt,series:t,initialPhoto:s,seriesConfig:k,onNewPhoto:function(e){var t=e.base64,a=Object(he.a)(e,["base64"]);console.log("onNewPhoto",Object(l.a)({base64:t},a));var n=t.split(";")[0].split("/")[1];return h(a,n).then(function(e){var n=e.data;if(n.createPhoto.preAuth){var o=JSON.parse(n.createPhoto.preAuth);console.log("PREAUTH",n.createPhoto.preAuth),d({id:a.id,seriesId:n.createPhoto.seriesId,base64:t,preAuth:o})}return n}).catch(function(e){console.log("onNewPhoto Graphql Error",e.stack),console.error(e)})},onChangePhoto:function(e,t){return b(e,t).catch(function(e){console.log("onChangePhoto Graphql Error",e.stack),console.error(e)})},onDeletePhoto:function(e){return y(e.id).then(function(){for(var e=arguments.length,t=new Array(e),a=0;a<e;a++)t[a]=arguments[a];console.log("photo deleted",t)}).catch(function(e){console.log("onDeletePhoto Graphql Error",e.stack),console.error(e)})},onChange:function(e,t){return g(e,t).catch(function(e){console.log("onChange Graphql Error",e.stack),console.error(e)})},onNewSeries:function(e,t){return console.log("Series.connect: onNewSeries starting",e),m(e).then(function(){var e=Object(Ft.a)(Dt.a.mark(function e(a){var n,o,r,i,s,c,u;return Dt.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.data,o=t.base64,r=Object(he.a)(t,["base64"]),i=o.split(";")[0].split("/")[1],console.log("Series.connect: done createSeriesMutation",n),e.next=6,h(Object(l.a)({},t,{seriesId:n.createSeries.id}),i);case 6:return s=e.sent,c=s.data,u=JSON.parse(c.createPhoto.preAuth),console.log("PREAUTH",c.createPhoto.preAuth),d({id:r.id,seriesId:c.createPhoto.seriesId,base64:o,preAuth:u}),p(n.createSeries.id),e.abrupt("return",n);case 13:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()).catch(function(e){console.log("onNewSeries Graphql Error",e.stack),console.error(e)})},onDelete:function(){return f().then(c).catch(function(e){console.log("onDelete Graphql Error",e.stack),console.error(e)})},onClose:u,onWatch:j?v:null,onUnWatch:j?w:null})}),To=Object(Qe.b)(function(e,t){var a=e.home.current;return{activeSeries:a.activeSeries,initialPhoto:a.initialPhoto,domain:a.domain}},function(e){return{onBack:function(){e(ut())},onAfterSeriesDelete:function(t,a){e(dt(null)),e(ut())},queueUpload:function(t){e(gt(t))},doneCreatingSeries:function(t){e(dt(t)),e(ct(Q.e.AppStateTypes.SERIES))}}})(Ao);function Lo(e,t){var a=[].concat(Object(Ke.a)(t),["__typename"]),n=Object.keys(e).filter(function(e){return a.indexOf(e)>-1});return console.log("sanitizeUpdateParams",{orig:Object.keys(e),remainder:n}),n.reduce(function(t,a){return Object(l.a)({},t,Object(Yt.a)({},a,e[a]))},{})}var _o=a(81),zo=a(246),Ro=a(242),Mo=a(274),Do=a(880),Fo=a(473),Bo=a.n(Fo),Uo=a(214),$o=function(e,t,a,o,r,i){var l=Object(n.useState)([]),s=Object(le.a)(l,2),c=s[0],u=s[1],d=Object(n.useState)({single:[],cluster:[]}),p=Object(le.a)(d,2),m=p[0],h=p[1],g=Object(n.useState)(0),b=Object(le.a)(g,2),f=b[0],y=b[1],v=Object(n.useCallback)(Object(He.a)(Object(Ft.a)(Dt.a.mark(function e(){var t,a=arguments;return Dt.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Wo.apply(void 0,a);case 2:t=e.sent,u(t),y(f+1);case 5:case"end":return e.stop()}},e)})),1e3),[]),w=Object(n.useCallback)(Object(He.a)(Object(Ft.a)(Dt.a.mark(function e(){var t,a=arguments;return Dt.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Go.apply(void 0,a);case 2:t=e.sent,h(t);case 4:case"end":return e.stop()}},e)})),300),[]);return Object(n.useEffect)(function(){v(e,r,o)},[e.length,i]),Object(n.useEffect)(function(){w(c,t,a)},[c,a,t,f]),{filteredClusteredData:m}},Wo=function(e,t,a){if(!e)return[];var n=Bo()(9,[".x",".y",".x",".y"]),o=new Do.a(Object(l.a)({},a,{zoom:0})),r=e.map(function(e){var t=[0,0];try{t=o.project(e.coords)}catch(n){console.error(n)}e.longitude,e.latitude;var a=Object(he.a)(e,["longitude","latitude"]);return{x:t[0],y:t[1],photoCount:a.photoCount,zoomLevels:[],geoJSON:e.coords?Object(Uo.point)(e.coords,Object(l.a)({},a)):null}});n.clear(),n.load(r);for(var i=function(e){var a=t/Math.sqrt(2)/Math.pow(2,e);r.forEach(function(t){if(void 0===t.zoomLevels[e]){var o=t.x,r=t.y,i=n.search({minX:o-a,minY:r-a,maxX:o+a,maxY:r+a}).filter(function(t){return void 0===t.zoomLevels[e]});i.forEach(function(a){if(a===t){var n=1===i.length?t.geoJSON:Object(Uo.centroid)(Object(Uo.featureCollection)(i.map(function(e){return e.geoJSON})));n.properties=Object(l.a)({},n.properties,{id:n.properties.id||wo()(),count:i.length,reducedPhotoCount:i.reduce(function(e,t){var a=t.photoCount;return a?e+a:e},0),points:i.map(function(e){return e.geoJSON})}),t.zoomLevels[e]=n}else a.zoomLevels[e]=null})}})},s=0;s<=20;s++)i(s);return r.map(function(e){return e.zoomLevels})};function Go(e,t,a){return e.filter(function(e){return!!e[a]}).reduce(function(e,n){var o=n[a],r=o.geometry.coordinates,i=o.properties.count;return(!t||t.length<4||t[0]<r[0]&&t[1]<r[1]&&t[2]>r[0]&&t[3]>r[1])&&(i>1?e.cluster.push(o):e.single.push(o)),e},{single:[],cluster:[]})}var qo=a(442),Ho=a(474),Yo=a.n(Ho),Vo=a(34),Xo=a.n(Vo)()(o.a.createElement(o.a.Fragment,null,o.a.createElement("path",{d:"M 5.4 0 L 18.6 0 C 21.58 0 24 2.42 24 5.4 L 24 18.6 C 24 21.58 21.58 24 18.6 24 L 5.4 24 C 2.42 24 0 21.58 0 18.6 L 0 5.4 C 0 2.42 2.42 0 5.4 0 Z",style:{fill:"none",stroke:"#000000",strokeWidth:2,strokeLinecap:"square",strokeDasharray:"0.1,3",strokeMiterlimit:5}}),o.a.createElement("path",{d:" M 12 1.333 L 15.135 7.685 L 22.145 8.704 L 17.072 13.648 L 18.27 20.63 L 12 17.333 L 5.73 20.63 L 6.928 13.648 L 1.855 8.704 L 8.865 7.685 L 12 1.333 Z ",fill:"rgb(235,235,235)",vectorEffect:"non-scaling-stroke",strokeWidth:"1",stroke:"rgb(0,0,0)",strokeLinejoin:"miter",strokeLinecap:"square",strokeMiterlimit:"3"})),"AppLogo"),Qo=a(476),Jo=a.n(Qo),Zo=a(475),Ko=a.n(Zo),er=Object(W.a)(function(e){return{root:{padding:"2px 4px",display:"flex",alignItems:"center",width:"100%",background:e.palette.primary.main,color:e.palette.primary.contrastText},searchIcon:{opacity:.3,marginRight:e.spacing(1)},transparent:{background:"none",color:e.palette.text.primary},input:{background:"#FFFFFF",border:"1px solid #AAAAAA",borderRadius:2*e.spacing(1),paddingLeft:e.spacing(1),marginLeft:0,flex:1},children:{flexGrow:1},iconButton:{padding:10},divider:{width:1,height:28,margin:4}}}),tr=function(e){var t=e.className,a=e.children,r=e.isTransparent,i=e.menuItems,l=er(),s=Object(n.useState)(!1),c=Object(le.a)(s,2),u=c[0],d=c[1],p=Object(n.useContext)(B),m=p.signOut,h=p.signedIn,g=p.forceSignIn;return o.a.createElement(ye.a,{className:It()(l.root,t,r?l.transparent:null),disableGutters:!0},o.a.createElement(pa.a,{className:l.iconButton},o.a.createElement(Xo,null)),o.a.createElement("div",{className:l.children},a),h&&o.a.createElement(pa.a,{color:"inherit",className:l.iconButton,"aria-label":"Menu",onClick:function(){return d(!u)}},o.a.createElement(Yo.a,{color:"inherit"})),!h&&o.a.createElement(pa.a,{color:"primary",className:l.iconButton,"aria-label":"Menu",onClick:g},o.a.createElement(Ko.a,{color:"primary"})),o.a.createElement(qo.a,{anchor:"top",open:u,onClose:function(){return d(!1)}},o.a.createElement("div",{tabIndex:0,role:"button",onClick:function(){return d(!1)},onKeyDown:function(){return d(!1)}},o.a.createElement("div",{className:l.fullList},o.a.createElement($a.a,null,i&&i.map(function(e,t){var a=e.callback,n=e.text,r=e.icon,i=e.color;return o.a.createElement(Wa.a,{button:!0,key:"top-menu-item-".concat(t),onClick:a},r&&o.a.createElement(Da.a,{color:i},r),o.a.createElement(Fa.a,{primary:n,color:i}))})),i&&o.a.createElement(Ba.a,null),o.a.createElement($a.a,null,h&&o.a.createElement(Wa.a,{button:!0,onClick:m},o.a.createElement(Da.a,null,o.a.createElement(Jo.a,null)),o.a.createElement(Fa.a,{primary:"Sign Out"})))))))},ar=a(314),nr=a(966),or=a(477),rr=a.n(or),ir=Object(W.a)(function(e){return{root:Object(Yt.a)({position:"relative",borderRadius:e.shape.borderRadius,backgroundColor:Object(ar.fade)(e.palette.common.white,.3),"&:hover":{backgroundColor:Object(ar.fade)(e.palette.common.white,.5)},marginRight:e.spacing(2),marginLeft:0,width:"100%"},e.breakpoints.up("sm"),{marginLeft:e.spacing(3),width:"auto"}),inputRoot:{color:"inherit"},inputInput:Object(Yt.a)({padding:e.spacing(1,1,1,7),transition:e.transitions.create("width"),width:"100%"},e.breakpoints.up("md"),{width:200}),searchIcon:{width:e.spacing(7),height:"100%",position:"absolute",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"}}}),lr=function(e){var t=e.autoFocus,a=e.disabled,r=e.onChange,i=e.onClick,l=e.defaultValue,s=Object(n.useRef)(),c=ir(),u=Object(n.useCallback)(Object(He.a)(r,500),[r]);return Object(n.useLayoutEffect)(function(){s.current},[]),o.a.createElement("div",{className:c.root,onClick:i},o.a.createElement("div",{className:c.searchIcon},o.a.createElement(rr.a,null)),o.a.createElement(nr.a,{autoFocus:!a&&t,inputProps:{onBlur:function(){}},onChange:function(e){u(e.target.value)},placeholder:"Search\u2026",disabled:a,defaultValue:l,inputRef:s,classes:{root:c.inputRoot,input:c.inputInput}}))},sr=Object(W.a)(function(e){return{root:{height:e.spacing(2),marginRight:e.spacing(1)},label:{padding:e.spacing(0,1,0,1),borderRadius:e.spacing(.5)}}}),cr=function(e){var t=sr();return o.a.createElement(Dn.a,Object.assign({},e,{classes:{root:It()(t.root,e.className),label:t.label}}))},ur=Object(W.a)(function(e){return{root:{margin:0,padding:e.spacing(1)},chipContainer:{display:"flex",width:"100%"},grow:{flexGrow:1},accessPUBLIC:{color:"white",background:Q.a.PUBLIC.color},accessPRIVATE:{color:"white",background:Q.a.PRIVATE.color},accessOPEN:{color:"white",background:Q.a.OPEN.color},img:{objectFit:"cover",height:"100%",width:"100%"},text:{margin:0,padding:e.spacing(0,1),alignSelf:"flex-start"},titleText:{textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"},dateContainer:{display:"flex"},dateLabel:{fontWeight:"bold",flex:"1 1 50px"},dateText:{},imgContainer:{flex:"0 0 25%",alignSelf:"flex-start",height:"100%"}}}),dr=function(e){var t=e.series,a=e.loading,r=e.onClick,i=e.children,l=e.showCreatedOn,s=e.showLastPhoto,c=ur(),u=Object(n.useContext)(B).seriesConfig;if(a||!t)return"LOADING...";var d=null,p=Q.a.PRIVATE.label;try{d=u.getPhotoUrl(t.featured,"thumb"),p=t.access?Q.a[t.access].label:Q.a.PRIVATE.label}catch(m){console.error(m)}return o.a.createElement(Wa.a,{className:c.root,button:!0,component:"div",disableGutters:!0},o.a.createElement("div",{className:c.imgContainer},o.a.createElement("img",{alt:"thumbnail",src:d,className:c.img,onClick:r})),o.a.createElement(Fa.a,{className:c.text,disableTypography:!0,onClick:r},o.a.createElement(U.a,{variant:"body1",component:"div",className:c.titleText},t.name||a),o.a.createElement(U.a,{variant:"body2",component:"div"},t.access&&o.a.createElement(cr,{label:p,className:c["access".concat(t.access)]}),"Series ",o.a.createElement("strong",null,"by:")," ",t.createdUser.username),o.a.createElement(U.a,{variant:"caption",component:"div"},"".concat(t.photoCount||0," Photos")),l&&o.a.createElement("div",{className:c.dateContainer},o.a.createElement(U.a,{variant:"caption",className:c.dateLabel},"Created:"),o.a.createElement(U.a,{variant:"caption",className:c.dateText},Object(Va.d)(t.createdOn,"llll"))),s&&o.a.createElement("div",{className:c.dateContainer},o.a.createElement(U.a,{variant:"caption",className:c.dateLabel},"Last Photo:"),o.a.createElement(U.a,{variant:"caption",className:c.dateText},Object(Va.d)(t.latest.takenOn,"llll")))),i)},pr=dr,mr=a(478),hr=a.n(mr),gr=Object(W.a)(function(e){return{root:{}}}),br=function(e){var t=e.seriesCount,a=e.reducedPhotoCount,n=e.onZoomTo,r=(e.onClose,gr());return console.log("cluster selected",{seriesCount:t,reducedPhotoCount:a}),o.a.createElement($a.a,null,o.a.createElement(Wa.a,{className:r.root},o.a.createElement(Da.a,{onClick:n},o.a.createElement(hr.a,null)),o.a.createElement(Fa.a,{onClick:n,primary:"".concat(t," Photo series"),secondary:"containing ".concat(a," individual photo").concat(1===a?"":"s")})))},fr=a(458),yr=a(268),vr=a.n(yr),wr=Object(W.a)(function(e){return{root:{color:e.palette.primary.main,width:150,position:"absolute",top:"50%",left:"50%",textAlign:"center",transformOrigin:"50% 50%",transform:"translateY(-50%) translateX(-50%)"},rootActive:{zIndex:1e3},icon:{},avatar:{position:"relative",margin:"0 auto",background:"green",color:"white",border:"2px solid white",height:40,width:40,zIndex:120,"&.PUBLIC":{background:Q.a.PUBLIC.color},"&.PRIVATE":{background:Q.a.PRIVATE.color},"&.OPEN":{background:Q.a.OPEN.color}},avatarActive:{background:"#FFFF00",color:"black",border:"2px solid black","&.PUBLIC":{background:"#FFFF00"},"&.PRIVATE":{background:"#FFFF00"},"&.OPEN":{background:"#FFFF00"}},badge:{zIndex:124,color:e.palette.secondary.contrastText,background:e.palette.secondary.main,transform:"scale(1) translate(30%, -30%)"},badgeActive:{color:e.palette.primary.contrastText,background:e.palette.primary.main},directionIndicator:{position:"absolute",top:20,left:"50%",zIndex:100},name:{color:"white",fontWeight:"bold",textShadow:"\n        0px 0px 4px #000000, \n        0px 0px 4px #000000 \n    ",zIndex:122,position:"relative"},nameActive:{color:"black",textShadow:"\n    0px 0px 2px #FFFFFF, \n    0px 0px 2px #FFFFFF,\n    0px 0px 4px #FFFFFF \n"}}}),xr=function(e){var t=e.name,a=e.access,n=e.onClick,r=e.active,i=e.photoCount,l=e.direction,s=wr();return o.a.createElement("div",{className:It()(s.root,r?s.rootActive:null,a)},o.a.createElement(tn.a,{classes:{badge:It()(s.badge,r?s.badgeActive:null,a)},badgeContent:i},o.a.createElement(fr.a,{className:It()(s.avatar,r?s.avatarActive:null,a),onClick:n},o.a.createElement(vr.a,{className:s.icon,color:"inherit"}))),l&&l>=0?o.a.createElement("div",{className:s.directionIndicator},o.a.createElement("svg",{className:s.svgArc,version:"1.1",width:"100",height:"100",viewBox:"0, 0, 100, 100",style:{transform:"translateY(-50%) translateX(-50%) rotateZ(".concat(l,"deg)")}},o.a.createElement("path",{d:"M50,0 C60.946,0.151 72.136,3.514 80.675,10.56 L50,50 L19.325,10.56 C27.938,3.461 39,0.278 50,0 z",fill:"#009DC1",fillOpacity:"0.444",strokeWidth:"1",strokeOpacity:"0.6",stroke:"#FFFFFF"}))):null,o.a.createElement(U.a,{variant:"body1",className:It()(s.name,r?s.nameActive:null)},t))},Er=a(255),Or=a.n(Er),kr=Object(W.a)(function(e){return{avatar:{background:e.palette.primary.dark,border:"2px solid ".concat(e.palette.primary.contrastText),color:e.palette.primary.contrastText},avatarActive:{background:"#FFFF00",border:"2px solid black",color:"black",zIndex:1e3}}}),Sr=function(e){var t=e.seriesCount,a=e.active,n=e.onClick,r=kr();return o.a.createElement(fr.a,{onClick:n,className:It()(r.avatar,a?r.avatarActive:null)},Or()(t).format("0,0"))},jr=Object(W.a)(function(e){return{root:{position:"relative",height:"100%","& .myPosMarker":{zIndex:1},"& .singleMarker":{zIndex:3},"& .clusterMarker":{zIndex:2}},fab:{background:e.palette.secondary.main,color:e.palette.secondary.contrastText},topBar:{position:"absolute",zIndex:1e3,top:0},zoomOutFab:{margin:e.spacing(.5),padding:e.spacing(.5),border:"2px solid",borderRadius:e.spacing(1),background:e.palette.common.white,fontSize:20,position:"absolute",zIndex:100,bottom:e.spacing(2),right:e.spacing(10)},selectedPopup:{padding:e.spacing(0,1,0,1),width:"90%",maxWidth:400,zIndex:2e3,position:"absolute",bottom:e.spacing(1),left:"50%",transformOrigin:"0% 50%",transform:"translateY(0%) translateX(-50%)"}}}),Cr={zoom:4,latitude:44.629701,longitude:-120.333379},Nr=function(e){var t=e.seriesList,a=e.initViewport,r=e.loading,i=e.activeSeries,s=e.queryVersion,c=e.setActiveSeries,u=e.onSeriesClick,d=e.onSearchClick,p=(e.popMapHistory,e.pushMapHistory),m=(e.clearMapHistory,Object(n.useState)({viewport:Object(l.a)({},Cr,a.viewport),bounds:a.bounds,filterBounds:null})),h=Object(le.a)(m,2),g=h[0],b=h[1],f=jr(),y=Object(n.useRef)(),v=Object(n.useState)(!1),w=Object(le.a)(v,2),x=w[0],E=w[1],O=Object(n.useRef)(),k=Object(n.useState)(0),S=Object(le.a)(k,2),j=S[0],C=S[1],N=Object(n.useState)(null),I=Object(le.a)(N,2),P=I[0],A=I[1],T=Object(n.useState)(),L=Object(le.a)(T,2),_=L[0],z=L[1],R=$o(t||[],g.filterBounds,j,g.viewport,80,s).filteredClusteredData;Object(n.useEffect)(function(){if(i&&t&&!_)try{var e=t.find(function(e){return e.id===i});if(e&&e.coords){var a=Object(Uo.buffer)(Object(Uo.point)(e.coords),10,{units:"meters"}),n=Object(Uo.bbox)(a);console.log("DEBUG",{bufferPts:a,bounds:n}),b(Object(l.a)({},g,{bounds:n}))}}catch(o){console.error(o)}},[t]),Object(n.useEffect)(function(){if(i&&R.single&&!_)try{var e=R.single.find(function(e){return e.properties.id===i});e&&O.current&&z(e)}catch(t){console.error(t)}},[R.single]);var M=Object(n.useCallback)(Object(He.a)(function(){var e=y.current?y.current:g.viewport,t=e.latitude,n=e.longitude,o=e.zoom,r=e.bearing,i=e.pitch,s=e.altitude;setTimeout(function(){return p(Object(l.a)({},a,{viewport:{latitude:t,longitude:n,zoom:o,bearing:r,pitch:i,altitude:s}}))},2e3)},2e3,!0)),D=function(e){z(e),e&&e.properties&&1===e.properties.count&&c(e.properties.id),M()},F=function(e){try{var t=Object(Uo.featureCollection)(e.properties.points),a=Object(Uo.buffer)(t,1e3,{units:"meters"}),n=Object(Uo.bbox)(a),o=.2*(n[2]-n[0]),r=.2*(n[3]-n[1]),i=[n[0]-o,n[1]-r,n[2]+o,n[3]+r];A({transitionDuration:2e3,transitionInterpolator:new _o.a,transitionEasing:zo.a}),b(Object(l.a)({},g,{bounds:i})),e.properties.count>1&&setTimeout(function(){return D(null)},2e3)}catch(s){console.error(s)}},B=function(e){_&&_.properties.id===e.properties.id?F(_):(A({transitionDuration:500,transitionInterpolator:new _o.b,transitionEasing:zo.a}),b({viewport:{longitude:e.geometry.coordinates[0],latitude:e.geometry.coordinates[1]}})),D(e)},U=Object(n.useMemo)(function(){return[].concat(Object(Ke.a)(R.single.map(function(e){return o.a.createElement(_o.c,{className:"singleMarker",key:"single-".concat(e.properties.id),latitude:e.geometry.coordinates[1],longitude:e.geometry.coordinates[0],offsetLeft:0,offsetTop:-20},o.a.createElement(xr,{name:e.properties.name,access:e.properties.access,photoCount:e.properties.photoCount,onClick:function(){return B(e)},direction:j>10&&e.properties.direction?e.properties.direction:null,active:_&&_.properties.id===e.properties.id}))})),Object(Ke.a)(R.cluster.map(function(e){return o.a.createElement(_o.c,{className:"clusterMarker",key:"cluster-".concat(e.properties.id),latitude:e.geometry.coordinates[1],longitude:e.geometry.coordinates[0],offsetLeft:-20,offsetTop:-20},o.a.createElement(Sr,{seriesCount:e.properties.count,photoCount:e.properties.reducedPhotoCount,onClick:function(){return B(e)},active:_&&_.properties.id===e.properties.id&&_.properties.count===e.properties.count}))})))},[R,_]),$=Object(n.useMemo)(function(){return!!_&&o.a.createElement(Pt.a,{className:f.selectedPopup},1===_.properties.count?o.a.createElement(pr,{loading:r.selectedSeries,series:_.properties,onClick:function(){return u(_.properties.id)}}):o.a.createElement(br,{seriesCount:_.properties.count,reducedPhotoCount:_.properties.reducedPhotoCount,onClose:function(){return D(null)},onZoomTo:function(){return F(_)}}))},[_]);return o.a.createElement("div",{className:f.root,ref:O},o.a.createElement(tr,{isTransparent:!0,className:f.topBar},o.a.createElement(lr,{onClick:d,defaultValue:""})),o.a.createElement(Mo.a,Object.assign({showMe:!0,viewport:g.viewport,transitions:P,mapStyles:Ro.a,controlPadding:{top:56},initStyle:Ro.a.length>1?1:0},{},{onTransitionStart:function(){E(!0)},onTransitionEnd:function(){E(!1),A(null)},bounds:g.bounds,maxZoom:20,minZoom:1,onViewportChange:function(e){var t=e.viewport,a=e.map;y.current=t;var n=Math.floor(t.zoom);if(!x&&a&&a.getBounds){var o=a.getBounds(),r=o._sw,i=r.lng,s=r.lat,c=o._ne,u=c.lng,d=c.lat,p=g.filterBounds||[i,s,u,d],m=Object(le.a)(p,4),h=m[0],f=m[1],v=m[2],w=m[3];if(n!==j||h>=i||f>=s||v<=u||w<=d){var E=[i-(u-i)/2,s-(d-s)/2,u+(u-i)/2,d+(d-s)/2];b(Object(l.a)({},g,{filterBounds:E}))}}n!==j&&C(n)},onNativeClick:function(){_&&D(null)}}),U),$)},Ir=5,Pr=Object(s.d)(N,{props:function(e){var t=e.data,a=e.ownProps;return!t.loading&&!t.error&&t.allSeries&&t.allSeries.seriesSummaries.length>0&&t.allSeries.nextToken?t.fetchMore({variables:Object(l.a)({},t.variables,{nextToken:t.allSeries.nextToken}),updateQuery:function(e,t){var a=t.fetchMoreResult;return{allSeries:Object(l.a)({},a.allSeries,{seriesSummaries:[].concat(Object(Ke.a)(e.allSeries.seriesSummaries),Object(Ke.a)(a.allSeries.seriesSummaries))})}}}):t.loading||t.error?a.setSeriesProps(t):a.setSeriesProps(Object(l.a)({},t,{readyForPolling:!0})),null},options:{variables:{limit:100}}}),Ar=Object(s.d)(I,{skip:function(e){return!e.lastCheck},props:function(e){var t=e.data,a=e.ownProps,n=a.seriesProps,o=a.updateIncrement;if(t.error&&(console.log("POLL FAIL",t.error,t),console.error(t.error)),!t.loading&&t.changedSeries&&t.changedSeries.seriesSummaries){var r=t.changedSeries.seriesSummaries,i=n.allSeries.seriesSummaries;if(t.changedSeries){var s=n.allSeries.seriesSummaries;r.forEach(function(e){var t=e.seriesStatus,a=Object(he.a)(e,["seriesStatus"]);if("deleted"===t)console.log("Polling found a series to delete: ",a.id),s=i.filter(function(e){return e.id!==a.id});else{var r=i.findIndex(function(e){return e.id===a.id});r>=0?(console.log("Polling found a series to Update: ",a.id),s=i.map(function(e,t){return t===r?a:e})):(console.log("Polling found a series to add: ",a.id),s=[].concat(Object(Ke.a)(i),[a]))}n.updateQuery(function(e,t){try{return Object(l.a)({},e).allSeries.seriesSummaries=s,o(),e}catch(a){return console.error(a),e}})})}}return null},options:function(e){return{variables:{limit:100,lastCheck:e.lastCheck}}}}),Tr=Pr(function(){return null}),Lr=Ar(function(){return null}),_r=Object(Qe.b)(function(e,t){return{activeSeries:e.home.current.activeSeries,initViewport:e.map.slice(-1).pop()}},function(e){return{mapFuncs:{setActiveSeries:function(t){e(dt(t))},onSeriesClick:function(){e(ct(Q.e.AppStateTypes.SERIES))},onSearchClick:function(){e(ct(Q.e.AppStateTypes.SEARCH,{search:{tab:Q.e.SEARCH_TABS.LOCATION,text:""}}))},popMapHistory:function(){e(pt())},pushMapHistory:function(t){e(mt(t))},clearMapHistory:function(){e(ht())}}}})(function(e){var t=e.initViewport,a=e.activeSeries,r=e.mapFuncs,i=Object(n.useState)(),l=Object(le.a)(i,2),s=l[0],c=l[1],u=Object(n.useState)(0),d=Object(le.a)(u,2),p=d[0],m=d[1],h=function(){return m(p+1)},g=Object(n.useRef)(),b=Object(n.useState)(null),f=Object(le.a)(b,2),y=f[0],v=f[1];g.current=y;var w=Object(n.useMemo)(function(){return o.a.createElement(Tr,{setSeriesProps:c})},[]),x=Object(n.useMemo)(function(){return o.a.createElement(Lr,{lastCheck:y,seriesProps:s,updateIncrement:h})},[y]);return Object(n.useEffect)(function(){if(s)return!g.current&&s.readyForPolling&&(g.current=setInterval(function(){g.current&&v(String(Date.now()-1e3*Ir))},1e3*Ir)),function(){g.current&&(console.log("clear poll timer"),clearInterval(g.current),g.current=null)}},[s]),o.a.createElement(o.a.Fragment,null,w,x,o.a.createElement(Nr,Object.assign({queryVersion:p,seriesList:s&&s.allSeries?s.allSeries.seriesSummaries:[],activeSeries:a,initViewport:t,loading:{}},r)))}),zr=a(955),Rr=a(228),Mr=a.n(Rr),Dr=a(269),Fr=a.n(Dr),Br=a(125),Ur=a.n(Br),$r=Object(W.a)(function(e){return{root:{},chosenItem:{background:e.palette.grey[300]},avatar:{},avatarImg:{height:"100%",width:"100%",objectFit:"cover"}}}),Wr=function(e){var t,a=e.variant,n=e.name,r=e.description,i=e.gravatar,l=e.onClick,s=e.onCancel,c=$r(),u=Mr.a;switch(a){case"tag":u=nn.a;break;case"location":u=Mr.a;break;case"user":u=i?(t=i,function(){return o.a.createElement(fr.a,{className:c.avatar},o.a.createElement("img",{className:c.avatarImg,alt:"profile",src:t}))}):Fr.a}return o.a.createElement(Wa.a,{className:It()(c.root,s?c.chosenItem:null),elevation:1,button:!!l,onClick:l},o.a.createElement(zr.a,null,o.a.createElement(fr.a,null,o.a.createElement(u,null))),o.a.createElement(Fa.a,{primary:n,secondary:r}),s&&o.a.createElement(Da.a,null,o.a.createElement(pa.a,{onClick:s},o.a.createElement(Ur.a,null))))},Gr=Wr,qr=Object(W.a)(function(e){return{root:{width:"100%",backgroundColor:e.palette.background.paper,position:"relative",overflow:"auto"},listSection:{backgroundColor:"inherit"},placeholderText:{textAlign:"center",padding:e.spacing(3,1),color:e.palette.grey[400]},ul:{backgroundColor:"inherit",padding:0}}}),Hr=function(e){var t=e.variant,a=e.loading,n=e.contextResults,r=e.setContextChoice,i=qr();return a?o.a.createElement(U.a,{className:i.placeholderText,variant:"h3"},"Searching..."):n&&0!==n.length?o.a.createElement($a.a,{className:i.root},n.map(function(e,a){return o.a.createElement(Gr,Object.assign({key:"scr-".concat(a),variant:t,onClick:function(){return r(e)}},e))})):o.a.createElement(U.a,{className:i.placeholderText,variant:"h4"},"No ",t," results")},Yr=Object(W.a)(function(e){return{root:{height:"100%"},list:{width:"100%",height:"100%",backgroundColor:e.palette.background.paper,position:"relative",overflowX:"hidden",overflowY:"scroll"},placeholderText:{textAlign:"center",padding:e.spacing(3,1),color:e.palette.grey[400]},listSection:{backgroundColor:"inherit"},ul:{backgroundColor:"inherit",padding:0}}}),Vr=function(e){var t=e.variant,a=e.loading,n=e.seriesList,r=e.contextChoice,i=e.onCancel,l=e.onResultClick,s=Yr(),c=null;return c=a?o.a.createElement(U.a,{className:s.placeholderText,variant:"h3"},"Searching..."):n&&n.length>0?n.map(function(e,t){return o.a.createElement(pr,{key:"series-".concat(t),series:e,onClick:function(){return l(e.id)},showCreatedOn:!0,showLastPhoto:!0})}):o.a.createElement(U.a,{className:s.placeholderText,variant:"h4"},"No series found"),o.a.createElement("div",{className:s.root},o.a.createElement(Gr,Object.assign({},r,{variant:t,onCancel:i})),o.a.createElement($a.a,{className:s.list,subheader:o.a.createElement("li",null)},c))},Xr=Object(W.a)(function(e){return{root:{flexGrow:1,padding:"10%",display:"flex",flexDirection:"column",opacity:.3,textAlign:"center"},icon:{width:"100%",flex:"1 1 40%",color:e.palette.primary.light,opacity:.5},primary:{flex:"1 1 30%",width:"100%"},secondary:{flex:"1 1 30%",width:"100%"}}}),Qr=function(e){var t=e.icon,a=e.primary,n=e.secondary,r=Xr(),i=t;return o.a.createElement("div",{className:r.root},o.a.createElement(i,{className:r.icon}),a&&o.a.createElement(U.a,{className:r.primary,variant:"h3"},a),n&&o.a.createElement(U.a,{className:r.secondary,variant:"h4"},n))},Jr=function(){var e=Object(n.useState)(null),t=Object(le.a)(e,2),a=t[0],o=t[1],r=function(){console.log("ONLINE"),o(null)},i=function(){console.log("OFFLINE");var e=Date.now();o(e)};return Object(n.useEffect)(function(){return window.addEventListener("online",r),window.addEventListener("offline",i),function(){window.removeEventListener("online",r),window.removeEventListener("offline",i)}},[]),{online:null===a,since:a}},Zr=a(479),Kr=a.n(Zr),ei=Q.e.SEARCH_TABS,ti=Object(W.a)(function(e){return{root:{height:"100%",display:"flex",overflow:"hidden",flexDirection:"column"},tabs:{},tab:{flexGrow:1},grow:{flexGrow:1}}}),ai=function(e){e.onMenuBack;var t=e.currentTab,a=e.setCurrentTab,r=e.defaultText,i=e.searchText,l=e.setSearchText,s=e.contextResults,c=e.searchResults,u=e.contextChoice,d=e.loading,p=e.setContextChoice,m=e.onMapClick,h=e.onResultClick,g=ti(),b=Jr().online;Object(n.useEffect)(function(){s&&!c&&1===s.length&&p(s[0])},[s]);var f={};switch(t){case ei.TAG:f={primary:"Tag search",secondary:"example: 'beaver...'",icon:nn.a};break;case ei.USER:f={primary:"User search",secondary:"example: 'SuperGreg123...'",icon:Fr.a};break;case ei.LOCATION:f={primary:"Location Search",secondary:"example: 'Vancouver...'",icon:Mr.a}}var y=null;return y=b?u&&c?o.a.createElement(Vr,{variant:t,loading:d,onResultClick:h,seriesList:c,contextChoice:u,onCancel:function(){return p(null)}}):s?o.a.createElement(Hr,{loading:d,variant:t,contextResults:s,setContextChoice:t===ei.LOCATION?m:p}):r.length>0?o.a.createElement(U.a,null,"Searching for ","'".concat(i,"'")||"..."):o.a.createElement(Qr,f):o.a.createElement(Qr,{primary:"Search Disabled",secondary:"(Offline)",icon:Kr.a}),o.a.createElement("div",{className:g.root},o.a.createElement(tr,null,o.a.createElement(lr,{disabled:!b,autoFocus:!0,onChange:l,defaultValue:i})),b&&o.a.createElement(ma.a,{value:t,disabled:!b,onChange:function(e,t){return a(t)},indicatorColor:"primary",textColor:"primary",classes:{flexContainer:g.tabs},centered:!0},o.a.createElement(ha.a,{className:g.tab,value:ei.TAG,label:"Tags"}),o.a.createElement(ha.a,{className:g.tab,value:ei.LOCATION,label:"Places"}),o.a.createElement(ha.a,{className:g.tab,value:ei.USER,label:"Users"})),y)};ai.defaultProps={currentTab:ei.TAGS,defaultText:""};var ni=ai,oi=Object(s.d)(L,{props:function(e){var t=e.data;t.error&&console.error(t.error);var a=null;try{t.loading||t.error||(a=t.series)}catch(n){console.error(t),console.error(n)}return{contextResults:t.tags?t.tags.map(function(e){var t=e.name,a=e.count;return{name:t,description:"~ ".concat(10*Math.ceil(a/10)," Photo series tagged")}}):[],loading:t.loading,series:a}},options:function(e){var t=e.searchText;return{variables:{tag:!t||t.length<3?"":t,limit:10}}}}),ri=Object(s.d)(D,{props:function(e){var t=e.data;t.error&&console.error(t.error);var a=null;try{t.loading||t.error||(a=t.series)}catch(n){console.error(t),console.error(n)}return{contextResults:t.userSearch?t.userSearch.map(function(e){var t=e.username,a=e.gravatar,n=e.createdOn;return{name:t,id:e.id,description:"Joined ".concat(Object(Va.c)(n)),gravatar:a}}):[],loading:t.loading,series:a}},skip:function(e){var t=e.searchText;return!t||t.length<3},options:function(e){return{variables:{searchStr:e.searchText,limit:10}}}}),ii=Object(s.d)(R,{props:function(e){var t=e.data;t.error&&console.error(t.error);var a=null;try{t.loading||t.error||(a=t.series)}catch(n){console.error(t),console.error(n)}return{contextResults:t.geocoder?t.geocoder.map(function(e){var t=e.relevance;return{name:e.text,description:e.placeName,bbox:e.bbox,center:e.center,relevance:t}}):[],loading:t.loading,series:a}},skip:function(e){var t=e.searchText;return!t||t.length<3},options:function(e){return{variables:{search:e.searchText}}}}),li=Object(s.d)(T,{props:function(e){var t=e.data;t.error&&console.error(t.error);var a=null;try{t.loading||t.error||(a=t.series)}catch(n){console.error(t),console.error(n)}return{searchResults:t.tagSeries&&t.tagSeries.seriesSummaries?t.tagSeries.seriesSummaries:[],loading:t.loading,series:a}},skip:function(e){return!e.contextChoice},options:function(e){return{variables:{tag:e.contextChoice.name,limit:10}}}}),si=Object(s.d)(P,{props:function(e){var t=e.data;t.error&&console.error(t.error);var a=null;try{t.loading||t.error||(a=t.series)}catch(n){console.error(t),console.error(n)}return{searchResults:t.userSeries&&t.userSeries.seriesSummaries?t.userSeries.seriesSummaries:[],loading:t.loading,series:a}},skip:function(e){return!e.contextChoice},options:function(e){return{variables:{createdBy:e.contextChoice.id}}}}),ci=Object(s.d)(_,{props:function(e){var t=e.data;t.error&&console.error(t.error);var a=null;try{t.loading||t.error||(a=t.series)}catch(n){console.error(t),console.error(n)}return{data:t,loading:t.loading,series:a}},skip:function(e){return!e.contextChoice},options:function(e){return{variables:{bounds:e.contextChoice.bbox}}}}),ui=Object(Qe.b)(function(e,t){var a=e.home.current,n=a.search,o=a.activeSeries,r=a.domain;return{defaultTab:n?n.tab:null,defaultText:n?n.text:null,activeSeries:o,domain:r}},function(e){return{onBack:function(){e(ut())},queueUpload:function(t){e(gt(t))},jumpToSeries:function(t){e(ct(Q.e.AppStateTypes.SERIES,{activeSeries:t}))},jumpToMap:function(t){var a=t.bbox,n=t.center,o=a;if(!o&&n){var r=Object(Uo.buffer)(Object(Uo.point)(n),500,{units:"meters"});o=Object(Uo.bbox)(r)}o&&(e(mt({mode:Q.e.MapModeTypes.FREE,bounds:o})),e(ct(Q.e.AppStateTypes.MAP,{activeSeries:null,initialPhoto:null})))}}})(function(e){var t=e.jumpToMap,a=e.jumpToSeries,r=e.defaultTab,i=e.defaultText,l=Object(n.useState)(r||Q.e.SEARCH_TABS.TAG),c=Object(le.a)(l,2),u=c[0],d=c[1],p=Object(n.useState)(i||""),m=Object(le.a)(p,2),h=m[0],g=m[1],b=Object(n.useState)(null),f=Object(le.a)(b,2),y=f[0],v=f[1],w=null,x=null;switch(u){case Q.e.SEARCH_TABS.TAG:w=oi,x=li;break;case Q.e.SEARCH_TABS.LOCATION:w=ci,x=ii;break;case Q.e.SEARCH_TABS.USER:w=ri,x=si}var E=Object(s.c)(w,x)(ni);return o.a.createElement(E,Object.assign({currentTab:u,searchText:h,contextChoice:y},{onMenuBack:function(){},onMapClick:t,onResultClick:a,setContextChoice:function(e){v(e)},setCurrentTab:function(e){v(null),d(e)},setSearchText:function(e){g(e),v(null)}}))}),di=Object(W.a)(function(e){return{root:{},gravatarImg:{display:"block",marginRight:e.spacing(2),width:"100%",maxWidth:"25%",height:"auto"}}}),pi=function(e){var t=e.user,a=e.loading,n=e.onAvatarClick,r=di();return a||!t?"LOADING...":(console.log("USER",t),o.a.createElement(Wa.a,{className:r.root,onClick:n,disableGutters:!0},o.a.createElement("img",{alt:"profile",className:r.gravatarImg,src:t.gravatar}),o.a.createElement(Fa.a,{primary:t.username,secondary:"Since ".concat(Object(Va.d)(t.createdOn))})))},mi=Object(W.a)(function(e){return{root:{display:"flex",flexDirection:"column",height:"100%"},filterContainer:{color:"#AAAAAA"},filterChip:{},seriesList:{height:"100%",overflowX:"hidden",overflowY:"scroll"}}}),hi="All",gi="Own",bi="Contributed",fi="Watching",yi="Last Photo",vi="Created",wi="Name",xi=function(e){var t=e.user,a=e.feed,r=e.loading,i=mi(),l=Object(n.useState)(hi),s=Object(le.a)(l,2),c=s[0],u=s[1],d=Object(n.useState)(yi),p=Object(le.a)(d,2),m=p[0],h=p[1],g=Object(n.useState)(!0),b=Object(le.a)(g,2),f=b[0],y=b[1],v=function(e){e===m?y(!f):h(e)},w=[];switch(c){case hi:w=Object(Ke.a)(a);break;case gi:w=a.filter(function(e){return e.createdUser.id===t.id});break;case bi:w=[];break;case fi:w=a.filter(function(e){return t.watching.indexOf(e.id)>-1})}switch(m){case yi:f?w.sort(function(e,t){return e.latest.takenOn-t.latest.takenOn}):w.sort(function(e,t){return t.latest.takenOn-e.latest.takenOn});break;case vi:f?w.sort(function(e,t){return e.createdOn-t.createdOn}):w.sort(function(e,t){return t.createdOn-e.createdOn});break;case wi:f?w.sort(function(e,t){return e.name<t.name?-1:e.name>t.firstname?1:0}):w.sort(function(e,t){return t.name<e.name?-1:t.name>e.name?1:0})}return console.log("MyProfile",{loading:r,feed:a}),o.a.createElement("div",{className:i.root},o.a.createElement(tr,null,o.a.createElement(U.a,null,"My Profile")),o.a.createElement(pi,{user:t}),o.a.createElement(Ba.a,null),o.a.createElement("div",{className:i.filterContainer},o.a.createElement("div",null,o.a.createElement(U.a,{component:"span"},"Filter: "),o.a.createElement(Oi,{active:c===hi,onClick:function(){return u(hi)},label:hi}),"|",o.a.createElement(Oi,{active:c===gi,onClick:function(){return u(gi)},label:gi}),"|",o.a.createElement(Oi,{active:c===bi,onClick:function(){return u(bi)},label:bi}),"|",o.a.createElement(Oi,{active:c===fi,onClick:function(){return u(fi)},label:fi})),o.a.createElement("div",null,o.a.createElement(U.a,{component:"span"},"Sort: "),o.a.createElement(Oi,{asc:f,active:m===wi,onClick:function(){return v(wi)},label:wi}),"|",o.a.createElement(Oi,{asc:f,active:m===yi,onClick:function(){return v(yi)},label:yi}),"|",o.a.createElement(Oi,{asc:f,active:m===vi,onClick:function(){return v(vi)},label:vi}))),o.a.createElement("div",{className:i.seriesList},w.map(function(e,t){return o.a.createElement(pr,{key:"seriesListItem".concat(t),series:e,showCreatedOn:!0,showLastPhoto:!0})})))},Ei=Object(W.a)(function(e){return{root:{margin:e.spacing(0,1,0,1)}}}),Oi=function(e){var t=e.active,a=e.asc,n=e.onClick,r=e.label,i=Ei(),l=t&&"undefined"!==typeof a?!0===a?"\u25b2":"\u25bc":" ";return o.a.createElement(U.a,{className:i.root,onClick:n,variant:"caption",color:t?"textPrimary":"textSecondary"},r," ",l)},ki=Object(s.d)(z,{props:function(e){var t=e.data;e.ownProps;return{data:{userQ:t}}}}),Si=Object(s.d)(P,{skip:function(e){return!e.data.userQ.user},props:function(e){var t=e.data,a=e.ownProps;return{data:Object(l.a)({},a.data,{seriesQ:t})}}}),ji=Object(s.d)(A,{props:function(e){var t=e.data,a=e.ownProps;return{data:Object(l.a)({},a.data,{watchedSeriesQ:t})}},skip:function(e){var t=e.data;try{return t.userQ.user.watching.length<1}catch(a){return!0}},options:function(e){return{variables:{seriesList:e.data.userQ.user.watching}}}}),Ci=Object(s.c)(ki,Si,ji)(function(e){var t=e.data,a=t.userQ,n=t.seriesQ,r=t.watchedSeriesQ,i=a&&a.user?a.user:null,l=n&&n.userSeries&&n.userSeries.seriesSummaries?n.userSeries.seriesSummaries:[],s=r&&r.arraySeries?r.arraySeries:[];console.log("ProfileConnect",{seriesQArr:l,watchedSeriesQ:r,watchedSeriesQArr:s});var c=[].concat(Object(Ke.a)(l),Object(Ke.a)(s)),u={user:a.loading,list:Boolean(n&&n.loading||r&&r.loading)};return o.a.createElement(xi,{user:i,loading:u,feed:c})}),Ni=a(490),Ii=Object(W.a)(function(e){return{root:{textAlign:"center",fontStyle:"italic",padding:e.spacing(2,1)}}}),Pi=function(e){var t=e.style,a=e.icon,n=e.text,r=Ii();return o.a.createElement(U.a,{className:r.root,variant:"subtitle1",color:"textSecondary",component:"div",style:t},a,n)},Ai=a(272),Ti=a.n(Ai),Li=Object(W.a)(function(e){return{root:{textAlign:"center"},placeAvatar:{color:"white",background:e.palette.primary.main,margin:"auto"},placeIcon:{}}}),_i=function(e){var t=e.onClick,a=Li();return o.a.createElement("div",{className:a.root},o.a.createElement(fr.a,{className:a.placeAvatar},o.a.createElement(pa.a,{color:"inherit",onClick:function(e){e.preventDefault(),e.stopPropagation(),t()}},o.a.createElement(Mr.a,{color:"inherit"}))))},zi=Object(W.a)(function(e){return{root:{height:"100%",padding:e.spacing(0,.5,1,.5)},imgContainer:{overflow:"hidden",height:"100%",position:"relative"},findOnMapButtonContainer:{position:"absolute",opacity:.8,bottom:e.spacing(1),right:e.spacing(1)},titleContainer:{background:"#444444AA",color:"white",position:"absolute",alignItems:"center",display:"flex",top:0,width:"100%",paddingRight:e.spacing(1)},avatar:{border:"1px solid white",margin:e.spacing(0,1)},title:{flexGrow:1},img:{objectFit:"cover",height:"100%",width:"100%"}}}),Ri="Added",Mi=function(e){var t=e.event,a=e.onMapClick,r=e.onImageClick,i=e.onProfileClick,l=(e.onSeriesClick,t.series),s=t.photo,c=zi(),u=Object(n.useContext)(B).seriesConfig;return o.a.createElement(Pt.a,{className:c.root,elevation:1},o.a.createElement("div",{className:c.imgContainer},o.a.createElement("img",{alt:"medium",className:c.img,src:u.getPhotoUrl(s,"medium"),onClick:function(){return r(l.id,s.id)}}),o.a.createElement("div",{className:c.titleContainer},o.a.createElement(fr.a,{onClick:function(){return i(s.createdUser.username)},className:c.avatar},o.a.createElement("img",{alt:"profile",className:c.gravatarImg,src:s.createdUser.gravatar})),o.a.createElement("div",{className:c.title},o.a.createElement(U.a,{variant:"body1",color:"inherit"},l.name),o.a.createElement(U.a,{variant:"body2",color:"inherit"},s.createdUser.username," ",Ri," a photo"),o.a.createElement(U.a,{variant:"caption",color:"inherit"},Object(Va.d)(s.updatedOn))),o.a.createElement(_i,{onClick:function(){return a(l.id,s.id)}}))))},Di=Mi,Fi=Object(W.a)(function(e){return{root:{display:"flex",flexDirection:"column",height:"100%"},listContainer:{flexGrow:1,overflowX:"hidden"},vList:{height:"100%",width:"100%"},feedContainer:{flexGrow:1,transform:"translateZ(0)"},grow:{flexGrow:1}}}),Bi=function(e){var t=e.events,a=e.loading,r=e.onMapClick,i=e.onImageClick,l=e.onProfileClick,s=e.onSeriesClick,c=(e.fetchNewest,e.fetchMore),u=e.window,d=Fi(),p=Object(n.useRef)(),m=Object(Ln.a)(p).size,h=Jr().online;return o.a.createElement("div",{className:d.root},o.a.createElement(tr,null,o.a.createElement(U.a,{className:d.grow},"Feed")),o.a.createElement("div",{className:d.listContainer,ref:p},o.a.createElement(Ni.a,{height:m.height,width:m.width,className:d.vList,rowCount:t.length+1,rowHeight:300,rowRenderer:function(e){var n,p=e.index,m=(e.isScrolling,e.isVisible,e.key),g=e.parent,b=e.style,f=t[p];if(p<t.length&&f)n=o.a.createElement(Di,{event:t[p],onSeriesClick:s,onImageClick:i,onProfileClick:l,onMapClick:r});else if(p===t.length){var y=u&&0===u[0];n=o.a.createElement(Pi,{style:b,text:"Loading..."});var v=1200+g.state.scrollTop>b.top;h?y?n=o.a.createElement(Pi,{style:b,text:"End"}):!a&&v&&c():n=o.a.createElement(Pi,{style:b,icon:o.a.createElement(Ti.a,null),text:"Cannot Refresh Offline"})}return o.a.createElement("div",{className:d.row,key:m,style:b},n)}})))},Ui=20,$i=Object(s.d)(M,{props:function(e){var t=e.data;t.error&&console.error(t.error);var a=!1,n=!1;return{data:t,loadingNewest:a,loadingMore:n,fetchNewest:function(){a=!0,console.log("fetchNewest",t),t.fetchMore({variables:Object(l.a)({},t.variables,{start:t.myFeed.window[1]}),updateQuery:function(e,t){var n=t.fetchMoreResult;return a=!1,{myFeed:Object(l.a)({},n.myFeed,{feed:[].concat(Object(Ke.a)(n.myFeed.feed),Object(Ke.a)(e.myFeed.feed)),window:[e.myFeed.window[0],n.myFeed.window[1]]})}}})},fetchMore:function(){n=!0,console.log("fetchMore",t),t.fetchMore({variables:Object(l.a)({},t.variables,{end:t.myFeed.window[0]}),updateQuery:function(e,t){var a=t.fetchMoreResult;return n=!1,{myFeed:Object(l.a)({},a.myFeed,{feed:[].concat(Object(Ke.a)(e.myFeed.feed),Object(Ke.a)(a.myFeed.feed)),window:[a.myFeed.window[0],e.myFeed.window[1]]})}}})},loading:t.loading}},options:function(e){e.activeSeries;return{variables:{limit:5}}}}),Wi=Object(Qe.b)(function(e,t){return{}},function(e){return{jumpToSeries:function(t,a){e(ct(Q.e.AppStateTypes.SERIES,{activeSeries:t,initialPhoto:a}))},jumpToUser:function(t){e(ct(Q.e.AppStateTypes.SEARCH,{search:{tab:Q.e.SEARCH_TABS.USER,text:t}}))},jumpToMap:function(t,a){e(mt({mode:Q.e.MapModeTypes.FREE})),e(ct(Q.e.AppStateTypes.MAP,{activeSeries:t,initialPhoto:a}))}}})($i(function(e){var t=e.data,a=e.loading,r=e.fetchMore,i=e.fetchNewest,l=(e.loadingNewest,e.loadingMore,e.jumpToSeries),s=e.jumpToMap,c=e.jumpToUser,u=Object(n.useRef)(),d=Jr().online,p=Object(n.useState)(null),m=Object(le.a)(p,2),h=m[0],g=m[1];u.current=h,Object(n.useEffect)(function(){return u.current||(u.current=setInterval(function(){!a&&d&&i(),u.current&&g(String(Date.now()-1e3*Ui))},1e3*Ui)),function(){u.current&&(console.log("clear poll timer"),clearInterval(u.current),u.current=null)}},[]);var b=t.myFeed&&t.myFeed.feed||[],f=t.myFeed&&t.myFeed.window.map(function(e){return parseInt(e,10)})||[null,null];return o.a.createElement(Bi,Object.assign({events:b,loading:a,window:f,fetchMore:r,fetchNewest:i,jumpToSeries:l},{onSeriesClick:function(){},onImageClick:l,onProfileClick:c,onMapClick:s}))})),Gi=a(223),qi=a.n(Gi),Hi=Object(W.a)(function(e){return{root:{background:"black",color:"white",textAlign:"center"}}}),Yi=function(){var e=Hi(),t=Jr(),a=t.online,r=t.since,i=Object(n.useState)(),l=Object(le.a)(i,2),s=l[0],c=l[1],u=Object(n.useRef)(),d=function(){var e=qi()(r,"x").fromNow();c(e)},p=function(){u.current&&(clearInterval(u.current),u.current=null)};return Object(n.useEffect)(function(){return r&&!u.current?(d(),u.current=setInterval(d,5e3)):r||p(),function(){p()}},[r]),a?null:o.a.createElement(U.a,{className:e.root,variant:"caption",component:"div"},"Offline (",s,")")},Vi=a(485),Xi=a.n(Vi),Qi=a(486),Ji=a.n(Qi),Zi=a(487),Ki=a.n(Zi),el=a(265),tl=a.n(el),al=a(488),nl=a.n(al),ol=Object(W.a)(function(e){return{root:{},text:{padding:e.spacing(2,2,0)},paper:{paddingBottom:50},list:{marginBottom:e.spacing(2)},subheader:{backgroundColor:e.palette.background.paper},grow:{flexGrow:1},spacer:{width:40,flexGrow:1}}}),rl=function(e){var t=e.className,a=e.signedIn,n=e.onHomeClick,r=e.onMapClick,i=e.onSearchClick,l=e.onProfileClick,s=e.onCameraClick,c=e.onLibraryClick,u=ol(),d=Jr().online;return o.a.createElement(da.a,{position:"static",className:It()(u.root,t)},o.a.createElement(ye.a,null,a&&o.a.createElement(be.a,{edge:"start",className:u.grow,color:"inherit",onClick:n},o.a.createElement(Xi.a,null)),o.a.createElement(be.a,{edge:"start",className:u.grow,color:"inherit",onClick:r},o.a.createElement(Ji.a,null)),a&&o.a.createElement(za,{onCameraClick:s,onLibraryClick:c},o.a.createElement(tl.a,null)),o.a.createElement("div",{className:u.spacer}),o.a.createElement(be.a,{color:"inherit",className:u.grow,disabled:!d,onClick:i},o.a.createElement(Ki.a,null)),a&&o.a.createElement(be.a,{edge:"end",color:"inherit",className:u.grow,onClick:l},o.a.createElement(nl.a,null))))},il=rl,ll=(Object(W.a)(function(e){return{root:{height:"100%",display:"flex",flexDirection:"column"},paper:{flexGrow:1}}}),Q.e.AppStateTypes),sl=Object(W.a)(function(e){return{root:{height:"100%",overflow:"hidden",display:"flex",flexDirection:"column"},offlineBar:{flex:"0 0"},activeWrapper:{overflow:"hidden",flexGrow:1,flexShrink:1},uploaderContainer:{zIndex:2e3,flex:"0 0"}}}),cl=function(e){var t=e.domain,a=e.setHomeState,r=e.onCameraClick,i=e.onLibraryClick,l=sl(),s=Object(n.useContext)(B).signedIn;Object(n.useEffect)(function(){s||t!==ll.FEED||a(ll.MAP)},[t]);var c=!0,u=Wi;switch(t){case ll.FEED:u=Wi;break;case ll.MAP:u=_r;break;case ll.PROFILE:u=Ci;break;case ll.SEARCH:u=ui;break;case ll.SERIES:case ll.NEW_SERIES_CAMERA:case ll.NEW_SERIES_LIBRARY:u=To,c=!1}return o.a.createElement("div",{className:l.root},o.a.createElement($.a,null)," ",o.a.createElement(Yi,{className:l.offlineBar}),o.a.createElement("div",{className:l.activeWrapper},o.a.createElement(u,null)),c&&o.a.createElement(il,{signedIn:s,onHomeClick:function(){return a(ll.FEED)},onMapClick:function(){return a(ll.MAP)},onSearchClick:function(){return a(ll.SEARCH,{search:null})},onProfileClick:function(){return a(ll.PROFILE)},onCameraClick:r,onLibraryClick:i}),o.a.createElement(Ht,{className:l.uploaderContainer}))},ul=a(489),dl=a.n(ul),pl=Object(W.a)(function(e){return{root:{height:"100%",overflow:"hidden",padding:e.spacing(1),display:"flex",flexDirection:"column",textAlign:"center",color:e.palette.text.primary,border:"20px solid ".concat(e.palette.text.secondary)},icon:{margin:"auto",flex:"1 1 20%",height:"70%",width:"70%"},text:{},stack:{padding:e.spacing(2),marginBottom:e.spacing(2),fontSize:"8px",flexGrow:1,textAlign:"left",whiteSpace:"pre-wrap",overflow:"scroll",color:e.palette.error.main,fontFamily:"Consolas, monaco, monospace"}}}),ml=function(e){var t=e.error,a=pl();return o.a.createElement("div",{className:a.root},o.a.createElement($.a,null),o.a.createElement(Ti.a,{className:a.icon,color:"inherit"}),o.a.createElement(U.a,{variant:"subtitle1",className:a.text,color:"inherit"},"Something went wrong"),t&&t.message&&o.a.createElement(U.a,{variant:"body1",className:a.text,color:"inherit"},t.message),null,o.a.createElement(be.a,{variant:"outlined",disabled:!0},o.a.createElement(dl.a,null),"File a bug report"))},hl=Object(Qe.b)(function(e,t){return{domain:e.home.current.domain}},function(e){return{setHomeState:function(t,a){e(ct(t,a))},onCameraClick:function(){e(ct(Q.e.AppStateTypes.NEW_SERIES_CAMERA))},onLibraryClick:function(){e(ct(Q.e.AppStateTypes.NEW_SERIES_LIBRARY))}}}),gl=Object(s.c)(Ct,function(e){return function(t){var a=Re(),r=a.signedIn,i=a.isGod,c=a.authData,u=a.signOut,d=a.authScreen,m=a.accessToken,h=a.forceSignIn,g=Object(n.useMemo)(function(){return function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=new Z.a,a=Object(X.a)(function(t,a){var n=a.headers;return{headers:Object(l.a)({},n,{authorization:e?"Bearer ".concat(e):""})}}),n=Object(V.a)({uri:Q.d.graphql});return console.log("Creating Apollo Client Client",Q.d.graphql,e?"TOKEN PROVIDED":"NO TOKEN"),new K.a({link:J.a.from([a,n]),tokenName:ee,cache:t,connectToDevTools:!0})}(m)},[m]);qe();var b=Ve();if(console.log("Rendering AppConnect",{responsive:b,props:t,signedIn:r,isGod:i,authData:c}),null===r)return d;var f=Object(l.a)({signOut:u,forceSignIn:h},b,{signedIn:r,role:r?i?"admin":"user":"anonymous",currentUser:c,seriesConfig:{meta:{},tags:[{id:"freeBothType",label:null,color:Q.c.tagColors[0],allowXY:!0,allowNonXY:!0,allowAdditions:!0,getValues:function(){return Promise.resolve(["a","b","c"])},values:[]}],getPhotoUrl:function(e,t){try{return"".concat(e.paths.base).concat(e.paths[t])}catch(a){return null}}}});return o.a.createElement(ie,{fallback:ml},o.a.createElement(s.a,{client:g},o.a.createElement(s.b,{query:z,skip:!r},function(a){var n=a.loading,i=a.error,l=a.data;return n?o.a.createElement(Y,null):(i&&console.error(i),r&&(f.user=l.user),o.a.createElement(B.Provider,{value:f},o.a.createElement(p,null,o.a.createElement(e,t))))})))}},hl)(cl),bl=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function fl(e,t){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var a=e.installing;null!=a&&(a.onstatechange=function(){"installed"===a.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See http://bit.ly/CRA-PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}}).catch(function(e){console.error("Error during service worker registration:",e)})}a(874);a(876),console.log("Rendering Main App"),i.a.render(o.a.createElement(gl,null),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/photomon_v0",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="".concat("/photomon_v0","/service-worker.js");bl?(function(e,t){fetch(e).then(function(a){var n=a.headers.get("content-type");404===a.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):fl(e,t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(t,e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit http://bit.ly/CRA-PWA")})):fl(t,e)})}}()},99:function(e,t,a){"use strict";var n=a(7),o=a(0),r=a.n(o),i=a(19),l=a.n(i),s=a(916),c=a(102),u=a(56),d=a(46),p=a(457),m=a.n(p),h=a(968),g=a(458),b=a(125),f=a.n(b),y=a(257),v=a.n(y),w=a(934),x=20,E=Object(s.a)(function(e){return{xyTagChip:{cursor:"pointer",color:"white",fontSize:"0.6em",background:"#444444",height:x,position:"absolute",left:-x/2,top:-x/2},editing:{},reversedChip:{flexDirection:"row-reverse",left:"unset",right:-x/2},deleteIcon:{width:x-1,height:x-1},chipAvatarIcon:{color:"white",width:x-4,height:x-4},chipAvatar:{background:"inherit",width:x,height:x},reversedDelete:{margin:"0 -".concat(x/8,"px 0 ").concat(x/8,"px")},chipBucket:{width:1,height:1,display:"flex",flexDirection:"row",position:"absolute"},reversedChipBucket:{flexDirection:"row-reverse"}}}),O=function(e){var t=e.color,a=e.edit,n=e.tag,o=e.newSize,i=e.onTagDragOver,s=e.onTagDragStop,c=(e.onNewTag,e.onTagDelete),u=Object(d.a)(e,["color","edit","tag","newSize","onTagDragOver","onTagDragStop","onNewTag","onTagDelete"]),p=n.relCoords.x>o.newWidth/2,b=E(),y=Object(w.a)(),x=function(e){e.preventDefault(),e.stopPropagation()};return r.a.createElement(m.a,{disabled:!a,bounds:{left:10,top:10,right:o.newWidth-10,bottom:o.newHeight-10},position:{x:n.relCoords.x,y:n.relCoords.y},onDrag:function(e,t){x(e),i(t,n)},onStop:function(e,t){x(e),s(t,n)},onClick:x},r.a.createElement("div",{className:l()(b.chipBucket,p&&b.reversedChipBucket)},r.a.createElement(h.a,Object.assign({style:{background:t?"".concat(t,"!important"):null,color:t?"".concat(y.palette.getContrastText(t),"!important"):null},color:a?"secondary":"default",label:n.label,data:n.id,onClick:x,onDelete:a?c(n):null,deleteIcon:a?r.a.createElement(f.a,{className:l()(b.deleteIcon,p&&b.reversedDelete)}):r.a.createElement("div",null),className:l()(b.xyTagChip,p&&b.reversedChip,a&&b.editing)},u,{avatar:r.a.createElement(g.a,{className:l()(b.chipAvatar,a&&b.editing)},r.a.createElement(v.a,{className:l()(b.chipAvatarIcon,a&&b.editing)}))}))))},k=a(23),S=a(8),j=a(941),C=a(943),N=a(919),I=a(944),P=a(126),A=a.n(P),T=a(926),L=a(961),_=a(937),z=a(261),R=a(263),M=a.n(R),D=Object(s.a)(function(e){return{root:{width:"100%"},noOptionsMessage:{padding:"".concat(e.spacing(1),"px ").concat(2*e.spacing(1),"px")},singleValue:{fontSize:16},placeholder:{position:"absolute",left:2,fontSize:16},input:{display:"flex",padding:0},valueContainer:{display:"flex",flexWrap:"wrap",flex:1,alignItems:"center",overflow:"hidden"},paper:{position:"absolute",zIndex:100,marginTop:e.spacing(1),left:0,right:0}}}),F=function(e){var t=e.tagConfig,a=e.onChange,n=D(),o=t.values.map(function(e){return{label:e.label,value:e.id}});return console.log("XYTagSelect",t),r.a.createElement("div",{className:n.root},!t.allowAdditions&&r.a.createElement(z.a,{options:o,classes:n,components:{Control:B,Menu:$,NoOptionsMessage:U,Option:q,Placeholder:G,ValueContainer:H},value:null,blurInputOnSelect:!0,isClearable:!1,onChange:a,placeholder:t.label,isSearchable:!0}),t.allowAdditions&&r.a.createElement(M.a,{options:o,classes:n,components:{Control:B,Menu:$,NoOptionsMessage:U,Option:q,Placeholder:G,ValueContainer:H},value:null,isClearable:!1,blurInputOnSelect:!0,onChange:a,placeholder:t.label,isSearchable:!0}))};function B(e){return r.a.createElement(L.a,Object.assign({fullWidth:!0,InputProps:{inputComponent:W,inputProps:Object(S.a)({className:e.selectProps.classes.input,inputRef:e.innerRef,children:e.children},e.innerProps)}},e.selectProps.textFieldProps))}var U=function(e){var t=e.innerProps,a=e.selectProps,n=e.children;return r.a.createElement(N.a,Object.assign({color:"textSecondary",className:a.classes.noOptionsMessage},t),n)},$=function(e){var t=e.selectProps,a=e.innerProps,n=e.children;return r.a.createElement(T.a,Object.assign({square:!0,className:t.classes.paper},a),n)},W=function(e){var t=e.inputRef,a=Object(d.a)(e,["inputRef"]);return r.a.createElement("div",Object.assign({ref:t},a))},G=function(e){return r.a.createElement(N.a,Object.assign({color:"textSecondary",className:e.selectProps.classes.placeholder},e.innerProps),e.children)},q=function(e){var t=e.innerRef,a=e.isFocused,n=e.isSelected,o=e.innerProps,i=e.children;return r.a.createElement(_.a,Object.assign({buttonRef:t,selected:a,component:"div",style:{fontWeight:n?500:400}},o),i)},H=function(e){var t=e.selectProps,a=e.children;return r.a.createElement("div",{className:t.classes.valueContainer},a)},Y=Object(s.a)(function(e){return{root:{overflow:"visible"},header:{padding:2*e.spacing(1)},listItem:{flexDirection:"column"},dlgBody:{paddingLeft:2*e.spacing(1),paddingRight:2*e.spacing(1),paddingBottom:2*e.spacing(1)},closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]}}}),V=function(e){var t=e.coords,a=e.open,n=e.seriesConfig,o=e.onNewTag,i=e.onClose,l=Y(),s=n.tags.filter(function(e){return e.allowXY});return t?r.a.createElement(j.a,{open:a,scroll:"paper",fullScreen:!0,classes:{paperScrollPaper:l.root},onClose:function(){return i()},"aria-labelledby":"simple-dialog-title"},r.a.createElement(C.a,{id:"simple-dialog-title",className:l.header},"New Tag:",r.a.createElement(I.a,{className:l.closeButton,onClick:i},r.a.createElement(A.a,null))),r.a.createElement("div",{className:l.dlgBody},s.length>1&&r.a.createElement(N.a,{variant:"caption"},"What kind of tag would you like to create?"),s.map(function(e,a){return r.a.createElement("div",{className:l.listItem,key:"tagSelect".concat(a)},r.a.createElement(F,{tagConfig:e,onChange:o(t,e)}))}))):null},X=a(235),Q=function(e,t,a,i){var l=Object(o.useContext)(u.a).seriesConfig,s=Object(o.useState)(!1),c=Object(n.a)(s,2),d=c[0],p=c[1],m=Object(o.useState)(null),h=Object(n.a)(m,2),g=h[0],b=h[1],f=new X.a(l,e.tags),y=function(t,n){return function(o){var r=o.value,i=o.__isNew__?f.createNewXYTagObj(r,n.id,t):f.createExistingXYTagObj(r,n.id,t);b(null),a(Object(S.a)({},e,{tags:[].concat(Object(k.a)(e.tags),[i])}))}},v=function(a,n){var o=a.x,r=a.y;return e.tags.map(function(e){if(e.id!==n.id)return e;var a=parseInt(o/t.multiplier,10),i=parseInt(r/t.multiplier,10);return Object(S.a)({},e,{coords:{x:a,y:i}})})};return{onNewTag:y,onTagDelete:function(t){return function(){var n=e.tags.filter(function(e){return e.id!==t.id});a(Object(S.a)({},e,{tags:n}))}},onAddTagTrigger:function(e){g||(i(!1),b({x:parseInt(e.pageX-(window.innerWidth-t.newWidth)/2*t.multiplier,10),y:parseInt(e.pageY-(window.innerHeight-t.newHeight)/2*t.multiplier,10)}))},onTagDragOver:function(e,t){v(e,t),p(!0)},onTagDragStop:function(t,n){var o=v(t,n);p(!1),a(Object(S.a)({},e,{tags:o}))},TagChooser:function(){return r.a.createElement(V,{open:!d&&Boolean(g),coords:g,seriesConfig:l,onNewTag:y,onClose:function(){b(null),i(!0)}})},getRelXYTags:f.getRelXYTags}},J=a(460),Z=a.n(J),K=Object(s.a)(function(e){return{root:{flexGrow:1,padding:"10%",display:"flex",flexDirection:"column",opacity:.3,textAlign:"center",color:e.palette.grey[100]},icon:{width:"100%",flex:"1 1 40%",color:e.palette.grey[100],opacity:.5},primary:{color:e.palette.grey[100],textAlign:"center",flex:"1 1 30%",width:"100%"},secondary:{flex:"1 1 30%",width:"100%"}}}),ee=function(){var e=K();return r.a.createElement("div",{className:e.root},r.a.createElement(Z.a,{className:e.icon}),r.a.createElement(N.a,{className:e.primary},"Img not found"))},te=Object(s.a)(function(e){return{root:{display:"block",position:"relative",width:"100%",height:"100%",background:"black",overflow:"hidden"},inner:{position:"absolute",top:"50%",left:"50%",transform:"translateY(-50%) translateX(-50%)",overflow:"hidden"},xyTags:{position:"absolute",top:0,left:0,height:"100%",width:"100%"},img:{display:"block"},brokenImg:{display:"none"},formControl:{width:"100%"}}});t.a=function(e){var t=e.photo,a=e.opacity,i=e.edit,s=e.showTags,d=(e.transition,e.onChange),p=e.className,m=te(),h=Object(o.useRef)(null),g=Object(o.useState)({multiplier:1}),b=Object(n.a)(g,2),f=b[0],y=b[1],v=Object(o.useState)(null),w=Object(n.a)(v,2),x=w[0],E=w[1],k=Object(o.useState)(!1),S=Object(n.a)(k,2),j=S[0],C=S[1],N=Object(o.useState)(0),I=Object(n.a)(N,2),P=I[0],A=I[1],T=Object(o.useContext)(u.a).seriesConfig;Object(o.useEffect)(function(){!function(){if(t.base64)h.current&&E(t.base64);else{var e=T.getPhotoUrl(t,"large");h.current&&E(e)}}()},[t]);var L=Object(c.a)(h),_=L.size,z=_.height,R=_.width,M=L.setResizeActive,D=P>0?"".concat(x,"?retry=").concat(P):x,F=Q(t,{height:z,width:R},d,M),B=F.onAddTagTrigger,U=F.TagChooser,$=F.getRelXYTags,W=F.onTagDragOver,G=F.onTagDragStop,q=F.onTagDelete;return r.a.createElement("div",{className:l()(m.root,p),style:{opacity:null!==a?a:1},ref:h},r.a.createElement("div",{className:m.inner,style:{height:f?f.newHeight:1,width:f?f.newWidth:1},onClick:B},s||i?r.a.createElement("div",{className:p},$(f.multiplier).map(function(e,t){return r.a.createElement(O,Object.assign({key:"xytag-".concat(t),color:e.color},{edit:i,newSize:f,tag:e,onTagDragOver:W,onTagDragStop:G,onTagDelete:q}))})):null,j&&r.a.createElement(ee,null),r.a.createElement("img",{className:l()(j?m.brokenImg:m.img),alt:D,onError:function(e){P<10&&(C(!0),console.log("Image Retry",P),console.error(e),setTimeout(function(){h.current&&A(P+1)},4e3))},src:D,onLoad:function(e){if(h.current){C(!1);var t=e.target,a=t.naturalHeight,n=t.naturalWidth,o=Math.min(z/a,R/n);y({newWidth:o*n,newHeight:o*a,naturalWidth:n,naturalHeight:a,multiplier:o})}},style:{height:f.newHeight,width:f.newWidth}})),i&&r.a.createElement(U,null))}}},[[514,2,1]]]);
//# sourceMappingURL=main.a598322e.chunk.js.map