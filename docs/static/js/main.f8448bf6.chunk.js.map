{"version":3,"sources":["lib/sensors.js","components/PhotoSeries/views/tags/XYTagChip.style.js","components/PhotoSeries/views/tags/XYTagChip.jsx","components/PhotoSeries/views/tags/XYTagSelect.jsx","components/PhotoSeries/views/tags/XYTagSelect.style.js","components/PhotoSeries/views/tags/XYTagChooser.jsx","components/PhotoSeries/views/tags/XYTagChooser.style.js","components/PhotoSeries/views/tags/useXYTags.js","components/PhotoSeries/views/subViews/BrokenImg.jsx","components/PhotoSeries/views/subViews/Photo.jsx","components/PhotoSeries/views/subViews/Photo.style.js","config.js","lib/useComponentSize.js","lib/SeriesConfig.js","components/PhotoSeries/views/tags/TagChip.jsx","components/PhotoSeries/views/controls/ShortLongText.jsx","lib/Tags.js","components/maps/markers/Dot.jsx","components/maps/BaseStaticMap.jsx","components/maps/MapDot.jsx","mapStyles/index.js","components/maps/controls/StyleButtons.jsx","components/PhotoSeries/views/dialogs/BigText.jsx","components/PhotoSeries/views/dialogs/DeleteDialog.jsx","components/PhotoSeries/views/dialogs/BigTextEdit.jsx","components/PhotoSeries/views/controls/PhotoFadeSlider.jsx","lib/useCamera.js","components/PhotoSeries/views/controls/TagControl.style.js","components/PhotoSeries/views/controls/TagView.jsx","components/PhotoSeries/views/controls/DateControl.jsx","components/PhotoSeries/views/controls/TagControl.jsx","components/PhotoSeries/views/dialogs/TagEdit.jsx","components/PhotoSeries/views/controls/DateView.jsx","components/PhotoSeries/views/subViews/PhotoInfoInner.jsx","components/maps/markers/MyLocation.jsx","components/maps/controls/MyLocationButton.jsx","components/maps/BaseMap.jsx","components/PhotoSeries/views/dialogs/MapDirPicker.jsx","components/PhotoSeries/views/subViews/SeriesEditInner.jsx","components/PhotoSeries/views/subViews/SeriesEditInner.style.js","components/PhotoSeries/views/subViews/PhotoGrid.jsx","components/PhotoSeries/views/subViews/PhotoGrid.style.js","components/PhotoSeries/views/NewPhoto.jsx","lib/Photo.js","lib/Series.js","lib/datelib.js","lib/useFileInput.js","components/PhotoSeries/views/controls/LibraryFilePicker.jsx","components/PhotoSeries/views/NewPhotoInfo.jsx","components/PhotoSeries/views/NewPhotoInfo.style.js","components/PhotoSeries/views/PhotoReviewTool.jsx","components/PhotoSeries/views/PhotoReviewTool.style.js","components/PhotoSeries/views/CameraTool.jsx","components/PhotoSeries/views/CameraTool.style.js","components/PhotoSeries/contexts.js","lib/util.js","translations.js","graphql/queries.js","themes/index.js","contexts.js","components/auth/useAuthCommon.js","icons/AppLogo.jsx","components/auth/AuthContainer.jsx","components/auth/Loading.jsx","lib/ErrorBoundary.jsx","components/misc/ErrorScreen.jsx","graphql/mutations.js","graphql/Error.connect.js","lib/useGraphQL.js","components/auth/auth.style.js","components/auth/SignIn.jsx","components/auth/ConfirmSignIn.jsx","components/auth/RequireNewPassword.jsx","components/auth/SignUp.jsx","components/auth/ConfirmSignUp.jsx","components/auth/ForgotPassword.jsx","lib/useAuthentication.js","components/misc/InstallPrompt.jsx","lib/useShowAddToHome.js","lib/useResponsive.js","redux/actions.js","redux/reducers/map.js","redux/reducers/home.js","redux/reducers/uploader.js","redux/reducers/flags.js","redux/reducers/index.js","redux/storeConfig.js","redux/withReduxProvider.js","components/UploadControl.jsx","lib/s3upload.js","graphql/Uploader.connect.js","permissions.js","components/PhotoSeries/views/QRDisplay.jsx","icons/QRCode.jsx","components/PhotoSeries/views/controls/AddFab.jsx","components/PhotoSeries/views/controls/ContextMenu.jsx","components/PhotoSeries/views/subViews/SeriesInfo.jsx","components/PhotoSeries/views/subViews/SeriesInfo.style.js","components/PhotoSeries/views/subViews/SwipeShow.jsx","components/PhotoSeries/views/subViews/SwipeShow.style.js","components/PhotoSeries/views/SeriesView.style.js","components/PhotoSeries/views/SeriesView.jsx","components/PhotoSeries/views/SeriesEdit.jsx","components/PhotoSeries/views/SeriesEdit.style.js","components/PhotoSeries/views/Slideshow.jsx","components/PhotoSeries/views/Slideshow.style.js","components/PhotoSeries/views/dialogs/CancelConfirm.jsx","components/PhotoSeries/views/subViews/PhotoInfo.jsx","components/PhotoSeries/views/PhotoViewTool.jsx","components/PhotoSeries/views/PhotoViewTool.style.js","lib/AccessHelper.js","components/PhotoSeries/views/SeriesNotFound.jsx","components/PhotoSeries/views/SeriesLoading.jsx","components/PhotoSeries/index.jsx","lib/localdb.js","graphql/Series.connect.js","lib/useClusteredData.js","components/maps/HomeMap.style.js","icons/AppLogoSimple.jsx","components/SideDrawer.jsx","components/TopBar.jsx","components/Search/SearchInput.jsx","components/misc/SeriesListItem.jsx","components/misc/ClusterSelected.jsx","components/maps/markers/Single.jsx","components/maps/markers/Cluster.jsx","components/maps/HomeMap.jsx","graphql/Map.connect.js","components/Search/SearchContextItem.jsx","components/Search/SearchContextResults.jsx","components/Search/SearchEnder.jsx","components/Search/SearchResults.jsx","components/Search/SearchPlaceholder.jsx","lib/useOnline.js","components/Search/Search.jsx","graphql/Search.connect.js","components/MyProfile/MeCard.jsx","components/MyProfile/MyProfile.jsx","graphql/Profile.connect.js","components/MyFeed/FeedEnder.jsx","components/misc/FindOnMapButton.jsx","components/MyFeed/FeedItem.jsx","components/MyFeed/MyFeed.jsx","graphql/Feed.connect.js","components/PhotoSeries/views/QRReader.jsx","components/misc/OfflineBar.jsx","components/BottomBar.jsx","App.jsx","App.connect.js","serviceWorker.js","index.js"],"names":["useGeolocation","_useState","useState","accuracy","altitude","altitudeAccuracy","heading","latitude","longitude","speed","timestamp","Date","now","_useState2","Object","_Users_matt_Work_Git_PBR_PhotoMonitoring_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__","state","setState","mountedRef","useRef","watchIdRef","current","onEvent","event","coords","useEffect","navigator","geolocation","getCurrentPosition","watchPosition","clearWatch","useDeviceOrientation","_useState3","absolute","alpha","beta","gamma","_useState4","deviceOrientation","setDeviceOrientation","handleDeviceOrientation","window","addEventListener","removeEventListener","isIos","test","userAgent","vendor","opera","isPhone","a","substr","tagChips","useStyles","makeStyles","theme","xyTagChip","cursor","color","fontSize","background","height","position","left","top","editing","reversedChip","flexDirection","right","deleteIcon","width","chipAvatarIcon","chipAvatar","reversedDelete","margin","concat","chipBucket","display","reversedChipBucket","XYTagChip","_ref","edit","tag","newSize","onTagDragOver","onTagDragStop","onTagDelete","onNewTag","props","objectWithoutProperties","isReversed","relCoords","x","newWidth","classes","useTheme","stopBadness","e","preventDefault","stopPropagation","react_default","createElement","react_draggable_default","disabled","bounds","bottom","newHeight","y","onDrag","data","onStop","onClick","className","classNames","Chip","assign","style","palette","getContrastText","label","id","onDelete","Cancel_default","avatar","Avatar","MyLocation_default","root","noOptionsMessage","padding","spacing","singleValue","placeholder","input","valueContainer","flexWrap","flex","alignItems","overflow","paper","zIndex","marginTop","XYTagSelect","tagConfig","onChange","options","values","map","tc","value","console","log","allowAdditions","react_select_esm","components","Control","Menu","NoOptionsMessage","Option","Placeholder","ValueContainer","blurInputOnSelect","isClearable","isSearchable","Creatable_default","TextField","fullWidth","InputProps","inputComponent","inputProps","objectSpread","selectProps","inputRef","innerRef","children","innerProps","textFieldProps","_ref2","Typography","_ref3","Paper","square","_ref4","ref","_ref5","isFocused","isSelected","MenuItem","buttonRef","selected","component","fontWeight","_ref6","header","listItem","dlgBody","paddingLeft","paddingRight","paddingBottom","closeButton","grey","XYTagChooser","open","seriesConfig","onClose","xyTags","tags","filter","t","allowXY","Dialog","scroll","fullScreen","paperScrollPaper","aria-labelledby","DialogTitle","IconButton","Close_default","length","variant","tagType","idx","key","tags_XYTagSelect","useXYTags","photo","setResizeActive","useContext","SeriesContext","slicedToArray","isDragging","setIsDragging","newTagDialog","setNewTagDialog","tagClass","Tags","addTag","__isNew__","createNewXYTagObj","createExistingXYTagObj","toConsumableArray","updateTagLocation","oldTag","newX","parseInt","multiplier","newY","onAddTagTrigger","pageX","innerWidth","pageY","innerHeight","TagChooser","tags_XYTagChooser","Boolean","getRelXYTags","flexGrow","opacity","textAlign","icon","primary","secondary","BrokenImg","BrokenImage_default","inner","transform","img","brokenImg","formControl","Photo","showTags","transition","refImgWrap","setNewSize","url","setUrl","_useState5","_useState6","broken","setBroken","_useState7","_useState8","urlRetryCounter","setURLRetryCounter","base64","newUrl","getPhotoUrl","getURL","_useComponentSize","useComponentSize","_useComponentSize$siz","size","urlWithRetries","_useXYTags","tags_XYTagChip","subViews_BrokenImg","alt","onError","err","error","setTimeout","src","onLoad","_event$target","target","naturalHeight","naturalWidth","Math","min","__webpack_require__","d","__webpack_exports__","mapConfig","home","endpoints","localDb","aws","ACCESS","_mapStyles__WEBPACK_IMPORTED_MODULE_0__","_material_ui_core_colors__WEBPACK_IMPORTED_MODULE_1__","_material_ui_core_colors__WEBPACK_IMPORTED_MODULE_2__","_material_ui_core_colors__WEBPACK_IMPORTED_MODULE_3__","tagColors","mapBoxToken","process","styles","MapStyles","baseurl","REACT_APP_BASEURL","AppStateTypes","FEED","MAP","SEARCH","PROFILE","SERIES","QRCAPTURE","NEW_SERIES_CAMERA","NEW_SERIES_LIBRARY","SEARCH_TABS","TAG","LOCATION","USER","MapModeTypes","FREE","graphql","imgStore","Auth","region","userPoolId","userPoolWebClientId","mandatorySignIn","cookieStorage","domain","expires","secure","OPEN","description","green","PRIVATE","red","PUBLIC","blue","getSize","el","minSize","defaultSize","max","offsetWidth","offsetHeight","resizeActiveRef","resizeActive","setComponentSize","handleResize","handleResizeDebounced","useCallback","debounce","useLayoutEffect","ResizeObserver","resizeObserver","observe","disconnect","TYPES","SeriesConfig","_this","this","_Users_matt_Work_Git_PBR_PhotoMonitoring_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_2__","getTagType","typeId","config","find","tt","getTagTypeIndex","findIndex","getXYTagTypes","getNonXYTagTypes","allowNonXY","getSeriesMeta","keys","meta","type","reduce","acc","_Users_matt_Work_Git_PBR_PhotoMonitoring_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_1__","_Users_matt_Work_Git_PBR_PhotoMonitoring_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__","default","getPhotoMeta","Error","marginRight","TagChip","_Users_matt_Work_Git_PBR_PhotoMonitoring_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_0__","react__WEBPACK_IMPORTED_MODULE_1___default","_material_ui_core_Chip__WEBPACK_IMPORTED_MODULE_2__","_material_ui_icons_Cancel__WEBPACK_IMPORTED_MODULE_3___default","react__WEBPACK_IMPORTED_MODULE_0__","react__WEBPACK_IMPORTED_MODULE_0___default","n","classnames__WEBPACK_IMPORTED_MODULE_1__","classnames__WEBPACK_IMPORTED_MODULE_1___default","_material_ui_core_Typography__WEBPACK_IMPORTED_MODULE_2__","_material_ui_core_FormLabel__WEBPACK_IMPORTED_MODULE_3__","_material_ui_core_styles__WEBPACK_IMPORTED_MODULE_4__","whiteSpace","&::before","content","ShortLongText","text","formLabel","defaultProps","_Users_matt_Work_Git_PBR_PhotoMonitoring_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_1__","findTagById","tagId","getXYTags","xyTagIds","indexOf","getNonXYTags","NonXYTagIds","createNewTagObj","uuid","createExistingTagObj","_Users_matt_Work_Git_PBR_PhotoMonitoring_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_0__","group","main","transformOrigin","rootActive","svgDot","dot","stroke","contrastText","strokeWidth","fill","directionIndicator","name","textShadow","nameActive","dark","Single","direction","version","viewBox","cx","cy","r","svgArc","fillOpacity","strokeOpacity","BaseStaticMap","controlPadding","viewport","mapStyles","onMapDataEvent","passthroughProps","mapRef","currStyle","setCurrStyle","projection","setProjection","recalcProjection","getDistanceScales","useMemo","esm","mapStyle","onData","mapboxApiAccessToken","StyleButtons","Array","isArray","c","handleChild","child","stylechooser","initStyle","MapDot","staticMap","editable","Map","BaseMap","mapProps","touchRotate","dragRotate","showMe","lockPan","onViewportChange","Dot","_Satellite_json__WEBPACK_IMPORTED_MODULE_0__","_TopoMap_json__WEBPACK_IMPORTED_MODULE_1__","_material_ui_icons__WEBPACK_IMPORTED_MODULE_2__","_material_ui_icons__WEBPACK_IMPORTED_MODULE_3__","_material_ui_icons__WEBPACK_IMPORTED_MODULE_4__","_material_ui_icons__WEBPACK_IMPORTED_MODULE_5__","toolTip","Icon","SatelliteOutlined","ActiveIcon","SatIcon","Satellite","TerrainOutlined","Terrain","TopoMap","speedDialFab","border","speedDialAction","marginBottom","speedDialIcon","speedDialLabel","actionsClosed","setOpen","noEventSetOpen","_material_ui_lab_SpeedDial__WEBPACK_IMPORTED_MODULE_2__","ariaLabel","speedDial","fab","_material_ui_lab_SpeedDialAction__WEBPACK_IMPORTED_MODULE_3__","tooltipPlacement","ButtonProps","TooltipClasses","tooltip","tooltipTitle","tooltipOpen","_material_ui_core_Typography__WEBPACK_IMPORTED_MODULE_1__","_material_ui_core_DialogContent__WEBPACK_IMPORTED_MODULE_2__","_material_ui_core_Dialog__WEBPACK_IMPORTED_MODULE_3__","_material_ui_core_IconButton__WEBPACK_IMPORTED_MODULE_4__","_material_ui_core_DialogTitle__WEBPACK_IMPORTED_MODULE_5__","_material_ui_icons_Close__WEBPACK_IMPORTED_MODULE_6__","_material_ui_icons_Close__WEBPACK_IMPORTED_MODULE_6___default","_material_ui_core_styles__WEBPACK_IMPORTED_MODULE_7__","body","title","alignSelf","dlgTitle","BigText","maxWidth","disableTypography","_material_ui_core_Dialog__WEBPACK_IMPORTED_MODULE_1__","_material_ui_core_DialogTitle__WEBPACK_IMPORTED_MODULE_2__","_material_ui_core_DialogContent__WEBPACK_IMPORTED_MODULE_3__","_material_ui_core_Button__WEBPACK_IMPORTED_MODULE_4__","_material_ui_core_Typography__WEBPACK_IMPORTED_MODULE_5__","_material_ui_core_DialogActions__WEBPACK_IMPORTED_MODULE_6__","DeleteDialog","message","onConfirm","disableBackdropClick","disableEscapeKeyDown","BigTextEdit","onOk","multiline","setValue","_material_ui_core_DialogTitle__WEBPACK_IMPORTED_MODULE_7__","_material_ui_core_TextField__WEBPACK_IMPORTED_MODULE_5__","rows","rowsMax","defaultValue","_material_ui_core_DialogActions__WEBPACK_IMPORTED_MODULE_4__","_material_ui_core_Button__WEBPACK_IMPORTED_MODULE_6__","sliderLabel","vertical","rail","boxShadow","track","thumb","marginLeft","PhotoFadeSlider","slider","setSlider","_material_ui_lab_Slider__WEBPACK_IMPORTED_MODULE_3__","orientation","useCamera","onCapture","_Users_matt_Work_Git_PBR_PhotoMonitoring_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_4__","cameraError","setCameraError","cameraOnline","setCameraOnline","camRef","Webcam","document","getElementById","setup","then","catch","captureImage","capturedData","takeBase64Photo","quality","captureRawData","takeImageData","webcamElement","canvasElement","location","protocol","hostname","warn","mediaDevices","getUserMedia","aspectRatio","srcObject","getTracks","stop","Promise","resolve","reject","undefined","audio","video","facingMode","mediaStream","URL","createObjectURL","onloadedmetadata","play","onplaying","imageWidth","videoWidth","imageHeight","videoHeight","context","getContext","drawImage","_this$_drawImage","_drawImage","getImageData","_this2","_this$_drawImage2","toBlob","blob","arguments","_this$_drawImage3","toDataURL","TagControl_style","tagContainer","actionButtons","TagControl","tagValues","fieldTitle","rootEdit","textBody","DateControl","hint","timestampToHTML5Input","textField","HTML5InputToTimestamp","controls_TagControl","onSelectChange","inputValue","action","removedValue","option","val","newVal","tcv","newCreateVal","v","selectOptions","remainingTags","deleteRemoves","isMulti","onMouseDown","onTouchEnd","_ref7","_ref8","_ref9","dlgContent","overflowY","TagEdit","onCancel","DialogContent","field","DialogActions","Button","DateView","formatDate","dlgTitleContainer","catTagTitle","paddingTop","DIALOGS","PhotoInfo","canEdit","delta","_useState2$","activeDialog","activeDialogContext","setActiveDialog","tagInst","TagClass","metaKeys","JSON","parse","controls_DateControl","takenOn","controls_DateView","note","Divider","TagView","Fragment","List","list","ListItem","ListItemText","render","dialogs_TagEdit","svgAccuracyDot","MyLocation","accHeight","pixelsPerMeter","accWidth","MyLocationButton","Fab","aria-label","initViewport","lockToBounds","incomingOnViewportChange","incomingOnTransitionStart","onTransitionStart","incomingOnTransitionEnd","onTransitionEnd","transitions","mapContainerRef","mapBoxRef","innerTransitionsRef","defaultViewVals","setViewport","isTransitioning","setIsTransitioning","myPosition","geoMarker","markers_MyLocation","zoom","viewportChange","newViewport","getMap","_bounds","minlng","minlat","maxlng","maxlat","_fitBounds","WebMercatorViewport","fitBounds","offset","dragPan","React","cloneElement","hideNavControls","showZoom","touchZoom","scrollZoom","showCompass","controls_MyLocationButton","transitionDuration","transitionInterpolator","FlyToInterpolator","transitionEasing","easeCubic","bearing","pitch","mapWrapper","sliderWrapper","sliderRoor","MapDirPicker","initLat","initLong","initDir","setCoords","setRotation","_ref2$viewport","FormLabel","mapFormLabel","Slider","container","step","access","accessRadio","grow","mapInnerWrap","minHeight","minWidth","chips","SeriesEditInner","series","FormControlLabel","control","Switch","checked","dialogs_MapDirPicker","newNote","tile","addFab","notDeleteable","unSelectedTile","& img","selectedTile","snackbarContent","backgroundColor","snackbar","PhotoGrid","photos","columns","multiSelect","onTileClick","selectMode","setSelectMode","selectedItems","setSelectedItems","deleteConfirm","setDeleteConfirm","_useContext","ac","handleCancelSelection","toggleListItem","remaining","arrId","sortedPhotos","sort","b","GridList","cols","cellHeight","canDelete","canUser","photoUrl","GridListTile","handlePhotoTap","handleAddToSelection","Remove_default","Add_default","GridListTileBar","Snackbar","autoHideDuration","ContentProps","aria-describedby","confirmation","MODES","NewPhoto","inputMethod","onCreate","isNewSeries","_Users_matt_Work_Git_PBR_PhotoMonitoring_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_2__","newPhoto","setNewPhoto","SeriesClass","newSeries","setNewSeries","photoRefId","setPhotoRefId","history","mode","_changeMode","geo","changeMode","newModeName","_Users_matt_Work_Git_PBR_PhotoMonitoring_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__","react__WEBPACK_IMPORTED_MODULE_3___default","_CameraTool__WEBPACK_IMPORTED_MODULE_7__","onShutter","refId","photoInitObj","PhotoClass","exif","foundIdx","newData","slice","parser","exifParser","create","Buffer","from","stringify","rawData","orient","geolocate","_controls_LibraryFilePicker__WEBPACK_IMPORTED_MODULE_9__","onLibraryAdd","date","String","DateTimeOriginal","GPSLatitude","isNumeric","GPSLongitude","fullNewPhotoObject","_PhotoReviewTool__WEBPACK_IMPORTED_MODULE_6__","defaultRefPhotoId","captured","onRetry","oldHistory","oldMode","pop","_NewPhotoInfo__WEBPACK_IMPORTED_MODULE_8__","onSave","_Users_matt_Work_Git_PBR_PhotoMonitoring_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__","setMeta","convertJSDatetoTimestamp","Series","formatDatAgo","moment__WEBPACK_IMPORTED_MODULE_0__","moment__WEBPACK_IMPORTED_MODULE_0___default","utctimestamp","format","moment","fromNow","jsDate","utc","isoStr","useFileInput","clickRef","element","handleChange","evt","file","files","reader","FileReader","onload","result","readAsDataURL","click","fileClickEl","forceClick","button","LibraryFilePicker","_useFileInput","PhotoLibrary_default","NewPhotoInfo","seriesDelta","setSeriesDelta","photoDelta","setPhotoDelta","CssBaseline","PhotoInfoInner","newAttr","capturedContainer","referenceContainer","reference","referenceTextContainer","newText","refText","PhotoReviewTool","newRefPhoto","p","refPhoto","cameraErrorText","disabledFab","cameraFab","@media (orientation: landscape)","@media (orientation: portrait)","cameraIcon","cancelFab","cancelIcon","swipeDrawer","libraryFab","myLocationFab","myLocationIcon","CameraTool","setRefPhoto","drawerOpen","setDrawerOpen","_useCamera","autoPlay","playsInline","muted","buttonFab","Camera_default","libraryIcon","SwipeableDrawer","anchor","paperAnchorLeft","onOpen","tabIndex","swipeDrawerContainer","role","onKeyDown","createContext","num","isNaN","parseFloat","isFinite","func","wait","immediate","timeout","_len","innerArgs","_key","callNow","clearTimeout","apply","addLocaleData","frLocaleData","IntlWrapper","index_es","locale","allSeries","gql","_templateObject","pollQuery","_templateObject2","userSeries","_templateObject3","seriesFromList","_templateObject4","seriesWithTag","_templateObject5","tagSearch","_templateObject6","getUser","_templateObject7","_templateObject8","geocode","_templateObject9","getMyFeed","_templateObject10","userSearch","_templateObject11","getWholeSeries","_templateObject12","typography","useNextVariants","colors","fade","lighten","topbar","bottombar","login","themes","createMuiTheme","AppContext","useAuthCommon","containerRef","handleKeyPress","found","getElementsByClassName","createSvgIcon","bgSwoosh","logo","AuthContainer","ThemeProvider","AppLogo","Loading","auth_AuthContainer","ErrorBoundary","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","hasError","info","_this$state","FallbackUI","fallback","Component","SEND_STATES","spacer","stack","fontFamily","ErrorScreen","sendState","reportError","dlgOpen","setDialogOpen","setNote","stackEl","buttonText","Error_default","BugReport_default","DialogContentText","autoFocus","deletePhoto","mutations_templateObject","deleteSeries","mutations_templateObject2","updateSeries","mutations_templateObject3","updatePhoto","mutations_templateObject4","createPhoto","mutations_templateObject5","createSeries","mutations_templateObject6","watchSeries","mutations_templateObject7","unWatchSeries","mutations_templateObject8","reportBug","mutations_templateObject9","withReportBugMutation","mutate","_ref$ownProps","ownProps","reduxState","reportJSON","errObj","env","toString","variables","update","store","connect","other","uploader","newMap","Wrapped","Amplify","configure","LOCAL_STORAGE_TOKEN","useGraphQL","createApolloClient","getCurrentToken","asyncToGenerator","regenerator_default","mark","_callee","currSession","wrap","_context","prev","next","currentSession","sent","abrupt","accessToken","jwtToken","t0","cache","InMemoryCache","authLink","setContext","_callee2","_","headers","token","newHeaders","_context2","authorization","_x","_x2","httpLink","createHttpLink","uri","ApolloClient","link","ApolloLink","tokenName","connectToDevTools","auth_style","forgotPassword","switch","switchButton","&:last-child","borderRadius","&:first-child","phoneNumInner","phoneNumDropdown","warnText","fontStyle","noSignin","SignIn","loading","handleSignup","handleForgotPassword","federated","handleInputChange","handleBeAnonymous","handleSignIn","autoComplete","Link","Toolbar","disableGutters","ConfirmSignIn","handleBack","handleConfirm","RequireNewPassword","change","requiredAttributes","placeholders","attribute","SignUp","signUpFields","signUpFieldLabels","signUpFieldPlaceholders","countryDialCodes","defaultDialCode","selectVal","setSelectVal","handleDialCodeChange","f","FormControl","InputLabel","htmlFor","shrink","required","Select","dialCode","ConfirmSignUp","handleResend","resendCode","ForgotPassword","handleSubmit","handleSendCode","setSent","defaultAuthState","authState","authData","signedIn","useAuthentication","setAuth","authScreen","dist","onStateChange","hideDefault","useAuthentication_SignIn","useAuthentication_Loading","useAuthentication_RequireNewPassword","useAuthentication_ConfirmSignIn","useAuthentication_ConfirmSignUp","useAuthentication_ForgotPassword","useAuthentication_SignUp","isGod","signInUserSession","idToken","payload","signOut","forceSignIn","newProps","changeState","signIn","auth_SignIn","SignInOrig","hide","includes","checkCustomSignUpFields","signUpConfig","sortFields","getDefaultDialCode","I18n","get","signUp","auth_SignUp","SignUpOrig","_this3","confirm","auth_ConfirmSignIn","ConfirmSignInOrig","_this4","resend","auth_ConfirmSignUp","ConfirmSignUpOrig","challengeParam","split","part","charAt","toUpperCase","toLowerCase","join","auth_RequireNewPassword","RequireNewPasswordOrig","auth_Loading","LoadingOrig","_this5","send","submit","auth_ForgotPassword","ForgotPasswordOrig","messageWrapper","animation","@keyframes installPulse","0%","50%","100%","textWrapper","buttons","InstallPrompt","onInstall","anchorOrigin","horizontal","elevation","paragraph","useShowAddToHome","showInstall","dismissInstall","deferredPrompt","setPrompt","handleBeforePrompt","installPrompt","misc_InstallPrompt","addToHomeScreen","prompt","userChoice","choiceResult","outcome","standalone","getState","_window","_window$screen","screen","wOrient","bIsIos","windowSize","screenSize","useResponsive","mediQueries","newState","Actions","actions","newDomain","params","seriesId","initialPhoto","flagName","flagVal","viewportSave","uploadObj","newProgress","mapInit","homeInit","initState","activeUpload","defaultFlags","iOSWarning","install","useLoggedOut","combineReducers","newStateHistory","newCurrentState","activeSeries","newParams","newHistory","newStore","newActive","flags","defineProperty","persistConfig","storage","persistedReducer","persistReducer","rootReducer","storeConfig","preloadedState","createStore","compose","applyMiddleware","thunk","persistor","persistStore","withReduxProvider","BaseComponent","_storeConfig","es","integration_react","msgText","messageInner","UploadControl","progress","LinearProgress","UploadControlCOSMOSWrapper","useWrapperStyles","displayName","updateUploadProgress","completeActiveUpload","formData","FormData","preAuth","fields","forEach","fieldkey","append","dataURLtoFile","Content-Type","onUploadProgress","progressEvent","loaded","total","floor","axios","post","dataurl","filename","arr","mime","match","bstr","atob","u8arr","Uint8Array","charCodeAt","File","interceptors","request","use","response","dispatch","uploadingRef","_x3","_doUpload","s3Upload","components_UploadControl","permissions","admin","create:own","read:any","update:any","delete:any","create:any","nonuser","series_public","series_open","user","read:own","update:own","delete:own","qrPaper","qrCode","QRDisplay","qrCodeEl","setQRCodeEl","obj","encodedId","encodeURI","QRCode","svgStr","dangerouslySetInnerHTML","__html","pulseCol","light","animationIterationCount","animationTimingFunction","@keyframes fabPulse","90%","directionUp","AddFab","onCameraClick","onLibraryClick","down","setDown","downRef","onDown","currentTarget","block","rootContainer","SpeedDial","onBlur","onTouchStart","SpeedDialAction","AddAPhoto_default","ContextMenu","anchorEl","menuItems","divider","ListItemIcon","primaryTypographyProps","tagListItem","chip","SeriesInfo","seriesConfigInst","SeriesConfigClass","newTags","existing","count","tagKey","idtk","subheading","photoWrapper","dateCaption","mobileStepper","manualBack","manualForward","tagButton","slideshowButton","dots","SwipeShow","onImageSelect","initPhotoIndex","activePhoto","setActivePhoto","setShowTags","singular","react_swipeable_views_lib_default","axis","index","onChangeIndex","enableMouseEvents","KeyboardArrowRight_default","KeyboardArrowLeft_default","subtitle","actionIcon","Badge","badgeContent","Label_default","MobileStepper","steps","activeStep","isFullScreen","slides","SeriesView_style","appBar","-webkit-overflow-scrolling","tabMenu","mapWrap","toolbarTitle","textOverflow","gridList","titleBar","menuButton","placeholderInner","progressWrapper","placeholderText","SeriesView","onSlideshowStart","onEditSeries","onDeletePhotos","onCameraAdd","onDeleteSeries","onMenuBack","onWatch","onUnWatch","watching","owned","contextEl","setContextEl","showQR","setShowQR","can","delete","contribute","listTypeTab","setListTypeTab","AppBar","ArrowBack_default","aria-haspopup","MoreVert_default","controls_ContextMenu","AddAlertIcon","QRCodeIcon","SlideshowIcon","EditIcon","DeleteIcon","Tabs","Tab","subViews_SwipeShow","subViews_SeriesInfo","controls_AddFab","views_QRDisplay","SeriesEdit","setDelta","swipeAble","slideContainer","slide","dotActive","iconButton","active","last","labelBadge","tagChip","Slideshow","_useStepper","useStepper","lastStep","handleForward","paused","pause","showXYTags","setShowXYTags","duration","titlePosition","PlayCircleFilled_default","PauseCircleFilled_default","nextButton","backButton","interval","setActiveStep","setPaused","setLastStep","timerRef","createTimer","setInterval","oldStep","destroyTimer","clearInterval","CancelConfirm","dirty","newDelta","dialogs_CancelConfirm","appBarEdit","tipChip","activeButton","STATES","PhotoViewTool","initPhotoId","onUpdatePhoto","setMode","tagsClass","desired","onCommitTags","infoButton","Info_default","containerStyle","photoidx","subViews_PhotoInfo","AccessHelper","userSub","permissionObj","ownOrAny","createdUser","isOwner","attrs","ownAny","perm","otherPerm","attributes","granted","AccessControl","sub","SeriesNotFound","SeriesLoading","CircularProgress","thickness","VIEW_ONLY_MODES","RepeatablePhotos","modeName","inputMethodINIT","currentUserId","currentUserRole","accessControl","onNewSeries","onChangePhoto","onNewPhoto","onDeletePhoto","AccesHelper","seriesState","pid","ph","onApprovePhoto","onCreateSeries","onNewSeriesReturn","newPid","newInputMethod","canUpdate","to","lastMode","views_SeriesLoading","views_SeriesNotFound","views_SeriesView","photoIdArr","sp","views_SeriesEdit","views_PhotoViewTool","views_Slideshow","contexts","Provider","localUUID","openDb","upgradeDB","createObjectStore","prefix","uuidv4","withGetSelectedQuery","skip","withUpdateSeriesMutation","_ref10","updateSeriesMutation","sanitizeUpdateParams","optimisticResponse","__typename","_ref11","qdata","readQuery","query","writeQuery","qdataAll","limit","summary","seriesSummaries","s","withUpdatePhotoMutation","_ref12","updatePhotoMutation","sanitizedPhotoDelta","newT","_ref13","updatedPhoto","withDeleteSeriesDeleteMutation","_ref14","deleteSeriesMutation","_ref15","withDeletePhotoMutation","_ref16","deletePhotoMutation","photoId","_ref17","finalCount","photoCount","withCreateNewSeries","_ref18","createSeriesMutation","featured","_ref19","newAllSeriesEntry","push","withCreateNewPhoto","_ref20","createPhotoMutation","ext","newPhotoInput","createdOn","username","Username","updatedBy","updatedOn","paths","large","orig","medium","_ref21","withWatchSeriesMutation","_ref22","watchSeriesMutation","_ref23","Set","qFeedData","withUnWatchSeriesMutation","_ref24","unWatchSeriesMutation","_ref25","sid","connectedWithApollo","onAfterSeriesDelete","onBack","queueUpload","doneCreatingSeries","currentUser","PhotoSeries","photoNoId","photoData","_state$home$current","inputObj","desiredParams","newDesiredParams","remainder","useClusteredData","filterBounds","currentZoom","sizeScale","queryVersion","clusteredData","setClusteredData","single","cluster","filteredData","setFilteredData","setVersion","updateDataDebounce","updatedData","_args","updateData","filterDataDebounce","filtered","_args2","filterData","filteredClusteredData","tree","rbush","screenCoords","project","properties","zoomLevels","geoJSON","point","clear","load","_loop","z","radius","sqrt","pow","neighbors","search","minX","minY","maxX","maxY","neighbor","newGeoJSON","centroid","featureCollection","reducedPhotoCount","points","newZ","geometry","coordinates","drawerInner","gravatarImg","fullList","SideDrawer","onQRClick","gravatar","AccountCircle_default","loginButton","CloudDownload_default","ExitToApp_default","borderBottom","searchIcon","transparent","transparentLogo","transparentLogoIcon","qrButton","qrButtonTransparent","TopBar","isTransparent","hideLogo","AppLogoSimple","components_SideDrawer","components_TopBar","TopBar_TopBar","useSearchBarStyles","shape","common","white","&:hover","breakpoints","up","inputRoot","inputInput","pointerEvents","justifyContent","SearchInput","debounceSearchText","blur","Search_default","InputBase","chipContainer","accessLabel","accessPUBLIC","accessPRIVATE","accessOPEN","verticalAlign","objectFit","titleText","dateContainer","dateLabel","dateText","imgFiller","imgContainer","SeriesListItem","showCreatedOn","showLastPhoto","latest","misc_SeriesListItem","ClusterSelected","seriesCount","onZoomTo","ZoomOutMap_default","&.PUBLIC","&.PRIVATE","&.OPEN","avatarActive","badge","badgeActive","Cluster","numeral","& .myPosMarker","& .singleMarker","& .clusterMarker","topBar","loadingWrapper","zoomOutFab","selectedPopup","defaultView","HomeMap","seriesList","onSeriesClick","onSearchClick","pushMapHistory","popMapHistory","clearMapHistory","mapViewObj","setMapViewObj","mapViewRef","homeMapContainerRef","setCurrentZoom","setTransitions","_useState9","_useState10","selectedItem","setSelectedItem","bufferPts","buffer","units","bbox","updateSelectedItem","item","saveMap","object","pts","lngBuff","latBuff","buffBounds","onMarkerClick","LinearInterpolator","markersRendered","offsetLeft","offsetTop","markers_Single","markers_Cluster","selectedItemRender","misc_ClusterSelected","Search_SearchInput","maxZoom","minZoom","viewZoom","getBounds","_map$getBounds","_map$getBounds$_sw","_sw","minLng","lng","minLat","lat","_map$getBounds$_ne","_ne","maxLng","maxLat","oldMinLng","oldMinLat","oldMaxLng","oldMaxLat","onNativeClick","POLL_INTERVAL","withAllSeries","nextToken","fetchMore","updateQuery","fetchMoreResult","setSeriesProps","readyForPolling","withPollQuery","lastCheck","_ref5$ownProps","seriesProps","updateIncrement","changedSeries","oldList","newSeriesSummaries","seriesStatus","polledSeries","ds","oldSeries","oldId","AllSeriesConnect","PollQueryConnect","mapFuncs","tab","setLastCheck","allSeriesQUERY","pollSeriesQUERY","maps_HomeMap","chosenItem","closeIcon","avatarImg","SearchContextItem","TheIcon","PlaceIcon","LabelIcon","PersonIcon","ListItemAvatar","Search_SearchContextItem","overflowX","listSection","ul","SearchContextResults","contextResults","setContextChoice","cr","SearchEnder","ctxItem","SearchResults","contextChoice","onResultClick","listRef","enderRef","handleScroll","_listRef$current","scrollTop","Search_SearchEnder","subheader","onScroll","SearchPlaceholder","PlaceholderIcon","useOnline","setOnline","setOffline","newDate","online","since","TABS","tabs","ListWrapper","Search","currentTab","setCurrentTab","defaultText","searchText","setSearchText","searchResults","onMapClick","Search_SearchResults","Search_SearchContextResults","Search_SearchPlaceholder","PortableWifiOffIcon","indicatorColor","flexContainer","centered","TAGS","withTagSearch","ceil","withUserSearch","searchStr","withGeoCode","geocoder","relevance","placeName","center","withTagSeries","tagSeries","withUserSeries","createdBy","defaultTab","jumpToSeries","jumpToMap","bboxFunc","withContextQuery","withSearchQuery","ComposedSearch","newContextChoice","newTab","MeCard","onAvatarClick","filterContainer","filterChip","seriesListItemWrap","noneFound","SORT","MyProfile","mySeries","watchingSeries","sortVal","setSort","sortAsc","setSortAsc","sortSetter","newSort","tabFeed","firstname","MyProfile_MeCard","MyProfile_FilterSortItem","asc","useFilterStyles","FilterSortItem","arrow","withuserSeriesQuery","seriesQ","withMyWatchedSeriesQuery","watchedSeriesQ","queryWrapped","arraySeries","components_MyProfile_MyProfile","FeedEnder","placeAvatar","placeIcon","FindOnMapButton","Place_default","findOnMapButtonContainer","titleContainer","seriesName","EVENT_VERBS","FeedItem","onImageClick","onProfileClick","misc_FindOnMapButton","listContainer","vList","feedContainer","MyFeed","events","fetchNewest","dist_es","rowCount","rowHeight","rowRenderer","isScrolling","isVisible","parent","row","MyFeed_FeedItem","wEnd","MyFeed_FeedEnder","almostAtEnd","ROWHEIGHT","withFeedQuery","loadingNewest","loadingMore","start","myFeed","feed","end","jumpToUser","components_MyFeed_MyFeed","qrIcon","tipPaper","docContainer","cameraContainer","snackErr","snackSuccess","snackMsg","QRReader","capturedImg","setCapturedImg","setErr","code","setCode","captureFunc","scannedCode","decodedUrl","jsQRFromBase64","decodeURI","t1","scan","SnackbarContent","jsQR","OfflineBar","_useOnline","sinceStr","setSinceStr","calcSinceStr","clearTimer","homeConfig","borderTop","BottomBar","onHomeClick","edge","HomeOutlined_default","MapOutlined_default","SearchOutlined_default","PersonOutline_default","offlineBar","activeWrapper","flexShrink","uploaderContainer","App","onQRCapture","setHomeState","showBottomBar","activeProps","ActiveComponent","FeedConnect","MapConnect","ProfileConnect","SearchConnect","SeriesConnect","misc_OfflineBar","components_BottomBar","Uploader_connect","setUseOffline","bVal","_useAuthentication","apolloClient","_useShowAddToHome","responsive","appContext","getValues","base","react_apollo_esm","client","translations_IntlWrapper","lib_ErrorBoundary","ErrorConnect","isLocalhost","registerValidSW","swUrl","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","onUpdate","onSuccess","require","ReactDOM","App_connect","href","origin","fetch","contentType","status","ready","unregister","reload","checkValidServiceWorker"],"mappings":"4OAEaA,EAAiB,WAAM,IAAAC,EACRC,mBAAS,CACjCC,SAAU,KACVC,SAAU,KACVC,iBAAkB,KAClBC,QAAS,KACTC,SAAU,KACVC,UAAW,KACXC,MAAO,KACPC,UAAWC,KAAKC,QATgBC,EAAAC,OAAAC,EAAA,EAAAD,CAAAb,EAAA,GAC3Be,EAD2BH,EAAA,GACpBI,EADoBJ,EAAA,GAW5BK,EAAaC,mBACbC,EAAaD,mBACnBD,EAAWG,SAAU,EAErB,IAAMC,EAAU,SAAAC,GACVL,EAAWG,SACbJ,EAAS,CACPd,SAAUoB,EAAMC,OAAOrB,SACvBC,SAAUmB,EAAMC,OAAOpB,SACvBC,iBAAkBkB,EAAMC,OAAOnB,iBAC/BC,QAASiB,EAAMC,OAAOlB,QACtBC,SAAUgB,EAAMC,OAAOjB,SACvBC,UAAWe,EAAMC,OAAOhB,UACxBC,MAAOc,EAAMC,OAAOf,MACpBC,UAAWa,EAAMb,aAevB,OAVAe,oBAAU,WAIR,OAHAC,UAAUC,YAAYC,mBAAmBN,GACzCF,EAAWC,QAAUK,UAAUC,YAAYE,cAAcP,GAElD,WACLJ,EAAWG,SAAU,EACrBK,UAAUC,YAAYG,WAAWV,EAAWC,WAE7C,CAACK,UAAUC,cAEPX,GAGF,SAASe,IAAwB,IAAAC,EACY9B,mBAAS,CAAE+B,UAAU,EAAOC,MAAO,KAAMC,KAAM,KAAMC,MAAO,OADxEC,EAAAvB,OAAAC,EAAA,EAAAD,CAAAkB,EAAA,GAC/BM,EAD+BD,EAAA,GACZE,EADYF,EAAA,GAGtC,SAASG,EAAyBjB,GAChCgB,EAAqB,CACnBN,SAAUV,EAAMU,SAChBC,MAAOX,EAAMW,MACbC,KAAMZ,EAAMY,KACZC,MAAOb,EAAMa,QAYjB,OARAX,oBAAU,WAGR,OAFAgB,OAAOC,iBAAiB,oBAAqBF,GAAyB,GAE/D,WACLC,OAAOE,oBAAoB,oBAAqBH,KAEjD,IAEIF,EASF,IAAMM,EAAQ,WACnB,MAAO,oBAAoBC,KAAKJ,OAAOf,UAAUoB,WAAapB,UAAUqB,QAAUN,OAAOO,OAAS,KAGvFC,EAAU,WACrB,IAAMC,EAAKT,OAAOf,UAAUoB,WAAapB,UAAUqB,QAAUN,OAAOO,OAAS,GAC7E,MAAO,2TACJH,KAAKK,IACR,4hDACGL,KAAKK,EAAEC,OAAO,EAAG,uMCnFhBC,EACI,GCaJC,EAAYC,YDVH,SAAAC,GAAK,MAAK,CACvBC,UAAW,CACTC,OAAQ,UACRC,MAAO,QACPC,SAAU,QACVC,WAAY,UACZC,OAAQT,EACRU,SAAU,WACVC,MAAOX,EAAkB,EACzBY,KAAMZ,EAAkB,GAE1Ba,QAAS,GAKTC,aAAc,CACZC,cAAe,cACfJ,KAAM,QACNK,OAAQhB,EAAkB,GAE5BiB,WAAY,CAEVC,MAAOlB,EAAkB,EACzBS,OAAQT,EAAkB,GAE5BmB,eAAgB,CACdb,MAAO,QACPY,MAAOlB,EAAkB,EACzBS,OAAQT,EAAkB,GAE5BoB,WAAY,CACVZ,WAAY,UACZU,MAAOlB,EACPS,OAAQT,GAEVqB,eAAgB,CACdC,OAAM,MAAAC,OAAQvB,EAAkB,EAA1B,SAAAuB,OAAmCvB,EAAkB,EAArD,OAIRwB,WAAY,CACVN,MAAO,EACPT,OAAQ,EACRgB,QAAS,OACTV,cAAe,MACfL,SAAU,YAEZgB,mBAAoB,CAClBX,cAAe,kBCgCJY,EArEG,SAAAC,GAGZ,IAFJtB,EAEIsB,EAFJtB,MAAOuB,EAEHD,EAFGC,KAAMC,EAETF,EAFSE,IAAKC,EAEdH,EAFcG,QAClBC,EACIJ,EADJI,cAAeC,EACXL,EADWK,cAAyBC,GACpCN,EAD0BO,SAC1BP,EADoCM,aAAgBE,EACpD1E,OAAA2E,EAAA,EAAA3E,CAAAkE,EAAA,2FACEU,EAAaR,EAAIS,UAAUC,EAAIT,EAAQU,SAAW,EAClDC,EAAUzC,IACVE,EAAQwC,cACRC,EAAc,SAACC,GACnBA,EAAEC,iBACFD,EAAEE,mBAaJ,OACEC,EAAAlD,EAAAmD,cAACC,EAAApD,EAAD,CACEqD,UAAWtB,EACXuB,OAAQ,CAAEzC,KAAM,GAAIC,IAAK,GAAII,MAAOe,EAAQU,SAAW,GAAIY,OAAQtB,EAAQuB,UAAY,IACvF5C,SAAU,CAAE8B,EAAGV,EAAIS,UAAUC,EAAGe,EAAGzB,EAAIS,UAAUgB,GACjDC,OAfe,SAACX,EAAGY,GACrBb,EAAYC,GACZb,EAAcyB,EAAM3B,IAclB4B,OAZmB,SAACb,EAAGY,GACzBb,EAAYC,GACZZ,EAAcwB,EAAM3B,IAWlB6B,QAASf,GAETI,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWC,IAAWnB,EAAQlB,WAAYc,GAAcI,EAAQhB,qBACnEsB,EAAAlD,EAAAmD,cAACa,EAAA,EAADpG,OAAAqG,OAAA,CACEC,MAAO,CACLxD,WAAYF,EAAK,GAAAiB,OAAMjB,EAAN,cAA0B,KAC3CA,MAAOA,EAAK,GAAAiB,OAAMpB,EAAM8D,QAAQC,gBAAgB5D,GAApC,cAAyD,MAEvEA,MAAOuB,EAAO,YAAc,UAC5BsC,MAAOrC,EAAIqC,MACXV,KAAM3B,EAAIsC,GACVT,QAASf,EACTyB,SAAUxC,EAAOK,EAAYJ,GAAO,KACpCb,WAAYY,EAAOmB,EAAAlD,EAAAmD,cAACqB,EAAAxE,EAAD,CAAY8D,UAAWC,IAAWnB,EAAQzB,WAAYqB,GAAcI,EAAQrB,kBAAsB2B,EAAAlD,EAAAmD,cAAA,YACrHW,UAAWC,IACTnB,EAAQtC,UACRkC,GAAcI,EAAQ5B,aACtBe,GAAQa,EAAQ7B,UAEduB,EAhBN,CAiBEmC,OAAQvB,EAAAlD,EAAAmD,cAACuB,EAAA,EAAD,CAAQZ,UAAWC,IAAWnB,EAAQtB,WAAYS,GAAQa,EAAQ7B,UACxEmC,EAAAlD,EAAAmD,cAACwB,EAAA3E,EAAD,CAAY8D,UAAWC,IAAWnB,EAAQvB,eAAgBU,GAAQa,EAAQ7B,+ICrDhFZ,EAAYC,YCbH,SAAAC,GAAK,MAAK,CACvBuE,KAAM,CACJxD,MAAO,QAETyD,iBAAkB,CAChBC,QAAO,GAAArD,OAAKpB,EAAM0E,QAAQ,GAAnB,OAAAtD,OAA8C,EAAnBpB,EAAM0E,QAAQ,GAAzC,OAETC,YAAa,CACXvE,SAAU,IAEZwE,YAAa,CACXrE,SAAU,WACVC,KAAM,EACNJ,SAAU,IAEZyE,MAAO,CACLvD,QAAS,OACTmD,QAAS,GAEXK,eAAgB,CACdxD,QAAS,OACTyD,SAAU,OACVC,KAAM,EACNC,WAAY,SACZC,SAAU,UAEZC,MAAO,CACL5E,SAAU,WACV6E,OAAQ,IACRC,UAAWrF,EAAM0E,QAAQ,GACzBlE,KAAM,EACNK,MAAO,MDwCIyE,EAxDK,SAAA7D,GAA6B,IAA1B8D,EAA0B9D,EAA1B8D,UAAWC,EAAe/D,EAAf+D,SAC1BjD,EAAUzC,IACV2F,EAAUF,EAAUG,OAAOC,IAAI,SAAAC,GAAE,MAAK,CAAE5B,MAAO4B,EAAG5B,MAAO6B,MAAOD,EAAG3B,MAEzE,OADA6B,QAAQC,IAAI,cAAeR,GAEzB1C,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQgC,OACpBgB,EAAUS,gBACVnD,EAAAlD,EAAAmD,cAACmD,EAAA,EAAD,CACER,QAASA,EACTlD,QAASA,EACT2D,WAAY,CACVC,UACAC,OACAC,mBACAC,SACAC,cACAC,kBAEFX,MAAO,KAEPY,mBAAiB,EACjBC,aAAa,EACblB,SAAUA,EACVZ,YAAaW,EAAUvB,MACvB2C,cAAY,IAGdpB,EAAUS,gBACVnD,EAAAlD,EAAAmD,cAAC8D,EAAAjH,EAAD,CACE8F,QAASA,EACTlD,QAASA,EACT2D,WAAY,CACVC,UACAC,OACAC,mBACAC,SACAC,cACAC,kBAEFX,MAAO,KACPa,aAAa,EAEbD,mBAAiB,EACjBjB,SAAUA,EACVZ,YAAaW,EAAUvB,MACvB2C,cAAY,MAatB,SAASR,EAASlE,GAChB,OACEY,EAAAlD,EAAAmD,cAAC+D,EAAA,EAADtJ,OAAAqG,OAAA,CACEkD,WAAS,EACTC,WAAY,CACVC,iBACAC,WAAW1J,OAAA2J,EAAA,EAAA3J,CAAA,CACTkG,UAAWxB,EAAMkF,YAAY5E,QAAQsC,MACrCuC,SAAUnF,EAAMoF,SAChBC,SAAUrF,EAAMqF,UACbrF,EAAMsF,cAGTtF,EAAMkF,YAAYK,iBAK5B,IAAMnB,EAAmB,SAAAoB,GAAA,IAAGF,EAAHE,EAAGF,WAAYJ,EAAfM,EAAeN,YAAaG,EAA5BG,EAA4BH,SAA5B,OACvBzE,EAAAlD,EAAAmD,cAAC4E,EAAA,EAADnK,OAAAqG,OAAA,CACEzD,MAAM,gBACNsD,UAAW0D,EAAY5E,QAAQiC,kBAC3B+C,GAEHD,IAIClB,EAAO,SAAAuB,GAAA,IAAGR,EAAHQ,EAAGR,YAAaI,EAAhBI,EAAgBJ,WAAYD,EAA5BK,EAA4BL,SAA5B,OACXzE,EAAAlD,EAAAmD,cAAC8E,EAAA,EAADrK,OAAAqG,OAAA,CAAOiE,QAAM,EAACpE,UAAW0D,EAAY5E,QAAQ4C,OAAWoC,GACrDD,IAICN,EAAiB,SAAAc,GAAA,IAAGV,EAAHU,EAAGV,SAAanF,EAAhB1E,OAAA2E,EAAA,EAAA3E,CAAAuK,EAAA,qBAA4BjF,EAAAlD,EAAAmD,cAAA,MAAAvF,OAAAqG,OAAA,CAAKmE,IAAKX,GAAcnF,KAErEsE,EAAc,SAACtE,GAAD,OAClBY,EAAAlD,EAAAmD,cAAC4E,EAAA,EAADnK,OAAAqG,OAAA,CACEzD,MAAM,gBACNsD,UAAWxB,EAAMkF,YAAY5E,QAAQqC,aACjC3C,EAAMsF,YAETtF,EAAMqF,WAILhB,EAAS,SAAA0B,GAAA,IAAGX,EAAHW,EAAGX,SAAUY,EAAbD,EAAaC,UAAWC,EAAxBF,EAAwBE,WAAYX,EAApCS,EAAoCT,WAAYD,EAAhDU,EAAgDV,SAAhD,OACbzE,EAAAlD,EAAAmD,cAACqF,EAAA,EAAD5K,OAAAqG,OAAA,CACEwE,UAAWf,EACXgB,SAAUJ,EACVK,UAAU,MACVzE,MAAO,CAAE0E,WAAYL,EAAa,IAAM,MACpCX,GAEHD,IAICd,EAAiB,SAAAgC,GAAA,IAAGrB,EAAHqB,EAAGrB,YAAaG,EAAhBkB,EAAgBlB,SAAhB,OACrBzE,EAAAlD,EAAAmD,cAAA,OAAKW,UAAW0D,EAAY5E,QAAQuC,gBAAiBwC,IEtHjDxH,EAAYC,YCdH,SAAAC,GAAK,MAAK,CACvBuE,KAAM,CACJW,SAAU,WAEZuD,OAAQ,CACNhE,QAA4B,EAAnBzE,EAAM0E,QAAQ,IAEzBgE,SAAU,CACR9H,cAAe,UAEjB+H,QAAS,CACPC,YAAgC,EAAnB5I,EAAM0E,QAAQ,GAC3BmE,aAAiC,EAAnB7I,EAAM0E,QAAQ,GAC5BoE,cAAkC,EAAnB9I,EAAM0E,QAAQ,IAE/BqE,YAAa,CACXxI,SAAU,WACVM,MAAOb,EAAM0E,QAAQ,GACrBjE,IAAKT,EAAM0E,QAAQ,GACnBvE,MAAOH,EAAM8D,QAAQkF,KAAK,SDuCfC,EA1CM,SAAAxH,GAAuD,IAApDxD,EAAoDwD,EAApDxD,OAAQiL,EAA4CzH,EAA5CyH,KAAMC,EAAsC1H,EAAtC0H,aAAcnH,EAAwBP,EAAxBO,SAAUoH,EAAc3H,EAAd2H,QACtD7G,EAAUzC,IACVuJ,EAASF,EAAaG,KAAKC,OAAO,SAAAC,GAAC,OAAIA,EAAEC,UAC/C,OAAKxL,EAEH4E,EAAAlD,EAAAmD,cAAC4G,EAAA,EAAD,CACER,KAAMA,EACNS,OAAO,QACPC,YAAU,EACVrH,QAAS,CAAEsH,iBAAkBtH,EAAQgC,MACrC6E,QAAS,kBAAMA,KACfU,kBAAgB,uBAEhBjH,EAAAlD,EAAAmD,cAACiH,EAAA,EAAD,CAAa9F,GAAG,sBAAsBR,UAAWlB,EAAQkG,QAAzD,WAEE5F,EAAAlD,EAAAmD,cAACkH,EAAA,EAAD,CAAYvG,UAAWlB,EAAQwG,YAAavF,QAAS4F,GACnDvG,EAAAlD,EAAAmD,cAACmH,EAAAtK,EAAD,QAGJkD,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQoG,SACrBU,EAAOa,OAAS,GACfrH,EAAAlD,EAAAmD,cAAC4E,EAAA,EAAD,CAAYyC,QAAQ,WAApB,8CAGDd,EAAO1D,IAAI,SAACyE,EAASC,GAAV,OACVxH,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQmG,SAAU4B,IAAG,YAAAlJ,OAAciJ,IACjDxH,EAAAlD,EAAAmD,cAACyH,EAAD,CAAahF,UAAW6E,EAAS5E,SAAUxD,EAAS/D,EAAQmM,UAvBlD,eEiFPI,EA/FG,SAACC,EAAO7I,EAAS4D,EAAUkF,GAAoB,IACvDvB,EAAiBwB,qBAAWC,KAA5BzB,aADuDzM,EAK3BC,oBAAS,GALkBW,EAAAC,OAAAsN,EAAA,EAAAtN,CAAAb,EAAA,GAKxDoO,EALwDxN,EAAA,GAK5CyN,EAL4CzN,EAAA,GAAAmB,EAMvB9B,mBAAS,MANcmC,EAAAvB,OAAAsN,EAAA,EAAAtN,CAAAkB,EAAA,GAMxDuM,EANwDlM,EAAA,GAM1CmM,EAN0CnM,EAAA,GAQzDoM,EAAW,IAAIC,IAAKhC,EAAcsB,EAAMnB,MAExCtH,EAAW,SAAC/D,EAAQmM,GAAT,OAAqB,SAAA3I,GAAiC,IAA9BoE,EAA8BpE,EAA9BoE,MACnCuF,EADiE3J,EAAvB4J,UAE1CH,EAASI,kBAAkBzF,EAAOuE,EAAQnG,GAAIhG,GAC9CiN,EAASK,uBAAuB1F,EAAOuE,EAAQnG,GAAIhG,GAEvDgN,EAAgB,MAChBzF,EAASjI,OAAA2J,EAAA,EAAA3J,CAAA,GAAKkN,EAAN,CAAanB,KAAI,GAAAlI,OAAA7D,OAAAiO,EAAA,EAAAjO,CAAMkN,EAAMnB,MAAZ,CAAkB8B,SAyBvCK,EAAoB,SAAAhE,EAAW9F,GAAQ,IAAhBU,EAAgBoF,EAAhBpF,EAAGe,EAAaqE,EAAbrE,EAa9B,OAZgBqH,EAAMnB,KAAK3D,IAAI,SAAA+F,GAC7B,GAAIA,EAAOzH,KAAOtC,EAAIsC,GAAI,OAAOyH,EAE/B,IAAIC,EAAOC,SAASvJ,EAAIT,EAAQiK,WAAY,IACxCC,EAAOF,SAASxI,EAAIxB,EAAQiK,WAAY,IAE5C,OAAOtO,OAAA2J,EAAA,EAAA3J,CAAA,GACFmO,EADL,CAEEzN,OAAQ,CAAEoE,EAAGsJ,EAAMvI,EAAG0I,QAkC9B,MAAO,CACL9J,WACAD,YAnEkB,SAACJ,GAAD,OAAS,WAC3B,IAAM2H,EAAOmB,EAAMnB,KAAKC,OAAO,SAAAmC,GAAM,OAAIA,EAAOzH,KAAOtC,EAAIsC,KAC3DuB,EAASjI,OAAA2J,EAAA,EAAA3J,CAAA,GACJkN,EADG,CAENnB,YAgEFyC,gBA1DsB,SAACrJ,GAClBsI,IAEHN,GAAgB,GAChBO,EAAgB,CACd5I,EAAGuJ,SAASlJ,EAAEsJ,OAAS9M,OAAO+M,WAAarK,EAAQU,UAAY,EAAIV,EAAQiK,WAAY,IACvFzI,EAAGwI,SAASlJ,EAAEwJ,OAAShN,OAAOiN,YAAcvK,EAAQuB,WAAa,EAAIvB,EAAQiK,WAAY,QAqD7FhK,cAtBoB,SAAC5D,EAAQ0D,GAC7B8J,EAAkBxN,EAAQ0D,GAC1BoJ,GAAc,IAqBdjJ,cAhCoB,SAAC7D,EAAQ0D,GAC7B,IAAM2H,EAAOmC,EAAkBxN,EAAQ0D,GACvCoJ,GAAc,GACdvF,EAASjI,OAAA2J,EAAA,EAAA3J,CAAA,GACJkN,EADG,CAENnB,WA4BF8C,WApBiB,kBACjBvJ,EAAAlD,EAAAmD,cAACuJ,EAAD,CACEnD,MAAO4B,GAAcwB,QAAQtB,GAC7B/M,OAAQ+M,EACR7B,aAAcA,EACdnH,SAAUA,EACVoH,QAAS,WACP6B,EAAgB,MAEhBP,GAAgB,OAYpB6B,aAAcrB,EAASqB,iCC1FrBzM,EAAYC,YAAW,SAAAC,GAAK,MAAK,CACrCuE,KAAM,CACJiI,SAAU,EACV/H,QAAS,MACTnD,QAAS,OACTV,cAAe,SACf6L,QAAS,GACTC,UAAW,SACXvM,MAAOH,EAAM8D,QAAQkF,KAAK,MAE5B2D,KAAM,CACJ5L,MAAO,OACPiE,KAAM,UACN7E,MAAOH,EAAM8D,QAAQkF,KAAK,KAC1ByD,QAAS,IAEXG,QAAS,CACPzM,MAAOH,EAAM8D,QAAQkF,KAAK,KAC1B0D,UAAW,SACX1H,KAAM,UACNjE,MAAO,QAET8L,UAAW,CACT7H,KAAM,UACNjE,MAAO,WAcI+L,GAVG,WAChB,IAAMvK,EAAUzC,IAChB,OACE+C,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQgC,MACtB1B,EAAAlD,EAAAmD,cAACiK,EAAApN,EAAD,CAAiB8D,UAAWlB,EAAQoK,OACpC9J,EAAAlD,EAAAmD,cAAC4E,EAAA,EAAD,CAAYjE,UAAWlB,EAAQqK,SAA/B,mBCzBA9M,GAAYC,YCbH,SAAAC,GAAK,MAAK,CACvBuE,KAAM,CAEJjD,QAAS,QACTf,SAAU,WACVQ,MAAO,OACPT,OAAQ,OACRD,WAAY,QACZ6E,SAAU,UAEZ8H,MAAO,CACLzM,SAAU,WACVE,IAAK,MACLD,KAAM,MACNyM,UAAW,oCACX/H,SAAU,UAEZmE,OAAQ,CACN9I,SAAU,WACVE,IAAK,EACLD,KAAM,EAGNF,OAAQ,OACRS,MAAO,QAGTmM,IAAK,CACH5L,QAAS,SAEX6L,UAAW,CACT7L,QAAS,QAEX8L,YAAa,CACXrM,MAAO,WDkFIsM,IArGD,SAAA5L,GAAyE,IAAtEgJ,EAAsEhJ,EAAtEgJ,MAAOgC,EAA+DhL,EAA/DgL,QAAS/K,EAAsDD,EAAtDC,KAAM4L,EAAgD7L,EAAhD6L,SAAsB9H,GAA0B/D,EAAtC8L,WAAsC9L,EAA1B+D,UAAU/B,EAAgBhC,EAAhBgC,UAC/DlB,EAAUzC,KACV0N,EAAa5P,iBAAO,MAF2DlB,EAGvDC,mBAAS,CAAEkP,WAAY,IAHgCvO,EAAAC,OAAAsN,EAAA,EAAAtN,CAAAb,EAAA,GAG9EkF,EAH8EtE,EAAA,GAGrEmQ,EAHqEnQ,EAAA,GAAAmB,EAI/D9B,mBAAS,MAJsDmC,EAAAvB,OAAAsN,EAAA,EAAAtN,CAAAkB,EAAA,GAI9EiP,EAJ8E5O,EAAA,GAIzE6O,EAJyE7O,EAAA,GAAA8O,EAKzDjR,oBAAS,GALgDkR,EAAAtQ,OAAAsN,EAAA,EAAAtN,CAAAqQ,EAAA,GAK9EE,EAL8ED,EAAA,GAKtEE,EALsEF,EAAA,GAAAG,EAMvCrR,mBAAS,GAN8BsR,EAAA1Q,OAAAsN,EAAA,EAAAtN,CAAAyQ,EAAA,GAM9EE,EAN8ED,EAAA,GAM7DE,EAN6DF,EAAA,GAO7E9E,EAAiBwB,qBAAWC,KAA5BzB,aAERjL,oBAAU,YACR,WACE,GAAKuM,EAAM2D,OAKLZ,EAAW1P,SAAS6P,EAAOlD,EAAM2D,YALpB,CACjB,IAAMC,EAASlF,EAAamF,YAAY7D,EAAO,SAC3C+C,EAAW1P,SAAS6P,EAAOU,IAMnCE,IACC,CAAC9D,IApBiF,IAAA+D,EAsBhCC,YAAiBjB,GAtBekB,EAAAF,EAsB7EG,KAAQrO,EAtBqEoO,EAsBrEpO,OAAQS,EAtB6D2N,EAsB7D3N,MAAS2J,EAtBoD8D,EAsBpD9D,gBAC3BkE,EAAiBV,EAAkB,EAAlB,GAAA9M,OAAyBsM,EAAzB,WAAAtM,OAAsC8M,GAAoBR,EAvBImB,EA0BYrE,EAAUC,EAAO,CAAEnK,SAAQS,SAASyE,EAAUkF,GAAvIqB,EA1B6E8C,EA0B7E9C,gBAAiBK,EA1B4DyC,EA0B5DzC,WAAYG,EA1BgDsC,EA0BhDtC,aAAc1K,EA1BkCgN,EA0BlChN,cAAeC,EA1BmB+M,EA0BnB/M,cAAeC,EA1BI8M,EA0BJ9M,YAkBjF,OACEc,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWC,IAAWnB,EAAQgC,KAAMd,GACvCI,MAAO,CAAE4I,QAAqB,OAAZA,EAAmBA,EAAU,GAC/C1E,IAAKyF,GAEL3K,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQyK,MACtBnJ,MAAO,CACLvD,OAAQsB,EAAUA,EAAQuB,UAAY,EACtCpC,MAAOa,EAAUA,EAAQU,SAAW,GAEtCkB,QAASuI,GAEPuB,GAAY5L,EAEVmB,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWA,GACZ8I,EAAa3K,EAAQiK,YAAYlG,IAAI,SAAChE,EAAK0I,GAAN,OACrCxH,EAAAlD,EAAAmD,cAACgM,EAADvR,OAAAqG,OAAA,CACE0G,IAAG,SAAAlJ,OAAWiJ,GACdlK,MAAOwB,EAAIxB,OACP,CAAEuB,OAAME,UAASD,MAAKE,gBAAeC,gBAAeC,oBAG5D,KAEL+L,GAAUjL,EAAAlD,EAAAmD,cAACiM,GAAD,MACXlM,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWC,IAAWoK,EAASvL,EAAQ4K,UAAY5K,EAAQ2K,KAC9D8B,IAAKJ,EACLK,QAAS,SAACC,GACJhB,EAAkB,KACpBH,GAAU,GACVjI,QAAQC,IAAI,cAAemI,GAC3BpI,QAAQqJ,MAAMD,GACdE,WAAW,WACL5B,EAAW1P,SAASqQ,EAAmBD,EAAkB,IAC5D,OAGPmB,IAAKT,EACLU,OAtDkB,SAAAtR,GACxB,GAAIwP,EAAW1P,QAAS,CACtBiQ,GAAU,GADY,IAAAwB,EAEkBvR,EAAMwR,OAAtCC,EAFcF,EAEdE,cAAeC,EAFDH,EAECG,aAEjB7D,EAAa8D,KAAKC,IACtBtP,EAASmP,EACT1O,EAAQ2O,GAKVjC,EAAW,CAAEnL,SAFIuJ,EAAa6D,EAEPvM,UADL0I,EAAa4D,EACGC,eAAcD,gBAAe5D,iBA2C3DhI,MAAO,CAAEvD,OAAQsB,EAAQuB,UAAWpC,MAAOa,EAAQU,aAGtDZ,GAAQmB,EAAAlD,EAAAmD,cAACsJ,EAAD,yCEtGfyD,EAAAC,EAAAC,EAAA,sBAAAC,IAAAH,EAAAC,EAAAC,EAAA,sBAAAE,IAAAJ,EAAAC,EAAAC,EAAA,sBAAAG,IAAAL,EAAAC,EAAAC,EAAA,sBAAAI,IAAAN,EAAAC,EAAAC,EAAA,sBAAAK,IAAAP,EAAAC,EAAAC,EAAA,sBAAAM,IAAA,IAAAC,EAAAT,EAAA,KAAAU,EAAAV,EAAA,KAAAW,EAAAX,EAAA,KAAAY,EAAAZ,EAAA,KAKAE,EAAA,GAEEW,UAAW,CACT,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UAAW,UACxF,UAAW,UAAW,UAAW,UAAW,UAAW,YAIpD,IAAMV,EAAY,CACvBW,YAAaC,uEACbC,OAAQC,KAGNC,EAAUH,2hBAAYI,kBAO1BlL,QAAQC,IAAI,WAAYgL,EANTH,eAQR,IAAMX,EAAO,CAClBgB,cAAe,CACbC,KAAM,OACNC,IAAK,MACLC,OAAQ,SACRC,QAAS,UACTC,OAAQ,SACRC,UAAW,YACXC,kBAAmB,oBACnBC,mBAAoB,sBAEtBC,YAAa,CACXC,IAAK,MACLC,SAAU,WACVC,KAAM,QAERC,aAAc,CACZC,KAAM,OACNF,KAAM,OACNF,IAAK,QAWIzB,EAAY,CACvB8B,QAASpB,mEAGET,EAAU,CACrB8B,SAAU,YAGC7B,EAAM,CACjB8B,KAAM,CAIJC,OAAQvB,YAERwB,WAAYxB,sBAEZyB,oBAAqBzB,4BAErB0B,iBAAiB,EAEjBC,cAAe,CAEbC,OAAM,GAAApR,OA5DCwP,oCAgEP6B,QAAS,GAETC,QAAQ,KAODrC,EAAS,CACpBsC,KAAM,CACJ3O,MAAO,OACP4O,YAAa,uDACbzS,MAAO0S,KAETC,QAAS,CACP9O,MAAO,UACP4O,YAAa,sCACbzS,MAAO4S,KAETC,OAAQ,CACNhP,MAAO,SACP4O,YAAa,6DACbzS,MAAO8S,kECxGLC,EAAU,SAACC,EAAIC,EAASC,GAC5B,OAAKF,EAEDC,EACK,CACLrS,MAAO4O,KAAK2D,IAAIF,EAAQrS,MAAOoS,EAAGI,aAClCjT,OAAQqP,KAAK2D,IAAIF,EAAQ9S,OAAQ6S,EAAGK,eAI/B,CACLzS,MAAOoS,EAAGI,YACVjT,OAAQ6S,EAAGK,cAXCH,GAAeD,GAAW,CAAErS,MAAO,EAAGT,OAAQ,IAiEjDmO,IAjDU,SAAC1G,EAAKqL,EAASC,GACtC,IAAMI,EAAkB7V,mBAD8BlB,EAEdC,oBAAS,GAFKW,EAAAC,OAAAC,EAAA,EAAAD,CAAAb,EAAA,GAE/CgX,EAF+CpW,EAAA,GAEjCoN,EAFiCpN,EAAA,GAItDmW,EAAgB3V,QAAU4V,EAJ4B,IAAAjV,EAKrB9B,mBAC/BuW,EAAQnL,EAAMA,EAAIjK,QAAU,KAAMsV,EAASC,IANSvU,EAAAvB,OAAAC,EAAA,EAAAD,CAAAkB,EAAA,GAK/CkQ,EAL+C7P,EAAA,GAKzC6U,EALyC7U,EAAA,GAShD8U,EAAe,WACnB,GAAKH,EAAgB3V,SAAYiK,EAAIjK,QAArC,CACA,IAAM8D,EAAUsR,EAAQnL,EAAIjK,QAASsV,EAASC,GAC1CzR,EAAQtB,SAAWqO,EAAKrO,QAAUsB,EAAQb,QAAU4N,EAAK5N,OAE3D4S,EAAiB/R,KAIfiS,EAAwBC,sBAC5BC,YAASH,EAAc,KACvB,IA0BF,OAvBAI,0BAAgB,WACd,GAAKjM,EAAIjK,QAAT,CAGA,GAFA8V,IAE8B,oBAAnBK,eAA+B,CACxC,IAAIC,EAAiB,IAAID,eAAeJ,GAGxC,OAFAK,EAAeC,QAAQpM,EAAIjK,SAEpB,WACLoW,EAAeE,WAAWrM,EAAIjK,SAC9BoW,EAAiB,MAMnB,OAFAhV,OAAOC,iBAAiB,SAAU0U,GAE3B,WACL3U,OAAOE,oBAAoB,SAAUyU,MAI3C,CAAC9L,EAAIjK,UAEE,CAAE6Q,OAAMjE,kFClEX2J,EAEI,SAFJA,EAIG,QAiCMC,IA9Bb,SAAAA,EAAanL,GAAc,IAAAoL,EAAAC,KACzB,GADyBjX,OAAAkX,EAAA,EAAAlX,CAAAiX,KAAAF,GAAAE,KAK3BE,WAAa,SAACC,GAAD,OAAYJ,EAAKK,OAAOtL,KAAKuL,KAAK,SAAAC,GAAE,OAAIA,EAAG7Q,KAAO0Q,KALpCH,KAO3BO,gBAAkB,SAACJ,GAEjB,OAAOJ,EAAKK,OAAOtL,KAAK0L,UAAU,SAAAF,GAAE,OAAIA,EAAG7Q,KAAO0Q,KATzBH,KAY3BS,cAAgB,kBAAMV,EAAKK,OAAOtL,KAAKC,OAAO,SAAAuL,GAAE,OAAIA,EAAGrL,WAZ5B+K,KAa3BU,iBAAmB,kBAAMX,EAAKK,OAAOtL,KAAKC,OAAO,SAAAuL,GAAE,OAAIA,EAAGK,cAb/BX,KAe3BY,cAAgB,kBAAM7X,OAAO8X,KAAKd,EAAKK,OAAOU,MAC3C/L,OAAO,SAAAe,GAAG,OAAIiK,EAAKK,OAAOU,KAAKhL,GAAKiL,OAASlB,IAC7CmB,OAAO,SAACC,EAAKnL,GAAN,OAAA/M,OAAAmY,EAAA,EAAAnY,CAAA,GACHkY,EADGlY,OAAAoY,EAAA,EAAApY,CAAA,GAEL+M,EAAMiK,EAAKK,OAAOU,KAAKhL,GAAKsL,WAC3B,KApBqBpB,KAsB3BqB,aAAe,kBAAMtY,OAAO8X,KAAKd,EAAKK,OAAOU,MAC1C/L,OAAO,SAAAe,GAAG,OAAIiK,EAAKK,OAAOU,KAAKhL,GAAKiL,OAASlB,IAC7CmB,OAAO,SAACC,EAAKnL,GAAN,OAAA/M,OAAAmY,EAAA,EAAAnY,CAAA,GACHkY,EADGlY,OAAAoY,EAAA,EAAApY,CAAA,GAEL+M,EAAMiK,EAAKK,OAAOU,KAAKhL,GAAKsL,WAC3B,MA1BCzM,EAAc,MAAM,IAAI2M,MAAM,yDACnCtB,KAAKI,OAASzL,+GCHLtJ,EACH,GAmBJC,EAAYC,YAhBJ,SAAAC,GAAK,MAAK,CACtBuE,KAAM,CACJnE,SAAU,QACVE,OAAQT,EACRkW,YAAa/V,EAAM0E,QAAQ,GAAK,EAChCW,UAAWrF,EAAM0E,QAAQ,GAAK,GAEhC5D,WAAY,CACVC,MAAOlB,EAAkB,EACzBS,OAAQT,EAAkB,GAE5BoB,WAAY,CACVF,MAAOlB,EACPS,OAAQT,MA0CGmW,IArCC,SAAAvU,GAA8C,IAA3CC,EAA2CD,EAA3CC,KAAMC,EAAqCF,EAArCE,IAAKxB,EAAgCsB,EAAhCtB,MAAO+D,EAAyBzC,EAAzByC,SAAajC,EAAY1E,OAAA0Y,EAAA,EAAA1Y,CAAAkE,EAAA,mCACtDc,EAAUzC,IACVE,EAAQwC,cACd,OACE0T,EAAAvW,EAAAmD,cAACqT,EAAA,EAAD5Y,OAAAqG,OAAA,CACEC,MAAO,CACLxD,WAAYF,GAAS,KACrBA,MAAOA,EAAK,GAAAiB,OAAMpB,EAAM8D,QAAQC,gBAAgB5D,IAAW,MAE7D6D,MAAOrC,EAAIqC,MACXV,KAAM3B,EAAIsC,GACVC,SAAUxC,EAAO,kBAAMwC,EAASvC,IAAO,KACvCb,WACEoV,EAAAvW,EAAAmD,cAACsT,EAAAzW,EAAD,CACE8D,UAAWlB,EAAQzB,WACnB0C,QAAS,SAAAd,GACPoD,QAAQC,IAAI,eAEdlC,MAAO,CACL4I,QAAS,GACTtM,MAAOA,EAAK,GAAAiB,OAAMpB,EAAM8D,QAAQC,gBAAgB5D,IAAW,QAIjEsD,UAAWlB,EAAQgC,MACftC,uCCrDV,IAAAoU,EAAAxG,EAAA,GAAAyG,EAAAzG,EAAA0G,EAAAF,GAAAG,EAAA3G,EAAA,IAAA4G,EAAA5G,EAAA0G,EAAAC,GAAAE,EAAA7G,EAAA,KAAA8G,EAAA9G,EAAA,KAAA+G,EAAA/G,EAAA,KAwBM/P,EAAYC,YAjBJ,SAAAC,GAAK,MAAK,CACtBuE,KAAM,CACJhE,SAAU,WACVe,QAAS,QACT4D,SAAU,SACV2R,WAAY,WACZC,YAAa,CACXC,QAAS,OACTzV,QAAS,QACTf,SAAU,WACV2C,OAAQ,EACRnC,MAAO,OACPT,OAAQ,IACRD,WAAU,mDAAAe,OAAqDpB,EAAM8D,QAAQzD,WAAW8E,MAA9E,eAMV6R,EAAgB,SAAAvV,GAAsC,IAAnCuC,EAAmCvC,EAAnCuC,MAAOiT,EAA4BxV,EAA5BwV,KAAM3W,EAAsBmB,EAAtBnB,OAAQkD,EAAc/B,EAAd+B,QACtCjB,EAAUzC,IAChB,OACEwW,EAAA3W,EAAAmD,cAAA,OAAKU,QAASA,GACXQ,GACCsS,EAAA3W,EAAAmD,cAAC6T,EAAA,EAAD,CAAWlT,UAAWlB,EAAQ2U,WAC3BlT,GAGLsS,EAAA3W,EAAAmD,cAAC4T,EAAA,EAAD,CAEEvM,QAAQ,QACRhK,MAAM,UACN0D,MAAO,CAAEvD,UACTmD,UAAWC,IAAWnB,EAAQgC,OAE7B0S,KAYTD,EAAcG,aAAe,CAC3B7W,OAAQ,KAGK0W,sFCEA7L,IAxDb,SAAAA,EAAahC,EAAcG,GAAM,IAAAiL,EAAAC,KAAAjX,OAAA6Z,EAAA,EAAA7Z,CAAAiX,KAAArJ,GAAAqJ,KAKjC6C,YAAc,SAAC1C,EAAQ2C,GACrB,OAAO/C,EAAKpL,aAAauL,WAAWC,GAAQjP,OACzCmP,KAAK,SAAAC,GAAE,OAAIA,EAAG7Q,KAAOqT,KAPO9C,KAWjC+C,UAAY,WACV,IAAMC,EAAWjD,EAAKpL,aAAa8L,gBAAgBtP,IAAI,SAAAmP,GAAE,OAAIA,EAAG7Q,KAChE,OAAOsQ,EAAKjL,KAAKC,OAAO,SAAA5H,GAAG,OAAI6V,EAASC,QAAQ9V,EAAIgT,SAAW,GAAKhT,EAAI1D,QAAU0D,EAAI1D,OAAOoE,KAb9DmS,KAgBjCkD,aAAe,WACb,IAAMC,EAAcpD,EAAKpL,aAAa+L,mBAAmBvP,IAAI,SAAAmP,GAAE,OAAIA,EAAG7Q,KACtE,OAAOsQ,EAAKjL,KAAKC,OAAO,SAAA5H,GAAG,OAAIgW,EAAYF,QAAQ9V,EAAIgT,SAAW,KAlBnCH,KAqBjCoD,gBAAkB,SAAC5T,EAAO2Q,GAAR,MAChB,CAAE1Q,GAAI4T,MAAQ7T,QAAO2Q,WAtBUH,KAyBjCsD,qBAAuB,SAAC7T,EAAI0Q,GAAL,OAAApX,OAAAwa,EAAA,EAAAxa,CAAA,GAClBgX,EAAK8C,YAAY1C,EAAQ1Q,GADP,CAErB0Q,YA3B+BH,KA8BjClJ,kBAAoB,SAACtH,EAAO2Q,EAAQ1W,GAAhB,MAA4B,CAC9CgG,GAAI4T,MACJ7T,QACA2Q,SACA1W,WAlC+BuW,KAqCjCjJ,uBAAyB,SAACtH,EAAI0Q,EAAQ1W,GAAb,OAAAV,OAAAwa,EAAA,EAAAxa,CAAA,GACpBgX,EAAK8C,YAAY1C,EAAQ1Q,GADL,CAEvB0Q,SACA1W,YAxC+BuW,KA8CjCjI,aAAe,SAACV,GAAD,OAAgB0I,EAAKgD,YAAY5R,IAAI,SAAAhE,GAAG,OAAApE,OAAAwa,EAAA,EAAAxa,CAAA,GAClDoE,EADkD,CAErDqW,MAAOzD,EAAKpL,aAAa4L,gBAAgBpT,EAAIgT,QAC7CvS,UAAW,CACTC,EAAGV,EAAI1D,OAAOoE,EAAIwJ,EAClBzI,EAAGzB,EAAI1D,OAAOmF,EAAIyI,QAlDpB2I,KAAKlL,KAAOA,EACZkL,KAAKrL,aAAe,IAAImL,IAAanL,4FCuDnCrJ,EAAYC,YAzDJ,SAAAC,GAAK,MAAK,CACtBuE,KAAM,CACJpE,MAAOH,EAAM8D,QAAQ8I,QAAQqL,KAC7B1X,SAAU,WACVE,IAAK,MACLD,KAAM,MACNkM,UAAW,SACXwL,gBAAiB,UACjBjL,UAAW,oCACX7H,OAAQ,GAEV+S,WAAY,CACV/S,OAAQ,KAEVgT,OAAQ,CACNhT,OAAQ,IACRrE,MAAO,GACPT,OAAQ,GACRC,SAAU,WACVE,IAAK,MACLD,KAAM,MACNkM,UAAW,SACXwL,gBAAiB,UACjBjL,UAAW,qCAEboL,IAAK,CACHC,OAAQtY,EAAM8D,QAAQ+I,UAAU0L,aAChCC,YAAa,IACbC,KAAMzY,EAAM8D,QAAQ+I,UAAUoL,MAEhCS,mBAAoB,CAClBnY,SAAU,WACVC,KAAM,MAGN4E,OAAQ,KAEVuT,KAAM,CACJxY,MAAO,QACPoI,WAAY,OACZqQ,WAAU,sEAIVxT,OAAQ,IACR7E,SAAU,YAGZsY,WAAY,CACV1Y,MAAOH,EAAM8D,QAAQ+I,UAAUiM,KAC/BF,WAAU,wFA0CCG,EAjCA,SAAAtX,GAAmB,IAAhBuX,EAAgBvX,EAAhBuX,UACVzW,EAAUzC,IAChB,OACE+C,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQgC,MACtB1B,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQ6V,OAAQa,QAAQ,MAAMC,QAAQ,gBACpDrW,EAAAlD,EAAAmD,cAAA,UAAQqW,GAAG,IAAIC,GAAG,IAAIC,EAAE,IAAI5V,UAAWlB,EAAQ8V,OAEhDW,GAAaA,GAAa,EACzBnW,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQmW,oBACtB7V,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQ+W,OACtBL,QAAQ,MACRlY,MAAM,MACNT,OAAO,MACP4Y,QAAQ,iBACRrV,MAAO,CAAEoJ,UAAS,6CAAA7L,OAA+C4X,EAA/C,UAClBnW,EAAAlD,EAAAmD,cAAA,QAAMgN,EAAE,mGACN2I,KAAK,UACLc,YAAY,QACZf,YAAY,MACZgB,cAAc,MACdlB,OAAO,cAIX,kECzEJmB,iBAAgB,SAACxX,GAAU,IAE7ByX,EAMEzX,EANFyX,eACAC,EAKE1X,EALF0X,SACArS,EAIErF,EAJFqF,SACAsS,EAGE3X,EAHF2X,UACAC,EAEE5X,EAFF4X,eACGC,EAP0Bvc,OAAA2E,EAAA,EAAA3E,CAQ3B0E,EAR2B,uEAUzB8X,EAASnc,iBAAO,MACd+Q,EAASF,YAAiBsL,EAAQ,CAAEhZ,MAAO,IAAKT,OAAQ,KAAxDqO,KAXuBjS,EAaGC,mBAAS,GAbZW,EAAAC,OAAAsN,EAAA,EAAAtN,CAAAb,EAAA,GAaxBsd,EAbwB1c,EAAA,GAab2c,EAba3c,EAAA,GAAAmB,EAcK9B,mBAAS,MAddmC,EAAAvB,OAAAsN,EAAA,EAAAtN,CAAAkB,EAAA,GAcxByb,EAdwBpb,EAAA,GAcZqb,EAdYrb,EAAA,GAgBzBsb,EAAmB,WACvB,MAAKzL,GAAQA,EAAK5N,MAAQ,IAAM4N,EAAKrO,OAAS,IAC9C,IACE,IAAM4Z,EAAaG,YAAkBV,GAErCQ,EAAcD,GAEhB,MAAOxX,GAELoD,QAAQqJ,MAAMzM,KAOlB,OAHKwX,GAAYE,IACjBE,kBAAQF,EAAkB,CAACzL,IAGzB9L,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWC,IAAW,UAAWzB,EAAMwB,WAAYsE,IAAKgS,EAAQlW,MAAO,CAAEvD,OAAQ,OAAQS,MAAO,SACnG8B,EAAAlD,EAAAmD,cAACyX,EAAA,EAADhd,OAAAqG,OAAA,GACM+V,EADN,CAEErZ,OAAQqO,EAAKrO,OACbS,MAAO4N,EAAK5N,MACZyZ,SAAUZ,EAAUI,GAAWnW,MAC/B4W,OAAQZ,EACRa,qBAAsB1K,IAAUW,aAC5BmJ,GAEFF,GAAaA,EAAU1P,OAAS,EAChCrH,EAAAlD,EAAAmD,cAAC6X,EAAA,EAAD,CACEjB,eAAgBA,EAChBM,UAAWA,EACXJ,UAAWA,EACXK,aAAcA,IAEd,KAEF3S,GAAYsT,MAAMC,QAAQvT,GACtBA,EAAS3B,IAAI,SAAAmV,GAAC,OAAIC,EAAYD,EAAGnB,EAAUhL,EAAKrO,OAAQqO,EAAK5N,MAAOmZ,KACpEa,EAAYzT,EAAUqS,EAAUhL,EAAKrO,OAAQqO,EAAK5N,MAAOmZ,OAOvE,SAASa,EAAaC,EAAOrB,EAAUrZ,EAAQS,EAAOmZ,GACpD,MAAwB,oBAAVc,EACVA,EAAMrB,EAAUrZ,EAAQS,EAAOmZ,GAC/Bc,EAgCNvB,EAActC,aAAe,CAC3BuC,eAAgB,GAChBuB,cAAc,EAMdC,UAAW,EACXtB,UAAW5J,IAAUa,QAGR4I,QCtEA0B,IAzCA,SAAA1Z,GAAiF,IAA9E2Z,EAA8E3Z,EAA9E2Z,UAAWC,EAAmE5Z,EAAnE4Z,SAAUre,EAAyDyE,EAAzDzE,SAAUC,EAA+CwE,EAA/CxE,UAAWuI,EAAoC/D,EAApC+D,SAAUwT,EAA0BvX,EAA1BuX,UAAc/W,EAAY1E,OAAA2E,EAAA,EAAA3E,CAAAkE,EAAA,wEACxF6Z,EAAMF,EAAY3B,EAAgB8B,IAElCC,EAAWJ,EAAY,GAAK,CAChCK,aAAa,EACbC,YAAY,EACZC,OAAQN,EACRO,SAAUP,EACVQ,iBAAkBrW,GAGpB,OACE3C,EAAAlD,EAAAmD,cAACwY,EAAD/d,OAAAqG,OAAA,GACM4X,EACAvZ,GAEHjF,GAAYC,EACX4F,EAAAlD,EAAAmD,cAACyX,EAAA,EAAD,CACE9W,UAAW,eACXzG,SAAUA,EACVC,UAAWA,GAEX4F,EAAAlD,EAAAmD,cAACgZ,EAAD,CAAK9C,UAAWA,KAGhBnW,EAAAlD,EAAAmD,cAACgZ,EAAD,CAAK9C,UAAWA,wCCpC1B,IAAA+C,EAAAlM,EAAA,KAAAmM,EAAAnM,EAAA,KAAAoM,EAAApM,EAAA,KAAAqM,EAAArM,EAAA,KAAAsM,EAAAtM,EAAA,KAAAuM,EAAAvM,EAAA,KAaAE,EAAA,GACE,CACEsM,QAAS,MACTC,KAAMC,IACNC,WAAYC,IACZtc,MAAO,QACP0D,MAAO6Y,GAET,CACEL,QAAS,OACTC,KAAMK,IACNH,WAAYI,IACZzc,MAAO,OACP0D,MAAOgZ,uGCYL/c,EAAYC,YA/BJ,SAAAC,GAAK,MAAK,CACtBuE,KAAM,CACJa,OAAQ,GACR7E,SAAU,YAEZuc,aAAc,CACZC,OAAQ,YACR1c,WAAYL,EAAM8D,QAAQmT,KAAKrK,QAC/BzM,MAAOH,EAAM8D,QAAQ8I,QAAQ2L,aAC7BxX,MAAO,GACPT,OAAQ,IAEV0c,gBAAiB,CACfD,OAAQ,YACR1c,WAAYL,EAAM8D,QAAQ8I,QAAQqL,KAClC9X,MAAOH,EAAM8D,QAAQ8I,QAAQ2L,aAC7BlT,UAAW,EACX4X,aAAc,GAEhBC,cAAe,GAGfC,eAAgB,CACd9c,WAAY,QACZF,MAAO,SAETid,cAAe,CACb9b,QAAS,WAMPqZ,EAAe,SAAAlZ,GAA4D,IAAzDiY,EAAyDjY,EAAzDiY,eAAgBM,EAAyCvY,EAAzCuY,UAAWJ,EAA8BnY,EAA9BmY,UAAWK,EAAmBxY,EAAnBwY,aAAmBvd,EACvDC,oBAAS,GAD8CW,EAAAC,OAAAC,EAAA,EAAAD,CAAAb,EAAA,GACxEwM,EADwE5L,EAAA,GAClE+f,EADkE/f,EAAA,GAEzEiF,EAAUzC,IACVE,EAAQwC,cACR8a,EAAiB,SAAC5a,EAAGjF,GACzBqI,QAAQC,IAAI,iBAAkBrD,EAAGjF,GACjCiF,EAAEC,iBACFD,EAAEE,kBACFya,EAAQ5f,IAGV,IAAKmc,IAAcgB,MAAMC,QAAQjB,IAAcA,EAAU1P,OAAS,IAAM0P,EAAUI,GAAY,OAAO,KAErG,IACMwC,EADe5C,EAAUI,GACCwC,WAEhC,OACEtG,EAAAvW,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQgC,KAAMV,MAAO,CACnCpD,IAAKiZ,EAAejZ,IAAMiZ,EAAejZ,IAAMT,EAAM0E,QAAQ,GAC7D7D,MAAO6Y,EAAe7Y,MAAQ6Y,EAAe7Y,MAAQb,EAAM0E,QAAQ,KAElEkV,EAAU1P,OAAS,GAClBgM,EAAAvW,EAAAmD,cAACya,EAAA,EAAD,CACEC,UAAU,oBACV/Z,UAAWlB,EAAQkb,UACnBlb,QAAS,CACPmb,IAAKnb,EAAQua,aACbM,cAAe7a,EAAQ6a,eAEzBzQ,KAAMuJ,EAAAvW,EAAAmD,cAAC0Z,EAAD,CAAY/Y,UAAWlB,EAAQoK,OAErCnJ,QAAS,SAACd,GAAD,OAAO4a,EAAe5a,GAAIwG,IACnCE,QAAS,SAAC1G,GAAD,OAAO4a,EAAe5a,GAAG,IAIlCwG,KAAMA,EACN8P,UAAU,QAGTY,EAAUjU,IAAI,SAAA8B,EAAgC4C,GAAhC,IAAGiS,EAAH7U,EAAG6U,KAAkBD,GAArB5U,EAAS+U,WAAT/U,EAAqB4U,SAArB,OACbnG,EAAAvW,EAAAmD,cAAC6a,EAAA,EAAD,CACErT,IAAG,cAAAlJ,OAAgBiJ,GAEnBsC,KAAMuJ,EAAAvW,EAAAmD,cAACwZ,EAAD,CAAM7Y,UAAWlB,EAAQ2a,gBAC/BU,iBAAiB,SACjBC,YAAa,CACXtb,QAAS,CACPgC,KAAMhC,EAAQya,kBAGlBc,eAAgB,CACdC,QAASxb,EAAQ4a,gBAEnBa,aAAc3B,EACd4B,aAAW,EACXza,QAAS,WACPsC,QAAQC,IAAI,MAAOsE,GACnB4P,EAAa5P,GACbgT,GAAQ,WAkBxB1C,EAAaxD,aAAe,CAC1BuC,eAAgB,IAGHiB,wCCzHf,IAAAtE,EAAAxG,EAAA,GAAAyG,EAAAzG,EAAA0G,EAAAF,GAAA6H,EAAArO,EAAA,KAAAsO,EAAAtO,EAAA,KAAAuO,EAAAvO,EAAA,KAAAwO,EAAAxO,EAAA,KAAAyO,EAAAzO,EAAA,KAAA0O,EAAA1O,EAAA,KAAA2O,EAAA3O,EAAA0G,EAAAgI,GAAAE,EAAA5O,EAAA,KAmCM/P,EAAYC,YAxBJ,SAAAC,GAAK,MAAK,CACtBuE,KAAM,GAGNma,KAAM,CACJxZ,SAAU,SACV2R,WAAY,WACZ/N,cAAe9I,EAAM0E,QAAQ,IAE/Bia,MAAO,CACLC,UAAW,aACX7d,MAAO,OACPI,OAAQ,EACRG,QAAS,OACTmD,QAASzE,EAAM0E,QAAQ,IAEzBma,SAAU,CACRrS,SAAU,GAEZzD,YAAa,CACX6V,UAAW,aACXze,MAAOH,EAAM8D,QAAQkF,KAAK,SAoCf8V,IA/BC,SAAArd,GAAoC,IAAjCyH,EAAiCzH,EAAjCyH,KAAME,EAA2B3H,EAA3B2H,QAASuV,EAAkBld,EAAlBkd,MAAOD,EAAWjd,EAAXid,KACjCnc,EAAUzC,IAChB,OACEwW,EAAA3W,EAAAmD,cAACsb,EAAA,EAAD,CACEzU,OAAO,QACPT,KAAMA,EACNpC,WAAS,EACTiY,SAAS,KACT3V,QAASA,EACTU,kBAAgB,uBAEhBwM,EAAA3W,EAAAmD,cAACwb,EAAA,EAAD,CAAa7a,UAAWlB,EAAQoc,MAAOK,mBAAiB,GACtD1I,EAAA3W,EAAAmD,cAACob,EAAA,EAAD,CAAYza,UAAWlB,EAAQsc,UAAWF,GAC1CrI,EAAA3W,EAAAmD,cAACub,EAAA,EAAD,CAAY5a,UAAWlB,EAAQwG,YAAavF,QAAS4F,GACnDkN,EAAA3W,EAAAmD,cAAC0b,EAAA7e,EAAD,QAGJ2W,EAAA3W,EAAAmD,cAACqb,EAAA,EAAD,KACE7H,EAAA3W,EAAAmD,cAACob,EAAA,EAAD,CAAY/T,QAAQ,QAAQ1G,UAAWlB,EAAQmc,MAAOA,wCCvD9D,IAAArI,EAAAxG,EAAA,GAAAyG,EAAAzG,EAAA0G,EAAAF,GAAA4I,EAAApP,EAAA,KAAAqP,EAAArP,EAAA,KAAAsP,EAAAtP,EAAA,KAAAuP,EAAAvP,EAAA,KAAAwP,EAAAxP,EAAA,KAAAyP,EAAAzP,EAAA,KAAA4O,EAAA5O,EAAA,KAeM/P,EAAYC,YAHJ,SAAAC,GAAK,MAAK,KA0CTuf,IArCM,SAAA9d,GAAyC,IAAtCkd,EAAsCld,EAAtCkd,MAAOa,EAA+B/d,EAA/B+d,QAASC,EAAsBhe,EAAtBge,UAAWvW,EAAWzH,EAAXyH,KAC3C3G,EAAUzC,IAChB,OACEwW,EAAA3W,EAAAmD,cAACmc,EAAA,EAAD,CACExb,UAAWlB,EAAQgC,KACnBmb,sBAAoB,EACpBxW,KAAMA,EACNyW,sBAAoB,EACpBZ,SAAS,KACTjV,kBAAgB,6BAEhBwM,EAAA3W,EAAAmD,cAACoc,EAAA,EAAD,CAAajb,GAAG,6BAA6B0a,GAC7CrI,EAAA3W,EAAAmD,cAACqc,EAAA,EAAD,KACE7I,EAAA3W,EAAAmD,cAACuc,EAAA,EAAD,KACGG,IAILlJ,EAAA3W,EAAAmD,cAACwc,EAAA,EAAD,KACEhJ,EAAA3W,EAAAmD,cAACsc,EAAA,EAAD,CAAQ5b,QAAS,kBAAMic,GAAU,IAAQtf,MAAM,WAA/C,MAGAmW,EAAA3W,EAAAmD,cAACsc,EAAA,EAAD,CAAQ5b,QAAS,kBAAMic,GAAU,IAAOtf,MAAM,WAA9C,uICPFL,EAAYC,YApBJ,SAAAC,GAAK,MAAK,CACtBuE,KAAM,GAGNma,KAAM,CACJxZ,SAAU,SACV2R,WAAY,WACZ/N,cAAe9I,EAAM0E,QAAQ,IAE/Bia,MAAO,CACLxd,OAAQ,EACRsD,QAASzE,EAAM0E,QAAQ,IAEzBqE,YAAa,CACXxI,SAAU,WACVM,MAAOb,EAAM0E,QAAQ,GACrBjE,IAAKT,EAAM0E,QAAQ,GACnBvE,MAAOH,EAAM8D,QAAQkF,KAAK,SA8Cf4W,IAzCK,SAAAne,GAA4C,IAAzCyH,EAAyCzH,EAAzCyH,KAAM2W,EAAmCpe,EAAnCoe,KAAMlB,EAA6Bld,EAA7Bkd,MAAOD,EAAsBjd,EAAtBid,KAAMoB,EAAgBre,EAAhBqe,UACxCvd,EAAUzC,IAD8CpD,EAEpCC,mBAAS+hB,GAAQ,IAFmBphB,EAAAC,OAAAC,EAAA,EAAAD,CAAAb,EAAA,GAEvDmJ,EAFuDvI,EAAA,GAEhDyiB,EAFgDziB,EAAA,GAG9D,OACE4Y,EAAAvW,EAAAmD,cAACsb,EAAA,EAAD,CACEzU,OAAO,QACPT,KAAMA,EACNpC,WAAS,EACTsC,QAAS,kBAAMyW,EAAKha,KAEpBqQ,EAAAvW,EAAAmD,cAACkd,EAAA,EAAD,CAAavc,UAAWlB,EAAQoc,OAC7BA,GAEHzI,EAAAvW,EAAAmD,cAACqb,EAAA,EAAD,KACEjI,EAAAvW,EAAAmD,cAACmd,EAAA,EAAD,CACExc,UAAWlB,EAAQmc,KACnBoB,UAAWA,EACXhZ,WAAS,EACToZ,KAAM,EACNC,QAAS,GACT3a,SAAU,SAAA9C,GAAC,OAAIqd,EAASrd,EAAE8M,OAAO3J,QACjCua,aAAc1B,KAGlBxI,EAAAvW,EAAAmD,cAACud,EAAA,EAAD,KACEnK,EAAAvW,EAAAmD,cAACwd,EAAA,EAAD,CAAQ9c,QAAS,kBAAMqc,EAAKnB,KAA5B,UACAxI,EAAAvW,EAAAmD,cAAA,OAAKe,MAAO,CAAE2I,SAAU,KACxB0J,EAAAvW,EAAAmD,cAACwd,EAAA,EAAD,CAAQ9c,QAAS,kBAAMqc,EAAKha,KAA5B,kGCbF/F,EAAYC,YAzCJ,SAAAC,GAAK,MAAK,CACtBuE,KAAM,CACJpE,MAAO,QACPiF,OAAQ,GACR9D,QAAS,OACTV,cAAe,SACfL,SAAU,WACVD,OAAQ,MACRG,IAAK,MACLD,KAAM,IACNyM,UAAW,oBAEbsT,YAAa,CACXjf,QAAS,QACTkL,SAAU,EACVE,UAAW,SACXjI,QAASzE,EAAM0E,QAAQ,EAAG,EAAG,EAAG,GAChCkU,WAAY,gCAEd4H,SAAU,CACR/b,QAAS,qBACT1D,MAAO,iBAET0f,KAAM,CACJ1f,MAAK,gBACLV,WAAYL,EAAM8D,QAAQ8I,QAAQkM,KAClC4H,UAAW,sBAEbC,MAAO,CACL5f,MAAK,gBACLV,WAAYL,EAAM8D,QAAQ8I,QAAQqL,MAEpC2I,MAAO,CAELvgB,WAAYL,EAAM8D,QAAQ8I,QAAQqL,KAClC8E,OAAM,aAAA3b,OAAepB,EAAM8D,QAAQ8I,QAAQkM,MAC3C+H,WAAY,kBACZ9f,MAAO,GACPT,OAAQ,OAKNwgB,EAAkB,SAAArf,GAAgC,IAA7B2e,EAA6B3e,EAA7B2e,aAAc5a,EAAe/D,EAAf+D,SACjCjD,EAAUzC,IADsCpD,EAG1BC,mBAASyjB,GAHiB9iB,EAAAC,OAAAC,EAAA,EAAAD,CAAAb,EAAA,GAG/CqkB,EAH+CzjB,EAAA,GAGvC0jB,EAHuC1jB,EAAA,GAWtD,OACE4Y,EAAAvW,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQgC,MACtB2R,EAAAvW,EAAAmD,cAAC4T,EAAA,EAAD,CAAYjT,UAAWlB,EAAQge,YAAapgB,MAAM,UAAUgK,QAAQ,WAApE,OACA+L,EAAAvW,EAAAmD,cAACme,EAAA,EAAD,CACE1e,QAAS,CACPie,SAAUje,EAAQie,SAClBC,KAAMle,EAAQke,KACdE,MAAOpe,EAAQoe,MACfC,MAAOre,EAAQqe,OAEjB/a,MAAOkb,EACPjX,kBAAgB,QAChBtE,SAlBe,SAACxH,EAAO6H,GAC3Bmb,EAAUnb,GAEVL,EAASK,IAgBLqb,YAAY,aAEdhL,EAAAvW,EAAAmD,cAAC4T,EAAA,EAAD,CAAYjT,UAAWlB,EAAQge,YAAapgB,MAAM,UAAUgK,QAAQ,WAApE,eAUN2W,EAAgB3J,aAAe,CAC7BiJ,aAAc,IACd5a,SAAU,cAGGsb,mICzFFK,EAAY,SAACC,EAAWrgB,EAAOT,GAAW,IAAA5D,EACfC,oBAAS,GADMW,EAAAC,OAAA8jB,EAAA,EAAA9jB,CAAAb,EAAA,GAC9C4kB,EAD8ChkB,EAAA,GACjCikB,EADiCjkB,EAAA,GAAAmB,EAEb9B,oBAAS,GAFImC,EAAAvB,OAAA8jB,EAAA,EAAA9jB,CAAAkB,EAAA,GAE9C+iB,EAF8C1iB,EAAA,GAEhC2iB,EAFgC3iB,EAAA,GAG/C4iB,EAAS9jB,mBAEfM,oBAAU,WACRwjB,EAAO5jB,QAAU,IAAI6jB,EACnBC,SAASC,eAAe,UACxBD,SAAS9e,cAAc,WAEzB4e,EAAO5jB,QAAQgkB,MACbxhB,GAAUpB,OAAO+M,WACjBlL,GAAS7B,OAAOiN,aAEf4V,KAAK,SAACze,GACLme,GAAgB,KAEjBO,MAAM,SAACtf,GACNoD,QAAQqJ,MAAMzM,GACd6e,GAAe,MAElB,CAACxgB,EAAOT,IAgBX,MAAO,CAAEghB,cAAaW,aAdD,WACnB,GAAIP,EAAO5jB,SAAW0jB,EAAc,CAClC,IAAMU,EAAeR,EAAO5jB,QAAQqkB,gBAAgB,CAAE5M,KAAM,OAAQ6M,QAAS,IAC7EhB,EAAUc,KAWsBV,eAAca,eAP3B,WACrB,GAAIX,EAAO5jB,SAAW0jB,EAAc,CAClC,IAAMU,EAAeR,EAAO5jB,QAAQwkB,gBACpClB,EAAUc,OAOVP,aACJ,SAAAA,EAAaY,EAAeC,GAAgBjlB,OAAAkX,EAAA,EAAAlX,CAAAiX,KAAAmN,GAC1CnN,KAAK+N,cAAgBA,EACrB/N,KAAKgO,cAAgBA,EAEY,WAA7BtjB,OAAOujB,SAASC,UAAsD,cAA7BxjB,OAAOujB,SAASE,UAC3D7c,QAAQ8c,KAAK,qGAGVzkB,UAAU0kB,cAAiB1kB,UAAU2kB,cACxChd,QAAQ8c,KAAR,4JAIa7hB,EAAOT,GACtB,IAAMyiB,EAAchiB,EAAQT,EACxBS,GAAST,EACXkU,KAAK+N,cAAcxhB,MAAQgiB,EAAcvO,KAAK+N,cAAcjiB,OAErDS,EAAQT,IACfkU,KAAK+N,cAAcjiB,OAASkU,KAAK+N,cAAcxhB,MAAQgiB,6IAKzD,IACEvO,KAAK+N,cAAcS,UAAUC,YAAY,GAAGC,OAC5C1O,KAAK+N,cAAgB,KACrB/N,KAAKgO,cAAgB,KAEvB,MAAO9f,GACLoD,QAAQqJ,MAAMzM,2KAIL3B,EAAOT,uGACX,IAAI6iB,QAAQ,SAACC,EAASC,QACiBC,IAAxCnlB,UAAU0kB,aAAaC,aACzB3kB,UAAU0kB,aAAaC,aAAa,CAAES,OAAO,EAAOC,MAAO,CAAEC,WAAY,cAAe1iB,QAAOT,YAC5FyhB,KAAK,SAAC2B,GACD,cAAenP,EAAKgO,cACtBhO,EAAKgO,cAAcS,UAAYU,EAI/BnP,EAAKgO,cAAclT,IAAMnQ,OAAOykB,IAAIC,gBAAgBF,GAEtDnP,EAAKgO,cAAcsB,iBAAmB,SAACnhB,GACrC6R,EAAKgO,cAAcuB,QAErBvP,EAAKgO,cAAcwB,UAAY,SAACrhB,GAC9B0gB,OAGHpB,MAAM,SAAA9S,GAAG,OAAImU,EAAOnU,KAGvBmU,EAAO,IAAIvN,MAAM,mKAMrB,IAAMkO,EAAaxP,KAAK+N,cAAc0B,WAChCC,EAAc1P,KAAK+N,cAAc4B,YAEjCC,EAAU5P,KAAKgO,cAAc6B,WAAW,MAM9C,OALA7P,KAAKgO,cAAczhB,MAAQijB,EAC3BxP,KAAKgO,cAAcliB,OAAS4jB,EAE5BE,EAAQE,UAAU9P,KAAK+N,cAAe,EAAG,EAAGyB,EAAYE,GAEjD,CAAEA,cAAaF,sDAGP,IAAAO,EACqB/P,KAAKgQ,aAAjCN,EADOK,EACPL,YAAaF,EADNO,EACMP,WACf1gB,EAAO,CAAEA,KAAM,KAAM4gB,cAAaF,cACxC,IACE1gB,EAAKA,KAAOkR,KAAKgO,cACd6B,WAAW,MACXI,aACC,EACA,EACAT,EACAE,GACA5gB,KAEN,MAAOZ,IAEP,OAAOY,0CAGQ,IAAAohB,EAAAlQ,KAAAmQ,EACqBnQ,KAAKgQ,aAAjCR,EADOW,EACPX,WAAYE,EADLS,EACKT,YACpB,OAAO,IAAIf,QAAQ,SAACC,EAASC,GAC3BqB,EAAKlC,cAAcoC,OAAO,SAACC,GACzBzB,EAAQ,CAAEyB,OAAMX,cAAaF,6DAKgC,IAAAviB,EAAAqjB,UAAA5a,OAAA,QAAAoZ,IAAAwB,UAAA,GAAAA,UAAA,GAA9B,CAAEvP,KAAM,OAAQ6M,QAAS,GAA3C7M,EAAgD9T,EAAhD8T,KAAM6M,EAA0C3gB,EAA1C2gB,QAA0C2C,EAC7BvQ,KAAKgQ,aAAjCN,EADyDa,EACzDb,YAAaF,EAD4Ce,EAC5Cf,WAErB,MAAO,CAAE5V,OADMoG,KAAKgO,cAAcwC,UAAU,SAAWzP,EAAM6M,GAC5C8B,cAAaF,oKCnJnBiB,EAAA,SAAAjlB,GAAK,MAAK,CACvBuE,KAAM,CACJxD,MAAO,QAETmkB,aAAc,GAEd9X,YAAa,GAGb+X,cAAe,CACbzY,UAAW,SAEblI,iBAAkB,CAChBC,QAASzE,EAAM0E,QAAQ,EAAG,IAE5BC,YAAa,CACXvE,SAAU,IAEZwE,YAAa,CACXrE,SAAU,WACVC,KAAM,EACNJ,SAAU,IAEZyE,MAAO,CACLvD,QAAS,OACTmD,QAAS,GAEXK,eAAgB,CACdxD,QAAS,OACTyD,SAAU,OACVC,KAAM,EACNC,WAAY,SACZC,SAAU,UAEZC,MAAO,CACL5E,SAAU,WACV6E,OAAQ,EACRC,UAAWrF,EAAM0E,QAAQ,GACzBlE,KAAM,EACNK,MAAO,KC9BLf,EAAYC,YAAW8D,GA+BduhB,EA3BI,SAAA3jB,GAA2C,IAAxC6H,EAAwC7H,EAAxC6H,KAAa/D,GAA2B9D,EAAlCuC,MAAkCvC,EAA3B8D,WAAW9B,EAAgBhC,EAAhBgC,UACtClB,EAAUzC,IAEVulB,EAAY/b,EAAKC,OAAO,SAAA5H,GAAG,OAAIA,EAAIgT,SAAWpP,EAAUtB,KAAOtC,EAAI1D,SAEzE,OACE4E,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWC,IAAWnB,EAAQgC,KAAMd,IACvCZ,EAAAlD,EAAAmD,cAAC4E,EAAA,EAAD,CAAYyC,QAAQ,WAAW1G,UAAWlB,EAAQ+iB,YAC/C/f,EAAUvB,OAEbnB,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQ2iB,cACrBG,EAAU1f,IAAI,SAAChE,EAAK0I,GAAN,OACbxH,EAAAlD,EAAAmD,cAACkT,EAAA,EAAD,CAASrU,IAAKA,EAAK2I,IAAG,UAAAlJ,OAAYiJ,GAAOlK,MAAOoF,EAAUpF,wCCA9DL,EAAYC,YAfJ,SAAAC,GAAK,MAAK,CACtBuE,KAAM,GAENghB,SAAU,GAEVnY,YAAa,CACXrM,MAAO,QAETykB,SAAU,CACR3O,WAAY,YAEdsO,cAAe,CACbzY,UAAW,YAsCA+Y,EAjCK,SAAAhkB,GAMd,IALJuC,EAKIvC,EALJuC,MACA6B,EAIIpE,EAJJoE,MACA6f,EAGIjkB,EAHJikB,KACAlgB,EAEI/D,EAFJ+D,SACA/B,EACIhC,EADJgC,UAEMlB,EAAUzC,IAChB,OACE+C,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWC,IAAWnB,EAAQgC,KAAMd,IACvCZ,EAAAlD,EAAAmD,cAAC4E,EAAA,EAAD,CAAYyC,QAAQ,WAAW1G,UAAWlB,EAAQ+iB,YAC/CthB,GAEHnB,EAAAlD,EAAAmD,cAAC+D,EAAA,EAAD,CACE0O,KAAK,iBACLzO,WAAS,EACTjB,MAAO8f,YAAsB9f,GAC7BpC,UAAWlB,EAAQqjB,UACnBpgB,SAAU,SAAC9C,GAAD,OAAO8C,EAASqgB,YAAsBnjB,EAAE8M,OAAO3J,WAE1D6f,GAAQ7iB,EAAAlD,EAAAmD,cAAC4E,EAAA,EAAD,CAAYyC,QAAQ,UAAU1G,UAAWlB,EAAQmjB,MAAOA,8LChCjE5lB,EAAYC,YAAW8D,GAuJ7BiiB,EAlJmB,SAAArkB,GAGb,IAFJ6H,EAEI7H,EAFJ6H,KAAM9D,EAEF/D,EAFE+D,SACNkgB,EACIjkB,EADJikB,KAAMngB,EACF9D,EADE8D,UAAW9B,EACbhC,EADagC,UAEXlB,EAAUzC,IAEVimB,EAAiB,SAACC,EAADve,GAAkD,IAAnCwe,EAAmCxe,EAAnCwe,OAAQC,EAA2Bze,EAA3Bye,aAAcC,EAAa1e,EAAb0e,OAE1D,OAAQF,GACN,IAAK,QACHzgB,EAAS,IACT,MACF,IAAK,eAEHA,EAAS8D,EAAKC,OAAO,SAAA6c,GAAG,OAAIA,EAAIniB,KAAOiiB,EAAargB,SACpD,MACF,IAAK,gBACH,IAAMwgB,EAAM9oB,OAAA2J,EAAA,EAAA3J,CAAA,GACPgI,EAAUG,OAAOmP,KAAK,SAAAyR,GAAG,OAAIA,EAAIriB,KAAOkiB,EAAOtgB,QADxC,CAEV8O,OAAQpP,EAAUtB,KAEpBuB,EAAQ,GAAApE,OAAA7D,OAAAiO,EAAA,EAAAjO,CAAK+L,GAAL,CAAW+c,KACnB,MACF,IAAK,gBACH,IACME,EAAe,CACnBviB,MAFegiB,EAAWnR,KAAK,SAAA2R,GAAC,OAAIA,EAAEnb,YAAWxF,MAGjD5B,GAAI4T,MACJlD,OAAQpP,EAAUtB,IAEpBuB,EAAQ,GAAApE,OAAA7D,OAAAiO,EAAA,EAAAjO,CAAK+L,GAAL,CAAWid,OAsCnBlB,EAAY/b,EAAKC,OAAO,SAAA5H,GAAG,OAAIA,EAAIgT,SAAWpP,EAAUtB,KAAOtC,EAAI1D,SAEnEwoB,EAAgBpB,EAAU1f,IAAI,SAAAygB,GAAG,MAAK,CAAEpiB,MAAOoiB,EAAIpiB,MAAO6B,MAAOugB,EAAIniB,MAIrEyiB,EAAgBnhB,EAAUG,OAC7B6D,OAAO,SAAA6c,GAAG,OAAkD,IAA9Cf,EAAU1f,IAAI,SAAA6D,GAAC,OAAIA,EAAEvF,KAAIwT,QAAQ2O,EAAIniB,MACnD0B,IAAI,SAAAygB,GAAG,MAAK,CAAEpiB,MAAOoiB,EAAIpiB,MAAO6B,MAAOugB,EAAIniB,MAI9C,OACEpB,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWC,IAAWnB,EAAQgC,KAAMd,IACvCZ,EAAAlD,EAAAmD,cAAC4E,EAAA,EAAD,CAAYyC,QAAQ,WAAW1G,UAAWlB,EAAQ+iB,YAC/C/f,EAAUvB,QAEXuB,EAAUS,gBACVnD,EAAAlD,EAAAmD,cAACmD,EAAA,EAAD,CACER,QAASihB,EACTnkB,QAASA,EACT0F,WAAS,EACT/B,WAAY,CACVC,UACAC,OAEAC,mBACAC,SACAC,cAEAC,kBAEFmgB,eAAa,EACb9gB,MAAO4gB,EACP/f,aAAa,EACblB,SAAUugB,EACVnhB,YAAY,cACZgiB,SAAO,EACPjgB,cAAY,IAGdpB,EAAUS,gBACVnD,EAAAlD,EAAAmD,cAAC8D,EAAAjH,EAAD,CACE8F,QAASihB,EACTnkB,QAASA,EACT0F,WAAS,EACT0e,eAAa,EACbzgB,WAAY,CACVC,UACAC,OAEAC,mBACAC,SACAC,cAEAC,kBAEFX,MAAO4gB,EACP/f,aAAa,EACblB,SAAUugB,EACVnhB,YAAY,cACZgiB,SAAO,EACPjgB,cAAY,IAGf+e,GAAQ7iB,EAAAlD,EAAAmD,cAAC4E,EAAA,EAAD,CAAYyC,QAAQ,UAAU1G,UAAWlB,EAAQmjB,MAAOA,KAevE,SAASvf,EAASlE,GAEhB,OACEY,EAAAlD,EAAAmD,cAAC+D,EAAA,EAADtJ,OAAAqG,OAAA,CACEkD,WAAS,EACTC,WAAY,CACVC,iBACAC,WAAY,CACVxD,UAAWxB,EAAMkF,YAAY5E,QAAQsC,MACrCuC,SAAUnF,EAAMoF,SAChBC,SAAUrF,EAAMqF,SAEhBuf,YAAa,SAACnkB,GACZT,EAAMsF,WAAWsf,YAAYnkB,IAE/BokB,WAAY,SAACpkB,GACXT,EAAMsF,WAAWuf,WAAWpkB,OAM9BT,EAAMkF,YAAYK,iBAK5B,IAAMnB,EAAmB,SAAA2B,GAAA,IAAGT,EAAHS,EAAGT,WAAYJ,EAAfa,EAAeb,YAAaG,EAA5BU,EAA4BV,SAA5B,OACvBzE,EAAAlD,EAAAmD,cAAC4E,EAAA,EAADnK,OAAAqG,OAAA,CACEzD,MAAM,gBACNsD,UAAW0D,EAAY5E,QAAQiC,kBAC3B+C,GAEHD,IAIClB,EAAO,SAAAoC,GAAA,IAAGrB,EAAHqB,EAAGrB,YAAaI,EAAhBiB,EAAgBjB,WAAYD,EAA5BkB,EAA4BlB,SAA5B,OACXzE,EAAAlD,EAAAmD,cAAC8E,EAAA,EAADrK,OAAAqG,OAAA,CAAOiE,QAAM,EAACpE,UAAW0D,EAAY5E,QAAQ4C,OAAWoC,GACrDD,IAKCN,EAAiB,SAAA+f,GAAA,IAAG3f,EAAH2f,EAAG3f,SAAanF,EAAhB1E,OAAA2E,EAAA,EAAA3E,CAAAwpB,EAAA,qBAA4BlkB,EAAAlD,EAAAmD,cAAA,MAAAvF,OAAAqG,OAAA,CAAKmE,IAAKX,GAAcnF,KAErEsE,EAAc,SAACtE,GAAD,OAClBY,EAAAlD,EAAAmD,cAAC4E,EAAA,EAADnK,OAAAqG,OAAA,CACEzD,MAAM,gBACNsD,UAAWxB,EAAMkF,YAAY5E,QAAQqC,aACjC3C,EAAMsF,YAETtF,EAAMqF,WAILhB,EAAS,SAAA0gB,GAAA,IAAG3f,EAAH2f,EAAG3f,SAAUY,EAAb+e,EAAa/e,UAAWC,EAAxB8e,EAAwB9e,WAAYX,EAApCyf,EAAoCzf,WAAYD,EAAhD0f,EAAgD1f,SAAhD,OACbzE,EAAAlD,EAAAmD,cAACqF,EAAA,EAAD5K,OAAAqG,OAAA,CACEwE,UAAWf,EACXgB,SAAUJ,EACVK,UAAU,MACVzE,MAAO,CAAE0E,WAAYL,EAAa,IAAM,MACpCX,GAEHD,IAICd,EAAiB,SAAAygB,GAAA,IAAG9f,EAAH8f,EAAG9f,YAAaG,EAAhB2f,EAAgB3f,SAAhB,OACrBzE,EAAAlD,EAAAmD,cAAA,OAAKW,UAAW0D,EAAY5E,QAAQuC,gBAAiBwC,ICtMjDxH,EAAYC,YAvBJ,SAAAC,GAAK,MAAK,CACtBuE,KAAM,GAEN2iB,WAAY,CAGVC,UAAW,oBACXre,cAAe,KAGjB6V,MAAO,CACL5d,MAAO,OACPI,OAAQ,EACRG,QAAS,OACTmD,QAASzE,EAAM0E,QAAQ,IAEzBma,SAAU,CACRrS,SAAU,GAEZzD,YAAa,CACX5I,MAAOH,EAAM8D,QAAQkF,KAAK,SAiDfoe,GA5CC,SAAA3lB,GAAsD,IAAnDyH,EAAmDzH,EAAnDyH,KAAMyV,EAA6Cld,EAA7Ckd,MAAOkB,EAAsCpe,EAAtCoe,KAAMwH,EAAgC5lB,EAAhC4lB,SAAU/d,EAAsB7H,EAAtB6H,KAAM/D,EAAgB9D,EAAhB8D,UAC9ChD,EAAUzC,IADoDpD,EAE1CC,mBAAS2M,GAFiChM,EAAAC,OAAAsN,EAAA,EAAAtN,CAAAb,EAAA,GAE7DmJ,EAF6DvI,EAAA,GAEtDyiB,EAFsDziB,EAAA,GAGpE,OACEuF,EAAAlD,EAAAmD,cAAC4G,EAAA,EAAD,CACEjG,UAAWlB,EAAQgC,KACnBoF,OAAO,OACPC,YAAU,EACVV,KAAMA,EACNE,QAAS,kBAAMyW,EAAKha,KAEpBhD,EAAAlD,EAAAmD,cAACiH,EAAA,EAAD,CAAatG,UAAWlB,EAAQoc,MAAOK,mBAAiB,GACtDnc,EAAAlD,EAAAmD,cAAC4E,EAAA,EAAD,CAAYjE,UAAWlB,EAAQsc,UAAWF,GAC1C9b,EAAAlD,EAAAmD,cAACkH,EAAA,EAAD,CAAYvG,UAAWlB,EAAQwG,YAAavF,QAAS6jB,GACnDxkB,EAAAlD,EAAAmD,cAACmH,EAAAtK,EAAD,QAGJkD,EAAAlD,EAAAmD,cAACwkB,EAAA,EAAD,CAAe7jB,UAAWlB,EAAQ2kB,YAChCrkB,EAAAlD,EAAAmD,cAACgjB,EAAD,CACEriB,UAAWlB,EAAQglB,MACnBje,KAAMzD,EACNN,UAAWA,EACXC,SAAUua,KAGdld,EAAAlD,EAAAmD,cAAC0kB,EAAA,EAAD,KACE3kB,EAAAlD,EAAAmD,cAAC2kB,EAAA,EAAD,CAAQjkB,QAAS6jB,GAAjB,UACAxkB,EAAAlD,EAAAmD,cAAA,OAAKe,MAAO,CAAE2I,SAAU,KACxB3J,EAAAlD,EAAAmD,cAAC2kB,EAAA,EAAD,CAAQjkB,QAAS,kBAAMuc,EAASzW,KAAhC,SACAzG,EAAAlD,EAAAmD,cAAC2kB,EAAA,EAAD,CAAQjkB,QAAS,kBAAMqc,EAAKha,KAA5B,kBClDF/F,GAAYC,YAbJ,SAAAC,GAAK,MAAK,CACtBuE,KAAM,GACNghB,SAAU,GACVnY,YAAa,CACXrM,MAAO,QAETykB,SAAU,CACR3O,WAAY,YAEdsO,cAAe,CACbzY,UAAW,YA2BAgb,GAtBE,SAAAjmB,GAIX,IAHJuC,EAGIvC,EAHJuC,MACA6B,EAEIpE,EAFJoE,MACApC,EACIhC,EADJgC,UAEMlB,EAAUzC,KAChB,OACE+C,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWC,IAAWnB,EAAQgC,KAAMd,IACvCZ,EAAAlD,EAAAmD,cAAC4E,EAAA,EAAD,CAAYyC,QAAQ,WAAW1G,UAAWlB,EAAQ+iB,YAC/CthB,GAEHnB,EAAAlD,EAAAmD,cAAC4E,EAAA,EAAD,CAAYyC,QAAQ,QAAQ1G,UAAWlB,EAAQmjB,MAAO7f,EAAQ8hB,YAAW9hB,GAAS,MCWlF/F,GAAYC,YAtBJ,SAAAC,GAAK,MAAK,CACtBuE,KAAM,CACJjE,OAAQ,MACRS,MAAO,OAET6mB,kBAAmB,CACjBtmB,QAAS,OACTmD,QAAS,GAEXojB,YAAa,CACXxiB,UAAWrF,EAAM0E,QAAQ,IAE3Bma,SAAU,CACRrS,SAAU,EACVsb,WAAY9nB,EAAM0E,QAAQ,GAC1BoE,cAAe9I,EAAM0E,QAAQ,GAC7BkE,YAAa5I,EAAM0E,QAAQ,IAE7B6iB,MAAO,CACLtK,aAAcjd,EAAM0E,QAAQ,OAK1BqjB,GACM,WADNA,GAEM,WAFNA,GAIK,MA4HIC,IAxHG,SAAAvmB,GAAyC,IAAtCwmB,EAAsCxmB,EAAtCwmB,QAASxd,EAA6BhJ,EAA7BgJ,MAAOyd,EAAsBzmB,EAAtBymB,MAAO1iB,EAAe/D,EAAf+D,SACpCjD,EAAUzC,KACRqJ,EAAiBwB,qBAAWC,MAA5BzB,aAFiDzM,EAGQC,mBAAS,IAHjBW,EAAAC,OAAAsN,EAAA,EAAAtN,CAAAb,EAAA,GAAAyrB,EAAA7qB,EAAA,GAGhD8qB,EAHgDD,EAGhDC,aAAcC,EAHkCF,EAGlCE,oBAAuBC,EAHWhrB,EAAA,GAKnDirB,EAAU,IAAIC,IAASrf,EAAc+e,EAAM5e,MAAQmB,EAAMnB,MAE3Dmf,EAAW,GACf,IACEA,EAAWhe,EAAM6K,KAAO/X,OAAO8X,KAAKqT,KAAKC,MAAMle,EAAM6K,OAAS,GAEhE,MAAO5S,GACLoD,QAAQqJ,MAAMzM,GAEhB,OACEG,EAAAlD,EAAAmD,cAAA,WACGmlB,EACCplB,EAAAlD,EAAAmD,cAAC8lB,EAAD,CACEnlB,UAAWlB,EAAQglB,MACnBvjB,MAAM,iBACN6B,MAAOqiB,EAAMW,SAAWpe,EAAMoe,QAC9BrjB,SAAU,SAAAqjB,GAAO,OAAIrjB,EAAS,CAAEqjB,aAChCZ,QAASA,IAITplB,EAAAlD,EAAAmD,cAACgmB,GAAD,CACE9kB,MAAM,iBACN6B,MAAOqiB,EAAMW,SAAWpe,EAAMoe,WAIlCZ,GAAWxd,EAAMse,OACjBlmB,EAAAlD,EAAAmD,cAACkU,EAAA,EAAD,CACEhT,MAAM,aACNiT,KAAMiR,EAAMa,MAAQte,EAAMse,KAC1BvlB,QAAS,WACM8kB,EAATL,EAAyB,CAAEG,aAAcL,IACxB,CAAEK,aAAcL,QAI3CllB,EAAAlD,EAAAmD,cAAC4E,EAAA,EAAD,CAAYyC,QAAQ,YAAY1G,UAAWlB,EAAQslB,aAAnD,iBACAhlB,EAAAlD,EAAAmD,cAACkmB,EAAA,EAAD,MACCT,EAAQpf,aAAa+L,mBAAmBvP,IAAI,SAACmP,EAAIzK,GAAL,OAC3CxH,EAAAlD,EAAAmD,cAAA,OACEwH,IAAG,WAAAlJ,OAAaiJ,GAChB7G,QAAS,kBAAMykB,EAAUK,EAAgB,CAAEF,aAAcL,GAAiBM,oBAAqBvT,IAAQ,OAEvGjS,EAAAlD,EAAAmD,cAACmmB,EAAD,CACExlB,UAAWlB,EAAQglB,MACnBvjB,MAAO8Q,EAAG9Q,MACVsF,KAAM4e,EAAM5e,MAAQmB,EAAMnB,KAC1B/D,UAAWuP,OAKhB2T,EAASve,OAAS,GAAK3M,OAAO8X,KAAKlM,EAAamM,MAAMpL,OAAS,GAC9DrH,EAAAlD,EAAAmD,cAACD,EAAAlD,EAAMupB,SAAP,KACErmB,EAAAlD,EAAAmD,cAAC4E,EAAA,EAAD,CAAYjE,UAAWlB,EAAQxF,SAA/B,YACA8F,EAAAlD,EAAAmD,cAACkmB,EAAA,EAAD,MACAnmB,EAAAlD,EAAAmD,cAACqmB,EAAA,EAAD,CAAM1lB,UAAWlB,EAAQ6mB,MACtBX,EAAS9iB,IAAI,SAAC2E,EAAKD,GAAN,OAAclB,EAAamM,KAAKhL,GAC5CzH,EAAAlD,EAAAmD,cAACumB,EAAA,EAAD,CAAU/e,IAAG,WAAAlJ,OAAaiJ,IACxBxH,EAAAlD,EAAAmD,cAACwmB,EAAA,EAAD,CACE1c,QAASzD,EAAamM,KAAKhL,GAAKtG,MAChC6I,UAAW1D,EAAamM,KAAKhL,GAAKif,OAAO9e,EAAM6K,KAAKhL,OAGtD,SAKT8d,GAAgBA,IAAiBL,IAChCllB,EAAAlD,EAAAmD,cAAC8c,EAAA,EAAD,CACE1W,MAAI,EACJ4W,WAAS,EACTD,KAAM,SAAAkJ,GACJvjB,EAAS,CAAEujB,SACXT,EAAgB,KAElB3J,MAAM,kBACND,KAAMwJ,EAAMa,MAAQte,EAAMse,OAG7BX,GAAgBA,IAAiBL,IAChCllB,EAAAlD,EAAAmD,cAACgc,EAAA,EAAD,CACE5V,MAAI,EACJ4W,WAAS,EACT1W,QAAS,kBAAMkf,EAAgB,KAC/B3J,MAAM,aACND,KAAMwJ,EAAMa,MAAQte,EAAMse,OAG7BX,GAAgBA,IAAiBL,IAChCllB,EAAAlD,EAAAmD,cAAC0mB,GAAD,CACEtgB,MAAI,EACJyV,MAAK,cAAAvd,OAAgBinB,EAAoBrkB,OACzC6b,KAAM,SAAAvW,GACJgf,EAAgB,IAChB9iB,EAAS,CAAE8D,UAEb+d,SAAU,kBAAMiB,EAAgB,KAChChf,KAAM4e,EAAM5e,MAAQmB,EAAMnB,KAC1B/D,UAAW8iB,wICnIfvoB,EAAYC,YAzBJ,SAAAC,GAAK,MAAK,CACtBuE,KAAM,CACJxD,MAAO,EACPT,OAAQ,EACR8E,OAAQ,GAEVgT,OAAQ,CACNrX,MAAO,GACPT,OAAQ,GACRC,SAAU,WACVE,IAAK,MACLD,KAAM,MACNkM,UAAW,SACXwL,gBAAiB,UACjBjL,UAAW,qCAEbwc,eAAgB,CACdlpB,SAAU,WACVE,IAAK,MACLD,KAAM,MACNkM,UAAW,SACXwL,gBAAiB,UACjBjL,UAAW,wCA8CAyc,EAzCI,SAAAjoB,GAA8BA,EAA3BlB,SAA2B,IAAjB2Z,EAAiBzY,EAAjByY,WACxB3X,EAAUzC,IAKV6pB,EAJW,GAICzP,EAAW0P,eAAe,GACtCC,EALW,GAKA3P,EAAW0P,eAAe,GAC3C,OACE/mB,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQgC,MAEtB1B,EAAAlD,EAAAmD,cAAA,OACEe,MAAO,CAAEvD,OAAQqpB,EAAW5oB,MAAO8oB,GACnCpmB,UAAWlB,EAAQknB,eACnBxQ,QAAQ,MACRC,QAAQ,kBAERrW,EAAAlD,EAAAmD,cAAA,UAAQqW,GAAG,KAAKC,GAAG,KAAKC,EAAG,GACzBf,OAAO,UACPiB,YAAY,MACZf,YAAY,IACZC,KAAK,aAIT5V,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQ6V,OAAQa,QAAQ,MAAMC,QAAQ,gBACpDrW,EAAAlD,EAAAmD,cAAA,UAAQqW,GAAG,IAAIC,GAAG,IAAIC,EAAE,IACtBf,OAAO,UACPE,YAAY,IACZC,KAAK,qEC/BT3Y,EAAYC,YAtBJ,SAAAC,GAAK,MAAK,CACtBuE,KAAM,CACJwY,OAAQ,YACR1c,WAAYL,EAAM8D,QAAQkF,KAAK,KAC/B7I,MAAO,QACPY,MAAO,GACPT,OAAQ,GACR8E,OAAQ,GACR7E,SAAU,eAyCCupB,EAzBU,SAAAroB,GAA2C,IAAxC+B,EAAwC/B,EAAxC+B,QAASkW,EAA+BjY,EAA/BiY,eAAgB1W,EAAevB,EAAfuB,SAC7CT,EAAUzC,IACVE,EAAQwC,cACd,OACEK,EAAAlD,EAAAmD,cAACinB,EAAA,EAAD,CACE/mB,SAAUA,EACVa,MAAO,CACLpD,IAAK,IAAMiZ,EAAejZ,IAAMiZ,EAAejZ,IAAMT,EAAM0E,QAAQ,IACnE7D,MAAO6Y,EAAe7Y,MAAQ6Y,EAAe7Y,MAAQb,EAAM0E,QAAQ,IAErEslB,aAAW,aACXvmB,UAAWlB,EAAQgC,KACnBf,QAASA,GAETX,EAAAlD,EAAAmD,cAACwB,EAAA3E,EAAD,iCC1BA4b,iBAAU,SAACtZ,GAAU,IAGvB0Z,EAgBE1Z,EAhBF0Z,OACArU,EAeErF,EAfFqF,SACAsS,EAcE3X,EAdF2X,UACAF,EAaEzX,EAbFyX,eACUuQ,EAYRhoB,EAZF0X,SACA1W,EAWEhB,EAXFgB,OACAinB,EAUEjoB,EAVFioB,aACAtO,EASE3Z,EATF2Z,QACAV,EAQEjZ,EARFiZ,UACkBiP,EAOhBloB,EAPF4Z,iBACmBuO,EAMjBnoB,EANFooB,kBACiBC,EAKfroB,EALFsoB,gBACAC,EAIEvoB,EAJFuoB,YACA3Q,EAGE5X,EAHF4X,eACAoB,EAEEhZ,EAFFgZ,aACGnB,EAlBoBvc,OAAA2E,EAAA,EAAA3E,CAmBrB0E,EAnBqB,oNAqBnBwoB,EAAkB7sB,iBAAO,MACzB8sB,EAAY9sB,iBAAO,MACnB+sB,EAAsB/sB,iBAAO,MAE3B+Q,EAASF,YAAiBgc,GAA1B9b,KAzBiBjS,EA2BSC,mBAASue,GA3BlB5d,EAAAC,OAAAsN,EAAA,EAAAtN,CAAAb,EAAA,GA2BlBsd,EA3BkB1c,EAAA,GA2BP2c,EA3BO3c,EAAA,GAAAmB,EA8BO9B,mBAASY,OAAA2J,EAAA,EAAA3J,CAAA,GAAKqtB,EAAoBX,IA9BzCnrB,EAAAvB,OAAAsN,EAAA,EAAAtN,CAAAkB,EAAA,GA8BlBkb,EA9BkB7a,EAAA,GA8BR+rB,EA9BQ/rB,EAAA,GAAA8O,EA+BqBjR,oBAAS,GA/B9BkR,EAAAtQ,OAAAsN,EAAA,EAAAtN,CAAAqQ,EAAA,GA+BlBkd,EA/BkBjd,EAAA,GA+BDkd,EA/BCld,EAAA,GAAAG,EAgCWrR,mBAAS,MAhCpBsR,EAAA1Q,OAAAsN,EAAA,EAAAtN,CAAAyQ,EAAA,GAgClBkM,EAhCkBjM,EAAA,GAgCNkM,GAhCMlM,EAAA,GAkCrB+c,GAAa,GACbrP,IACFqP,GAAavuB,eAEf,IAAMwuB,GAAaD,GAAWhuB,UAAYguB,GAAW/tB,UAEjD4F,EAAAlD,EAAAmD,cAACyX,EAAA,EAAD,CAAQjQ,IAAI,QAAQ7G,UAAU,cAAczG,SAAUguB,GAAWhuB,SAAUC,UAAW+tB,GAAW/tB,UAAW4G,MAAO,CAAEuB,OAAQ,IAC3HvC,EAAAlD,EAAAmD,cAACooB,EAAD,CAAY3qB,SAAUyqB,GAAY9Q,WAAYA,KAE9C,KAGNI,kBAAQ,WACN,MAAK3L,GAAQA,EAAK5N,MAAQ,IAAM4N,EAAKrO,OAAS,IAA9C,CACIsZ,EAAU1P,QAAU8P,GAAWC,EAAaiB,GAChD,IACE,IAAMhB,EAAaG,YAAkBV,GAErCQ,GAAcD,GAEhB,MAAOxX,GACLoD,QAAQC,IAAI,QAAS4T,GACrB7T,QAAQqJ,MAAMzM,MAEf,CAACiX,EAASwR,KAAMxc,IAEnB,IAwBMkN,GAAmB,SAACuP,GACxB,IAAMC,EAAW9tB,OAAA2J,EAAA,EAAA3J,CAAA,GAAQ6tB,GAErBnoB,GAAUinB,IACRmB,EAAYpuB,UAAYgG,EAAO,GAAIooB,EAAYpuB,UAAYgG,EAAO,GAC7DooB,EAAYpuB,UAAYgG,EAAO,KAAIooB,EAAYpuB,UAAYgG,EAAO,IAEvEooB,EAAYruB,SAAWiG,EAAO,GAAIooB,EAAYruB,SAAWiG,EAAO,GAC3DooB,EAAYruB,SAAWiG,EAAO,KAAIooB,EAAYruB,SAAWiG,EAAO,KAEvE2Y,IACFyP,EAAYruB,SAAW2c,EAAS3c,SAChCquB,EAAYpuB,UAAY0c,EAAS1c,WAK9B6tB,GAAuD,oBAA7BX,GAC7BA,EAAyB,CACvBxQ,SAAU0R,EACV1c,OACAuL,aACAvU,IAAK+kB,EAAU5sB,SAAW4sB,EAAU5sB,QAAQwtB,WAGhDT,EAAYQ,IAsDd,OAPA/Q,kBA5CyB,WAEvB,MAAKrX,IAAW0L,GAAQA,EAAK5N,MAAQ,IAAM4N,EAAKrO,OAAS,IAAMwqB,GAA/D,CAF6B,IAAAS,EAAAhuB,OAAAsN,EAAA,EAAAtN,CAIY0F,EAJZ,GAItBuoB,EAJsBD,EAAA,GAIdE,EAJcF,EAAA,GAING,EAJMH,EAAA,GAIEI,EAJFJ,EAAA,GAK7B,IACEzlB,QAAQC,IAAI,oBADV,IAAA6lB,EAEoC,IAAIC,IAAJtuB,OAAA2J,EAAA,EAAA3J,CAAA,GAA6BoR,EAASgL,IAAYmS,UACtF,CAAE,CAACN,EAAQC,GAAS,CAACC,EAAQC,IAC7B,CAAElnB,QAAS,GAAIsnB,OAAQ,CAAC,EAAG,KAFrB9uB,EAFN2uB,EAEM3uB,UAAWD,EAFjB4uB,EAEiB5uB,SAAUmuB,EAF3BS,EAE2BT,KAI7BrlB,QAAQC,IAAI,iBAAkB9C,EAAQ0W,EAASwR,KAAMA,EAAMxR,GAG3DkR,EAAYttB,OAAA2J,EAAA,EAAA3J,CAAA,GAAKoc,EAAN,CAAgB1c,YAAWD,WAAUmuB,UAElD,MAAOzoB,GAELoD,QAAQqJ,MAAMzM,MA0BQ,CAACiM,EAAM1L,IAEjC/E,oBAAU,WACR2sB,EAAYttB,OAAA2J,EAAA,EAAA3J,CAAA,GAAKoc,EAAasQ,KAE9B,CAACA,IAGDpnB,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWC,IAAW,eAAgBzB,EAAMwB,WAAYsE,IAAK0iB,GAC/D9b,EAAKrO,OAAS,GAAKqO,EAAK5N,MAAQ,GAC/B8B,EAAAlD,EAAAmD,cAACyX,EAAA,EAADhd,OAAAqG,OAAA,GACM+V,EACCgR,EAAoB7sB,SAAW0sB,EAFtC,CAGEziB,IAAK,SAAApC,GACH+kB,EAAU5sB,QAAU6H,GAEtBrF,OAAQqO,EAAKrO,OACbS,MAAO4N,EAAK5N,MACZyZ,SAAUR,EAAYJ,EAAU1P,OAAS0P,EAAUI,GAAWnW,MAAQ+V,EAAU,GAAG/V,MACnF4W,OAAQZ,EACRwQ,kBA1CsB,WAC5BvkB,QAAQC,IAAI,oCACZglB,GAAmB,GACsB,oBAA9BX,GAA0CA,KAwC/CG,gBArCoB,WAC1BzkB,QAAQC,IAAI,kCACZglB,GAAmB,GACnBJ,EAAoB7sB,QAAU,KAC1BwsB,GAAyBA,IACW,oBAA7BH,GACTA,EAAyB,CACvBxQ,WACAhL,OACAuL,aACAvU,IAAK+kB,EAAU5sB,SAAW4sB,EAAU5sB,QAAQwtB,YA4B1CU,SAAUpQ,EACVC,iBAAkBA,GAClBnB,qBAAsB1K,IAAUW,aAC5BmJ,GAGFxS,GAAYsT,MAAMC,QAAQvT,GACtBA,EAAS3B,IAAI,SAACmV,EAAGzQ,GAAJ,OAAYyQ,EAAImR,IAAMC,aACnCnR,EAAYD,EAAGnB,EAAUhL,EAAKrO,OAAQqO,EAAK5N,MAAOmZ,GAClD,CAAE5P,IAAG,YAAAlJ,OAAciJ,KACjB,OACF0Q,EAAYzT,EAAUqS,EAAUhL,EAAKrO,OAAQqO,EAAK5N,MAAOmZ,GAG7De,GACApY,EAAAlD,EAAAmD,cAAC6X,EAAA,EAAD,CACEjB,eAAgBA,EAChBM,UAAWA,EACXJ,UAAWA,EACXK,aAAcA,KAIfhY,EAAMkqB,iBACPtpB,EAAAlD,EAAAmD,cAACyX,EAAA,EAAD,CACEsB,iBAAkB,SAAAlC,GAAQ,OAAIkC,GAAiBte,OAAA2J,EAAA,EAAA3J,CAAA,GAAKoc,EAAahL,KACjEyd,UAA+B,KAApBnqB,EAAMoqB,YAA6C,KAArBpqB,EAAMqqB,WAC/CC,aAAoC,KAAtBtqB,EAAMwZ,cAA+C,KAArBxZ,EAAMyZ,aAGvDC,IAAWC,GACV/Y,EAAAlD,EAAAmD,cAACD,EAAAlD,EAAMupB,SAAP,KACG+B,GACDpoB,EAAAlD,EAAAmD,cAAC0pB,EAAD,CAAkBxpB,UAAWgoB,KAAeA,GAAWhuB,SAAU0c,eAAgBA,EAAgBlW,QAvJ7F,WACTwnB,GAAWhuB,UAAaguB,GAAW/tB,YAExC0tB,EAAoB7sB,QAAU,CAC5B2uB,mBAFqB,IAGrBC,uBAAwB,IAAIC,IAC5BC,iBAAkBC,KAGpBzd,WAAW,WACLub,EAAoB7sB,UAAS6sB,EAAoB7sB,QAAU,OAR1C,KAUvB+sB,EAAYttB,OAAA2J,EAAA,EAAA3J,CAAA,GACPoc,EADM,CAET3c,SAAUguB,GAAWhuB,SACrBC,UAAW+tB,GAAW/tB,UACtBkuB,KAAMxR,EAASwR,KAAO,GAAKxR,EAASwR,KAAO,eA+KjD5P,EAAQpE,aAAe,CACrBuC,eAAgB,GAChBuB,cAAc,EACdC,UAAW,EACXtB,UAAW5J,IAAUa,OACrBqZ,cAAc,GAGD3O,UAETqP,EAAkB,CACtB5tB,SAAU,WACVC,WAAY,YACZ6vB,QAAS,EACTC,MAAO,EACP5B,KAAM,IAGR,SAASpQ,EAAaC,EAAOrB,EAAUrZ,EAAQS,EAAOmZ,GACpD,MAAwB,oBAAVc,EACVA,EAAMrB,EAAUrZ,EAAQS,EAAOmZ,GAC/Bc,gMC9OAlb,EAAYC,YAvCJ,SAAAC,GAAK,MAAK,CACtBuE,KAAM,GAGN2iB,WAAY,CACV5lB,QAAS,OACTV,cAAe,SACf6D,QAAS,GAEXuoB,WAAY,CACVxgB,SAAU,GAEZygB,cAAe,CACbxoB,QAAS,QAEXsc,OAAQ,CACNtc,QAAS,YAEXyoB,WAAY,CACVzoB,QAAS,UAEXia,KAAM,CACJxZ,SAAU,SACV2R,WAAY,WACZ/N,cAAe9I,EAAM0E,QAAQ,IAE/Bia,MAAO,CACLte,WAAYL,EAAM8D,QAAQ8I,QAAQqL,KAClC9X,MAAOH,EAAM8D,QAAQ8I,QAAQ2L,aAC7BpX,OAAQ,EACRsD,QAASzE,EAAM0E,QAAQ,IAEzBqE,YAAa,CACXxI,SAAU,WACVM,MAAOb,EAAM0E,QAAQ,GACrBjE,IAAKT,EAAM0E,QAAQ,GACnBvE,MAAOH,EAAM8D,QAAQkF,KAAK,SAsEfmkB,EAjEM,SAAA1rB,GAAiG,IAA9FyH,EAA8FzH,EAA9FyH,KAAM2W,EAAwFpe,EAAxFoe,KAAMwH,EAAkF5lB,EAAlF4lB,SAAU1I,EAAwEld,EAAxEkd,MAAiByO,EAAuD3rB,EAAjEzE,SAA8BqwB,EAAmC5rB,EAA9CxE,UAAgCqwB,EAAc7rB,EAAzBuX,UACrFzW,EAAUzC,IADoGpD,EAEvEC,mBAAS,CAAEM,UAAWowB,EAAUrwB,SAAUowB,IAF6B9vB,EAAAC,OAAAsN,EAAA,EAAAtN,CAAAb,EAAA,GAAAyrB,EAAA7qB,EAAA,GAE3GL,EAF2GkrB,EAE3GlrB,UAAWD,EAFgGmrB,EAEhGnrB,SAAYuwB,EAFoFjwB,EAAA,GAAAmB,EAGnF9B,mBAAS2wB,GAH0ExuB,EAAAvB,OAAAsN,EAAA,EAAAtN,CAAAkB,EAAA,GAG7Gua,EAH6Gla,EAAA,GAGlG0uB,EAHkG1uB,EAAA,GAK9GmrB,EAAe3P,kBAAQ,iBAAO,CAClC6Q,KAAM,GACNnuB,SAAUowB,EACVnwB,UAAWowB,IACT,CAACD,EAASC,IAId,OACExqB,EAAAlD,EAAAmD,cAAC4G,EAAA,EAAD,CACEC,OAAO,QACPT,KAAMA,EACNpC,WAAS,EACT8C,YAAU,EACVR,QAASie,GAETxkB,EAAAlD,EAAAmD,cAACiH,EAAA,EAAD,CAAatG,UAAWlB,EAAQoc,MAAOK,mBAAiB,GACtDnc,EAAAlD,EAAAmD,cAAC4E,EAAA,EAAD,CAAYvH,MAAM,WAAWwe,IAE/B9b,EAAAlD,EAAAmD,cAACwkB,EAAA,EAAD,CAAe7jB,UAAWlB,EAAQ2kB,YAChCrkB,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQyqB,YACtBnqB,EAAAlD,EAAAmD,cAACqY,EAAA,EAAD,CACEE,UAAQ,EACR5X,UAAWlB,EAAQoD,IACnBqT,UAAWA,EAAY,EAAIA,EAAY,KACvCW,SAAUsQ,EACVzkB,SApBQ,SAAAiC,GAAA,IAAAgmB,EAAAhmB,EAAGkS,SAAY1c,EAAfwwB,EAAexwB,UAAWD,EAA1BywB,EAA0BzwB,SAA1B,OAA2CuwB,EAAU,CAAEtwB,YAAWD,iBAuB9E6F,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQ0qB,eACtBpqB,EAAAlD,EAAAmD,cAAC4qB,EAAA,EAAD,CAAWjqB,UAAWlB,EAAQorB,cAA9B,aAAuD3U,GAAa,EAAI,GAAK,SAC7EnW,EAAAlD,EAAAmD,cAAC8qB,EAAA,EAAD,CACErrB,QAAS,CAAEgC,KAAMhC,EAAQ2qB,WAAYW,UAAWtrB,EAAQwe,QACxDlb,MAAOmT,IAAc,EACrBpJ,KAAM,EACN0D,IAAK,IACLwa,KAAM,EACNtoB,SAAU,SAAC9C,EAAGmD,GAAJ,OAAc2nB,EAAY3nB,QAI1ChD,EAAAlD,EAAAmD,cAAC0kB,EAAA,EAAD,KACE3kB,EAAAlD,EAAAmD,cAAC2kB,EAAA,EAAD,CAAQjkB,QAAS6jB,GAAjB,UACAxkB,EAAAlD,EAAAmD,cAAA,OAAKe,MAAO,CAAE2I,SAAU,KACxB3J,EAAAlD,EAAAmD,cAAC2kB,EAAA,EAAD,CAAQjkB,QAAS,kBAAMqc,EAAK,CAAE5iB,YAAWD,WAAUgc,gBAAnD,mCCpFF+O,EACK,YADLA,EAEM,WAGNjoB,EAAYC,YCzBH,SAAAC,GAAK,MAAK,CACvBuE,KAAM,GAGNyI,MAAO,CACL1L,QAAS,OACTV,cAAe,UAGjBie,SAAU,CACRxe,WAAYL,EAAM8D,QAAQ8I,QAAQqL,KAClC9X,MAAOH,EAAM8D,QAAQ8I,QAAQ2L,cAE/BwV,OAAQ,CACNzsB,QAAS,OACTV,cAAe,UAEjBotB,YAAa,CACX7sB,OAAQnB,EAAM0E,QAAQ,EAAG,IAG3BupB,KAAM,CACJzhB,SAAU,GAEZ+a,MAAO,CACL/a,SAAU,EACVyQ,aAAiC,EAAnBjd,EAAM0E,QAAQ,IAE9Bqc,OAAQ,CACNnY,YAAa5I,EAAM0E,QAAQ,GAC3BmE,aAAc7I,EAAM0E,QAAQ,IAE9BkhB,UAAW,CACT/E,WAAY7gB,EAAM0E,QAAQ,GAC1BqR,YAAa/V,EAAM0E,QAAQ,GAC3B3D,MAAO,QAETmW,UAAW,CACT5V,QAAS,QACT+D,UAAWrF,EAAM0E,QAAQ,GACzBuY,aAAcjd,EAAM0E,QAAQ,IAE9BipB,aAAc,CACZrsB,QAAS,QACT+D,UAAWrF,EAAM0E,QAAQ,GACzBuY,aAAcjd,EAAM0E,QAAQ,IAE9BwpB,aAAc,CACZ1hB,SAAU,EACVlM,OAAQ,QACR6tB,UAAW,SAEbnB,WAAY,CACVxgB,SAAU,EACVlL,QAAS,OACTV,cAAe,SACfkI,cAAkC,EAAnB9I,EAAM0E,QAAQ,IAE/B0I,YAAa,CACXjM,OAAQnB,EAAM0E,QAAQ,GACtB0pB,SAAU,KAEZC,MAAO,CACL/sB,QAAS,OACTyD,SAAU,WDiFCupB,IAnHS,SAAA7sB,GAAiC,IAA9B8sB,EAA8B9sB,EAA9B8sB,OAAQrG,EAAsBzmB,EAAtBymB,MAAO1iB,EAAe/D,EAAf+D,SAClCjD,EAAUzC,IADuCpD,EAEfC,mBAAS,MAFMW,EAAAC,OAAAsN,EAAA,EAAAtN,CAAAb,EAAA,GAEhD0rB,EAFgD9qB,EAAA,GAElCgrB,EAFkChrB,EAAA,GAIjDqc,EAAW,CAAEwR,KAAM,KACpBjD,EAAMlrB,UAAYuxB,EAAOtwB,OAAO,MAAQiqB,EAAMjrB,WAAasxB,EAAOtwB,OAAO,MAC5E0b,EAAS1c,UAAYirB,EAAMjrB,WAAasxB,EAAOtwB,OAAO,GACtD0b,EAAS3c,SAAWkrB,EAAMlrB,UAAYuxB,EAAOtwB,OAAO,IAGtD,IAAM8vB,EAAS7F,EAAM6F,QAAUQ,EAAOR,QAAU,UAEhD,OACElrB,EAAAlD,EAAAmD,cAAA,WACED,EAAAlD,EAAAmD,cAAC+D,EAAA,EAAD,CACE7C,MAAM,cACN8C,WAAS,EACTlC,YAAY,aACZnB,UAAWlB,EAAQglB,MACnB1hB,MAAOqiB,EAAMvP,MAAQ4V,EAAO5V,MAAQ,GACpCnT,SAAU,SAAA9C,GAAC,OAAI8C,EAASjI,OAAA2J,EAAA,EAAA3J,CAAA,GAAK2qB,EAAN,CAAavP,KAAMjW,EAAE8M,OAAO3J,YAErDhD,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQyqB,WAAYxpB,QAAS,kBAAM8kB,EAAgBP,KACjEllB,EAAAlD,EAAAmD,cAAC4qB,EAAA,EAAD,CAAWjqB,UAAWlB,EAAQorB,cAA9B,YACA9qB,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQ2rB,cACtBrrB,EAAAlD,EAAAmD,cAACqY,EAAA,EAAD,CACEC,WAAS,EACT3X,UAAWlB,EAAQoD,IACnBqT,UAAWkP,EAAMlP,WAAauV,EAAOvV,UACrCW,SAAUA,MAIhB9W,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQglB,OACtB1kB,EAAAlD,EAAAmD,cAAC4qB,EAAA,EAAD,sBACA7qB,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQwrB,QACtBlrB,EAAAlD,EAAAmD,cAAC0rB,EAAA,EAAD,CACE/qB,UAAWlB,EAAQyrB,YACnBS,QACE5rB,EAAAlD,EAAAmD,cAAC4rB,EAAA,EAAD,CACEC,QAAS,CAAC,OAAQ,UAAUlX,QAAQsW,IAAW,EAC/CvoB,SAAU,SAAC9C,GACT8C,EAASjI,OAAA2J,EAAA,EAAA3J,CAAA,GAAK2qB,EAAN,CAAa6F,OAAQrrB,EAAE8M,OAAOmf,QAAU,SAAW,cAE7D9oB,MAAO,WAGX7B,MAAOnB,EAAAlD,EAAAmD,cAAA,WACLD,EAAAlD,EAAAmD,cAAC4E,EAAA,EAAD,CAAYyC,QAAQ,QAAQ7B,UAAU,OAAO+H,IAAO2C,OAAOhP,OAC3DnB,EAAAlD,EAAAmD,cAAC4E,EAAA,EAAD,CAAYyC,QAAQ,UAAUhK,MAAM,gBAAgBmI,UAAU,OAAO+H,IAAO2C,OAAOJ,gBAIvF/P,EAAAlD,EAAAmD,cAAC0rB,EAAA,EAAD,CACE/qB,UAAWlB,EAAQyrB,YACnBhrB,SAAU,CAAC,WAAWyU,QAAQsW,IAAW,EACzCU,QACE5rB,EAAAlD,EAAAmD,cAAC4rB,EAAA,EAAD,CACEC,QAAS,CAAC,QAAQlX,QAAQsW,IAAW,EACrCvoB,SAAU,SAAC9C,GAAD,OAAO8C,EAASjI,OAAA2J,EAAA,EAAA3J,CAAA,GAAK2qB,EAAN,CAAa6F,OAAQrrB,EAAE8M,OAAOmf,QAAU,OAAS,aAC1E9oB,MAAO,SAGX7B,MAAOnB,EAAAlD,EAAAmD,cAAA,WACLD,EAAAlD,EAAAmD,cAAC4E,EAAA,EAAD,CAAYyC,QAAQ,QAAQ7B,UAAU,OAAO+H,IAAOsC,KAAK3O,OACzDnB,EAAAlD,EAAAmD,cAAC4E,EAAA,EAAD,CAAYyC,QAAQ,UAAUhK,MAAM,gBAAgBmI,UAAU,OAAO+H,IAAOsC,KAAKC,kBAMzF/P,EAAAlD,EAAAmD,cAACkU,EAAA,EAAD,CACExT,QAAS,kBAAM8kB,EAAgBP,IAC/BtkB,UAAWlB,EAAQglB,MACnBvjB,MAAM,cACNiT,KAAMiR,EAAMa,MAAQwF,EAAOxF,OAE5BX,IAAiBL,GAChBllB,EAAAlD,EAAAmD,cAAC8rB,EAAD,CACE1lB,MAAI,EACJyV,MAAM,8BACN3hB,SAAUkrB,EAAMlrB,UAAYuxB,EAAOtwB,OAAO,GAC1ChB,UAAWirB,EAAMjrB,WAAasxB,EAAOtwB,OAAO,GAC5C+a,UAAWkP,EAAMlP,WAAauV,EAAOvV,UACrC6G,KAAM,SAACvc,GACLkC,EAASjI,OAAA2J,EAAA,EAAA3J,CAAA,GAAK2qB,EAAU5kB,IACxBglB,EAAgB,OAElBjB,SAAU,kBAAMiB,EAAgB,SAGnCF,IAAiBL,GAChBllB,EAAAlD,EAAAmD,cAAC8c,EAAA,EAAD,CACE1W,MAAI,EACJyV,MAAM,cACND,KAAMwJ,EAAMa,MAAQwF,EAAOxF,KAC3BjJ,WAAS,EACTD,KAAM,SAACgP,GACLrpB,EAASjI,OAAA2J,EAAA,EAAA3J,CAAA,GAAK2qB,EAAN,CAAaa,KAAM8F,KAC3BvG,EAAgB,OAElBjB,SAAU,kBAAMiB,EAAgB,uOE9GpCxoB,EAAYC,YCpBH,SAAAC,GAAK,MAAK,CACvBuE,KAAM,GAGNuqB,KAAM,GAGNC,OAAQ,CACNxuB,SAAU,WACV6E,OAAQ,GACR3E,IAAKT,EAAM0E,QAAQ,GACnBlE,KAAMR,EAAM0E,QAAQ,GACpB+H,QAAS,IAEXuiB,cAAe,CACb3uB,WAAYL,EAAM8D,QAAQ8I,QAAQkM,KAClCrM,QAAS,IAIXwiB,eAAgB,CACdC,QAAS,CACPziB,QAAS,KAGb0iB,aAAc,CACZ1qB,QAAO,GAAArD,OAAKpB,EAAM0E,QAAQ,GAAnB,gBACPwqB,QAAS,CACPziB,QAAS,IAGbS,IAAK,GAGLkiB,gBAAiB,CACfC,gBAAiBtc,IAAI,MAEvBuc,SAAU,MDfNC,EAAY,SAAA9tB,GAA6D,IAA1D+tB,EAA0D/tB,EAA1D+tB,OAAQC,EAAkDhuB,EAAlDguB,QAASC,EAAyCjuB,EAAzCiuB,YAAaxrB,EAA4BzC,EAA5ByC,SAAUyrB,EAAkBluB,EAAlBkuB,YAAkBjzB,EACzCC,oBAAS,GADgCW,EAAAC,OAAAsN,EAAA,EAAAtN,CAAAb,EAAA,GACtEkzB,EADsEtyB,EAAA,GAC1DuyB,EAD0DvyB,EAAA,GAEvEiF,EAAUzC,IAF6DrB,EAGnC9B,mBAAS,IAH0BmC,EAAAvB,OAAAsN,EAAA,EAAAtN,CAAAkB,EAAA,GAGtEqxB,EAHsEhxB,EAAA,GAGvDixB,EAHuDjxB,EAAA,GAAA8O,EAInCjR,oBAAS,GAJ0BkR,EAAAtQ,OAAAsN,EAAA,EAAAtN,CAAAqQ,EAAA,GAItEoiB,EAJsEniB,EAAA,GAIvDoiB,EAJuDpiB,EAAA,GAAAqiB,EAMhDvlB,qBAAWC,KAAhCzB,EANqE+mB,EAMrE/mB,aAAcgnB,EANuDD,EAMvDC,GAUhBC,EAAwB,WAC5BP,GAAc,GACdE,EAAiB,KASbM,EAAiB,SAACpsB,GAEtB,GADc6rB,EAAcrY,QAAQxT,GACxB,EAAG8rB,EAAgB,GAAA3uB,OAAA7D,OAAAiO,EAAA,EAAAjO,CAAKuyB,GAAL,CAAoB7rB,SAC9C,CACH,IAAMqsB,EAAYR,EAAcvmB,OAAO,SAAAgnB,GAAK,OAAIA,IAAUtsB,IACjC,IAArBqsB,EAAUpmB,QAAckmB,IAC5BL,EAAiBO,KAafE,EAAYjzB,OAAAiO,EAAA,EAAAjO,CAAOiyB,GAGzB,OAFAgB,EAAaC,KAAK,SAAC9wB,EAAG+wB,GAAJ,OAAU9kB,SAAS8kB,EAAE7H,QAAS,IAAMjd,SAASjM,EAAEkpB,QAAS,MAGxEhmB,EAAAlD,EAAAmD,cAAA,WACED,EAAAlD,EAAAmD,cAAC6tB,EAAA,EAAD,CAAUC,KAAMnB,EAASoB,WAAY,IAAKptB,UAAWlB,EAAQgC,MAC1DisB,EAAa7qB,IAAI,SAAC8E,EAAOJ,GACxB,IAAMhC,EAAWynB,EAAcrY,QAAQhN,EAAMxG,KAAO,EAC9C6sB,EAAYX,EAAGY,QAAQ,SAAUtmB,EAAO,SAE1CumB,EAAW7nB,EAAamF,YAAY7D,EAAO,UAAYA,EAAM2D,OAEjE,OACEvL,EAAAlD,EAAAmD,cAACmuB,EAAA,EAAD,CACE3mB,IAAG,WAAAlJ,OAAaiJ,GAChB7G,QAAS,SAACd,GAAD,OAAOouB,GAxBL,SAACpuB,EAAG+H,GACzB/H,EAAEC,iBACFD,EAAEE,kBAEEgtB,EAAYS,EAAe5lB,EAAMxG,IAEhC0rB,EAAYllB,EAAMxG,IAkBgBitB,CAAexuB,EAAG+H,IAC/ChH,UAAWC,IACTnB,EAAQusB,KACRc,IAAekB,GAAavuB,EAAQysB,cACpCY,GAAckB,IAAczoB,GAAY9F,EAAQ0sB,eAChDW,GAAcvnB,GAAY9F,EAAQ4sB,eAGpCtsB,EAAAlD,EAAAmD,cAAA,OAAKuM,IAAK2hB,EAAUhiB,IAAKgiB,EAAUvtB,UAAWlB,EAAQ2K,MACrD4jB,GAAapB,GACZ7sB,EAAAlD,EAAAmD,cAACinB,EAAA,EAAD,CAAKpb,KAAK,QAAQqb,aAAW,MAAMvmB,UAAWlB,EAAQwsB,OAAQvrB,QAAS,SAACd,GAAD,OA/DxD,SAACA,EAAGuB,GAC/BvB,EAAEC,iBACFD,EAAEE,kBAEFitB,GAAc,GACdQ,EAAepsB,GA0D2EktB,CAAqBzuB,EAAG+H,EAAMxG,MACxG2rB,GAAevnB,EAAyBxF,EAAAlD,EAAAmD,cAACsuB,EAAAzxB,EAAD,MAAdkD,EAAAlD,EAAAmD,cAACuuB,EAAA1xB,EAAD,OAGhCkD,EAAAlD,EAAAmD,cAACwuB,EAAA,EAAD,CACE3S,MAAO9b,EAAAlD,EAAAmD,cAAA,YAAO6kB,YAAWld,EAAMoe,gBAMzChmB,EAAAlD,EAAAmD,cAACyuB,EAAA,EAAD,CACEroB,KAAM0mB,EACN4B,iBAAkB,KAClBC,aAAc,CACZC,mBAAoB,0BACpBjuB,UAAWlB,EAAQ6sB,iBAErB5P,QAAS3c,EAAAlD,EAAAmD,cAAA,QAAMmB,GAAG,2BAA2B6rB,EAAc5lB,OAAlD,oBACT+b,OAAQpjB,EAAAlD,EAAAmD,cAAA,WACND,EAAAlD,EAAAmD,cAAC2kB,EAAA,EAAD,CAAQtnB,MAAM,UAAU6C,SAAU8sB,EAAc5lB,QAAUslB,EAAOtlB,OAAQyE,KAAK,QAAQnL,QAAS,kBAAMysB,GAAiB,KAAtH,UAGAptB,EAAAlD,EAAAmD,cAAC2kB,EAAA,EAAD,CAAQtnB,MAAM,UAAUwO,KAAK,QAAQnL,QAAS,kBAAM4sB,MAApD,WAKF3sB,UAAWlB,EAAQ+sB,WAGrBzsB,EAAAlD,EAAAmD,cAACyc,EAAA,EAAD,CACErW,KAAM8mB,EACNvQ,UAnFkB,SAACkS,GACvB1B,GAAiB,IACI,IAAjB0B,GAAyB7B,EAAc5lB,OAASslB,EAAOtlB,QAAQhG,EAAS4rB,GAC5EM,KAiFIzR,MAAK,UAAAvd,OAAY0uB,EAAc5lB,OAA1B,WACLsV,QAAQ,oDAehB+P,EAAUpY,aAAe,CACvBuY,aAAa,EACbD,QAAS,GAGIF,qNErITqC,EACI,SADJA,EAEQ,UAFRA,EAGS,cAHTA,EAIW,gBAiMFC,IA9LE,SAAApwB,GAAsD,IAAnDqwB,EAAmDrwB,EAAnDqwB,YAAaC,EAAsCtwB,EAAtCswB,SAAU1K,EAA4B5lB,EAA5B4lB,SAAU2K,EAAkBvwB,EAAlBuwB,YAAkB9B,EACpCvlB,qBAAWC,KAApCzB,EAD6D+mB,EAC7D/mB,aAAcolB,EAD+C2B,EAC/C3B,OAD+C7xB,EAErCC,mBAAS,MAF4BW,EAAAC,OAAA00B,EAAA,EAAA10B,CAAAb,EAAA,GAE9Dw1B,EAF8D50B,EAAA,GAEpD60B,EAFoD70B,EAAA,GAAAmB,EAGnC9B,mBAASq1B,EAAc,IAAII,IAAYjpB,GAAcolB,OAAS,MAH3BzvB,EAAAvB,OAAA00B,EAAA,EAAA10B,CAAAkB,EAAA,GAG9D4zB,EAH8DvzB,EAAA,GAGnDwzB,EAHmDxzB,EAAA,GAAA8O,EAKjCjR,mBAAS,MALwBkR,EAAAtQ,OAAA00B,EAAA,EAAA10B,CAAAqQ,EAAA,GAK9D2kB,EAL8D1kB,EAAA,GAKlD2kB,EALkD3kB,EAAA,GAAAG,EAMzCrR,mBAAS,CAAEmB,QAASg0B,EAAaW,QAAS,KANDxkB,EAAA1Q,OAAA00B,EAAA,EAAA10B,CAAAyQ,EAAA,GAM9D0kB,EAN8DzkB,EAAA,GAMxD0kB,EANwD1kB,EAAA,GAO/DiT,EAAc1iB,cACdo0B,EAAMn2B,cAEN+yB,EAASjB,GAAUA,EAAOiB,OAASjB,EAAOiB,OAAS,GA2DnDqD,EAAa,SAACC,GAClBhtB,QAAQC,IAAI,sBAAuB2sB,EAAMI,GACzCH,EAAY,CACV70B,QAASg1B,EACTL,QAAO,GAAArxB,OAAA7D,OAAAw1B,EAAA,EAAAx1B,CAAMm1B,EAAKD,SAAX,CAAoBC,EAAK50B,aAyDhCwK,EAAY,KAChB,OAAQoqB,EAAK50B,SACX,KAAK8zB,EACHtpB,EACE0qB,EAAArzB,EAAAmD,cAACmwB,EAAA,EAAD,CACEzD,OAAQA,EACR0D,UA9CU,SAAC5vB,EAAM6vB,GACvB,IAAMC,EAAe,IAAIC,IAAWlqB,GAAcsB,MAElD3E,QAAQC,IAAI,2BAA4B,CAAEzC,SAC1C,IACIgwB,EAAO,GACLC,EAAWjwB,EAAK8K,OAAOqJ,QAFhB,qBAEqCvN,OAC5CspB,EAAUlwB,EAAK8K,OAAOqlB,MAAMF,GAC5BG,EAASC,IAAWC,OAAOC,EAAOC,KAAKN,EAAS,WACtD1tB,QAAQC,IAAI,yBACZ,IACEutB,EAAOI,EAAO/K,QACd7iB,QAAQC,IAAI,WAAY2iB,KAAKqL,UAAUT,IAEzC,MAAOpkB,GAELpJ,QAAQqJ,MAAM,aAAcD,GAG9B,GAAI8iB,EAAa,KACTh1B,EAAwB41B,EAAxB51B,SAAUC,EAAc21B,EAAd31B,UAEXD,GAAaC,IAChBD,EAAW,WACXC,GAAa,aAEfq1B,EAAa/0B,OAAAmY,EAAA,EAAAnY,CAAA,GAAK80B,EAAN,CAAiBr1B,WAAUC,eAEzCk1B,EAAY50B,OAAAmY,EAAA,EAAAnY,CAAA,GACP61B,EADM,CAETY,QAAS,CACPC,OAAQ/S,EACRgT,UAAWtB,GAEbxkB,OAAQ9K,EAAK8K,UAEfokB,EAAcW,GACdN,EAAWjB,IAULvK,SAAUA,IAGd,MACF,KAAKuK,EACHtpB,EAAY0qB,EAAArzB,EAAAmD,cAACqxB,EAAA,EAAD,CACV9M,SAAUA,EACV+M,aApIe,SAAC9wB,GACpBwC,QAAQC,IAAI,8BAA+B,CAAEzC,SAC7C,IACIgwB,EAAO,GACLC,EAAWjwB,EAAKmU,QAFT,qBAE8BvN,OACrCspB,EAAUlwB,EAAKmwB,MAAMF,GACrBG,EAASC,IAAWC,OAAOC,EAAOC,KAAKN,EAAS,WACtD1tB,QAAQC,IAAI,yBACZ,IACEutB,EAAOI,EAAO/K,QACd7iB,QAAQC,IAAI,WAAY2iB,KAAKqL,UAAUT,IAEzC,MAAOpkB,GAELpJ,QAAQqJ,MAAM,aAAcD,GAG9B,IAAImlB,EAAOC,OAAOl3B,KAAKC,OACvB,IACEg3B,EAAOC,OAAOhB,EAAKhqB,KAAKirB,kBAE1B,MAAOrlB,GACLpJ,QAAQC,IAAI,OAAQutB,GACpBxtB,QAAQqJ,MAAM,0BAA2BD,GAG3C,GADApJ,QAAQC,IAAI,cAAe,CAAEisB,gBACzBA,EAAa,KACTh1B,EAAwB41B,EAAxB51B,SAAUC,EAAc21B,EAAd31B,UAEXD,GAAaC,IAChBD,EAAW,WACXC,GAAa,aAEf,IACMq2B,EAAKhqB,KAAKkrB,aAAeC,YAAUnB,EAAKhqB,KAAKkrB,cAAgBlB,EAAKhqB,KAAKorB,cAAgBD,YAAUnB,EAAKhqB,KAAKorB,gBAC7G13B,EAAWs2B,EAAKhqB,KAAKkrB,YACrBv3B,EAAYq2B,EAAKhqB,KAAKorB,cAG1B,MAAOhyB,GACLoD,QAAQqJ,MAAM,sDAEhBrJ,QAAQC,IAAI,uBAAwB,CAAE6sB,MAAK51B,WAAUC,cACrDq1B,EAAa/0B,OAAAmY,EAAA,EAAAnY,CAAA,GAAK80B,EAAN,CAAiBr1B,WAAUC,eAEzC,IAAMm2B,EAAe,IAAIC,IAAWlqB,GAAcsB,MAC5CkqB,EAAkBp3B,OAAAmY,EAAA,EAAAnY,CAAA,GACnB61B,EADmB,CAEtBvK,QAASwL,EACTL,QAAS,CAAEV,QACXllB,OAAQ9K,IAEV6uB,EAAYwC,GACZ9B,EAAWjB,GACX9rB,QAAQC,IAAI,wBAAyB4uB,MAiFnC,MACF,KAAK/C,EACHtpB,EACE0qB,EAAArzB,EAAAmD,cAAC8xB,EAAA,EAAD,CACEC,kBAAmBtC,EACnB/C,OAAQA,EACRsF,SAAU5C,EACVzS,UAAW,kBAAMoT,EAAWjB,IAC5BvK,SAAUA,EACV0N,QAhFS,WACf,GAAIrC,EAAKD,QAAQvoB,OAAS,EAAG,CAC3B,IAAM8qB,EAAUz3B,OAAAw1B,EAAA,EAAAx1B,CAAOm1B,EAAKD,SACtBwC,EAAUD,EAAWE,MAC3BvC,EAAY,CACV70B,QAASm3B,EACTxC,QAASuC,SAIX3N,OAyEA,MACF,KAAKuK,EACHtpB,EACE0qB,EAAArzB,EAAAmD,cAACqyB,EAAA,EAAD,CACE1qB,MAAOynB,EACPG,UAAWA,EACX+C,OAAQrD,EACR1K,SAAUA,IAGd,MACF,QACEvhB,QAAQC,IAAI,qDAAsD2sB,GAClErL,IAGJ,OAAO/e,6GC7KM+E,IApBb,SAAAA,EAAalE,EAAcsB,GAAO,IAAA8J,EAAAC,KAAAjX,OAAA83B,EAAA,EAAA93B,CAAAiX,KAAAnH,GAAAmH,KAQlC8gB,QAAU,WACR/gB,EAAKe,KAAOoT,KAAKqL,UAAUxf,EAAKK,OAAOiB,iBATPrB,KAYlC0d,SAAW,iBAAO,CAChBjuB,GAAI,IAAM4T,MACVgR,QAAS0M,YAAyB,IAAIn4B,MACtCkY,KAAMoT,KAAKqL,UAAUxf,EAAKK,OAAOiB,gBACjCvM,KAAM,KAfNkL,KAAKI,OAAS,IAAIN,IAAanL,GACpBqL,KAAK/J,MAAZA,GAEW+J,KAAK0d,25+FCcTsD,IAnBb,SAAAA,EAAarsB,EAAcolB,GAAQ,IAAAha,EAAAC,KAAAjX,OAAA83B,EAAA,EAAA93B,CAAAiX,KAAAghB,GAAAhhB,KAQnC8gB,QAAU,WACR/gB,EAAKe,KAAOoT,KAAKqL,UAAUxf,EAAKK,OAAOQ,kBATNZ,KAYnC6d,UAAY,iBAAO,CACjBpuB,GAAI,IAAM4T,MACVvC,KAAMoT,KAAKqL,UAAUxf,EAAKK,OAAOQ,iBACjCoa,OAAQ,KAdRhb,KAAKI,OAAS,IAAIN,IAAanL,GACnBqL,KAAK+Z,OAAbA,GAEY/Z,KAAK6d,8CCRzBxiB,EAAAC,EAAAC,EAAA,sBAAA4X,IAAA9X,EAAAC,EAAAC,EAAA,sBAAA0lB,IAAA5lB,EAAAC,EAAAC,EAAA,sBAAAwlB,IAAA1lB,EAAAC,EAAAC,EAAA,sBAAA4V,IAAA9V,EAAAC,EAAAC,EAAA,sBAAA8V,IAAA,IAAA6P,EAAA7lB,EAAA,KAAA8lB,EAAA9lB,EAAA0G,EAAAmf,GASa/N,EAAa,SAACiO,GAAkC,IAApBC,EAAoB/Q,UAAA5a,OAAA,QAAAoZ,IAAAwB,UAAA,GAAAA,UAAA,GAAX,OAChD,OAAOgR,IAAOF,EAAc,KAAKC,OAAOA,IAG7BJ,EAAe,SAACG,GAC3B,OAAOE,IAAOF,EAAc,KAAKG,WAetBR,EAA2B,SAACS,GACvC,OAAOF,IACJG,IAAID,GACJH,OAAO,MAOL,SAASlQ,EAAuBiQ,GAErC,OAAOE,IAAOF,EAAc,KAAKC,OAAO,oBAOnC,SAAShQ,EAAuBqQ,GACrC,OAAOJ,IAAO,IAAI14B,KAAK84B,GAAS,oBAAoBL,OAAO,+FCL9CM,EA1CM,WAAyB,IAAxB3wB,EAAwBsf,UAAA5a,OAAA,QAAAoZ,IAAAwB,UAAA,GAAAA,UAAA,GAAb,aACzB1d,EAAWxJ,mBACXw4B,EAAWx4B,mBAEXy4B,EACJxzB,EAAAlD,EAAAmD,cAAA,SAAOe,MAAO,CAAEvC,QAAS,QAAUyG,IAAKX,EAAUmO,KAAK,SAkCzD,OA3BArX,oBAAU,WACR,IAAMo4B,EAAe,SAAAC,GAAO,IACnBC,EADmBj5B,OAAAiO,EAAA,EAAAjO,CACP6J,EAAStJ,QAAQ24B,OADV,GAE1B,GAAID,EAAM,CACR,IAAME,EAAS,IAAIC,WACnBD,EAAOE,OAAS,SAAAl0B,GACd8C,EAAS9C,EAAE8M,OAAOqnB,SAEpBH,EAAOI,cAAcN,GAEvBpvB,EAAStJ,QAAQ+H,MAAQ,MAU3B,OAPIuB,EAAStJ,UACXsJ,EAAStJ,QAAQqB,iBAAiB,SAAUm3B,GACvCF,EAASt4B,UACZsJ,EAAStJ,QAAQi5B,QACjBX,EAASt4B,SAAU,IAGhB,WACDsJ,EAAStJ,SACXsJ,EAAStJ,QAAQsB,oBAAoB,SAAUk3B,KAGlD,CAAClvB,EAAStJ,UAEN,CAAEk5B,YAAaX,EAASY,WA/BZ,WACb7vB,EAAStJ,SAASsJ,EAAStJ,QAAQi5B,oBCJrCj3B,EAAYC,YAAW,SAAAC,GAAK,MAAK,CACrCuE,KAAM,CACJjE,OAAQ,OACRgB,QAAS,OACTV,cAAe,SACf8L,UAAW,SACXvM,MAAOH,EAAM8D,QAAQkF,KAAK,KAC1B+T,OAAM,cAAA3b,OAAgBpB,EAAM8D,QAAQkF,KAAK,OAE3C2D,KAAM,CACJxM,MAAOH,EAAM8D,QAAQkF,KAAK,KAC1B7H,OAAQ,OACR6D,KAAM,UACN1E,OAAQ,MACRS,MAAO,OAETm2B,OAAQ,CACN/1B,OAAQnB,EAAM0E,QAAQ,OA0BXyyB,IAtBW,SAAA11B,GAAgC,IAA7B2yB,EAA6B3yB,EAA7B2yB,aAAc/M,EAAe5lB,EAAf4lB,SACnC9kB,EAAUzC,IADwCs3B,EAEpBjB,EAAa/B,GAAzC4C,EAFgDI,EAEhDJ,YAAaC,EAFmCG,EAEnCH,WACrB,OACEp0B,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQgC,MACrByyB,EACDn0B,EAAAlD,EAAAmD,cAACu0B,EAAA13B,EAAD,CAAkB8D,UAAWlB,EAAQoK,KAAKxM,MAAM,UAAUqD,QAASyzB,IACnEp0B,EAAAlD,EAAAmD,cAAC2kB,EAAA,EAAD,CAAQtd,QAAQ,YAAY1G,UAAWlB,EAAQ20B,OAAQ/2B,MAAM,UAAUqD,QAASyzB,GAAhF,uBAGAp0B,EAAAlD,EAAAmD,cAAC2kB,EAAA,EAAD,CAAQtd,QAAQ,WAAW1G,UAAWlB,EAAQ20B,OAAQ/2B,MAAM,YAAYqD,QAAS6jB,GAAjF,2KCpBAvnB,EAAYC,YClBH,SAAAC,GAAK,MAAK,CACvBuE,KAAM,GAGN2S,UAAW,CACT/W,MAAOH,EAAM8D,QAAQmT,KAAKpK,WAE5B8gB,aAAc,CACZtoB,UAAWrF,EAAM0E,QAAQ,GACzBuY,aAAcjd,EAAM0E,QAAQ,GAC5BvE,MAAOH,EAAM8D,QAAQmT,KAAKpK,WAE5BlH,IAAK,CACHsX,aAAcjd,EAAM0E,QAAQ,IAE9BsoB,WAAY,CACV/P,aAAcjd,EAAM0E,QAAQ,IAE9B6iB,MAAO,CACLtK,aAAcjd,EAAM0E,QAAQ,OD2EjB4yB,IA1EM,SAAA71B,GAA4C,IAAzCgJ,EAAyChJ,EAAzCgJ,MAAO4nB,EAAkC5wB,EAAlC4wB,UAAWhL,EAAuB5lB,EAAvB4lB,SAAU+N,EAAa3zB,EAAb2zB,OAC5C7yB,EAAUzC,IAD+CpD,EAGzBC,mBAAS01B,GAAa,IAHG/0B,EAAAC,OAAAsN,EAAA,EAAAtN,CAAAb,EAAA,GAGxD66B,EAHwDj6B,EAAA,GAG3Ck6B,EAH2Cl6B,EAAA,GAAAmB,EAI3B9B,mBAAS8N,GAJkB3L,EAAAvB,OAAAsN,EAAA,EAAAtN,CAAAkB,EAAA,GAIxDg5B,EAJwD34B,EAAA,GAI5C44B,EAJ4C54B,EAAA,GAiB/D,OACE+D,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQgC,MACtB1B,EAAAlD,EAAAmD,cAAC60B,EAAA,EAAD,MADF,IAEE90B,EAAAlD,EAAAmD,cAAC4G,EAAA,EAAD,CACEE,YAAU,EACV9C,WAAS,EACT6C,OAAO,QACP+V,sBAAoB,EACpBC,sBAAoB,EACpBvW,QAASie,EACTvd,kBAAgB,0BAChBZ,MAAI,GAEJrG,EAAAlD,EAAAmD,cAACiH,EAAA,EAAD,CAAaiV,mBAAiB,EAACvb,UAAWlB,EAAQqlB,mBAChD/kB,EAAAlD,EAAAmD,cAAC4E,EAAA,EAAD,CAAYyC,QAAQ,KAAK1G,UAAWlB,EAAQsc,UAA5C,yBAIFhc,EAAAlD,EAAAmD,cAACwkB,EAAA,EAAD,OAEK+K,GACDxvB,EAAAlD,EAAAmD,cAACwrB,EAAA,EAAD,CACEC,OAAQ8D,EACRnK,MAAOqP,EACP/xB,SAAUgyB,IAId30B,EAAAlD,EAAAmD,cAAC80B,EAAA,EAAD,CACEntB,MAAOA,EACPwd,SAAO,EACPC,MAAOuP,EACPjyB,SAAU,SAACqyB,GAAD,OAAaH,EAAcn6B,OAAA2J,EAAA,EAAA3J,CAAA,GAAKk6B,EAAeI,QAI7Dh1B,EAAAlD,EAAAmD,cAAC0kB,EAAA,EAAD,KACE3kB,EAAAlD,EAAAmD,cAAC2kB,EAAA,EAAD,CAAQjkB,QAAS6jB,EAAUlnB,MAAM,WAAjC,UAGA0C,EAAAlD,EAAAmD,cAAC2kB,EAAA,EAAD,CAAQjkB,QAAS,kBAAM4xB,EAAO,CAAE7G,OAAQgJ,EAAa9sB,MAAOgtB,KAAet3B,MAAM,WAAjF,wIE/DJL,EAAYC,YCdH,SAAAC,GAAK,MAAK,CACvBuE,KAAM,CACJlE,WAAY,oBAEZC,OAAQ,OACRS,MAAO,QAET+2B,kBAAmB,CACjBv3B,SAAU,WACV6E,OAAQ,EACR9E,OAAQ,OACRS,MAAO,QAETg3B,mBAAoB,CAClBx3B,SAAU,WACV6E,OAAQ,EACR9E,OAAQ,OACRS,MAAO,QAET+zB,SAAU,GAGVkD,UAAW,GAGXC,uBAAwB,CACtBl3B,MAAO,OACPO,QAAS,OACTnB,MAAO,QACPE,WAAY,kBACZoE,QAASzE,EAAM0E,QAAQ,GACvBnE,SAAU,WACV6E,OAAQ,EACR3E,IAAK,GAEPy3B,QAAS,CACP1rB,SAAU,EACVrM,MAAO,QACPyY,WAAY,cACZlM,UAAW,SAEbyrB,QAAS,CACP3rB,SAAU,EACVrM,MAAO,QACPyY,WAAY,kBDkDDwf,IA9ES,SAAA32B,GAGlB,IAFJqzB,EAEIrzB,EAFJqzB,SAAUD,EAENpzB,EAFMozB,kBACVpV,EACIhe,EADJge,UAAW4H,EACP5lB,EADO4lB,SAAU0N,EACjBtzB,EADiBszB,QAEbxG,EAAW5jB,qBAAWC,KAAtB2jB,OACFiB,EAASjB,GAAUA,EAAOiB,OAASjB,EAAOiB,OAAS,KACnDjtB,EAAUzC,IAEVu4B,EAAcxD,EAChBrF,EAAO3a,KAAK,SAAAyjB,GAAC,OAAIA,EAAEr0B,KAAO4wB,IAC1BrF,GAAUA,EAAOtlB,OAAS,EAAIslB,EAAO,GAAK,KAP1C9yB,EAS4BC,mBAAS07B,GATrC/6B,EAAAC,OAAAsN,EAAA,EAAAtN,CAAAb,EAAA,GASG67B,EATHj7B,EAAA,GAAAmB,GAAAnB,EAAA,GAUwBX,mBAAS,MAVjCmC,EAAAvB,OAAAsN,EAAA,EAAAtN,CAAAkB,EAAA,GAUGsiB,EAVHjiB,EAAA,GAUWkiB,EAVXliB,EAAA,GAYJ,OAAKg2B,EAGHjyB,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQgC,MACtB1B,EAAAlD,EAAAmD,cAAC60B,EAAA,EAAD,MACErrB,QAAQisB,IACR11B,EAAAlD,EAAAmD,cAACge,EAAA,EAAD,CAAiBV,aAAc,IAAK5a,SAAUwb,IAGhDne,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQuyB,UACtBjyB,EAAAlD,EAAAmD,cAACuK,EAAA,EAAD,CACEZ,QAASsU,EAAS,IAClBtd,UAAWlB,EAAQu1B,kBACnBrtB,MAAOqqB,KAGTxoB,QAAQisB,IACR11B,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQy1B,WACtBn1B,EAAAlD,EAAAmD,cAACuK,EAAA,EAAD,CACE5J,UAAWlB,EAAQw1B,mBACnBttB,MAAO8tB,KAIb11B,EAAAlD,EAAAmD,cAACyuB,EAAA,EAAD,CACEroB,MAAI,EACJsoB,iBAAkB,KAClBC,aAAc,CACZC,mBAAoB,0BACpBjuB,UAAWlB,EAAQ6sB,iBAErB5P,QAAS3c,EAAAlD,EAAAmD,cAAA,QAAMmB,GAAG,2BAAT,oBACTgiB,OAAQpjB,EAAAlD,EAAAmD,cAAA,WACND,EAAAlD,EAAAmD,cAAC2kB,EAAA,EAAD,CAAQtnB,MAAM,UAAUwO,KAAK,QAAQnL,QAAS6jB,GAA9C,UAGC/a,QAAQyoB,IACPlyB,EAAAlD,EAAAmD,cAAC2kB,EAAA,EAAD,CAAQtnB,MAAM,UAAUwO,KAAK,QAAQnL,QAASuxB,GAA9C,SAKFlyB,EAAAlD,EAAAmD,cAAC2kB,EAAA,EAAD,CAAQtnB,MAAM,UAAUwO,KAAK,QAAQnL,QAASic,GAA9C,SAKFhc,UAAWlB,EAAQ+sB,YA/CH,oOEVlBxvB,EAAYC,YCrBH,SAAAC,GAAK,MAAK,CACvBuE,KAAM,CACJlE,WAAY,QAEZC,OAAQ,OACRS,MAAO,QAETy3B,gBAAiB,CACfr4B,MAAO,QACPI,SAAU,WACVE,IAAK,MACLD,KAAM,MACNO,MAAO,MACPkM,UAAW,oCACXP,UAAW,UAEb+rB,YAAa,CACXt4B,MAAO,mBACPE,WAAY,oBACZoM,QAAS,IAEXisB,UAAW,CACTn4B,SAAU,WACV6E,OAAQ,GACRuzB,kCAAmC,CACjC93B,MAAO,OACPJ,IAAK,MACLwM,UAAW,mBACX3M,OAAQ,OACRS,MAAO,QAET63B,iCAAkC,CAChC11B,OAAQ,OACR1C,KAAM,MACNyM,UAAW,mBACX3M,OAAQ,OACRS,MAAO,SAGX83B,WAAY,CACVv4B,OAAQ,OACRS,MAAO,QAET+3B,UAAW,CACTv4B,SAAU,WACV6E,OAAQ,GACRuzB,kCAAmC,CACjC93B,MAAO,OACPJ,IAAK,OACLH,OAAQ,OACRS,MAAO,QAET63B,iCAAkC,CAChC/3B,MAAO,OACPqC,OAAQ,OACR5C,OAAQ,OACRS,MAAO,SAGXg4B,WAAY,CACVz4B,OAAQ,OACRS,MAAO,QAGTi4B,YAAa,CACXj4B,MAAO,OAGTk4B,WAAY,CACV14B,SAAU,WACV6E,OAAQ,GACRuzB,kCAAmC,CACjCn4B,KAAM,OACNC,IAAK,OACLH,OAAQ,OACRS,MAAO,QAET63B,iCAAkC,CAChCp4B,KAAM,OACNC,IAAK,OACLH,OAAQ,OACRS,MAAO,SAIXm4B,cAAe,CACb34B,SAAU,WACV6E,OAAQ,GACRuzB,kCAAmC,CACjC93B,MAAO,OACPqC,OAAQ,OACR5C,OAAQ,OACRS,MAAO,QAET63B,iCAAkC,CAChCp4B,KAAM,OACN0C,OAAQ,OACR5C,OAAQ,OACRS,MAAO,SAGXo4B,eAAgB,CACd74B,OAAQ,MACRS,MAAO,OAET+2B,kBAAmB,CACjBv3B,SAAU,WACV6E,OAAQ,EACR9E,OAAQ,OACRS,MAAO,QAETg3B,mBAAoB,CAClBx3B,SAAU,WACV6E,OAAQ,EACR9E,OAAQ,OACRS,MAAO,QAET+zB,SAAU,GAGVkD,UAAW,GAGXxU,MAAO,CACLjjB,SAAU,WACVE,IAAK,EACLD,KAAM,EACNF,OAAQ,QACRS,MAAO,QACPqE,OAAQ,MDqBGg0B,IA9HI,SAAA33B,GAAwD,IAArD+tB,EAAqD/tB,EAArD+tB,OAAQnI,EAA6C5lB,EAA7C4lB,SAAU6L,EAAmCzxB,EAAnCyxB,UAAW2B,EAAwBpzB,EAAxBozB,kBAC3CtyB,EAAUzC,IADyDpD,EAE7CC,mBAAS,IAFoCW,EAAAC,OAAAsN,EAAA,EAAAtN,CAAAb,EAAA,GAElEqkB,EAFkEzjB,EAAA,GAE1D0jB,EAF0D1jB,EAAA,GAGnE+6B,EAAcxD,EAChBrF,EAAO3a,KAAK,SAAAyjB,GAAC,OAAIA,EAAEr0B,KAAO4wB,IAC1BrF,GAAUA,EAAOtlB,OAAS,EAAIslB,EAAO,GAAK,KAL2B/wB,EAOzC9B,mBAAS07B,GAPgCv5B,EAAAvB,OAAAsN,EAAA,EAAAtN,CAAAkB,EAAA,GAOlE85B,EAPkEz5B,EAAA,GAOxDu6B,EAPwDv6B,EAAA,GAAA8O,EAQrCjR,oBAAS,GAR4BkR,EAAAtQ,OAAAsN,EAAA,EAAAtN,CAAAqQ,EAAA,GAQlE0rB,EARkEzrB,EAAA,GAQtD0rB,EARsD1rB,EAAA,GAAA2rB,EASrBrY,YAAU,SAAC7d,GAAD,OAAU4vB,EAAU5vB,EAAMi1B,EAAWA,EAASt0B,GAAK,QAAzGqd,EATiEkY,EASjElY,YAAaW,EAToDuX,EASpDvX,aAAcT,EATsCgY,EAStChY,aAOnC,OACE3e,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQgC,MACtB1B,EAAAlD,EAAAmD,cAAC60B,EAAA,EAAD,OACGrW,GAAehV,QAAQisB,IACxB11B,EAAAlD,EAAAmD,cAACge,EAAA,EAAD,CAAiBV,aAAcW,EAAQvb,SAAUwb,IAGjDM,GACAze,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQi2B,iBACtB31B,EAAAlD,EAAAmD,cAAC4E,EAAA,EAAD,CAAYyC,QAAQ,YAAYhK,MAAM,WAAtC,oBACA0C,EAAAlD,EAAAmD,cAAC4E,EAAA,EAAD,CAAYyC,QAAQ,QAAQhK,MAAM,WAAlC,4CAIJ0C,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQuyB,UACpBxoB,QAAQisB,IACR11B,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQy1B,WACtBn1B,EAAAlD,EAAAmD,cAACuK,EAAA,EAAD,CACE5J,UAAWlB,EAAQw1B,mBACnBtrB,SAAU,IAAMsU,GAAU,IAC1BtW,MAAO8tB,MAIVjX,GACDze,EAAAlD,EAAAmD,cAAA,SACE22B,UAAQ,EACRC,aAAW,EACXC,OAAK,EACL11B,GAAG,SACHlD,MAAO7B,OAAO+M,WACd3L,OAAQpB,OAAOiN,YACf1I,UAAWlB,EAAQihB,SAKzB3gB,EAAAlD,EAAAmD,cAACinB,EAAA,EAAD,CACE5pB,MAAM,UACN6pB,aAAW,aACXznB,QAAS,CACPS,SAAUT,EAAQk2B,aAEpBz1B,SAAUse,IAAgBE,EAC1B/d,UAAWC,IAAWnB,EAAQm2B,UAAWn2B,EAAQq3B,WACjDp2B,QAASye,GAETpf,EAAAlD,EAAAmD,cAAC+2B,EAAAl6B,EAAD,CAAY8D,UAAWlB,EAAQs2B,cAGjCh2B,EAAAlD,EAAAmD,cAACinB,EAAA,EAAD,CACE5pB,MAAM,YACN6pB,aAAW,SACXxmB,QAAS6jB,EACT9kB,QAAS,CACPS,SAAUT,EAAQk2B,aAEpBh1B,UAAWC,IAAWnB,EAAQu2B,UAAWv2B,EAAQq3B,YAEjD/2B,EAAAlD,EAAAmD,cAACqB,EAAAxE,EAAD,CAAY8D,UAAWlB,EAAQw2B,cAGjCl2B,EAAAlD,EAAAmD,cAACinB,EAAA,EAAD,CACEC,aAAW,SACXvmB,UAAWC,IAAWnB,EAAQ02B,WAAY12B,EAAQq3B,WAClDr3B,QAAS,CACPS,SAAUT,EAAQk2B,aAEpBz1B,UAAWwsB,GAA4B,IAAlBA,EAAOtlB,OAC5B1G,QAAS,kBAAM+1B,GAAc,KAE7B12B,EAAAlD,EAAAmD,cAACu0B,EAAA13B,EAAD,CAAkB8D,UAAWlB,EAAQu3B,eAGvCj3B,EAAAlD,EAAAmD,cAACi3B,EAAA,EAAD,CACEC,OAAO,OACP9wB,KAAMowB,EACN/2B,QAAS,CACP03B,gBAAiB13B,EAAQy2B,aAE3B5vB,QAAS,kBAAMmwB,GAAc,IAC7BW,OAAQ,kBAAMX,GAAc,KAE5B12B,EAAAlD,EAAAmD,cAAA,OACEq3B,SAAU,EACV12B,UAAWlB,EAAQ63B,qBACnBC,KAAK,SACL72B,QAAS,kBAAM+1B,GAAc,IAC7Be,UAAW,kBAAMf,GAAc,KAE/B12B,EAAAlD,EAAAmD,cAACysB,EAAA,EAAD,CACEG,aAAa,EACbD,QAAS,EACTD,OAAQA,EACRG,YAnGc,SAAC1rB,GACvBo1B,EAAY7J,EAAO3a,KAAK,SAAAyjB,GAAC,OAAIA,EAAEr0B,KAAOA,KACtCs1B,GAAc,2CErClB1pB,EAAAC,EAAAC,EAAA,sBAAAnF,IAAA,IAAAyL,EAAAxG,EAAA,GAEajF,EAFbiF,EAAA0G,EAAAF,GAE6B4V,EAAMsO,cAAc,oHCFjD,SAAA1G,GAAAhkB,EAAAC,EAAAC,EAAA,sBAAA0kB,IAAA5kB,EAAAC,EAAAC,EAAA,sBAAAgE,IAAAlE,EAAA,SAEa4kB,EAAY,SAAA+F,GACvB,IACE,OAAQC,MAAMC,WAAWF,KAASG,SAASH,GAE7C,MAAO93B,GACL,OAAO,IAgKJ,SAASqR,EAAU6mB,EAAMC,EAAMC,GAAW,IAAAvmB,EAAAC,KAC3CumB,EAAU,KACd,OAAO,WAAkB,QAAAC,EAAAlW,UAAA5a,OAAd+wB,EAAc,IAAArgB,MAAAogB,GAAAE,EAAA,EAAAA,EAAAF,EAAAE,IAAdD,EAAcC,GAAApW,UAAAoW,GACvB,IAAM9W,EAAU7P,EAEV4mB,EAAUL,IAAcC,EAC9BK,aAAaL,GAEbA,EAAU3rB,WAAW,WACnB2rB,EAAU,KACLD,GAEHF,EAAKS,MAAMjX,EAAS6W,IAErBJ,GACCM,GAEFP,EAAKS,MAAMjX,EAAS6W,sLClL1BK,YAAcC,KAEatP,IAAMsO,cAAc,IAAxC,IAQMiB,EAAc,SAAA/5B,GAAA,IAAG6F,EAAH7F,EAAG6F,SAAH,OACzBzE,EAAAlD,EAAAmD,cAAC24B,EAAA,EAAD,CAAcC,OAAO,MAClBp0B,42PChBE,IAAMq0B,EAAYC,IAAHC,KA6CTC,EAAYF,IAAHG,KA4CTC,EAAaJ,IAAHK,KAgDVC,EAAiBN,IAAHO,KA0CdC,EAAgBR,IAAHS,KA6CbC,EAAYV,IAAHW,KAoDTC,GA3CYZ,IAAHa,KA2CCb,IAAHc,MAePC,EAAUf,IAAHgB,KAaPC,EAAYjB,IAAHkB,KA0CTC,EAAanB,IAAHoB,KAcVC,EAAiBrB,IAAHsB,uBCnWrBC,EAAa,CACjBC,iBAAiB,GAGbC,EACC,UADDA,EAEE,UAFFA,EAGO,UAHPA,EAIQ,UAIRptB,EAAO,CACXnM,QAAS,CACP8I,QAAS,CACPqL,KAAMolB,GAERxwB,UAAW,CACToL,KAAMolB,GAERpmB,KAAM,CACJrK,QAASywB,EACTxwB,UAAWywB,eAAKD,EAAY,MAGhCF,cAGI5O,EAAS,CACbzqB,QAAS,CACP8I,QAAS,CACPqL,KAAMslB,kBAAQF,EAAY,KAE5BxwB,UAAW,CACToL,KAAMolB,GAERpmB,KAAM,CACJrK,QAASywB,EACTxwB,UAAWywB,eAAKD,EAAY,MAGhCF,cAGIK,EAAS,CACb15B,QAAS,CACP8I,QAAS,CACPqL,KAAMolB,GAERxwB,UAAW,CACToL,KAAMolB,IAGVF,cAGIM,EAAY,CAChB35B,QAAS,CACP8I,QAAS,CACPqL,KAAMolB,GAERxwB,UAAW,CACToL,KAAMolB,IAGVF,cAGIO,EAAQ,CACZ55B,QAAS,CACP8I,QAAS,CACPqL,KAAMolB,GAERxwB,UAAW,CACToL,KAAMolB,GAERpmB,KAAM,CACJrK,QAASywB,EACTxwB,UAAWywB,eAAKD,EAAmB,KAErCh9B,WAAY,CACVuV,QAASynB,EACTl4B,MAAOk4B,IAGXF,cAGaQ,EAAA,CACb1tB,KAAM2tB,YAAe3tB,GACrBytB,MAAOE,YAAeF,GACtBnP,OAAQqP,YAAerP,GACvBiP,OAAQI,YAAeJ,GACvBC,UAAWG,YAAeH,IClGfI,EAAa5R,IAAMsO,cAAc,kCC8B/BuD,GA9BO,WACpB,IAAMC,EAAengC,mBACfogC,EAAiB,SAAChgC,GACtB,GAAkB,UAAdA,EAAMsM,KACJyzB,EAAajgC,QACf,IACE,IAAMmgC,EAAQF,EAAajgC,QAAQogC,uBAAuB,eACtDD,GAASA,EAAM,IAAIA,EAAM,GAAGlH,QAElC,MAAOr0B,GACLoD,QAAQqJ,MAAM,gCAAiCzM,KAiBvD,OAZAxE,oBAAU,WACR,GAAI6/B,EAAajgC,QAAS,CACxB,IACE8jB,SAASziB,iBAAiB,WAAY6+B,GAAgB,GAExD,MAAOt7B,GACLoD,QAAQqJ,MAAM,2BAA4BzM,GAE5C,OAAO,kBAAMkf,SAASxiB,oBAAoB,WAAY4+B,GAAgB,MAEvE,IAEID,uBC1BMI,QACbt7B,EAAAlD,EAAAmD,cAACD,EAAAlD,EAAMupB,SAAP,KACErmB,EAAAlD,EAAAmD,cAAA,QAAMgN,EAAE,+MACRjN,EAAAlD,EAAAmD,cAAA,QAAMgN,EAAE,gNACRjN,EAAAlD,EAAAmD,cAAA,QAAMgN,EAAE,iNACRjN,EAAAlD,EAAAmD,cAAA,QAAMgN,EAAE,wNACRjN,EAAAlD,EAAAmD,cAAA,QAAMgN,EAAE,sNACRjN,EAAAlD,EAAAmD,cAAA,QAAMgN,EAAE,sNAES,qBCAfhQ,GAAYC,aAAW,SAAAC,GAAK,MAAK,CACrCuE,KAAM,CACJjE,OAAQ,QAEV89B,SAAU,CACRr9B,MAAO,OACPT,OAAQ,OACRC,SAAU,WACVE,IAAK,EACLD,KAAM,EACN4E,OAAQ,GAEVi5B,KAAM,CACJt9B,MAAO,OACPT,OAAQ,OACR8E,OAAQ,GAEV4H,MAAO,CACLjM,MAAO,OACPqtB,SAAU,IACVrP,SAAU,IACVxe,SAAU,WACV6E,OAAQ,EACRsH,UAAW,SACXjM,IAAK,MACLD,KAAM,MACN0X,gBAAiB,UACjBjL,UAAW,wCAgCAqxB,GA5BO,SAAA78B,GAAkB,IAAf6F,EAAe7F,EAAf6F,SACjBy2B,EAAeD,KACfv7B,EAAUzC,KAChB,OACE+C,EAAAlD,EAAAmD,cAACy7B,GAAA,EAAD,CAAev+B,MAAO29B,EAAOD,OAC3B76B,EAAAlD,EAAAmD,cAAA,OAAKiF,IAAKg2B,EAAct6B,UAAWlB,EAAQgC,MACzC1B,EAAAlD,EAAAmD,cAAC60B,GAAA,EAAD,MAMA90B,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQyK,OAEtBnK,EAAAlD,EAAAmD,cAAC07B,GAAD,CAAS/6B,UAAWlB,EAAQ87B,OAE5Bx7B,EAAAlD,EAAAmD,cAAC4E,GAAA,EAAD,CAAYyC,QAAQ,MAApB,YACC7C,MCtCIm3B,GAZC,WAEd,OACE57B,EAAAlD,EAAAmD,cAAC47B,GAAD,KACE77B,EAAAlD,EAAAmD,cAAC4E,GAAA,EAAD,CAAYyC,QAAQ,MAApB,gECiCSw0B,eArCb,SAAAA,EAAa18B,GAAO,IAAAsS,EAAA,OAAAhX,OAAAqhC,GAAA,EAAArhC,CAAAiX,KAAAmqB,GAClB74B,QAAQC,IAAI,8BACZwO,EAAAhX,OAAAshC,GAAA,EAAAthC,CAAAiX,KAAAjX,OAAAuhC,GAAA,EAAAvhC,CAAAohC,GAAAI,KAAAvqB,KAAMvS,KACDxE,MAAQ,CAAEuhC,UAAU,GAHPzqB,mFAaDpF,EAAO8vB,GACxBn5B,QAAQC,IAAI,mCACZD,QAAQqJ,MAAMA,oCAKN,IAAA+vB,EACoB1qB,KAAK/W,MAAzBuhC,EADAE,EACAF,SAAU7vB,EADV+vB,EACU/vB,MACAgwB,EAAe3qB,KAAKvS,MAA9Bm9B,SACR,OAAIJ,GACFl5B,QAAQC,IAAI,0BAELlD,EAAAlD,EAAAmD,cAACq8B,EAAD,CAAYhwB,MAAOA,KAGrBqF,KAAKvS,MAAMqF,4DAvBa6H,GAI/B,OAFArJ,QAAQC,IAAI,0CACZD,QAAQqJ,MAAMA,GACP,CAAE6vB,UAAU,EAAM7vB,gBAXD8c,IAAMoT,6ICMrBC,GACH,SADGA,GAEF,UAFEA,GAGL,OAHKA,GAIJ,QAGHx/B,GAAYC,aAAW,SAAAC,GAAK,MAAK,CACrCuE,KAAM,CACJjE,OAAQ,OACR4E,SAAU,SACVT,QAASzE,EAAM0E,QAAQ,GACvBpD,QAAS,OACTV,cAAe,SACf8L,UAAW,SACXvM,MAAOH,EAAM8D,QAAQmT,KAAKrK,QAC1BmQ,OAAM,cAAA3b,OAAgBpB,EAAM8D,QAAQmT,KAAKpK,YAE3CqqB,OAAQ,GAIRvqB,KAAM,CACJF,QAAS,GACTtL,OAAQ,OACR6D,KAAM,UAENjE,MAAO,OAETkW,KAAM,GAENsoB,OAAQ,CACN/yB,SAAU,GAEZgzB,MAAO,CACL/6B,QAASzE,EAAM0E,QAAQ,GACvBuY,aAAcjd,EAAM0E,QAAQ,GAC5BtE,SAAU,MACVoM,SAAU,EACVE,UAAW,OACXmK,WAAY,WACZ3R,SAAU,SACV/E,MAAOH,EAAM8D,QAAQqL,MAAM8I,KAC3BwnB,WAAY,kCA4GDC,GAxGK,SAAAj+B,GAAuC,IAApC0N,EAAoC1N,EAApC0N,MAAOwwB,EAA6Bl+B,EAA7Bk+B,UAAWC,EAAkBn+B,EAAlBm+B,YACjCr9B,EAAUzC,KADyCpD,EAExBC,oBAAS,GAFeW,EAAAC,OAAAsN,GAAA,EAAAtN,CAAAb,EAAA,GAElDmjC,EAFkDviC,EAAA,GAEzCwiC,EAFyCxiC,EAAA,GAAAmB,EAGjC9B,mBAAS,IAHwBmC,EAAAvB,OAAAsN,GAAA,EAAAtN,CAAAkB,EAAA,GAGlDsqB,EAHkDjqB,EAAA,GAG5CihC,EAH4CjhC,EAAA,GAKrDkhC,EAAUn9B,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQg9B,SAYtC,IAAIU,EAAa,kBACbj9B,GAAW,EACX7C,EAAQ,UACZ,OAAQw/B,GACN,KAAKL,GACHW,EAAa,kBACb,MACF,KAAKX,GACHt8B,GAAW,EACX7C,EAAQ,UACR8/B,EAAa,aACb,MACF,KAAKX,GACHn/B,EAAQ,UACR6C,GAAW,EACXi9B,EAAa,8BACb,MACF,KAAKX,GACHn/B,EAAQ,YACR6C,GAAW,EACXi9B,EAAa,2BAMjB,OACEp9B,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQgC,MACtB1B,EAAAlD,EAAAmD,cAAC60B,GAAA,EAAD,MACA90B,EAAAlD,EAAAmD,cAACo9B,GAAAvgC,EAAD,CAAW8D,UAAWlB,EAAQoK,KAAMxM,MAAM,UAC1C0C,EAAAlD,EAAAmD,cAAC4E,GAAA,EAAD,CAAYyC,QAAQ,YAAY1G,UAAWlB,EAAQ0U,KAAM9W,MAAM,WAA/D,wBAGCgP,GAASA,EAAMqQ,SAAW3c,EAAAlD,EAAAmD,cAAC4E,GAAA,EAAD,CAAYyC,QAAQ,QAAQ1G,UAAWlB,EAAQ0U,KAAM9W,MAAM,WACnFgP,EAAMqQ,SAET3c,EAAAlD,EAAAmD,cAAC2kB,GAAA,EAAD,CACEhkB,UAAWlB,EAAQ20B,OACnB/sB,QAAQ,YACRnH,SAAUA,EACV7C,MAAOA,EACPqD,QAAS,kBAAMs8B,GAAc,KAE7Bj9B,EAAAlD,EAAAmD,cAACq9B,GAAAxgC,EAAD,MACCsgC,GAEFD,EACDn9B,EAAAlD,EAAAmD,cAAC4G,GAAA,EAAD,CAAQR,KAAM22B,EAASz2B,QAAS,kBAAM02B,GAAc,IAAQh2B,kBAAgB,qBAC1EjH,EAAAlD,EAAAmD,cAACiH,GAAA,EAAD,CAAa9F,GAAG,qBAAhB,gBACApB,EAAAlD,EAAAmD,cAACwkB,GAAA,EAAD,KACEzkB,EAAAlD,EAAAmD,cAACs9B,GAAA,EAAD,4DAGAv9B,EAAAlD,EAAAmD,cAAC+D,GAAA,EAAD,CACEw5B,WAAS,EACTl/B,OAAO,QACP2e,WAAS,EACTta,SAAU,SAAC9C,GAAD,OAAOq9B,EAAQr9B,EAAE8M,OAAO3J,QAClCsa,QAAQ,IACRlc,GAAG,OACHW,YAAY,sCACZZ,MAAM,OACN8C,WAAS,KAGbjE,EAAAlD,EAAAmD,cAAC0kB,GAAA,EAAD,KACE3kB,EAAAlD,EAAAmD,cAAC2kB,GAAA,EAAD,CAAQjkB,QAAS,kBAAMs8B,GAAc,IAAQ3/B,MAAM,WAAnD,UAGA0C,EAAAlD,EAAAmD,cAAC2kB,GAAA,EAAD,CAAQjkB,QAAS,WACfo8B,EAAY7W,GACZ+W,GAAc,IACb3/B,MAAM,WAHT,8oGClJH,IAAMmgC,GAAc1E,IAAH2E,MAMXC,GAAe5E,IAAH6E,MAMZC,GAAe9E,IAAH+E,MAyBZC,GAAchF,IAAHiF,MAQXC,GAAclF,IAAHmF,MAoCXC,GAAepF,IAAHqF,MAgEZC,GAActF,IAAHuF,MAMXC,GAAgBxF,IAAHyF,MAMbC,GAAY1F,IAAH2F,MClJhBC,GAAwBxvB,YAAQsvB,GAAW,CAC/Cr/B,MAAO,SAAAR,GAA2D,IAAxDggC,EAAwDhgC,EAAxDggC,OAAwDC,EAAAjgC,EAAhDkgC,SAAYC,EAAoCF,EAApCE,WAAYzyB,EAAwBuyB,EAAxBvyB,MAAOzR,EAAiBgkC,EAAjBhkC,SAG/C,OAFAoI,QAAQC,IAAI,8BAA+B,CAAE07B,SAAQG,aAAYzyB,UAC7DsyB,EAAOtyB,OAAOzR,EAAS4hC,IACpB,CACLM,YAAa,SAAC7W,GACZrrB,EAAS4hC,IACT,IAAIuC,EAAa,GACXC,EAAS,CAAE/Y,OAAM6Y,aAAYzyB,QAAO4yB,IAAKnxB,4hBAC/C9K,QAAQC,IAAI,sCAAuC+7B,GACnD,IACED,EAAanZ,KAAKqL,UAAU+N,GAE9B,MAAOp/B,GACLm/B,EAAa1yB,EAAM6yB,WAGrB,OADAl8B,QAAQC,IAAI,uCAAwC87B,GAC7CJ,EAAO,CACZQ,UAAW,CAAEJ,cACbK,OAAQ,SAACC,EAAD16B,GAAqB,IAAXnE,EAAWmE,EAAXnE,KAChBwC,QAAQC,IAAI,+BAAgCzC,GAC5C5F,EAAS4hC,YAwBN8C,gBAbS,SAAC3kC,EAAOwE,GAAU,IAChC0D,EAAkClI,EAAlCkI,IAAKsK,EAA6BxS,EAA7BwS,KAAmBoyB,GAAU5kC,EAAvB6kC,SADqB/kC,OAAA2E,EAAA,EAAA3E,CACEE,EADF,4BAElC8kC,EAAS58B,EAAI8tB,OAAO,GAE1B,MAAO,CACLmO,WAAWrkC,OAAA2J,EAAA,EAAA3J,CAAA,GACN8kC,EADK,CAER18B,IAAK48B,EACLtyB,WAKSmyB,CAnDM,SAACngC,GAAU,IAAAvF,EACJC,mBAAS2iC,IADLhiC,EAAAC,OAAAsN,GAAA,EAAAtN,CAAAb,EAAA,GACvBe,EADuBH,EAAA,GAChBI,EADgBJ,EAAA,GAExBklC,EAAUhB,GAAsB9B,IACtC,OAAO78B,EAAAlD,EAAAmD,cAAC0/B,EAADjlC,OAAAqG,OAAA,GAAa3B,EAAb,CAAoBvE,SAAUA,EAAUiiC,UAAWliC,oHCD5DglC,KAAQC,UAAUtyB,MAElB,IAAMuyB,GAAsB,eAObC,OALf,WAEE,OADqBtoB,kBAAQuoB,GAAoB,KAU7CC,GAAe,eAAArhC,EAAAlE,OAAAwlC,GAAA,EAAAxlC,CAAAylC,GAAArjC,EAAAsjC,KAAG,SAAAC,IAAA,IAAAC,EAAA,OAAAH,GAAArjC,EAAAyjC,KAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,cAAAF,EAAAC,KAAA,EAAAD,EAAAE,KAAA,EAEMrxB,QAAKsxB,iBAFX,cAEdL,EAFcE,EAAAI,KAAAJ,EAAAK,OAAA,SAGbP,EAAYQ,YAAYC,UAHX,cAAAP,EAAAC,KAAA,EAAAD,EAAAQ,GAAAR,EAAA,SAMpBv9B,QAAQqJ,MAARk0B,EAAAQ,IANoBR,EAAAK,OAAA,SAOb,MAPa,yBAAAL,EAAAngB,SAAAggB,EAAA,iBAAH,yBAAAzhC,EAAA45B,MAAA7mB,KAAAsQ,YAAA,GAWrB,SAAS+d,KAEP,IAAMiB,EAAQ,IAAIC,KAGZC,EAAWC,aAAU,eAAAt8B,EAAApK,OAAAwlC,GAAA,EAAAxlC,CAAAylC,GAAArjC,EAAAsjC,KAAC,SAAAiB,EAAOC,EAAP18B,GAAA,IAAA28B,EAAAC,EAAAC,EAAA,OAAAtB,GAAArjC,EAAAyjC,KAAA,SAAAmB,GAAA,cAAAA,EAAAjB,KAAAiB,EAAAhB,MAAA,cAAYa,EAAZ38B,EAAY28B,QAAZG,EAAAhB,KAAA,EACNT,KADM,cACpBuB,EADoBE,EAAAd,KAEpBa,EAFoB/mC,OAAA2J,EAAA,EAAA3J,CAAA,GAGrB6mC,EAHqB,CAIxBI,cAAeH,EAAK,UAAAjjC,OAAaijC,GAAU,KAJnBE,EAAAb,OAAA,SAanB,CAAEU,QAASE,IAbQ,wBAAAC,EAAArhB,SAAAghB,MAAD,gBAAAO,EAAAC,GAAA,OAAA/8B,EAAA0zB,MAAA7mB,KAAAsQ,YAAA,IAiBrB6f,EAAWC,aAAe,CAAEC,IAAK30B,KAAU8B,UAWjD,OAVAlM,QAAQC,IAAI,gCAAiCmK,KAAU8B,SAElC,IAAI8yB,KAAa,CACpCC,KAAMC,KAAWlR,KAAK,CAACkQ,EAAUW,IACjCM,UAAWtC,GACXmB,QACAoB,mBAAmBt0B,oEChERu0B,GAAA,SAAAnlC,GAAK,MAAK,CACvBuE,KAAM,GAENg7B,OAAQ,CACN/yB,SAAU,GAEZ44B,eAAgB,CACdrkC,MAAO,OACP2L,UAAW,SAEb24B,OAAQ,GAGRC,aAAc,CACZ94B,SAAU,EACV+4B,eAAgB,CACdC,aAAc,GAEhBC,gBAAiB,CACfD,aAAc,IAGlBE,cAAe,CACbrgC,UAAWrF,EAAM0E,QAAQ,GACzBpD,QAAS,QAGXqkC,iBAAkB,CAChBxkC,OAAQnB,EAAM0E,QAAQ,GACtB0pB,SAAU,KAEZwX,SAAU,CACRvgC,UAAWrF,EAAM0E,QAAQ,GACzBmhC,UAAW,UAEbC,SAAU,CACRzgC,UAAWrF,EAAM0E,QAAQ,MCvBvB5E,GAAYC,aAAW8D,IAmFdkiC,GAjFA,SAAAtkC,GAMgB,IANbukC,EAMavkC,EANbukC,QAChBC,EAK6BxkC,EAL7BwkC,aAEAC,GAG6BzkC,EAJ7B0kC,UAI6B1kC,EAH7BykC,sBACAE,EAE6B3kC,EAF7B2kC,kBACAC,EAC6B5kC,EAD7B4kC,kBACAC,EAA6B7kC,EAA7B6kC,aACM/jC,GADuBhF,OAAA2E,EAAA,EAAA3E,CAAAkE,EAAA,sHACb3B,MAChB,OACE+C,EAAAlD,EAAAmD,cAAC47B,GAAD,KAIE77B,EAAAlD,EAAAmD,cAAC+D,GAAA,EAAD,CACE5C,GAAG,WACH6C,WAAS,EACTwD,IAAI,WACJqO,KAAK,WACL3U,MAAM,WACN7D,MAAM,UACNkgC,WAAS,EACT58B,UAAWlB,EAAQqjB,UACnBzkB,OAAO,SACPqE,SAAU4gC,IAEZvjC,EAAAlD,EAAAmD,cAAC+D,GAAA,EAAD,CACEC,WAAS,EACT7C,GAAG,WACHD,MAAM,WACN7D,MAAM,UACNmK,IAAI,WACJqO,KAAK,WACLpD,KAAK,WACL9R,UAAWlB,EAAQqjB,UACnB2gB,aAAa,mBACbplC,OAAO,SACPqE,SAAU4gC,IAEZvjC,EAAAlD,EAAAmD,cAAC0jC,GAAA,EAAD,CAAMl+B,UAAU,SAAS6B,QAAQ,QAAQ1G,UAAWlB,EAAQ6iC,eAAgBpiC,SAAUgjC,EAASxiC,QAAS0iC,GAAxG,mBAGArjC,EAAAlD,EAAAmD,cAAC2jC,GAAA,EAAD,CAASC,gBAAc,GAErB7jC,EAAAlD,EAAAmD,cAAC2kB,GAAA,EAAD,CAAQnf,UAAU,SAASnI,MAAM,YAAYgK,QAAQ,YAAYnH,SAAUgjC,EAASxiC,QAASyiC,GAA7F,eAGApjC,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQg9B,SACxB18B,EAAAlD,EAAAmD,cAAC2kB,GAAA,EAAD,CACEhkB,UAAU,cACV6E,UAAU,SACVnI,MAAM,UACNgK,QAAQ,YACRnH,SAAUgjC,EACVxiC,QAAS8iC,GANX,YAYFzjC,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQujC,UACtBjjC,EAAAlD,EAAAmD,cAAC2kB,GAAA,EAAD,CAAQ3gB,WAAS,EAACqD,QAAS,WAAY3G,QAAS6iC,EAAmBlmC,MAAM,WAAzE,+BAGA0C,EAAAlD,EAAAmD,cAAC4E,GAAA,EAAD,CAAYyC,QAAQ,UAAU1G,UAAWlB,EAAQqjC,SAAUzlC,MAAM,gBAAgBmI,UAAU,OAA3F,iFCpEFxI,GAAYC,aAAW8D,IAyCd8iC,GAvCO,SAAAllC,GAAsD,IAAnD2kC,EAAmD3kC,EAAnD2kC,kBAAmBQ,EAAgCnlC,EAAhCmlC,WAAYC,EAAoBplC,EAApBolC,cAChDtkC,EAAUzC,KAChB,OACE+C,EAAAlD,EAAAmD,cAAC47B,GAAD,KACE77B,EAAAlD,EAAAmD,cAAC+D,GAAA,EAAD,CACE5C,GAAG,UACH6C,WAAS,EACTu5B,WAAS,EACTr8B,MAAM,WACN2U,KAAK,OACLlV,UAAWlB,EAAQqjB,UACnBzkB,OAAO,SACPqE,SAAU4gC,IAGZvjC,EAAAlD,EAAAmD,cAAC2jC,GAAA,EAAD,CAASC,gBAAc,GACrB7jC,EAAAlD,EAAAmD,cAAC2kB,GAAA,EAAD,CAAQtnB,MAAM,YAAYgK,QAAQ,YAAY3G,QAASojC,GAAvD,QAGA/jC,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQg9B,SACxB18B,EAAAlD,EAAAmD,cAAC2kB,GAAA,EAAD,CACEhkB,UAAU,cACVtD,MAAM,UACNgK,QAAQ,YACR3G,QAASqjC,GAJX,cCrBF/mC,GAAYC,aAAW8D,IA0DdijC,GAxDY,SAAArlC,GAAqE,IAAlEslC,EAAkEtlC,EAAlEslC,OAAQC,EAA0DvlC,EAA1DulC,mBAAoBC,EAAsCxlC,EAAtCwlC,aAAcb,EAAwB3kC,EAAxB2kC,kBAChE7jC,EAAUzC,KAChB,OACE+C,EAAAlD,EAAAmD,cAAC47B,GAAD,KACE77B,EAAAlD,EAAAmD,cAAC4E,GAAA,EAAD,mCACA7E,EAAAlD,EAAAmD,cAAC+D,GAAA,EAAD,CACE5C,GAAG,aACH6C,WAAS,EACTu5B,WAAS,EACTr8B,MAAM,eACNP,UAAWlB,EAAQqjB,UACnBrQ,KAAK,WACLgxB,aAAa,eACbplC,OAAO,SACPqE,SAAU4gC,IAEXY,EACErhC,IAAI,SAACuhC,EAAW78B,GAAZ,OACHxH,EAAAlD,EAAAmD,cAAC+D,GAAA,EAAD,CACEC,WAAS,EACTwD,IAAK48B,EACLvuB,KAAMuuB,EACNzjC,UAAWlB,EAAQqjB,UACnBhhB,YAAaqiC,EAAa58B,GAC1BkL,KAAK,OACLpU,OAAO,SACPqE,SAAU4gC,MAIhBvjC,EAAAlD,EAAAmD,cAAC2jC,GAAA,EAAD,CAASC,gBAAc,GAErB7jC,EAAAlD,EAAAmD,cAAC2kB,GAAA,EAAD,CAAQtnB,MAAM,YAAYgK,QAAQ,aAAlC,QAGAtH,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQg9B,SACxB18B,EAAAlD,EAAAmD,cAAC2kB,GAAA,EAAD,CACEtnB,MAAM,UACNgK,QAAQ,YACR3G,QAASujC,EACTtjC,UAAU,eAJZ,4CCnCF3D,GAAYC,aAAW8D,IAiGdsjC,GA/FA,SAAA1lC,GACqD,IADlD2kC,EACkD3kC,EADlD2kC,kBAAmBgB,EAC+B3lC,EAD/B2lC,aAAcC,EACiB5lC,EADjB4lC,kBAAmBC,EACF7lC,EADE6lC,wBACpErB,EAAkExkC,EAAlEwkC,aAAcW,EAAoDnlC,EAApDmlC,WAAYW,EAAwC9lC,EAAxC8lC,iBAAkBC,EAAsB/lC,EAAtB+lC,gBAC5C1hC,QAAQC,IAAI,cAAe,CAAEyhC,kBAAiBD,mBAAkBH,eAAcC,oBAAmBC,4BAD/B,IAAA5qC,EAEhCC,mBAAS6qC,GAFuBlqC,EAAAC,OAAAsN,GAAA,EAAAtN,CAAAb,EAAA,GAE3D+qC,EAF2DnqC,EAAA,GAEhDoqC,EAFgDpqC,EAAA,GAG5DiF,EAAUzC,KACV6nC,EAAuB,SAAAjlC,GAC3B0jC,EAAkB1jC,GAClBglC,EAAahlC,EAAE8M,OAAO3J,QAExB,OACEhD,EAAAlD,EAAAmD,cAAC47B,GAAD,KAEI0I,EAAazhC,IAAI,SAAC4hB,EAAOld,GACvB,MAAqB,iBAAdkd,EAAMjd,IACXzH,EAAAlD,EAAAmD,cAAC+D,GAAA,EAAD,CACEC,WAAS,EACTu5B,UAAgE,IAArD+G,EAAapyB,UAAU,SAAA4yB,GAAC,OAAIA,EAAEt9B,MAAQid,EAAMjd,MACvDiL,KAAMgS,EAAMhS,KACZoD,KAAM4O,EAAMjd,IACZA,IAAKid,EAAMjd,IACX1F,YAAa0iC,EAAwBj9B,GACrCrG,MAAOqjC,EAAkBh9B,GACzB5G,UAAWlB,EAAQqjB,UACnBzkB,OAAO,SACPqE,SAAU4gC,IAGZvjC,EAAAlD,EAAAmD,cAAC+kC,GAAA,EAAD,CACEpkC,UAAWlB,EAAQojC,iBACnB7+B,WAAS,EACTwD,IAAI,YAEJzH,EAAAlD,EAAAmD,cAACglC,GAAA,EAAD,CAAYC,QAAQ,YAAYC,QAAM,GACnCX,EAAkBh9B,GAClBkd,EAAM0gB,SAAW,IAAM,IAE1BplC,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQmjC,eACtB7iC,EAAAlD,EAAAmD,cAAColC,GAAA,EAAD,CACEriC,MAAO4hC,EACPjiC,SAAUmiC,EACV1gC,WAAY,CACV0R,KAAM,YACN1U,GAAI,cAGLsjC,EAAiB5hC,IAAI,SAAAwiC,GAAQ,OAC5BtlC,EAAAlD,EAAAmD,cAAA,UAAQwH,IAAK69B,EAAUtiC,MAAOsiC,GAC3BA,MAIPtlC,EAAAlD,EAAAmD,cAAC+D,GAAA,EAAD,CACEjC,YAAa0iC,EAAwBj9B,GACrCkL,KAAK,MACLzO,WAAS,EACT7C,GAAG,oBACHqG,IAAI,oBACJqO,KAAK,oBACLnT,SAAU4gC,QAOtBvjC,EAAAlD,EAAAmD,cAAC2jC,GAAA,EAAD,CAASC,gBAAc,GACrB7jC,EAAAlD,EAAAmD,cAAC2kB,GAAA,EAAD,CAAQtnB,MAAM,YAAYgK,QAAQ,WAAW3G,QAASojC,GAAtD,QAGA/jC,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQg9B,SACxB18B,EAAAlD,EAAAmD,cAAC2kB,GAAA,EAAD,CACEhkB,UAAU,cACV6E,UAAU,SACVnI,MAAM,UACNgK,QAAQ,YACR3G,QAASyiC,GALX,qBC3EFnmC,GAAYC,aAAW8D,IAuDdukC,GArDO,SAAA3mC,GAAoE,IAAjE2kC,EAAiE3kC,EAAjE2kC,kBAAmBQ,EAA8CnlC,EAA9CmlC,WAAYyB,EAAkC5mC,EAAlC4mC,aAAcxB,EAAoBplC,EAApBolC,cAC9DtkC,EAAUzC,KAChB,OACE+C,EAAAlD,EAAAmD,cAAC47B,GAAD,KACE77B,EAAAlD,EAAAmD,cAAC+D,GAAA,EAAD,CACE5C,GAAG,WACH6C,WAAS,EACTu5B,WAAS,EACT1nB,KAAK,WACL3U,MAAM,WACNP,UAAWlB,EAAQqjB,UACnBzkB,OAAO,SACPqE,SAAU4gC,IAEZvjC,EAAAlD,EAAAmD,cAAC+D,GAAA,EAAD,CACE5C,GAAG,mBACH6C,WAAS,EACT6R,KAAK,OACL3U,MAAM,oBACNP,UAAWlB,EAAQqjB,UACnBzkB,OAAO,SACPqE,SAAU4gC,IAGZvjC,EAAAlD,EAAAmD,cAAC0jC,GAAA,EAAD,CAAMl+B,UAAU,SAAS6B,QAAQ,QAAQ1G,UAAWlB,EAAQ+lC,WAAY9kC,QAAS6kC,GAAjF,eAGAxlC,EAAAlD,EAAAmD,cAAC2jC,GAAA,EAAD,CAASC,gBAAc,GAErB7jC,EAAAlD,EAAAmD,cAAC2kB,GAAA,EAAD,CAAQtnB,MAAM,YAAYgK,QAAQ,WAAW3G,QAASojC,GAAtD,QAGA/jC,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQg9B,SACxB18B,EAAAlD,EAAAmD,cAAC2kB,GAAA,EAAD,CACEtnB,MAAM,UACNgK,QAAQ,YACR1G,UAAU,cACVD,QAASqjC,GAJX,cCjCF/mC,GAAYC,aAAW8D,IAiGd0kC,GA/FQ,SAAA9mC,GAAqE,IAAlE+mC,EAAkE/mC,EAAlE+mC,aAAcpC,EAAoD3kC,EAApD2kC,kBAAmBqC,EAAiChnC,EAAjCgnC,eAAgB7B,EAAiBnlC,EAAjBmlC,WAAiBlqC,EAClEC,oBAAS,GADyDW,EAAAC,OAAAsN,GAAA,EAAAtN,CAAAb,EAAA,GACnF+mC,EADmFnmC,EAAA,GAC7EorC,EAD6EprC,EAAA,GAEpFiF,EAAUzC,KAChB,OACE+C,EAAAlD,EAAAmD,cAAC47B,GAAD,KACE77B,EAAAlD,EAAAmD,cAAC4E,GAAA,EAAD,yBACE+7B,GACA5gC,EAAAlD,EAAAmD,cAAC+D,GAAA,EAAD,CACE5C,GAAG,WACHo8B,WAAS,EACTv5B,WAAS,EACT9C,MAAM,WACN2U,KAAK,WACLlV,UAAWlB,EAAQqjB,UACnBzkB,OAAO,SACPqE,SAAU4gC,IAGb3C,GACC5gC,EAAAlD,EAAAmD,cAAC+D,GAAA,EAAD,CACE5C,GAAG,aACH6C,WAAS,EACTu5B,WAAS,EACTr8B,MAAM,OACN2U,KAAK,OACLlV,UAAWlB,EAAQqjB,UACnBzkB,OAAO,SACPqE,SAAU4gC,IAGb3C,GACC5gC,EAAAlD,EAAAmD,cAAC+D,GAAA,EAAD,CACE5C,GAAG,cACH6C,WAAS,EACT9C,MAAM,eACNP,UAAWlB,EAAQqjB,UACnBrQ,KAAK,WACLoD,KAAK,WACL4tB,aAAa,mBACbplC,OAAO,SACPqE,SAAU4gC,IAGb3C,GACC5gC,EAAAlD,EAAAmD,cAAC0jC,GAAA,EAAD,CAAMl+B,UAAU,SAAS6B,QAAQ,QAAQ1G,UAAWlB,EAAQ+lC,WAAY9kC,QAASilC,GAAjF,eAKF5lC,EAAAlD,EAAAmD,cAAC2jC,GAAA,EAAD,CAASC,gBAAc,GACrB7jC,EAAAlD,EAAAmD,cAAC2kB,GAAA,EAAD,CACEtnB,MAAM,YACNgK,QAAQ,WACR3G,QAAS,WACPigC,EAAOiF,GAAQ,GAAS9B,MAJ5B,QASA/jC,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQg9B,UACtBkE,GACA5gC,EAAAlD,EAAAmD,cAAC2kB,GAAA,EAAD,CACEtnB,MAAM,UACNgK,QAAQ,YACR1G,UAAU,cACVD,QAAS,WACPklC,GAAQ,GACRD,MANJ,aAYDhF,GACC5gC,EAAAlD,EAAAmD,cAAC2kB,GAAA,EAAD,CACEhkB,UAAU,cACVtD,MAAM,UACNgK,QAAQ,YACR3G,QAASglC,GAJX,aC/DV/F,KAAQC,UAAUtyB,MAElB,IAAMu4B,GAAmB,CAAEC,UAAW,OAAQC,SAAU,GAAIC,SAAU,MAqEvDC,GAnEW,WAAM,IAAArsC,EACuBC,mBAASgsC,IADhCrrC,EAAAC,OAAAsN,GAAA,EAAAtN,CAAAb,EAAA,GAAAyrB,EAAA7qB,EAAA,GACrBsrC,EADqBzgB,EACrBygB,UAAWC,EADU1gB,EACV0gB,SAAUC,EADA3gB,EACA2gB,SAAYE,EADZ1rC,EAAA,GAoBxBwlC,EAAe,eAAArhC,EAAAlE,OAAAwlC,GAAA,EAAAxlC,CAAAylC,GAAArjC,EAAAsjC,KAAG,SAAAC,IAAA,IAAAC,EAAA,OAAAH,GAAArjC,EAAAyjC,KAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,cAAAF,EAAAE,KAAA,EACIrxB,QAAKsxB,iBADT,cAChBL,EADgBE,EAAAI,KAEtB39B,QAAQC,IAAI,OAAQo9B,EAAYQ,aAFVN,EAAAK,OAAA,SAGfP,GAAeA,EAAYQ,YAAcR,EAAYQ,YAAc,MAHpD,wBAAAN,EAAAngB,SAAAggB,MAAH,yBAAAzhC,EAAA45B,MAAA7mB,KAAAsQ,YAAA,GAcfmkB,EAAaH,EAAW,KAC1BjmC,EAAAlD,EAAAmD,cAAComC,GAAA,cAAD,CAAeC,cA7BW,SAAC1rC,EAAO6F,GAEpC0lC,EAAQ,CACNJ,UAAWnrC,EACXorC,SAAUvlC,EAEVwlC,SAAWrrC,GAA0B,IAAjBA,EAAMyM,OAEZ,aAAVzM,GAEEqrC,EAHF,QAsBiDM,aAAW,GAChEvmC,EAAAlD,EAAAmD,cAACumC,GAAD,CAAQhD,kBANQ,WAClB2C,EAAQ,CAAEJ,YAAWC,WAAUC,UAAU,OAMvCjmC,EAAAlD,EAAAmD,cAACwmC,GAAD,MACAzmC,EAAAlD,EAAAmD,cAACymC,GAAD,MAEA1mC,EAAAlD,EAAAmD,cAAC0mC,GAAD,MACA3mC,EAAAlD,EAAAmD,cAAC2mC,GAAD,MAEA5mC,EAAAlD,EAAAmD,cAAComC,GAAA,cAAD,MACArmC,EAAAlD,EAAAmD,cAAC4mC,GAAD,MACA7mC,EAAAlD,EAAAmD,cAAC6mC,GAAD,OAIAC,GAAQ,EACZ,IACEA,EAAQf,EAASgB,kBAAkBC,QAAQC,QAAQ,kBAAkBtyB,QAAQ,aAAe,EAE9F,MAAO/U,IAEP,MAAO,CACLkmC,YACAC,WACAe,QACAI,QAjCc,kBAAM93B,QAAK83B,UACxBjoB,KAAK,SAAAze,GAAI,OAAIwC,QAAQC,IAAIzC,KACzB0e,MAAM,SAAA9S,GAAG,OAAIpJ,QAAQC,IAAImJ,MAgC1B4zB,kBACAmH,YAAa,kBAAMjB,EAAQL,KAC3BG,WACAG,eAMElD,gMACa,IAAAxxB,EAAAC,KACPwxB,EAAYxxB,KAAK/W,MAAjBuoC,QACFkE,EAAQ3sC,OAAA2J,EAAA,EAAA3J,CAAA,GACTiX,KAAKvS,MADI,CAEZ+jC,UACAE,qBAAsB,kBAAM3xB,EAAK41B,YAAY,mBAC7ClE,aAAc,kBAAM1xB,EAAK41B,YAAY,WACrC/D,kBAAmB5xB,KAAK4xB,kBACxBE,aAAc9xB,KAAK41B,SAErB,OAAOvnC,EAAAlD,EAAAmD,cAACunC,GAAeH,UAXNI,WAefnD,gMACa,IAAAziB,EAAAlQ,KACP+1B,EAAS/1B,KAAKvS,MAAdsoC,KACR,GAAIA,GAAQA,EAAKC,SAASrD,GACxB,OAAO,KAEL3yB,KAAKi2B,4BACPj2B,KAAK4yB,aAAe5yB,KAAKvS,MAAMyoC,aAAatD,cAE9C5yB,KAAKm2B,aAEL,IAAMT,EAAQ3sC,OAAA2J,EAAA,EAAA3J,CAAA,GACTiX,KAAKvS,MADI,CAEZslC,sBACAC,gBAAiBhzB,KAAKo2B,qBACtBxE,kBAAmB5xB,KAAK4xB,kBACxBgB,aAAc5yB,KAAK4yB,aACnBC,kBAAmB7yB,KAAK4yB,aAAazhC,IAAI,SAAA4hB,GAAK,OAAIsjB,QAAKC,IAAIvjB,EAAMvjB,SACjEsjC,wBAAyB9yB,KAAK4yB,aAAazhC,IAAI,SAAA4hB,GAAK,OAAIsjB,QAAKC,IAAIvjB,EAAM3iB,eACvEqhC,aAAczxB,KAAKu2B,OACnBnE,WAAY,kBAAMliB,EAAKylB,YAAY,aAErC,OAAOtnC,EAAAlD,EAAAmD,cAACkoC,GAAed,UAtBNe,WA0BftE,gMACa,IAAAuE,EAAA12B,KACT01B,EAAQ3sC,OAAA2J,EAAA,EAAA3J,CAAA,GACTiX,KAAKvS,MADI,CAEZ2kC,WAAY,kBAAMsE,EAAKf,YAAY,WACnC/D,kBAAmB5xB,KAAK4xB,kBACxBS,cAAeryB,KAAK22B,UAEtB,OAAOtoC,EAAAlD,EAAAmD,cAACsoC,GAAsBlB,UARNmB,kBAYtBjD,gMACa,IAAAkD,EAAA92B,KACT01B,EAAQ3sC,OAAA2J,EAAA,EAAA3J,CAAA,GACTiX,KAAKvS,MADI,CAEZ2kC,WAAY,kBAAM0E,EAAKnB,YAAY,WACnC/D,kBAAmB5xB,KAAK4xB,kBACxBS,cAAeryB,KAAK22B,QACpB9C,aAAc7zB,KAAK+2B,SAErB,OAAO1oC,EAAAlD,EAAAmD,cAAC0oC,GAAsBtB,UATNuB,kBAatB3E,gMAEF,IACQE,EADKxyB,KAAKvS,MAAM4mC,SACY6C,eAA5B1E,mBACFC,EAAersB,MAAMC,QAAQmsB,GAC/BA,EAAmBrhC,IAAI,SAAAuhC,GAAS,OAAI2D,QAAKC,IAAyB5D,EA8D7DyE,MAAM,KAAKhmC,IAAI,SAAAimC,GAAI,OAAIA,EAAKC,OAAO,GAAGC,cAAgBF,EAAKhsC,OAAO,GAAGmsC,gBAAeC,KAAK,QA7D9F,GAEE9B,EAAQ3sC,OAAA2J,EAAA,EAAA3J,CAAA,GACTiX,KAAKvS,MADI,CAEZmkC,kBAAmB5xB,KAAK4xB,kBACxBY,qBACAC,eACAF,OAAQvyB,KAAKuyB,SAEf,OAAOlkC,EAAAlD,EAAAmD,cAACmpC,GAA2B/B,UAfNgC,uBAmB3BzN,gMAEF,OAAO57B,EAAAlD,EAAAmD,cAACqpC,GAAgB33B,KAAKvS,cAFXmqC,YA8BhB7D,gMACa,IAAA8D,EAAA73B,KACT01B,EAAQ3sC,OAAA2J,EAAA,EAAA3J,CAAA,GACTiX,KAAKvS,MADI,CAEZ2kC,WAAY,kBAAMyF,EAAKlC,YAAY,WACnC/D,kBAAmB5xB,KAAK4xB,kBACxBS,cAAeryB,KAAK22B,QACpB9C,aAAc7zB,KAAK83B,KACnB9D,aAAch0B,KAAK+3B,OACnB9D,eAAgBj0B,KAAK83B,OAEvB,OAAOzpC,EAAAlD,EAAAmD,cAAC0pC,GAAuBtC,UAXNuC,sDC9MvB3sC,GAAYC,aAAW,SAAAC,GAAK,MAAK,CACrCuE,KAAM,GAGNwS,QAAS,GAGT21B,eAAgB,CACdprC,QAAS,QAEX+8B,KAAM,CACJ/9B,OAAQ,GACRS,MAAO,IAEToE,MAAO,CACL9E,WAAYL,EAAM8D,QAAQmT,KAAKrK,QAC/BzM,MAAOH,EAAM8D,QAAQ8I,QAAQ2L,aAC7BwE,OAAM,aAAA3b,OAAepB,EAAM8D,QAAQ8I,QAAQ2L,cAC3CmI,UAAS,WAAAtf,OAAapB,EAAM8D,QAAQ8I,QAAQqL,MAC5C00B,UAAW,4BACXloC,QAASzE,EAAM0E,QAAQ,EAAG,GAC1B3D,MAAO,QAET6rC,0BAA2B,CACzBC,KAAM,CACJnsB,UAAS,aAAAtf,OAAepB,EAAM8D,QAAQ8I,QAAQqL,OAEhD60B,MAAO,CACLpsB,UAAS,aAAAtf,OAAepB,EAAM8D,QAAQ8I,QAAQqL,OAEhD80B,OAAQ,CACNrsB,UAAS,2BAGbssB,YAAa,CACXxgC,SAAU,EACV5D,YAAa5I,EAAM0E,QAAQ,IAE7BuoC,QAAS,CACP3rC,QAAS,QAEXi+B,OAAQ,CACN/yB,SAAU,MAyCC0gC,GArCO,SAAAzrC,GAAkC,IAA/ByH,EAA+BzH,EAA/ByH,KAAME,EAAyB3H,EAAzB2H,QAAS+jC,EAAgB1rC,EAAhB0rC,UAChC5qC,EAAUzC,KAEhB,OACE+C,EAAAlD,EAAAmD,cAACyuB,GAAA,EAAD,CACE6b,aAAc,CACZ5sB,SAAU,SACV6sB,WAAY,UAEdnkC,KAAMA,EAENE,QAASA,GAETvG,EAAAlD,EAAAmD,cAAC8E,GAAA,EAAD,CAAOnE,UAAWlB,EAAQ4C,MAAOmoC,UAAW,IAC1CzqC,EAAAlD,EAAAmD,cAAA,OAAKmB,GAAG,kBAAkBR,UAAWlB,EAAQmqC,gBAC3C7pC,EAAAlD,EAAAmD,cAAC07B,GAAD,CAAS/6B,UAAWlB,EAAQ87B,OAC5Bx7B,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQyqC,aACtBnqC,EAAAlD,EAAAmD,cAAC4E,GAAA,EAAD,CAAYyC,QAAQ,QAAQhK,MAAM,WAAlC,oBACA0C,EAAAlD,EAAAmD,cAAC4E,GAAA,EAAD,CAAYyC,QAAQ,QAAQhK,MAAM,UAAUotC,WAAS,GAArD,6FACA1qC,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQ0qC,SACtBpqC,EAAAlD,EAAAmD,cAAC2kB,GAAA,EAAD,CAAQtnB,MAAM,YAAYgK,QAAQ,YAAY3G,QAAS4F,GAAvD,aACAvG,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQg9B,SACxB18B,EAAAlD,EAAAmD,cAAC2kB,GAAA,EAAD,CAAQtnB,MAAM,UAAUgK,QAAQ,YAAY3G,QAAS2pC,GAArD,iBCLCK,GA7DU,SAACC,EAAaC,GAAmB,IAAAhxC,EACpBC,mBAAS,MADWW,EAAAC,OAAAsN,GAAA,EAAAtN,CAAAb,EAAA,GACjDixC,EADiDrwC,EAAA,GACjCswC,EADiCtwC,EAAA,GAGlDuwC,EAAqB,SAAAnrC,GAEzBA,EAAEC,iBAEFirC,EAAUlrC,IAINorC,EAAgBxzB,kBAAQ,WAC5B,OAAKmzB,GAAgBE,EACd9qC,EAAAlD,EAAAmD,cAACirC,GAAD,CAAe7kC,MAAI,EAACE,QAASskC,EAAgBP,UAAWa,IADnB,MAE3C,CAACP,EAAaE,IAiBjB,SAASK,IAEPL,EAAeM,SAEfN,EAAeO,WACZnsB,KAAK,SAACosB,GACwB,aAAzBA,EAAaC,SACftoC,QAAQC,IAAI,iCACZ2nC,MAGA5nC,QAAQC,IAAI,kCACZ2nC,KAEFE,EAAU,QAUhB,OAvCA1vC,oBAAU,WAUR,OANImB,gBAtB0B,eAAgBH,OAAOf,WAAee,OAAOf,UAAUkwC,YAuBnFvoC,QAAQC,IAAI,gDAId7G,OAAOC,iBAAiB,sBAAuB0uC,GACxC,WACL3uC,OAAOE,oBAAoB,sBAAuByuC,KAEnD,IA0BI,CACLC,gBACAE,gBAAiBF,EAAgBE,EAAkB,gBC/DjDM,GAAW,WAAM,IAAAC,EACuDrvC,OAApEgiB,EADaqtB,EACbrtB,YAAajV,EADAsiC,EACAtiC,WAAYE,EADZoiC,EACYpiC,YADZqiC,EAAAD,EACyBE,OAAU1tC,EADnCytC,EACmCztC,MAAOT,EAD1CkuC,EAC0CluC,OACzDouC,EAA6C,IAAnC,CAAC,GAAI,KAAKj3B,QAAQyJ,GAAqB,WAAa,YAC9DytB,EAAStvC,eAcf,MAToB,CAClBK,QALeA,eAMfL,MAAOsvC,EACPztB,YAAawtB,EACbE,WAPiB,CAAE7tC,MAAOkL,EAAY3L,OAAQ6L,GAQ9C0iC,WAPiB,CAAE9tC,QAAOT,YAqDfwuC,GAvCO,SAACC,GAAgB,IAAAryC,EACXC,mBAAS2xC,MADEhxC,EAAAC,OAAAsN,GAAA,EAAAtN,CAAAb,EAAA,GAC9Be,EAD8BH,EAAA,GACvBI,EADuBJ,EAAA,GAqB/BuW,EAAwBC,sBAAYC,aAlBrB,SAACrR,GAChBA,IACFA,EAAEC,iBACFD,EAAEE,mBAEJ,IAAMosC,EAAWV,KAEjB5wC,EAASsxC,IAWsD,KAAM,IAevE,OAZAh7B,0BAAgB,WAKd,OAJAH,IACA3U,OAAOC,iBAAiB,SAAU0U,GAG3B,WACL3U,OAAOE,oBAAoB,SAAUyU,KAIzC,IAEOpW,yCCtDIwxC,GAEQ,oBAFRA,GAGgB,4BAHhBA,GAIM,kBAJNA,GAMM,kBANNA,GAOO,mBAPPA,GAQQ,oBARRA,GAUK,iBAVLA,GAWQ,oBAXRA,GAYe,2BAZfA,GAcF,UAQIC,GACC,SAACC,EAAWC,GAAZ,MAAwB,CAAE75B,KAAM05B,GAA2B3rC,KAAM,CAAE6rC,YAAWC,YAD/EF,GAEE,iBAAO,CAAE35B,KAAM05B,KAFjBC,GAGI,SAACG,EAAUC,GAAX,MAA6B,CAAE/5B,KAAM05B,GAAmC3rC,KAAM,CAAE+rC,WAAUC,kBAH9FJ,GAKJ,SAACK,EAAUC,GAAX,MAAwB,CAAEj6B,KAAM05B,GAAiB3rC,KAAM,CAAEisC,WAAUC,aAL/DN,GAOE,iBAAO,CAAE35B,KAAM05B,KAPjBC,GAQG,SAACO,GAAD,MAAmB,CAAEl6B,KAAM05B,GAA0B3rC,KAAMmsC,IAR9DP,GASI,iBAAO,CAAE35B,KAAM05B,KATnBC,GAWA,SAACQ,GAAD,MAAgB,CAAEn6B,KAAM05B,GAAwB3rC,KAAMosC,IAXtDR,GAaS,iBAAO,CAAE35B,KAAM05B,KAbxBC,GAcS,SAACS,GAAD,MAAkB,CAAEp6B,KAAM05B,GAAkC3rC,KAAMqsC,ICxCpFC,GAAU,CACd,CACEld,KAAMziB,KAAK6B,aAAaC,KAExB4H,SAAU,CAGR3c,SAAU,kBACVC,WAAY,mBACZkuB,KAAM,MCRN0kB,GAAW,CACfpd,QAAS,GACT30B,QAAS,CACP0U,OAAQvC,KAAKgB,cAAcC,OCJzB4+B,GAAY,CAChB3N,MAAO,GACP4N,aAAc,eCDVC,GAAe,CACnBC,WAAY5wC,eACZ6wC,SAAS,EACTC,cAAc,GCADC,8BAAgB,CAAEzqC,IJUlB,WAA6B,IAA5BlI,EAA4BqnB,UAAA5a,OAAA,QAAAoZ,IAAAwB,UAAA,GAAAA,UAAA,GAApB8qB,GAAS3pB,EAAWnB,UAAA5a,OAAA,EAAA4a,UAAA,QAAAxB,EAClC/N,EAAe0Q,EAAf1Q,KAAMjS,EAAS2iB,EAAT3iB,KAEd,OAAQiS,GACN,KAAK05B,GAEH,OAD0BxxC,EAAMyM,OAAS,EAAI,CAAC,CAACzM,EAAMyM,OAAS,IAAM,GAGtE,KAAK+kC,GACH,OAAOxxC,EAAMg2B,MAAM,GAAI,GAEzB,KAAKwb,GACH,SAAA7tC,OAAA7D,OAAAiO,GAAA,EAAAjO,CAAWE,GAAX,CAAkB6F,IACpB,QACE,OAAO7F,IIxByBwS,KHStC,WAA6C,IAA7BxS,EAA6BqnB,UAAA5a,OAAA,QAAAoZ,IAAAwB,UAAA,GAAAA,UAAA,GAArB+qB,GAAU5pB,EAAWnB,UAAA5a,OAAA,EAAA4a,UAAA,QAAAxB,EACnC/N,EAAe0Q,EAAf1Q,KAAMjS,EAAS2iB,EAAT3iB,KACNmvB,EAAqBh1B,EAArBg1B,QAAS30B,EAAYL,EAAZK,QAEjB,OAAQyX,GACN,KAAK05B,GACH,IAAMoB,EAAe9yC,OAAAiO,GAAA,EAAAjO,CAAOk1B,GACtB6d,EAAkBD,EAAgBnmC,OAAS,EAAImmC,EAAgBnb,MAAQ2a,GAAS/xC,QACtF,OAAOP,OAAA2J,EAAA,EAAA3J,CAAA,GACFE,EADL,CAEEK,QAASwyC,EACT7d,QAAS4d,IAGb,KAAKpB,GAAL,IACUsB,EAA+BzyC,EAA/ByyC,aAAcjB,EAAiBxxC,EAAjBwxC,aACtB,OAAO/xC,OAAA2J,EAAA,EAAA3J,CAAA,GACFE,EADL,CAEEg1B,UACA30B,QAAQP,OAAA2J,EAAA,EAAA3J,CAAA,GACHO,EADE,CAELyyC,aAAcA,GAAgB,KAC9BjB,aAAciB,GAAgBjB,EAAeA,EAAe,SAIlE,KAAKL,GAAL,IACUE,EAAsB7rC,EAAtB6rC,UACFqB,EADwBltC,EAAX8rC,QACS,GACtBqB,EAAU,GAAArvC,OAAA7D,OAAAiO,GAAA,EAAAjO,CAAOk1B,GAAP,CAAgB30B,IAChC,OAAOP,OAAA2J,EAAA,EAAA3J,CAAA,GACFE,EADL,CAEEg1B,QAASge,EACT3yC,QAAQP,OAAA2J,EAAA,EAAA3J,CAAA,GACHO,EADE,CAEL0U,OAAQ28B,GACLqB,KAIT,QACE,OAAO/yC,IGlD+B6kC,SFC7B,WAA+B,IAA9B7kC,EAA8BqnB,UAAA5a,OAAA,QAAAoZ,IAAAwB,UAAA,GAAAA,UAAA,GAAtBgrB,GAAW7pB,EAAWnB,UAAA5a,OAAA,EAAA4a,UAAA,QAAAxB,EACpC/N,EAAe0Q,EAAf1Q,KAAMjS,EAAS2iB,EAAT3iB,KACN6+B,EAAwB1kC,EAAxB0kC,MAAO4N,EAAiBtyC,EAAjBsyC,aAEf,OAAQx6B,GACN,KAAK05B,GACH,OAAKc,EAOIxyC,OAAA2J,EAAA,EAAA3J,CAAA,GACFE,EADL,CAEE0kC,MAAK,GAAA/gC,OAAA7D,OAAAiO,GAAA,EAAAjO,CAAM4kC,GAAN,CAAa7+B,MARb/F,OAAA2J,EAAA,EAAA3J,CAAA,GACFE,EADL,CAEEsyC,aAAczsC,IASpB,KAAK2rC,GACH,GAAqB,IAAjB9M,EAAMj4B,OACR,OAAO3M,OAAA2J,EAAA,EAAA3J,CAAA,GACFE,EADL,CAEEsyC,aAAc,OAIhB,IAAMW,EAAQnzC,OAAAiO,GAAA,EAAAjO,CAAO4kC,GACfwO,EAAYD,EAASxb,MAC3B,OAAO33B,OAAA2J,EAAA,EAAA3J,CAAA,GACFE,EADL,CAEE0kC,MAAOuO,EACPX,aAAcY,IAGpB,KAAK1B,GACH,OAAO1xC,OAAA2J,EAAA,EAAA3J,CAAA,GACFE,EADL,CAEEsyC,aAAaxyC,OAAA2J,EAAA,EAAA3J,CAAA,GAAMwyC,EAAiBzsC,KAExC,QACE,OAAO7F,IEzCyCmzC,MDEvC,WAAkC,IAAjCnzC,EAAiCqnB,UAAA5a,OAAA,QAAAoZ,IAAAwB,UAAA,GAAAA,UAAA,GAAzBkrB,GAAc/pB,EAAWnB,UAAA5a,OAAA,EAAA4a,UAAA,QAAAxB,EACvC/N,EAAe0Q,EAAf1Q,KAAMjS,EAAS2iB,EAAT3iB,KAEd,OAAQiS,GACN,KAAK05B,GAAL,IACUM,EAAsBjsC,EAAtBisC,SAAUC,EAAYlsC,EAAZksC,QAClB,OAAOjyC,OAAA2J,EAAA,EAAA3J,CAAA,GAAKE,EAAZF,OAAAszC,GAAA,EAAAtzC,CAAA,GAAoBgyC,EAAWC,IAEjC,QACE,OAAO/xC,0BERPqzC,GAAgB,CACpBxmC,IAAK,OACLymC,mBAGIC,GAAmBC,aAAeH,GAAeI,IA4CxCC,GAAA,WACb,IAdyBC,EAcnBjP,EAbQkP,uBACZL,GACAI,EACAE,mBACEC,2BACEC,QASN,MAAO,CACLrP,QACAsP,UAAWC,aAAavP,KCtCbwP,GAZW,SAAAC,GAAa,OAAI,SAAC3vC,GAAU,IAAA4vC,EACvBV,KAArBhP,EAD4C0P,EAC5C1P,MAAOsP,EADqCI,EACrCJ,UAEf,OACE5uC,EAAAlD,EAAAmD,cAACgvC,GAAA,EAAD,CAAU3P,MAAOA,GACft/B,EAAAlD,EAAAmD,cAACivC,GAAA,EAAD,CAAa/L,QAASnjC,EAAAlD,EAAAmD,cAACqpC,GAAD,MAAasF,UAAWA,GAC5C5uC,EAAAlD,EAAAmD,cAAC8uC,EAAkB3vC,qCCSrBnC,GAAYC,aAlBJ,SAAAC,GAAK,MAAK,CACtBuE,KAAM,CACJlE,WAAY,QACZF,MAAOH,EAAM8D,QAAQ8I,QAAQ2L,aAC7B9T,QAA4B,EAAnBzE,EAAM0E,QAAQ,IAEzB8a,QAAS,GAGTwyB,QAAS,CACP1wC,QAAS,QAEXi+B,OAAQ,CACN/yB,SAAU,GAEZylC,aAAc,MA6BVC,GAxBwB,SAAAzwC,GAAmC,IAAhCgC,EAAgChC,EAAhCgC,UAAWwT,EAAqBxV,EAArBwV,KAAMk7B,EAAe1wC,EAAf0wC,SAC1C5vC,EAAUzC,KAChB,IAAKmX,EAAM,OAAO,KAClB,IAAMuI,EAAO,cAAApe,OAAiB6V,GAC9B,OACEpU,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWC,KAAWnB,EAAQgC,KAAMd,IACvCZ,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQ0vC,cACtBpvC,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQyvC,SACtBnvC,EAAAlD,EAAAmD,cAAC4E,GAAA,EAAD,CAAYvH,MAAM,WAAWqf,GAC7B3c,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQg9B,SACxB18B,EAAAlD,EAAAmD,cAAC4E,GAAA,EAAD,CAAYvH,MAAM,WAAWgyC,EAA7B,MAEFtvC,EAAAlD,EAAAmD,cAACsvC,GAAA,EAAD,CAAgBjyC,MAAM,YAAYgK,QAAQ,cAActE,MAAOssC,OAaxDD,MAEFG,GAA6B,SAAA5qC,GAAwB,IAArBwP,EAAqBxP,EAArBwP,KAAMk7B,EAAe1qC,EAAf0qC,SAE3C5vC,EAAU+vC,KAChB,OACEzvC,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQgC,MACtB1B,EAAAlD,EAAAmD,cAAC60B,GAAA,EAAD,MADF,IAEE90B,EAAAlD,EAAAmD,cAAC8E,GAAA,EAAD,CAAOnE,UAAWlB,EAAQ4C,OACxBtC,EAAAlD,EAAAmD,cAAC4E,GAAA,EAAD,CAAYyC,QAAQ,MAApB,+BAIFtH,EAAAlD,EAAAmD,cAACovC,GAAD,CAAej7B,KAAMA,EAAMk7B,SAAUA,MAoBrCG,GAAmBvyC,aAXJ,SAAAC,GAAK,MAAK,CAC7BuE,KAAM,CACJjE,OAAQ,OACRgB,QAAS,OACTV,cAAe,UAEjBuE,MAAO,CACLqH,SAAU,MAMd6lC,GAA2BE,YAAcL,GAAcK,YAChD,6FC9DQ,SAAArP,EAAyB6M,EAAcyC,EAAsBC,GAA7D,IAAAC,EAAAlc,EAAA5hB,EAAA,OAAAouB,GAAArjC,EAAAyjC,KAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,cACbz9B,QAAQC,IAAI,+BAAgCgqC,GAGxC2C,EAAW,IAAIC,KAEnBp1C,OAAO8X,KAAK06B,EAAa6C,QAAQC,QAAQC,QAAQ,SAAAC,GAC/CjtC,QAAQC,IAAI,SAAUgtC,EAAUhD,EAAa6C,QAAQC,OAAOE,IAC5DL,EAASM,OAAOD,EAAUhD,EAAa6C,QAAQC,OAAOE,MAElDvc,EAAOyc,GAAclD,EAAa3hC,OAAQ,SAChDskC,EAASM,OAAO,OAAQxc,GAElB5hB,EAAS,CACbwvB,QAAS,CACP8O,eAAgB,uBAElBC,iBAAkB,SAAAC,GAAiB,IACzBC,EAAkBD,EAAlBC,OAAQC,EAAUF,EAAVE,MAEhBxtC,QAAQC,IAAI,gBAAiBstC,EAAQC,EAAO3jC,KAAK4jC,MAAM,IAAMF,EAASC,IACtEd,EAAqB,CAAEL,SAAUxiC,KAAK4jC,MAAM,IAAMF,EAASC,OAI/DxtC,QAAQC,IAAI,WAAY2sC,GAzBXrP,EAAAE,KAAA,EA2BPiQ,KAAMC,KACV1D,EAAa6C,QAAQllC,IACrBglC,EACA99B,GACAoN,MAAM,SAAA9S,GACNpJ,QAAQqJ,MAAMD,GACdpJ,QAAQC,IAAImJ,EAAIswB,SAjCL,OAmCb15B,QAAQC,IAAI,+BACZ0sC,IApCa,yBAAApP,EAAAngB,SAAAggB,6BAuCf,SAAS+P,GAAeS,EAASC,GAI/B,IAHA,IAAIC,EAAMF,EAAQ/H,MAAM,KAAUkI,EAAOD,EAAI,GAAGE,MAAM,WAAW,GAE7DC,EAAOC,KAAKJ,EAAI,IAASr9B,EAAIw9B,EAAK7pC,OAAY+pC,EAAQ,IAAIC,WAAW39B,GAClEA,KACL09B,EAAM19B,GAAKw9B,EAAKI,WAAW59B,GAE7B,OAAO,IAAI69B,KAAK,CAACH,GAAQN,EAAU,CAAEp+B,KAAMs+B,IApE7CL,KAAMa,aAAaC,QAAQC,IACzB,SAAAD,GAEE,OADAxuC,QAAQC,IAAI,6BAA8BuuC,GACnCA,GAET,SAAAplC,GAEE,OADApJ,QAAQC,IAAI,mCAAoCmJ,GACzCiU,QAAQE,OAAOnU,KAI1BskC,KAAMa,aAAaG,SAASD,IAC1B,SAAAC,GAEE,OADA1uC,QAAQC,IAAI,qBAAsByuC,GAC3BA,GAET,SAAAtlC,GAEE,OADApJ,QAAQC,IAAI,oCAAqCmJ,GAC1CiU,QAAQE,OAAOnU,KCjB1B,IA0CekzB,gBAdS,SAAC3kC,EAAOwE,GAE9B,MAAO,CAAE8tC,aADgBtyC,EAAM6kC,SAAvByN,eAIiB,SAAA0E,GAAQ,MAAK,CACtChC,qBAAsB,WACpBgC,EAASvF,OAEXsD,qBAAsB,SAAC7C,GACrB8E,EAASvF,GAA6BS,OAI3BvN,CA1CQ,SAAA3gC,GAKjB,IAJJsuC,EAIItuC,EAJJsuC,aACA0C,EAGIhxC,EAHJgxC,qBACAD,EAEI/wC,EAFJ+wC,qBACGvwC,EACC1E,OAAA2E,EAAA,EAAA3E,CAAAkE,EAAA,gEACEizC,EAAe92C,mBASrB,OARAM,oBAAU,WACRw2C,EAAa52C,QAAU42C,EAAa52C,WAAaiyC,EAE7CA,IAAiB2E,EAAa52C,SDWvB,SAAf2mC,EAAAC,EAAAiQ,GAAAC,GAAAvZ,MAAA7mB,KAAAsQ,WCVM+vB,CAAS9E,EAAcyC,EAAsBC,IAE9C,CAACnmC,QAAQyjC,KAEPA,EACEltC,EAAAlD,EAAAmD,cAACgyC,GAADv3C,OAAAqG,OAAA,CAAeqT,KAAM,kBAAmBk7B,SAAUpC,EAAaoC,UAAY,GAAOlwC,IAD/D,OCXb8yC,GAAA,CAEbC,MAAO,CACLzmB,OAAQ,CACN0mB,aAAc,CAAC,KACfC,WAAY,CAAC,KACbC,aAAc,CAAC,KACfC,aAAc,CAAC,MAEjB3qC,MAAO,CACL4qC,aAAc,CAAC,KACfH,WAAY,CAAC,KACbC,aAAc,CAAC,KACfC,aAAc,CAAC,OAInBE,QAAS,CACP7qC,MAAO,CACLyqC,WAAY,CAAC,KACbC,aAAc,CAAC,KACfC,aAAc,CAAC,MAEjBG,cAAe,CACbL,WAAY,CAAC,MAEfM,YAAa,CACXN,WAAY,CAAC,OAKjBO,KAAM,CACJlnB,OAAQ,CACN0mB,aAAc,CAAC,KACfS,WAAY,CAAC,KACbC,aAAc,CAAC,KACfC,aAAc,CAAC,MAEjBL,cAAe,CACbL,WAAY,CAAC,MAEfM,YAAa,CACXN,WAAY,CAAC,KACbC,aAAc,CAAC,WAEjB1qC,MAAO,CACLyqC,WAAY,CAAC,KACbD,aAAc,CAAC,KACfU,aAAc,CAAC,KACfC,aAAc,CAAC,iOCnDf91C,GAAYC,aAAW,SAAAC,GAAK,MAAK,CACrCuE,KAAM,GAENoa,MAAO,CACLjS,UAAW,UAEbmpC,QAAS,CACPpxC,QAASzE,EAAM0E,QAAQ,IAEzBoxC,OAAQ,CACN/0C,MAAO,OACPT,OAAQ,QAuCGy1C,GAnCG,SAAAt0C,GAAuB,IAApB2H,EAAoB3H,EAApB2H,QAASF,EAAWzH,EAAXyH,KACtB3G,EAAUzC,KACRyuB,EAAW5jB,qBAAWC,MAAtB2jB,OAF+B7xB,EAGPC,mBAAS,MAHFW,EAAAC,OAAAsN,GAAA,EAAAtN,CAAAb,EAAA,GAGhCs5C,EAHgC14C,EAAA,GAGtB24C,EAHsB34C,EAAA,GAIjC44C,EAAM,CAAE3gC,KAAM,SAAUtR,GAAIsqB,EAAOtqB,IACnCkyC,EAAYC,UAAU1tB,KAAKqL,UAAUmiB,IACrCxoC,EAAG,GAAAtM,OAAMwP,eAAN,aAAAxP,OAAwC+0C,GASjD,OAPAniC,0BAAgB,WACdqiC,KAAOrU,SAASt0B,EAAK,SAACwB,EAAKonC,GACrBpnC,EAAKpJ,QAAQqJ,MAAMD,GAClB+mC,EAAYK,MAElB,CAAC/nB,IAGF1rB,EAAAlD,EAAAmD,cAAC4G,GAAA,EAAD,CACER,KAAMA,EACNE,QAASA,EACT3F,UAAWlB,EAAQgC,MAEnB1B,EAAAlD,EAAAmD,cAAC8E,GAAA,EAAD,CAAOnE,UAAWlB,EAAQszC,SACxBhzC,EAAAlD,EAAAmD,cAAC4E,GAAA,EAAD,CAAYyC,QAAQ,YAAY7B,UAAU,MAAM7E,UAAWlB,EAAQoc,OAAQ4P,EAAO5V,MAClF9V,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQuzC,OAAQS,wBAAyB,CAAEC,OAAQR,KAClEznB,EAAOtwB,QAAU4E,EAAAlD,EAAAmD,cAAC4E,GAAA,EAAD,CAAYY,UAAU,MAAM7E,UAAWlB,EAAQoc,OAA/C,KAAyD4P,EAAOtwB,OAAO,GAAvE,KAA6EswB,EAAOtwB,OAAO,GAA3F,SC9CXkgC,QACbt7B,EAAAlD,EAAAmD,cAACD,EAAAlD,EAAMupB,SAAP,KACErmB,EAAAlD,EAAAmD,cAAA,QAAMgN,EAAE,6DACRjN,EAAAlD,EAAAmD,cAAA,QAAMT,EAAE,IAAIe,EAAE,IAAIrC,MAAM,IAAIT,OAAO,MACnCuC,EAAAlD,EAAAmD,cAAA,QAAMT,EAAE,KAAKe,EAAE,IAAIrC,MAAM,IAAIT,OAAO,MACpCuC,EAAAlD,EAAAmD,cAAA,QAAMT,EAAE,IAAIe,EAAE,KAAKrC,MAAM,IAAIT,OAAO,MACpCuC,EAAAlD,EAAAmD,cAAA,QAAMT,EAAE,KAAKe,EAAE,KAAKrC,MAAM,IAAIT,OAAO,MACrCuC,EAAAlD,EAAAmD,cAAA,QAAMT,EAAE,KAAKe,EAAE,KAAKrC,MAAM,IAAIT,OAAO,MACrCuC,EAAAlD,EAAAmD,cAAA,QAAMT,EAAE,KAAKe,EAAE,KAAKrC,MAAM,IAAIT,OAAO,MACrCuC,EAAAlD,EAAAmD,cAAA,QAAMT,EAAE,KAAKe,EAAE,IAAIrC,MAAM,IAAIT,OAAO,MACpCuC,EAAAlD,EAAAmD,cAAA,QAAMT,EAAE,KAAKe,EAAE,IAAIrC,MAAM,IAAIT,OAAO,MACpCuC,EAAAlD,EAAAmD,cAAA,QAAMT,EAAE,IAAIe,EAAE,KAAKrC,MAAM,IAAIT,OAAO,MACpCuC,EAAAlD,EAAAmD,cAAA,QAAMT,EAAE,IAAIe,EAAE,KAAKrC,MAAM,IAAIT,OAAO,MACpCuC,EAAAlD,EAAAmD,cAAA,QAAMT,EAAE,IAAIe,EAAE,KAAKrC,MAAM,IAAIT,OAAO,MACpCuC,EAAAlD,EAAAmD,cAAA,QAAMT,EAAE,KAAKe,EAAE,IAAIrC,MAAM,IAAIT,OAAO,MACpCuC,EAAAlD,EAAAmD,cAAA,QAAMT,EAAE,KAAKe,EAAE,IAAIrC,MAAM,IAAIT,OAAO,MACpCuC,EAAAlD,EAAAmD,cAAA,QAAMT,EAAE,KAAKe,EAAE,KAAKrC,MAAM,IAAIT,OAAO,MACrCuC,EAAAlD,EAAAmD,cAAA,QAAMT,EAAE,KAAKe,EAAE,KAAKrC,MAAM,IAAIT,OAAO,MACrCuC,EAAAlD,EAAAmD,cAAA,QAAMT,EAAE,KAAKe,EAAE,KAAKrC,MAAM,IAAIT,OAAO,MACrCuC,EAAAlD,EAAAmD,cAAA,QAAMT,EAAE,KAAKe,EAAE,KAAKrC,MAAM,IAAIT,OAAO,MACrCuC,EAAAlD,EAAAmD,cAAA,QAAMT,EAAE,KAAKe,EAAE,KAAKrC,MAAM,IAAIT,OAAO,MACrCuC,EAAAlD,EAAAmD,cAAA,QAAMT,EAAE,KAAKe,EAAE,KAAKrC,MAAM,IAAIT,OAAO,OACpB,+DCbfR,GAAYC,aAAW,SAAAC,GAC3B,IAAMy2C,EAAWnZ,eAAKt9B,EAAM8D,QAAQ+I,UAAU6pC,MAAO,IACrD,MAAO,CACLnyC,KAAM,GAENuY,aAAc,CACZzc,WAAYL,EAAM8D,QAAQ+I,UAAUoL,KACpC9X,MAAOH,EAAM8D,QAAQ+I,UAAU0L,aAC/BzB,YAAa,CACXC,QAAS,OACTzV,QAAS,QACTf,SAAU,WACVQ,MAAO,OACPT,OAAQ,OACRklC,aAAc,UACd9kB,UAAS,WAAAtf,OAAaq1C,GACtB9J,UAAW,eACXgK,wBAAyB,EACzBC,wBAAyB,WAG7BC,sBAAuB,CACrBhK,KAAM,CACJnsB,UAAS,aAAAtf,OAAeq1C,IAE1BK,MAAO,CACLp2B,UAAS,aAAAtf,OAAeq1C,IAE1B1J,OAAQ,CACNrsB,UAAS,2BAGbq2B,YAAa,GAEb35B,cAAe,CACb9b,QAAS,WAkHA01C,GA7GA,SAAAv1C,GAA4D,IAAzDgC,EAAyDhC,EAAzDgC,UAAW6D,EAA8C7F,EAA9C6F,SAAU2vC,EAAoCx1C,EAApCw1C,cAAeC,EAAqBz1C,EAArBy1C,eAAqBx6C,EACjDC,oBAAS,GADwCW,EAAAC,OAAAsN,GAAA,EAAAtN,CAAAb,EAAA,GAClEwM,EADkE5L,EAAA,GAC5D+f,EAD4D/f,EAAA,GAAAmB,EAEjD9B,oBAAS,GAFwCmC,EAAAvB,OAAAsN,GAAA,EAAAtN,CAAAkB,EAAA,GAElE04C,EAFkEr4C,EAAA,GAE5Ds4C,EAF4Dt4C,EAAA,GAGnEyD,EAAUzC,KAEVu3C,EAAUz5C,iBAAOu5C,GACvBE,EAAQv5C,QAAUq5C,EAElB,IAiBMG,EAAS,SAAC50C,GAGHA,EAAE60C,cAnBbH,GAAQ,GACHluC,GACHkG,WAAW,WACLioC,EAAQv5C,SAASuf,GAAQ,IAC5B,MAkBDm6B,EAAQ,SAAC90C,GACTA,GAAKA,EAAEE,kBACTF,EAAEE,kBACFF,EAAEC,mBAIN,OACEE,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWC,KAAWnB,EAAQk1C,cAAeh0C,IAChDZ,EAAAlD,EAAAmD,cAAC40C,GAAA,EAAD,CACEl6B,UAAU,wBACVm6B,OAAQ,SAACj1C,GACP0M,WAAW,kBAAMiO,GAAQ,IAAQ,MAEnC9a,QAAS,CACPw0C,YAAax0C,EAAQw0C,YACrB35B,cAAe7a,EAAQ6a,cACvB7Y,KAAMhC,EAAQgC,KACdmZ,IAAKha,KAAWnB,EAAQua,aAAc,iBAExCnQ,KAAMrF,EACN9D,QAAS,SAACd,GACR80C,EAAM90C,GACN00C,GAAQ,GACHluC,IACHpD,QAAQC,IAAI,oBACZkxC,MAGJpwB,YAAaywB,EAEbM,aAAcN,EAGdpuC,KAAMA,EACN8P,UAAU,MAEVnW,EAAAlD,EAAAmD,cAAC+0C,GAAA,EAAD,CAEElrC,KAAM9J,EAAAlD,EAAAmD,cAACg1C,GAAAn4C,EAAD,CAAe8D,UAAWlB,EAAQ2a,gBACxCU,iBAAiB,QACjBI,aAAa,cACbC,aAAW,EACXza,QAAS,SAACd,GACRoD,QAAQC,IAAI,eACZsX,GAAQ,GACR+5B,GAAQ,GACRH,IACAO,EAAM90C,MAGVG,EAAAlD,EAAAmD,cAAC+0C,GAAA,EAAD,CAEElrC,KAAM9J,EAAAlD,EAAAmD,cAACu0B,GAAA13B,EAAD,CAAkB8D,UAAWlB,EAAQ2a,gBAC3CU,iBAAiB,QACjBI,aAAa,qBACbC,aAAW,EACXza,QAAS,SAACd,GACRoD,QAAQC,IAAI,gBACZsX,GAAQ,GACR+5B,GAAQ,GACRF,IACAM,EAAM90C,2DCzFHq1C,GA9CK,SAAAt2C,GAAsC,IAAnCu2C,EAAmCv2C,EAAnCu2C,SAAU5uC,EAAyB3H,EAAzB2H,QAAS6uC,EAAgBx2C,EAAhBw2C,UACxC,OACEp1C,EAAAlD,EAAAmD,cAACsD,GAAA,EAAD,CACE4xC,SAAUA,EACV9uC,OAAQ8uC,EACR5uC,QAASA,GAER6uC,EAAUtyC,IAAI,SAAA8B,EAAyD4C,GAAQ,IAA9DsC,EAA8DlF,EAA9DkF,KAAMxM,EAAwDsH,EAAxDtH,MAAO8W,EAAiDxP,EAAjDwP,KAAMszB,EAA2C9iC,EAA3C8iC,KAAMvnC,EAAqCyE,EAArCzE,SAAUijB,EAA2Bxe,EAA3Bwe,OAAQiyB,EAAmBzwC,EAAnBywC,QACrD57B,EAAO3P,GAAQ,KACrB,OAAI49B,EAAa,KACb2N,EAAgBr1C,EAAAlD,EAAAmD,cAACkmB,GAAA,EAAD,CAAS1e,IAAG,eAAAlJ,OAAiBiJ,KAE/CxH,EAAAlD,EAAAmD,cAACqF,GAAA,EAAD,CACEmC,IAAG,eAAAlJ,OAAiBiJ,GACpBrH,SAAUA,EACVQ,QAAS,WACP4F,IACA6c,MAED3J,GACCzZ,EAAAlD,EAAAmD,cAACq1C,GAAA,EAAD,KACEt1C,EAAAlD,EAAAmD,cAACwZ,EAAD,CAAMnc,MAAO6C,EAAW,WAAa7C,KAGzC0C,EAAAlD,EAAAmD,cAACwmB,GAAA,EAAD,CAAc1c,QAASqK,EAAMmhC,uBAAwB,CAAEj4C,+FCd7D4nB,GACM,WAENjoB,GAAYC,aCvBH,SAAAC,GAAK,MAAK,CACvBuE,KAAM,CACJpD,OAAQnB,EAAM0E,QAAQ,GACtB2qB,gBAAiBrvB,EAAM8D,QAAQzD,WAAW8E,MAC1C2D,cAAe,IAGjBye,MAAO,CACLtK,aAAcjd,EAAM0E,QAAQ,IAE9B0kB,KAAM,CACJ3kB,QAASzE,EAAM0E,QAAQ,IAEzB3H,QAAS,CACPsI,UAAWrF,EAAM0E,QAAQ,IAE3B2zC,YAAa,CACXhzC,UAAWrF,EAAM0E,QAAQ,GACzBuY,aAAcjd,EAAM0E,QAAQ,IAE9B4zC,KAAM,CACJn3C,OAAQnB,EAAM0E,QAAQ,QDyIX6zC,GArII,SAAA92C,GAA8B,IAA3B0H,EAA2B1H,EAA3B0H,aAAcolB,EAAa9sB,EAAb8sB,OAC5BhsB,EAAUzC,KACV04C,EAAmB,IAAIC,KAAkBtvC,GAFAzM,EAGPC,mBAAS,MAHFW,EAAAC,OAAAsN,GAAA,EAAAtN,CAAAb,EAAA,GAGxC0rB,EAHwC9qB,EAAA,GAG1BgrB,EAH0BhrB,EAAA,GAIzCo7C,EAAUnqB,EAAOiB,OAAOha,OAAO,SAACC,EAADhO,GAanC,OAbsDA,EAAX6B,KACtCwpC,QAAQ,SAAAnxC,GACX,GAAK8T,EAAI9T,EAAIgT,QAKR,GAAIc,EAAI9T,EAAIgT,QAAQhT,EAAIqC,OAAQ,CACnC,IAAM20C,EAAWljC,EAAI9T,EAAIgT,QAAQhT,EAAIqC,OACrCyR,EAAI9T,EAAIgT,QAAQhT,EAAIqC,OAApBzG,OAAA2J,EAAA,EAAA3J,CAAA,GAAkCo7C,EAAlC,CAA4CC,MAAOD,EAASC,MAAQ,SAEjEnjC,EAAI9T,EAAIgT,QAAQhT,EAAIqC,OAApBzG,OAAA2J,EAAA,EAAA3J,CAAA,GAAkCoE,EAAlC,CAAuCi3C,MAAO,SARjDnjC,EAAI9T,EAAIgT,QAARpX,OAAAszC,GAAA,EAAAtzC,CAAA,GACGoE,EAAIqC,MADPzG,OAAA2J,EAAA,EAAA3J,CAAA,GACoBoE,EADpB,CACyBi3C,MAAO,OAS7BnjC,GACN,IAECgT,EAAW,GACf,IACEA,EAAW8F,EAAOjZ,KAAO/X,OAAO8X,KAAKqT,KAAKC,MAAM4F,EAAOjZ,OAAS,GAElE,MAAO5S,GACLoD,QAAQqJ,MAAMzM,GAGhB,OACEG,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQgC,MACtB1B,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQglB,OACtB1kB,EAAAlD,EAAAmD,cAAC4qB,GAAA,EAAD,CAAWjqB,UAAWlB,EAAQ2U,WAA9B,eAGArU,EAAAlD,EAAAmD,cAAC4E,GAAA,EAAD,CAAYyC,QAAQ,QAAQhK,MAAM,WAC/BouB,EAAO5V,OAGX4V,EAAOxF,MACNlmB,EAAAlD,EAAAmD,cAACkU,GAAA,EAAD,CACEhT,MAAM,cACNiT,KAAMsX,EAAOxF,KACbvlB,QAAS,kBAAM8kB,EAAgBP,OAInCllB,EAAAlD,EAAAmD,cAAC4E,GAAA,EAAD,CAAYjE,UAAWlB,EAAQxF,QAASoN,QAAQ,aAAhD,kBACAtH,EAAAlD,EAAAmD,cAACkmB,GAAA,EAAD,MACAnmB,EAAAlD,EAAAmD,cAACqmB,GAAA,EAAD,CAAM1lB,UAAWlB,EAAQ6mB,MACvBvmB,EAAAlD,EAAAmD,cAACumB,GAAA,EAAD,CAAUqd,gBAAc,GACtB7jC,EAAAlD,EAAAmD,cAACwmB,GAAA,EAAD,CACE1c,QAAO,WAAAxL,OAAamtB,EAAOiB,OAAOtlB,QAClC2C,UAAW0hB,EAAOiB,OAAOtlB,OAAS,GAChCrH,EAAAlD,EAAAmD,cAAA,sBACO6kB,aAAW4G,EAAOiB,OAAOjB,EAAOiB,OAAOtlB,OAAS,GAAG2e,QAAS,OACjEhmB,EAAAlD,EAAAmD,cAAA,WAFF,WAGQ6kB,aAAW4G,EAAOiB,OAAO,GAAG3G,QAAS,WAMnDhmB,EAAAlD,EAAAmD,cAACumB,GAAA,EAAD,CAAUqd,gBAAc,GACtB7jC,EAAAlD,EAAAmD,cAACwmB,GAAA,EAAD,KACEzmB,EAAAlD,EAAAmD,cAAC4qB,GAAA,EAAD,CAAWjqB,UAAWlB,EAAQ2U,WAA9B,mCAGArU,EAAAlD,EAAAmD,cAACkmB,GAAA,EAAD,MACiC,IAAhCzrB,OAAO8X,KAAKqjC,GAASxuC,QACpBrH,EAAAlD,EAAAmD,cAAC4E,GAAA,EAAD,CAAYyC,QAAQ,WAApB,sCAED5M,OAAO8X,KAAKqjC,GAAS/yC,IAAI,SAACkzC,EAAQC,GAAT,OACxBj2C,EAAAlD,EAAAmD,cAAA,OAAKwH,IAAG,aAAAlJ,OAAe03C,GAAQr1C,UAAWlB,EAAQ81C,aAChDx1C,EAAAlD,EAAAmD,cAAC4E,GAAA,EAAD,CAAYjE,UAAWlB,EAAQw2C,WAAY5uC,QAAQ,YAAYquC,EAAiB9jC,WAAWmkC,GAAQ70C,OACnGnB,EAAAlD,EAAAmD,cAACkmB,GAAA,EAAD,MACCzrB,OAAOmI,OAAOgzC,EAAQG,IAAS3uC,OAAS,EAErC3M,OAAOmI,OAAOgzC,EAAQG,IAASlzC,IAAI,SAAChE,EAAK0I,GAAN,OACjCxH,EAAAlD,EAAAmD,cAACkT,GAAA,EAAD,CACE1L,IAAG,WAAAlJ,OAAa03C,EAAb,KAAA13C,OAAqBiJ,GACxB1I,IAAKA,EACLxB,MAAOq4C,EAAiB9jC,WAAWmkC,GAAQ14C,UAK/C0C,EAAAlD,EAAAmD,cAAC4E,GAAA,EAAD,CAAYyC,QAAQ,WAApB,4CAUbse,EAASve,OAAS,GAAK3M,OAAO8X,KAAKlM,EAAamM,MAAMpL,OAAS,GAC9DrH,EAAAlD,EAAAmD,cAACD,EAAAlD,EAAMupB,SAAP,KACErmB,EAAAlD,EAAAmD,cAAC4qB,GAAA,EAAD,CAAWjqB,UAAWlB,EAAQ2U,WAA9B,YAGArU,EAAAlD,EAAAmD,cAACkmB,GAAA,EAAD,MACAnmB,EAAAlD,EAAAmD,cAACqmB,GAAA,EAAD,CAAM1lB,UAAWlB,EAAQ6mB,MACtBX,EAAS9iB,IAAI,SAAC2E,EAAKD,GAAN,OAAclB,EAAamM,KAAKhL,GAC5CzH,EAAAlD,EAAAmD,cAACumB,GAAA,EAAD,CAAU/e,IAAG,WAAAlJ,OAAaiJ,IACxBxH,EAAAlD,EAAAmD,cAACwmB,GAAA,EAAD,CACE1c,QAASzD,EAAamM,KAAKhL,GAAKtG,MAChC6I,UAAW1D,EAAamM,KAAKhL,GAAKif,OAAOgF,EAAOjZ,KAAKhL,OAGvD,SAKT8d,IAAiBL,IAChBllB,EAAAlD,EAAAmD,cAACgc,GAAA,EAAD,CACE5V,MAAI,EACJ4W,WAAS,EACT1W,QAAS,kBAAMkf,EAAgB,OAC/B3J,MAAM,cACND,KAAM6P,EAAOxF,+IE/HjBjpB,GAAYC,aCnBH,SAAAC,GAAK,MAAK,CACvBuE,KAAM,CACJhE,SAAU,YAEZyM,MAAO,CACLzM,SAAU,YAEZy4C,aAAc,CACZ7qB,UAAW,IACX7tB,OAAQ,KAEV24C,YAAa,CACXx0C,QAASzE,EAAM0E,QAAQ,GACvBrE,WAAYL,EAAM8D,QAAQ8I,QAAQkM,KAClC3Y,MAAOH,EAAM8D,QAAQ8I,QAAQ2L,aAC7B7L,UAAW,UAEbwsC,cAAe,GAKfC,WAAY,CACVh5C,MAAO,QACPiF,OAAQ,GACR7E,SAAU,WACV0M,UAAW,mBACXzM,KAAM,EACNC,IAAK,OAEP24C,cAAe,CACbj5C,MAAO,QACPiF,OAAQ,GACR7E,SAAU,WACV0M,UAAW,mBACXpM,MAAO,EACPJ,IAAK,OAEP44C,UAAW,CACTl5C,MAAO,6BAETm5C,gBAAiB,CACfn5C,MAAO,6BAETo5C,KAAM,CACJp4C,OAAQ,aDxBNq4C,GAAY,SAAA/3C,GAA6C,IAA1C+tB,EAA0C/tB,EAA1C+tB,OAAQ8f,EAAkC7tC,EAAlC6tC,aAAcmK,EAAoBh4C,EAApBg4C,cACnCl3C,EAAUzC,KACVE,EAAQwC,eACRk3C,EAAiBpK,GAAe9f,EAAOxa,UAAU,SAAAsjB,GAAC,OAAIA,EAAEr0B,KAAOqrC,KAAqB,EAH7B5yC,EAIvBC,mBAAS+8C,GAAkB,EAAIA,EAAiB,GAJzBp8C,EAAAC,OAAAsN,GAAA,EAAAtN,CAAAb,EAAA,GAItDi9C,EAJsDr8C,EAAA,GAIzCs8C,EAJyCt8C,EAAA,GAAAmB,EAK7B9B,oBAAS,GALoBmC,EAAAvB,OAAAsN,GAAA,EAAAtN,CAAAkB,EAAA,GAKtD6O,EALsDxO,EAAA,GAK5C+6C,EAL4C/6C,EAAA,GAMvDg7C,EAAWtqB,EAAOtlB,OAAS,EAE3BsmB,EAAYjzB,OAAAiO,GAAA,EAAAjO,CAAOiyB,GACzBgB,EAAaC,KAAK,SAAC9wB,EAAG+wB,GAAJ,OAAU9kB,SAAS8kB,EAAE7H,QAAS,IAAMjd,SAASjM,EAAEkpB,QAAS,MAK1E,OACEhmB,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQgC,MACtB1B,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQyK,OACtBnK,EAAAlD,EAAAmD,cAACi3C,GAAAp6C,EAAD,CACEq6C,KAA0B,QAApBh6C,EAAMgZ,UAAsB,YAAc,IAChDihC,MAAON,EACPO,cAAe,SAAC9zB,GAAD,OAASwzB,EAAexzB,IACvC+zB,mBAAiB,GAEhB3pB,EAAa7qB,IAAI,SAAC8E,EAAOJ,GAAR,OAChBxH,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQy2C,aAAc1uC,IAAG,gBAAAlJ,OAAkBiJ,GAAO7G,QAAS,kBAAMi2C,EAAcjpB,EAAampB,GAAa11C,MACvHpB,EAAAlD,EAAAmD,cAACuK,GAAA,EAAD,CAAO5C,MAAOA,EAAOhH,UAAWlB,EAAQkI,MAAO6C,SAAUA,QAI/DzK,EAAAlD,EAAAmD,cAACkH,GAAA,EAAD,CAAY2E,KAAK,QAAQlL,UAAWlB,EAAQ42C,WAAY31C,QAjB3C,kBAAMo2C,EAAeD,GAAe,EAAInpB,EAAatmB,OAAS,EAAIyvC,EAAc,IAiBhBx5C,MAAM,UAAU6C,SAA0B,IAAhB22C,GAChF,QAApB35C,EAAMgZ,UAAsBnW,EAAAlD,EAAAmD,cAACs3C,GAAAz6C,EAAD,MAAyBkD,EAAAlD,EAAAmD,cAACu3C,GAAA16C,EAAD,OAExDkD,EAAAlD,EAAAmD,cAACkH,GAAA,EAAD,CAAY2E,KAAK,QAAQlL,UAAWlB,EAAQ62C,cAAe51C,QArB3C,kBAAMo2C,EAAeD,GAAenpB,EAAatmB,OAAS,EAAIyvC,EAAc,IAqBTx5C,MAAM,UAAU6C,SAAU22C,IAAgBnqB,EAAOtlB,OAAS,GACtH,QAApBlK,EAAMgZ,UAAsBnW,EAAAlD,EAAAmD,cAACu3C,GAAA16C,EAAD,MAAwBkD,EAAAlD,EAAAmD,cAACs3C,GAAAz6C,EAAD,OAEvDkD,EAAAlD,EAAAmD,cAACwuB,GAAA,EAAD,CACE3S,MAAOm7B,EAAW,QAAH,UAAA14C,OAAuBu4C,EAAc,EAArC,KAAAv4C,OAA0CovB,EAAatmB,OAAvD,KACfowC,SAAU9pB,EAAatmB,OAAS,GAC9BrH,EAAAlD,EAAAmD,cAAA,YAAO6kB,aAAW6I,EAAampB,GAAa9wB,UAE9C0xB,WACE13C,EAAAlD,EAAAmD,cAACD,EAAAlD,EAAMupB,SAAP,KACErmB,EAAAlD,EAAAmD,cAACkH,GAAA,EAAD,CAAYvG,UAAWlB,EAAQ82C,UAAW71C,QAAS,kBAAMq2C,GAAavsC,KACpEzK,EAAAlD,EAAAmD,cAAC03C,GAAA,EAAD,CAAOr6C,MAAOmN,EAAW,UAAY,YAAamtC,aAAcjqB,EAAampB,GAAarwC,KAAOknB,EAAampB,GAAarwC,KAAKC,OAAO,SAAA5H,GAAG,OAAIA,EAAI1D,SAAQiM,OAAS,MACjKrH,EAAAlD,EAAAmD,cAAC43C,GAAA/6C,EAAD,aAOVm6C,GACFj3C,EAAAlD,EAAAmD,cAAC63C,GAAA,EAAD,CACEC,MAAOpqB,EAAatmB,OACpB3J,SAAS,SACTs6C,WAAYlB,EACZp3C,QAAS,CACPgC,KAAMhC,EAAQ22C,cACdK,KAAMh3C,EAAQg3C,UAoBxBC,GAAUriC,aAAe,CACvB5J,WAAY,IACZutC,cAAc,EACdC,OAAQ,IAGKvB,8BEzGAwB,GAAA,SAAAh7C,GAAK,MAAK,CACvBuE,KAAM,CACJjD,QAAS,OACThB,OAAQ,OACRM,cAAe,SACfsE,SAAU,UAEZ+1C,OAAQ,CACNzuC,SAAU,GAEZQ,MAAO,CACLzM,SAAU,WACViM,SAAU,EACV2a,UAAW,SACX+zB,6BAA8B,SAEhCC,QAAS,CACP91C,UAAWrF,EAAM0E,QAAQ,IAE3B02C,QAAS,CACP76C,SAAU,WACVD,OAAQ,OACRS,MAAO,OACPN,IAAK,EACLD,KAAM,GAER66C,aAAc,CACZ7uC,SAAU,EACV8uC,aAAc,WACdzkC,WAAY,SACZ3R,SAAU,UAEZ8xC,OAAQ,CACNz2C,SAAU,WACV2C,OAAQlD,EAAM0E,QAAQ,GACtB7D,MAAOb,EAAM0E,QAAQ,GAIrBU,OAAQ,KAEV6oB,KAAM,CACJzhB,SAAU,GAEZ+uC,SAAU,CACRx2C,SAAU,SAEVkI,UAAW,iBAEbuuC,SAAU,CACRl6C,QAAS,OACTmD,QAASzE,EAAM0E,QAAQ,IAEzB+2C,WAAY,GAIZC,iBAAkB,CAChBn7C,SAAU,WACViM,SAAU,EACVtH,SAAU,SACVwH,UAAW,SACXpL,QAAS,OACThB,OAAQ,OACRM,cAAe,UAEjB+6C,gBAAiB,CACfjvC,UAAW,SACXuQ,aAAcjd,EAAM0E,QAAQ,IAE9Bk3C,gBAAiB,CACfnvC,QAAS,IAEX7H,YAAa,GAGbutC,SAAU,CACRhyC,MAAOH,EAAM8D,QAAQkF,KAAK,QCrCxBlJ,GAAYC,aAAW8D,IAiLdg4C,GA/KI,SAAAp6C,GAMb,IALJq6C,EAKIr6C,EALJq6C,iBAAkBt2C,EAKd/D,EALc+D,SAClBu2C,EAIIt6C,EAJJs6C,aAAcC,EAIVv6C,EAJUu6C,eAAgBC,EAI1Bx6C,EAJ0Bw6C,YAC9BC,EAGIz6C,EAHJy6C,eAAgB9nB,EAGZ3yB,EAHY2yB,aAAczE,EAG1BluB,EAH0BkuB,YAAawsB,EAGvC16C,EAHuC06C,WAC3CC,EAEI36C,EAFJ26C,QAASC,EAEL56C,EAFK46C,UAAW/M,EAEhB7tC,EAFgB6tC,aACpBgN,EACI76C,EADJ66C,SAAUC,EACN96C,EADM86C,MAEJh6C,EAAUzC,KADZpD,EAE8BC,qBAF9BW,EAAAC,OAAAsN,GAAA,EAAAtN,CAAAb,EAAA,GAEG8/C,EAFHl/C,EAAA,GAEcm/C,EAFdn/C,EAAA,GAAAmB,EAGwB9B,oBAAS,GAHjCmC,EAAAvB,OAAAsN,GAAA,EAAAtN,CAAAkB,EAAA,GAGGi+C,EAHH59C,EAAA,GAGW69C,EAHX79C,EAAA,GAAA8O,EAIsCjR,oBAAS,GAJ/CkR,EAAAtQ,OAAAsN,GAAA,EAAAtN,CAAAqQ,EAAA,GAIGoiB,EAJHniB,EAAA,GAIkBoiB,EAJlBpiB,EAAA,GAAAqiB,EAMiCvlB,qBAAWC,MAAxC2jB,EANJ2B,EAMI3B,OAAQplB,EANZ+mB,EAMY/mB,aAAcgnB,EAN1BD,EAM0BC,GAOxBxW,EAAW,CAAEwR,KAAM,IACrBoD,GAAUA,EAAOtwB,QAAmC,IAAzBswB,EAAOtwB,OAAOiM,SAC3CyP,EAAS1c,UAAYsxB,EAAOtwB,OAAO,GACnC0b,EAAS3c,SAAWuxB,EAAOtwB,OAAO,IAGpC,IAAM2+C,EAAM,CACV1a,OAAQ/R,EAAGY,QAAQ,SAAUxC,EAAQ,SAAU,KAC/CsuB,OAAQ1sB,EAAGY,QAAQ,SAAUxC,EAAQ,SAAU,KAC/CuuB,WAAY3sB,EAAGY,QAAQ,SAAUxC,EAAQ,SAAU,CAAC,YAtBlDvgB,EAyBkCrR,mBAAS,GAzB3CsR,EAAA1Q,OAAAsN,GAAA,EAAAtN,CAAAyQ,EAAA,GAyBG+uC,EAzBH9uC,EAAA,GAyBgB+uC,EAzBhB/uC,EAAA,GA0BJ,OACEpL,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQgC,MACtB1B,EAAAlD,EAAAmD,cAAC60B,GAAA,EAAD,MACA90B,EAAAlD,EAAAmD,cAACm6C,GAAA,EAAD,CAAQ18C,SAAS,SAASkD,UAAWlB,EAAQ04C,QAC3Cp4C,EAAAlD,EAAAmD,cAAC2jC,GAAA,EAAD,CAASC,gBAAc,GACrB7jC,EAAAlD,EAAAmD,cAACkH,GAAA,EAAD,CAAYvG,UAAWlB,EAAQk5C,WAAYt7C,MAAM,UAAUqD,QAAS24C,EAAYnyB,aAAW,QACzFnnB,EAAAlD,EAAAmD,cAACo6C,GAAAv9C,EAAD,OAEFkD,EAAAlD,EAAAmD,cAAC4E,GAAA,EAAD,CAAYyC,QAAQ,YAAYhK,MAAM,UAAUsD,UAAWlB,EAAQ84C,cAChE9sB,EAAO5V,MAAQ,UAMlB9V,EAAAlD,EAAAmD,cAACkH,GAAA,EAAD,CACEmzC,gBAAc,OACdh9C,MAAM,UACNqD,QAAS,SAAAxF,GAAK,OAAIy+C,EAAaz+C,EAAMu5C,iBAErC10C,EAAAlD,EAAAmD,cAACs6C,GAAAz9C,EAAD,OAGFkD,EAAAlD,EAAAmD,cAACu6C,GAAD,CAAarF,SAAUwE,EAAWpzC,QAAS,kBAAMqzC,EAAa,OAAOxE,UAAW,CAC9E,CACEhhC,KAAM,eACNtK,KAAM2wC,KACN/S,MAAO6R,GAAWG,GAASD,EAC3Br2B,OAAQm2B,GAEV,CACEnlC,KAAM,iBACNtK,KAAM2wC,KACN/S,MAAO8R,GAAaE,IAAUD,EAC9Br2B,OAAQo2B,GAEV,CACEplC,KAAM,iBACNtK,KAAM4wC,GACNt3B,OAAQ,kBAAM02B,GAAU,KAE1B,CACE1lC,KAAM,kBACNtK,KAAM6wC,KACNjT,MAAOuR,EACP71B,OAAQ61B,GAEV,CAAE5D,SAAS,GACX,CACEjhC,KAAM,cACNtK,KAAM8wC,KACNlT,MAAOwR,IAAiBa,EAAI1a,OAC5Bjc,OAAQ81B,GAEV,CACE9kC,KAAM,gBACNtK,KAAM+wC,KACNnT,MAAOta,IAAqB2sB,EAAIC,OAChC18C,MAAO,QACP8lB,OAAQ,kBAAMgK,GAAiB,SAIrCptB,EAAAlD,EAAAmD,cAAC66C,GAAA,EAAD,CAAMxzC,QAAQ,YACZtE,MAAOk3C,EACPv3C,SAAU,SAAC9C,EAAGmD,GAAJ,OAAcm3C,EAAen3C,KAEvChD,EAAAlD,EAAAmD,cAAC86C,GAAA,EAAD,CAAK55C,MAAM,SACXnB,EAAAlD,EAAAmD,cAAC86C,GAAA,EAAD,CAAK55C,MAAM,QACXnB,EAAAlD,EAAAmD,cAAC86C,GAAA,EAAD,CAAK55C,MAAM,aAIfnB,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQyK,OACL,IAAhB+vC,GACCl6C,EAAAlD,EAAAmD,cAACD,EAAAlD,EAAMupB,SAAP,KACGqF,EAAOiB,QAAUjB,EAAOiB,OAAOtlB,OAAS,GACvCrH,EAAAlD,EAAAmD,cAAC+6C,GAAD,CACEruB,OAAQjB,EAAOiB,OACf8f,aAAcA,EACdmK,cAAe9pB,IAGnB9sB,EAAAlD,EAAAmD,cAACg7C,GAAD,CAAYvvB,OAAQA,EAAQplB,aAAcA,EAAc3D,SAAUA,KAGrE+oB,EAAOiB,QAA0B,IAAhButB,GAChBl6C,EAAAlD,EAAAmD,cAACysB,GAAA,EAAD,CACEC,OAAQjB,EAAOiB,OACfG,YAAaA,EACbzrB,SAAU83C,KAKC,IAAhBe,GACCl6C,EAAAlD,EAAAmD,cAACqY,GAAA,EAAD,CACEQ,QAAM,EACN1e,UAAWsxB,EAAOtxB,UAClBD,SAAUuxB,EAAOvxB,SACjB2c,SAAUA,EACVX,UAAWuV,EAAOvV,YAIL,IAAhB+jC,GAAqBH,EAAIE,YACxBj6C,EAAAlD,EAAAmD,cAACi7C,GAAD,CACEt6C,UAAWlB,EAAQy0C,OACnBC,cAAegF,EACf/E,eAAgB9iB,GAEhBvxB,EAAAlD,EAAAmD,cAACg1C,GAAAn4C,EAAD,OAGJkD,EAAAlD,EAAAmD,cAACk7C,GAAD,CAAW90C,KAAMwzC,EAAQtzC,QAAS,kBAAMuzC,GAAU,MAClD95C,EAAAlD,EAAAmD,cAACyc,GAAA,EAAD,CACErW,KAAM8mB,EACNvQ,UAvIkB,SAACkS,GACvB1B,GAAiB,IACI,IAAjB0B,GAAuBuqB,EAAe3tB,EAAOtqB,KAsI7C0a,MAAM,gBACNa,QAAQ,gIC9KV1f,GAAYC,aCnBH,SAAAC,GAAK,MAAK,CACvBuE,KAAM,GAGNyI,MAAO,CACL1L,QAAS,OACTV,cAAe,UAGjBie,SAAU,CACRxe,WAAYL,EAAM8D,QAAQ8I,QAAQqL,KAClC9X,MAAOH,EAAM8D,QAAQ8I,QAAQ2L,cAE/B0V,KAAM,CACJzhB,SAAU,GAEZ+a,MAAO,CACL/a,SAAU,EACVyQ,aAAcjd,EAAM0E,QAAQ,IAE9Bqc,OAAQ,CACNnY,YAAa5I,EAAM0E,QAAQ,GAC3BmE,aAAc7I,EAAM0E,QAAQ,IAE9BkhB,UAAW,CACT/E,WAAY7gB,EAAM0E,QAAQ,GAC1BqR,YAAa/V,EAAM0E,QAAQ,GAC3B3D,MAAO,QAETmW,UAAW,CACT5V,QAAS,QACT+D,UAAWrF,EAAM0E,QAAQ,GACzBuY,aAAcjd,EAAM0E,QAAQ,IAE9BipB,aAAc,CACZrsB,QAAS,QACT+D,UAAWrF,EAAM0E,QAAQ,GACzBuY,aAAcjd,EAAM0E,QAAQ,IAE9BwpB,aAAc,CACZ1hB,SAAU,GAEZwgB,WAAY,CACVxgB,SAAU,EACVlL,QAAS,OACTV,cAAe,SACfkI,cAAe9I,EAAM0E,QAAQ,IAE/B0I,YAAa,CACXjM,OAAQnB,EAAM0E,QAAQ,GACtB0pB,SAAU,KAEZC,MAAO,CACL/sB,QAAS,OACTyD,SAAU,WDeCk5C,GAhDI,SAAAx8C,GAAwB,IAArBoe,EAAqBpe,EAArBoe,KAAMwH,EAAe5lB,EAAf4lB,SACpB9kB,EAAUzC,KACRyuB,EAAW5jB,qBAAWC,MAAtB2jB,OAFiC7xB,EAGfC,mBAAS,IAHMW,EAAAC,OAAAsN,GAAA,EAAAtN,CAAAb,EAAA,GAGlCwrB,EAHkC5qB,EAAA,GAG3B4gD,EAH2B5gD,EAAA,GAKzC,OACEuF,EAAAlD,EAAAmD,cAAC4G,GAAA,EAAD,CACEC,OAAO,QACPlG,UAAWlB,EAAQgC,KACnBqF,YAAU,EACVV,MAAI,EACJpC,WAAS,EACTsC,QAASie,GAETxkB,EAAAlD,EAAAmD,cAAC60B,GAAA,EAAD,MACA90B,EAAAlD,EAAAmD,cAACiH,GAAA,EAAD,CAAaiV,mBAAiB,EAACvb,UAAWlB,EAAQsc,UAChDhc,EAAAlD,EAAAmD,cAAC4E,GAAA,EAAD,CAAYyC,QAAQ,YAAYhK,MAAM,UAAUsD,UAAWlB,EAAQ0rB,MAAnE,wBAIFprB,EAAAlD,EAAAmD,cAACwkB,GAAA,EAAD,CAAe7jB,UAAWlB,EAAQyK,OAChCnK,EAAAlD,EAAAmD,cAACwrB,GAAA,EAAD,CACEC,OAAQA,EACRrG,MAAOA,EACP1iB,SAAU04C,KAGdr7C,EAAAlD,EAAAmD,cAAC0kB,GAAA,EAAD,KACE3kB,EAAAlD,EAAAmD,cAAC2kB,GAAA,EAAD,CAAQhkB,UAAWlB,EAAQk5C,WAAYt7C,MAAM,UAAUqD,QAAS,kBAAM06C,EAAS,KAAKl0B,aAAW,QAA/F,SAGAnnB,EAAAlD,EAAAmD,cAAC2kB,GAAA,EAAD,CAAQhkB,UAAWlB,EAAQk5C,WAAYt7C,MAAM,UAAUqD,QAAS6jB,EAAU2C,aAAW,QAArF,UAGAnnB,EAAAlD,EAAAmD,cAAC2kB,GAAA,EAAD,CAAQhkB,UAAWlB,EAAQk5C,WAAYt7C,MAAM,UAAUqD,QAAS,kBAAMqc,EAAKtiB,OAAA2J,EAAA,EAAA3J,CAAA,CAAE0G,GAAIsqB,EAAOtqB,IAAOikB,KAAU8B,aAAW,QAApH,uEE3BFlqB,GAAYC,aC5BH,SAAAC,GAAK,MAAK,CACvBuE,KAAM,CAEJjE,OAAQ,OACRgB,QAAS,OACTV,cAAe,UAEjBu9C,UAAW,CACT79C,OAAQ,QAEV89C,eAAgB,CACd5xC,SAAU,GAEZgvC,SAAU,CACR/2C,QAASzE,EAAM0E,QAAQ,EAAG,GAC1BpE,OAAQ,kBAEV44C,cAAe,CACb1sC,SAAU,EACVnM,WAAYL,EAAM8D,QAAQkF,KAAK,KAC/B7I,MAAOH,EAAM8D,QAAQC,gBAAgB/D,EAAM8D,QAAQkF,KAAK,OAE1Dq1C,MAAO,CACL59C,IAAK,EACL2E,OAAQ,EACRqH,QAAS,EACTlM,SAAU,WACVe,QAAS,QACT4D,SAAU,SACVnE,MAAO,OACPT,OAAQ,OACR6tB,UAAW,KAEbmwB,UAAW,CACTj+C,WAAY,SAEdk+C,WAAY,CACVp+C,MAAO,SAETq+C,OAAQ,CACNp5C,OAAQ,EACRqH,QAAS,GAEXgyC,KAAM,CACJhyC,QAAS,EACTrH,OAAQ,GAEV8f,aAAc,GAGdw5B,WAAY,CACVv+C,MAAO,QACPiF,OAAQ,GACR7E,SAAU,WACVM,MAAOb,EAAM0E,QAAQ,GACrBxB,OAAQlD,EAAM0E,QAAQ,GACtB+H,QAAS,IAEXkyC,QAAS,CAEP5oC,YAAa/V,EAAM0E,QAAQ,GAC3BtE,SAAU,GACVE,OAAQN,EAAM0E,QAAQ,GACtBD,QAASzE,EAAM0E,QAAQ,KAEzBzE,UAAW,CACTM,SAAU,WACVH,SAAUJ,EAAM0E,QAAQ,GACxBpE,OAAQN,EAAM0E,QAAQ,IAExBy0C,WAAY,CACVh5C,MAAO,QACPiF,OAAQ,GACR7E,SAAU,WACV0M,UAAW,mBACXzM,KAAM,EACNC,IAAK,OAEP24C,cAAe,CACbj5C,MAAO,QACPiF,OAAQ,GACR7E,SAAU,WACV0M,UAAW,mBACXpM,MAAO,EACPJ,IAAK,UDtDHm+C,GAAY,SAAAn9C,GAAsC,IAAnC4lB,EAAmC5lB,EAAnC4lB,SAAUmI,EAAyB/tB,EAAzB+tB,OAAQjiB,EAAiB9L,EAAjB8L,WAC/BhL,EAAUzC,KACVE,EAAQwC,eAFwCq8C,EAG2BC,GAAWtvB,EAAOtlB,OAAQqD,GAAnGstC,EAH8CgE,EAG9ChE,WAAYkE,EAHkCF,EAGlCE,SAAUC,EAHwBH,EAGxBG,cAAepY,EAHSiY,EAGTjY,WAAYqY,EAHHJ,EAGGI,OAAQC,EAHXL,EAGWK,MAAOp7B,EAHlB+6B,EAGkB/6B,KAHlBpnB,EAIlBC,oBAAS,GAJSW,EAAAC,OAAAsN,GAAA,EAAAtN,CAAAb,EAAA,GAI/CyiD,EAJ+C7hD,EAAA,GAInC8hD,EAJmC9hD,EAAA,GAMhDkQ,EAAa5P,iBAAO,MAN4B8Q,EAOlBD,aAAiBjB,GAA7CmB,KAAQrO,EAPsCoO,EAOtCpO,OAAQS,EAP8B2N,EAO9B3N,MAExB,OACE8B,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQgC,MACtB1B,EAAAlD,EAAAmD,cAAC60B,GAAA,EAAD,MACA90B,EAAAlD,EAAAmD,cAAA,OAAKiF,IAAKyF,EAAY/J,UAAWlB,EAAQ67C,gBACtC5uB,EAAO7pB,IAAI,SAAC04C,EAAOh0C,GAAR,OACVxH,EAAAlD,EAAAmD,cAACmuB,GAAA,EAAD,CACE3mB,IAAG,SAAAlJ,OAAWiJ,GACd5G,UAAWC,KACTnB,EAAQ87C,MACRxD,IAAexwC,GAAO9H,EAAQi8C,OAC9BO,IAAa10C,GAAO9H,EAAQk8C,MAE9Bj7C,QAAS,kBAAM47C,GAAeD,IAC9Bt7C,MAAO,CACLvD,SACAS,QACAwM,WAAYvN,EAAMwqB,YAAYoJ,OAAO,CAAC,WAAY,CAAEyrB,SAAU,IAAQ9xC,MAGxE1K,EAAAlD,EAAAmD,cAACuK,GAAA,EAAD,CAAO5C,MAAO4zC,EAAO56C,UAAWlB,EAAQkI,MAAO6C,SAAU6xC,IACzDt8C,EAAAlD,EAAAmD,cAAC4E,GAAA,EAAD,CAAYjE,UAAWlB,EAAQm8C,YAA/B,SACOS,EAAa,MAAQ,OAC1Bt8C,EAAAlD,EAAAmD,cAAC03C,GAAA,EAAD,CAAOr6C,MAAM,YAAYs6C,aAAcjrB,EAAOqrB,GAAYvxC,KAAKC,OAAO,SAAA5H,GAAG,OAAIA,EAAI1D,SAAQiM,QACvFrH,EAAAlD,EAAAmD,cAAC43C,GAAA/6C,EAAD,CAAWQ,MAAM,cAIrB0C,EAAAlD,EAAAmD,cAACwuB,GAAA,EAAD,CACE7tB,UAAWlB,EAAQi5C,SACnB8D,cAAc,MACd3gC,MACE9b,EAAAlD,EAAAmD,cAAC4E,GAAA,EAAD,CAAYvH,MAAM,UAAUgK,QAAQ,WAClCtH,EAAAlD,EAAAmD,cAACkH,GAAA,EAAD,CAAYvG,UAAWlB,EAAQg8C,WAAY/6C,QAAS,SAACd,GAAD,OAAO2kB,MACzDxkB,EAAAlD,EAAAmD,cAACo6C,GAAAv9C,EAAD,OAEDgoB,aAAW02B,EAAMx1B,UAGtByxB,SAAUz3C,EAAAlD,EAAAmD,cAAA,UAAKm8C,EAAS,SAAW,QACnC1E,WAAY0E,EACVp8C,EAAAlD,EAAAmD,cAACkH,GAAA,EAAD,CAAYvG,UAAWlB,EAAQg8C,WAAY/6C,QAAS,SAACd,GACnDA,EAAEC,iBACFD,EAAEE,kBACFkhB,MAEAjhB,EAAAlD,EAAAmD,cAACy8C,GAAA5/C,EAAD,OAGFkD,EAAAlD,EAAAmD,cAACkH,GAAA,EAAD,CAAYvG,UAAWlB,EAAQg8C,WAAY/6C,QAAS,SAACd,GACnDA,EAAEC,iBACFD,EAAEE,kBACFs8C,MAEAr8C,EAAAlD,EAAAmD,cAAC08C,GAAA7/C,EAAD,YAMVkD,EAAAlD,EAAAmD,cAACkH,GAAA,EAAD,CAAY2E,KAAK,QAAQlL,UAAWlB,EAAQ42C,WAAY31C,QAASojC,EAAYzmC,MAAM,WAC5D,QAApBH,EAAMgZ,UAAsBnW,EAAAlD,EAAAmD,cAACs3C,GAAAz6C,EAAD,MAAyBkD,EAAAlD,EAAAmD,cAACu3C,GAAA16C,EAAD,OAExDkD,EAAAlD,EAAAmD,cAACkH,GAAA,EAAD,CAAY2E,KAAK,QAAQlL,UAAWlB,EAAQ62C,cAAe51C,QAASw7C,EAAe7+C,MAAM,WAClE,QAApBH,EAAMgZ,UAAsBnW,EAAAlD,EAAAmD,cAACu3C,GAAA16C,EAAD,MAAwBkD,EAAAlD,EAAAmD,cAACs3C,GAAAz6C,EAAD,QAIzDkD,EAAAlD,EAAAmD,cAAC63C,GAAA,EAAD,CACEC,MAAOprB,EAAOtlB,OACd3J,SAAS,SACTs6C,WAAYA,EACZt4C,QAAS,CACPgC,KAAMhC,EAAQ22C,cACdoF,UAAW/7C,EAAQ+7C,WAErBmB,WACE58C,EAAAlD,EAAAmD,cAAC2kB,GAAA,EAAD,CAAQtnB,MAAM,UAAUwO,KAAK,QAAQnL,QAASw7C,EAAeh8C,SAAU63C,IAAerrB,EAAOtlB,OAAS,GAAtG,OAEuB,QAApBlK,EAAMgZ,UAAsBnW,EAAAlD,EAAAmD,cAACu3C,GAAA16C,EAAD,MAAwBkD,EAAAlD,EAAAmD,cAACs3C,GAAAz6C,EAAD,OAGzD+/C,WACE78C,EAAAlD,EAAAmD,cAAC2kB,GAAA,EAAD,CAAQtnB,MAAM,UAAUwO,KAAK,QAAQnL,QAASojC,EAAY5jC,SAAyB,IAAf63C,GAC7C,QAApB76C,EAAMgZ,UAAsBnW,EAAAlD,EAAAmD,cAACs3C,GAAAz6C,EAAD,MAAyBkD,EAAAlD,EAAAmD,cAACu3C,GAAA16C,EAAD,MADxD,YAmBVi/C,GAAUznC,aAAe,CACvB5J,WAAY,IACZutC,cAAc,EACdC,OAAQ,IAGK6D,UAKTE,GAAa,SAACtkB,EAAKmlB,GAAa,IAAAlhD,EACA9B,mBAAS,GADTmC,EAAAvB,OAAAsN,GAAA,EAAAtN,CAAAkB,EAAA,GAC7Bo8C,EAD6B/7C,EAAA,GACjB8gD,EADiB9gD,EAAA,GAAA8O,EAERjR,oBAAS,GAFDkR,EAAAtQ,OAAAsN,GAAA,EAAAtN,CAAAqQ,EAAA,GAE7BqxC,EAF6BpxC,EAAA,GAErBgyC,EAFqBhyC,EAAA,GAAAG,EAGJrR,mBAAS,GAHLsR,EAAA1Q,OAAAsN,GAAA,EAAAtN,CAAAyQ,EAAA,GAG7B+wC,EAH6B9wC,EAAA,GAGnB6xC,EAHmB7xC,EAAA,GAI9B8xC,EAAWniD,mBA+BXoiD,EAAc,WAClBD,EAASjiD,QAAUoB,OAAO+gD,YAIxB,kBAAML,EAAc,SAAAM,GAElB,OADAJ,EAAYI,GACJA,EAAU,GAAK1lB,EAAO,EAAI0lB,EAAU,KAE5CP,IAGAQ,EAAe,WACfJ,EAASjiD,SAASoB,OAAOkhD,cAAcL,EAASjiD,UAUtD,OAPAI,oBAAU,WAER,OADA8hD,IACO,WACLG,MAED,IAEI,CAAEtF,aAAYkE,WAAUC,cApDT,WACpBc,EAAYjF,GACe+E,EAAvB/E,EAAa,GAAKrgB,EAAmB,EACtBqgB,EAAa,GAC3BoE,IACHkB,IACAH,MA8C0CpZ,WA3C3B,WACjBkZ,EAAYjF,GACY+E,EAApB/E,EAAa,EAAI,EAAiBrgB,EAAM,EACzBqgB,EAAa,GAC3BoE,IACHkB,IACAH,MAqCsDJ,gBAAeX,SAAQC,MAjCnE,WACZiB,IACAN,GAAU,IA+B4E/7B,KA7B3E,WACX+7B,GAAU,GACVM,IACAH,4DEvKElgD,GAAYC,aAJJ,SAAAC,GAAK,MAAK,KA4CTqgD,GAtCO,SAAA5+C,GAAyC,IAAtCkd,EAAsCld,EAAtCkd,MAAOa,EAA+B/d,EAA/B+d,QAASC,EAAsBhe,EAAtBge,UAAWvW,EAAWzH,EAAXyH,KAC5C3G,EAAUzC,KAChB,OACE+C,EAAAlD,EAAAmD,cAAC4G,GAAA,EAAD,CACEjG,UAAWlB,EAAQgC,KACnBmb,sBAAoB,EACpB5Y,WAAS,EACToC,KAAMA,EACNyW,sBAAoB,EACpBZ,SAAS,KACTjV,kBAAgB,6BAEhBjH,EAAAlD,EAAAmD,cAACiH,GAAA,EAAD,CAAa9F,GAAG,6BAA6B0a,GAC7C9b,EAAAlD,EAAAmD,cAACwkB,GAAA,EAAD,KACEzkB,EAAAlD,EAAAmD,cAAC4E,GAAA,EAAD,KACG8X,IAIL3c,EAAAlD,EAAAmD,cAAC0kB,GAAA,EAAD,KACE3kB,EAAAlD,EAAAmD,cAAC2kB,GAAA,EAAD,CAAQjkB,QAAS,kBAAMic,GAAU,IAAQtf,MAAM,WAA/C,MAGA0C,EAAAlD,EAAAmD,cAAC2kB,GAAA,EAAD,CAAQjkB,QAAS,kBAAMic,GAAU,IAAOtf,MAAM,aAA9C,oBCJFL,GAAYC,aAnBJ,SAAAC,GAAK,MAAK,CACtBuE,KAAM,CACJjE,OAAQ,MACRS,MAAO,OAET6mB,kBAAmB,CACjBtmB,QAAS,OACTmD,QAAS,GAEXoa,SAAU,CACRrS,SAAU,EACVsb,WAAY9nB,EAAM0E,QAAQ,GAC1BoE,cAAe9I,EAAM0E,QAAQ,GAC7BkE,YAAa5I,EAAM0E,QAAQ,IAE7B6iB,MAAO,CACLtK,aAAcjd,EAAM0E,QAAQ,OAK1BqjB,GAKI,SAsFKC,GAnFG,SAAAvmB,GAA8C,IAA3CwmB,EAA2CxmB,EAA3CwmB,QAASxd,EAAkChJ,EAAlCgJ,MAAO4c,EAA2B5lB,EAA3B4lB,SAAUxH,EAAiBpe,EAAjBoe,KAAM3W,EAAWzH,EAAXyH,KAC7C3G,EAAUzC,KAD8CpD,EAEtBC,mBAAS,MAFaW,EAAAC,OAAAsN,GAAA,EAAAtN,CAAAb,EAAA,GAEvD0rB,EAFuD9qB,EAAA,GAEzCgrB,EAFyChrB,EAAA,GAAAmB,EAGpC9B,mBAAS,IAH2BmC,EAAAvB,OAAAsN,GAAA,EAAAtN,CAAAkB,EAAA,GAGvDypB,EAHuDppB,EAAA,GAGhDo/C,EAHgDp/C,EAAA,GAKxDwhD,EAAQp4B,GAAS3qB,OAAO8X,KAAK6S,GAAOhe,OAAS,EAEnD,OACErH,EAAAlD,EAAAmD,cAAC4G,GAAA,EAAD,CACEE,YAAU,EACV9C,WAAS,EACTsC,QAAS,WACHk3C,EAAOh4B,EAAgBP,IACtBV,KAEPvd,kBAAgB,0BAChBZ,KAAMA,GAENrG,EAAAlD,EAAAmD,cAACiH,GAAA,EAAD,CAAaiV,mBAAiB,EAACvb,UAAWlB,EAAQqlB,mBAChD/kB,EAAAlD,EAAAmD,cAAC4E,GAAA,EAAD,CAAYyC,QAAQ,KAAK1G,UAAWlB,EAAQsc,UAA5C,oBAGAhc,EAAAlD,EAAAmD,cAACkH,GAAA,EAAD,CAAYxG,QAAS6jB,GACnBxkB,EAAAlD,EAAAmD,cAACmH,GAAAtK,EAAD,QAGJkD,EAAAlD,EAAAmD,cAACwkB,GAAA,EAAD,KACEzkB,EAAAlD,EAAAmD,cAAC80B,GAAA,EAAD,CACEntB,MAAOA,EACPyd,MAAOA,EACP1iB,SAAU,SAAA+6C,GAAQ,OAAIrC,EAAS3gD,OAAA2J,EAAA,EAAA3J,CAAA,GAAK2qB,EAAUq4B,KAC9Ct4B,QAASA,KAIbplB,EAAAlD,EAAAmD,cAAC0kB,GAAA,EAAD,MACIS,GACAplB,EAAAlD,EAAAmD,cAAC2kB,GAAA,EAAD,CAAQjkB,QAAS6jB,EAAUlnB,MAAM,WAAjC,MAID8nB,IAAYq4B,GACXz9C,EAAAlD,EAAAmD,cAAC2kB,GAAA,EAAD,CAAQjkB,QAAS6jB,EAAUlnB,MAAM,WAAjC,QAID8nB,GAAWq4B,GACVz9C,EAAAlD,EAAAmD,cAACD,EAAAlD,EAAMupB,SAAP,KACErmB,EAAAlD,EAAAmD,cAAC2kB,GAAA,EAAD,CAAQjkB,QAAS,kBAAM8kB,EAAgBP,KAAiB5nB,MAAM,WAA9D,UAGA0C,EAAAlD,EAAAmD,cAAC2kB,GAAA,EAAD,CAAQjkB,QAAS,kBAAM06C,EAAS,KAAK/9C,MAAM,WAA3C,SAGA0C,EAAAlD,EAAAmD,cAAC2kB,GAAA,EAAD,CAAQjkB,QAAS,kBAAMqc,EAAKqI,IAAQ/nB,MAAM,WAA1C,QAMLioB,GAAgBA,IAAiBL,IAChCllB,EAAAlD,EAAAmD,cAAC09C,GAAD,CACEt3C,MAAI,EACJyV,MAAM,wBACNa,QAAQ,kDACRC,UAAW,SAAA0rB,GACT7iB,EAAgB,MACZ6iB,GAAS9jB,mBCrFnBvnB,GAAYC,aC7BH,SAAAC,GAAK,MAAK,CACvBuE,KAAM,CACJjD,QAAS,OACThB,OAAQ,OACRM,cAAe,SACfsE,SAAU,UAEZ+1C,OAAQ,CACNzuC,SAAU,GAEZi0C,WAAY,CACVtgD,MAAOH,EAAM8D,QAAQ+I,UAAU0L,aAC/BlY,WAAYL,EAAM8D,QAAQ+I,UAAUoL,MAEtCgW,KAAM,CACJzhB,SAAU,GAEZwsC,aAAc,CACZ14C,OAAQ,QAEV0M,MAAO,CACLhI,KAAM,MACNzE,SAAU,YAEZ46C,QAAS,CACP91C,UAAWrF,EAAM0E,QAAQ,IAE3Bg8C,QAAS,CACPngD,SAAU,WACV6E,OAAQ,GACRlC,OAAQ,GACR1C,KAAM,MACNiM,QAAS,GACTQ,UAAW,oBAEbisC,cAAe,CACb74C,WAAY,QAEdk5C,KAAM,CACJp4C,OAAQ,UAEVkX,IAAK,CACH0E,OAAQ,uBAEVuhC,UAAW,CACTj+C,WAAYL,EAAM8D,QAAQ+I,UAAUoL,MAmBtC0oC,aAAc,CACZxgD,MAAOH,EAAM8D,QAAQ8I,QAAQqL,KAC7BxL,QAAS,MDnCPm0C,GACK,EADLA,GAEM,EAFNA,GAGM,EAHNA,GAIM,EAJNA,GAKS,EA6LAC,GA1LO,SAAAp/C,GAAkE,IAA/D+tB,EAA+D/tB,EAA/D+tB,OAAQsxB,EAAuDr/C,EAAvDq/C,YAAa3E,EAA0C16C,EAA1C06C,WAAY4E,EAA8Bt/C,EAA9Bs/C,cAAe7uB,EAAezwB,EAAfywB,SACjE3vB,EAAUzC,KACVE,EAAQwC,eAFwE0tB,EAGjDvlB,qBAAWC,MAAxC2jB,EAH8E2B,EAG9E3B,OAAQplB,EAHsE+mB,EAGtE/mB,aAAcgnB,EAHwDD,EAGxDC,GACxBK,EAAYjzB,OAAAiO,GAAA,EAAAjO,CAAOiyB,GACzBgB,EAAaC,KAAK,SAAC9wB,EAAG+wB,GAAJ,OAAU9kB,SAAS8kB,EAAE7H,QAAS,IAAMjd,SAASjM,EAAEkpB,QAAS,MALY,IAAAnsB,EAMhDC,mBAASmkD,EAActwB,EAAaxb,UAAU,SAAAsjB,GAAC,OAAIA,EAAEr0B,KAAO68C,IAAe,GAN3BxjD,EAAAC,OAAAsN,GAAA,EAAAtN,CAAAb,EAAA,GAM/Ei9C,EAN+Er8C,EAAA,GAMlEs8C,EANkEt8C,EAAA,GAShFmN,EAAQ+kB,EAAOmqB,GATiEl7C,EAU5D9B,mBAASu1B,EAAWznB,EAAQ,IAVgC3L,EAAAvB,OAAAsN,GAAA,EAAAtN,CAAAkB,EAAA,GAU/EypB,EAV+EppB,EAAA,GAUxEo/C,EAVwEp/C,EAAA,GAAA8O,EAW9DjR,mBAAS,CAC/BmB,QAASo0B,EAAW0uB,GAAqBA,GACzCnC,KAAM,OAb8E5wC,EAAAtQ,OAAAsN,GAAA,EAAAtN,CAAAqQ,EAAA,GAW/E8kB,EAX+E7kB,EAAA,GAWzEmzC,EAXyEnzC,EAAA,GAgBhFozC,EAAY,IAAI91C,KAAKhC,EAAc+e,EAAM5e,MAAQmB,EAAMnB,MAEvDupB,EAAa,SAACquB,GAClBF,EAAQ,CAAEljD,QAASojD,EAASzC,KAAM/rB,EAAK50B,WAGnCqjD,EAAe,WACnBtuB,EAAW+tB,IACXG,EAAct2C,EAADlN,OAAA2J,EAAA,EAAA3J,CAAA,CAAU0G,GAAIwG,EAAMxG,IAAOikB,KAqBpC00B,EAAM,CACV1a,OAAQ/R,EAAGY,QAAQ,SAAUxC,EAAQ,WAC7B4B,EAAGY,QAAQ,SAAUtmB,EAAO,UAGtC,OACE5H,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQgC,MACtB1B,EAAAlD,EAAAmD,cAAC60B,GAAA,EAAD,MADF,IAEE90B,EAAAlD,EAAAmD,cAACm6C,GAAA,EAAD,CAAQ18C,SAAS,SAASkD,UAAWC,KAAWnB,EAAQ04C,OAAQvoB,EAAK50B,UAAY8iD,GAAiBr+C,EAAQk+C,WAAa,OACrH59C,EAAAlD,EAAAmD,cAAC2jC,GAAA,EAAD,KACG/T,EAAK50B,UAAY8iD,IAChB/9C,EAAAlD,EAAAmD,cAACkH,GAAA,EAAD,CACEvG,UAAWlB,EAAQk5C,WACnBt7C,MAAM,UACN6pB,aAAW,OACXxmB,QAAS,kBAAM24C,MAEft5C,EAAAlD,EAAAmD,cAACo6C,GAAAv9C,EAAD,OAGJkD,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQ0rB,MACtBprB,EAAAlD,EAAAmD,cAAC4E,GAAA,EAAD,CAAYyC,QAAQ,YAAYhK,MAAM,WACnC+xB,EAAW,WAAH,eAAA9wB,OAA+Bu4C,EAAc,EAA7C,KAAAv4C,OAAkDouB,EAAOtlB,OAAzD,MAEXrH,EAAAlD,EAAAmD,cAAC4E,GAAA,EAAD,CAAYyC,QAAQ,YAAYhK,MAAM,WACnCwnB,aAAWld,EAAMoe,QAAS,SAI7B6J,EAAK50B,UAAY8iD,IACnB/9C,EAAAlD,EAAAmD,cAAC2kB,GAAA,EAAD,CAAQtnB,MAAM,UAAUqD,QA3CR,WACtBqvB,EAAW+tB,IACX1C,EAASzzC,KAyCH,UAKEioB,EAAK50B,UAAY8iD,IACnB/9C,EAAAlD,EAAAmD,cAAC2kB,GAAA,EAAD,CAAQtnB,MAAM,UAAUqD,QAAS29C,GAAjC,QAIEzuB,EAAK50B,UAAY8iD,IACnB/9C,EAAAlD,EAAAmD,cAAC2kB,GAAA,EAAD,CAAQtnB,MAAM,UAAUqD,QA3DN,WACxBu9C,EAAct2C,EAADlN,OAAA2J,EAAA,EAAA3J,CAAA,CAAU0G,GAAIwG,EAAMxG,IAAOikB,IACxCi0B,MAyDM,QAKES,EAAI1a,QAAUxP,EAAK50B,UAAY8iD,IACjC/9C,EAAAlD,EAAAmD,cAAC2kB,GAAA,EAAD,CAAQtnB,MAAM,UAAUqD,QAAS,kBAAMqvB,EAAW+tB,MAAlD,QAKGluB,EAAK50B,UAAY8iD,IAAmBluB,EAAK50B,UAAY8iD,IACxD/9C,EAAAlD,EAAAmD,cAACkH,GAAA,EAAD,CAAY7J,MAAM,UAChBsD,UAAWC,KAAWnB,EAAQ82C,UAAW3mB,EAAK50B,UAAY8iD,IAAmBr+C,EAAQo+C,cACrFn9C,QAAS,kBAAMqvB,EAAWH,EAAK50B,UAAY8iD,GAAkBA,GAAiBA,MAE9E/9C,EAAAlD,EAAAmD,cAAC03C,GAAA,EAAD,CAAO/2C,UAAWlB,EAAQpB,OAAQs5C,aAAcwG,EAAU1pC,YAAYrN,OAAQ/J,MAAM,WAClF0C,EAAAlD,EAAAmD,cAAC43C,GAAA/6C,EAAD,CAAWQ,MAAM,cAKlBuyB,EAAK50B,UAAY8iD,IAAmBluB,EAAK50B,UAAY8iD,IACxD/9C,EAAAlD,EAAAmD,cAACkH,GAAA,EAAD,CAAY7J,MAAM,UAChBsD,UAAWC,KAAWnB,EAAQ6+C,WAAY1uB,EAAK50B,UAAY8iD,IAAmBr+C,EAAQo+C,cACtFn9C,QAAS,kBAAMqvB,EAAWH,EAAK50B,UAAY8iD,GAAkBA,GAAiBA,MAE9E/9C,EAAAlD,EAAAmD,cAACu+C,GAAA1hD,EAAD,SAMNkD,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQyK,MAAOxJ,QAlFhB,SAACd,GACdgwB,EAAK50B,UAAY8iD,KACnBl+C,EAAEC,iBACFD,EAAEE,kBACFiwB,EAAW+tB,OA+ET/9C,EAAAlD,EAAAmD,cAACi3C,GAAAp6C,EAAD,CACEq6C,KAA0B,QAApBh6C,EAAMgZ,UAAsB,YAAc,IAChDihC,MAAON,EACP2H,eAAgB,CAAEhhD,OAAQ,QAC1BuD,MAAO,CAAEvD,OAAQ,QACjB0C,SAAU0vB,EAAK50B,UAAY8iD,GAC3B1G,cAAe,SAAC9zB,GAAD,OAASwzB,EAAexzB,IACvC+zB,mBAAiB,GAEhB3pB,EAAa7qB,IAAI,SAAC47C,EAAUl3C,GAAX,OAChBxH,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQy2C,aAAc1uC,IAAG,gBAAAlJ,OAAkBiJ,IACzDxH,EAAAlD,EAAAmD,cAACuK,GAAA,EAAD,CACEC,SAAUolB,EAAK50B,UAAY8iD,GAC3Bn2C,MAAKlN,OAAA2J,EAAA,EAAA3J,CAAA,GAAOgkD,EAAar5B,GACzBxmB,KAAMk7C,EAAI1a,SAAWxP,EAAK50B,UAAY8iD,IAAmBluB,EAAK50B,UAAY8iD,IAC1Ep7C,SAAU04C,EACViD,aAAcA,QAMrBzuB,EAAK50B,UAAY8iD,IAChB/9C,EAAAlD,EAAAmD,cAAC63C,GAAA,EAAD,CACEC,MAAOpqB,EAAatmB,OACpB3J,SAAS,SACTs6C,WAAYlB,EACZp3C,QAAS,CACPgC,KAAMhC,EAAQ22C,cACdK,KAAMh3C,EAAQg3C,KACdlhC,IAAK9V,EAAQ8V,IACbimC,UAAW/7C,EAAQ+7C,cAK3Bz7C,EAAAlD,EAAAmD,cAAC0+C,GAAD,CACEt4C,KAAMwpB,EAAK50B,UAAY8iD,GACvBn2C,MAAOA,EACPwd,QAAS20B,EAAI1a,OACbriB,KAAM,SAAC0gC,GACLQ,EAAct2C,EAADlN,OAAA2J,EAAA,EAAA3J,CAAA,CAAU0G,GAAIwG,EAAMxG,IAAOs8C,IACxC1tB,EAAWH,EAAK+rB,OAElBp3B,SAAU,kBAAMwL,EAAWH,EAAK+rB,UAE/B/rB,EAAK50B,UAAY8iD,IAAmBluB,EAAK50B,UAAY8iD,KACtD/9C,EAAAlD,EAAAmD,cAACa,GAAA,EAAD,CACEK,MAAM,yBACNR,QAAS,aACTC,UAAWlB,EAAQm+C,2CE7Ide,cAjEb,SAAAA,EAAaC,EAASrnB,EAAMsnB,GAAe,IAAAptC,EAAAC,KAAAjX,OAAAqhC,GAAA,EAAArhC,CAAAiX,KAAAitC,GAAAjtC,KAQ3CotC,SAAW,SAAC1L,GACV,IAAKA,IAAQA,EAAI2L,cAAgB3L,EAAI2L,YAAY59C,GAAI,MAAM,IAAI6R,MAAJ,yBAC3D,IACE,OAAOogC,EAAI2L,YAAY59C,KAAOsQ,EAAKmtC,QAAU,MAAQ,MAEvD,MAAOh/C,GACL,MAAO,QAdgC8R,KAkB3CstC,QAAU,SAAC5L,GACT,IAAKA,IAAQA,EAAI2L,cAAgB3L,EAAI2L,YAAY59C,GAAI,MAAM,IAAI6R,MAAJ,yBAC3D,IACE,OAAOogC,EAAI2L,YAAY59C,KAAOsQ,EAAKmtC,QAErC,MAAOh/C,GACL,OAAO,IAxBgC8R,KAgC3Cuc,QAAU,SAAC9K,EAAQiwB,EAAK3gC,EAAMwsC,GAC5B,GAAI,CAAC,SAAU,SAAStqC,QAAQlC,GAAQ,EAAG,MAAM,IAAIO,MAAJ,+BAAA1U,OAAyCmU,IAE1F,IACE,IAAMysC,EAASztC,EAAKqtC,SAAS1L,GAEvB+L,EAAO1tC,EAAK4b,GAAGysB,IAAIroC,EAAK8lB,MAAjB,GAAAj5B,OAA0B6kB,GAA1B7kB,OAAmC4gD,IAAUzsC,GACtD2sC,EAAY,KAOhB,MANa,WAAT3sC,IACiB,WAAf2gC,EAAInoB,OAAqBm0B,EAAY3tC,EAAK4b,GAAGysB,IAAIroC,EAAK8lB,MAAjB,GAAAj5B,OAA0B6kB,GAA1B7kB,OAAmC4gD,IAAU,iBAC9D,SAAf9L,EAAInoB,SAAmBm0B,EAAY3tC,EAAK4b,GAAGysB,IAAIroC,EAAK8lB,MAAjB,GAAAj5B,OAA0B6kB,GAA1B7kB,OAAmC4gD,IAAU,iBAIvFD,EACEG,IACOD,EAAKE,WAAWttC,KAAK,SAAAyjB,GAAC,MAAU,MAANA,GAAaypB,EAAMtqC,QAAQ6gB,IAAM,OACjE4pB,EAAUC,WAAWttC,KAAK,SAAAyjB,GAAC,MAAU,MAANA,GAAaypB,EAAMtqC,QAAQ6gB,IAAM,MAEvD2pB,EAAKE,WAAWttC,KAAK,SAAAyjB,GAAC,MAAU,MAANA,GAAaypB,EAAMtqC,QAAQ6gB,IAAM,IAGrE4pB,EAAkBD,EAAKG,SAAWF,EAAUE,QACpCH,EAAKG,QAGrB,MAAO1/C,GAEL,OADAoD,QAAQqJ,MAAMzM,IACP,IA3DT8R,KAAKktC,QAAUA,EACfltC,KAAK6lB,KAAOA,EACZ7lB,KAAKmtC,cAAgBA,EACrBntC,KAAK2b,GAAK,IAAIkyB,KAAcV,2DAyB5B77C,QAAQC,IAAI,gBAAiB,CAAEu8C,IAAK9tC,KAAKktC,QAASrnB,KAAM7lB,KAAK6lB,gBClB3Dv6B,GAAYC,aAAW8D,IAmCd0+C,GAjCQ,SAAA9gD,GAAoB,IAAjB06C,EAAiB16C,EAAjB06C,WAClB55C,EAAUzC,KAEhB,OACE+C,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQgC,MACtB1B,EAAAlD,EAAAmD,cAAC60B,GAAA,EAAD,MACA90B,EAAAlD,EAAAmD,cAACm6C,GAAA,EAAD,CAAQ18C,SAAS,SAASkD,UAAWlB,EAAQ04C,QAC3Cp4C,EAAAlD,EAAAmD,cAAC2jC,GAAA,EAAD,CAASC,gBAAc,GACrB7jC,EAAAlD,EAAAmD,cAACkH,GAAA,EAAD,CAAYvG,UAAWlB,EAAQk5C,WAAYt7C,MAAM,UAAUqD,QAAS24C,EAAYnyB,aAAW,QACzFnnB,EAAAlD,EAAAmD,cAACo6C,GAAAv9C,EAAD,OAEFkD,EAAAlD,EAAAmD,cAAC4E,GAAA,EAAD,CAAYyC,QAAQ,YAAYhK,MAAM,UAAUsD,UAAWlB,EAAQ84C,cAAnE,YAMJx4C,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQm5C,kBACtB74C,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQ0rB,OACxBprB,EAAAlD,EAAAmD,cAAC4E,GAAA,EAAD,CAAYjE,UAAWlB,EAAQq5C,gBAAiBzxC,QAAQ,MAAxD,oBAGAtH,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQ0rB,oBCvB1BnuB,GAAYC,aAAW8D,IAsCd2+C,GApCO,SAAA/gD,GAAoB,IAAjB06C,EAAiB16C,EAAjB06C,WACjB55C,EAAUzC,KAEhB,OACE+C,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQgC,MACtB1B,EAAAlD,EAAAmD,cAAC60B,GAAA,EAAD,MACA90B,EAAAlD,EAAAmD,cAACm6C,GAAA,EAAD,CAAQ18C,SAAS,SAASkD,UAAWlB,EAAQ04C,QAC3Cp4C,EAAAlD,EAAAmD,cAAC2jC,GAAA,EAAD,CAASC,gBAAc,GACrB7jC,EAAAlD,EAAAmD,cAACkH,GAAA,EAAD,CAAYvG,UAAWlB,EAAQk5C,WAAYt7C,MAAM,UAAUqD,QAAS24C,EAAYnyB,aAAW,QACzFnnB,EAAAlD,EAAAmD,cAACo6C,GAAAv9C,EAAD,OAEFkD,EAAAlD,EAAAmD,cAAC4E,GAAA,EAAD,CAAYyC,QAAQ,YAAYhK,MAAM,UAAUsD,UAAWlB,EAAQ84C,cAAnE,YAMJx4C,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQm5C,kBACtB74C,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQ0rB,OACxBprB,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQo5C,iBACtB94C,EAAAlD,EAAAmD,cAAC2/C,GAAA,EAAD,CAAkBh/C,UAAWlB,EAAQ4vC,SAAUhyC,MAAM,UAAUwO,KAAM,IAAK+zC,UAAW,KAEvF7/C,EAAAlD,EAAAmD,cAAC4E,GAAA,EAAD,CAAYjE,UAAWlB,EAAQq5C,gBAAiBzxC,QAAQ,MAAxD,cAGAtH,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQ0rB,UC3BnB2D,GACE,SADFA,GAEE,aAFFA,GAGD,WAHCA,GAIA,YAJAA,GAMC,cANDA,GAOK,iBAPLA,GAQA,YAEP+wB,GAAkB,CAAC/wB,GAAmBA,GAAkBA,IAMxDgxB,GAAmB,SAAAnhD,GAMnB,IALJohD,EAKIphD,EALJohD,SAAUt0B,EAKN9sB,EALM8sB,OAAQplB,EAKd1H,EALc0H,aAA2B25C,EAKzCrhD,EAL4BqwB,YAChCixB,EAIIthD,EAJJshD,cAAeC,EAIXvhD,EAJWuhD,gBAAiBC,EAI5BxhD,EAJ4BwhD,cAAe3T,EAI3C7tC,EAJ2C6tC,aAC/C9pC,EAGI/D,EAHJ+D,SAAU4D,EAGN3H,EAHM2H,QAASlF,EAGfzC,EAHeyC,SAAUg/C,EAGzBzhD,EAHyByhD,YAAaC,EAGtC1hD,EAHsC0hD,cAC1CC,EAEI3hD,EAFJ2hD,WAAYC,EAER5hD,EAFQ4hD,cAAerd,EAEvBvkC,EAFuBukC,QAC3BoW,EACI36C,EADJ26C,QAASC,EACL56C,EADK46C,UAAWC,EAChB76C,EADgB66C,SAAUC,EAC1B96C,EAD0B86C,MAC1B7/C,EAG4BC,mBAAS,CACvC4xB,SACAplB,eACAgnB,GAAI8yB,EAAgB,IAAIK,GAAYP,EAAeC,EAAiBC,GAAiB,OANnF3lD,EAAAC,OAAAsN,GAAA,EAAAtN,CAAAb,EAAA,GAGG6mD,EAHHjmD,EAAA,GAGgBI,EAHhBJ,EAAA,GAAAmB,EAQoB9B,mBAAS,CAC/BmB,QAAS,CACP6a,KAAMkqC,GAAYjxB,GAClB4xB,IAAKlU,EACLxd,YAAagxB,GAEfrwB,QAAS,KAdP3zB,EAAAvB,OAAAsN,GAAA,EAAAtN,CAAAkB,EAAA,GAQGi0B,EARH5zB,EAAA,GAQSkiD,EARTliD,EAAA,GAkBJZ,oBAAU,kBAAMR,EAASH,OAAA2J,EAAA,EAAA3J,CAAA,GAAKgmD,EAAN,CAAmBh1B,aAAW,CAACA,IAGvD,IAAMwyB,EAAgB,SAACt2C,EAAOgtB,GAC5B,IAAMpF,EAAS90B,OAAA2J,EAAA,EAAA3J,CAAA,GAAQgmD,EAAYh1B,QACnC8D,EAAU7C,OAAS6C,EAAU7C,OAAO7pB,IAAI,SAAA89C,GAAE,OAAIA,EAAGx/C,KAAOwzB,EAAWxzB,GAArB1G,OAAA2J,EAAA,EAAA3J,CAAA,GAA+BkmD,EAAOhsB,GAAegsB,IACnGN,EAAc14C,EAADlN,OAAA2J,EAAA,EAAA3J,CAAA,GAAak6B,EAAb,CAAyB4X,SAAUhd,EAAUpuB,OAGtDy/C,EAAc,eAAA/7C,EAAApK,OAAAwlC,GAAA,EAAAxlC,CAAAylC,GAAArjC,EAAAsjC,KAAG,SAAAC,EAAAz7B,GAAA,IAAAgwB,EAAApF,EAAA,OAAA2Q,GAAArjC,EAAAyjC,KAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,cAAgB9L,EAAhBhwB,EAASgD,MAAThD,EAA4B8mB,OAC3C8D,EADe90B,OAAA2J,EAAA,EAAA3J,CAAA,GAEhBgxB,EAFgB,CAGnBiB,OAAM,GAAApuB,OAAA7D,OAAAiO,GAAA,EAAAjO,CAAMgxB,EAAOiB,QAAb,CAAqBiI,MAHR4L,EAAAE,KAAA,EAKf6f,EAAW3rB,GALI,OAOrB/5B,EAASH,OAAA2J,EAAA,EAAA3J,CAAA,GAAKgmD,EAAN,CAAmBh1B,OAAQ8D,KACnCQ,EAAWjB,GAAsB6F,EAAWxzB,IARvB,wBAAAo/B,EAAAngB,SAAAggB,MAAH,gBAAAuB,GAAA,OAAA98B,EAAA0zB,MAAA7mB,KAAAsQ,YAAA,GAWd6+B,EAAc,eAAA37C,EAAAzK,OAAAwlC,GAAA,EAAAxlC,CAAAylC,GAAArjC,EAAAsjC,KAAG,SAAAiB,EAAAp8B,GAAA,IAAA2vB,EAAAF,EAAAqsB,EAAA,OAAA5gB,GAAArjC,EAAAyjC,KAAA,SAAAmB,GAAA,cAAAA,EAAAjB,KAAAiB,EAAAhB,MAAA,cAAgB9L,EAAhB3vB,EAAS2C,MAA2B8sB,EAApCzvB,EAA4BymB,OACjDzoB,QAAQC,IAAI,0CAA2C,CAAEwxB,cAAaE,eADjD8M,EAAAhB,KAAA,EAEW2f,EAAY3rB,EAAaE,GAFpC,OAEfmsB,EAFerf,EAAAd,KAGrB39B,QAAQC,IAAI,+CAAgD69C,GAHvC,wBAAArf,EAAArhB,SAAAghB,MAAH,gBAAAQ,GAAA,OAAA18B,EAAAqzB,MAAA7mB,KAAAsQ,YAAA,GAad+N,EAAa,SAACC,EAAa+wB,EAAQC,GACvC,IAAMC,EAAYR,EAAYpzB,GAAGY,QAAQ,SAAUxC,EAAQ,UACvC,OAAhBg1B,GAAsBn6C,KACrB26C,GAAapB,GAAgBlrC,QAAQqb,GAAe,EACvDhtB,QAAQqJ,MAAM,2BAA4B,CAAE2kB,KAAMpB,EAAK50B,QAASkmD,GAAIlxB,EAAaixB,cAIjF/C,EAAQ,CACNljD,QAAS,CACP6a,KAAMma,EACN0wB,IAAKK,EACL/xB,YAAagyB,GAEfrxB,QAAO,GAAArxB,OAAA7D,OAAAiO,GAAA,EAAAjO,CAAMm1B,EAAKD,SAAX,CAAoBC,EAAK50B,aAIhCmmD,EAAW,WAEf,GAAIvxB,EAAKD,QAAQvoB,OAAS,EAAG,CAC3B,IAAM8qB,EAAUz3B,OAAAiO,GAAA,EAAAjO,CAAOm1B,EAAKD,SACtBwC,EAAUD,EAAWE,MAC3B8rB,EAAQ,CACNljD,QAASm3B,EACTxC,QAASuC,SAIX5rB,KAUAd,EAAY,KAEhB,GAAI09B,EAAS,OAAOnjC,EAAAlD,EAAAmD,cAACohD,GAAD,CAAe/H,WAAY/yC,IAC1C,IAAKm6C,EAAYh1B,OAAQ,OAAO1rB,EAAAlD,EAAAmD,cAACqhD,GAAD,CAAgBhI,WAAY/yC,IAEjE,OAAQspB,EAAK50B,QAAQ6a,MACnB,KAAKiZ,GACHtpB,EACEzF,EAAAlD,EAAAmD,cAACshD,GAAD,CAEEtI,iBAAkB,kBAAMjpB,EAAWjB,KACnCpsB,SAAU,WACRM,QAAQC,IAAI,6BAEdu2C,SAAUA,EACVC,MAAOA,EACPjN,aAAcA,EACd0M,eA9De,SAACqI,GACtB91B,EAAOiB,OAAOjmB,OAAO,SAAA+6C,GAAE,OAAID,EAAW5sC,QAAQ6sC,EAAGrgD,KAAO,IAAG6uC,QAAQ,SAAAxa,GAAC,OAAI+qB,EAAc/qB,MA8DhF4jB,eAAgBh4C,EAChB+3C,YAAa,kBAAMppB,EAAWjB,GAAgB,KAAM,WACpDmqB,aAAc,kBAAMlpB,EAAWjB,KAC/BwC,aAAc,kBAAMvB,EAAWjB,GAAgB,KAAM,YACrDjC,YA3BU,SAAC6zB,GAEjB3wB,EAAWjB,GAAkB4xB,IA0BvBrH,WAAY/yC,EACZgzC,QAASA,EACTC,UAAWA,IAGf,MACF,KAAKzqB,GACHtpB,EACEzF,EAAAlD,EAAAmD,cAACyhD,GAAD,CACEl9B,SAAU,kBAAMwL,EAAWjB,KAC3B/R,KAAM,SAAC0X,GACL/xB,EAAS+oB,EAADhxB,OAAA2J,EAAA,EAAA3J,CAAA,GAAcg6B,EAAd,CAA2BtzB,GAAIsqB,EAAOtqB,MAC9C4uB,EAAWjB,OAIjB,MACF,KAAKA,GACHtpB,EACEzF,EAAAlD,EAAAmD,cAAC0hD,GAAD,CACEh1B,OAAQ+zB,EAAYh1B,OAAOiB,OAC3BsxB,YAAapuB,EAAK50B,QAAQ0lD,IAC1BrH,WAAY8H,EACZlD,cAAeA,IAGnB,MACF,KAAKnvB,GACHtpB,EACEzF,EAAAlD,EAAAmD,cAAC0hD,GAAD,CACEh1B,OAAQ+zB,EAAYh1B,OAAOiB,OAC3BsxB,YAAapuB,EAAK50B,QAAQ0lD,IAC1BtxB,UAAQ,EACRiqB,WAAY,kBAAMtpB,EAAWjB,KAC7BmvB,cAAeA,IAGnB,MACF,KAAKnvB,GACHtpB,EACEzF,EAAAlD,EAAAmD,cAAC2hD,GAAD,CAAWj1B,OAAQ+zB,EAAYh1B,OAAOiB,OAAQnI,SAAU48B,IAE1D,MACF,KAAKryB,GACHtpB,EACEzF,EAAAlD,EAAAmD,cAAC+uB,GAAA,EAAD,CACEC,YAAaY,EAAK50B,QAAQg0B,YAC1BtC,OAAQjB,EAASA,EAAOiB,OAAS,KACjCuC,SAAU2xB,EACVr8B,SAAU48B,IAGd,MACF,KAAKryB,GACHtpB,EACEzF,EAAAlD,EAAAmD,cAAC+uB,GAAA,EAAD,CACEC,YAAaY,EAAK50B,QAAQg0B,YAC1BE,aAAW,EACXD,SAAU4xB,EACVt8B,SAAU48B,IAGd,MACF,QACEn+C,QAAQC,IAAI,4DAA6Dw9C,GACzEj7C,EAAY,KAGhB,OACEzF,EAAAlD,EAAAmD,cAAC4hD,GAAA,EAAcC,SAAf,CAAwB9+C,MAAO09C,GAC5Bj7C,IAgCPs6C,GAAiBzrC,aAAe,CAC9Bub,KAAMd,IAGOgxB,wCChPFgC,IARKC,kBAAO,eAAgB,EAAG,SAAAC,GAC1Ch/C,QAAQC,IAAI,iBAAkB++C,GAC9B,IAAM3iB,EAAQ2iB,EAAUC,kBAAkB50C,KAAQ8B,UAClDnM,QAAQC,IAAI,uBAAwBo8B,KACnCngB,MAAM,SAAAtf,GACPoD,QAAQqJ,MAAM,QAASzM,KAGA,SAACsiD,GACxB,iBAAA5jD,OAAkB4jD,EAAlB,MAAA5jD,OAA6B6jD,UCD/B,IAoJMC,GAAuBlzC,YAAQirB,EAAgB,CACnDh7B,MAAO,SAAA8kB,GAAc,IAAXzjB,EAAWyjB,EAAXzjB,KACJA,EAAK6L,OAAOrJ,QAAQqJ,MAAM7L,EAAK6L,OAEnC,IAAIof,EAAS,KACb,IACOjrB,EAAK0iC,SAAY1iC,EAAK6L,QAAOof,EAASjrB,EAAKirB,QAElD,MAAO7rB,GACLoD,QAAQqJ,MAAM7L,GACdwC,QAAQqJ,MAAMzM,GAEhB,MAAO,CACLY,OACA0iC,QAAS1iC,EAAK0iC,QACdzX,WAGJ42B,KAAM,SAAAn+B,GAAA,IAAGupB,EAAHvpB,EAAGupB,aAAcve,EAAjBhL,EAAiBgL,YAAjB,OAAoCue,GAAgBve,GAC1DvsB,QAAS,SAAAwhB,GAAA,MAAuB,CAC9Bgb,UAAW,CACTh+B,GAFKgjB,EAAGspB,kBAOR6U,GAA2BpzC,YAAQ0uB,GAAc,CACrDz+B,MAAO,SAAAojD,GAAA,IAAG5jB,EAAH4jB,EAAG5jB,OAAQE,EAAX0jB,EAAW1jB,SAAX,MAA2B,CAEhC2jB,qBAAsB,SAAC/2B,EAAQgJ,GAAT,OAAyBkK,EAAO,CASpDQ,UAAW,CAAE1T,OAAQg3B,GAAqBhuB,EAAa,CAAC,KAAM,OAAQ,SAAU,OAAQ,WAAY,YAAa,eACjHiuB,mBAAoB,CAClB9kB,aAAanjC,OAAA2J,EAAA,EAAA3J,CAAA,GACRgxB,EACAgJ,EAFO,CAGVkuB,WAAY,YAGhBvjB,OAAQ,SAACC,EAADujB,GAAqBA,EAAXpiD,KAAW,IAErBqiD,EAAQxjB,EAAMyjB,UAAU,CAAEC,MAAO5oB,EAAgBgF,UAAW,CAAEh+B,GAAI09B,EAAS4O,gBACjFoV,EAAMp3B,OAANhxB,OAAA2J,EAAA,EAAA3J,CAAA,GAAoBooD,EAAMp3B,OAAWgJ,GACrC4K,EAAM2jB,WAAW,CAAED,MAAO5oB,EAAgB35B,KAAMqiD,IAKhD,IACE,IAAMI,EAAW5jB,EAAMyjB,UAAU,CAAEC,MAAOlqB,EAAWsG,UAAW,CAAE+jB,MAAO,OAEnEC,EAAUV,GAAqBhuB,EAAa,CAAC,KAAM,OAAQ,SAAU,WAAY,YAAa,cACpGwuB,EAASpqB,UAAUuqB,gBAAkBH,EAASpqB,UAAUuqB,gBAAgBvgD,IAAI,SAAAwgD,GAAC,OAAIA,EAAEliD,KAAOgiD,EAAQhiD,GAC9FkiD,EAD6E5oD,OAAA2J,EAAA,EAAA3J,CAAA,GAExE4oD,EAAMF,KAEf9jB,EAAM2jB,WAAW,CAAED,MAAOlqB,EAAWr4B,KAAMyiD,IAG7C,MAAOrjD,aAWT0jD,GAA0Bp0C,YAAQ4uB,GAAa,CACnD3+B,MAAO,SAAAokD,GAAA,IAAG5kB,EAAH4kB,EAAG5kB,OAAQE,EAAX0kB,EAAW1kB,SAAX,MAA2B,CAEhC2kB,oBAAqB,SAAC77C,EAAOgtB,GAC3B,IAAM8uB,EAAsBhB,GAAqB9tB,EAAY,CAAE,KAAM,WAAY,UAAW,OAAQ,SAcpG,OAbI8uB,EAAoBj9C,MAAQi9C,EAAoBj9C,KAAKY,OAAS,IAMhEq8C,EAAoBj9C,KAAOi9C,EAAoBj9C,KAAK3D,IAAI,SAAA6D,GACtD,IAAMg9C,EAAOjB,GAAqB/7C,EAAG,CAAE,QAAS,SAAU,WAE1D,OADIg9C,EAAKvoD,SAAQuoD,EAAKvoD,OAASsnD,GAAqBiB,EAAKvoD,OAAQ,CAAE,IAAK,OACjEuoD,KAIJ/kB,EAAO,CAQZQ,UAAW,CAAEx3B,MAAO87C,GACpBf,mBAAoB,CAClB5kB,YAAYrjC,OAAA2J,EAAA,EAAA3J,CAAA,GACPkN,EACA87C,EAFM,CAGTd,WAAY,WAGhBvjB,OAAQ,SAACC,EAADskB,GAAqBA,EAAXnjD,KAAW,IAErBqiD,EAAQxjB,EAAMyjB,UAAU,CAAEC,MAAO5oB,EAAgBgF,UAAW,CAAEh+B,GAAI09B,EAAS4O,gBAE3EmW,EAAYnpD,OAAA2J,EAAA,EAAA3J,CAAA,GACbgpD,EADa,CAEhBj9C,KAAMi9C,EAAoBj9C,KAAOi9C,EAAoBj9C,KAAK3D,IAAI,SAAA6D,GAC5D,IAAMg9C,EAAIjpD,OAAA2J,EAAA,EAAA3J,CAAA,GAAQiM,EAAR,CAAWi8C,WAAY,QAEjC,OADAe,EAAKvoD,OAASuoD,EAAKvoD,OAALV,OAAA2J,EAAA,EAAA3J,CAAA,GAAmBipD,EAAKvoD,OAAxB,CAAgCwnD,WAAY,gBAAkB,KACrEe,IACJ,KAGPb,EAAMp3B,OAAOiB,OAASm2B,EAAMp3B,OAAOiB,OAAO7pB,IAAI,SAAA8E,GAAK,OAAIA,EAAMxG,KAAOwzB,EAAWxzB,GAAKwG,EAA7BlN,OAAA2J,EAAA,EAAA3J,CAAA,GAA0CkN,EAAUi8C,KAE3GvkB,EAAM2jB,WAAW,CAAED,MAAO5oB,EAAgB35B,KAAMqiD,YAQpDgB,GAAiC30C,YAAQwuB,GAAc,CAC3Dv+B,MAAO,SAAA2kD,GAA0B,IAAvBnlB,EAAuBmlB,EAAvBnlB,OAAQE,EAAeilB,EAAfjlB,SAChB,MAAO,CACLklB,qBAAsB,kBAAMplB,EAAO,CACjCQ,UAAW,CAAEh+B,GAAI09B,EAAS4O,cAC1BiV,mBAAoB,CAClBhlB,aAAcmB,EAAS4O,cAEzBrO,OAAQ,SAACC,EAAD2kB,GAAqB,IAAXxjD,EAAWwjD,EAAXxjD,KAChB,IACE,IAAMyiD,EAAW5jB,EAAMyjB,UAAU,CAAEC,MAAOlqB,EAAWsG,UAAW,CAAE+jB,MAAO,OACzED,EAASpqB,UAAUuqB,gBAAkBH,EAASpqB,UAAUuqB,gBAAgB38C,OAAO,SAAA48C,GAAC,OAAIA,EAAEliD,KAAOX,EAAKk9B,eAClG2B,EAAM2jB,WAAW,CAAED,MAAOlqB,EAAWr4B,KAAMyiD,IAE7C,MAAOrjD,aAOXqkD,GAA0B/0C,YAAQsuB,GAAa,CACnDr+B,MAAO,SAAA+kD,GAAA,IAAGvlB,EAAHulB,EAAGvlB,OAAQE,EAAXqlB,EAAWrlB,SAAX,MAA2B,CAEhCslB,oBAAqB,SAACC,GAAD,OAAazlB,EAAO,CACvCQ,UAAW,CAAEoN,SAAU1N,EAASpT,OAAOtqB,GAAIijD,WAC3C1B,mBAAoB,CAClBllB,YAAa4mB,GAEfhlB,OAAQ,SAACC,EAADglB,GAAqB,IAAX7jD,EAAW6jD,EAAX7jD,KAChBwC,QAAQC,IAAI,mCAAoC2iB,KAAKqL,UAAUzwB,EAAM,KAAM,IAC3E,IAAI8jD,EAEEzB,EAAQxjB,EAAMyjB,UAAU,CAAEC,MAAO5oB,EAAgBgF,UAAW,CAAEh+B,GAAI09B,EAAS4O,gBACjFoV,EAAMp3B,OAAOiB,OAASm2B,EAAMp3B,OAAOiB,OAAOjmB,OAAO,SAAAkB,GAAK,OAAIA,EAAMxG,KAAOX,EAAKg9B,cAE5E8mB,EAAazB,EAAMp3B,OAAOiB,OAAOtlB,OACjCy7C,EAAMp3B,OAAO84B,WAAaD,EAC1BjlB,EAAM2jB,WAAW,CAAED,MAAO5oB,EAAgB35B,KAAMqiD,IAChD7/C,QAAQC,IAAI,yCAA0C4/C,GAItD,IACE,IAAMI,EAAW5jB,EAAMyjB,UAAU,CAAEC,MAAOlqB,EAAWsG,UAAW,CAAE+jB,MAAO,OACzElgD,QAAQC,IAAI,gCAAiCggD,GAC7CA,EAASpqB,UAAUuqB,gBAAkBH,EAASpqB,UAAUuqB,gBAAgBvgD,IAAI,SAAAwgD,GAAC,OAAIA,EAAEliD,KAAOX,EAAKg9B,YAC3F6lB,EAD6E5oD,OAAA2J,EAAA,EAAA3J,CAAA,GAExE4oD,EAFwE,CAErEkB,WAA2B,OAAfD,EAAsBA,EAAajB,EAAEkB,eAE7DllB,EAAM2jB,WAAW,CAAED,MAAOlqB,EAAWr4B,KAAMyiD,IAC3CjgD,QAAQC,IAAI,sCAAuCggD,GAErD,MAAOrjD,IAEPoD,QAAQC,IAAI,cAAe4/C,EAAMp3B,OAAOiB,gBAM1C83B,GAAsBt1C,YAAQgvB,GAAc,CAChD/+B,MAAO,SAAAslD,GAA0B,IAAvB9lB,EAAuB8lB,EAAvB9lB,OAAuB8lB,EAAf5lB,SAChB,MAAO,CACL6lB,qBAAsB,SAACn1B,GASrB,OAAOoP,EAAO,CACZQ,UAAW,CAAE1T,OAAQg3B,GAAqBlzB,EAAW,CAAC,OAAQ,OAAQ,WAAY,YAAa,YAAa,UAC5GmzB,mBAAoB,CAClBxkB,aAAgB,CACd/8B,GAAM2gD,GAAU,UAChBjsC,KAAQ0Z,EAAU1Z,MAAQ,KAC1BoQ,KAAQsJ,EAAUtJ,MAAQ,KAC1BzT,KAAQ+c,EAAU/c,MAAQ,GAC1BmyC,SAAYp1B,EAAUo1B,UAAY,KAClCxpD,OAAUo0B,EAAUp0B,QAAU,KAC9B+a,UAAaqZ,EAAUrZ,WAAa,KACpCquC,WAAc,EACd73B,OAAU,GACVi2B,WAAY,WAGhBvjB,OAAQ,SAACC,EAADulB,GAAqB,IAAXpkD,EAAWokD,EAAXpkD,KAEhBwC,QAAQC,IAAI,gCAAiCzC,EAAM6+B,GAEnD,IACEA,EAAM2jB,WAAW,CAAED,MAAO5oB,EACxB35B,KAAM,CAAEirB,OAAQjrB,EAAK09B,gBAEvBl7B,QAAQC,IAAI,8BAA+B,CAAEwoB,OAAQjrB,EAAK09B,eAE5D,MAAOt+B,GACLoD,QAAQqJ,MAAMzM,GAGhB,IACE,IAAMqjD,EAAW5jB,EAAMyjB,UAAU,CAAEC,MAAOlqB,EAAWsG,UAAW,CAAE+jB,MAAO,OAEnE2B,EAAoBpC,GAAqBjiD,EAAK09B,aAAc,CAAC,KAAM,OAAQ,YAAa,WAAY,YAAa,WAAY,aAAc,eAAgB,cACjK+kB,EAASpqB,UAAUuqB,gBAAgB0B,KAAKD,GACxCxlB,EAAM2jB,WAAW,CAAED,MAAOlqB,EAAWr4B,KAAMyiD,IAI7C,MAAOrjD,GAELoD,QAAQqJ,MAAM,wCACdrJ,QAAQqJ,MAAMzM,YAUtBmlD,GAAqB71C,YAAQ8uB,GAAa,CAC9C7+B,MAAO,SAAA6lD,GAA0B,IAAvBrmB,EAAuBqmB,EAAvBrmB,OAAQE,EAAemmB,EAAfnmB,SAChB,MAAO,CACLomB,oBAAqB,SAAC71B,EAAU81B,GAUO91B,EAA7B9jB,OAV8B,IAUnB65C,EAVmB1qD,OAAA2E,EAAA,EAAA3E,CAUD20B,EAVC,YActC,OAHK+1B,EAAc5Y,UAAY1N,EAAS4O,eACtC0X,EAAc5Y,SAAW1N,EAAS4O,cAE7B9O,EAAO,CACZQ,UAAW,CAAEx3B,MAAO86C,GAAqB0C,EAAe,CAAE,WAAY,UAAW,OAAQ,OAAQ,SAAWD,OAC5GxC,mBAAoB,CAClB1kB,YAAe,CACbr2B,MAAS,CACPxG,GAAM2gD,GAAU,SAChBtvC,KAAQ2yC,EAAc3yC,KACtB+5B,SAAY4Y,EAAc5Y,SAC1B6Y,UAAa9qD,KAAKC,MAAM2kC,WACxB6f,YAAe,CACb59C,GAAM09B,EAASkH,SAASsZ,WAAWG,IACnC6F,SAAYxmB,EAASkH,SAASuf,UAEhCC,UAAa1mB,EAASkH,SAASsZ,WAAWG,IAC1CgG,UAAalrD,KAAKC,MAAM2kC,WACxBnZ,QAAWo/B,EAAcp/B,QACzBvf,KAAQ2+C,EAAc3+C,MAAQ,GAC9Bi/C,MAAS,CACPC,MAAO,KACPC,KAAM,KACN7nC,MAAO,KACP8nC,OAAQ,KACRjD,WAAY,SAEdA,WAAc,SAEhB7S,QAAW,KACX6S,WAAc,mBAGlBvjB,OAAQ,SAACC,EAADwmB,GAAqB,IAAXrlD,EAAWqlD,EAAXrlD,KAEhBwC,QAAQC,IAAI,uCAAwC,CAAEzC,OAAM6+B,QAAOR,aAEnE,IACE,IAAMgkB,EAAQxjB,EAAMyjB,UAAU,CAAEC,MAAO5oB,EAAgBgF,UAAW,CAAEh+B,GAAIX,EAAKw9B,YAAYuO,YACzFsW,EAAMp3B,OAAOiB,OAASm2B,EAAMp3B,OAAOiB,OAAb,GAAApuB,OAAA7D,OAAAiO,GAAA,EAAAjO,CAA0BooD,EAAMp3B,OAAOiB,QAAvC,CAA+ClsB,EAAKw9B,cAE1EqB,EAAM2jB,WAAW,CAAED,MAAO5oB,EAAgB35B,KAAMqiD,IAElD,MAAOjjD,IAMP,IAAIqjD,EAAW,KACf,IACEA,EAAW5jB,EAAMyjB,UAAU,CAAEC,MAAOlqB,EAAWsG,UAAW,CAAE+jB,MAAO,OACnElgD,QAAQC,IAAI,gCAAiCggD,GAC7CA,EAASpqB,UAAUuqB,gBAAkBH,EAASpqB,UAAUuqB,gBAAgBvgD,IAAI,SAAAwgD,GAAC,OAAIA,EAAEliD,KAAOX,EAAKw9B,YAAYr2B,MAAM4kC,SAC7G8W,EAD6E5oD,OAAA2J,EAAA,EAAA3J,CAAA,GAExE4oD,EAFwE,CAErEkB,WAAYlB,EAAEkB,WAAa,MAEvCllB,EAAM2jB,WAAW,CAAED,MAAOlqB,EAAWr4B,KAAMyiD,IAC3CjgD,QAAQC,IAAI,sCAAuCggD,GAErD,MAAOrjD,GACLoD,QAAQqJ,MAAM,uCACdrJ,QAAQqJ,MAAMzM,YAStBkmD,GAA0B52C,YAAQkvB,GAAa,CACnDj/B,MAAO,SAAA4mD,GAA0B,IAAvBpnB,EAAuBonB,EAAvBpnB,OAAQE,EAAeknB,EAAflnB,SAChB,MAAO,CACLmnB,oBAAqB,kBAAMrnB,EAAO,CAChCQ,UAAW,CAAEoN,SAAU1N,EAAS4O,cAChCiV,mBAAoB,CAClBtkB,YAAaS,EAAS4O,cAExBrO,OAAQ,SAACC,EAAD4mB,GAAqB,IAAXzlD,EAAWylD,EAAXzlD,KAGVyiD,EAAW5jB,EAAMyjB,UAAU,CAAEC,MAAOrpB,IAC1CupB,EAAStQ,KAAK6G,SAAd/+C,OAAAiO,GAAA,EAAAjO,CAA6B,IAAIyrD,IAAJ,GAAA5nD,OAAA7D,OAAAiO,GAAA,EAAAjO,CAAYwoD,EAAStQ,KAAK6G,UAAY,IAAtC,CAA0Ch5C,EAAK49B,gBAC5EiB,EAAM2jB,WAAW,CAAED,MAAOrpB,EAASl5B,KAAMyiD,IAEzC,IAAMkD,EAAY9mB,EAAMyjB,UAAU,CAAEC,MAAOhpB,IAC3C/2B,QAAQC,IAAI,QAASkjD,WAWzBC,GAA4Bl3C,YAAQovB,GAAe,CACvDn/B,MAAO,SAAAknD,GAA0B,IAAvB1nB,EAAuB0nB,EAAvB1nB,OAAQE,EAAewnB,EAAfxnB,SAChB,MAAO,CACLynB,sBAAuB,kBAAM3nB,EAAO,CAClCQ,UAAW,CAAEoN,SAAU1N,EAAS4O,cAChCiV,mBAAoB,CAClBpkB,cAAeO,EAAS4O,cAE1BrO,OAAQ,SAACC,EAADknB,GAAqB,IAAX/lD,EAAW+lD,EAAX/lD,KAEVyiD,EAAW5jB,EAAMyjB,UAAU,CAAEC,MAAOrpB,IAC1CupB,EAAStQ,KAAK6G,SAAWyJ,EAAStQ,KAAK6G,SAAS/yC,OAAO,SAAA+/C,GAAG,OAAIA,IAAQhmD,EAAK89B,gBAC3Ee,EAAM2jB,WAAW,CAAED,MAAOrpB,EAASl5B,KAAMyiD,YAY7CwD,GAAsBjY,YAC1B4T,GACAoC,GACAO,GACAzC,GACAgB,GACAO,GACAI,GACA6B,GACAM,GAT0B5X,CA/hBN,SAAA7vC,GAOhB,IANJ8sB,EAMI9sB,EANJ8sB,OAAQyX,EAMJvkC,EANIukC,QAASxzB,EAMb/Q,EANa+Q,OAAQ+9B,EAMrB9uC,EANqB8uC,aAAcjB,EAMnC7tC,EANmC6tC,aACvCka,EAKI/nD,EALJ+nD,oBAAqBC,EAKjBhoD,EALiBgoD,OAAQC,EAKzBjoD,EALyBioD,YAAaC,EAKtCloD,EALsCkoD,mBAC1CnC,EAII/lD,EAJJ+lD,qBAAsBO,EAIlBtmD,EAJkBsmD,oBACtBzC,EAGI7jD,EAHJ6jD,qBAAsBgB,EAGlB7kD,EAHkB6kD,oBACtBO,EAEIplD,EAFJolD,qBAAsBI,EAElBxlD,EAFkBwlD,oBACtB6B,EACIrnD,EADJqnD,oBAAqBM,EACjB3nD,EADiB2nD,sBACjBl5B,EACwDvlB,qBAAWkzB,GAA/DxD,EADJnK,EACImK,KAAMuvB,EADV15B,EACU05B,YAAazgD,EADvB+mB,EACuB/mB,aAAcssC,EADrCvlB,EACqCulB,KAAM3M,EAD3C5Y,EAC2C4Y,SAC3ChX,EAAc,SAEdtf,IAAWvC,KAAKgB,cAAcO,kBAAmBsgB,EAAc,SAC1Dtf,IAAWvC,KAAKgB,cAAcQ,qBAAoBqgB,EAAc,WAGzE,IAAI+wB,EAAWjxB,GAGf,OAFIpf,IAAWvC,KAAKgB,cAAcK,SAAQuxC,EAAWjxB,IAGnD/uB,EAAAlD,EAAAmD,cAACy7B,GAAA,EAAD,CAAev+B,MAAO29B,EAAOpP,QAC3B1rB,EAAAlD,EAAAmD,cAAC+mD,GAAD,CACEhH,SAAUA,EACV/wB,YAAaA,EAEbyqB,MAAOzT,GAAY2M,GAAQlnB,GAAUknB,EAAKxxC,KAAOsqB,EAAOtqB,GACxDq4C,SAAUxT,GAAY2M,GAAQA,EAAK6G,UAAY7G,EAAK6G,SAAS7kC,QAAQ84B,IAAiB,EAGtFwS,cAAeja,EAAW8gB,EAAYzH,WAAWG,IAAM,KACvDU,gBAAiB3oB,EACjB4oB,cAAelO,GACf/O,QAASA,EACTzX,OAAQA,EACR+gB,aAAcA,EACdnmC,aAAcA,EAEdi6C,WAAY,SAAA37C,GAA6B,IAA1B2G,EAA0B3G,EAA1B2G,OAAW8jB,EAAe30B,OAAA2E,EAAA,EAAA3E,CAAAkK,EAAA,YACvC3B,QAAQC,IAAI,aAAZxI,OAAA2J,EAAA,EAAA3J,CAAA,CAA4B6Q,UAAW8jB,IACvC,IAAM81B,EAAM55C,EAAOu9B,MAAM,KAAK,GAAGA,MAAM,KAAK,GAC5C,OAAOoc,EAAoB71B,EAAU81B,GAClCjmC,KAAK,SAAApa,GAAc,IAAXrE,EAAWqE,EAAXrE,KAEP,GAAIA,EAAKw9B,YAAY8R,QAAS,CAC5B,IAAMA,EAAUlqB,KAAKC,MAAMrlB,EAAKw9B,YAAY8R,SAC5C9sC,QAAQC,IAAI,UAAWzC,EAAKw9B,YAAY8R,SACxC8W,EAAY,CACVzlD,GAAIiuB,EAASjuB,GACborC,SAAU/rC,EAAKw9B,YAAYuO,SAC3BjhC,SACAwkC,YAGJ,OAAOtvC,IAER0e,MAAM,SAAA9S,GACLpJ,QAAQC,IAAI,2BAA4BmJ,EAAIswB,OAC5C15B,QAAQqJ,MAAMD,MAGpBi0C,cAAe,SAAC14C,EAAOgtB,GAAR,OAAuB6uB,EAAoB77C,EAAOgtB,GAC9DzV,MAAM,SAAA9S,GACLpJ,QAAQC,IAAI,8BAA+BmJ,EAAIswB,OAC/C15B,QAAQqJ,MAAMD,MAGlBm0C,cAAe,SAAC54C,GAAD,OAAWw8C,EAAoBx8C,EAAMxG,IACjD8d,KAAK,WAAa,QAAAiZ,EAAAlW,UAAA5a,OAAT5G,EAAS,IAAAsX,MAAAogB,GAAAE,EAAA,EAAAA,EAAAF,EAAAE,IAAT53B,EAAS43B,GAAApW,UAAAoW,GACjBp1B,QAAQC,IAAI,gBAAiBzC,KAE9B0e,MAAM,SAAA9S,GACLpJ,QAAQC,IAAI,8BAA+BmJ,EAAIswB,OAC/C15B,QAAQqJ,MAAMD,MAGlB1J,SAAU,SAAC+oB,EAAQgJ,GAAT,OAAyB+tB,EAAqB/2B,EAAQgJ,GAC7DvV,MAAM,SAAA9S,GACLpJ,QAAQC,IAAI,yBAA0BmJ,EAAIswB,OAC1C15B,QAAQqJ,MAAMD,MAGlBg0C,YAAa,SAAC7wB,EAAWy3B,GAEvB,OADAhkD,QAAQC,IAAI,uCAAwCssB,GAC7Cm1B,EAAqBn1B,GACzBtQ,KADI,eAAA/Z,EAAAzK,OAAAwlC,GAAA,EAAAxlC,CAAAylC,GAAArjC,EAAAsjC,KACC,SAAAC,EAAAp7B,GAAA,IAAAxE,EAAA8K,EAAA8jB,EAAA81B,EAAAx/C,EAAAuhD,EAAAnX,EAAA,OAAA5P,GAAArjC,EAAAyjC,KAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,cAASjgC,EAATwE,EAASxE,KACL8K,EAAwB07C,EAAxB17C,OAAW8jB,EADf30B,OAAA2E,EAAA,EAAA3E,CAC4BusD,EAD5B,YAEE9B,EAAM55C,EAAOu9B,MAAM,KAAK,GAAGA,MAAM,KAAK,GAC5C7lC,QAAQC,IAAI,4CAA6CzC,GAHrD+/B,EAAAE,KAAA,EAI8BwkB,EAAoBxqD,OAAA2J,EAAA,EAAA3J,CAAA,GAAKusD,EAAN,CAAiBza,SAAU/rC,EAAK09B,aAAa/8B,KAAM+jD,GAJpG,cAAAx/C,EAAA66B,EAAAI,KAIUsmB,EAJVvhD,EAIIlF,KAEFsvC,EAAUlqB,KAAKC,MAAMohC,EAAUjpB,YAAY8R,SACjD9sC,QAAQC,IAAI,UAAWgkD,EAAUjpB,YAAY8R,SAC7C8W,EAAY,CACVzlD,GAAIiuB,EAASjuB,GACborC,SAAU0a,EAAUjpB,YAAYuO,SAChCjhC,SACAwkC,YAEF+W,EAAmBrmD,EAAK09B,aAAa/8B,IAdjCo/B,EAAAK,OAAA,SAeGpgC,GAfH,yBAAA+/B,EAAAngB,SAAAggB,MADD,gBAAAuB,GAAA,OAAAz8B,EAAAqzB,MAAA7mB,KAAAsQ,YAAA,IAkBJ9C,MAAM,SAAA9S,GACLpJ,QAAQC,IAAI,4BAA6BmJ,EAAIswB,OAC7C15B,QAAQqJ,MAAMD,MAGpBhL,SAAU,kBAAM2iD,IACb9kC,KAAKynC,GACLxnC,MAAM,SAAA9S,GACLpJ,QAAQC,IAAI,yBAA0BmJ,EAAIswB,OAC1C15B,QAAQqJ,MAAMD,MAGlB9F,QAASqgD,EACTrN,QAAStT,EAAWggB,EAAsB,KAC1CzM,UAAWvT,EAAWsgB,EAAwB,UAkdvChnB,gBAtBS,SAAC3kC,EAAOwE,GAAU,IAAA+nD,EACoBvsD,EAAMwS,KAA1DnS,QACR,MAAO,CAAEyyC,aAF+ByZ,EACrBzZ,aACIjB,aAFiB0a,EACP1a,aACI98B,OAFGw3C,EACOx3C,SAItB,SAAAiiC,GAAQ,MAAK,CACtCgV,OAAQ,WACNhV,EAASvF,OAEXsa,oBAAqB,SAACl/C,EAAKqlC,GACzB8E,EAASvF,GAAwB,OACjCuF,EAASvF,OAEXwa,YAAa,SAACha,GACZ+E,EAASvF,GAAoBQ,KAE/Bia,mBAAoB,SAACta,GACnBoF,EAASvF,GAAwBG,IACjCoF,EAASvF,GAAqBj/B,KAAKgB,cAAcK,YAItC8wB,CAGbmnB,IAKF,SAAShE,GAAsB0E,EAAUC,GACvC,IAAMC,EAAgB,GAAA/oD,OAAA7D,OAAAiO,GAAA,EAAAjO,CAAO2sD,GAAP,CAAsB,eACtCE,EAAY7sD,OAAO8X,KAAK40C,GAAU1gD,OAAO,SAAAe,GAAG,OAAI6/C,EAAiB1yC,QAAQnN,IAAQ,IAEvF,OADAxE,QAAQC,IAAI,uBAAwB,CAAE0iD,KAAMlrD,OAAO8X,KAAK40C,GAAWG,cAC5DA,EAAU50C,OAAO,SAACC,EAAKnL,GAAN,OAAA/M,OAAA2J,EAAA,EAAA3J,CAAA,GAAoBkY,EAApBlY,OAAAszC,GAAA,EAAAtzC,CAAA,GAA0B+M,EAAM2/C,EAAS3/C,MAAS,uFC3jB7D+/C,GA9BU,SAAC/mD,EAAMgnD,EAAcC,EAAa5wC,EAAU6wC,EAAWC,GAAiB,IAAA/tD,EACrDC,mBAAS,IAD4CW,EAAAC,OAAAsN,GAAA,EAAAtN,CAAAb,EAAA,GACxFguD,EADwFptD,EAAA,GACzEqtD,EADyErtD,EAAA,GAAAmB,EAEvD9B,mBAAS,CAAEiuD,OAAQ,GAAIC,QAAS,KAFuB/rD,EAAAvB,OAAAsN,GAAA,EAAAtN,CAAAkB,EAAA,GAExFqsD,EAFwFhsD,EAAA,GAE1EisD,EAF0EjsD,EAAA,GAAA8O,EAGjEjR,mBAAS,GAHwDkR,EAAAtQ,OAAAsN,GAAA,EAAAtN,CAAAqQ,EAAA,GAGxFqL,EAHwFpL,EAAA,GAG/Em9C,EAH+En9C,EAAA,GAMzFo9C,EAAqBn3C,sBAAYC,aAAQxW,OAAAwlC,GAAA,EAAAxlC,CAAAylC,GAAArjC,EAAAsjC,KAAC,SAAAC,IAAA,IAAAgoB,EAAAC,EAAArmC,UAAA,OAAAke,GAAArjC,EAAAyjC,KAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,cAAAF,EAAAE,KAAA,EACpB6nB,GAAU/vB,WAAV,EAAA8vB,GADoB,OACxCD,EADwC7nB,EAAAI,KAE9CknB,EAAiBO,GAEjBF,EAAW/xC,EAAU,GAJyB,wBAAAoqB,EAAAngB,SAAAggB,MAK7C,KAAO,IAEJmoB,EAAqBv3C,sBAAYC,aAAQxW,OAAAwlC,GAAA,EAAAxlC,CAAAylC,GAAArjC,EAAAsjC,KAAC,SAAAiB,IAAA,IAAAonB,EAAAC,EAAAzmC,UAAA,OAAAke,GAAArjC,EAAAyjC,KAAA,SAAAmB,GAAA,cAAAA,EAAAjB,KAAAiB,EAAAhB,MAAA,cAAAgB,EAAAhB,KAAA,EACvBioB,GAAUnwB,WAAV,EAAAkwB,GADuB,OACxCD,EADwC/mB,EAAAd,KAE9CsnB,EAAgBO,GAF8B,wBAAA/mB,EAAArhB,SAAAghB,MAG7C,KAAM,IAWT,OARAhmC,oBAAU,WACR+sD,EAAmB3nD,EAAMknD,EAAW7wC,IACnC,CAACrW,EAAK4G,OAAQugD,IAEjBvsD,oBAAU,WACRmtD,EAAmBX,EAAeJ,EAAcC,IAC/C,CAACG,EAAeH,EAAaD,EAAcrxC,IAEvC,CAAEwyC,sBAAuBX,IAS5BM,GAAa,SAAC9nD,EAAMknD,EAAW7wC,GAGnC,IAAKrW,EACH,MAAO,GAET,IAAMooD,EAAOC,KAAM,EAAG,CAAC,KAAM,KAAM,KAAM,OAEnC1+C,EAAY,IAAI4e,KAAJtuB,OAAA2J,EAAA,EAAA3J,CAAA,GACboc,EADa,CAEhBwR,KAAM,KAKFqI,EAAUlwB,EAAKqC,IAAI,SAAA2yB,GAEvB,IAAIszB,EAAe,CAAC,EAAG,GACvB,IACEA,EAAe3+C,EAAU4+C,QAAQvzB,EAAEr6B,QAErC,MAAOyE,GACLoD,QAAQqJ,MAAMzM,GAE+B41B,EAAvCr7B,UAAuCq7B,EAA5Bt7B,SATS,IASI8uD,EATJvuD,OAAA2E,EAAA,EAAA3E,CASmB+6B,EATnB,0BAU5B,MAAO,CACLj2B,EAAGupD,EAAa,GAChBxoD,EAAGwoD,EAAa,GAChBvE,WAAYyE,EAAWzE,WACvB0E,WAAY,GACZC,QAAS1zB,EAAEr6B,OAASguD,iBAAM3zB,EAAEr6B,OAAHV,OAAA2J,EAAA,EAAA3J,CAAA,GAAgBuuD,IAAgB,QAI7DJ,EAAKQ,QACLR,EAAKS,KAAK34B,GAEV,IArCgD,IAAA44B,EAAA,SAqCvCC,GACP,IAAMC,EAAS9B,EAAY76C,KAAK48C,KAAK,GAAK58C,KAAK68C,IAAI,EAAGH,GAGtD74B,EAAQsf,QAAQ,SAAAxa,GACd,QAAwBhV,IAApBgV,EAAEyzB,WAAWM,GAAkB,KAEzBhqD,EAASi2B,EAATj2B,EAAGe,EAAMk1B,EAANl1B,EAGLqpD,EAAYf,EACfgB,OAAO,CACNC,KAAMtqD,EAAIiqD,EACVM,KAAMxpD,EAAIkpD,EACVO,KAAMxqD,EAAIiqD,EACVQ,KAAM1pD,EAAIkpD,IAEX/iD,OAAO,SAAAwjD,GAAQ,YAA+BzpC,IAA3BypC,EAAShB,WAAWM,KAG1CI,EAAU3Z,QAAQ,SAAAia,GAChB,GAAIA,IAAaz0B,EAAG,CAClB,IAAM00B,EAAkC,IAArBP,EAAUviD,OACzBouB,EAAE0zB,QACFiB,oBAASC,6BAAkBT,EAAU9mD,IAAI,SAAA4Q,GAAC,OAAIA,EAAEy1C,YAEpDgB,EAAWlB,WAAXvuD,OAAA2J,EAAA,EAAA3J,CAAA,GACKyvD,EAAWlB,WADhB,CAEE7nD,GAAI+oD,EAAWlB,WAAW7nD,IAAM4T,OAChC+gC,MAAO6T,EAAUviD,OACjBijD,kBAAmBV,EAAUj3C,OAAO,SAACC,EAAD3N,GAAA,IAAQu/C,EAARv/C,EAAQu/C,WAAR,OAAyBA,EAAa5xC,EAAM4xC,EAAa5xC,GAAK,GAClG23C,OAAQX,EAAU9mD,IAAI,SAAA4Q,GAAC,OAAIA,EAAEy1C,YAE/B1zB,EAAEyzB,WAAWM,GAAKW,OAGlBD,EAAShB,WAAWM,GAAK,WApC1BA,EAAI,EAAGA,GAAK,GAAIA,IAAKD,EAArBC,GA4CT,OAAO74B,EAAQ7tB,IAAI,SAAAgC,GAAA,OAAAA,EAAGokD,cAGxB,SAASP,GAAYd,EAAeJ,EAAc+C,GAGhD,OAAO3C,EAEJnhD,OAAO,SAAAuG,GAAC,QAAMA,EAAEu9C,KAEhB73C,OAAO,SAACC,EAAKs2C,GACZ,IAAMC,EAAUD,EAAWsB,GACrBpvD,EAAS+tD,EAAQsB,SAASC,YACxB3U,EAAUoT,EAAQF,WAAlBlT,MASR,QAPK0R,GAAgBA,EAAapgD,OAAS,GACzCogD,EAAa,GAAKrsD,EAAO,IAAMqsD,EAAa,GAAKrsD,EAAO,IACxDqsD,EAAa,GAAKrsD,EAAO,IAAMqsD,EAAa,GAAKrsD,EAAO,MAEpD26C,EAAQ,EAAGnjC,EAAIo1C,QAAQjD,KAAKoE,GAC3Bv2C,EAAIm1C,OAAOhD,KAAKoE,IAEhBv2C,GACN,CACDm1C,OAAQ,GACRC,QAAS,KCrJA,ICGA1sB,QACbt7B,EAAAlD,EAAAmD,cAACD,EAAAlD,EAAMupB,SAAP,KACErmB,EAAAlD,EAAAmD,cAAA,QAAMgN,EAAE,mIACRjN,EAAAlD,EAAAmD,cAAA,QAAMgN,EAAE,sIACRjN,EAAAlD,EAAAmD,cAAA,QAAMgN,EAAE,qIACRjN,EAAAlD,EAAAmD,cAAA,QAAMgN,EAAE,0IACRjN,EAAAlD,EAAAmD,cAAA,QAAMgN,EAAE,wIACRjN,EAAAlD,EAAAmD,cAAA,QAAMgN,EAAE,0IACS,qGCOfhQ,GAAYC,aAAW,SAAAC,GAAK,MAAK,CACrCwtD,YAAa,CACXzsD,MAAO,IACPO,QAAS,OACTV,cAAe,SACfN,OAAQ,QAEV8D,OAAQ,CACN9D,OAAQN,EAAM0E,QAAQ,GACtB3D,MAAOf,EAAM0E,QAAQ,GACrBqY,OAAM,aAAA3b,OAAepB,EAAM8D,QAAQ8I,QAAQqL,MAC3C9W,OAAQnB,EAAM0E,QAAQ,EAAG,IAE3B+oD,YAAa,CACX1sD,MAAO,QAETw+B,OAAQ,CACN/yB,SAAU,GAEZkhD,SAAU,CACR3sD,MAAO,WAuFI4sD,GAnFI,SAAAlsD,GAA+B,IAA5ByH,EAA4BzH,EAA5ByH,KAAMgxB,EAAsBz4B,EAAtBy4B,OAAQ9wB,EAAc3H,EAAd2H,QAC5B7G,EAAUzC,KADgCowB,EAE6BvlB,qBAAWkzB,GAAhFmM,EAFwC9Z,EAExC8Z,QAASlB,EAF+B5Y,EAE/B4Y,SAAUmB,EAFqB/Z,EAErB+Z,YAAawL,EAFQvlB,EAERulB,KAAMmY,EAFE19B,EAEF09B,UAAW5f,EAFT9d,EAES8d,gBACzD,OACEnrC,EAAAlD,EAAAmD,cAACi3B,GAAA,EAAD,CACE7wB,KAAMA,EACNE,QAASA,EACT8wB,OAAQA,GAERr3B,EAAAlD,EAAAmD,cAAA,OACEW,UAAWlB,EAAQirD,YACnBnzB,KAAK,eACL72B,QAAS4F,EACTkxB,UAAWlxB,GAEVqsC,GAAQA,EAAK0S,UACZtlD,EAAAlD,EAAAmD,cAACqmB,GAAA,EAAD,KACEtmB,EAAAlD,EAAAmD,cAACumB,GAAA,EAAD,CAAU5lB,UAAWlB,EAAQgC,KAAMf,QAAS,aAAUkjC,gBAAc,GAClE7jC,EAAAlD,EAAAmD,cAACuB,GAAA,EAAD,CAAQZ,UAAWlB,EAAQ6B,QACxB0kC,GAAY2M,EACT5yC,EAAAlD,EAAAmD,cAAA,OAAKkM,IAAI,UAAUvL,UAAWlB,EAAQkrD,YAAap+C,IAAKomC,EAAKoY,WAC7DhrD,EAAAlD,EAAAmD,cAACgrD,GAAAnuD,EAAD,CAAmBQ,MAAM,UAAUsD,UAAWlB,EAAQwrD,gBAI9DlrD,EAAAlD,EAAAmD,cAACumB,GAAA,EAAD,CAAU5lB,UAAWlB,EAAQgC,KAAMf,QAAS,cAC1CX,EAAAlD,EAAAmD,cAACwmB,GAAA,EAAD,CACE1c,QAAS6oC,EAAK0S,aAMtBtlD,EAAAlD,EAAAmD,cAACkmB,GAAA,EAAD,MACAnmB,EAAAlD,EAAAmD,cAACqmB,GAAA,EAAD,KACEtmB,EAAAlD,EAAAmD,cAACumB,GAAA,EAAD,CAAU6N,QAAM,EAAC1zB,QAASoqD,GACxB/qD,EAAAlD,EAAAmD,cAACq1C,GAAA,EAAD,KACEt1C,EAAAlD,EAAAmD,cAACuzC,GAAD,OAEFxzC,EAAAlD,EAAAmD,cAACwmB,GAAA,EAAD,CAAc1c,QAAS,kBAExBohC,GACCnrC,EAAAlD,EAAAmD,cAACumB,GAAA,EAAD,CAAU6N,QAAM,EAAC1zB,QAASwqC,GACxBnrC,EAAAlD,EAAAmD,cAACq1C,GAAA,EAAD,KACEt1C,EAAAlD,EAAAmD,cAACkrD,GAAAruD,EAAD,OAEFkD,EAAAlD,EAAAmD,cAACwmB,GAAA,EAAD,CAAc1c,QAAS,mBAAoBC,UAAW,uBAI5DhK,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQg9B,SACxB18B,EAAAlD,EAAAmD,cAACkmB,GAAA,EAAD,MACAnmB,EAAAlD,EAAAmD,cAACqmB,GAAA,EAAD,KACG2f,EAEGjmC,EAAAlD,EAAAmD,cAACumB,GAAA,EAAD,CAAU6N,QAAM,EAAC1zB,QAASwmC,GACxBnnC,EAAAlD,EAAAmD,cAACq1C,GAAA,EAAD,KACEt1C,EAAAlD,EAAAmD,cAACmrD,GAAAtuD,EAAD,OAEFkD,EAAAlD,EAAAmD,cAACwmB,GAAA,EAAD,CAAc1c,QAAS,cAIzB/J,EAAAlD,EAAAmD,cAACumB,GAAA,EAAD,CAAU6N,QAAM,EAAC1zB,QAASymC,GACxBpnC,EAAAlD,EAAAmD,cAACq1C,GAAA,EAAD,KACEt1C,EAAAlD,EAAAmD,cAACgrD,GAAAnuD,EAAD,OAEFkD,EAAAlD,EAAAmD,cAACwmB,GAAA,EAAD,CAAc1c,QAAS,iBC5CjC9M,GAAYC,aA/CJ,SAAAC,GAAK,MAAK,CACtBuE,KAAM,CACJjD,QAAS,OACT2D,WAAY,SACZlE,MAAO,OACP0D,QAASzE,EAAM0E,QAAQ,EAAG,GAC1B2qB,gBAAiBrvB,EAAM8D,QAAQ8I,QAAQqL,KACvC9X,MAAOH,EAAM8D,QAAQ8I,QAAQ2L,aAC7B21C,aAAY,aAAA9sD,OAAepB,EAAM8D,QAAQ8I,SACzCvM,WAAU,0BAAAe,OAA4BpB,EAAM8D,QAAQ+I,UAAUoL,KAApD,SAAA7W,OAAgEpB,EAAM8D,QAAQ8I,QAAQqL,KAAtF,WAEZk2C,WAAY,CACV1hD,QAAS,GACTsJ,YAAa/V,EAAM0E,QAAQ,IAE7B0pD,YAAa,CACX/+B,gBAAiB,cACjBhvB,WAAY,OACZF,MAAOH,EAAM8D,QAAQmT,KAAKrK,SAG5ByxB,KAAM,CACJ55B,QAASzE,EAAM0E,QAAQ,EAAG,GAC1BpE,OAAQ,GACRS,MAAO,IAETstD,gBAAiB,CACfhuD,WAAU,0BAAAe,OAA4BpB,EAAM8D,QAAQ+I,UAAUoL,KAApD,SAAA7W,OAAgEpB,EAAM8D,QAAQ8I,QAAQqL,KAAtF,UACVxT,QAASzE,EAAM0E,QAAQ,GAAK,KAE9B4pD,oBAAqB,CACnBnuD,MAAO,QACPG,OAAQ,GACRS,MAAO,IAETuG,SAAU,CACRkF,SAAU,EACV/H,QAASzE,EAAM0E,QAAQ,EAAG,IAE5B6pD,SAAU,CACR9pD,QAASzE,EAAM0E,QAAQ,EAAG,IAE5B8pD,oBAAqB,CACnBnuD,WAAY,QACZoE,QAASzE,EAAM0E,QAAQ,GAAK,QAK1B+pD,GAAS,SAAAhtD,GAAiE,IAA9DgC,EAA8DhC,EAA9DgC,UAAW6D,EAAmD7F,EAAnD6F,SAAUonD,EAAyCjtD,EAAzCitD,cAA0BC,GAAeltD,EAA1Bw2C,UAA0Bx2C,EAAfktD,UACzDpsD,EAAUzC,KAD8DpD,EAE1CC,oBAAS,GAFiCW,EAAAC,OAAAsN,GAAA,EAAAtN,CAAAb,EAAA,GAEvE48B,EAFuEh8B,EAAA,GAE3Di8B,EAF2Dj8B,EAAA,GAGtEswD,EAAcjjD,qBAAWkzB,GAAzB+vB,UAER,OACE/qD,EAAAlD,EAAAmD,cAACD,EAAAlD,EAAMupB,SAAP,KACErmB,EAAAlD,EAAAmD,cAACm6C,GAAA,EAAD,CAAQ18C,SAAS,UACfsC,EAAAlD,EAAAmD,cAAC2jC,GAAA,EAAD,CAAShjC,UAAWC,KAAWnB,EAAQgC,KAAMd,EAAWirD,EAAgBnsD,EAAQ6rD,YAAc,MAAO1nB,gBAAc,IAC/GioB,GACA9rD,EAAAlD,EAAAmD,cAACkH,GAAA,EAAD,CACEvG,UAAWirD,EAAgBnsD,EAAQ8rD,gBAAkB9rD,EAAQ87B,KAC7Dl+B,MAAM,UACNqD,QAAS,kBAAM+1B,GAAc,KAE7B12B,EAAAlD,EAAAmD,cAAC8rD,GAAD,CAAenrD,UAAWirD,EAAgBnsD,EAAQ+rD,oBAAsB/rD,EAAQ87B,QAGpFx7B,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQ+E,UACrBA,GAEHzE,EAAAlD,EAAAmD,cAACkH,GAAA,EAAD,CACE7J,MAAM,UACNsD,UAAWirD,EAAgBnsD,EAAQisD,oBAAsBjsD,EAAQgsD,SACjEvkC,aAAW,OACXxmB,QAASoqD,GAET/qD,EAAAlD,EAAAmD,cAACuzC,GAAD,CAAYl2C,MAAM,eAIxB0C,EAAAlD,EAAAmD,cAAC+rD,GAAD,CACE3lD,KAAMowB,EACNlwB,QAAS,kBAAMmwB,GAAc,IAC7BW,OAAQ,kBAAMX,GAAc,QAmBrBu1B,GAAA,SAAC7sD,GAAD,OAAWY,EAAAlD,EAAAmD,cAACy7B,GAAA,EAAD,CAAev+B,MAAO29B,EAAOH,QAAQ36B,EAAAlD,EAAAmD,cAACisD,GAAW9sD,qCC9GrE+sD,GAAqBjvD,aAAW,SAAAC,GAAK,MAAK,CAC9CuE,KAAKhH,OAAAszC,GAAA,EAAAtzC,CAAA,CACHgD,SAAU,WACVilC,aAAcxlC,EAAMivD,MAAMzpB,aAC1BnW,gBAAiBiO,eAAKt9B,EAAM8D,QAAQorD,OAAOC,MAAO,IAClDC,UAAW,CACT//B,gBAAiBiO,eAAKt9B,EAAM8D,QAAQorD,OAAOC,MAAO,KAEpDp5C,YAAa/V,EAAM0E,QAAQ,GAC3Bmc,WAAY,EACZ9f,MAAO,QACNf,EAAMqvD,YAAYC,GAAG,MAAQ,CAC5BzuC,WAAY7gB,EAAM0E,QAAQ,GAC1B3D,MAAO,SAGXqtD,YAAa,CACX/+B,gBAAiBiO,eAAKt9B,EAAM8D,QAAQorD,OAAOC,MAAO,IAClDC,UAAW,CACT//B,gBAAiBiO,eAAKt9B,EAAM8D,QAAQorD,OAAOC,MAAO,MAGtDI,UAAW,CACTpvD,MAAO,UACPY,MAAO,QAETyuD,WAAWjyD,OAAAszC,GAAA,EAAAtzC,CAAA,CACTkH,QAASzE,EAAM0E,QAAQ,EAAG,EAAG,EAAG,GAChC6I,WAAYvN,EAAMwqB,YAAYoJ,OAAO,SACrC7yB,MAAO,QACNf,EAAMqvD,YAAYC,GAAG,MAAQ,CAC5BvuD,MAAO,MAGXotD,WAAY,CACVptD,MAAOf,EAAM0E,QAAQ,GACrBpE,OAAQ,OACRC,SAAU,WACVkvD,cAAe,OACfnuD,QAAS,OACT2D,WAAY,SACZyqD,eAAgB,aA8DLC,GAvDY,SAAAluD,GAA6E,IAA1E4+B,EAA0E5+B,EAA1E4+B,UAAWr9B,EAA+DvB,EAA/DuB,SAAUwC,EAAqD/D,EAArD+D,SAAUhC,EAA2C/B,EAA3C+B,QAAS4c,EAAkC3e,EAAlC2e,aAAcsuC,EAAoBjtD,EAApBitD,cAC5EtnD,EAAWxJ,mBACX2E,EAAUysD,KAEVY,EAAqB97C,sBACzBC,aAASvO,EAAU,KACnB,CAACA,IASH,OANAwO,0BAAgB,WACV5M,EAAStJ,UAAYuiC,IACvBv6B,QAAQC,IAAI,gBACZqB,EAAStJ,QAAQ+xD,SAElB,CAACxvB,IAEFx9B,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWC,KAAWnB,EAAQgC,KAAMmqD,EAAgBnsD,EAAQ6rD,YAAc,MAAO5qD,QAASA,GAC7FX,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQ4rD,YACtBtrD,EAAAlD,EAAAmD,cAACgtD,GAAAnwD,EAAD,OAEFkD,EAAAlD,EAAAmD,cAACitD,GAAA,EAAD,CACE1vB,WAAYr9B,GAAYq9B,EACxBp5B,WAAY,CACV0wC,OAAQ,cAKVnyC,SAAU,SAAC9C,GAETktD,EAAmBltD,EAAE8M,OAAO3J,QAE9BjB,YAAY,eACZ5B,SAAUA,EACVod,aAAcA,EAEdhZ,SAAUA,EACV7E,QAAS,CACPgC,KAAMhC,EAAQgtD,UACd1qD,MAAOtC,EAAQitD,gBCjBnB1vD,GAAYC,aAnEJ,SAAAC,GAAK,MAAK,CACtBuE,KAAM,CACJpD,OAAQ,EACRsD,QAASzE,EAAM0E,QAAQ,IAEzBsrD,cAAe,CACb1uD,QAAS,OACTP,MAAO,QAETktB,KAAM,CAAEzhB,SAAU,GAClByjD,YAAa,CACXxrD,QAASzE,EAAM0E,QAAQ,GAAK,KAE9BwrD,aAAc,CACZ/vD,MAAO,QACPE,WAAYgQ,KAAO2C,OAAO7S,MAAM,MAElCgwD,cAAe,CACbhwD,MAAO,QACPE,WAAYgQ,KAAOyC,QAAQ3S,MAAM,MAEnCiwD,WAAY,CACVjwD,MAAO,QACPE,WAAYgQ,KAAOsC,KAAKxS,MAAM,MAEhC+M,IAAK,CACHmjD,cAAe,MACfC,UAAW,QACXhwD,OAAQ,OACRS,MAAO,QAETkW,KAAM,CACJ3W,OAAQ,QACRa,OAAQ,EACRsD,QAASzE,EAAM0E,QAAQ,EAAG,GAC1Bka,UAAW,aACXtd,QAAS,OACTV,cAAe,UAEjB2vD,UAAW,CACTjV,aAAc,WACdzkC,WAAY,SACZ3R,SAAU,UAEZsrD,cAAe,CACblvD,QAAS,QAEXmvD,UAAW,CACTloD,WAAY,OACZvD,KAAM,YAER0rD,SAAU,GAGVC,UAAW,CACTnkD,SAAU,EACVnM,WAAYL,EAAM8D,QAAQmT,KAAKrK,SAEjCgkD,aAAc,CACZ5rD,KAAM,YACN4Z,UAAW,aACXte,OAAQ,OACR6tB,UAAW,IACX7sB,QAAS,OACTV,cAAe,aAKbiwD,GAAiB,SAAApvD,GAA0E,IAAvE8sB,EAAuE9sB,EAAvE8sB,OAAQyX,EAA+DvkC,EAA/DukC,QAASxiC,EAAsD/B,EAAtD+B,QAAS8D,EAA6C7F,EAA7C6F,SAAUwpD,EAAmCrvD,EAAnCqvD,cAAeC,EAAoBtvD,EAApBsvD,cACrExuD,EAAUzC,KACRqJ,EAAiBwB,qBAAWkzB,GAA5B10B,aACR,GAAI68B,IAAYzX,EAAQ,MAAO,aAC/B,IAAI3N,EAAQ,KACRqvC,EAAc5/C,KAAOyC,QAAQ9O,MACjC,IACE4c,EAAQzX,EAAamF,YAAYigB,EAAOk5B,SAAU,SAClDwI,EAAc1hC,EAAOR,OAAS1d,KAAOke,EAAOR,QAAQ/pB,MAAQqM,KAAOyC,QAAQ9O,MAE7E,MAAOtB,GACLoD,QAAQqJ,MAAMzM,GAEhB,OACEG,EAAAlD,EAAAmD,cAACumB,GAAA,EAAD,CAAU5lB,UAAWlB,EAAQgC,KAAM2yB,QAAM,EAAC5uB,UAAU,MAAMo+B,gBAAc,GACtE7jC,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQquD,cACtB/tD,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQouD,WACtB9tD,EAAAlD,EAAAmD,cAAA,OAAKkM,IAAI,YAAYK,IAAKuR,EAAOnd,UAAWlB,EAAQ2K,IAAK1J,QAASA,KAEnE+qB,EAAOR,QACNlrB,EAAAlD,EAAAmD,cAAC4E,GAAA,EAAD,CAAYjE,UAAWC,KAAWnB,EAAQ0tD,YAAa1tD,EAAO,SAAAnB,OAAUmtB,EAAOR,UAC7E5jB,QAAQ,UACR7B,UAAU,OAFZ,GAAAlH,OAIMmtB,EAAO84B,YAAc,EAJ3B,eAIuCxkD,EAAAlD,EAAAmD,cAAA,cAAMmtD,EAAN,OAI3CptD,EAAAlD,EAAAmD,cAACwmB,GAAA,EAAD,CAAc7lB,UAAWlB,EAAQ0U,KAAM+H,mBAAiB,EAACxb,QAASA,GAChEX,EAAAlD,EAAAmD,cAAC4E,GAAA,EAAD,CAAYyC,QAAQ,QAAQ7B,UAAU,MAAM7E,UAAWlB,EAAQguD,WAC5DhiC,EAAO5V,MAAQqtB,GAElBnjC,EAAAlD,EAAAmD,cAAC4E,GAAA,EAAD,CAAYyC,QAAQ,QAAQ7B,UAAU,OACpCzF,EAAAlD,EAAAmD,cAAA,6BADF,IACgCyrB,EAAOszB,YAAYsG,UAEnDtlD,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQ0rB,OACvB6iC,GAAiBjuD,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQiuD,eACxC3tD,EAAAlD,EAAAmD,cAAC4E,GAAA,EAAD,CAAYyC,QAAQ,UAAU1G,UAAWlB,EAAQkuD,WAAjD,YACA5tD,EAAAlD,EAAAmD,cAAC4E,GAAA,EAAD,CAAYyC,QAAQ,UAAU1G,UAAWlB,EAAQmuD,UAAW/oC,aAAW4G,EAAO25B,UAAW,SAE1F6I,GAAiBluD,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQiuD,eACxC3tD,EAAAlD,EAAAmD,cAAC4E,GAAA,EAAD,CAAYyC,QAAQ,UAAU1G,UAAWlB,EAAQkuD,WAAjD,eACA5tD,EAAAlD,EAAAmD,cAAC4E,GAAA,EAAD,CAAYyC,QAAQ,UAAU1G,UAAWlB,EAAQmuD,UAAW/oC,aAAW4G,EAAOyiC,OAAOnoC,QAAS,UAIjGvhB,IAcP2pD,GAAA,wBC5HMnxD,GAAYC,aANJ,SAAAC,GAAK,MAAK,CACtBuE,KAAM,MAuCO2sD,GAhCS,SAAAzvD,GAA2D,IAAxD0vD,EAAwD1vD,EAAxD0vD,YAAahE,EAA2C1rD,EAA3C0rD,kBAAmBiE,EAAwB3vD,EAAxB2vD,SACnD7uD,GAD2Ed,EAAd2H,QACnDtJ,MAEhB,OADAgG,QAAQC,IAAI,mBAAoB,CAAEorD,cAAahE,sBAE7CtqD,EAAAlD,EAAAmD,cAACqmB,GAAA,EAAD,KACEtmB,EAAAlD,EAAAmD,cAACumB,GAAA,EAAD,CAAU5lB,UAAWlB,EAAQgC,MAC3B1B,EAAAlD,EAAAmD,cAACq1C,GAAA,EAAD,CAAc30C,QAAS4tD,GACrBvuD,EAAAlD,EAAAmD,cAACuuD,GAAA1xD,EAAD,OAEFkD,EAAAlD,EAAAmD,cAACwmB,GAAA,EAAD,CACE9lB,QAAS4tD,EACTxkD,QAAO,GAAAxL,OAAK+vD,EAAL,iBACPtkD,UAAS,cAAAzL,OAAgB+rD,EAAhB,qBAAA/rD,OAA2E,IAAtB+rD,EAA0B,GAAK,+BCuDjGrtD,GAAYC,aA7EJ,SAAAC,GAAK,MAAK,CACtBuE,KAAM,CACJpE,MAAOH,EAAM8D,QAAQ8I,QAAQqL,KAC7BlX,MAAO,IACPR,SAAU,WACVE,IAAK,MACLD,KAAM,MACNkM,UAAW,SACXwL,gBAAiB,UACjBjL,UAAW,qCAEbkL,WAAY,CACV/S,OAAQ,KAEVuH,KAAM,GAINvI,OAAQ,CACN7D,SAAU,WACVY,OAAQ,SACRd,WAAY,QACZF,MAAO,QACP4c,OAAQ,kBACRzc,OAAQ,GACRS,MAAO,GACPqE,OAAQ,IACRksD,WAAY,CAAEjxD,WAAYgQ,KAAO2C,OAAO7S,OACxCoxD,YAAa,CAAElxD,WAAYgQ,KAAOyC,QAAQ3S,OAC1CqxD,SAAU,CAAEnxD,WAAYgQ,KAAOsC,KAAKxS,QAEtCsxD,aAAc,CACZpxD,WAAY,UACZF,MAAO,QACP4c,OAAM,kBACNu0C,WAAY,CAAEjxD,WAAY,WAC1BkxD,YAAa,CAAElxD,WAAY,WAC3BmxD,SAAU,CAAEnxD,WAAY,YAE1BqxD,MAAO,CACLtsD,OAAQ,IACRjF,MAAOH,EAAM8D,QAAQ+I,UAAU0L,aAC/BlY,WAAYL,EAAM8D,QAAQ+I,UAAUoL,KACpChL,UAAW,iCAEb0kD,YAAa,CACXxxD,MAAOH,EAAM8D,QAAQ8I,QAAQ2L,aAC7BlY,WAAYL,EAAM8D,QAAQ8I,QAAQqL,MAEpCS,mBAAoB,CAClBnY,SAAU,WACVE,IAAK,GACLD,KAAM,MAGN4E,OAAQ,KAEVuT,KAAM,CACJxY,MAAO,QACPoI,WAAY,OACZqQ,WAAU,sEAIVxT,OAAQ,IACR7E,SAAU,YAGZsY,WAAY,CACV1Y,MAAO,QACPyY,WAAU,wFAoDCG,GA3CA,SAAAtX,GAA8D,IAA3DkX,EAA2DlX,EAA3DkX,KAAMoV,EAAqDtsB,EAArDssB,OAAQvqB,EAA6C/B,EAA7C+B,QAASg7C,EAAoC/8C,EAApC+8C,OAAQ6I,EAA4B5lD,EAA5B4lD,WAAYruC,EAAgBvX,EAAhBuX,UACrDzW,EAAUzC,KAChB,OACE+C,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWC,KAAWnB,EAAQgC,KAAMi6C,EAASj8C,EAAQ4V,WAAa,KAAM4V,IAC3ElrB,EAAAlD,EAAAmD,cAAC03C,GAAA,EAAD,CAAOj4C,QAAS,CAAEmvD,MAAOhuD,KAAWnB,EAAQmvD,MAAOlT,EAASj8C,EAAQovD,YAAc,KAAM5jC,IAAW0sB,aAAc4M,GAC/GxkD,EAAAlD,EAAAmD,cAACuB,GAAA,EAAD,CAAQZ,UAAWC,KAAWnB,EAAQ6B,OAAQo6C,EAASj8C,EAAQkvD,aAAe,KAAM1jC,GAASvqB,QAASA,GACpGX,EAAAlD,EAAAmD,cAAC+2B,GAAAl6B,EAAD,CAAQ8D,UAAWlB,EAAQoK,KAAMxM,MAAM,cAG1C6Y,GAAaA,GAAa,EACzBnW,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQmW,oBACtB7V,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQ+W,OACtBL,QAAQ,MACRlY,MAAM,MACNT,OAAO,MACP4Y,QAAQ,iBACRrV,MAAO,CAAEoJ,UAAS,6CAAA7L,OAA+C4X,EAA/C,UAClBnW,EAAAlD,EAAAmD,cAAA,QAAMgN,EAAE,mGACN2I,KAAK,UACLc,YAAY,QACZf,YAAY,IACZgB,cAAc,MACdlB,OAAO,cAIX,KACJzV,EAAAlD,EAAAmD,cAAC4E,GAAA,EAAD,CAAYyC,QAAQ,QAAQ1G,UAAWC,KAAWnB,EAAQoW,KAAM6lC,EAASj8C,EAAQsW,WAAa,OAC3FF,0BChGH7Y,GAAYC,aAbJ,SAAAC,GAAK,MAAK,CACtBoE,OAAQ,CACN/D,WAAYL,EAAM8D,QAAQkF,KAAK,KAC/B+T,OAAM,aAAA3b,OAAepB,EAAM8D,QAAQkF,KAAK,MACxC7I,MAAOH,EAAM8D,QAAQkF,KAAK,MAE5ByoD,aAAc,CACZpxD,WAAY,UACZ0c,OAAM,kBACN5c,MAAO,QACPiF,OAAQ,QAoBGwsD,GAfC,SAAAnwD,GAAsC,IAAnC0vD,EAAmC1vD,EAAnC0vD,YAAa3S,EAAsB/8C,EAAtB+8C,OAAQh7C,EAAc/B,EAAd+B,QAChCjB,EAAUzC,KAChB,OACE+C,EAAAlD,EAAAmD,cAACuB,GAAA,EAAD,CAAQb,QAASA,EAASC,UAAWC,KAAWnB,EAAQ6B,OAAQo6C,EAASj8C,EAAQkvD,aAAe,OAC7FI,KAAQV,GAAat7B,OAAO,SCF7B/1B,GAAYC,aTzBH,SAAAC,GAAK,MAAK,CACvBuE,KAAM,CACJhE,SAAU,WACVD,OAAQ,OACRwxD,iBAAkB,CAChB1sD,OAAQ,GAEV2sD,kBAAmB,CACjB3sD,OAAQ,GAEV4sD,mBAAoB,CAClB5sD,OAAQ,IAGZsY,IAAK,CACHrd,WAAYL,EAAM8D,QAAQ+I,UAAUoL,KACpC9X,MAAOH,EAAM8D,QAAQ+I,UAAU0L,cAEjC05C,OAAQ,CACN1xD,SAAU,WACV6E,OAAQ,IACR3E,IAAK,GAEPyxD,eAAgB,CACd3xD,SAAU,WACVJ,MAAOH,EAAM8D,QAAQmT,KAAKrK,QAC1BH,QAAS,GACTrH,OAAQ,IACRsH,UAAW,SACXjM,IAAK,MACLD,KAAM,MACNyM,UAAW,qCAEbklD,WAAY,CACVhxD,OAAQnB,EAAM0E,QAAQ,IACtBD,QAASzE,EAAM0E,QAAQ,IACvBqY,OAAQ,YACRyoB,aAAcxlC,EAAM0E,QAAQ,GAC5BrE,WAAYL,EAAM8D,QAAQorD,OAAOC,MACjC/uD,SAAU,GACVG,SAAU,WACV6E,OAAQ,IACRlC,OAAQlD,EAAM0E,QAAQ,GACtB7D,MAAOb,EAAM0E,QAAQ,KAEvB0tD,cAAe,CAEbrxD,MAAO,MACPge,SAAU,IACV3Z,OAAQ,IACR7E,SAAU,WACV2C,OAAQlD,EAAM0E,QAAQ,GACtBlE,KAAM,MACN0X,gBAAiB,SACjBjL,UAAW,sCS3BTolD,GAAc,CAClBlnC,KAAM,EACNnuB,SAAU,UACVC,WAAY,YAwSCq1D,GAnSC,SAAA7wD,GAIV,IAHJ8wD,EAGI9wD,EAHJ8wD,WAAYtoC,EAGRxoB,EAHQwoB,aAAc+b,EAGtBvkC,EAHsBukC,QAASuK,EAG/B9uC,EAH+B8uC,aAAcka,EAG7ChpD,EAH6CgpD,aACjD+H,EAEI/wD,EAFJ+wD,cAAeC,EAEXhxD,EAFWgxD,cACAC,GACXjxD,EADJkxD,cACIlxD,EADWixD,gBACXh2D,GAAA+E,EAD2BmxD,gBAEKj2D,mBAAS,CAC3Cgd,SAASpc,OAAA2J,EAAA,EAAA3J,CAAA,GAAM80D,GAAgBpoC,EAAatQ,UAC5C1W,OAAQgnB,EAAahnB,OACrBqnD,aAAc,QAJZhtD,EAAAC,OAAAsN,GAAA,EAAAtN,CAAAb,EAAA,GACGm2D,EADHv1D,EAAA,GACew1D,EADfx1D,EAAA,GAOEiF,EAAUzC,KACVizD,EAAan1D,mBARfa,EAS0C9B,oBAAS,GATnDmC,EAAAvB,OAAAsN,GAAA,EAAAtN,CAAAkB,EAAA,GASGqsB,EATHhsB,EAAA,GASoBisB,EATpBjsB,EAAA,GAUEk0D,EAAsBp1D,mBAVxBgQ,EAYkCjR,mBAAS,GAZ3CkR,EAAAtQ,OAAAsN,GAAA,EAAAtN,CAAAqQ,EAAA,GAYG28C,EAZH18C,EAAA,GAYgBolD,EAZhBplD,EAAA,GAAAG,EAakCrR,mBAAS,MAb3CsR,EAAA1Q,OAAAsN,GAAA,EAAAtN,CAAAyQ,EAAA,GAaGwc,EAbHvc,EAAA,GAagBilD,EAbhBjlD,EAAA,GAAAklD,EAcoCx2D,qBAdpCy2D,EAAA71D,OAAAsN,GAAA,EAAAtN,CAAA41D,EAAA,GAcGE,EAdHD,EAAA,GAciBE,EAdjBF,EAAA,GAiBI3H,EAA0BpB,GAChCkI,GAAc,GACdM,EAAWvI,aACXC,EACAsI,EAAWl5C,SA3BG,GA6Bd8wC,GANMgB,sBAWRvtD,oBAAU,WACR,GAAKqyC,GAAiBgiB,IAAcc,EACpC,IACE,IAAMhrD,EAAWkqD,EAAW19C,KAAK,SAAAsxC,GAAC,OAAIA,EAAEliD,KAAOssC,IAE/C,GAAIloC,GAAYA,EAASpK,OAAQ,CAC/B,IAAMs1D,EAAYC,kBAAOvH,iBAAM5jD,EAASpK,QAAS,GAAI,CAAEw1D,MAAO,WACxDxwD,EAASywD,gBAAKH,GACpBT,EAAcv1D,OAAA2J,EAAA,EAAA3J,CAAA,GAAKs1D,EAAN,CAAkB5vD,aAGnC,MAAOP,GACLoD,QAAQqJ,MAAMzM,KAEf,CAAC6vD,IAEJr0D,oBAAU,WACR,GAAKqyC,GAAiBkb,EAAsBb,SAAUyI,EACtD,IACE,IAAMhrD,EAAWojD,EAAsBb,OAAO/1C,KAAK,SAAAsxC,GAAC,OAAIA,EAAE2F,WAAW7nD,KAAOssC,IACxEloC,GAAY2qD,EAAoBl1D,SAASw1D,EAAgBjrD,GAE/D,MAAO3F,GACLoD,QAAQqJ,MAAMzM,KAEf,CAAC+oD,EAAsBb,SAE1B,IAQM+I,EAAqB,SAACC,GAE1BN,EAAgBM,GAVF,WAAM,IAAAnsD,EAC4CsrD,EAAWj1D,QAAUi1D,EAAWj1D,QAAU+0D,EAAWl5C,SAA7G3c,EADYyK,EACZzK,SAAUC,EADEwK,EACFxK,UAAWkuB,EADT1jB,EACS0jB,KAAM2B,EADfrlB,EACeqlB,QAASC,EADxBtlB,EACwBslB,MAAOlwB,EAD/B4K,EAC+B5K,SACnDuS,WAAW,kBAAMsjD,EAAe,CAC9B/4C,SAAU,CAAE3c,WAAUC,YAAWkuB,OAAM2B,UAASC,QAAOlwB,eACrD,KAOJg3D,IAGIzC,EAAW,SAAC0C,GAChB,IACE,IAAMC,EAAM7G,6BAAkB4G,EAAOhI,WAAWsB,QAC1CnqD,EAASywD,gBAAKK,GAEdC,EAAoC,IAAzB/wD,EAAO,GAAKA,EAAO,IAC9BgxD,EAAoC,IAAzBhxD,EAAO,GAAKA,EAAO,IAC9BixD,EAAa,CACjBjxD,EAAO,GAAK+wD,EACZ/wD,EAAO,GAAKgxD,EACZhxD,EAAO,GAAK+wD,EACZ/wD,EAAO,GAAKgxD,GAGdf,EAAe,CACbzmC,mBAAoB,IACpBC,uBAAwB,IAAIC,KAC5BC,iBAAkBC,OAEpBimC,EAAcv1D,OAAA2J,EAAA,EAAA3J,CAAA,GAAKs1D,EAAN,CAAkB5vD,OAAQixD,KACnCJ,EAAOhI,WAAWlT,MAAQ,GAAGxpC,WAAW,kBAAMukD,EAAmB,OAAO,KAE9E,MAAOjxD,GACLoD,QAAQqJ,MAAMzM,KA8CZyxD,EAAgB,SAACje,GAEjBmd,GAAgBA,EAAavH,WAAW7nD,KAAOiyC,EAAI4V,WAAW7nD,GAEhEmtD,EAASiC,IAITH,EAAe,CACbzmC,mBAAoB,IACpBC,uBAAwB,IAAI0nC,KAC5BxnC,iBAAkBC,OAEpBimC,EAAc,CACZn5C,SAAU,CACR1c,UAAWi5C,EAAIoX,SAASC,YAAY,GACpCvwD,SAAUk5C,EAAIoX,SAASC,YAAY,OAIzCoG,EAAmBzd,IAIfme,EAAkB/5C,kBAAQ,oBAAAlZ,OAAA7D,OAAAiO,GAAA,EAAAjO,CAC3BkuD,EAAsBb,OAAOjlD,IAAI,SAAAuwC,GAAG,OACrCrzC,EAAAlD,EAAAmD,cAACyX,GAAA,EAAD,CACE9W,UAAW,eACX6G,IAAG,UAAAlJ,OAAY80C,EAAI4V,WAAW7nD,IAC9BjH,SAAUk5C,EAAIoX,SAASC,YAAY,GACnCtwD,UAAWi5C,EAAIoX,SAASC,YAAY,GACpC+G,WAAY,EACZC,WAAY,IAEZ1xD,EAAAlD,EAAAmD,cAAC0xD,GAAD,CAAc77C,KAAMu9B,EAAI4V,WAAWnzC,KACjCoV,OAAQmoB,EAAI4V,WAAW/9B,OACvBs5B,WAAYnR,EAAI4V,WAAWzE,WAC3B7jD,QAAS,kBAAM2wD,EAAcje,IAC7Bl9B,UAAWuxC,EAAc,IAAMrU,EAAI4V,WAAW9yC,UAAYk9B,EAAI4V,WAAW9yC,UAAY,KACrFwlC,OAAQ6U,GAAgBA,EAAavH,WAAW7nD,KAAOiyC,EAAI4V,WAAW7nD,SAf9C1G,OAAAiO,GAAA,EAAAjO,CAmB3BkuD,EAAsBZ,QAAQllD,IAAI,SAAAuwC,GAAG,OACtCrzC,EAAAlD,EAAAmD,cAACyX,GAAA,EAAD,CACE9W,UAAU,gBACV6G,IAAG,WAAAlJ,OAAa80C,EAAI4V,WAAW7nD,IAC/BjH,SAAUk5C,EAAIoX,SAASC,YAAY,GACnCtwD,UAAWi5C,EAAIoX,SAASC,YAAY,GACpC+G,YAAa,GACbC,WAAY,IAEZ1xD,EAAAlD,EAAAmD,cAAC2xD,GAAD,CACEtD,YAAajb,EAAI4V,WAAWlT,MAC5ByO,WAAYnR,EAAI4V,WAAWqB,kBAC3B3pD,QAAS,kBAAM2wD,EAAcje,IAC7BsI,OACE6U,GACAA,EAAavH,WAAW7nD,KAAOiyC,EAAI4V,WAAW7nD,IAC9CovD,EAAavH,WAAWlT,QAAU1C,EAAI4V,WAAWlT,cAKvD,CAAC6S,EAAuB4H,IAEtBqB,EAAqBp6C,kBAAQ,mBAAQ+4C,GACzCxwD,EAAAlD,EAAAmD,cAAC8E,GAAA,EAAD,CAAOnE,UAAWlB,EAAQ6vD,eACW,IAAlCiB,EAAavH,WAAWlT,MACrB/1C,EAAAlD,EAAAmD,cAACmuD,GAAD,CACA1iC,OAAQ8kC,EAAavH,WACrBgF,eAAa,EACbC,eAAa,EACbvtD,QAAS,kBAAMgvD,EAAca,EAAavH,WAAW7nD,OAErDpB,EAAAlD,EAAAmD,cAAC6xD,GAAD,CACAxD,YAAakC,EAAavH,WAAWlT,MACrCuU,kBAAmBkG,EAAavH,WAAWqB,kBAC3C/jD,QAAS,kBAAMuqD,EAAmB,OAClCvC,SAAU,kBAAMA,EAASiC,QAI9B,CAACA,IAEJ,OACExwD,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQgC,KAAMwD,IAAKirD,GACjCnwD,EAAAlD,EAAAmD,cAACgsD,GAAD,CAAQJ,eAAa,EAACjrD,UAAWlB,EAAQ0vD,QACvCpvD,EAAAlD,EAAAmD,cAAC8xD,GAAD,CACElG,eAAa,EACblrD,QAASivD,EACTryC,aAAc,MAGjB4lB,GACCnjC,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQ2vD,gBACtBrvD,EAAAlD,EAAAmD,cAAC2/C,GAAA,EAAD,CAAkB9zC,KAAM,GAAI+zC,UAAW,EAAGviD,MAAM,aAKpD0C,EAAAlD,EAAAmD,cAACyY,GAAA,EAADhe,OAAAqG,OAAA,CACE+X,QAAM,EAENhC,SAAUk5C,EAAWl5C,SACrB6Q,YAAaA,EACb5Q,UAAW9I,KACX4I,eAAgB,CAAEjZ,IAAK,IACvBya,UAAWpK,KAAU5G,OAAS,EAAI,EAAI,GA9G/B,GAuGT,CASEmgB,kBAAmB,WAEjBU,GAAmB,IAErBR,gBAAiB,WAEfQ,GAAmB,GACnBmoC,EAAe,OAEjBjwD,OAAQ4vD,EAAW5vD,OACnB4xD,QAAS,GACTC,QAAS,EACTj5C,iBApKmB,SAAAlU,GAAuB,IAApBgS,EAAoBhS,EAApBgS,SAAUhU,EAAUgC,EAAVhC,IACpCotD,EAAWj1D,QAAU6b,EAarB,IAAMo7C,EAAWplD,KAAK4jC,MAAM55B,EAASwR,MACrC,IAAKL,GAAmBnlB,GAAOA,EAAIqvD,UAAW,KAAAC,EAEqCtvD,EAAIqvD,YAFzCE,EAAAD,EAEpCE,IAAYC,EAFwBF,EAE7BG,IAAkBC,EAFWJ,EAEhBK,IAFgBC,EAAAP,EAEDQ,IAAYC,EAFXF,EAEMH,IAAkBM,EAFxBH,EAEmBD,IAFnBztD,EAGS+qD,EAAWvI,cAAgB,CAAC8K,EAAQE,EAAQI,EAAQC,GAH7D3tD,EAAAzK,OAAAsN,GAAA,EAAAtN,CAAAuK,EAAA,GAGrC8tD,EAHqC5tD,EAAA,GAG1B6tD,EAH0B7tD,EAAA,GAGf8tD,EAHe9tD,EAAA,GAGJ+tD,EAHI/tD,EAAA,GAI5C,GAAI+sD,IAAaxK,GACfqL,GAAaR,GAAUS,GAAaP,GACpCQ,GAAaJ,GAAUK,GAAaJ,EACpC,CAEA,IAAMrL,EAAe,CACnB8K,GAAUM,EAASN,GAAU,EAC7BE,GAAUK,EAASL,GAAU,EAC7BI,GAAUA,EAASN,GAAU,EAC7BO,GAAUA,EAASL,GAAU,GAE/BxC,EAAcv1D,OAAA2J,EAAA,EAAA3J,CAAA,GAAKs1D,EAAN,CAAkBvI,mBAG/ByK,IAAaxK,GACf0I,EAAe8B,IAmIbiB,cAAe,WACT3C,GAAcM,EAAmB,SAGtCU,GAGFK,IC1SDuB,GAAgB,EAwDhBC,GAAgBlkD,YAAQ2pB,EAAW,CACvC15B,MAAO,SAAAwF,GAAwB,IAArBnE,EAAqBmE,EAArBnE,KAAMq+B,EAAel6B,EAAfk6B,SAsBd,OApBKr+B,EAAK0iC,UAAY1iC,EAAK6L,OAAS7L,EAAKq4B,WAAar4B,EAAKq4B,UAAUuqB,gBAAgBh8C,OAAS,GAAK5G,EAAKq4B,UAAUw6B,UAChH7yD,EAAK8yD,UAAU,CACbn0B,UAAU1kC,OAAA2J,EAAA,EAAA3J,CAAA,GAAM+F,EAAK2+B,UAAZ,CAAuBk0B,UAAW7yD,EAAKq4B,UAAUw6B,YAE1DE,YAAa,SAAC/yB,EAAD37B,GAA+B,IAAtB2uD,EAAsB3uD,EAAtB2uD,gBACpB,MAAO,CACL36B,UAAUp+B,OAAA2J,EAAA,EAAA3J,CAAA,GACL+4D,EAAgB36B,UADZ,CAEPuqB,gBAAe,GAAA9kD,OAAA7D,OAAAiO,GAAA,EAAAjO,CAAO+lC,EAAK3H,UAAUuqB,iBAAtB3oD,OAAAiO,GAAA,EAAAjO,CAA0C+4D,EAAgB36B,UAAUuqB,wBAMpF5iD,EAAK0iC,SAAW1iC,EAAK6L,MAC5BwyB,EAAS40B,eAAejzD,GAGxBq+B,EAAS40B,eAATh5D,OAAA2J,EAAA,EAAA3J,CAAA,GAA6B+F,EAA7B,CAAmCkzD,iBAAiB,KAE/C,MAET/wD,QAAS,CACPw8B,UAAW,CAAE+jB,MAAO,QAOlByQ,GAAgBzkD,YAAQ8pB,EAAW,CACvCqpB,KAAM,SAAAr9C,GAAA,OAAAA,EAAG4uD,WACTz0D,MAAO,SAAA+F,GAA0D,IAAvD1E,EAAuD0E,EAAvD1E,KAAuDqzD,EAAA3uD,EAAjD25B,SAAYi1B,EAAqCD,EAArCC,YAAaC,EAAwBF,EAAxBE,gBAKvC,GAJIvzD,EAAK6L,QACPrJ,QAAQC,IAAI,YAAazC,EAAK6L,MAAO7L,GACrCwC,QAAQqJ,MAAM7L,EAAK6L,SAEhB7L,EAAK0iC,SAAW1iC,EAAKwzD,eAAiBxzD,EAAKwzD,cAAc5Q,gBAAiB,CAE7E,IAAM1yB,EAAUlwB,EAAKwzD,cAAc5Q,gBAC7B6Q,EAAUH,EAAYj7B,UAAUuqB,gBAItC,GAAI5iD,EAAKwzD,cAAe,CACtB,IAAIE,EAAqBJ,EAAYj7B,UAAUuqB,gBAC/C1yB,EAAQsf,QAAQ,SAAAtqC,GAAuC,IAApCyuD,EAAoCzuD,EAApCyuD,aAAiBC,EAAmB35D,OAAA2E,EAAA,EAAA3E,CAAAiL,EAAA,kBACrD,GAAqB,YAAjByuD,EACFnxD,QAAQC,IAAI,qCAAsCmxD,EAAajzD,IAC/D+yD,EAAqBD,EAAQxtD,OAAO,SAAA48C,GAAC,OAAIA,EAAEliD,KAAOizD,EAAajzD,SAE5D,CACH,IAAMoG,EAAM0sD,EAAQ/hD,UAAU,SAAAmiD,GAAE,OAAIA,EAAGlzD,KAAOizD,EAAajzD,KACvDoG,GAAO,GACTvE,QAAQC,IAAI,qCAAsCmxD,EAAajzD,IAC/D+yD,EAAqBD,EAAQpxD,IAAI,SAACyxD,EAAWC,GAAZ,OAAsBA,IAAUhtD,EAAM6sD,EAAeE,MAGtFtxD,QAAQC,IAAI,kCAAmCmxD,EAAajzD,IAC5D+yD,EAAkB,GAAA51D,OAAA7D,OAAAiO,GAAA,EAAAjO,CAAOw5D,GAAP,CAAgBG,KAGtCN,EAAYP,YAAY,SAAC/yD,EAAMmC,GAC7B,IAIE,OAHalI,OAAA2J,EAAA,EAAA3J,CAAA,GAAQ+F,GACbq4B,UAAUuqB,gBAAkB8Q,EACpCH,IACOvzD,EAET,MAAOZ,GAEL,OADAoD,QAAQqJ,MAAMzM,GACPY,QAMjB,OAAO,MAETmC,QAAS,SAAAshB,GAAA,MAAoB,CAC3Bkb,UAAW,CACT+jB,MAAO,IACP0Q,UAHK3vC,EAAG2vC,eASRY,GAAmBpB,GAAc,kBAAM,OACvCqB,GAAmBd,GAAc,kBAAM,OA8B9Br0B,gBA3BS,SAAC3kC,EAAOwE,GAG9B,MAAO,CAAEsuC,aAF6B9yC,EAAMwS,KAApCnS,QAAWyyC,aAEItmB,aADFxsB,EAAMkI,IAAI8tB,OAAO,GAAGyB,QAKhB,SAAAuf,GAAQ,MAAK,CACtC+iB,SAAU,CACRhF,cAAe,SAACjiB,GACdkE,EAASvF,GAAqBj/B,KAAKgB,cAAcK,OAAQ,CAAEi/B,mBAE7DkiB,cAAe,WACbhe,EAASvF,GAAqBj/B,KAAKgB,cAAcG,OAAQ,CAAEs7C,OAAQ,CAAE+K,IAAKxnD,KAAKyB,YAAYE,SAAUqF,KAAM,QAE7G07C,cAAe,WACble,EAASvF,OAEXwjB,eAAgB,SAACjjB,GACfgF,EAASvF,GAAuBO,KAElCmjB,gBAAiB,WACfne,EAASvF,UAKA9M,CA5KU,SAAA3gC,GAA8C,IAA3CwoB,EAA2CxoB,EAA3CwoB,aAAcsmB,EAA6B9uC,EAA7B8uC,aAAcinB,EAAe/1D,EAAf+1D,SAAe96D,EAC/BC,qBAD+BW,EAAAC,OAAAsN,GAAA,EAAAtN,CAAAb,EAAA,GAC9Dk6D,EAD8Dt5D,EAAA,GACjDi5D,EADiDj5D,EAAA,GAAAmB,EAElC9B,mBAAS,GAFyBmC,EAAAvB,OAAAsN,GAAA,EAAAtN,CAAAkB,EAAA,GAE9DgsD,EAF8D3rD,EAAA,GAEhDksD,EAFgDlsD,EAAA,GAG/D+3D,EAAkB,kBAAM7L,EAAWP,EAAe,IAClD1K,EAAWniD,mBAJoDgQ,EAKnCjR,mBAAS,MAL0BkR,EAAAtQ,OAAAsN,GAAA,EAAAtN,CAAAqQ,EAAA,GAK9D8oD,EAL8D7oD,EAAA,GAKnD6pD,EALmD7pD,EAAA,GAMrEkyC,EAASjiD,QAAU44D,EAGnB,IAAMiB,EAAiBr9C,kBAAQ,kBAAMzX,EAAAlD,EAAAmD,cAACw0D,GAAD,CAAkBf,eAAgBA,KAAoB,IACrFqB,EAAkBt9C,kBAAQ,kBAAMzX,EAAAlD,EAAAmD,cAACy0D,GAAD,CAAkBb,UAAWA,EAAWE,YAAaA,EAAaC,gBAAiBA,KAAqB,CAACH,IAkB/I,OAfAx4D,oBAAU,WACR,GAAK04D,EAKL,OADK7W,EAASjiD,SAAW84D,EAAYJ,kBAAiBzW,EAASjiD,QAAUmiD,YAHzE,WACMF,EAASjiD,SAAS45D,EAAapjC,OAAOl3B,KAAKC,MAAwB,IAAhB44D,MAEkD,IAAhBA,KACpF,WACDlW,EAASjiD,UACXgI,QAAQC,IAAI,oBACZq6C,cAAcL,EAASjiD,SACvBiiD,EAASjiD,QAAU,QAGtB,CAAC84D,IAGF/zD,EAAAlD,EAAAmD,cAACD,EAAAlD,EAAMupB,SAAP,KACGyuC,EACAC,EACD/0D,EAAAlD,EAAAmD,cAAC+0D,GAADt6D,OAAAqG,OAAA,CACE6mD,aAAcA,EACd8H,WAAYqE,GAAeA,EAAYj7B,UAAYi7B,EAAYj7B,UAAUuqB,gBAAkB,GAC3F3V,aAAcA,EACdtmB,aAAcA,EACd+b,QAAS4wB,GAAeA,EAAY5wB,SAChCwxB,gFCnCN13D,GAAYC,aAAW,SAAAC,GAAK,MAAK,CACrCuE,KAAM,GAGNuzD,WAAY,CACV33D,MAAOH,EAAM8D,QAAQ8I,QAAQ2L,aAC7BlY,WAAYL,EAAM8D,QAAQ8I,QAAQkM,MAEpC1U,OAAQ,CACN/D,WAAYL,EAAM8D,QAAQ8I,QAAQqL,MAEpC8/C,UAAW,CACT53D,MAAOH,EAAM8D,QAAQ8I,QAAQ2L,aAC7B1P,aAAc,GAEhBmvD,UAAW,CACT13D,OAAQ,OACRS,MAAO,OACPuvD,UAAW,YAIT2H,GAAoB,SAAAx2D,GAA4E,IAIjF4N,EAJQ5L,EAAyEhC,EAAzEgC,UAAW0G,EAA8D1I,EAA9D0I,QAASwO,EAAqDlX,EAArDkX,KAAM/F,EAA+CnR,EAA/CmR,YAAai7C,EAAkCpsD,EAAlCosD,SAAUrqD,EAAwB/B,EAAxB+B,QAAS6jB,EAAe5lB,EAAf4lB,SAC/E9kB,EAAUzC,KACZo4D,EAAUC,KAQd,OAAQhuD,GACN,IAAK,MACH+tD,EAAUE,KACV,MACF,IAAK,WACHF,EAAUC,KACV,MACF,IAAK,OACHD,EAAUrK,GAdKx+C,EAcgBw+C,EAdR,kBACzBhrD,EAAAlD,EAAAmD,cAACuB,GAAA,EAAD,CAAQZ,UAAWlB,EAAQ6B,QACzBvB,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQy1D,UAAWhpD,IAAI,UAAUK,IAAKA,OAYXgpD,KAK/C,OACEx1D,EAAAlD,EAAAmD,cAACumB,GAAA,EAAD,CACE5lB,UAAWC,KAAWD,EAAWlB,EAAQgC,KAAM8iB,EAAW9kB,EAAQu1D,WAAa,MAC/E5gC,SAAU1zB,EACVA,QAASA,GAETX,EAAAlD,EAAAmD,cAACw1D,GAAA,EAAD,KACEz1D,EAAAlD,EAAAmD,cAACuB,GAAA,EAAD,CAAQZ,UAAWlB,EAAQ6B,QACzBvB,EAAAlD,EAAAmD,cAACo1D,EAAD,CAAS/3D,MAAM,cAGnB0C,EAAAlD,EAAAmD,cAACwmB,GAAA,EAAD,CAActK,mBAAiB,GAC7Bnc,EAAAlD,EAAAmD,cAAC4E,GAAA,EAAD,CAAYyC,QAAQ,QAAQhK,MAAM,WAAWwY,GAC7C9V,EAAAlD,EAAAmD,cAAC4E,GAAA,EAAD,CAAYyC,QAAQ,QAAQhK,MAAM,WAAWyS,IAE9CyU,GACCxkB,EAAAlD,EAAAmD,cAACq1C,GAAA,EAAD,KACEt1C,EAAAlD,EAAAmD,cAACkH,GAAA,EAAD,CAAYxG,QAAS6jB,EAAU5jB,UAAWlB,EAAQw1D,WAChDl1D,EAAAlD,EAAAmD,cAACqB,GAAAxE,EAAD,CAAYQ,MAAM,gBAkB9Bo4D,GAAA,GC1FMz4D,GAAYC,aAAW,SAAAC,GAAK,MAAK,CACrCuE,KAAM,CACJjE,OAAQ,OACR+uB,gBAAiBrvB,EAAM8D,QAAQzD,WAAW8E,MAC1C5E,SAAU,WACVi4D,UAAW,SACXrxC,UAAW,UAEbsxC,YAAa,CACXppC,gBAAiB,WAEnBusB,gBAAiB,CACflvC,UAAW,SACXjI,QAASzE,EAAM0E,QAAQ,EAAG,GAC1BvE,MAAOH,EAAM8D,QAAQkF,KAAK,MAE5B0vD,GAAI,CACFrpC,gBAAiB,UACjB5qB,QAAS,MAkCEk0D,GA9Bc,SAAAl3D,GAA4D,IAAzD0I,EAAyD1I,EAAzD0I,QAAS67B,EAAgDvkC,EAAhDukC,QAAS4yB,EAAuCn3D,EAAvCm3D,eAAgBC,EAAuBp3D,EAAvBo3D,iBAC1Dt2D,EAAUzC,KAChB,OAAIkmC,EACKnjC,EAAAlD,EAAAmD,cAAC4E,GAAA,EAAD,CAAYjE,UAAWlB,EAAQq5C,gBAAiBzxC,QAAQ,MAAxD,gBAECyuD,GAA4C,IAA1BA,EAAe1uD,OAKzCrH,EAAAlD,EAAAmD,cAACqmB,GAAA,EAAD,CAAM1lB,UAAWlB,EAAQgC,MACtBq0D,EAAejzD,IAAI,SAACmzD,EAAIzuD,GAAL,OAClBxH,EAAAlD,EAAAmD,cAACy1D,GAADh7D,OAAAqG,OAAA,CACE0G,IAAG,OAAAlJ,OAASiJ,GACZF,QAASA,EACT3G,QAAS,kBAAMq1D,EAAiBC,KAC5BA,OAVHj2D,EAAAlD,EAAAmD,cAAC4E,GAAA,EAAD,CAAYjE,UAAWlB,EAAQq5C,gBAAiBzxC,QAAQ,MAAxD,MAAiEA,EAAjE,aChCLrK,GAAYC,aAAW,SAAAC,GAAK,MAAK,CACrCuE,KAAM,CACJmI,UAAW,SACXm5B,UAAW,SACXphC,QAASzE,EAAM0E,QAAQ,EAAG,OAoBfq0D,GAhBK,SAAAt3D,GAA2B,IAAxBoC,EAAwBpC,EAAxBoC,MAAO8I,EAAiBlL,EAAjBkL,KAAMsK,EAAWxV,EAAXwV,KAC5B1U,EAAUzC,KAChB,OACE+C,EAAAlD,EAAAmD,cAAC4E,GAAA,EAAD,CAAYjE,UAAWlB,EAAQgC,KAAM4F,QAAQ,YAAYhK,MAAM,gBAAgBmI,UAAU,MAAMzE,MAAOA,GACnG8I,EACAsK,ICNDnX,GAAYC,aAAW,SAAAC,GAAK,MAAK,CACrCuE,KAAM,CACJjE,OAAQ,OACRgB,QAAS,OACTV,cAAe,SACfsE,SAAU,UAEZ8zD,QAAS,CACPxsD,SAAU,GAEZ4c,KAAM,CACJ5c,SAAU,EACV6iB,gBAAiBrvB,EAAM8D,QAAQzD,WAAW8E,MAC1C5E,SAAU,WACVi4D,UAAW,SACXrxC,UAAW,UAEby0B,gBAAiB,CACflvC,UAAW,SACXjI,QAASzE,EAAM0E,QAAQ,EAAG,GAC1BvE,MAAOH,EAAM8D,QAAQkF,KAAK,MAE5ByvD,YAAa,CACXppC,gBAAiB,WAEnBqpC,GAAI,CACFrpC,gBAAiB,UACjB5qB,QAAS,MAuEEw0D,GAnEO,SAAAx3D,GAAyF,IAAtF0I,EAAsF1I,EAAtF0I,QAAS67B,EAA6EvkC,EAA7EukC,QAASusB,EAAoE9wD,EAApE8wD,WAAY2G,EAAwDz3D,EAAxDy3D,cAAe7xC,EAAyC5lB,EAAzC4lB,SAAU8xC,EAA+B13D,EAA/B03D,cAAe/C,EAAgB30D,EAAhB20D,UACvF7zD,EAAUzC,KACVs5D,EAAUx7D,mBACVy7D,EAAWz7D,mBAEX07D,EAAevlD,aAAS,WAC5B,IAAKiyB,GAAWowB,GAAaiD,EAASv7D,SAAWs7D,EAAQt7D,QAAS,KACxDy2D,EAAc8E,EAASv7D,QAAvBy2D,UADwDgF,EAE5BH,EAAQt7D,QAApC07D,EAFwDD,EAExDC,UAAWhmD,EAF6C+lD,EAE7C/lD,aAEf+gD,EAA2B,GADV/gD,EAAegmD,KAElC1zD,QAAQC,IAAI,SAAU,CAAEyN,eAAcgmD,YAAWjF,cACjD6B,OAGH,KAEHl4D,oBAAUo7D,EAAc,CAAC/G,IAEzB,IAAIx7C,EAAU,KA4Bd,OA3BIivB,EACFjvB,EACElU,EAAAlD,EAAAmD,cAAC4E,GAAA,EAAD,CAAYjE,UAAWlB,EAAQq5C,gBAAiBzxC,QAAQ,MAAxD,gBAGKooD,GAAcA,EAAWroD,OAAS,GACzC6M,EAAUw7C,EAAW5sD,IAAI,SAAC4oB,EAAQlkB,GAAT,OACvBxH,EAAAlD,EAAAmD,cAACmuD,GAAD,CACE3mD,IAAG,UAAAlJ,OAAYiJ,GACfkkB,OAAQA,EACR/qB,QAAS,kBAAM21D,EAAc5qC,EAAOtqB,KACpC6sD,eAAa,EACbC,eAAa,OAGTnJ,KACN/kD,EAAAlD,EAAAmD,cAAA,OAAKwH,IAAI,QAAQvC,IAAKsxD,GACpBx2D,EAAAlD,EAAAmD,cAAC22D,GAAD,CAAaxiD,KAAMm/C,EAAY,aAAe,sBAKlDr/C,EACElU,EAAAlD,EAAAmD,cAAC4E,GAAA,EAAD,CAAYjE,UAAWlB,EAAQq5C,gBAAiBzxC,QAAQ,MAAxD,mBAKFtH,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQgC,MACtB1B,EAAAlD,EAAAmD,cAACy1D,GAADh7D,OAAAqG,OAAA,CAAmBH,UAAWlB,EAAQy2D,SAAaE,EAAnD,CAAkE/uD,QAASA,EAASkd,SAAUA,KAC9FxkB,EAAAlD,EAAAmD,cAACqmB,GAAA,EAAD,CAAM1lB,UAAWlB,EAAQ6mB,KAAMswC,UAAW72D,EAAAlD,EAAAmD,cAAA,WAAQ62D,SAAUL,EAAcjyD,SAAU+xD,GACjFriD,KCxFHjX,GAAYC,aAAW,SAAAC,GAAK,MAAK,CACrCuE,KAAM,CACJiI,SAAU,EACV/H,QAAS,MACTnD,QAAS,OACTV,cAAe,SACf6L,QAAS,GACTC,UAAW,UAEbC,KAAM,CACJ5L,MAAO,OACPiE,KAAM,UACN7E,MAAOH,EAAM8D,QAAQ8I,QAAQ8pC,MAC7BjqC,QAAS,IAEXG,QAAS,CACP5H,KAAM,UACNjE,MAAO,QAET8L,UAAW,CACT7H,KAAM,UACNjE,MAAO,WA8BI64D,GA1BW,SAAAn4D,GAAkC,IAA/BkL,EAA+BlL,EAA/BkL,KAAMC,EAAyBnL,EAAzBmL,QAASC,EAAgBpL,EAAhBoL,UACpCtK,EAAUzC,KACV+5D,EAAkBltD,EACxB,OACE9J,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQgC,MACtB1B,EAAAlD,EAAAmD,cAAC+2D,EAAD,CAAiBp2D,UAAWlB,EAAQoK,OACnCC,GACC/J,EAAAlD,EAAAmD,cAAC4E,GAAA,EAAD,CAAYjE,UAAWlB,EAAQqK,QAASzC,QAAQ,MAC7CyC,GAGJC,GACChK,EAAAlD,EAAAmD,cAAC4E,GAAA,EAAD,CAAYjE,UAAWlB,EAAQsK,UAAW1C,QAAQ,MAC/C0C,KCbIitD,GA7BG,WAAM,IAAAp9D,EACIC,mBAAS,MADbW,EAAAC,OAAAsN,GAAA,EAAAtN,CAAAb,EAAA,GACfe,EADeH,EAAA,GACRI,EADQJ,EAAA,GAGhBy8D,EAAY,WAChBj0D,QAAQC,IAAI,UACZrI,EAAS,OAELs8D,EAAa,WACjBl0D,QAAQC,IAAI,WACZ,IAAMk0D,EAAU78D,KAAKC,MACrBK,EAASu8D,IAaX,OAVA/7D,oBAAU,WAIR,OAHAgB,OAAOC,iBAAiB,SAAU46D,GAClC76D,OAAOC,iBAAiB,UAAW66D,GAE5B,WACL96D,OAAOE,oBAAoB,SAAU26D,GACrC76D,OAAOE,oBAAoB,UAAW46D,KAEvC,IAEI,CACLE,OAAkB,OAAVz8D,EACR08D,MAAO18D,yBCRL28D,GAAOnqD,KAAKyB,YA2BZ5R,GAAYC,aAzBJ,SAAAC,GAAK,MAAK,CACtBuE,KAAM,CACJjE,OAAQ,OACRgB,QAAS,OACT4D,SAAU,SACVtE,cAAe,UAEjBy5D,KAAM,GAMNC,YAAa,CACX9tD,SAAU,EACVtH,SAAU,UAEZuyD,IAAK,CACHjrD,SAAU,GAEZyhB,KAAM,CACJzhB,SAAU,MAMR+tD,GAAS,SAAA94D,GAITA,EAHJ06C,WAGI,IAHQqe,EAGR/4D,EAHQ+4D,WAAYC,EAGpBh5D,EAHoBg5D,cAAeC,EAGnCj5D,EAHmCi5D,YAAaC,EAGhDl5D,EAHgDk5D,WACpDC,EAEIn5D,EAFJm5D,cAAehC,EAEXn3D,EAFWm3D,eAAgBiC,EAE3Bp5D,EAF2Bo5D,cAAe3B,EAE1Cz3D,EAF0Cy3D,cAC9ClzB,EACIvkC,EADJukC,QAAS6yB,EACLp3D,EADKo3D,iBAAkBiC,EACvBr5D,EADuBq5D,WAAY3B,EACnC13D,EADmC03D,cAAe/C,EAClD30D,EADkD20D,UAEhD7zD,EAAUzC,KAERo6D,EAAWJ,KAAXI,OAGRh8D,oBAAU,WACJ06D,IAAmBiC,GAA2C,IAA1BjC,EAAe1uD,QACrD2uD,EAAiBD,EAAe,KAEjC,CAACA,IAEJ,IAAIh0D,EAAc,GAClB,OAAQ41D,GACN,KAAKJ,GAAKzoD,IACR/M,EAAc,CAAEgI,QAAS,aAAcC,UAAW,uBAA0BF,KAAMyrD,MAClF,MACF,KAAKgC,GAAKvoD,KACRjN,EAAc,CAAEgI,QAAS,cAAeC,UAAW,6BAAgCF,KAAM0rD,MACzF,MACF,KAAK+B,GAAKxoD,SACRhN,EAAc,CAAEgI,QAAS,kBAAmBC,UAAW,0BAA6BF,KAAMwrD,MAO9F,IAAIphD,EAAU,KA0Cd,OA/BEA,EAVGmjD,EASIhB,GAAiB2B,EAEtBh4D,EAAAlD,EAAAmD,cAACi4D,GAAD,CACE5wD,QAASqwD,EACTx0B,QAASA,EACTmzB,cAAeA,EACf/C,UAAWA,EACX7D,WAAYsI,EACZ3B,cAAeA,EACf7xC,SAAU,kBAAMwxC,EAAiB,SAI9BD,EAEL/1D,EAAAlD,EAAAmD,cAACk4D,GAAD,CACEh1B,QAASA,EACT77B,QAASqwD,EACT5B,eAAgBA,EAChBC,iBAAkB2B,IAAeJ,GAAKxoD,SAAWkpD,EAAajC,IAI3D6B,EAAYxwD,OAAS,EAE1BrH,EAAAlD,EAAAmD,cAAC4E,GAAA,EAAD,sBAA2B,IAAAtG,OAAIu5D,EAAJ,MAAqB,OAIxC93D,EAAAlD,EAAAmD,cAACm4D,GAAsBr2D,GApC/B/B,EAAAlD,EAAAmD,cAACm4D,GAAD,CACEruD,QAAQ,kBACRC,UAAU,YACVF,KAAMuuD,OAqCVr4D,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQgC,MACtB1B,EAAAlD,EAAAmD,cAACgsD,GAAD,KACEjsD,EAAAlD,EAAAmD,cAAC8xD,GAAD,CACE5xD,UAAWk3D,EAEX10D,SAAUo1D,EACVx6C,aAAcu6C,KAGjBT,GACCr3D,EAAAlD,EAAAmD,cAAC66C,GAAA,EAAD,CACE93C,MAAO20D,EACPx3D,UAAWk3D,EACX10D,SAAU,SAAC9C,EAAG0jB,GAAJ,OAAYq0C,EAAcr0C,IACpC+0C,eAAe,UACf54D,QAAS,CAAE64D,cAAe74D,EAAQ83D,MAClCgB,UAAQ,GAERx4D,EAAAlD,EAAAmD,cAAC86C,GAAA,EAAD,CAAKn6C,UAAWlB,EAAQk1D,IAAK5xD,MAAOu0D,GAAKzoD,IAAK3N,MAAM,SACpDnB,EAAAlD,EAAAmD,cAAC86C,GAAA,EAAD,CAAKn6C,UAAWlB,EAAQk1D,IAAK5xD,MAAOu0D,GAAKxoD,SAAU5N,MAAM,WACzDnB,EAAAlD,EAAAmD,cAAC86C,GAAA,EAAD,CAAKn6C,UAAWlB,EAAQk1D,IAAK5xD,MAAOu0D,GAAKvoD,KAAM7N,MAAM,WAGzDnB,EAAAlD,EAAAmD,cAAA,OACEW,UAAWlB,EAAQ+3D,aAElBvjD,KAqBTwjD,GAAOpjD,aAAe,CACpBqjD,WAAYJ,GAAKkB,KACjBZ,YAAa,IAGAH,UCtFTgB,GAAgBvpD,YAAQsqB,EAAW,CACvCr6B,MAAO,SAAAwF,GAAc,IAAXnE,EAAWmE,EAAXnE,KACJA,EAAK6L,OAAOrJ,QAAQqJ,MAAM7L,EAAK6L,OAEnC,IAAIof,EAAS,KACb,IACOjrB,EAAK0iC,SAAY1iC,EAAK6L,QAAOof,EAASjrB,EAAKirB,QAElD,MAAO7rB,GACLoD,QAAQqJ,MAAM7L,GACdwC,QAAQqJ,MAAMzM,GAMhB,MAAO,CACLk2D,eALqBt1D,EAAKgG,KAAOhG,EAAKgG,KAAK3D,IAAI,SAAAgC,GAAA,IAAGgR,EAAHhR,EAAGgR,KAAMigC,EAATjxC,EAASixC,MAAT,MAAsB,CACrEjgC,OAAM/F,YAAW,KAAAxR,OAA+B,GAAxBuO,KAAK6rD,KAAK5iB,EAAQ,IAAzB,2BACb,GAIJ5S,QAAS1iC,EAAK0iC,QACdzX,WAIJ9oB,QAAS,SAAAqC,GAAA,IAAG6yD,EAAH7yD,EAAG6yD,WAAH,MAAqB,CAC5B14B,UAAW,CACTtgC,KAAMg5D,GAAcA,EAAWzwD,OAAS,EAAI,GAAKywD,EACjD3U,MAAO,QAKPyV,GAAiBzpD,YAAQ+qB,EAAY,CACzC96B,MAAO,SAAA+F,GAAc,IAAX1E,EAAW0E,EAAX1E,KACJA,EAAK6L,OAAOrJ,QAAQqJ,MAAM7L,EAAK6L,OAEnC,IAAIof,EAAS,KACb,IACOjrB,EAAK0iC,SAAY1iC,EAAK6L,QAAOof,EAASjrB,EAAKirB,QAElD,MAAO7rB,GACLoD,QAAQqJ,MAAM7L,GACdwC,QAAQqJ,MAAMzM,GAUhB,MAAO,CACLk2D,eARqBt1D,EAAKy5B,WAAaz5B,EAAKy5B,WAAWp3B,IAAI,SAAA6C,GAAA,IAAG2/C,EAAH3/C,EAAG2/C,SAAU0F,EAAbrlD,EAAaqlD,SAAU3F,EAAvB1/C,EAAuB0/C,UAAvB,MAA4C,CACvGvvC,KAAMwvC,EACNlkD,GAF2DuE,EAAkCvE,GAG7F2O,YAAW,UAAAxR,OAAYq0B,aAAayyB,IACpC2F,cACI,GAIJ7nB,QAAS1iC,EAAK0iC,QACdzX,WAGJ42B,KAAM,SAAAp+B,GAAA,IAAG4zC,EAAH5zC,EAAG4zC,WAAH,OAAqBA,GAAcA,EAAWzwD,OAAS,GAC7DzE,QAAS,SAAAuhB,GAAA,MAAqB,CAC5Bib,UAAW,CACTy5B,UAFK10C,EAAG2zC,WAGR3U,MAAO,QAKP2V,GAAc3pD,YAAQ2qB,EAAS,CACnC16B,MAAO,SAAAglB,GAAc,IAAX3jB,EAAW2jB,EAAX3jB,KACJA,EAAK6L,OAAOrJ,QAAQqJ,MAAM7L,EAAK6L,OAEnC,IAAIof,EAAS,KACb,IACOjrB,EAAK0iC,SAAY1iC,EAAK6L,QAAOof,EAASjrB,EAAKirB,QAElD,MAAO7rB,GACLoD,QAAQqJ,MAAM7L,GACdwC,QAAQqJ,MAAMzM,GAWhB,MAAO,CACLk2D,eATqBt1D,EAAKs4D,SAAWt4D,EAAKs4D,SAASj2D,IAAI,SAAA0/C,GAAA,IAAGwW,EAAHxW,EAAGwW,UAAH,MAAmD,CAC1GljD,KADuD0sC,EAAcpuC,KAErErE,YAFuDyyC,EAAoByW,UAG3EpI,KAHuDrO,EAA+BqO,KAItFqI,OAJuD1W,EAAqC0W,OAK5FF,eACI,GAIJ71B,QAAS1iC,EAAK0iC,QACdzX,WAGJ42B,KAAM,SAAAO,GAAA,IAAGiV,EAAHjV,EAAGiV,WAAH,OAAqBA,GAAcA,EAAWzwD,OAAS,GAC7DzE,QAAS,SAAA4gD,GAAA,MAAqB,CAC5BpkB,UAAW,CACTyqB,OAFKrG,EAAGsU,gBAYRqB,GAAgBhqD,YAAQoqB,EAAe,CAC3Cn6B,MAAO,SAAAwkD,GAAc,IAAXnjD,EAAWmjD,EAAXnjD,KACJA,EAAK6L,OAAOrJ,QAAQqJ,MAAM7L,EAAK6L,OAEnC,IAAIof,EAAS,KACb,IACOjrB,EAAK0iC,SAAY1iC,EAAK6L,QAAOof,EAASjrB,EAAKirB,QAElD,MAAO7rB,GACLoD,QAAQqJ,MAAM7L,GACdwC,QAAQqJ,MAAMzM,GAIhB,IAAM0zD,GAAY9yD,EAAK0iC,SAAY1iC,EAAK24D,WAAc34D,EAAK24D,UAAU9F,UAAmB,WACtFrwD,QAAQC,IAAI,YAAazC,GACzBA,EAAK8yD,UAAU,CACbn0B,UAAU1kC,OAAA2J,EAAA,EAAA3J,CAAA,GAAM+F,EAAK2+B,UAAZ,CAAuBk0B,UAAW7yD,EAAK24D,UAAU9F,YAE1DE,YAAa,SAAC/yB,EAADsjB,GAA+B,IAAtB0P,EAAsB1P,EAAtB0P,gBACpB,MAAO,CACL2F,UAAU1+D,OAAA2J,EAAA,EAAA3J,CAAA,GACL+4D,EAAgB2F,UADZ,CAEP/V,gBAAe,GAAA9kD,OAAA7D,OAAAiO,GAAA,EAAAjO,CAAO+lC,EAAK24B,UAAU/V,iBAAtB3oD,OAAAiO,GAAA,EAAAjO,CAA0C+4D,EAAgB2F,UAAU/V,yBATZ,KAoBjF,MAAO,CACL2U,cALoBv3D,EAAK24D,WAAa34D,EAAK24D,UAAU/V,gBACnD5iD,EAAK24D,UAAU/V,gBACf,GAIFkQ,YACApwB,QAAS1iC,EAAK0iC,QACdzX,WAGJ42B,KAAM,SAAA2B,GAAA,OAAAA,EAAGoS,eACTzzD,QAAS,SAAAuhD,GAAA,MAAwB,CAC/B/kB,UAAW,CACTtgC,IAFKqlD,EAAGkS,cAEWvgD,KACnBqtC,MAAO,QAKPkW,GAAiBlqD,YAAQgqB,EAAY,CACzC/5B,MAAO,SAAAklD,GAAc,IAAX7jD,EAAW6jD,EAAX7jD,KACJA,EAAK6L,OAAOrJ,QAAQqJ,MAAM7L,EAAK6L,OAEnC,IAAIof,EAAS,KACb,IACOjrB,EAAK0iC,SAAY1iC,EAAK6L,QAAOof,EAASjrB,EAAKirB,QAElD,MAAO7rB,GACLoD,QAAQqJ,MAAM7L,GACdwC,QAAQqJ,MAAMzM,GAIhB,IAAM0zD,GAAY9yD,EAAK0iC,SAAY1iC,EAAK04B,YAAe14B,EAAK04B,WAAWm6B,UAAmB,WACxFrwD,QAAQC,IAAI,YAAazC,GACzBA,EAAK8yD,UAAU,CACbn0B,UAAU1kC,OAAA2J,EAAA,EAAA3J,CAAA,GAAM+F,EAAK2+B,UAAZ,CAAuBk0B,UAAW7yD,EAAK04B,WAAWm6B,YAE3DE,YAAa,SAAC/yB,EAADikB,GAA+B,IAAtB+O,EAAsB/O,EAAtB+O,gBACpB,MAAO,CACLt6B,WAAWz+B,OAAA2J,EAAA,EAAA3J,CAAA,GACN+4D,EAAgBt6B,WADX,CAERkqB,gBAAe,GAAA9kD,OAAA7D,OAAAiO,GAAA,EAAAjO,CAAO+lC,EAAKtH,WAAWkqB,iBAAvB3oD,OAAAiO,GAAA,EAAAjO,CAA2C+4D,EAAgBt6B,WAAWkqB,yBATZ,KAoBnF,MAAO,CACL2U,cALoBv3D,EAAK04B,YAAc14B,EAAK04B,WAAWkqB,gBACrD5iD,EAAK04B,WAAWkqB,gBAChB,GAIFkQ,YACApwB,QAAS1iC,EAAK0iC,QACdzX,WAGJ42B,KAAM,SAAAuC,GAAA,OAAAA,EAAGwR,eACTzzD,QAAS,SAAAqiD,GAAA,MAAwB,CAC/B7lB,UAAW,CACTk6B,UAFKrU,EAAGoR,cAEiBj1D,GACzB+hD,MAAO,QA0EE5jB,gBAtCS,SAAC3kC,EAAOwE,GAAU,IAAA+nD,EACcvsD,EAAMwS,KAApDnS,QAAW4uD,EADqB1C,EACrB0C,OAAQnc,EADayZ,EACbzZ,aAAc/9B,EADDw3C,EACCx3C,OACzC,MAAO,CACL4pD,WAAY1P,EAASA,EAAO+K,IAAM,KAClCiD,YAAahO,EAASA,EAAOz1C,KAAO,KACpCs5B,eACA/9B,WAIuB,SAAAiiC,GAAQ,MAAK,CACtCgV,OAAQ,WACNhV,EAASvF,OAEXwa,YAAa,SAACha,GACZ+E,EAASvF,GAAoBQ,KAE/B2sB,aAAc,SAAChtB,GACboF,EAASvF,GAAqBj/B,KAAKgB,cAAcK,OAAQ,CAAEi/B,aAAclB,MAG3EitB,UAAW,SAAA3T,GAAsB,IAAnB+K,EAAmB/K,EAAnB+K,KAAMqI,EAAapT,EAAboT,OACd94D,EAASywD,EACb,IAAKzwD,GAAU84D,EAAQ,CACrB,IAAMxI,EAAYC,kBAAOvH,iBAAM8P,GAAS,IAAK,CAAEtI,MAAO,WACtDxwD,EAASs5D,gBAAShJ,GAGhBtwD,IACFwxC,EAASvF,GAAuB,CAC9Bxc,KAAMziB,KAAK6B,aAAaC,KACxB9O,OAAQA,KAEVwxC,EAASvF,GAAqBj/B,KAAKgB,cAAcE,IAAK,CAAEo/B,aAAc,KAAMjB,aAAc,YAKjFlN,CA7VO,SAAA3gC,GAEhB,IADJ66D,EACI76D,EADJ66D,UAAWD,EACP56D,EADO46D,aAAcD,EACrB36D,EADqB26D,WAAY1B,EACjCj5D,EADiCi5D,YAAatE,EAC9C30D,EAD8C20D,UAC9C15D,EAGgCC,mBAASy/D,GAAcnsD,KAAKyB,YAAYC,KAHxErU,EAAAC,OAAAsN,GAAA,EAAAtN,CAAAb,EAAA,GAGG89D,EAHHl9D,EAAA,GAGem9D,EAHfn9D,EAAA,GAAAmB,EAKgC9B,mBAAS+9D,GAAe,IALxD57D,EAAAvB,OAAAsN,GAAA,EAAAtN,CAAAkB,EAAA,GAKGk8D,EALH77D,EAAA,GAKe87D,EALf97D,EAAA,GAAA8O,EAMsCjR,mBAAS,MAN/CkR,EAAAtQ,OAAAsN,GAAA,EAAAtN,CAAAqQ,EAAA,GAMGsrD,EANHrrD,EAAA,GAMkBgrD,EANlBhrD,EAAA,GAoBA2uD,EAAmB,KACnBC,EAAkB,KAEtB,OAAQjC,GACN,KAAKvqD,KAAKyB,YAAYC,IACpB6qD,EAAmBjB,GACnBkB,EAAkBT,GAClB,MACF,KAAK/rD,KAAKyB,YAAYE,SACpB4qD,EAAmBb,GAEnB,MACF,KAAK1rD,KAAKyB,YAAYG,KACpB2qD,EAAmBf,GACnBgB,EAAkBP,GAMtB,IAAMQ,EAAiBpiD,kBAAQ,kBAAMmiD,EACjCnrB,YACAkrB,EACAC,EAFAnrB,CAGAipB,IACAiC,EAAiBjC,KAAS,CAACiC,EAAkBC,IAEjD,OAAO55D,EAAAlD,EAAAmD,cAAC45D,EAADn/D,OAAAqG,OAAoB,CAAE42D,aAAYG,aAAYzB,iBAA9C,CACL/c,WAAY,aACZ2e,WAAYwB,EACZnD,cAAekD,EACfxD,iBAvCgC,SAAC8D,GACjC9D,EAAiB8D,IAuCjBvG,UAAWA,EACXqE,cA7CsB,SAACmC,GACvB/D,EAAiB,MACjB4B,EAAcmC,IA4CdhC,cAvC6B,SAAC3jD,GAC9B2jD,EAAc3jD,GACd4hD,EAAiB,YC1Bf/4D,GAAYC,aAAW,SAAAC,GAAK,MAAK,CACrCuE,KAAM,GAGNkpD,YAAa,CACXnsD,QAAS,QACTuf,WAAY7gB,EAAM0E,QAAQ,GAC1BqR,YAAa/V,EAAM0E,QAAQ,GAC3B3D,MAAO,OACPge,SAAU,MACVze,OAAQ,WA2BGu8D,GAvBA,SAAAp7D,GAAsC,IAAnCg0C,EAAmCh0C,EAAnCg0C,KAAMzP,EAA6BvkC,EAA7BukC,QAAS82B,EAAoBr7D,EAApBq7D,cACzBv6D,EAAUzC,KAEhB,OAAIkmC,IAAYyP,EAAa,aAI3B5yC,EAAAlD,EAAAmD,cAACumB,GAAA,EAAD,CAAU5lB,UAAWlB,EAAQgC,KAAMf,QAASs5D,EAAep2B,gBAAc,GACvE7jC,EAAAlD,EAAAmD,cAAA,OAAKkM,IAAI,UAAUvL,UAAWlB,EAAQkrD,YAAap+C,IAAKomC,EAAKoY,WAC7DhrD,EAAAlD,EAAAmD,cAACwmB,GAAA,EAAD,CACE1c,QAAS6oC,EAAK0S,SACdt7C,UAAS,iBAAAzL,OAAmBumB,aAAW8tB,EAAKyS,UAAW,WClBzDpoD,GAAYC,aAAW,SAAAC,GAAK,MAAK,CACrCuE,KAAM,CACJlE,WAAYL,EAAM8D,QAAQzD,WAAW8E,MACrC7D,QAAS,OACTV,cAAe,SACfN,OAAQ,QAEVy8D,gBAAiB,CACf58D,MAAOH,EAAM8D,QAAQ8I,QAAQC,UAC7BxM,WAAYL,EAAM8D,QAAQzD,WAAWuV,QACrClJ,UAAW,SACXjI,QAASzE,EAAM0E,QAAQ,EAAG,IAE5Bs4D,WAAY,GAGZC,mBAAoB,CAClB97D,OAAQnB,EAAM0E,QAAQ,EAAG,KAE3B6tD,WAAY,CACVjyD,OAAQ,OACRk4D,UAAW,SACXrxC,UAAW,UAEbkzC,KAAM,GAGN6C,UAAW,CACT/8D,MAAOH,EAAM8D,QAAQmT,KAAKpK,UAC1BH,UAAW,SACXjI,QAASzE,EAAM0E,QAAQ,OAIrBy4D,GACM,aADNA,GAEK,UAFLA,GAGE,OA2GOC,GAxGG,SAAA37D,GAAoE,IAAjE47D,EAAiE57D,EAAjE47D,SAAUC,EAAuD77D,EAAvD67D,eAAgBt3B,EAAuCvkC,EAAvCukC,QAASq2B,EAA8B56D,EAA9B46D,aAChD95D,GAD8Ed,EAAhB66D,UACpDx8D,MADoEpD,EAEhDC,mBAAS,GAFuCW,EAAAC,OAAAsN,GAAA,EAAAtN,CAAAb,EAAA,GAE7E89D,EAF6El9D,EAAA,GAEjEm9D,EAFiEn9D,EAAA,GAAAmB,EAGzD9B,mBAASwgE,IAHgDr+D,EAAAvB,OAAAsN,GAAA,EAAAtN,CAAAkB,EAAA,GAG7E8+D,EAH6Ez+D,EAAA,GAGpE0+D,EAHoE1+D,EAAA,GAAA8O,EAItDjR,oBAAS,GAJ6CkR,EAAAtQ,OAAAsN,GAAA,EAAAtN,CAAAqQ,EAAA,GAI7E6vD,EAJ6E5vD,EAAA,GAIpE6vD,EAJoE7vD,EAAA,GAM5E4nC,EAAS9qC,qBAAWkzB,GAApB4X,KAEFkoB,EAAa,SAACC,GACdA,IAAYL,EAASG,GAAYD,GAChCD,EAAQI,IAGXC,EAAyB,IAAfrD,EAAmB6C,EAAWC,EAE5C,OAAQC,GACN,KAAKJ,GACCM,EAASI,EAAQptC,KAAK,SAAC9wB,EAAG+wB,GAAJ,OAAU/wB,EAAEqxD,OAAOnoC,QAAU6H,EAAEsgC,OAAOnoC,UAC3Dg1C,EAAQptC,KAAK,SAAC9wB,EAAG+wB,GAAJ,OAAUA,EAAEsgC,OAAOnoC,QAAUlpB,EAAEqxD,OAAOnoC,UACxD,MACF,KAAKs0C,GACCM,EAASI,EAAQptC,KAAK,SAAC9wB,EAAG+wB,GAAJ,OAAU/wB,EAAEuoD,UAAYx3B,EAAEw3B,YAC/C2V,EAAQptC,KAAK,SAAC9wB,EAAG+wB,GAAJ,OAAUA,EAAEw3B,UAAYvoD,EAAEuoD,YAC5C,MACF,KAAKiV,GACCM,EACFI,EAAQptC,KAAK,SAAC9wB,EAAG+wB,GACf,OAAI/wB,EAAEgZ,KAAO+X,EAAE/X,MACL,EAENhZ,EAAEgZ,KAAO+X,EAAEotC,UACN,EAEF,IAITD,EAAQptC,KAAK,SAAC9wB,EAAG+wB,GACf,OAAIA,EAAE/X,KAAOhZ,EAAEgZ,MACL,EAEN+X,EAAE/X,KAAOhZ,EAAEgZ,KACN,EAEF,IAQf,OACE9V,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQgC,MACtB1B,EAAAlD,EAAAmD,cAACgsD,GAAD,KACEjsD,EAAAlD,EAAAmD,cAAC4E,GAAA,EAAD,oBAEF7E,EAAAlD,EAAAmD,cAACi7D,GAAD,CAAQtoB,KAAMA,IAEd5yC,EAAAlD,EAAAmD,cAAC66C,GAAA,EAAD,CACE93C,MAAO20D,EACPh1D,SAAU,SAAC9C,EAAG0jB,GAAJ,OAAYq0C,EAAcr0C,IACpC+0C,eAAe,UACfE,UAAQ,EACR94D,QAAS,CAAE64D,cAAe74D,EAAQ83D,OAElCx3D,EAAAlD,EAAAmD,cAAC86C,GAAA,EAAD,CAAKn6C,UAAWlB,EAAQk1D,IAAK5xD,MAAO,EAAG7B,MAAM,cAC7CnB,EAAAlD,EAAAmD,cAAC86C,GAAA,EAAD,CAAKn6C,UAAWlB,EAAQk1D,IAAK5xD,MAAO,EAAG7B,MAAM,cAE/CnB,EAAAlD,EAAAmD,cAACkmB,GAAA,EAAD,MACAnmB,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQw6D,iBACtBl6D,EAAAlD,EAAAmD,cAACk7D,GAAD,CAAgBC,IAAKR,EAASjf,OAAQ+e,IAAYJ,GAAW35D,QAAS,kBAAMm6D,EAAWR,KAAYn5D,MAAOm5D,KAD5G,IAGEt6D,EAAAlD,EAAAmD,cAACk7D,GAAD,CAAgBC,IAAKR,EAASjf,OAAQ+e,IAAYJ,GAAe35D,QAAS,kBAAMm6D,EAAWR,KAAgBn5D,MAAOm5D,KAHpH,IAKEt6D,EAAAlD,EAAAmD,cAACk7D,GAAD,CAAgBC,IAAKR,EAASjf,OAAQ+e,IAAYJ,GAAc35D,QAAS,kBAAMm6D,EAAWR,KAAen5D,MAAOm5D,MAElHt6D,EAAAlD,EAAAmD,cAACkmB,GAAA,EAAD,MACAnmB,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQgwD,aACpBvsB,KAAa63B,GAA8B,IAAnBA,EAAQ3zD,SAChCrH,EAAAlD,EAAAmD,cAAC4E,GAAA,EAAD,CAAYjE,UAAWlB,EAAQ26D,UAAW50D,UAAU,OAApD,mBAEDu1D,EAAQl4D,IAAI,SAAC4oB,EAAQlkB,GAAT,OACXxH,EAAAlD,EAAAmD,cAACmuD,GAAD,CACE3mD,IAAG,iBAAAlJ,OAAmBiJ,GACtBkkB,OAAQA,EACRuiC,eAAa,EACbC,eAAa,EACbvtD,QAAS,kBAAM64D,EAAa9tC,EAAOtqB,YAkBzCi6D,GAAkBn+D,aAAW,SAAAC,GAAK,MAAK,CAC3CuE,KAAM,CACJpD,OAAQnB,EAAM0E,QAAQ,EAAG,EAAG,EAAG,OAI7By5D,GAAiB,SAAA12D,GAAqC,IAAlC+2C,EAAkC/2C,EAAlC+2C,OAAQyf,EAA0Bx2D,EAA1Bw2D,IAAKz6D,EAAqBiE,EAArBjE,QAASQ,EAAYyD,EAAZzD,MACxCzB,EAAU27D,KAEVE,GAAgB,IAARH,EAAe,SAAM,SAEnC,OACEp7D,EAAAlD,EAAAmD,cAAC2kB,GAAA,EAAD,CACE9Y,KAAK,QACLlL,UAAWlB,EAAQgC,KACnBf,QAASA,EAETrD,MAAOq+C,EAAS,YAAc,WAE7Bx6C,EACDnB,EAAAlD,EAAAmD,cAAA,QAAMe,MAAO,CAAE4I,QAAS+xC,EAAS,EAAI,IAClC4f,KCvJHC,GAAsBrsD,YAAQgqB,EAAY,CAC9C/5B,MAAO,SAAAwF,GAAwB,IAArBnE,EAAqBmE,EAArBnE,KAAMq+B,EAAel6B,EAAfk6B,SAEd,MAAO,CAAEr+B,KAAK/F,OAAA2J,EAAA,EAAA3J,CAAA,GAAMokC,EAASr+B,KAAhB,CAAsBg7D,QAASh7D,QAI1Ci7D,GAA2BvsD,YAAQkqB,EAAgB,CACvDj6B,MAAO,SAAA0F,GAAwB,IAArBrE,EAAqBqE,EAArBrE,KAAMq+B,EAAeh6B,EAAfg6B,SAEd,MAAO,CAAEr+B,KAAK/F,OAAA2J,EAAA,EAAA3J,CAAA,GAAMokC,EAASr+B,KAAhB,CAAsBk7D,eAAgBl7D,MAErD6hD,KAAM,SAAAr9C,GAAoBA,EAAjBxE,KAAiB,IAAXmyC,EAAW3tC,EAAX2tC,KACb,IACE,OAAOA,EAAK6G,SAASpyC,OAAS,EAEhC,MAAOxH,GACL,OAAO,IAGX+C,QAAS,SAAAuC,GAAoBA,EAAjB1E,KACV,MAAO,CACL2+B,UAAW,CAAEswB,WAFYvqD,EAAXytC,KAEgB6G,cAQ9BmiB,GAAentB,YACnB+sB,GAEAE,GAHmBjtB,CAnDE,SAAA7vC,GAAuC,IAApC6B,EAAoC7B,EAApC6B,KAAM+4D,EAA8B56D,EAA9B46D,aAAcC,EAAgB76D,EAAhB66D,UACpCgC,EAA4Bh7D,EAA5Bg7D,QAASE,EAAmBl7D,EAAnBk7D,eAEXnB,EAAWiB,GAAWA,EAAQtiC,YAAcsiC,EAAQtiC,WAAWkqB,gBAAkBoY,EAAQtiC,WAAWkqB,gBAAkB,GACtHoX,EAAiBkB,GAAkBA,EAAeE,YAAcF,EAAeE,YAAc,GAG7F14B,EAAU15B,QACbgyD,GAAWA,EAAQt4B,SACnBw4B,GAAkBA,EAAex4B,SAGpC,OAAOnjC,EAAAlD,EAAAmD,cAAC67D,GAAc,CAAE34B,UAASq3B,WAAUC,iBAAgBjB,eAAcC,gBA6D5Dl6B,gBAbS,SAAC3kC,EAAOwE,GAC9B,MAAO,IAGkB,SAAAwyC,GAAQ,MAAK,CACtC4nB,aAAc,SAAChtB,GACboF,EAASvF,GAAqBj/B,KAAKgB,cAAcK,OAAQ,CAAEi/B,aAAclB,MAE3EitB,UAAW,SAACjtB,GACVoF,EAASvF,GAAqBj/B,KAAKgB,cAAcE,IAAK,CAAEo/B,aAAclB,QAI3DjN,CAGbq8B,cCjFI3+D,GAAYC,aAAW,SAAAC,GAAK,MAAK,CACrCuE,KAAM,CACJjD,QAAS,OACT2D,WAAY,UAEdgpB,KAAM,CAAEzhB,SAAU,GAClByK,KAAM,CACJvK,UAAW,SACXm5B,UAAW,SACXphC,QAASzE,EAAM0E,QAAQ,EAAG,OAwBfk6D,GApBG,SAAAn9D,GAA2B,IAAxBoC,EAAwBpC,EAAxBoC,MAAO8I,EAAiBlL,EAAjBkL,KAAMsK,EAAWxV,EAAXwV,KAC1B1U,EAAUzC,KAChB,OACE+C,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQgC,MACtB1B,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQ0rB,OACvBthB,EACD9J,EAAAlD,EAAAmD,cAAC4E,GAAA,EAAD,CAAYjE,UAAWlB,EAAQ0U,KAAM9M,QAAQ,YAAYhK,MAAM,gBAAgBmI,UAAU,MAAMzE,MAAOA,GACnGoT,GAEHpU,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQ0rB,SCpBxBnuB,GAAYC,aAAW,SAAAC,GAAK,MAAK,CACrCuE,KAAM,CACJmI,UAAW,UAEbmyD,YAAa,CACX1+D,MAAOH,EAAM8D,QAAQ8I,QAAQ2L,aAC7BwE,OAAM,aAAA3b,OAAepB,EAAM8D,QAAQ8I,QAAQ2L,cAC3ClY,WAAYL,EAAM8D,QAAQmT,KAAKrK,QAC/BzL,OAAQ,QAEV29D,UAAW,MA0BEC,GAtBS,SAAAt9D,GAAiB,IAAd+B,EAAc/B,EAAd+B,QACnBjB,EAAUzC,KAChB,OACE+C,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQgC,MACtB1B,EAAAlD,EAAAmD,cAACuB,GAAA,EAAD,CAAQZ,UAAWlB,EAAQs8D,aACzBh8D,EAAAlD,EAAAmD,cAACkH,GAAA,EAAD,CAAY7J,MAAM,UAAUqD,QAAS,SAAAd,GACnCA,EAAEC,iBACFD,EAAEE,kBACFY,MAEAX,EAAAlD,EAAAmD,cAACk8D,GAAAr/D,EAAD,CAAWQ,MAAM,gBClBrBL,GAAYC,aAAW,SAAAC,GAAK,MAAK,CACrCuE,KAAM,CACJjE,OAAQ,OAERmE,QAASzE,EAAM0E,QAAQ,GAAK,IAE9BksD,aAAc,CACZ1rD,SAAU,SACV5E,OAAQ,OACRC,SAAU,YAEZ0+D,yBAA0B,CACxB1+D,SAAU,WACVkM,QAAS,GACTvJ,OAAQlD,EAAM0E,QAAQ,GACtB7D,MAAOb,EAAM0E,QAAQ,IAEvBw6D,eAAgB,CACd7+D,WAAY,YACZuY,WAAY,qBACZzY,MAAO,QACPI,SAAU,WACV0E,WAAY,SACZ3D,QAAS,OACTb,IAAK,EACLM,MAAO,OACP8H,aAAc7I,EAAM0E,QAAQ,IAE9BN,OAAQ,CACN2Y,OAAQ,kBACR5b,OAAQnB,EAAM0E,QAAQ,EAAG,IAE3Bia,MAAO,CACL3Z,KAAM,UACNE,SAAU,UAEZi6D,WAAY,CACV7jB,aAAc,WACdzkC,WAAY,SACZ3R,SAAU,UAEZgI,IAAK,CACHojD,UAAW,QACXhwD,OAAQ,OACRS,MAAO,QAET0sD,YAAa,CACX1sD,MAAO,WAILq+D,GAEC,QAGDC,GAAW,SAAA59D,GAAwE,IAArEzD,EAAqEyD,EAArEzD,MAAO88D,EAA8Dr5D,EAA9Dq5D,WAAYwE,EAAkD79D,EAAlD69D,aAAcC,EAAoC99D,EAApC89D,eAC3ChxC,GAD+E9sB,EAApB+wD,cACzCx0D,EAAlBuwB,QAAQ9jB,EAAUzM,EAAVyM,MAEVlI,EAAUzC,KACRqJ,EAAiBwB,qBAAWkzB,GAA5B10B,aACR,OACEtG,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQgC,MACtB1B,EAAAlD,EAAAmD,cAAC8E,GAAA,EAAD,CAAOnE,UAAWlB,EAAQquD,cACxB/tD,EAAAlD,EAAAmD,cAAA,OACEkM,IAAI,SACJvL,UAAWlB,EAAQ2K,IACnBmC,IAAKlG,EAAamF,YAAY7D,EAAO,UACrCjH,QAAS,kBAAM87D,EAAa/wC,EAAOtqB,GAAIwG,EAAMxG,OAE/CpB,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQ28D,gBACtBr8D,EAAAlD,EAAAmD,cAACuB,GAAA,EAAD,CAAQb,QAAS,kBAAM+7D,EAAe90D,EAAMo3C,YAAYsG,WAAW1kD,UAAWlB,EAAQ6B,QACpFvB,EAAAlD,EAAAmD,cAAA,OAAKkM,IAAI,UAAUvL,UAAWlB,EAAQkrD,YAAap+C,IAAK5E,EAAMo3C,YAAYgM,YAE5EhrD,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQoc,OACtB9b,EAAAlD,EAAAmD,cAAC4E,GAAA,EAAD,CAAYjE,UAAWlB,EAAQ48D,WAAYh1D,QAAQ,QAAQhK,MAAM,WAAWouB,EAAO5V,MACnF9V,EAAAlD,EAAAmD,cAAC4E,GAAA,EAAD,CAAYyC,QAAQ,QAAQhK,MAAM,WAAWsK,EAAMo3C,YAAYsG,SAA/D,IAA0EiX,GAA1E,YACAv8D,EAAAlD,EAAAmD,cAAC4E,GAAA,EAAD,CAAYyC,QAAQ,UAAUhK,MAAM,WAAWwnB,aAAWld,EAAM69C,aAElEzlD,EAAAlD,EAAAmD,cAAC08D,GAAD,CAAiBh8D,QAAS,kBAAMs3D,EAAWvsC,EAAOtqB,GAAIwG,EAAMxG,WAgBvDo7D,MCzFTv/D,GAAYC,aAAW,SAAAC,GAAK,MAAK,CACrCuE,KAAM,CACJjD,QAAS,OACTV,cAAe,SACfN,OAAQ,QAEVm/D,cAAe,CACbjzD,SAAU,EACVtH,SAAU,UAEZw6D,MAAO,CACLp/D,OAAQ,OACRS,MAAO,QAET4+D,cAAe,CACbnzD,SAAU,EAEVS,UAAW,iBAEbghB,KAAM,CACJzhB,SAAU,MAoGCozD,GAhGA,SAAAn+D,GAGT,IAFJo+D,EAEIp+D,EAFJo+D,OAAQ75B,EAEJvkC,EAFIukC,QAAS80B,EAEbr5D,EAFaq5D,WAAYwE,EAEzB79D,EAFyB69D,aAAcC,EAEvC99D,EAFuC89D,eAC3C/M,EACI/wD,EADJ+wD,cAA4B4D,GACxB30D,EADWq+D,YACXr+D,EADwB20D,WAAWl3D,EACnCuC,EADmCvC,OAEjCqD,EAAUzC,KACVs5D,EAAUx7D,mBACR+Q,EAASF,aAAiB2qD,GAA1BzqD,KACAurD,EAAWJ,KAAXI,OA0DR,OACEr3D,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQgC,MACtB1B,EAAAlD,EAAAmD,cAACgsD,GAAD,KACEjsD,EAAAlD,EAAAmD,cAAC4E,GAAA,EAAD,CAAYjE,UAAWlB,EAAQ0rB,MAA/B,cAEFprB,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQk9D,cAAe13D,IAAKqxD,GAC1Cv2D,EAAAlD,EAAAmD,cAACi9D,GAAA,EAAD,CACEz/D,OAAQqO,EAAKrO,OACbS,MAAO4N,EAAK5N,MACZ0C,UAAWlB,EAAQm9D,MACnBM,SAAUH,EAAO31D,OAAS,EAC1B+1D,UAtGQ,IAuGRC,YApEY,SAAAz4D,GAQd,IAEAsP,EATJkjC,EAOIxyC,EAPJwyC,MAGA3vC,GAII7C,EANJ04D,YAMI14D,EALJ24D,UAKI34D,EAJJ6C,KACA+1D,EAGI54D,EAHJ44D,OACAx8D,EAEI4D,EAFJ5D,MAGMy8D,EAAMT,EAAO5lB,GAEnB,GAAIA,EAAQ4lB,EAAO31D,QAAUo2D,EAC3BvpD,EAAUlU,EAAAlD,EAAAmD,cAACy9D,GAAD,CACRviE,MAAO6hE,EAAO5lB,GACduY,cAAeA,EACf8M,aAAcA,EACdC,eAAgBA,EAChBzE,WAAYA,SAGX,GAAI7gB,IAAU4lB,EAAO31D,OAAQ,CAEhC,IAAMs2D,EAAOthE,GAAwB,IAAdA,EAAO,GAC9B6X,EAAUlU,EAAAlD,EAAAmD,cAAC29D,GAAD,CAAW9zD,KAAM9J,EAAAlD,EAAAmD,cAAC2/C,GAAA,EAAD,CAAkB9zC,KAAM,GAAI+zC,UAAW,EAAGviD,MAAM,YAAc8W,KAAK,eAE9F,IAAMypD,EAAcC,KAAgBN,EAAO5iE,MAAM+7D,UAAY31D,EAAMpD,IAE9Dy5D,EAGIsG,EACPzpD,EAAUlU,EAAAlD,EAAAmD,cAAC29D,GAAD,CAAWxpD,KAAK,iBAGlB+uB,GAAW06B,GACnBtK,IAPAr/C,EAAUlU,EAAAlD,EAAAmD,cAAC29D,GAAD,CAAW9zD,KAAM9J,EAAAlD,EAAAmD,cAACo9B,GAAAvgC,EAAD,MAAesX,KAAK,2BAWnD,OACEpU,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQ+9D,IAAKh2D,IAAKA,EAAKzG,MAAOA,GAC3CkT,SCnFHk/C,GAAgB,GAyDhB2K,GAAgB5uD,YAAQ6qB,EAAW,CACvC56B,MAAO,SAAAwF,GAAc,IAAXnE,EAAWmE,EAAXnE,KACJA,EAAK6L,OAAOrJ,QAAQqJ,MAAM7L,EAAK6L,OAGnC,IAAI0xD,GAAgB,EAChBC,GAAc,EA6ClB,MAAO,CACLx9D,OACAu9D,gBACAC,cACAhB,YA5CkB,WAClBe,GAAgB,EAChB/6D,QAAQC,IAAI,cAAezC,GAC3BA,EAAK8yD,UAAU,CACbn0B,UAAU1kC,OAAA2J,EAAA,EAAA3J,CAAA,GAAM+F,EAAK2+B,UAAZ,CAAuB8+B,MAAOz9D,EAAK09D,OAAO9hE,OAAO,KAE1Dm3D,YAAa,SAAC/yB,EAAD37B,GAA+B,IAAtB2uD,EAAsB3uD,EAAtB2uD,gBAEpB,OADAuK,GAAgB,EACT,CACLG,OAAOzjE,OAAA2J,EAAA,EAAA3J,CAAA,GACF+4D,EAAgB0K,OADf,CAGJC,KAAI,GAAA7/D,OAAA7D,OAAAiO,GAAA,EAAAjO,CAAO+4D,EAAgB0K,OAAOC,MAA9B1jE,OAAAiO,GAAA,EAAAjO,CAAuC+lC,EAAK09B,OAAOC,OACvD/hE,OAAQ,CAACokC,EAAK09B,OAAO9hE,OAAO,GAAIo3D,EAAgB0K,OAAO9hE,OAAO,WAgCtEk3D,UAxBgB,WAChB0K,GAAc,EACdh7D,QAAQC,IAAI,YAAazC,GACzBA,EAAK8yD,UAAU,CACbn0B,UAAU1kC,OAAA2J,EAAA,EAAA3J,CAAA,GAAM+F,EAAK2+B,UAAZ,CAAuBi/B,IAAK59D,EAAK09D,OAAO9hE,OAAO,KAExDm3D,YAAa,SAAC/yB,EAADx7B,GAA+B,IAAtBwuD,EAAsBxuD,EAAtBwuD,gBAEpB,OADAwK,GAAc,EACP,CACLE,OAAOzjE,OAAA2J,EAAA,EAAA3J,CAAA,GACF+4D,EAAgB0K,OADf,CAEJC,KAAI,GAAA7/D,OAAA7D,OAAAiO,GAAA,EAAAjO,CAAO+lC,EAAK09B,OAAOC,MAAnB1jE,OAAAiO,GAAA,EAAAjO,CAA4B+4D,EAAgB0K,OAAOC,OACvD/hE,OAAQ,CAACo3D,EAAgB0K,OAAO9hE,OAAO,GAAIokC,EAAK09B,OAAO9hE,OAAO,WAatE8mC,QAAS1iC,EAAK0iC,UAIlBvgC,QAAS,SAAAuC,KAAGuoC,aAAH,MAAuB,CAC9BtO,UAAW,CACT+jB,MAvHa,OAoJJ5jB,gBArBS,SAAC3kC,EAAOwE,GAC9B,MAAO,IAKkB,SAAAwyC,GAAQ,MAAK,CACtC4nB,aAAc,SAAChtB,EAAU6X,GACvBzS,EAASvF,GAAqBj/B,KAAKgB,cAAcK,OAAQ,CAAEi/B,aAAclB,EAAUC,aAAc4X,MAEnGia,WAAY,SAAChZ,GACX1T,EAASvF,GAAqBj/B,KAAKgB,cAAcG,OAAQ,CAAEs7C,OAAQ,CAAE+K,IAAKxnD,KAAKyB,YAAYG,KAAMoF,KAAMkxC,OAEzGmU,UAAW,SAACjtB,EAAU6X,GACpBzS,EAASvF,GAAuB,CAC9Bxc,KAAMziB,KAAK6B,aAAaC,QAE1B0iC,EAASvF,GAAqBj/B,KAAKgB,cAAcE,IAAK,CAAEo/B,aAAclB,EAAUC,aAAc4X,QAInF9kB,CAIbw+B,GAtJkB,SAAAn/D,GAOd,IANJ6B,EAMI7B,EANJ6B,KAAM0iC,EAMFvkC,EANEukC,QAASowB,EAMX30D,EANW20D,UAAW0J,EAMtBr+D,EANsBq+D,YAG1BzD,GAGI56D,EALJo/D,cAKIp/D,EAJJq/D,YAIIr/D,EAHJ46D,cACAC,EAEI76D,EAFJ66D,UACA6E,EACI1/D,EADJ0/D,WAEMphB,EAAWniD,mBACTs8D,EAAWJ,KAAXI,OAFJx9D,EAG8BC,mBAAS,MAHvCW,EAAAC,OAAAsN,GAAA,EAAAtN,CAAAb,EAAA,GAGGg6D,EAHHp5D,EAAA,GAGco6D,EAHdp6D,EAAA,GAIJyiD,EAASjiD,QAAU44D,EAGnBx4D,oBAAU,WAMR,OADK6hD,EAASjiD,UAASiiD,EAASjiD,QAAUmiD,YAJ1C,YACOja,GAAWk0B,GAAQ4F,IACpB/f,EAASjiD,SAAS45D,EAAapjC,OAAOl3B,KAAKC,MAAwB,IAAhB44D,MAEmB,IAAhBA,KACrD,WACDlW,EAASjiD,UACXgI,QAAQC,IAAI,oBACZq6C,cAAcL,EAASjiD,SACvBiiD,EAASjiD,QAAU,QAGtB,IAEH,IAAM+hE,EAASv8D,EAAK09D,QAAS19D,EAAK09D,OAAOC,MAAa,GAChD/hE,EAASoE,EAAK09D,QAAS19D,EAAK09D,OAAO9hE,OAAOyG,IAAI,SAAA6gB,GAAC,OAAI5a,SAAS4a,EAAG,OAAuB,CAAC,KAAM,MAEnG,OACE3jB,EAAAlD,EAAAmD,cAACs+D,GAAD7jE,OAAAqG,OAAY,CAAEi8D,SAAQ75B,UAAS9mC,SAAQk3D,YAAW0J,cAAazD,gBAA/D,CACE7J,cAAe,aACf8M,aAAcjD,EACdkD,eAAgB4B,EAChBrG,WAAYwB,qECzBZx8D,GAAYC,aAAW,SAAAC,GAAK,MAAK,CACrCuE,KAAM,CACJjD,QAAS,OACThB,OAAQ,OACRM,cAAe,UAEjBygE,OAAQ,CACNtkD,OAAQ,gBACRtY,QAASzE,EAAM0E,QAAQ,GACvBnE,SAAU,WACVJ,MAAO,QACPsM,QAAS,GACTrH,OAAQ,EACRrE,MAAO,MACPT,OAAQ,MACRG,IAAK,MACLD,KAAM,MACN0X,gBAAiB,UACjBjL,UAAW,qCAEbguC,OAAQ,GAGRjuC,MAAO,CACLvI,QAASzE,EAAM0E,QAAQ,GACvBpE,OAAQ,OACRkM,SAAU,EACVtH,SAAU,UAEZo8D,SAAU,CACR78D,QAASzE,EAAM0E,QAAQ,GACvBvD,OAAQnB,EAAM0E,QAAQ,IAExB68D,aAAc,CACZ/0D,SAAU,EACV/H,QAASzE,EAAM0E,QAAQ,IAEzB88D,gBAAiB,CACfzgE,MAAO,MACPI,OAAQ,SACRZ,SAAU,WAEVuW,YAAa,CACXC,QAAS,IACTzV,QAAS,QACTwmB,WAAY,SAGhB25C,SAAU,CACRphE,WAAY0S,KAAI,KAChB5S,MAAO,SAETuhE,aAAc,CACZrhE,WAAYwS,KAAM,KAClB1S,MAAO,SAETwhE,SAAU,GAGVn+C,MAAO,CACLljB,OAAQ,OACRS,MAAO,OACPsvD,cAAe,UAiIJuR,GArHE,SAAAngE,GAA+B,IAA5B06C,EAA4B16C,EAA5B06C,WAAY/6B,EAAgB3f,EAAhB2f,UACxB7e,EAAUzC,KAD8BpD,EAERC,qBAFQW,EAAAC,OAAAsN,GAAA,EAAAtN,CAAAb,EAAA,GAEvCmlE,EAFuCvkE,EAAA,GAE1BwkE,EAF0BxkE,EAAA,GAAAmB,EAGxB9B,mBAAS,MAHemC,EAAAvB,OAAAsN,GAAA,EAAAtN,CAAAkB,EAAA,GAGvCyQ,EAHuCpQ,EAAA,GAGlCijE,EAHkCjjE,EAAA,GAAA8O,EAItBjR,mBAAS,MAJakR,EAAAtQ,OAAAsN,GAAA,EAAAtN,CAAAqQ,EAAA,GAIvCo0D,EAJuCn0D,EAAA,GAIjCo0D,EAJiCp0D,EAAA,GAAA2rB,EAMQrY,aAAU2gD,EAnF9C,IACC,KAkFXxgD,EANsCkY,EAMtClY,YAAae,EANyBmX,EAMzBnX,eAAgBb,EANSgY,EAMThY,aAE/B0gD,EAAcpuD,sBAAYC,aAASsO,EAAgB,KAAM,CAACb,EAAcF,IAwC9E,OAtCApjB,oBAAU,YACJsjB,GAAiBF,GAAgBpS,GAAQ8yD,IACtCH,GAAgBA,EAAYv+D,KAErB,eAAAmE,EAAAlK,OAAAwlC,GAAA,EAAAxlC,CAAAylC,GAAArjC,EAAAsjC,KAAG,SAAAC,IAAA,IAAAi/B,EAAA5uC,EAAAC,EAAA4uC,EAAA,OAAAp/B,GAAArjC,EAAAyjC,KAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,cACP4+B,EAAc,KADP9+B,EAAAC,KAAA,EAAAD,EAAAE,KAAA,EAGW8+B,GAAeR,GAH1B,OAGTM,EAHS9+B,EAAAI,KAAAJ,EAAAE,KAAA,gBAAAF,EAAAC,KAAA,EAAAD,EAAAQ,GAAAR,EAAA,SAMTv9B,QAAQqJ,MAARk0B,EAAAQ,IANS,WAAAR,EAAAC,KAAA,IASL6+B,EATK,CAAA9+B,EAAAE,KAAA,YAWDhQ,EAAW4uC,EAAY7+D,KAAKmU,QADrB,uBAC0CvN,OACjDspB,EAAU2uC,EAAY7+D,KAAKmwB,MAAMF,GACvCztB,QAAQC,IAAI,QAAS,CAAEzC,KAAM6+D,EAAY7+D,KAAMkwB,aACzC4uC,EAAa15C,KAAKC,MAAM25C,UAAU9uC,KACxBje,MAAS6sD,EAAWn+D,GAf7B,CAAAo/B,EAAAE,KAAA,eAeuC,IAAIztB,MAAM,mCAfjD,QAgBPmsD,EAAQG,GACRL,EAAO,MACPj8D,QAAQC,IAAI,SAAUo8D,GAlBf,QAoBTD,IApBS7+B,EAAAE,KAAA,iBAAAF,EAAAC,KAAA,GAAAD,EAAAk/B,GAAAl/B,EAAA,UAuBT0+B,EAAO,uBACPj8D,QAAQqJ,MAARk0B,EAAAk/B,IACAL,IAzBS,yBAAA7+B,EAAAngB,SAAAggB,EAAA,yBAAH,yBAAAz7B,EAAA4zB,MAAA7mB,KAAAsQ,YAAA,EA4BV09C,GA9BqCN,MAiCxC,CAAC1gD,EAAcqgD,EAAa3yD,EAAK8yD,IAIlCn/D,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQgC,MACtB1B,EAAAlD,EAAAmD,cAAC60B,GAAA,EAAD,MADF,IAEE90B,EAAAlD,EAAAmD,cAACm6C,GAAA,EAAD,CAAQ18C,SAAS,SAASkD,UAAWlB,EAAQ04C,QAC3Cp4C,EAAAlD,EAAAmD,cAAC2jC,GAAA,EAAD,CAASC,gBAAc,GACrB7jC,EAAAlD,EAAAmD,cAACkH,GAAA,EAAD,CAAYvG,UAAWlB,EAAQk5C,WAAYt7C,MAAM,UAAUqD,QAAS24C,EAAYnyB,aAAW,QACzFnnB,EAAAlD,EAAAmD,cAACo6C,GAAAv9C,EAAD,OAEFkD,EAAAlD,EAAAmD,cAAC4E,GAAA,EAAD,CAAYyC,QAAQ,YAAYhK,MAAM,UAAUsD,UAAWlB,EAAQ84C,cAAnE,qBAKJx4C,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQyK,OACtBnK,EAAAlD,EAAAmD,cAAC8E,GAAA,EAAD,CAAOnE,UAAWlB,EAAQi/D,iBACxB3+D,EAAAlD,EAAAmD,cAACuzC,GAAD,CAAY5yC,UAAWlB,EAAQ8+D,SAC/Bx+D,EAAAlD,EAAAmD,cAAA,SACE22B,UAAQ,EACRC,aAAW,EACXC,OAAK,EACL11B,GAAG,SACHR,UAAWlB,EAAQihB,SAGvB3gB,EAAAlD,EAAAmD,cAAC8E,GAAA,EAAD,CAAOnE,UAAWlB,EAAQ++D,UACxBz+D,EAAAlD,EAAAmD,cAAC4E,GAAA,EAAD,qFAGJ7E,EAAAlD,EAAAmD,cAACyuB,GAAA,EAAD,CACE6b,aAAc,CAAE5sB,SAAU,SAAU6sB,WAAY,UAChDnkC,OAAQgG,EACRsiB,iBAAkB,IAClBpoB,QAAS,kBAAM24D,EAAO,QAEtBl/D,EAAAlD,EAAAmD,cAAC2/D,GAAA,EAAD,CACEh/D,UAAWlB,EAAQk/D,SACnBjiD,QAAS3c,EAAAlD,EAAAmD,cAAA,QAAMW,UAAWlB,EAAQo/D,UAAWzyD,MAGjDrM,EAAAlD,EAAAmD,cAACyuB,GAAA,EAAD,CACE6b,aAAc,CAAE5sB,SAAU,SAAU6sB,WAAY,UAChDnkC,KAAMoY,GAENze,EAAAlD,EAAAmD,cAAC2/D,GAAA,EAAD,CACEh/D,UAAWlB,EAAQk/D,SACnBjiD,QAAS3c,EAAAlD,EAAAmD,cAAA,QAAMW,UAAWlB,EAAQo/D,UAAzB,oDAGb9+D,EAAAlD,EAAAmD,cAACyuB,GAAA,EAAD,CACE6b,aAAc,CAAE5sB,SAAU,SAAU6sB,WAAY,UAChDnkC,OAAQ84D,EACRxwC,iBAAkB,IAClBpoB,QAAS,kBAAMgY,EAAU4gD,EAAKzsD,KAAMysD,EAAK/9D,MAEzCpB,EAAAlD,EAAAmD,cAAC2/D,GAAA,EAAD,CACEh/D,UAAWlB,EAAQm/D,aACnBliD,QAAS3c,EAAAlD,EAAAmD,cAAA,QAAMW,UAAWlB,EAAQo/D,UAAzB,6BAebU,GAAiB,SAAA16D,GAAuC,IAApCrE,EAAoCqE,EAApCrE,KAAM4gB,EAA8Bvc,EAA9Buc,YAAaF,EAAiBrc,EAAjBqc,WAC3C,OAAO,IAAIb,QAAQ,SAACC,EAASC,GAC3B,IAGED,EADes/C,KAAKp/D,EAAM0gB,EAAYE,IAGxC,MAAOxhB,GACL2gB,EAAO3gB,4BCzNP5C,GAAYC,aAAW,SAAAC,GAAK,MAAK,CACrCuE,KAAM,CACJlE,WAAY,QACZF,MAAO,QACPuM,UAAW,aAyCAi2D,GArCI,WACjB,IAAMpgE,EAAUzC,KADO8iE,EAEG9I,KAAlBI,EAFe0I,EAEf1I,OAAQC,EAFOyI,EAEPzI,MAFOz9D,EAGSC,qBAHTW,EAAAC,OAAAsN,GAAA,EAAAtN,CAAAb,EAAA,GAGhBmmE,EAHgBvlE,EAAA,GAGNwlE,EAHMxlE,EAAA,GAIjByiD,EAAWniD,mBAEXmlE,EAAe,WACnB,IAAM7qC,EAAUpC,KAAOqkC,EAAO,KAAKpkC,UAEnC+sC,EAAY5qC,IAER8qC,EAAa,WACbjjB,EAASjiD,UACXsiD,cAAcL,EAASjiD,SACvBiiD,EAASjiD,QAAU,OAevB,OAXAI,oBAAU,WAMR,OALIi8D,IAAUpa,EAASjiD,SACrBilE,IACAhjB,EAASjiD,QAAUmiD,YAAY8iB,EA/Bf,MAiCR5I,GAAM6I,IACT,WACLA,MAED,CAAC7I,IAEAD,EAAe,KAEjBr3D,EAAAlD,EAAAmD,cAAC4E,GAAA,EAAD,CAAYjE,UAAWlB,EAAQgC,KAAM4F,QAAQ,UAAU7B,UAAU,OAAjE,YACYu6D,EADZ,+GCvBEjiB,GAASqiB,KAAWhyD,cAEpBnR,GAAYC,aAAW,SAAAC,GAAK,MAAK,CACrCuE,KAAM,CACJ2+D,UAAS,aAAA9hE,OAAepB,EAAM8D,QAAQ+I,UAAUoL,OAElDhB,KAAM,CACJxS,QAASzE,EAAM0E,QAAQ,EAAG,EAAG,IAE/BS,MAAO,CACL2D,cAAe,IAEjBsgB,KAAM,CACJnM,aAAcjd,EAAM0E,QAAQ,IAE9Bg1D,UAAW,CACTrqC,gBAAiBrvB,EAAM8D,QAAQzD,WAAW8E,OAE5C8oB,KAAM,CACJzhB,SAAU,GAEZuiB,OAAQ,CACNxuB,SAAU,WACV2C,OAAQ,EACR1C,KAAM,MACN0X,gBAAiB,SAEjBjL,UAAW,kDACX7H,OAAQ,KAEVm6B,OAAQ,CACNx+B,MAAO,GACPyL,SAAU,MAIR22D,GAAY,SAAA1hE,GAA4H,IAAzHgC,EAAyHhC,EAAzHgC,UAAW+O,EAA8G/Q,EAA9G+Q,OAAQs2B,EAAsGrnC,EAAtGqnC,SAAUs6B,EAA4F3hE,EAA5F2hE,YAAatI,EAA+Er5D,EAA/Eq5D,WAAYrI,EAAmEhxD,EAAnEgxD,cAAe8M,EAAoD99D,EAApD89D,eAAgBtoB,EAAoCx1C,EAApCw1C,cAAeC,EAAqBz1C,EAArBy1C,eACjH30C,EAAUzC,KACRo6D,EAAWJ,KAAXI,OAER,OACEr3D,EAAAlD,EAAAmD,cAACm6C,GAAA,EAAD,CAAQ18C,SAAS,SAASkD,UAAWC,KAAWnB,EAAQgC,KAAMd,IAC5DZ,EAAAlD,EAAAmD,cAAC2jC,GAAA,EAAD,KACGqC,GACCjmC,EAAAlD,EAAAmD,cAAC2kB,GAAA,EAAD,CACE47C,KAAK,QACL5/D,UAAWlB,EAAQ0rB,KACnB9tB,MAAOqS,IAAWouC,GAAO1vC,KAAO,YAAc,UAC9C1N,QAAS4/D,GAETvgE,EAAAlD,EAAAmD,cAACwgE,GAAA3jE,EAAD,OAGJkD,EAAAlD,EAAAmD,cAAC2kB,GAAA,EAAD,CACE47C,KAAK,QACL5/D,UAAWlB,EAAQ0rB,KACnB9tB,MAAOqS,IAAWouC,GAAOzvC,IAAM,YAAc,UAC7C3N,QAASs3D,GAETj4D,EAAAlD,EAAAmD,cAACygE,GAAA5jE,EAAD,OAEDmpC,GACCjmC,EAAAlD,EAAAmD,cAACi7C,GAAD,CACEt6C,UAAWlB,EAAQwsB,OACnBkoB,cAAeA,EACfC,eAAgBA,GAEhBr0C,EAAAlD,EAAAmD,cAACuuB,GAAA1xB,EAAD,OAGJkD,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQg9B,SACxB18B,EAAAlD,EAAAmD,cAAC2kB,GAAA,EAAD,CACEtnB,MAAOqS,IAAWouC,GAAOxvC,OAAS,YAAc,UAChD3N,UAAWlB,EAAQ0rB,KACnBjrB,UAAWk3D,EACX12D,QAASivD,GAET5vD,EAAAlD,EAAAmD,cAAC0gE,GAAA7jE,EAAD,OAEDmpC,GACCjmC,EAAAlD,EAAAmD,cAAC2kB,GAAA,EAAD,CACE47C,KAAK,MACLljE,MAAOqS,IAAWouC,GAAOvvC,QAAU,YAAc,UACjD5N,UAAWlB,EAAQ0rB,KACnBzqB,QAAS+7D,GAET18D,EAAAlD,EAAAmD,cAAC2gE,GAAA9jE,EAAD,UAqBGwjE,MC7GTviB,ID2ImB7gD,aAXJ,SAAAC,GAAK,MAAK,CAC7BuE,KAAM,CACJjE,OAAQ,OACRgB,QAAS,OACTV,cAAe,UAEjBuE,MAAO,CACLqH,SAAU,MCvICy2D,KAAWhyD,eAEpBnR,GAAYC,aAAW,SAAAC,GAAK,MAAK,CACrCuE,KAAM,CACJjE,OAAQ,OACR4E,SAAU,SACV5D,QAAS,OACTV,cAAe,UAEjB8iE,WAAY,CACV1+D,KAAM,OAER2+D,cAAe,CACbz+D,SAAU,SACVsH,SAAU,EACVo3D,WAAY,GAEdC,kBAAmB,CACjBz+D,OAAQ,IACRJ,KAAM,UA8FK8+D,GAtFH,SAAAriE,GAAgG,IAA7F+Q,EAA6F/Q,EAA7F+Q,OAAQuxD,EAAqFtiE,EAArFsiE,YAAa5nB,EAAwE16C,EAAxE06C,WAAY6nB,EAA4DviE,EAA5DuiE,aAAc/sB,EAA8Cx1C,EAA9Cw1C,cAAeC,EAA+Bz1C,EAA/By1C,eAAgB5vC,EAAe7F,EAAf6F,SACrF/E,EAAUzC,KAD0FowB,EAE/EvlB,qBAAWkzB,GAA9BiL,EAFkG5Y,EAElG4Y,SAAU2M,EAFwFvlB,EAExFulB,KAElBv3C,oBAAU,YAEH4qC,GAAY,CAAC8X,GAAOzvC,IAAKyvC,GAAOxvC,OAAQwvC,GAAOtvC,OAAQsvC,GAAOrvC,WAAWkG,QAAQjF,GAAU,GAAGwxD,EAAapjB,GAAOzvC,MACtH,CAACqB,IAEJ,IAAIyxD,GAAgB,EAChBC,EAAc,GACdC,EAAkBC,GACtB,OAAQ5xD,GACN,KAAKouC,GAAO1vC,KACVizD,EAAkBC,GAClB,MACF,KAAKxjB,GAAOzvC,IACVgzD,EAAkBE,GAClB,MACF,KAAKzjB,GAAOvvC,QACV8yD,EAAkBG,GAClBJ,EAAc,CAAEzuB,QAChB,MACF,KAAKmL,GAAOxvC,OACV+yD,EAAkBI,GAClB,MACF,KAAK3jB,GAAOtvC,OAIZ,KAAKsvC,GAAOpvC,kBAIZ,KAAKovC,GAAOnvC,mBACV0yD,EAAkBK,GAClBP,GAAgB,EAChB,MACF,KAAKrjB,GAAOrvC,UACV4yD,EAAkBvC,GAClBqC,GAAgB,EAChBC,EAAc,CAAE9iD,UAAW2iD,EAAa5nB,cAM5C,OACEt5C,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQgC,MACtB1B,EAAAlD,EAAAmD,cAAC60B,GAAA,EAAD,MADF,IAEE90B,EAAAlD,EAAAmD,cAAC2hE,GAAD,CAAYhhE,UAAWlB,EAAQmhE,aAC/B7gE,EAAAlD,EAAAmD,cAAA,OAAKW,UAAWlB,EAAQohE,eACtB9gE,EAAAlD,EAAAmD,cAACqhE,EAAoBD,IAErBD,GACAphE,EAAAlD,EAAAmD,cAACy7B,GAAA,EAAD,CAAev+B,MAAO29B,EAAOF,WAC3B56B,EAAAlD,EAAAmD,cAAC4hE,GAAD,CACE57B,SAAUA,EACVt2B,OAAQA,EACR4wD,YAAa,kBAAMY,EAAapjB,GAAO1vC,OACvC4pD,WAAY,kBAAMkJ,EAAapjB,GAAOzvC,MACtCshD,cAAe,kBAAMuR,EAAapjB,GAAOxvC,OAAQ,CAAEs7C,OAAQ,QAC3D6S,eAAgB,kBAAMyE,EAAapjB,GAAOvvC,UAC1C4lC,cAAeA,EACfC,eAAgBA,KAKtBr0C,EAAAlD,EAAAmD,cAAC6hE,GAAD,CAAiBlhE,UAAWlB,EAAQshE,oBACnCv8D,IC8CQgqC,eAEbK,GACAvP,aApDsB,SAAC3kC,EAAOwE,GAE9B,MAAO,CAAEuQ,OADU/U,EAAMwS,KAAKnS,QAAtB0U,OACSo+B,MAAOnzC,EAAMmzC,QAGL,SAAA6D,GAAQ,MAAK,CACtCuvB,aAAc,SAAC70B,EAAWqB,GACxBiE,EAASvF,GAAqBC,EAAWqB,KAE3CyG,cAAe,WACbxC,EAASvF,GAAqB+zB,KAAWhyD,cAAcO,qBAEzD0lC,eAAgB,WACdzC,EAASvF,GAAqB+zB,KAAWhyD,cAAcQ,sBAEzDi8B,eAAgB,WACd+G,EAASvF,GAAgB,WAAW,KAEtC01B,cAAe,SAACC,GACdpwB,EAASvF,GAAgB,eAAgB21B,KAE3CjX,UAAW,WACTnZ,EAASvF,GAAqB+zB,KAAWhyD,cAAcM,aAEzD4qC,WAAY,WACV1H,EAASvF,OAEX60B,YAAa,SAACxuD,EAAMg7B,GAClB,OAAQh7B,GACN,IAAK,SACHk/B,EAASvF,GAAqB+zB,KAAWhyD,cAAcK,OAAQ,CAAEi/B,uBA3HnC,SAAA/N,GAAO,OAAI,SAAA/gC,GAAmE,IAAhEmsD,EAAgEnsD,EAAhEmsD,UAAWgX,EAAqDnjE,EAArDmjE,cAAel3B,EAAsCjsC,EAAtCisC,eAAgBkD,EAAsBnvC,EAAtBmvC,MAAU3uC,EAAY1E,OAAA2E,EAAA,EAAA3E,CAAAkE,EAAA,wDAAAqjE,EAE1C/7B,GAAkB6H,EAAMT,aAAcy0B,GAAtGh7B,EAF0Gk7B,EAE1Gl7B,MAAOd,EAFmGg8B,EAEnGh8B,SAAUD,EAFyFi8B,EAEzFj8B,SAAUmB,EAF+E86B,EAE/E96B,QAASf,EAFsE67B,EAEtE77B,WAAYgB,EAF0D66B,EAE1D76B,YAElD86B,EAAeniC,KAJ6FoiC,EAOvEx3B,GAAiBoD,EAAMV,QAASxC,GAAnEI,EAP0Gk3B,EAO1Gl3B,cAAeE,EAP2Fg3B,EAO3Fh3B,gBACjBi3B,EAAan2B,KASnB,GALA5wC,oBAAU,YACS,IAAb4qC,GAAqB8H,EAAMT,aAAcy0B,GAAc,IACrC,IAAb97B,GAAuB8H,EAAMT,cAAcy0B,GAAc,IACjE,CAAC97B,IAEa,OAAbA,IAAsB8H,EAAMT,aAAc,OAAOlH,EAGrD,IAAMi8B,EAAU3nE,OAAA2J,EAAA,EAAA3J,CAAA,CACdysC,UACAC,YAAa,WACX26B,GAAc,GACd36B,MAECg7B,EANW,CAOdn8B,SAAUx8B,QAAQw8B,GAClBzO,KAAOyO,EAEHc,EACE,QACA,OAHF,UAIJggB,YAAa/gB,EACb+kB,YACA5f,kBACA7kC,aAAc,CACZmM,KAAM,GACNhM,KAAM,CACJ,CACErF,GAAI,eACJD,MAAO,KACP7D,MAAOyU,KAAOlE,UAAU,GACxBjH,SAAS,EACT0L,YAAY,EACZnP,gBAAgB,EAEhBm/D,UAAW,kBAAMhiD,QAAQC,QAAQ,CAAC,IAAK,IAAK,OAC5C1d,OAAQ,KAGZ4I,YAAa,SAAC7D,EAAOkE,GACnB,IACE,SAAAvN,OAAUqJ,EAAM89C,MAAM6c,MAAtBhkE,OAA6BqJ,EAAM89C,MAAM55C,IAE3C,MAAOjM,GACL,OAAO,UAMf,OAGEG,EAAAlD,EAAAmD,cAACy7B,GAAA,EAAD,CAAev+B,MAAO29B,EAAO1tB,MAC3BpN,EAAAlD,EAAAmD,cAACuiE,EAAA,EAAD,CAAgBC,OAAQP,GACtBliE,EAAAlD,EAAAmD,cAACuiE,EAAA,EAAD,CAAOxf,MAAOrpB,EAAS2oB,MAAOrc,GAC3B,SAAArhC,GAA8B,IAA3Bu+B,EAA2Bv+B,EAA3Bu+B,QAAS72B,EAAkB1H,EAAlB0H,MAAO7L,EAAWmE,EAAXnE,KAClB,OAAI0iC,EAAgBnjC,EAAAlD,EAAAmD,cAACqpC,GAAD,OAChBh9B,GACFrJ,QAAQqJ,MAAMA,GAEZ25B,IAAUo8B,EAAWzvB,KAAOnyC,EAAKmyC,MAEnC5yC,EAAAlD,EAAAmD,cAAC+6B,EAAW8mB,SAAZ,CAAqB9+C,MAAOq/D,GAC1BriE,EAAAlD,EAAAmD,cAACyiE,EAAD,KACE1iE,EAAAlD,EAAAmD,cAAC0/B,EAAYvgC,EACV6rC,YAqDK,SAACtL,GAAD,OAAa,SAACvgC,GAAD,OACrCY,EAAAlD,EAAAmD,cAAC0iE,GAAD,CAAepmC,SAAUqmC,IACvB5iE,EAAAlD,EAAAmD,cAAC0/B,EAAYvgC,MASFqvC,CASbwyB,ICnKI4B,GAAcp5D,QACW,cAA7BpN,OAAOujB,SAASE,UAEe,UAA7BzjB,OAAOujB,SAASE,UAEhBzjB,OAAOujB,SAASE,SAASmxB,MACvB,2DAuCN,SAAS6xB,GAAiBC,EAAOhxD,GAC/BzW,UAAU0nE,cACPC,SAASF,GACT7jD,KAAK,SAAAgkD,GACJA,EAAaC,cAAgB,WAC3B,IAAMC,EAAmBF,EAAaG,WACd,MAApBD,IAGJA,EAAiBE,cAAgB,WACA,cAA3BF,EAAiBxoE,QACfU,UAAU0nE,cAAcO,YAI1BtgE,QAAQC,IACN,gHAKE6O,GAAUA,EAAOyxD,UACnBzxD,EAAOyxD,SAASN,KAOlBjgE,QAAQC,IAAI,sCAGR6O,GAAUA,EAAO0xD,WACnB1xD,EAAO0xD,UAAUP,UAO5B/jD,MAAM,SAAA7S,GACLrJ,QAAQqJ,MAAM,4CAA6CA,YC3FjEo3D,EAAQ,KAERzgE,QAAQC,IAAI,sBACZygE,IAASj9C,OAAO1mB,EAAAlD,EAAAmD,cAAC2jE,GAAD,MAAgB7kD,SAASC,eAAe,SDYjD,SAAmBjN,GACxB,GAA6C,kBAAmBzW,UAAW,CAGzE,GADkB,IAAIwlB,IAAI/S,eAAwB1R,OAAOujB,SAASikD,MACpDC,SAAWznE,OAAOujB,SAASkkD,OAIvC,OAGFznE,OAAOC,iBAAiB,OAAQ,WAC9B,IAAMymE,EAAK,GAAAxkE,OAAMwP,eAAN,sBAEP80D,IAkEV,SAAkCE,EAAOhxD,GAEvCgyD,MAAMhB,GACH7jD,KAAK,SAAAyyB,GAEJ,IAAMqyB,EAAcryB,EAASpQ,QAAQ0G,IAAI,gBAEnB,MAApB0J,EAASsyB,QACO,MAAfD,IAA8D,IAAvCA,EAAYpvD,QAAQ,cAG5CtZ,UAAU0nE,cAAckB,MAAMhlD,KAAK,SAAAgkD,GACjCA,EAAaiB,aAAajlD,KAAK,WAC7B7iB,OAAOujB,SAASwkD,aAMpBtB,GAAgBC,EAAOhxD,KAG1BoN,MAAM,WACLlc,QAAQC,IACN,mEAxFAmhE,CAAwBtB,EAAOhxD,GAI/BzW,UAAU0nE,cAAckB,MAAMhlD,KAAK,WACjCjc,QAAQC,IACN,+GAOJ4/D,GAAgBC,EAAOhxD,MCpC/BixD","file":"static/js/main.f8448bf6.chunk.js","sourcesContent":["import { useState, useEffect, useRef } from 'react'\n\nexport const useGeolocation = () => {\n  const [state, setState] = useState({\n    accuracy: null,\n    altitude: null,\n    altitudeAccuracy: null,\n    heading: null,\n    latitude: null,\n    longitude: null,\n    speed: null,\n    timestamp: Date.now()\n  })\n  const mountedRef = useRef()\n  const watchIdRef = useRef()\n  mountedRef.current = true\n\n  const onEvent = event => {\n    if (mountedRef.current) {\n      setState({\n        accuracy: event.coords.accuracy,\n        altitude: event.coords.altitude,\n        altitudeAccuracy: event.coords.altitudeAccuracy,\n        heading: event.coords.heading,\n        latitude: event.coords.latitude,\n        longitude: event.coords.longitude,\n        speed: event.coords.speed,\n        timestamp: event.timestamp\n      })\n    }\n  }\n\n  useEffect(() => {\n    navigator.geolocation.getCurrentPosition(onEvent)\n    watchIdRef.current = navigator.geolocation.watchPosition(onEvent)\n\n    return () => {\n      mountedRef.current = false\n      navigator.geolocation.clearWatch(watchIdRef.current)\n    }\n  }, [navigator.geolocation])\n\n  return state\n}\n\nexport function useDeviceOrientation () {\n  const [deviceOrientation, setDeviceOrientation] = useState({ absolute: false, alpha: null, beta: null, gamma: null })\n\n  function handleDeviceOrientation (event) {\n    setDeviceOrientation({\n      absolute: event.absolute,\n      alpha: event.alpha,\n      beta: event.beta,\n      gamma: event.gamma\n    })\n  }\n\n  useEffect(() => {\n    window.addEventListener('deviceorientation', handleDeviceOrientation, true)\n\n    return () => {\n      window.removeEventListener('deviceorientation', handleDeviceOrientation)\n    }\n  }, [])\n\n  return deviceOrientation\n}\n\nexport function playClickAudio (clickSound) {\n  let audio = new Audio('data:audio/mp3;base64,' + clickSound.base64)\n  audio.play()\n}\n\n// Detects if device is on iOS\nexport const isIos = () => {\n  return /iphone|ipad|ipod/i.test(window.navigator.userAgent || navigator.vendor || window.opera || '')\n}\n\nexport const isPhone = () => {\n  const a = (window.navigator.userAgent || navigator.vendor || window.opera || '')\n  return /(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i\n    .test(a) ||\n  /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i\n    .test(a.substr(0, 4))\n}\n","const tagChips = {\n  height: 20\n}\n\nexport default theme => ({\n  xyTagChip: {\n    cursor: 'pointer',\n    color: 'white',\n    fontSize: '0.6em',\n    background: '#444444',\n    height: tagChips.height,\n    position: 'absolute',\n    left: -tagChips.height / 2,\n    top: -tagChips.height / 2\n  },\n  editing: {\n    // color: 'white',\n    // background: theme.palette.secondary.main\n  },\n  // The tag is flipped on the right side of the screen\n  reversedChip: {\n    flexDirection: 'row-reverse',\n    left: 'unset',\n    right: -tagChips.height / 2\n  },\n  deleteIcon: {\n    // color: 'white',\n    width: tagChips.height - 1,\n    height: tagChips.height - 1\n  },\n  chipAvatarIcon: {\n    color: 'white',\n    width: tagChips.height - 4,\n    height: tagChips.height - 4\n  },\n  chipAvatar: {\n    background: 'inherit',\n    width: tagChips.height,\n    height: tagChips.height\n  },\n  reversedDelete: {\n    margin: `0 -${tagChips.height / 8}px 0 ${tagChips.height / 8}px`\n  },\n  // The chip bucket is the container div for the chip and represents the\n  // Actual XY coordinates. The chip itself is offset to make the\n  chipBucket: {\n    width: 1,\n    height: 1,\n    display: 'flex',\n    flexDirection: 'row',\n    position: 'absolute'\n  },\n  reversedChipBucket: {\n    flexDirection: 'row-reverse'\n  }\n})\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport Draggable from 'react-draggable'\n\nimport Chip from '@material-ui/core/Chip'\nimport Avatar from '@material-ui/core/Avatar'\n\nimport CancelIcon from '@material-ui/icons/Cancel'\nimport MyLocation from '@material-ui/icons/MyLocation'\n\nimport { makeStyles, useTheme } from '@material-ui/core/styles'\nimport style from './XYTagChip.style'\n\nconst useStyles = makeStyles(style)\n\nconst XYTagChip = ({\n  color, edit, tag, newSize,\n  onTagDragOver, onTagDragStop, onNewTag, onTagDelete, ...props\n}) => {\n  const isReversed = tag.relCoords.x > newSize.newWidth / 2\n  const classes = useStyles()\n  const theme = useTheme()\n  const stopBadness = (e) => {\n    e.preventDefault()\n    e.stopPropagation()\n  }\n\n  const handleDrag = (e, data) => {\n    stopBadness(e)\n    onTagDragOver(data, tag)\n  }\n  const handleStopDrag = (e, data) => {\n    stopBadness(e)\n    onTagDragStop(data, tag)\n  }\n\n  // Draggable chip if it is editable\n  return (\n    <Draggable\n      disabled={!edit}\n      bounds={{ left: 10, top: 10, right: newSize.newWidth - 10, bottom: newSize.newHeight - 10 }}\n      position={{ x: tag.relCoords.x, y: tag.relCoords.y }}\n      onDrag={handleDrag}\n      onStop={handleStopDrag}\n      onClick={stopBadness}\n    >\n      <div className={classNames(classes.chipBucket, isReversed && classes.reversedChipBucket)}>\n        <Chip\n          style={{\n            background: color ? `${color}!important` : null,\n            color: color ? `${theme.palette.getContrastText(color)}!important` : null\n          }}\n          color={edit ? 'secondary' : 'default'}\n          label={tag.label}\n          data={tag.id}\n          onClick={stopBadness}\n          onDelete={edit ? onTagDelete(tag) : null}\n          deleteIcon={edit ? <CancelIcon className={classNames(classes.deleteIcon, isReversed && classes.reversedDelete)} /> : <div />}\n          className={classNames(\n            classes.xyTagChip,\n            isReversed && classes.reversedChip,\n            edit && classes.editing\n          )}\n          {...props}\n          avatar={<Avatar className={classNames(classes.chipAvatar, edit && classes.editing)}>\n            <MyLocation className={classNames(classes.chipAvatarIcon, edit && classes.editing)} />\n          </Avatar>}\n        />\n      </div>\n    </Draggable>\n  )\n}\n\nXYTagChip.propTypes = {\n  color: PropTypes.string,\n  edit: PropTypes.bool,\n  tag: PropTypes.object.isRequired,\n  newSize: PropTypes.object,\n  onTagDragOver: PropTypes.func,\n  onTagDragStop: PropTypes.func,\n  onNewTag: PropTypes.func,\n  onTagDelete: PropTypes.func\n}\n\nexport default XYTagChip\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\nimport Paper from '@material-ui/core/Paper'\nimport Typography from '@material-ui/core/Typography'\nimport TextField from '@material-ui/core/TextField'\nimport MenuItem from '@material-ui/core/MenuItem'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport Select from 'react-select'\nimport CreatableSelect from 'react-select/lib/Creatable'\nimport style from './XYTagSelect.style'\n\nconst useStyles = makeStyles(style)\n\nconst XYTagSelect = ({ tagConfig, onChange }) => {\n  const classes = useStyles()\n  const options = tagConfig.values.map(tc => ({ label: tc.label, value: tc.id }))\n  console.log('XYTagSelect', tagConfig)\n  return (\n    <div className={classes.root}>\n      {!tagConfig.allowAdditions && (\n        <Select\n          options={options}\n          classes={classes}\n          components={{\n            Control,\n            Menu,\n            NoOptionsMessage,\n            Option,\n            Placeholder,\n            ValueContainer\n          }}\n          value={null}\n          // onBlur={e => e.preventDefault()}\n          blurInputOnSelect\n          isClearable={false}\n          onChange={onChange}\n          placeholder={tagConfig.label}\n          isSearchable\n        />\n      ) }\n      { tagConfig.allowAdditions && (\n        <CreatableSelect\n          options={options}\n          classes={classes}\n          components={{\n            Control,\n            Menu,\n            NoOptionsMessage,\n            Option,\n            Placeholder,\n            ValueContainer\n          }}\n          value={null}\n          isClearable={false}\n          // onBlur={e => e.preventDefault()}\n          blurInputOnSelect\n          onChange={onChange}\n          placeholder={tagConfig.label}\n          isSearchable\n        />\n      )}\n    </div>\n  )\n}\nXYTagSelect.propTypes = {\n  tagConfig: PropTypes.object.isRequired,\n  onChange: PropTypes.func.isRequired\n}\n\nexport default XYTagSelect\n\nfunction Control (props) {\n  return (\n    <TextField\n      fullWidth\n      InputProps={{\n        inputComponent,\n        inputProps: {\n          className: props.selectProps.classes.input,\n          inputRef: props.innerRef,\n          children: props.children,\n          ...props.innerProps\n        }\n      }}\n      {...props.selectProps.textFieldProps}\n    />\n  )\n}\n\nconst NoOptionsMessage = ({ innerProps, selectProps, children }) => (\n  <Typography\n    color='textSecondary'\n    className={selectProps.classes.noOptionsMessage}\n    {...innerProps}\n  >\n    {children}\n  </Typography>\n)\n\nconst Menu = ({ selectProps, innerProps, children }) => (\n  <Paper square className={selectProps.classes.paper} {...innerProps}>\n    {children}\n  </Paper>\n)\n\nconst inputComponent = ({ inputRef, ...props }) => <div ref={inputRef} {...props} />\n\nconst Placeholder = (props) => (\n  <Typography\n    color='textSecondary'\n    className={props.selectProps.classes.placeholder}\n    {...props.innerProps}\n  >\n    {props.children}\n  </Typography>\n)\n\nconst Option = ({ innerRef, isFocused, isSelected, innerProps, children }) => (\n  <MenuItem\n    buttonRef={innerRef}\n    selected={isFocused}\n    component='div'\n    style={{ fontWeight: isSelected ? 500 : 400 }}\n    {...innerProps}\n  >\n    {children}\n  </MenuItem>\n)\n\nconst ValueContainer = ({ selectProps, children }) => (\n  <div className={selectProps.classes.valueContainer}>{children}</div>\n)\nValueContainer.propTypes = {\n  selectProps: PropTypes.object.isRequired,\n  children: PropTypes.any\n}\n","export default theme => ({\n  root: {\n    width: '100%'\n  },\n  noOptionsMessage: {\n    padding: `${theme.spacing(1)}px ${theme.spacing(1) * 2}px`\n  },\n  singleValue: {\n    fontSize: 16\n  },\n  placeholder: {\n    position: 'absolute',\n    left: 2,\n    fontSize: 16\n  },\n  input: {\n    display: 'flex',\n    padding: 0\n  },\n  valueContainer: {\n    display: 'flex',\n    flexWrap: 'wrap',\n    flex: 1,\n    alignItems: 'center',\n    overflow: 'hidden'\n  },\n  paper: {\n    position: 'absolute',\n    zIndex: 100,\n    marginTop: theme.spacing(1),\n    left: 0,\n    right: 0\n  }\n})\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport Typography from '@material-ui/core/Typography'\nimport IconButton from '@material-ui/core/IconButton'\n\nimport CloseIcon from '@material-ui/icons/Close'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport XYTagSelect from './XYTagSelect'\nimport style from './XYTagChooser.style'\n\nconst useStyles = makeStyles(style)\n\nconst XYTagChooser = ({ coords, open, seriesConfig, onNewTag, onClose }) => {\n  const classes = useStyles()\n  const xyTags = seriesConfig.tags.filter(t => t.allowXY)\n  if (!coords) return null\n  return (\n    <Dialog\n      open={open}\n      scroll='paper'\n      fullScreen\n      classes={{ paperScrollPaper: classes.root }}\n      onClose={() => onClose()}\n      aria-labelledby='simple-dialog-title'\n    >\n      <DialogTitle id='simple-dialog-title' className={classes.header}>\n      New Tag:\n        <IconButton className={classes.closeButton} onClick={onClose}>\n          <CloseIcon />\n        </IconButton>\n      </DialogTitle>\n      <div className={classes.dlgBody}>\n        {xyTags.length > 1 && (\n          <Typography variant='caption'>What kind of tag would you like to create?</Typography>\n        )}\n\n        {xyTags.map((tagType, idx) => (\n          <div className={classes.listItem} key={`tagSelect${idx}`}>\n            <XYTagSelect tagConfig={tagType} onChange={onNewTag(coords, tagType)} />\n          </div>\n        ))}\n      </div>\n    </Dialog>\n  )\n}\n\nXYTagChooser.propTypes = {\n  seriesConfig: PropTypes.object.isRequired,\n  open: PropTypes.bool.isRequired,\n  coords: PropTypes.object,\n  onClose: PropTypes.func.isRequired,\n  onNewTag: PropTypes.func.isRequired\n}\n\nexport default XYTagChooser\n","export default theme => ({\n  root: {\n    overflow: 'visible'\n  },\n  header: {\n    padding: theme.spacing(1) * 2\n  },\n  listItem: {\n    flexDirection: 'column'\n  },\n  dlgBody: {\n    paddingLeft: theme.spacing(1) * 2,\n    paddingRight: theme.spacing(1) * 2,\n    paddingBottom: theme.spacing(1) * 2\n  },\n  closeButton: {\n    position: 'absolute',\n    right: theme.spacing(1),\n    top: theme.spacing(1),\n    color: theme.palette.grey[500]\n  }\n})\n","import React, { useState, useContext } from 'react'\nimport { SeriesContext } from '../../contexts'\nimport XYTagChooser from './XYTagChooser'\nimport Tags from '../../../../lib/Tags'\n\nconst useXYTags = (photo, newSize, onChange, setResizeActive) => {\n  const { seriesConfig } = useContext(SeriesContext)\n\n  // we hold the tags in state so that every little drag motion\n  // doesn't cause an updated state until you let go\n  const [isDragging, setIsDragging] = useState(false)\n  const [newTagDialog, setNewTagDialog] = useState(null)\n\n  const tagClass = new Tags(seriesConfig, photo.tags)\n\n  const onNewTag = (coords, tagType) => ({ value, __isNew__: isNew }) => {\n    let addTag = isNew\n      ? tagClass.createNewXYTagObj(value, tagType.id, coords)\n      : tagClass.createExistingXYTagObj(value, tagType.id, coords)\n\n    setNewTagDialog(null)\n    onChange({ ...photo, tags: [...photo.tags, addTag] })\n  }\n\n  const onTagDelete = (tag) => () => {\n    const tags = photo.tags.filter(oldTag => oldTag.id !== tag.id)\n    onChange({\n      ...photo,\n      tags\n    })\n  }\n\n  // When the photo is tapped, send the x,y coords of that tap\n  // to a dialog we will open\n  const onAddTagTrigger = (e) => {\n    if (!newTagDialog) {\n      // Turn off resizing so mobile keyboards don't complete F us.\n      setResizeActive(false)\n      setNewTagDialog({\n        x: parseInt(e.pageX - (window.innerWidth - newSize.newWidth) / 2 * newSize.multiplier, 10),\n        y: parseInt(e.pageY - (window.innerHeight - newSize.newHeight) / 2 * newSize.multiplier, 10)\n      })\n    }\n  }\n\n  // This gets used by the drag AND the stop\n  const updateTagLocation = ({ x, y }, tag) => {\n    const newTags = photo.tags.map(oldTag => {\n      if (oldTag.id !== tag.id) return oldTag\n      else {\n        let newX = parseInt(x / newSize.multiplier, 10)\n        let newY = parseInt(y / newSize.multiplier, 10)\n\n        return {\n          ...oldTag,\n          coords: { x: newX, y: newY }\n        }\n      }\n    })\n    return newTags\n  }\n\n  const onTagDragStop = (coords, tag) => {\n    const tags = updateTagLocation(coords, tag)\n    setIsDragging(false)\n    onChange({\n      ...photo,\n      tags\n    })\n  }\n\n  const onTagDragOver = (coords, tag) => {\n    updateTagLocation(coords, tag)\n    setIsDragging(true)\n  }\n  const TagChooser = () => (\n    <XYTagChooser\n      open={!isDragging && Boolean(newTagDialog)}\n      coords={newTagDialog}\n      seriesConfig={seriesConfig}\n      onNewTag={onNewTag}\n      onClose={() => {\n        setNewTagDialog(null)\n        // Turn on resizing again.\n        setResizeActive(true)\n      }}\n    />\n  )\n\n  return {\n    onNewTag,\n    onTagDelete,\n    onAddTagTrigger,\n    onTagDragOver,\n    onTagDragStop,\n    TagChooser,\n    getRelXYTags: tagClass.getRelXYTags\n  }\n}\n\nexport default useXYTags\n","import React from 'react'\nimport Typography from '@material-ui/core/Typography'\nimport BrokenImageIcon from '@material-ui/icons/BrokenImage'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    flexGrow: 1,\n    padding: '10%',\n    display: 'flex',\n    flexDirection: 'column',\n    opacity: 0.3,\n    textAlign: 'center',\n    color: theme.palette.grey[100]\n  },\n  icon: {\n    width: '100%',\n    flex: '1 1 40%',\n    color: theme.palette.grey[100],\n    opacity: 0.5\n  },\n  primary: {\n    color: theme.palette.grey[100],\n    textAlign: 'center',\n    flex: '1 1 30%',\n    width: '100%'\n  },\n  secondary: {\n    flex: '1 1 30%',\n    width: '100%'\n  }\n}))\n\nconst BrokenImg = () => {\n  const classes = useStyles()\n  return (\n    <div className={classes.root}>\n      <BrokenImageIcon className={classes.icon} />\n      <Typography className={classes.primary}>Img not found</Typography>\n    </div>\n  )\n}\n\nexport default BrokenImg\n","import React, { useState, useRef, useContext, useEffect } from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport useComponentSize from '../../../../lib/useComponentSize'\n\nimport { SeriesContext } from '../../contexts'\nimport XYTagChip from '../tags/XYTagChip'\nimport useXYTags from '../tags/useXYTags'\nimport BrokenImg from './BrokenImg'\nimport style from './Photo.style'\n\nconst useStyles = makeStyles(style)\n\nconst Photo = ({ photo, opacity, edit, showTags, transition, onChange, className }) => {\n  const classes = useStyles()\n  const refImgWrap = useRef(null)\n  const [newSize, setNewSize] = useState({ multiplier: 1 })\n  const [url, setUrl] = useState(null)\n  const [broken, setBroken] = useState(false)\n  const [urlRetryCounter, setURLRetryCounter] = useState(0)\n  const { seriesConfig } = useContext(SeriesContext)\n\n  useEffect(() => {\n    function getURL () {\n      if (!photo.base64) {\n        const newUrl = seriesConfig.getPhotoUrl(photo, 'large')\n        if (refImgWrap.current) setUrl(newUrl)\n      }\n      else {\n        if (refImgWrap.current) setUrl(photo.base64)\n      }\n    }\n    getURL()\n  }, [photo])\n\n  const { size: { height, width }, setResizeActive } = useComponentSize(refImgWrap)\n  const urlWithRetries = urlRetryCounter > 0 ? `${url}?retry=${urlRetryCounter}` : url\n\n  // All tag-related info is put in its own hook\n  const { onAddTagTrigger, TagChooser, getRelXYTags, onTagDragOver, onTagDragStop, onTagDelete } = useXYTags(photo, { height, width }, onChange, setResizeActive)\n\n  const handleImageLoaded = event => {\n    if (refImgWrap.current) {\n      setBroken(false)\n      const { naturalHeight, naturalWidth } = event.target\n      // 4 different cases of orientation:\n      const multiplier = Math.min(\n        height / naturalHeight,\n        width / naturalWidth\n      )\n\n      const newWidth = multiplier * naturalWidth\n      const newHeight = multiplier * naturalHeight\n      setNewSize({ newWidth, newHeight, naturalWidth, naturalHeight, multiplier })\n    }\n  }\n\n  return (\n    <div className={classNames(classes.root, className)}\n      style={{ opacity: opacity !== null ? opacity : 1 }}\n      ref={refImgWrap}\n    >\n      <div className={classes.inner}\n        style={{\n          height: newSize ? newSize.newHeight : 1,\n          width: newSize ? newSize.newWidth : 1\n        }}\n        onClick={onAddTagTrigger}\n      >\n        { showTags || edit\n          ? (\n            <div className={className}>\n              { getRelXYTags(newSize.multiplier).map((tag, idx) => (\n                <XYTagChip\n                  key={`xytag-${idx}`}\n                  color={tag.color}\n                  {...{ edit, newSize, tag, onTagDragOver, onTagDragStop, onTagDelete }} />\n              ))}\n            </div>\n          ) : null\n        }\n        {broken && <BrokenImg />}\n        <img className={classNames(broken ? classes.brokenImg : classes.img)}\n          alt={urlWithRetries}\n          onError={(err) => {\n            if (urlRetryCounter < 10) {\n              setBroken(true)\n              console.log('Image Retry', urlRetryCounter)\n              console.error(err)\n              setTimeout(() => {\n                if (refImgWrap.current) setURLRetryCounter(urlRetryCounter + 1)\n              }, 4000)\n            }\n          }}\n          src={urlWithRetries}\n          onLoad={handleImageLoaded}\n          style={{ height: newSize.newHeight, width: newSize.newWidth }}\n        />\n      </div>\n      {edit && <TagChooser />}\n    </div>\n  )\n}\n\nPhoto.propTypes = {\n  className: PropTypes.string,\n  opacity: PropTypes.number,\n  photo: PropTypes.object.isRequired,\n  edit: PropTypes.bool,\n  showTags: PropTypes.bool,\n  transition: PropTypes.string,\n  onChange: PropTypes.func\n}\n\nexport default Photo\n","// import { fade } from '@material-ui/core/styles/colorManipulator'\nexport default theme => ({\n  root: {\n    // maxWidth: 400,\n    display: 'block',\n    position: 'relative',\n    width: '100%',\n    height: '100%',\n    background: 'black',\n    overflow: 'hidden'\n  },\n  inner: {\n    position: 'absolute',\n    top: '50%',\n    left: '50%',\n    transform: 'translateY(-50%) translateX(-50%)',\n    overflow: 'hidden'\n  },\n  xyTags: {\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    // opacity: 0.8,\n    // border: '4px solid red',\n    height: '100%',\n    width: '100%'\n    // background: 'rgba(150, 150, 150, 0.5)'\n  },\n  img: {\n    display: 'block'\n  },\n  brokenImg: {\n    display: 'none'\n  },\n  formControl: {\n    width: '100%'\n  }\n})\n","import MapStyles from './mapStyles'\nimport {\n  green, blue, red\n} from '@material-ui/core/colors'\n\nexport default {\n  // Bright Pastel\n  tagColors: [\n    '#418CF0', '#FCB441', '#E0400A', '#056492', '#BFBFBF', '#1A3B69', '#FFE382', '#129CDD', '#CA6B4B',\n    '#005CDB', '#F3D288', '#506381', '#F1B9A8', '#E0830A', '#7893BE'\n  ]\n}\n\nexport const mapConfig = {\n  mapBoxToken: process.env.REACT_APP_MAPBOX_TOKEN,\n  styles: MapStyles\n}\n\nlet baseurl = process.env.REACT_APP_BASEURL\nlet basename = process.env.REACT_APP_BASENAME\nlet domain = process.env.REACT_APP_DOMAIN\nif (process.env.NODE_ENV && process.env.NODE_ENV === 'development') {\n  domain = 'localhost'\n  basename = ''\n}\nconsole.log('config: ', baseurl, basename)\n\nexport const home = {\n  AppStateTypes: {\n    FEED: 'feed', // Looking at the Home Feed\n    MAP: 'map', // Looking at the map\n    SEARCH: 'search', // looking at the search\n    PROFILE: 'profile', // Looking at user information\n    SERIES: 'series', // Looking at one particular series\n    QRCAPTURE: 'QRCapture', // Capture a QRCode\n    NEW_SERIES_CAMERA: 'new_series_camera', // Looking at one particular sereis\n    NEW_SERIES_LIBRARY: 'new_series_library' // Looking at one particular sereis\n  },\n  SEARCH_TABS: {\n    TAG: 'tag',\n    LOCATION: 'location',\n    USER: 'user'\n  },\n  MapModeTypes: {\n    FREE: 'free', //\n    USER: 'user', // filtered to a given user\n    TAG: 'tag' // filtered to a given tag\n  }\n}\n\nexport const federated = {\n  // oauth_config: {\n\n  // },\n  // google_client_id: process.env.REACT_APP_GOOGLE_APP_ID\n}\n\nexport const endpoints = {\n  graphql: process.env.REACT_APP_GRAPHQL\n}\n\nexport const localDb = {\n  imgStore: 'imgStore'\n}\n\nexport const aws = {\n  Auth: {\n    // REQUIRED - Amazon Cognito Identity Pool ID\n    // identityPoolId: process.env.REACT_APP_COGNITO_IDPOOLID, // XX-XXXX-X:XXXXXXXX-XXXX-1234-abcd-1234567890ab\n    // REQUIRED - Amazon Cognito Region\n    region: process.env.REACT_APP_AWS_REGION,\n    // OPTIONAL - Amazon Cognito User Pool ID\n    userPoolId: process.env.REACT_APP_COGNITO_USER_POOL_ID,\n    // OPTIONAL - Amazon Cognito Web Client ID (26-char alphanumeric string)\n    userPoolWebClientId: process.env.REACT_APP_COGNITO_CLIENT_ID,\n    // OPTIONAL - Enforce user authentication prior to accessing AWS resources or not\n    mandatorySignIn: true,\n    // OPTIONAL - Configuration for cookie storage\n    cookieStorage: {\n      // REQUIRED - Cookie domain (only required if cookieStorage is provided)\n      domain: `${domain}`,\n      // OPTIONAL - Cookie path\n      // path: `/${basename}`,\n      // OPTIONAL - Cookie expiration in days\n      expires: 20,\n      // OPTIONAL - Cookie secure flag\n      secure: false\n    }\n\n  }\n\n}\n\nexport const ACCESS = {\n  OPEN: {\n    label: 'Open',\n    description: 'Anyone can see and contribute photos to this series.',\n    color: green\n  },\n  PRIVATE: {\n    label: 'Private',\n    description: 'Can only be seen by their createors',\n    color: red\n  },\n  PUBLIC: {\n    label: 'Public',\n    description: 'Anyone can see this series. Only the owner can add photos.',\n    color: blue\n  }\n}\n","import { useCallback, useState, useLayoutEffect, useRef } from 'react'\nimport { debounce } from './util'\n\nconst getSize = (el, minSize, defaultSize) => {\n  if (!el) return defaultSize || minSize || { width: 0, height: 0 }\n\n  if (minSize) {\n    return {\n      width: Math.max(minSize.width, el.offsetWidth),\n      height: Math.max(minSize.height, el.offsetHeight)\n    }\n  }\n  else {\n    return {\n      width: el.offsetWidth,\n      height: el.offsetHeight\n    }\n  }\n}\n\nconst useComponentSize = (ref, minSize, defaultSize) => {\n  const resizeActiveRef = useRef()\n  const [resizeActive, setResizeActive] = useState(true)\n\n  resizeActiveRef.current = resizeActive\n  const [size, setComponentSize] = useState(\n    getSize(ref ? ref.current : null, minSize, defaultSize)\n  )\n\n  const handleResize = () => {\n    if (!resizeActiveRef.current || !ref.current) return\n    const newSize = getSize(ref.current, minSize, defaultSize)\n    if (newSize.height !== size.height || newSize.width !== size.width) {\n      // console.log('handleResize Called', { newSize, size })\n      setComponentSize(newSize)\n    }\n  }\n\n  const handleResizeDebounced = useCallback(\n    debounce(handleResize, 500),\n    []\n  )\n\n  useLayoutEffect(() => {\n    if (!ref.current) return\n    handleResize()\n\n    if (typeof ResizeObserver === 'function') {\n      let resizeObserver = new ResizeObserver(handleResizeDebounced)\n      resizeObserver.observe(ref.current)\n\n      return () => {\n        resizeObserver.disconnect(ref.current)\n        resizeObserver = null\n      }\n    }\n    else {\n      window.addEventListener('resize', handleResizeDebounced)\n\n      return () => {\n        window.removeEventListener('resize', handleResizeDebounced)\n      }\n    }\n  },\n  [ref.current])\n\n  return { size, setResizeActive }\n}\n\nexport default useComponentSize\n","const TYPES = {\n  // Series meta gets appended automatically to the seriees\n  SERIES: 'SERIES',\n  // Same but now only gets appended to the photo\n  PHOTO: 'PHOTO'\n}\nclass SeriesConfig {\n  constructor (seriesConfig) {\n    if (!seriesConfig) throw new Error('No seriesConfig object provided to SeriesConfig class')\n    this.config = seriesConfig\n  }\n\n  getTagType = (typeId) => this.config.tags.find(tt => tt.id === typeId)\n  // getTagTypeIndex = (typeId) => this.config.tags.findIndex(tt => tt.id === typeId)\n  getTagTypeIndex = (typeId) => {\n    // console.log('HERE', typeId)\n    return this.config.tags.findIndex(tt => tt.id === typeId)\n  }\n\n  getXYTagTypes = () => this.config.tags.filter(tt => tt.allowXY)\n  getNonXYTagTypes = () => this.config.tags.filter(tt => tt.allowNonXY)\n\n  getSeriesMeta = () => Object.keys(this.config.meta)\n    .filter(key => this.config.meta[key].type === TYPES.SERIES)\n    .reduce((acc, key) => ({\n      ...acc,\n      [key]: this.config.meta[key].default\n    }), {})\n\n  getPhotoMeta = () => Object.keys(this.config.meta)\n    .filter(key => this.config.meta[key].type === TYPES.PHOTO)\n    .reduce((acc, key) => ({\n      ...acc,\n      [key]: this.config.meta[key].default\n    }), {})\n}\n\nexport default SeriesConfig\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Chip from '@material-ui/core/Chip'\nimport CancelIcon from '@material-ui/icons/Cancel'\nimport { makeStyles, useTheme } from '@material-ui/core/styles'\n\nexport const tagChips = {\n  height: 20\n}\n\nconst style = theme => ({\n  root: {\n    fontSize: '0.6em',\n    height: tagChips.height,\n    marginRight: theme.spacing(1) / 2,\n    marginTop: theme.spacing(1) / 2\n  },\n  deleteIcon: {\n    width: tagChips.height - 1,\n    height: tagChips.height - 1\n  },\n  chipAvatar: {\n    width: tagChips.height,\n    height: tagChips.height\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst TagChip = ({ edit, tag, color, onDelete, ...props }) => {\n  const classes = useStyles()\n  const theme = useTheme()\n  return (\n    <Chip\n      style={{\n        background: color || null,\n        color: color ? `${theme.palette.getContrastText(color)}` : null\n      }}\n      label={tag.label}\n      data={tag.id}\n      onDelete={edit ? () => onDelete(tag) : null}\n      deleteIcon={(\n        <CancelIcon\n          className={classes.deleteIcon}\n          onClick={e => {\n            console.log('this click')\n          }}\n          style={{\n            opacity: 0.5,\n            color: color ? `${theme.palette.getContrastText(color)}` : null\n          }}\n        />\n      )}\n      className={classes.root}\n      {...props}\n    />\n  )\n}\n\nTagChip.propTypes = {\n  color: PropTypes.string.isRequired,\n  edit: PropTypes.bool,\n  tag: PropTypes.object.isRequired,\n  onDelete: PropTypes.func\n}\n\nexport default TagChip\n","import React from 'react'\nimport classNames from 'classnames'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport FormLabel from '@material-ui/core/FormLabel'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n    position: 'relative',\n    display: 'block',\n    overflow: 'hidden',\n    whiteSpace: 'pre-line',\n    '&::before': {\n      content: '\"  \"',\n      display: 'block',\n      position: 'absolute',\n      bottom: 0,\n      width: '100%',\n      height: 100,\n      background: `linear-gradient(180deg, rgba(255,255,255,0) 0%, ${theme.palette.background.paper} 100%)`\n    }\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst ShortLongText = ({ label, text, height, onClick }) => {\n  const classes = useStyles()\n  return (\n    <div onClick={onClick}>\n      {label && (\n        <FormLabel className={classes.formLabel}>\n          {label}\n        </FormLabel>\n      )}\n      <Typography\n\n        variant='body1'\n        color='inherit'\n        style={{ height }}\n        className={classNames(classes.root)}\n      >\n        {text}\n      </Typography>\n    </div>\n  )\n}\n\nShortLongText.propTypes = {\n  label: PropTypes.string,\n  text: PropTypes.string,\n  height: PropTypes.number,\n  onClick: PropTypes.func\n}\nShortLongText.defaultProps = {\n  height: 100\n}\n\nexport default ShortLongText\n","import uuid from 'uuid/v4'\nimport SeriesConfig from './SeriesConfig'\n\nclass Tags {\n  constructor (seriesConfig, tags) {\n    this.tags = tags\n    this.seriesConfig = new SeriesConfig(seriesConfig)\n  }\n\n  findTagById = (typeId, tagId) => {\n    return this.seriesConfig.getTagType(typeId).values\n      .find(tt => tt.id === tagId)\n  }\n\n  // Filter the list of tags to those that are XY tags\n  getXYTags = () => {\n    const xyTagIds = this.seriesConfig.getXYTagTypes().map(tt => tt.id)\n    return this.tags.filter(tag => xyTagIds.indexOf(tag.typeId) > -1 && tag.coords && tag.coords.x)\n  }\n\n  getNonXYTags = () => {\n    const NonXYTagIds = this.seriesConfig.getNonXYTagTypes().map(tt => tt.id)\n    return this.tags.filter(tag => NonXYTagIds.indexOf(tag.typeId) > -1)\n  }\n\n  createNewTagObj = (label, typeId) => (\n    { id: uuid(), label, typeId }\n  )\n\n  createExistingTagObj = (id, typeId) => ({\n    ...this.findTagById(typeId, id),\n    typeId\n  })\n\n  createNewXYTagObj = (label, typeId, coords) => ({\n    id: uuid(),\n    label,\n    typeId,\n    coords\n  })\n\n  createExistingXYTagObj = (id, typeId, coords) => ({\n    ...this.findTagById(typeId, id),\n    typeId,\n    coords\n  })\n\n  // Get tags in a way that's easy to render them\n  // We augment these tags with relative positions\n  // and a group number for coloring.\n  getRelXYTags = (multiplier) => this.getXYTags().map(tag => ({\n    ...tag,\n    group: this.seriesConfig.getTagTypeIndex(tag.typeId),\n    relCoords: {\n      x: tag.coords.x * multiplier,\n      y: tag.coords.y * multiplier\n    }\n  }))\n}\n\nexport default Tags\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n    color: theme.palette.primary.main,\n    position: 'absolute',\n    top: '50%',\n    left: '50%',\n    textAlign: 'center',\n    transformOrigin: '50% 50%',\n    transform: 'translateY(-50%) translateX(-50%)',\n    zIndex: 1\n  },\n  rootActive: {\n    zIndex: 1000\n  },\n  svgDot: {\n    zIndex: 102,\n    width: 20,\n    height: 20,\n    position: 'absolute',\n    top: '50%',\n    left: '50%',\n    textAlign: 'center',\n    transformOrigin: '50% 50%',\n    transform: 'translateY(-50%) translateX(-50%)'\n  },\n  dot: {\n    stroke: theme.palette.secondary.contrastText,\n    strokeWidth: '1',\n    fill: theme.palette.secondary.main\n  },\n  directionIndicator: {\n    position: 'absolute',\n    left: '50%',\n    // transformOrigin: '50% 50%',\n    // transform: 'translateY(-50%) translateX(-50%)',\n    zIndex: 100\n  },\n  name: {\n    color: 'white',\n    fontWeight: 'bold',\n    textShadow: `\n        0px 0px 4px #000000, \n        0px 0px 4px #000000 \n    `,\n    zIndex: 122,\n    position: 'relative'\n    // textStroke: '1px white'\n  },\n  nameActive: {\n    color: theme.palette.secondary.dark,\n    textShadow: `\n    0px 0px 2px #FFFFFF, \n    0px 0px 2px #FFFFFF,\n    0px 0px 4px #FFFFFF \n`\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst Single = ({ direction }) => {\n  const classes = useStyles()\n  return (\n    <div className={classes.root}>\n      <svg className={classes.svgDot} version='1.1' viewBox='0, 0, 10, 10' >\n        <circle cx='5' cy='5' r='4' className={classes.dot} />\n      </svg>\n      {direction && direction >= 0 ? (\n        <div className={classes.directionIndicator}>\n          <svg className={classes.svgArc}\n            version='1.1'\n            width='100'\n            height='100'\n            viewBox='0, 0, 100, 100'\n            style={{ transform: `translateY(-50%) translateX(-50%) rotateZ(${direction}deg)` }}>\n            <path d='M50,0 C60.946,0.151 72.136,3.514 80.675,10.56 L50,50 L19.325,10.56 C27.938,3.461 39,0.278 50,0 z'\n              fill='#009DC1'\n              fillOpacity='0.444'\n              strokeWidth='0.5'\n              strokeOpacity='0.6'\n              stroke='#FFFFFF'\n            />\n          </svg>\n        </div>\n      ) : null}\n    </div>\n  )\n}\n\nSingle.propTypes = {\n  direction: PropTypes.number\n}\n\nexport default Single\n","import React, { useState, useRef, useMemo } from 'react'\nimport { StaticMap } from 'react-map-gl'\nimport PropTypes from 'prop-types'\nimport { getDistanceScales } from 'viewport-mercator-project'\nimport useComponentSize from '../../lib/useComponentSize'\nimport StyleButtons from './controls/StyleButtons'\nimport { mapConfig } from '../../config'\nimport classNames from 'classnames'\nimport 'mapbox-gl/dist/mapbox-gl.css'\nimport './BaseMap.css'\n\n/**\n * Note that this component technically has state but it is designed to be functionally stateless\n */\nconst BaseStaticMap = (props) => {\n  const {\n    controlPadding,\n    viewport,\n    children,\n    mapStyles,\n    onMapDataEvent,\n    ...passthroughProps\n  } = props\n\n  const mapRef = useRef(null)\n  const { size } = useComponentSize(mapRef, { width: 100, height: 50 })\n\n  const [currStyle, setCurrStyle] = useState(0)\n  const [projection, setProjection] = useState(null)\n\n  const recalcProjection = () => {\n    if (!size || size.width < 10 || size.height < 10) return\n    try {\n      const projection = getDistanceScales(viewport)\n      // console.log('recalcProjection', { projection, size })\n      setProjection(projection)\n    }\n    catch (e) {\n      // Sometimes we don't have a valid bound. Don't make a big deal out of it.\n      console.error(e)\n    }\n  }\n\n  if (!projection) recalcProjection()\n  useMemo(recalcProjection, [size])\n\n  return (\n    <div className={classNames('BaseMap', props.className)} ref={mapRef} style={{ height: '100%', width: '100%' }}>\n      <StaticMap\n        {...viewport}\n        height={size.height}\n        width={size.width}\n        mapStyle={mapStyles[currStyle].style}\n        onData={onMapDataEvent}\n        mapboxApiAccessToken={mapConfig.mapBoxToken}\n        {...passthroughProps}\n      >\n        { mapStyles && mapStyles.length > 1 ? (\n          <StyleButtons\n            controlPadding={controlPadding}\n            currStyle={currStyle}\n            mapStyles={mapStyles}\n            setCurrStyle={setCurrStyle}\n          />\n        ) : null }\n        {\n          children && Array.isArray(children)\n            ? children.map(c => handleChild(c, viewport, size.height, size.width, projection))\n            : handleChild(children, viewport, size.height, size.width, projection)\n        }\n      </StaticMap>\n    </div>\n  )\n}\n\nfunction handleChild (child, viewport, height, width, projection) {\n  return typeof child === 'function'\n    ? child(viewport, height, width, projection)\n    : child\n}\n\nBaseStaticMap.propTypes = {\n  // Anything else we want to add to the map\n  children: PropTypes.any,\n  deckelements: PropTypes.array,\n  data: PropTypes.array,\n  // Maybe we want map controls to be padded\n  controlPadding: PropTypes.object,\n\n  minPitch: PropTypes.number,\n  maxPitch: PropTypes.number,\n  pitch: PropTypes.number,\n\n  // Lock the bounds of a map to a rectangle [minlng, minlat], [maxlng, maxlat]\n  bounds: PropTypes.array,\n  // Lock the possible zoom levels to a range: [minZoom, maxZoom]\n  zoomBounds: PropTypes.array,\n  // InitialBounds of the map.\n  InnerBounds: PropTypes.array,\n\n  // List of valid styles that will get picker buttons\n  mapStyles: PropTypes.array,\n\n  // Just some default props we probably won't set.\n  latitude: PropTypes.number,\n  longitude: PropTypes.number,\n  zoom: PropTypes.number,\n\n  onMapDataEvent: PropTypes.func\n}\nBaseStaticMap.defaultProps = {\n  controlPadding: {},\n  stylechooser: true,\n  // viewport: {\n  //   zoom: 12,\n  //   latitude: 49.3050394,\n  //   longitude: -123.1398254\n  // },\n  initStyle: 0,\n  mapStyles: mapConfig.styles\n}\n\nexport default BaseStaticMap\n","import React from 'react'\nimport PropTypes from 'prop-types'\n// import { makeStyles } from '@material-ui/core/styles'\nimport { Marker } from 'react-map-gl'\nimport BaseMap from './BaseMap'\nimport Dot from './markers/Dot'\nimport BaseStaticMap from './BaseStaticMap'\n// import style from './MapDot.style'\n\n// const useStyles = makeStyles(style)\n\nconst MapDot = ({ staticMap, editable, latitude, longitude, onChange, direction, ...props }) => {\n  const Map = staticMap ? BaseStaticMap : BaseMap\n  // const classes = useStyles()\n  const mapProps = staticMap ? {} : {\n    touchRotate: false,\n    dragRotate: false,\n    showMe: editable,\n    lockPan: !editable,\n    onViewportChange: onChange\n  }\n\n  return (\n    <Map\n      {...mapProps}\n      {...props}\n    >\n      {latitude && longitude ? (\n        <Marker\n          className={'singleMarker'}\n          latitude={latitude}\n          longitude={longitude}\n        >\n          <Dot direction={direction} />\n        </Marker>\n      )\n        : <Dot direction={direction} />\n      }\n\n    </Map>\n  )\n}\n\nMapDot.propTypes = {\n  direction: PropTypes.number,\n  latitude: PropTypes.number,\n  longitude: PropTypes.number,\n  editable: PropTypes.bool,\n  staticMap: PropTypes.bool,\n  onChange: PropTypes.func\n}\n\nexport default MapDot\n","import Satellite from './Satellite.json'\n// import BasicMap from './BasicMap.json'\nimport TopoMap from './TopoMap.json'\n\nimport {\n  Satellite as SatIcon,\n  SatelliteOutlined,\n  // DirectionsCar,\n  // DirectionsCarOutlined,\n  Terrain,\n  TerrainOutlined\n} from '@material-ui/icons'\n\nexport default [\n  {\n    toolTip: 'Sat',\n    Icon: SatelliteOutlined,\n    ActiveIcon: SatIcon,\n    color: 'green',\n    style: Satellite\n  },\n  {\n    toolTip: 'Topo',\n    Icon: TerrainOutlined,\n    ActiveIcon: Terrain,\n    color: 'blue',\n    style: TopoMap\n  }\n]\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\nimport SpeedDial from '@material-ui/lab/SpeedDial'\nimport SpeedDialAction from '@material-ui/lab/SpeedDialAction'\n// import MapLayersIcon from '@material-ui/icons/Layers'\nimport { makeStyles, useTheme } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n    zIndex: 10,\n    position: 'absolute'\n  },\n  speedDialFab: {\n    border: '2px solid',\n    background: theme.palette.text.primary,\n    color: theme.palette.primary.contrastText,\n    width: 40,\n    height: 40\n  },\n  speedDialAction: {\n    border: '2px solid',\n    background: theme.palette.primary.main,\n    color: theme.palette.primary.contrastText,\n    marginTop: 0,\n    marginBottom: 0\n  },\n  speedDialIcon: {\n    // border: '1px solid red'\n  },\n  speedDialLabel: {\n    background: 'black',\n    color: 'white'\n  },\n  actionsClosed: {\n    display: 'none'\n  }\n})\n\nconst useStyles = makeStyles(style)\n\nconst StyleButtons = ({ controlPadding, currStyle, mapStyles, setCurrStyle }) => {\n  const [open, setOpen] = useState(false)\n  const classes = useStyles()\n  const theme = useTheme()\n  const noEventSetOpen = (e, state) => {\n    console.log('noEventSetOpen', e, state)\n    e.preventDefault()\n    e.stopPropagation()\n    setOpen(state)\n  }\n\n  if (!mapStyles || !Array.isArray(mapStyles) || mapStyles.length < 2 || !mapStyles[currStyle]) return null\n\n  const currStyleObj = mapStyles[currStyle]\n  const ActiveIcon = currStyleObj.ActiveIcon\n\n  return (\n    <div className={classes.root} style={{\n      top: controlPadding.top ? controlPadding.top : theme.spacing(2),\n      right: controlPadding.right ? controlPadding.right : theme.spacing(2)\n    }}>\n      {mapStyles.length > 1 && (\n        <SpeedDial\n          ariaLabel='SpeedDial example'\n          className={classes.speedDial}\n          classes={{\n            fab: classes.speedDialFab,\n            actionsClosed: classes.actionsClosed\n          }}\n          icon={<ActiveIcon className={classes.icon} />}\n          // onBlur={(e) => noEventSetOpen(e, false)}\n          onClick={(e) => noEventSetOpen(e, !open)}\n          onClose={(e) => noEventSetOpen(e, false)}\n          // onFocus={(e) => noEventSetOpen(e, true)}\n          // onMouseEnter={(e) => noEventSetOpen(e, true)}\n          // onMouseLeave={(e) => noEventSetOpen(e, false)}\n          open={open}\n          direction='left'\n        >\n\n          {mapStyles.map(({ Icon, ActiveIcon, toolTip }, idx) => (\n            <SpeedDialAction\n              key={`stylebutton${idx}`}\n              // Bit of a hack here. This function isn't quite ready for primetime\n              icon={<Icon className={classes.speedDialIcon} />}\n              tooltipPlacement='bottom'\n              ButtonProps={{\n                classes: {\n                  root: classes.speedDialAction\n                }\n              }}\n              TooltipClasses={{\n                tooltip: classes.speedDialLabel\n              }}\n              tooltipTitle={toolTip}\n              tooltipOpen\n              onClick={() => {\n                console.log('SET', idx)\n                setCurrStyle(idx)\n                setOpen(false)\n              }}\n            />\n          ))}\n\n        </SpeedDial>\n      ) }\n    </div>\n  )\n}\n\nStyleButtons.propTypes = {\n  // controlPadding: {top, right, bottom, left}\n  controlPadding: PropTypes.object,\n  currStyle: PropTypes.number,\n  mapStyles: PropTypes.array,\n  setCurrStyle: PropTypes.func\n}\nStyleButtons.defaultProps = {\n  controlPadding: {}\n}\n\nexport default StyleButtons\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport Dialog from '@material-ui/core/Dialog'\nimport IconButton from '@material-ui/core/IconButton'\nimport DialogTitle from '@material-ui/core/DialogTitle'\n\nimport CloseIcon from '@material-ui/icons/Close'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n\n  },\n  body: {\n    overflow: 'hidden',\n    whiteSpace: 'pre-line',\n    paddingBottom: theme.spacing(1)\n  },\n  title: {\n    alignSelf: 'flex-start',\n    width: '100%',\n    margin: 0,\n    display: 'flex',\n    padding: theme.spacing(2)\n  },\n  dlgTitle: {\n    flexGrow: 1\n  },\n  closeButton: {\n    alignSelf: 'flex-start',\n    color: theme.palette.grey[500]\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst BigText = ({ open, onClose, title, body }) => {\n  const classes = useStyles()\n  return (\n    <Dialog\n      scroll='paper'\n      open={open}\n      fullWidth\n      maxWidth='xl'\n      onClose={onClose}\n      aria-labelledby='simple-dialog-title'\n    >\n      <DialogTitle className={classes.title} disableTypography>\n        <Typography className={classes.dlgTitle}>{title}</Typography>\n        <IconButton className={classes.closeButton} onClick={onClose}>\n          <CloseIcon />\n        </IconButton>\n      </DialogTitle>\n      <DialogContent>\n        <Typography variant='body2' className={classes.body}>{body}</Typography>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nBigText.propTypes = {\n  open: PropTypes.bool,\n  onClose: PropTypes.func,\n  title: PropTypes.string,\n  body: PropTypes.string\n}\n\nexport default BigText\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport Button from '@material-ui/core/Button'\nimport Typography from '@material-ui/core/Typography'\nimport DialogActions from '@material-ui/core/DialogActions'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n\n})\nconst useStyles = makeStyles(style)\n\nconst DeleteDialog = ({ title, message, onConfirm, open }) => {\n  const classes = useStyles()\n  return (\n    <Dialog\n      className={classes.root}\n      disableBackdropClick\n      open={open}\n      disableEscapeKeyDown\n      maxWidth='xl'\n      aria-labelledby='confirmation-dialog-title'\n    >\n      <DialogTitle id='confirmation-dialog-title'>{title}</DialogTitle>\n      <DialogContent>\n        <Typography>\n          {message}\n        </Typography>\n\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={() => onConfirm(false)} color='primary'>\n      No\n        </Button>\n        <Button onClick={() => onConfirm(true)} color='primary'>\n      Yes\n        </Button>\n      </DialogActions>\n    </Dialog>\n  )\n}\n\nDeleteDialog.propTypes = {\n  open: PropTypes.bool,\n  title: PropTypes.string.isRequired,\n  message: PropTypes.string.isRequired,\n  onConfirm: PropTypes.func.isRequired\n}\n\nexport default DeleteDialog\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\n// import Typography from '@material-ui/core/Typography'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogActions from '@material-ui/core/DialogActions'\nimport TextField from '@material-ui/core/TextField'\nimport Button from '@material-ui/core/Button'\nimport DialogTitle from '@material-ui/core/DialogTitle'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n\n  },\n  body: {\n    overflow: 'hidden',\n    whiteSpace: 'pre-line',\n    paddingBottom: theme.spacing(1)\n  },\n  title: {\n    margin: 0,\n    padding: theme.spacing(2)\n  },\n  closeButton: {\n    position: 'absolute',\n    right: theme.spacing(1),\n    top: theme.spacing(1),\n    color: theme.palette.grey[500]\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst BigTextEdit = ({ open, onOk, title, body, multiline }) => {\n  const classes = useStyles()\n  const [value, setValue] = useState(body || '')\n  return (\n    <Dialog\n      scroll='paper'\n      open={open}\n      fullWidth\n      onClose={() => onOk(value)}\n    >\n      <DialogTitle className={classes.title}>\n        {title}\n      </DialogTitle>\n      <DialogContent>\n        <TextField\n          className={classes.body}\n          multiline={multiline}\n          fullWidth\n          rows={6}\n          rowsMax={20}\n          onChange={e => setValue(e.target.value)}\n          defaultValue={body}\n        />\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={() => onOk(body)}>Cancel</Button>\n        <div style={{ flexGrow: 1 }} />\n        <Button onClick={() => onOk(value)}>Ok</Button>\n      </DialogActions>\n    </Dialog>\n  )\n}\n\nBigTextEdit.propTypes = {\n  open: PropTypes.bool,\n  multiline: PropTypes.bool,\n  onOk: PropTypes.func,\n  title: PropTypes.string,\n  body: PropTypes.string\n}\n\nexport default BigTextEdit\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport Slider from '@material-ui/lab/Slider'\n// import { Menu as MenuIcon } from '@material-ui/icons'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n    color: 'white',\n    zIndex: 10,\n    display: 'flex',\n    flexDirection: 'column',\n    position: 'absolute',\n    height: '50%',\n    top: '45%',\n    left: '0',\n    transform: 'translateY(-50%)'\n  },\n  sliderLabel: {\n    display: 'block',\n    flexGrow: 1,\n    textAlign: 'center',\n    padding: theme.spacing(3, 0, 3, 0),\n    textShadow: '0 0 5px black, 0 0 5px black'\n  },\n  vertical: {\n    padding: '0px 31px!important',\n    width: '4px!important'\n  },\n  rail: {\n    width: `4px!important`,\n    background: theme.palette.primary.dark,\n    boxShadow: '0 0 10px 5px black'\n  },\n  track: {\n    width: `4px!important`,\n    background: theme.palette.primary.main\n  },\n  thumb: {\n    // transform: 'translate(50%, -50%)',\n    background: theme.palette.primary.main,\n    border: `1px solid ${theme.palette.primary.dark}`,\n    marginLeft: '-8px !important',\n    width: 20,\n    height: 20\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst PhotoFadeSlider = ({ defaultValue, onChange }) => {\n  const classes = useStyles()\n  // we control the state internally so we get a smooth experience\n  const [slider, setSlider] = useState(defaultValue)\n\n  const onSliderMove = (event, value) => {\n    setSlider(value)\n    // send it back if we need to\n    onChange(value)\n  }\n\n  return (\n    <div className={classes.root}>\n      <Typography className={classes.sliderLabel} color='inherit' variant='caption'>New</Typography>\n      <Slider\n        classes={{\n          vertical: classes.vertical,\n          rail: classes.rail,\n          track: classes.track,\n          thumb: classes.thumb\n        }}\n        value={slider}\n        aria-labelledby='label'\n        onChange={onSliderMove}\n        orientation='vertical'\n      />\n      <Typography className={classes.sliderLabel} color='inherit' variant='caption'>Reference</Typography>\n    </div>\n  )\n}\n\nPhotoFadeSlider.propTypes = {\n  defaultValue: PropTypes.number,\n  onChange: PropTypes.func\n}\n\nPhotoFadeSlider.defaultProps = {\n  defaultValue: 100,\n  onChange: () => {}\n}\n\nexport default PhotoFadeSlider\n","import { useState, useEffect, useRef } from 'react'\n\nexport const useCamera = (onCapture, width, height) => {\n  const [cameraError, setCameraError] = useState(false)\n  const [cameraOnline, setCameraOnline] = useState(false)\n  const camRef = useRef()\n\n  useEffect(() => {\n    camRef.current = new Webcam(\n      document.getElementById('webcam'),\n      document.createElement('canvas')\n    )\n    camRef.current.setup(\n      height || window.innerWidth, // width\n      width || window.innerHeight // height\n    )\n      .then((data) => {\n        setCameraOnline(true)\n      })\n      .catch((e) => {\n        console.error(e)\n        setCameraError(true)\n      })\n  }, [width, height])\n\n  const captureImage = () => {\n    if (camRef.current && cameraOnline) {\n      const capturedData = camRef.current.takeBase64Photo({ type: 'jpeg', quality: 1 })\n      onCapture(capturedData)\n    }\n  }\n\n  const captureRawData = () => {\n    if (camRef.current && cameraOnline) {\n      const capturedData = camRef.current.takeImageData()\n      onCapture(capturedData)\n    }\n  }\n\n  return { cameraError, captureImage, cameraOnline, captureRawData }\n}\n\nclass Webcam {\n  constructor (webcamElement, canvasElement) {\n    this.webcamElement = webcamElement\n    this.canvasElement = canvasElement\n\n    if (window.location.protocol !== 'https:' && window.location.hostname !== 'localhost') {\n      console.warn('getUserMedia() must be run from a secure origin: https or localhost.\\nChanging protocol to https.')\n    }\n\n    if (!navigator.mediaDevices && !navigator.getUserMedia) {\n      console.warn(`Your browser doesn't support navigator.mediaDevices.getUserMedia and navigator.getUserMedia.`)\n    }\n  }\n\n  adjustVideoSize (width, height) {\n    const aspectRatio = width / height\n    if (width >= height) {\n      this.webcamElement.width = aspectRatio * this.webcamElement.height\n    }\n    else if (width < height) {\n      this.webcamElement.height = this.webcamElement.width / aspectRatio\n    }\n  }\n\n  async destroy () {\n    try {\n      this.webcamElement.srcObject.getTracks()[0].stop()\n      this.webcamElement = null\n      this.canvasElement = null\n    }\n    catch (e) {\n      console.error(e)\n    }\n  }\n\n  async setup (width, height) {\n    return new Promise((resolve, reject) => {\n      if (navigator.mediaDevices.getUserMedia !== undefined) {\n        navigator.mediaDevices.getUserMedia({ audio: false, video: { facingMode: 'environment', width, height } })\n          .then((mediaStream) => {\n            if ('srcObject' in this.webcamElement) {\n              this.webcamElement.srcObject = mediaStream\n            }\n            else {\n              // For older browsers withouth the srcObject.\n              this.webcamElement.src = window.URL.createObjectURL(mediaStream)\n            }\n            this.webcamElement.onloadedmetadata = (e) => {\n              this.webcamElement.play()\n            }\n            this.webcamElement.onplaying = (e) => {\n              resolve()\n            }\n          })\n          .catch(err => reject(err))\n      }\n      else {\n        reject(new Error('Error accessing camera'))\n      }\n    })\n  }\n\n  _drawImage () {\n    const imageWidth = this.webcamElement.videoWidth\n    const imageHeight = this.webcamElement.videoHeight\n\n    const context = this.canvasElement.getContext('2d')\n    this.canvasElement.width = imageWidth\n    this.canvasElement.height = imageHeight\n\n    context.drawImage(this.webcamElement, 0, 0, imageWidth, imageHeight)\n\n    return { imageHeight, imageWidth }\n  }\n\n  takeImageData () {\n    const { imageHeight, imageWidth } = this._drawImage()\n    const data = { data: null, imageHeight, imageWidth }\n    try {\n      data.data = this.canvasElement\n        .getContext('2d')\n        .getImageData(\n          0,\n          0,\n          imageWidth,\n          imageHeight\n        ).data\n    }\n    catch (e) {}\n\n    return data\n  }\n\n  takeBlobPhoto () {\n    const { imageWidth, imageHeight } = this._drawImage()\n    return new Promise((resolve, reject) => {\n      this.canvasElement.toBlob((blob) => {\n        resolve({ blob, imageHeight, imageWidth })\n      })\n    })\n  }\n\n  takeBase64Photo ({ type, quality } = { type: 'jpeg', quality: 1 }) {\n    const { imageHeight, imageWidth } = this._drawImage()\n    const base64 = this.canvasElement.toDataURL('image/' + type, quality)\n    return { base64, imageHeight, imageWidth }\n  }\n}\n","export default theme => ({\n  root: {\n    width: '100%'\n  },\n  tagContainer: {\n  },\n  formControl: {\n\n  },\n  actionButtons: {\n    textAlign: 'right'\n  },\n  noOptionsMessage: {\n    padding: theme.spacing(1, 2)\n  },\n  singleValue: {\n    fontSize: 16\n  },\n  placeholder: {\n    position: 'absolute',\n    left: 2,\n    fontSize: 16\n  },\n  input: {\n    display: 'flex',\n    padding: 0\n  },\n  valueContainer: {\n    display: 'flex',\n    flexWrap: 'wrap',\n    flex: 1,\n    alignItems: 'center',\n    overflow: 'hidden'\n  },\n  paper: {\n    position: 'absolute',\n    zIndex: 1,\n    marginTop: theme.spacing(1),\n    left: 0,\n    right: 0\n  }\n})\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport Typography from '@material-ui/core/Typography'\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport TagChip from '../tags/TagChip'\nimport style from './TagControl.style'\n\nconst useStyles = makeStyles(style)\n/**\n * Just to be clear: the state here is being stored as []\n */\nconst TagControl = ({ tags, label, tagConfig, className }) => {\n  const classes = useStyles()\n  // Filter to just this tag type\n  const tagValues = tags.filter(tag => tag.typeId === tagConfig.id && !tag.coords)\n\n  return (\n    <div className={classNames(classes.root, className)}>\n      <Typography variant='overline' className={classes.fieldTitle}>\n        {tagConfig.label}\n      </Typography>\n      <div className={classes.tagContainer}>\n        {tagValues.map((tag, idx) => (\n          <TagChip tag={tag} key={`tagchip${idx}`} color={tagConfig.color} />\n        ))}\n      </div>\n\n    </div>\n  )\n}\n\nTagControl.propTypes = {\n  className: PropTypes.string,\n  label: PropTypes.string,\n  tags: PropTypes.array,\n  tagConfig: PropTypes.object\n}\n\nexport default TagControl\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport {\n  TextField,\n  Typography\n} from '@material-ui/core'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { timestampToHTML5Input, HTML5InputToTimestamp } from '../../../../lib/datelib'\n\nconst style = theme => ({\n  root: {\n  },\n  rootEdit: {\n  },\n  formControl: {\n    width: '100%'\n  },\n  textBody: {\n    whiteSpace: 'pre-line'\n  },\n  actionButtons: {\n    textAlign: 'right'\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst DateControl = ({\n  label,\n  value,\n  hint,\n  onChange,\n  className\n}) => {\n  const classes = useStyles()\n  return (\n    <div className={classNames(classes.root, className)}>\n      <Typography variant='overline' className={classes.fieldTitle}>\n        {label}\n      </Typography>\n      <TextField\n        type='datetime-local'\n        fullWidth\n        value={timestampToHTML5Input(value)}\n        className={classes.textField}\n        onChange={(e) => onChange(HTML5InputToTimestamp(e.target.value))}\n      />\n      {hint && <Typography variant='caption' className={classes.hint}>{hint}</Typography>}\n    </div>\n  )\n}\n\nDateControl.propTypes = {\n  className: PropTypes.string,\n  label: PropTypes.string.isRequired,\n  hint: PropTypes.string,\n  value: PropTypes.string, // all timestamps come in as integerstrings\n  onChange: PropTypes.func.isRequired\n}\n\nexport default DateControl\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport uuid from 'uuid/v4'\nimport Paper from '@material-ui/core/Paper'\nimport TextField from '@material-ui/core/TextField'\nimport Typography from '@material-ui/core/Typography'\nimport MenuItem from '@material-ui/core/MenuItem'\n\nimport Select from 'react-select'\nimport CreatableSelect from 'react-select/lib/Creatable'\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport TagChip from '../tags/TagChip'\nimport style from './TagControl.style'\nconst useStyles = makeStyles(style)\n\n/**\n * Just to be clear: the state here is being stored as []\n */\nconst TagControl = ({\n  tags, onChange,\n  hint, tagConfig, className\n}) => {\n  const classes = useStyles()\n  // console.log('TagControl Rnder', { tags, tagConfig })\n  const onSelectChange = (inputValue, { action, removedValue, option }) => {\n    // If this was the last tag then close the menu\n    switch (action) {\n      case 'clear':\n        onChange([])\n        break\n      case 'remove-value':\n        // Remember we need to potentially remove it from the old AND the new\n        onChange(tags.filter(val => val.id !== removedValue.value))\n        break\n      case 'select-option':\n        const newVal = {\n          ...tagConfig.values.find(tcv => tcv.id === option.value),\n          typeId: tagConfig.id\n        }\n        onChange([...tags, newVal])\n        break\n      case 'create-option':\n        const newLabel = inputValue.find(v => v.__isNew__).value\n        const newCreateVal = {\n          label: newLabel,\n          id: uuid(),\n          typeId: tagConfig.id\n        }\n        onChange([...tags, newCreateVal])\n        break\n      default:\n        break\n    }\n  }\n\n  const SingleValue = ({ removeProps, innerProps, data, ...props }) => {\n    // console.log('SingleValue PROPS', { removeProps, innerProps, data, props })\n    return (\n      <TagChip tag={data} onDelete={(e) => {\n        // console.log('EVENT', e)\n        removeProps.onClick()\n      }} color={tagConfig.color} edit />\n    )\n  }\n  SingleValue.propTypes = {\n    removeProps: PropTypes.any,\n    innerProps: PropTypes.any,\n    data: PropTypes.any\n  }\n\n  const MultiValue = ({ removeProps, innerProps, data, ...props }) => {\n    // console.log('MultiValue PROPS', { removeProps, innerProps, data, props })\n    return (\n      <TagChip tag={data} onDelete={(e) => {\n        // console.log('EVENT', e)\n        removeProps.onClick()\n      }} color={tagConfig.color} edit />\n    )\n  }\n  MultiValue.propTypes = {\n    removeProps: PropTypes.any,\n    innerProps: PropTypes.any,\n    data: PropTypes.any\n  }\n\n  // Filter to just this tag type\n  const tagValues = tags.filter(tag => tag.typeId === tagConfig.id && !tag.coords)\n  // Now format it as {label, value: id} for react-select\n  const selectOptions = tagValues.map(val => ({ label: val.label, value: val.id }))\n\n  // Filter out things we haven't chosen yet\n  // Also transform the options into a label/value pair for react-select\n  const remainingTags = tagConfig.values\n    .filter(val => tagValues.map(t => t.id).indexOf(val.id) === -1)\n    .map(val => ({ label: val.label, value: val.id }))\n\n  // console.log('TAG DEBUG', { value, tagValues, tagConfig })\n\n  return (\n    <div className={classNames(classes.root, className)}>\n      <Typography variant='overline' className={classes.fieldTitle}>\n        {tagConfig.label}\n      </Typography>\n      {!tagConfig.allowAdditions && (\n        <Select\n          options={remainingTags}\n          classes={classes}\n          isFocused\n          components={{\n            Control,\n            Menu,\n            //   MultiValue,\n            NoOptionsMessage,\n            Option,\n            Placeholder,\n            //   SingleValue,\n            ValueContainer\n          }}\n          deleteRemoves\n          value={selectOptions}\n          isClearable={false}\n          onChange={onSelectChange}\n          placeholder='Select Tags'\n          isMulti\n          isSearchable\n        />\n      ) }\n      { tagConfig.allowAdditions && (\n        <CreatableSelect\n          options={remainingTags}\n          classes={classes}\n          isFocused\n          deleteRemoves\n          components={{\n            Control,\n            Menu,\n            //   MultiValue,\n            NoOptionsMessage,\n            Option,\n            Placeholder,\n            //   SingleValue,\n            ValueContainer\n          }}\n          value={selectOptions}\n          isClearable={false}\n          onChange={onSelectChange}\n          placeholder='Select Tags'\n          isMulti\n          isSearchable\n        />\n      )}\n      {hint && <Typography variant='caption' className={classes.hint}>{hint}</Typography>}\n    </div>\n  )\n}\n\nTagControl.propTypes = {\n  className: PropTypes.string,\n  hint: PropTypes.string,\n  tags: PropTypes.array,\n  onChange: PropTypes.func.isRequired,\n  tagConfig: PropTypes.object\n}\n\nexport default TagControl\n\nfunction Control (props) {\n  // console.log('CONTROL PROPS', props)\n  return (\n    <TextField\n      fullWidth\n      InputProps={{\n        inputComponent,\n        inputProps: {\n          className: props.selectProps.classes.input,\n          inputRef: props.innerRef,\n          children: props.children,\n          // innerProps: {\n          onMouseDown: (e) => {\n            props.innerProps.onMouseDown(e)\n          },\n          onTouchEnd: (e) => {\n            props.innerProps.onTouchEnd(e)\n          }\n          // }\n          // ...props.innerProps\n        }\n      }}\n      {...props.selectProps.textFieldProps}\n    />\n  )\n}\n\nconst NoOptionsMessage = ({ innerProps, selectProps, children }) => (\n  <Typography\n    color='textSecondary'\n    className={selectProps.classes.noOptionsMessage}\n    {...innerProps}\n  >\n    {children}\n  </Typography>\n)\n\nconst Menu = ({ selectProps, innerProps, children }) => (\n  <Paper square className={selectProps.classes.paper} {...innerProps}>\n    {children}\n    {/* {console.log('MENU PROPS', { selectProps, innerProps, children })} */}\n  </Paper>\n)\n\nconst inputComponent = ({ inputRef, ...props }) => <div ref={inputRef} {...props} />\n\nconst Placeholder = (props) => (\n  <Typography\n    color='textSecondary'\n    className={props.selectProps.classes.placeholder}\n    {...props.innerProps}\n  >\n    {props.children}\n  </Typography>\n)\n\nconst Option = ({ innerRef, isFocused, isSelected, innerProps, children }) => (\n  <MenuItem\n    buttonRef={innerRef}\n    selected={isFocused}\n    component='div'\n    style={{ fontWeight: isSelected ? 500 : 400 }}\n    {...innerProps}\n  >\n    {children}\n  </MenuItem>\n)\n\nconst ValueContainer = ({ selectProps, children }) => (\n  <div className={selectProps.classes.valueContainer}>{children}</div>\n)\nValueContainer.propTypes = {\n  selectProps: PropTypes.any,\n  children: PropTypes.any\n}\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\n// import Typography from '@material-ui/core/Typography'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport Typography from '@material-ui/core/Typography'\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogActions from '@material-ui/core/DialogActions'\nimport Button from '@material-ui/core/Button'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport IconButton from '@material-ui/core/IconButton'\n\nimport CloseIcon from '@material-ui/icons/Close'\nimport TagControl from '../controls/TagControl'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n  },\n  dlgContent: {\n    // position: 'relative',\n    // maxWidth: '200px',\n    overflowY: 'visible!important',\n    paddingBottom: 300\n    // overflowX: 'hidden'\n  },\n  title: {\n    width: '100%',\n    margin: 0,\n    display: 'flex',\n    padding: theme.spacing(2)\n  },\n  dlgTitle: {\n    flexGrow: 1\n  },\n  closeButton: {\n    color: theme.palette.grey[500]\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst TagEdit = ({ open, title, onOk, onCancel, tags, tagConfig }) => {\n  const classes = useStyles()\n  const [value, setValue] = useState(tags)\n  return (\n    <Dialog\n      className={classes.root}\n      scroll='body'\n      fullScreen\n      open={open}\n      onClose={() => onOk(value)}\n    >\n      <DialogTitle className={classes.title} disableTypography>\n        <Typography className={classes.dlgTitle}>{title}</Typography>\n        <IconButton className={classes.closeButton} onClick={onCancel}>\n          <CloseIcon />\n        </IconButton>\n      </DialogTitle>\n      <DialogContent className={classes.dlgContent}>\n        <TagControl\n          className={classes.field}\n          tags={value}\n          tagConfig={tagConfig}\n          onChange={setValue}\n        />\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={onCancel}>Cancel</Button>\n        <div style={{ flexGrow: 1 }} />\n        <Button onClick={() => setValue(tags)}>Reset</Button>\n        <Button onClick={() => onOk(value)}>Ok</Button>\n      </DialogActions>\n    </Dialog>\n  )\n}\n\nTagEdit.propTypes = {\n  open: PropTypes.bool,\n  title: PropTypes.string,\n  onOk: PropTypes.func,\n  onCancel: PropTypes.func,\n  tags: PropTypes.array.isRequired,\n  tagConfig: PropTypes.object.isRequired\n}\n\nexport default TagEdit\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport Typography from '@material-ui/core/Typography'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { formatDate } from '../../../../lib/datelib'\n\nconst style = theme => ({\n  root: { },\n  rootEdit: { },\n  formControl: {\n    width: '100%'\n  },\n  textBody: {\n    whiteSpace: 'pre-line'\n  },\n  actionButtons: {\n    textAlign: 'right'\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst DateView = ({\n  label,\n  value,\n  className\n}) => {\n  const classes = useStyles()\n  return (\n    <div className={classNames(classes.root, className)}>\n      <Typography variant='overline' className={classes.fieldTitle}>\n        {label}\n      </Typography>\n      <Typography variant='body1' className={classes.hint}>{value ? formatDate(value) : ''}</Typography>\n    </div>\n  )\n}\n\nDateView.propTypes = {\n  className: PropTypes.string,\n  label: PropTypes.string.isRequired,\n  value: PropTypes.string\n}\n\nexport default DateView\n","import React, { useContext, useState } from 'react'\nimport PropTypes from 'prop-types'\n\nimport Typography from '@material-ui/core/Typography'\nimport Divider from '@material-ui/core/Divider'\nimport List from '@material-ui/core/List'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemText from '@material-ui/core/ListItemText'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport TagView from '../controls/TagView'\nimport ShortLongText from '../controls/ShortLongText'\nimport DateControl from '../controls/DateControl'\nimport TagClass from '../../../../lib/Tags'\nimport BigTextEdit from '../dialogs/BigTextEdit'\nimport BigText from '../dialogs/BigText'\nimport TagEdit from '../dialogs/TagEdit'\n\nimport { SeriesContext } from '../../contexts'\nimport DateView from '../controls/DateView'\n\nconst style = theme => ({\n  root: {\n    height: '90%',\n    width: '85%'\n  },\n  dlgTitleContainer: {\n    display: 'flex',\n    padding: 0\n  },\n  catTagTitle: {\n    marginTop: theme.spacing(2)\n  },\n  dlgTitle: {\n    flexGrow: 1,\n    paddingTop: theme.spacing(2),\n    paddingBottom: theme.spacing(1),\n    paddingLeft: theme.spacing(3)\n  },\n  field: {\n    marginBottom: theme.spacing(2)\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst DIALOGS = {\n  NOTEEDIT: 'noteEdit',\n  NOTEVIEW: 'noteView',\n  PHOTOTAKEN: 'taken',\n  TAGEDIT: 'tag',\n  CANCEL: 'cancel'\n}\n\nconst PhotoInfo = ({ canEdit, photo, delta, onChange }) => {\n  const classes = useStyles()\n  const { seriesConfig } = useContext(SeriesContext)\n  const [{ activeDialog, activeDialogContext }, setActiveDialog] = useState({})\n\n  const tagInst = new TagClass(seriesConfig, delta.tags || photo.tags)\n\n  let metaKeys = []\n  try {\n    metaKeys = photo.meta ? Object.keys(JSON.parse(photo.meta)) : []\n  }\n  catch (e) {\n    console.error(e)\n  }\n  return (\n    <div>\n      {canEdit ? (\n        <DateControl\n          className={classes.field}\n          label='Photo taken on'\n          value={delta.takenOn || photo.takenOn}\n          onChange={takenOn => onChange({ takenOn })}\n          canEdit={canEdit}\n        />\n      )\n        : (\n          <DateView\n            label='Photo taken on'\n            value={delta.takenOn || photo.takenOn}\n          />\n        )}\n\n      {(canEdit || photo.note) && (\n        <ShortLongText\n          label='Photo Note'\n          text={delta.note || photo.note}\n          onClick={() => {\n            if (canEdit) setActiveDialog({ activeDialog: DIALOGS.NOTEEDIT })\n            else setActiveDialog({ activeDialog: DIALOGS.NOTEVIEW })\n          }}\n        />\n      )}\n      <Typography variant='subtitle1' className={classes.catTagTitle}>Category tags</Typography>\n      <Divider />\n      {tagInst.seriesConfig.getNonXYTagTypes().map((tt, idx) => (\n        <div\n          key={`tagtype-${idx}`}\n          onClick={() => canEdit ? setActiveDialog({ activeDialog: DIALOGS.TAGEDIT, activeDialogContext: tt }) : null}\n        >\n          <TagView\n            className={classes.field}\n            label={tt.label}\n            tags={delta.tags || photo.tags}\n            tagConfig={tt}\n          />\n        </div>\n      ))}\n\n      {metaKeys.length > 0 && Object.keys(seriesConfig.meta).length > 0 && (\n        <React.Fragment>\n          <Typography className={classes.heading}>Metadata</Typography>\n          <Divider />\n          <List className={classes.list}>\n            {metaKeys.map((key, idx) => seriesConfig.meta[key] ? (\n              <ListItem key={`metadata${idx}`}>\n                <ListItemText\n                  primary={seriesConfig.meta[key].label}\n                  secondary={seriesConfig.meta[key].render(photo.meta[key])}\n                />\n              </ListItem>\n            ) : null\n            )}\n          </List>\n        </React.Fragment>\n      )}\n      {activeDialog && activeDialog === DIALOGS.NOTEEDIT && (\n        <BigTextEdit\n          open\n          multiline\n          onOk={note => {\n            onChange({ note })\n            setActiveDialog({})\n          }}\n          title='Edit Photo Note'\n          body={delta.note || photo.note}\n        />\n      )}\n      {activeDialog && activeDialog === DIALOGS.NOTEVIEW && (\n        <BigText\n          open\n          multiline\n          onClose={() => setActiveDialog({})}\n          title='Photo Note'\n          body={delta.note || photo.note}\n        />\n      )}\n      {activeDialog && activeDialog === DIALOGS.TAGEDIT && (\n        <TagEdit\n          open\n          title={`Edit Tags: ${activeDialogContext.label}`}\n          onOk={tags => {\n            setActiveDialog({})\n            onChange({ tags })\n          }}\n          onCancel={() => setActiveDialog({})}\n          tags={delta.tags || photo.tags}\n          tagConfig={activeDialogContext}\n        />\n      )}\n    </div>\n  )\n}\n\nPhotoInfo.propTypes = {\n  canEdit: PropTypes.bool,\n  onChange: PropTypes.func.isRequired,\n  photo: PropTypes.object.isRequired,\n  delta: PropTypes.object.isRequired\n}\n\nexport default PhotoInfo\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n    width: 1,\n    height: 1,\n    zIndex: 1\n  },\n  svgDot: {\n    width: 20,\n    height: 20,\n    position: 'absolute',\n    top: '50%',\n    left: '50%',\n    textAlign: 'center',\n    transformOrigin: '50% 50%',\n    transform: 'translateY(-50%) translateX(-50%)'\n  },\n  svgAccuracyDot: {\n    position: 'absolute',\n    top: '50%',\n    left: '50%',\n    textAlign: 'center',\n    transformOrigin: '50% 50%',\n    transform: 'translateY(-50%) translateX(-50%)'\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst MyLocation = ({ position, projection }) => {\n  const classes = useStyles()\n  const accuracy = 20 // assume 20m to start\n  // metersPerPixel [12, 12, 12]\n  // pixelsPerMeter [0: 0.08029229250399847, 1: -0.08029229250399847, 2: 0.08029229250399847]\n  // console.log('POSITION', { position, projection })\n  const accHeight = projection.pixelsPerMeter[0] * (accuracy)\n  const accWidth = projection.pixelsPerMeter[1] * (accuracy)\n  return (\n    <div className={classes.root}>\n      {/* This is the accuracy radius */}\n      <svg\n        style={{ height: accHeight, width: accWidth }}\n        className={classes.svgAccuracyDot}\n        version='1.1'\n        viewBox='0, 0, 100, 100'\n      >\n        <circle cx='50' cy='50' r={49}\n          stroke='#8888FF'\n          fillOpacity='0.4'\n          strokeWidth='1'\n          fill='#AAAAFF'\n        />\n      </svg>\n      {/* This is the dot */}\n      <svg className={classes.svgDot} version='1.1' viewBox='0, 0, 10, 10'>\n        <circle cx='5' cy='5' r='4'\n          stroke='#FFFFFF'\n          strokeWidth='1'\n          fill='#4444FF'\n        />\n      </svg>\n    </div>\n  )\n}\n\nMyLocation.propTypes = {\n  position: PropTypes.object,\n  projection: PropTypes.object\n}\n\nexport default MyLocation\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Fab from '@material-ui/core/Fab'\nimport MyLocationIcon from '@material-ui/icons/MyLocation'\n\nimport { makeStyles, useTheme } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n    border: '1px solid',\n    background: theme.palette.grey[100],\n    color: 'black',\n    width: 40,\n    height: 40,\n    zIndex: 10,\n    position: 'absolute'\n    // margin: theme.spacing(0.5),\n    // padding: theme.spacing(0.5),\n    // border: '2px solid',\n    // borderRadius: theme.spacing(1),\n    // background: theme.palette.common.white,\n    // fontSize: 20,\n    // position: 'absolute',\n    // zIndex: 100,\n    // bottom: theme.spacing(10),\n    // right: theme.spacing(2)\n  }\n})\n\nconst useStyles = makeStyles(style)\n\nconst MyLocationButton = ({ onClick, controlPadding, disabled }) => {\n  const classes = useStyles()\n  const theme = useTheme()\n  return (\n    <Fab\n      disabled={disabled}\n      style={{\n        top: 56 + (controlPadding.top ? controlPadding.top : theme.spacing(2)),\n        right: controlPadding.right ? controlPadding.right : theme.spacing(2)\n      }}\n      aria-label='myLocation'\n      className={classes.root}\n      onClick={onClick}\n    >\n      <MyLocationIcon />\n    </Fab>\n  )\n}\n\nMyLocationButton.propTypes = {\n  controlPadding: PropTypes.object,\n  onClick: PropTypes.func.isRequired,\n  disabled: PropTypes.bool\n}\n\nexport default MyLocationButton\n","import React, { useState, useRef, useMemo, useEffect } from 'react'\nimport ReactMapGL, { NavigationControl, Marker, FlyToInterpolator } from 'react-map-gl'\nimport PropTypes from 'prop-types'\nimport { easeCubic } from 'd3-ease'\nimport WebMercatorViewport, { getDistanceScales } from 'viewport-mercator-project'\nimport useComponentSize from '../../lib/useComponentSize'\nimport MyLocation from './markers/MyLocation'\nimport { useGeolocation } from '../../lib/sensors'\n// import { debounce } from '../../lib/util'\nimport StyleButtons from './controls/StyleButtons'\nimport MyLocationButton from './controls/MyLocationButton'\nimport { mapConfig } from '../../config'\nimport classNames from 'classnames'\nimport 'mapbox-gl/dist/mapbox-gl.css'\nimport './BaseMap.css'\n\n/**\n * Note that this component technically has state but it is designed to be functionally stateless\n */\nconst BaseMap = (props) => {\n  // pull what we need out of the props\n  const {\n    showMe,\n    children,\n    mapStyles,\n    controlPadding,\n    viewport: initViewport,\n    bounds,\n    lockToBounds,\n    lockPan,\n    initStyle,\n    onViewportChange: incomingOnViewportChange,\n    onTransitionStart: incomingOnTransitionStart,\n    onTransitionEnd: incomingOnTransitionEnd,\n    transitions,\n    onMapDataEvent,\n    stylechooser,\n    ...passthroughProps\n  } = props\n\n  const mapContainerRef = useRef(null)\n  const mapBoxRef = useRef(null)\n  const innerTransitionsRef = useRef(null)\n\n  const { size } = useComponentSize(mapContainerRef)\n\n  const [currStyle, setCurrStyle] = useState(initStyle)\n\n  // This is the truth of the viewport!!\n  const [viewport, setViewport] = useState({ ...defaultViewVals, ...initViewport })\n  const [isTransitioning, setIsTransitioning] = useState(false)\n  const [projection, setProjection] = useState(null)\n\n  let myPosition = {}\n  if (showMe) {\n    myPosition = useGeolocation()\n  }\n  const geoMarker = (myPosition.latitude && myPosition.longitude)\n    ? (\n      <Marker key='myPos' className='myPosMarker' latitude={myPosition.latitude} longitude={myPosition.longitude} style={{ zIndex: 1 }}>\n        <MyLocation position={myPosition} projection={projection} />\n      </Marker>\n    ) : null\n\n  // Recalculate the projection if we need to but only when zoom changes\n  useMemo(() => {\n    if (!size || size.width < 10 || size.height < 10) return\n    if (mapStyles.length <= currStyle) setCurrStyle(initStyle)\n    try {\n      const projection = getDistanceScales(viewport)\n      // console.log('recalcProjection', { projection, size })\n      setProjection(projection)\n    }\n    catch (e) {\n      console.log('ERROR', viewport)\n      console.error(e)\n    }\n  }, [viewport.zoom, size])\n\n  const flyToMe = () => {\n    if (!myPosition.latitude || !myPosition.longitude) return\n    const transitionTime = 2000\n    innerTransitionsRef.current = {\n      transitionDuration: transitionTime,\n      transitionInterpolator: new FlyToInterpolator(),\n      transitionEasing: easeCubic\n    }\n    // You get `transitionTime` ms to figure this out. then we just jump\n    setTimeout(() => {\n      if (innerTransitionsRef.current) innerTransitionsRef.current = null\n    }, transitionTime)\n    setViewport({\n      ...viewport,\n      latitude: myPosition.latitude,\n      longitude: myPosition.longitude,\n      zoom: viewport.zoom > 10 ? viewport.zoom : 12\n    })\n  }\n\n  /**\n   * Callback fired when the user changes the viewport object\n   * @param {*} viewport\n   */\n  const onViewportChange = (viewportChange) => {\n    const newViewport = { ...viewportChange }\n    // Here we set/reset the bounds\n    if (bounds && lockToBounds) {\n      if (newViewport.longitude < bounds[0]) newViewport.longitude = bounds[0]\n      else if (newViewport.longitude > bounds[2]) newViewport.longitude = bounds[2]\n\n      if (newViewport.latitude < bounds[1]) newViewport.latitude = bounds[1]\n      else if (newViewport.latitude > bounds[3]) newViewport.latitude = bounds[3]\n    }\n    if (lockPan) {\n      newViewport.latitude = viewport.latitude\n      newViewport.longitude = viewport.longitude\n    }\n\n    // console.log('onViewportChange', newViewport)\n    // Fire the external callback so parent components can track viewport if they need to\n    if (!isTransitioning && typeof incomingOnViewportChange === 'function') {\n      incomingOnViewportChange({\n        viewport: newViewport,\n        size,\n        projection,\n        map: mapBoxRef.current && mapBoxRef.current.getMap()\n      })\n    }\n    setViewport(newViewport)\n  }\n\n  const recalcZoomBounds = () => {\n    // console.log('Should I recalc viewbounds?')\n    if (!bounds || !size || size.width < 10 || size.height < 10 || isTransitioning) return\n    // On the first run we're going to try to center the bounds.\n    const [minlng, minlat, maxlng, maxlat] = bounds\n    try {\n      console.log('recalcZoomBounds')\n      const { longitude, latitude, zoom } = new WebMercatorViewport({ ...size, ...viewport }).fitBounds(\n        [ [minlng, minlat], [maxlng, maxlat] ],\n        { padding: 40, offset: [0, 0] }\n      )\n      console.log('Changing Zoom ', bounds, viewport.zoom, zoom, viewport)\n\n      // console.log('recalcZoomBounds')\n      setViewport({ ...viewport, longitude, latitude, zoom })\n    }\n    catch (e) {\n      // Sometimes we don't have a valid bound. Don't make a big deal out of it.\n      console.error(e)\n    }\n  }\n\n  const handleTransitionStart = () => {\n    console.log('handleTransitionStart (internal)')\n    setIsTransitioning(true)\n    if (typeof incomingOnTransitionStart === 'function') incomingOnTransitionStart()\n  }\n\n  const handleTransitionEnd = () => {\n    console.log('handleTransitionEnd (internal)')\n    setIsTransitioning(false)\n    innerTransitionsRef.current = null\n    if (incomingOnTransitionEnd) incomingOnTransitionEnd()\n    if (typeof incomingOnViewportChange === 'function') {\n      incomingOnViewportChange({\n        viewport,\n        size,\n        projection,\n        map: mapBoxRef.current && mapBoxRef.current.getMap()\n      })\n    }\n  }\n\n  // RecalcZoombounds should only be done sparingly\n  useMemo(recalcZoomBounds, [size, bounds])\n\n  useEffect(() => {\n    setViewport({ ...viewport, ...initViewport })\n  }\n  , [initViewport])\n\n  return (\n    <div className={classNames('mapContainer', props.className)} ref={mapContainerRef}>\n      {size.height > 0 && size.width > 0 && (\n        <ReactMapGL\n          {...viewport}\n          {...(innerTransitionsRef.current || transitions)}\n          ref={map => {\n            mapBoxRef.current = map\n          }}\n          height={size.height}\n          width={size.width}\n          mapStyle={currStyle < mapStyles.length ? mapStyles[currStyle].style : mapStyles[0].style}\n          onData={onMapDataEvent}\n          onTransitionStart={handleTransitionStart}\n          onTransitionEnd={handleTransitionEnd}\n          dragPan={!lockPan}\n          onViewportChange={onViewportChange}\n          mapboxApiAccessToken={mapConfig.mapBoxToken}\n          {...passthroughProps}\n        >\n          {\n            children && Array.isArray(children)\n              ? children.map((c, idx) => c ? React.cloneElement(\n                handleChild(c, viewport, size.height, size.width, projection),\n                { key: `mapChild-${idx}` }\n              ) : null)\n              : handleChild(children, viewport, size.height, size.width, projection)\n          }\n          {/* Make sure the controls are above everything else */}\n          { stylechooser && (\n            <StyleButtons\n              controlPadding={controlPadding}\n              currStyle={currStyle}\n              mapStyles={mapStyles}\n              setCurrStyle={setCurrStyle}\n            />\n          )}\n          {/* Augment children with some props they need to survive in this harsh world */}\n          { !props.hideNavControls && (\n            <NavigationControl\n              onViewportChange={viewport => onViewportChange({ ...viewport, ...size })}\n              showZoom={!props.touchZoom === false && !props.scrollZoom === false}\n              showCompass={!props.touchRotate === false && !props.dragRotate === false}\n            />\n          )}\n          {showMe && !lockPan && (\n            <React.Fragment>\n              {geoMarker}\n              <MyLocationButton disabled={!myPosition || !myPosition.latitude} controlPadding={controlPadding} onClick={flyToMe} />\n            </React.Fragment>\n          )}\n        </ReactMapGL>\n      )}\n    </div>\n  )\n}\n\nBaseMap.propTypes = {\n  // Anything else we want to add to the map\n  children: PropTypes.any,\n  data: PropTypes.array,\n  // Maybe we want map controls to be padded\n  controlPadding: PropTypes.object,\n\n  showMe: PropTypes.bool,\n\n  // Separate transitions from viewport so we can set them independently\n  transitions: PropTypes.object,\n  initStyle: PropTypes.number,\n\n  // Some switches to make things easier\n  stylechooser: PropTypes.bool,\n  lockPan: PropTypes.bool,\n  lockRotation: PropTypes.bool,\n  lockZoom: PropTypes.bool,\n  lockToBounds: PropTypes.bool,\n  hideNavControls: PropTypes.bool,\n\n  // bounds of the map. may be locked or not [minlng, minlat], [maxlng, maxlat]\n  bounds: PropTypes.array,\n\n  // List of valid styles that will get picker buttons\n  mapStyles: PropTypes.array,\n\n  onMapDataEvent: PropTypes.func,\n  onViewportChange: PropTypes.func\n}\n\nBaseMap.defaultProps = {\n  controlPadding: {},\n  stylechooser: true,\n  initStyle: 0,\n  mapStyles: mapConfig.styles,\n  lockToBounds: false\n}\n\nexport default BaseMap\n\nconst defaultViewVals = {\n  latitude: 49.3050394,\n  longitude: -123.1398254,\n  bearing: 0,\n  pitch: 0,\n  zoom: 12\n}\n\nfunction handleChild (child, viewport, height, width, projection) {\n  return typeof child === 'function'\n    ? child(viewport, height, width, projection)\n    : child\n}\n","import React, { useState, useMemo } from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogActions from '@material-ui/core/DialogActions'\nimport Button from '@material-ui/core/Button'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport FormLabel from '@material-ui/core/FormLabel'\nimport Slider from '@material-ui/lab/Slider'\n\nimport MapDot from '../../../maps/MapDot'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n\n  },\n  dlgContent: {\n    display: 'flex',\n    flexDirection: 'column',\n    padding: 0\n  },\n  mapWrapper: {\n    flexGrow: 1\n  },\n  sliderWrapper: {\n    padding: '20px'\n  },\n  slider: {\n    padding: '22px 0px'\n  },\n  sliderRoor: {\n    padding: '0 20px'\n  },\n  body: {\n    overflow: 'hidden',\n    whiteSpace: 'pre-line',\n    paddingBottom: theme.spacing(1)\n  },\n  title: {\n    background: theme.palette.primary.main,\n    color: theme.palette.primary.contrastText,\n    margin: 0,\n    padding: theme.spacing(2)\n  },\n  closeButton: {\n    position: 'absolute',\n    right: theme.spacing(1),\n    top: theme.spacing(1),\n    color: theme.palette.grey[500]\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst MapDirPicker = ({ open, onOk, onCancel, title, latitude: initLat, longitude: initLong, direction: initDir }) => {\n  const classes = useStyles()\n  const [{ longitude, latitude }, setCoords] = useState({ longitude: initLong, latitude: initLat })\n  const [direction, setRotation] = useState(initDir)\n\n  const initViewport = useMemo(() => ({\n    zoom: 18,\n    latitude: initLat,\n    longitude: initLong\n  }), [initLat, initLong])\n\n  const mapChange = ({ viewport: { longitude, latitude } }) => setCoords({ longitude, latitude })\n\n  return (\n    <Dialog\n      scroll='paper'\n      open={open}\n      fullWidth\n      fullScreen\n      onClose={onCancel}\n    >\n      <DialogTitle className={classes.title} disableTypography>\n        <Typography color='inherit'>{title}</Typography>\n      </DialogTitle>\n      <DialogContent className={classes.dlgContent}>\n        <div className={classes.mapWrapper}>\n          <MapDot\n            editable\n            className={classes.map}\n            direction={direction > 0 ? direction : null}\n            viewport={initViewport}\n            onChange={mapChange}\n          />\n        </div>\n        <div className={classes.sliderWrapper}>\n          <FormLabel className={classes.mapFormLabel}>Direction {direction > -1 ? '' : '(off)'}</FormLabel>\n          <Slider\n            classes={{ root: classes.sliderRoor, container: classes.slider }}\n            value={direction || -1}\n            min={-1}\n            max={360}\n            step={1}\n            onChange={(e, value) => setRotation(value)}\n          />\n        </div>\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={onCancel}>Cancel</Button>\n        <div style={{ flexGrow: 1 }} />\n        <Button onClick={() => onOk({ longitude, latitude, direction })}>Ok</Button>\n      </DialogActions>\n    </Dialog>\n  )\n}\n\nMapDirPicker.propTypes = {\n  open: PropTypes.bool,\n  latitude: PropTypes.number,\n  longitude: PropTypes.number,\n  direction: PropTypes.number,\n  onOk: PropTypes.func,\n  onCancel: PropTypes.func,\n  title: PropTypes.string\n}\n\nexport default MapDirPicker\n","\nimport React, { useState } from 'react'\nimport PropTypes from 'prop-types'\n\nimport TextField from '@material-ui/core/TextField'\nimport FormLabel from '@material-ui/core/FormLabel'\nimport Typography from '@material-ui/core/Typography'\nimport FormControlLabel from '@material-ui/core/FormControlLabel'\nimport Switch from '@material-ui/core/Switch'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport MapDot from '../../../maps/MapDot'\n\nimport MapDirPicker from '../dialogs/MapDirPicker'\nimport BigTextEdit from '../dialogs/BigTextEdit'\n\nimport style from './SeriesEditInner.style'\nimport { ACCESS } from '../../../../config'\nimport ShortLongText from '../controls/ShortLongText'\n\nconst DIALOGS = {\n  MAPPICK: 'mapPicker',\n  NOTEEDIT: 'noteEdit'\n}\n\nconst useStyles = makeStyles(style)\n\n/**\n * SeriesEdit appears in two places so we need this to be a bit reusable\n */\nconst SeriesEditInner = ({ series, delta, onChange }) => {\n  const classes = useStyles()\n  const [activeDialog, setActiveDialog] = useState(null)\n\n  const viewport = { zoom: 18 }\n  if ((delta.latitude || series.coords[1]) && (delta.longitude || series.coords[0])) {\n    viewport.longitude = delta.longitude || series.coords[0]\n    viewport.latitude = delta.latitude || series.coords[1]\n  }\n\n  const access = delta.access || series.access || 'PRIVATE'\n  // console.log('ACESS', access)\n  return (\n    <div>\n      <TextField\n        label='Series Name'\n        fullWidth\n        placeholder='New Series'\n        className={classes.field}\n        value={delta.name || series.name || ''}\n        onChange={e => onChange({ ...delta, name: e.target.value })}\n      />\n      <div className={classes.mapWrapper} onClick={() => setActiveDialog(DIALOGS.MAPPICK)}>\n        <FormLabel className={classes.mapFormLabel}>Location</FormLabel>\n        <div className={classes.mapInnerWrap}>\n          <MapDot\n            staticMap\n            className={classes.map}\n            direction={delta.direction || series.direction}\n            viewport={viewport}\n          />\n        </div>\n      </div>\n      <div className={classes.field}>\n        <FormLabel>Series Access</FormLabel>\n        <div className={classes.access}>\n          <FormControlLabel\n            className={classes.accessRadio}\n            control={\n              <Switch\n                checked={['OPEN', 'PUBLIC'].indexOf(access) > -1}\n                onChange={(e) => {\n                  onChange({ ...delta, access: e.target.checked ? 'PUBLIC' : 'PRIVATE' })\n                }}\n                value={'PUBLIC'}\n              />\n            }\n            label={<div>\n              <Typography variant='body2' component='div'>{ACCESS.PUBLIC.label}</Typography>\n              <Typography variant='caption' color='textSecondary' component='div'>{ACCESS.PUBLIC.description}</Typography>\n            </div>}\n\n          />\n          <FormControlLabel\n            className={classes.accessRadio}\n            disabled={['PRIVATE'].indexOf(access) > -1}\n            control={\n              <Switch\n                checked={['OPEN'].indexOf(access) > -1}\n                onChange={(e) => onChange({ ...delta, access: e.target.checked ? 'OPEN' : 'PUBLIC' })}\n                value={'OPEN'}\n              />\n            }\n            label={<div>\n              <Typography variant='body2' component='div'>{ACCESS.OPEN.label}</Typography>\n              <Typography variant='caption' color='textSecondary' component='div'>{ACCESS.OPEN.description}</Typography>\n            </div>}\n          />\n        </div>\n      </div>\n\n      <ShortLongText\n        onClick={() => setActiveDialog(DIALOGS.NOTEEDIT)}\n        className={classes.field}\n        label='Series Note'\n        text={delta.note || series.note}\n      />\n      {activeDialog === DIALOGS.MAPPICK && (\n        <MapDirPicker\n          open\n          title='Series Location & Direction'\n          latitude={delta.latitude || series.coords[1]}\n          longitude={delta.longitude || series.coords[0]}\n          direction={delta.direction || series.direction}\n          onOk={(data) => {\n            onChange({ ...delta, ...data })\n            setActiveDialog(null)\n          }}\n          onCancel={() => setActiveDialog(null)}\n        />\n      )}\n      {activeDialog === DIALOGS.NOTEEDIT && (\n        <BigTextEdit\n          open\n          title='Series Note'\n          body={delta.note || series.note}\n          multiline\n          onOk={(newNote) => {\n            onChange({ ...delta, note: newNote })\n            setActiveDialog(null)\n          }}\n          onCancel={() => setActiveDialog(null)}\n        />\n      )}\n    </div>\n  )\n}\n\nSeriesEditInner.propTypes = {\n  // now some functions\n  series: PropTypes.object.isRequired,\n  delta: PropTypes.object.isRequired,\n  onChange: PropTypes.func.isRequired\n}\n\nexport default SeriesEditInner\n","export default theme => ({\n  root: {\n\n  },\n  inner: {\n    display: 'flex',\n    flexDirection: 'column'\n    // padding: theme.spacing(1)\n  },\n  dlgTitle: {\n    background: theme.palette.primary.main,\n    color: theme.palette.primary.contrastText\n  },\n  access: {\n    display: 'flex',\n    flexDirection: 'column'\n  },\n  accessRadio: {\n    margin: theme.spacing(2, 1)\n    // flex: '1 1 50%'\n  },\n  grow: {\n    flexGrow: 1\n  },\n  field: {\n    flexGrow: 0,\n    marginBottom: theme.spacing(1) * 2\n  },\n  slider: {\n    paddingLeft: theme.spacing(1),\n    paddingRight: theme.spacing(1)\n  },\n  textField: {\n    marginLeft: theme.spacing(1),\n    marginRight: theme.spacing(1),\n    width: '100%'\n  },\n  formLabel: {\n    display: 'block',\n    marginTop: theme.spacing(1),\n    marginBottom: theme.spacing(1)\n  },\n  mapFormLabel: {\n    display: 'block',\n    marginTop: theme.spacing(1),\n    marginBottom: theme.spacing(1)\n  },\n  mapInnerWrap: {\n    flexGrow: 1,\n    height: '200px',\n    minHeight: '200px'\n  },\n  mapWrapper: {\n    flexGrow: 1,\n    display: 'flex',\n    flexDirection: 'column',\n    paddingBottom: theme.spacing(1) * 2\n  },\n  formControl: {\n    margin: theme.spacing(1),\n    minWidth: 120\n  },\n  chips: {\n    display: 'flex',\n    flexWrap: 'wrap'\n  }\n})\n","import React, { useState, useContext } from 'react'\nimport classNames from 'classnames'\nimport PropTypes from 'prop-types'\n\nimport GridList from '@material-ui/core/GridList'\nimport GridListTile from '@material-ui/core/GridListTile'\nimport GridListTileBar from '@material-ui/core/GridListTileBar'\nimport Snackbar from '@material-ui/core/Snackbar'\nimport Button from '@material-ui/core/Button'\nimport Fab from '@material-ui/core/Fab'\n\nimport AddIcon from '@material-ui/icons/Add'\nimport RemoveIcon from '@material-ui/icons/Remove'\n\nimport { SeriesContext } from '../../contexts'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport style from './PhotoGrid.style'\nimport DeleteDialog from '../dialogs/DeleteDialog'\nimport { formatDate } from '../../../../lib/datelib'\n\nconst useStyles = makeStyles(style)\n\nconst PhotoGrid = ({ photos, columns, multiSelect, onDelete, onTileClick }) => {\n  const [selectMode, setSelectMode] = useState(false)\n  const classes = useStyles()\n  const [selectedItems, setSelectedItems] = useState([])\n  const [deleteConfirm, setDeleteConfirm] = useState(false)\n\n  const { seriesConfig, ac } = useContext(SeriesContext)\n\n  const handleAddToSelection = (e, id) => {\n    e.preventDefault()\n    e.stopPropagation()\n\n    setSelectMode(true)\n    toggleListItem(id)\n  }\n\n  const handleCancelSelection = () => {\n    setSelectMode(false)\n    setSelectedItems([])\n  }\n\n  const onDeleteConfirm = (confirmation) => {\n    setDeleteConfirm(false)\n    if (confirmation === true && selectedItems.length < photos.length) onDelete(selectedItems)\n    handleCancelSelection()\n  }\n\n  const toggleListItem = (id) => {\n    const index = selectedItems.indexOf(id)\n    if (index < 0) setSelectedItems([...selectedItems, id])\n    else {\n      const remaining = selectedItems.filter(arrId => arrId !== id)\n      if (remaining.length === 0) handleCancelSelection()\n      setSelectedItems(remaining)\n    }\n  }\n\n  const handlePhotoTap = (e, photo) => {\n    e.preventDefault()\n    e.stopPropagation()\n    // Select / deselect the item in edit mode\n    if (selectMode) toggleListItem(photo.id)\n    // navigate if tileClick selected\n    else onTileClick(photo.id)\n  }\n\n  const sortedPhotos = [...photos]\n  sortedPhotos.sort((a, b) => parseInt(b.takenOn, 10) - parseInt(a.takenOn, 10))\n\n  return (\n    <div>\n      <GridList cols={columns} cellHeight={200} className={classes.root}>\n        {sortedPhotos.map((photo, idx) => {\n          const selected = selectedItems.indexOf(photo.id) > -1\n          const canDelete = ac.canUser('delete', photo, 'photo')\n\n          let photoUrl = seriesConfig.getPhotoUrl(photo, 'thumb') || photo.base64\n\n          return (\n            <GridListTile\n              key={`gridTile${idx}`}\n              onClick={(e) => canDelete && handlePhotoTap(e, photo)}\n              className={classNames(\n                classes.tile,\n                selectMode && !canDelete && classes.notDeleteable,\n                selectMode && canDelete && !selected && classes.unSelectedTile,\n                selectMode && selected && classes.selectedTile\n              )}\n            >\n              <img src={photoUrl} alt={photoUrl} className={classes.img} />\n              {canDelete && multiSelect && (\n                <Fab size='small' aria-label='Add' className={classes.addFab} onClick={(e) => handleAddToSelection(e, photo.id)}>\n                  {!selectMode || !selected ? <AddIcon /> : <RemoveIcon />}\n                </Fab>\n              )}\n              <GridListTileBar\n                title={<span>{formatDate(photo.takenOn)}</span>}\n              />\n            </GridListTile>\n          )\n        })}\n      </GridList>\n      <Snackbar\n        open={selectMode}\n        autoHideDuration={null}\n        ContentProps={{\n          'aria-describedby': 'snackbar-fab-message-id',\n          className: classes.snackbarContent\n        }}\n        message={<span id='snackbar-fab-message-id'>{selectedItems.length} Photos selected</span>}\n        action={<div>\n          <Button color='inherit' disabled={selectedItems.length >= photos.length} size='small' onClick={() => setDeleteConfirm(true)}>\n                Delete\n          </Button>\n          <Button color='inherit' size='small' onClick={() => handleCancelSelection()}>\n                Cancel\n          </Button>\n        </div>\n        }\n        className={classes.snackbar}\n      />\n\n      <DeleteDialog\n        open={deleteConfirm}\n        onConfirm={onDeleteConfirm}\n        title={`Delete ${selectedItems.length} Photos`}\n        message='Are you sure you want to delete these photos?'\n      />\n    </div>\n\n  )\n}\n\nPhotoGrid.propTypes = {\n  photos: PropTypes.array.isRequired,\n  columns: PropTypes.number,\n\n  multiSelect: PropTypes.bool,\n  onDelete: PropTypes.func,\n  onTileClick: PropTypes.func.isRequired\n}\nPhotoGrid.defaultProps = {\n  multiSelect: true,\n  columns: 2\n}\n\nexport default PhotoGrid\n","import { red } from '@material-ui/core/colors'\nexport default theme => ({\n  root: {\n\n  },\n  tile: {\n\n  },\n  addFab: {\n    position: 'absolute',\n    zIndex: 10,\n    top: theme.spacing(1),\n    left: theme.spacing(1),\n    opacity: 0.3\n  },\n  notDeleteable: {\n    background: theme.palette.primary.dark,\n    opacity: 0.1\n    // '& img': {\n    // }\n  },\n  unSelectedTile: {\n    '& img': {\n      opacity: 0.7\n    }\n  },\n  selectedTile: {\n    padding: `${theme.spacing(2)}px!important`,\n    '& img': {\n      opacity: 1\n    }\n  },\n  img: {\n\n  },\n  snackbarContent: {\n    backgroundColor: red[700]\n  },\n  snackbar: {\n  }\n})\n","import React, { useState, useContext } from 'react'\nimport PropTypes from 'prop-types'\nimport exifParser from 'exif-parser'\nimport { isNumeric } from '../../../lib/util'\n\nimport PhotoReviewTool from './PhotoReviewTool'\nimport CameraTool from './CameraTool'\nimport NewPhotoInfo from './NewPhotoInfo'\nimport LibraryFilePicker from './controls/LibraryFilePicker'\n\nimport PhotoClass from '../../../lib/Photo'\nimport SeriesClass from '../../../lib/Series'\nimport { useDeviceOrientation, useGeolocation } from '../../../lib/sensors'\n\nimport { SeriesContext } from '../contexts'\n\nconst MODES = {\n  CAMERA: 'camera',\n  FILEPICKER: 'library',\n  PHOTOREVIEW: 'photoreview',\n  PHOTOINFOEDIT: 'photoinfoedit'\n}\n\nconst NewPhoto = ({ inputMethod, onCreate, onCancel, isNewSeries }) => {\n  const { seriesConfig, series } = useContext(SeriesContext)\n  const [newPhoto, setNewPhoto] = useState(null)\n  const [newSeries, setNewSeries] = useState(isNewSeries ? new SeriesClass(seriesConfig).series : null)\n\n  const [photoRefId, setPhotoRefId] = useState(null)\n  const [mode, _changeMode] = useState({ current: inputMethod, history: [] })\n  const orientation = useDeviceOrientation()\n  const geo = useGeolocation()\n\n  const photos = series && series.photos ? series.photos : []\n\n  const onLibraryAdd = (data) => {\n    console.log('onLibraryAdd Debug GOT DATA', { data })\n    const find = 'base64,'\n    let exif = {}\n    const foundIdx = data.indexOf(find) + find.length\n    const newData = data.slice(foundIdx)\n    const parser = exifParser.create(Buffer.from(newData, 'base64'))\n    console.log('onLibraryAdd Buffered')\n    try {\n      exif = parser.parse()\n      console.log('got EXIF', JSON.stringify(exif))\n    }\n    catch (err) {\n    // got invalid data, handle error\n      console.error('EXIF ERROR', err)\n    }\n    // Ok, now try to get the datetime off the EXIF\n    let date = String(Date.now())\n    try {\n      date = String(exif.tags.DateTimeOriginal)\n    }\n    catch (err) {\n      console.log('EXIF', exif)\n      console.error('ERROR GETTING TIMESTAMP', err)\n    }\n    console.log('isNewSeries', { isNewSeries })\n    if (isNewSeries) {\n      let { latitude, longitude } = geo\n      // Stanley park as a fallback if we can't get the geo\n      if (!latitude || !longitude) {\n        latitude = 49.3050394\n        longitude = -123.1398254\n      }\n      try {\n        if (exif.tags.GPSLatitude && isNumeric(exif.tags.GPSLatitude) && exif.tags.GPSLongitude && isNumeric(exif.tags.GPSLongitude)) {\n          latitude = exif.tags.GPSLatitude\n          longitude = exif.tags.GPSLongitude\n        }\n      }\n      catch (e) {\n        console.error('GPS Longitude and Latitude could not be determined')\n      }\n      console.log('LATLONG FOR LIB PICK', { geo, latitude, longitude })\n      setNewSeries({ ...newSeries, latitude, longitude })\n    }\n    const photoInitObj = new PhotoClass(seriesConfig).photo\n    const fullNewPhotoObject = {\n      ...photoInitObj,\n      takenOn: date,\n      rawData: { exif },\n      base64: data\n    }\n    setNewPhoto(fullNewPhotoObject)\n    changeMode(MODES.PHOTOREVIEW)\n    console.log('onLibraryAdd FINISHED', fullNewPhotoObject)\n  }\n\n  const changeMode = (newModeName) => {\n    console.log('NEWPHOTO changeMode', mode, newModeName)\n    _changeMode({\n      current: newModeName,\n      history: [...mode.history, mode.current]\n    })\n  }\n  const lastMode = () => {\n    if (mode.history.length > 0) {\n      const oldHistory = [...mode.history]\n      const oldMode = oldHistory.pop()\n      _changeMode({\n        current: oldMode,\n        history: oldHistory\n      })\n    }\n    else {\n      onCancel()\n    }\n  }\n\n  const onShutter = (data, refId) => {\n    const photoInitObj = new PhotoClass(seriesConfig).photo\n\n    console.log('onShutter Debug GOT DATA', { data })\n    const find = 'base64,'\n    let exif = {}\n    const foundIdx = data.base64.indexOf(find) + find.length\n    const newData = data.base64.slice(foundIdx)\n    const parser = exifParser.create(Buffer.from(newData, 'base64'))\n    console.log('onLibraryAdd Buffered')\n    try {\n      exif = parser.parse()\n      console.log('got EXIF', JSON.stringify(exif))\n    }\n    catch (err) {\n    // got invalid data, handle error\n      console.error('EXIF ERROR', err)\n    }\n\n    if (isNewSeries) {\n      let { latitude, longitude } = geo\n      // Stanley park as a fallback if we can't get the geo\n      if (!latitude || !longitude) {\n        latitude = 49.3050394\n        longitude = -123.1398254\n      }\n      setNewSeries({ ...newSeries, latitude, longitude })\n    }\n    setNewPhoto({\n      ...photoInitObj,\n      rawData: {\n        orient: orientation,\n        geolocate: geo\n      },\n      base64: data.base64\n    })\n    setPhotoRefId(refId)\n    changeMode(MODES.PHOTOREVIEW)\n  }\n\n  let component = null\n  switch (mode.current) {\n    case MODES.CAMERA:\n      component = (\n        <CameraTool\n          photos={photos}\n          onShutter={onShutter}\n          onCancel={onCancel}\n        />\n      )\n      break\n    case MODES.FILEPICKER:\n      component = <LibraryFilePicker\n        onCancel={onCancel}\n        onLibraryAdd={onLibraryAdd}\n      />\n      // fileClick() // move this to useEffect to help with click handling\n      break\n    case MODES.PHOTOREVIEW:\n      component = (\n        <PhotoReviewTool\n          defaultRefPhotoId={photoRefId}\n          photos={photos}\n          captured={newPhoto}\n          onConfirm={() => changeMode(MODES.PHOTOINFOEDIT)}\n          onCancel={onCancel}\n          onRetry={lastMode}\n        />\n      )\n      break\n    case MODES.PHOTOINFOEDIT:\n      component = (\n        <NewPhotoInfo\n          photo={newPhoto}\n          newSeries={newSeries}\n          onSave={onCreate}\n          onCancel={onCancel}\n        />\n      )\n      break\n    default:\n      console.log('NEWPHOTO: default state. you should NEVER see this', mode)\n      onCancel()\n  }\n\n  return component\n}\n\nNewPhoto.propTypes = {\n  inputMethod: PropTypes.oneOf(['camera', 'library']),\n  onCreate: PropTypes.func.isRequired,\n  onCancel: PropTypes.func.isRequired,\n  isNewSeries: PropTypes.bool,\n  seriesConfig: PropTypes.object,\n  // This might be a new series so we might have\n  // actions to work on that\n  // This will be provided EITHER photos or onSeriesCreate\n  photos: PropTypes.array\n}\n\nexport default NewPhoto\n","import uuid from 'uuid/v4'\nimport { convertJSDatetoTimestamp } from './datelib'\nimport SeriesConfig from './SeriesConfig'\n\nclass Photo {\n  constructor (seriesConfig, photo) {\n    this.config = new SeriesConfig(seriesConfig)\n    if (photo) this.photo = photo\n    else {\n      this.photo = this.newPhoto()\n    }\n  }\n\n  setMeta = () => {\n    this.meta = JSON.stringify(this.config.getPhotoMeta())\n  }\n\n  newPhoto = () => ({\n    id: '_' + uuid(),\n    takenOn: convertJSDatetoTimestamp(new Date()),\n    meta: JSON.stringify(this.config.getPhotoMeta()),\n    tags: []\n  })\n}\n\nexport default Photo\n","import uuid from 'uuid/v4'\nimport SeriesConfig from './SeriesConfig'\n\nclass Series {\n  constructor (seriesConfig, series) {\n    this.config = new SeriesConfig(seriesConfig)\n    if (series) this.series = series\n    else {\n      this.series = this.newSeries()\n    }\n  }\n\n  setMeta = () => {\n    this.meta = JSON.stringify(this.config.getSeriesMeta())\n  }\n\n  newSeries = () => ({\n    id: '_' + uuid(),\n    meta: JSON.stringify(this.config.getSeriesMeta()),\n    photos: []\n  })\n}\n\nexport default Series\n","import moment from 'moment'\n\n/**\n * Takes a UTC unix timestamp integer or string (milliseconds)\n * and a valid moment format string and returns a formatted\n * date string\n * @param {*} utctimestamp\n * @param {*} format\n */\nexport const formatDate = (utctimestamp, format = 'LLLL') => {\n  return moment(utctimestamp, 'x').format(format)\n}\n\nexport const formatDatAgo = (utctimestamp) => {\n  return moment(utctimestamp, 'x').fromNow()\n}\n\n/**\n * Takes a UTC timestamp and returns a moment object in LOCAL mode\n * @param {*} utctimestamp\n */\nexport const parseDate = (utctimestamp) => {\n  return moment(utctimestamp, 'x')\n}\n\n/**\n * This returns the object in LOCAL mode\n * @param {*} jsDate\n */\nexport const convertJSDatetoTimestamp = (jsDate) => {\n  return moment\n    .utc(jsDate)\n    .format('x')\n}\n\n/**\n *\n * @param {*} utctimestamp\n */\nexport function timestampToHTML5Input (utctimestamp) {\n  // // trim the Z and milliseconds + seconds\n  return moment(utctimestamp, 'x').format('YYYY-MM-DDTkk:mm')\n}\n\n/**\n * Returns an integer timestamp\n * @param {*} isoStr\n */\nexport function HTML5InputToTimestamp (isoStr) {\n  return moment(new Date(isoStr), 'YYYY-MM-DDTkk:mm').format('x')\n}\n","import React, { useEffect, useRef } from 'react'\n\nconst useFileInput = (onChange = () => {}) => {\n  const inputRef = useRef()\n  const clickRef = useRef()\n\n  const element = (\n    <input style={{ display: 'none' }} ref={inputRef} type='file' />\n  )\n\n  const forceClick = () => {\n    if (inputRef.current) inputRef.current.click()\n  }\n\n  useEffect(() => {\n    const handleChange = evt => {\n      const [file] = [...inputRef.current.files]\n      if (file) {\n        const reader = new FileReader()\n        reader.onload = e => {\n          onChange(e.target.result)\n        }\n        reader.readAsDataURL(file)\n      }\n      inputRef.current.value = null\n    }\n\n    if (inputRef.current) {\n      inputRef.current.addEventListener('change', handleChange)\n      if (!clickRef.current) {\n        inputRef.current.click()\n        clickRef.current = true\n      }\n    }\n    return () => {\n      if (inputRef.current) {\n        inputRef.current.removeEventListener('change', handleChange)\n      }\n    }\n  }, [inputRef.current])\n\n  return { fileClickEl: element, forceClick }\n}\n\nexport default useFileInput\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport PhotoLibraryIcon from '@material-ui/icons/PhotoLibrary'\nimport { makeStyles } from '@material-ui/core/styles'\nimport useFileInput from '../../../../lib/useFileInput'\nimport { Button } from '@material-ui/core'\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    height: '100%',\n    display: 'flex',\n    flexDirection: 'column',\n    textAlign: 'center',\n    color: theme.palette.grey[600],\n    border: `20px solid ${theme.palette.grey[400]}`\n  },\n  icon: {\n    color: theme.palette.grey[600],\n    margin: 'auto',\n    flex: '1 1 50%',\n    height: '70%',\n    width: '70%'\n  },\n  button: {\n    margin: theme.spacing(2)\n  }\n}))\n\nconst LibraryFilePicker = ({ onLibraryAdd, onCancel }) => {\n  const classes = useStyles()\n  const { fileClickEl, forceClick } = useFileInput(onLibraryAdd)\n  return (\n    <div className={classes.root}>\n      {fileClickEl}\n      <PhotoLibraryIcon className={classes.icon}color='inherit' onClick={forceClick} />\n      <Button variant='contained' className={classes.button} color='primary' onClick={forceClick}>\n        Import from Library\n      </Button>\n      <Button variant='outlined' className={classes.button} color='secondary' onClick={onCancel}>\n        Cancel\n      </Button>\n    </div>\n  )\n}\n\nLibraryFilePicker.propTypes = {\n  onLibraryAdd: PropTypes.func.isRequired,\n  onCancel: PropTypes.func.isRequired\n}\n\nexport default LibraryFilePicker\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport Typography from '@material-ui/core/Typography'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport DialogActions from '@material-ui/core/DialogActions'\nimport Button from '@material-ui/core/Button'\n\nimport SeriesEditInner from './subViews/SeriesEditInner'\n\n// import { SeriesContext } from '../contexts'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport style from './NewPhotoInfo.style'\nimport PhotoInfoInner from './subViews/PhotoInfoInner'\n\nconst useStyles = makeStyles(style)\n\nconst NewPhotoInfo = ({ photo, newSeries, onCancel, onSave }) => {\n  const classes = useStyles()\n  // const { series } = useContext(SeriesContext)\n  const [seriesDelta, setSeriesDelta] = useState(newSeries || {})\n  const [photoDelta, setPhotoDelta] = useState(photo)\n\n  // console.log('NewPhotoInfo', {\n  //   seriesDelta,\n  //   photoDelta,\n  //   photo,\n  //   series,\n  //   newSeries,\n  //   onCancel,\n  //   onSave\n  // })\n  // console.log('NewPhotoInfo', { series, seriesDelta, photoDelta })\n\n  return (\n    <div className={classes.root}>\n      <CssBaseline /> {/* You only need this in a root element. Don't put it anywhere else in the dom */}\n      <Dialog\n        fullScreen\n        fullWidth\n        scroll='paper'\n        disableBackdropClick\n        disableEscapeKeyDown\n        onClose={onCancel}\n        aria-labelledby='customized-dialog-title'\n        open\n      >\n        <DialogTitle disableTypography className={classes.dlgTitleContainer}>\n          <Typography variant='h5' className={classes.dlgTitle}>\n          New Photo Properties\n          </Typography>\n        </DialogTitle>\n        <DialogContent>\n\n          {!!newSeries && (\n            <SeriesEditInner\n              series={newSeries}\n              delta={seriesDelta}\n              onChange={setSeriesDelta}\n            />\n          )}\n\n          <PhotoInfoInner\n            photo={photo}\n            canEdit\n            delta={photoDelta}\n            onChange={(newAttr) => setPhotoDelta({ ...photoDelta, ...newAttr })}\n          />\n\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={onCancel} color='primary'>\n            Cancel\n          </Button>\n          <Button onClick={() => onSave({ series: seriesDelta, photo: photoDelta })} color='primary'>\n            Next\n          </Button>\n        </DialogActions>\n      </Dialog>\n    </div>\n  )\n}\n\nNewPhotoInfo.propTypes = {\n  photo: PropTypes.object.isRequired,\n  newSeries: PropTypes.object,\n  // Standard functions\n  onCancel: PropTypes.func.isRequired,\n  onSave: PropTypes.func\n}\n\nexport default NewPhotoInfo\n","export default theme => ({\n  root: {\n\n  },\n  formLabel: {\n    color: theme.palette.text.secondary\n  },\n  mapFormLabel: {\n    marginTop: theme.spacing(2),\n    marginBottom: theme.spacing(1),\n    color: theme.palette.text.secondary\n  },\n  map: {\n    marginBottom: theme.spacing(2)\n  },\n  mapWrapper: {\n    marginBottom: theme.spacing(2)\n  },\n  field: {\n    marginBottom: theme.spacing(2)\n  }\n})\n","import React, { useState, useContext } from 'react'\nimport PropTypes from 'prop-types'\n\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport Snackbar from '@material-ui/core/Snackbar'\nimport Button from '@material-ui/core/Button'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport Photo from './subViews/Photo'\nimport PhotoFadeSlider from './controls/PhotoFadeSlider'\nimport style from './PhotoReviewTool.style'\n\nimport { SeriesContext } from '../contexts'\nconst useStyles = makeStyles(style)\n\nconst PhotoReviewTool = ({\n  captured, defaultRefPhotoId,\n  onConfirm, onCancel, onRetry\n}) => {\n  const { series } = useContext(SeriesContext)\n  const photos = series && series.photos ? series.photos : null\n  const classes = useStyles()\n\n  const newRefPhoto = defaultRefPhotoId\n    ? photos.find(p => p.id === defaultRefPhotoId)\n    : photos && photos.length > 0 ? photos[0] : null\n\n  const [refPhoto, setRefPhoto] = useState(newRefPhoto)\n  const [slider, setSlider] = useState(100)\n\n  if (!captured) return 'Loading...'\n\n  return (\n    <div className={classes.root}>\n      <CssBaseline />\n      { Boolean(refPhoto) && (\n        <PhotoFadeSlider defaultValue={100} onChange={setSlider} />\n      )}\n\n      <div className={classes.captured}>\n        <Photo\n          opacity={slider / 100}\n          className={classes.capturedContainer}\n          photo={captured}\n        />\n      </div>\n      { Boolean(refPhoto) && (\n        <div className={classes.reference} >\n          <Photo\n            className={classes.referenceContainer}\n            photo={refPhoto}\n          />\n        </div>\n      )}\n      <Snackbar\n        open\n        autoHideDuration={null}\n        ContentProps={{\n          'aria-describedby': 'snackbar-fab-message-id',\n          className: classes.snackbarContent\n        }}\n        message={<span id='snackbar-fab-message-id'>Keep this photo?</span>}\n        action={<div>\n          <Button color='inherit' size='small' onClick={onCancel}>\n                Cancel\n          </Button>\n          {Boolean(onRetry) && (\n            <Button color='inherit' size='small' onClick={onRetry}>\n          Retry\n            </Button>\n          )}\n\n          <Button color='inherit' size='small' onClick={onConfirm}>\n                Keep\n          </Button>\n        </div>\n        }\n        className={classes.snackbar}\n      />\n    </div>\n  )\n}\n\nPhotoReviewTool.propTypes = {\n  defaultRefPhotoId: PropTypes.string,\n  captured: PropTypes.object,\n  // Now some functions\n  onConfirm: PropTypes.func.isRequired,\n  onCancel: PropTypes.func.isRequired,\n  onRetry: PropTypes.func // only for camera\n\n}\n\nexport default PhotoReviewTool\n","export default theme => ({\n  root: {\n    background: 'rgb(150,150, 150)',\n    // border: '5px solid red',\n    height: '100%',\n    width: '100%'\n  },\n  capturedContainer: {\n    position: 'absolute',\n    zIndex: 1,\n    height: '100%',\n    width: '100%'\n  },\n  referenceContainer: {\n    position: 'absolute',\n    zIndex: 0,\n    height: '100%',\n    width: '100%'\n  },\n  captured: {\n\n  },\n  reference: {\n\n  },\n  referenceTextContainer: {\n    width: '100%',\n    display: 'flex',\n    color: 'white',\n    background: 'rgba(0,0,0,0.5)',\n    padding: theme.spacing(3),\n    position: 'absolute',\n    zIndex: 4,\n    top: 0\n  },\n  newText: {\n    flexGrow: 1,\n    color: 'white',\n    textShadow: '1 1 1 black',\n    textAlign: 'right'\n  },\n  refText: {\n    flexGrow: 1,\n    color: 'white',\n    textShadow: '1 1 1 black'\n  }\n})\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\n\nimport Fab from '@material-ui/core/Fab'\nimport SwipeableDrawer from '@material-ui/core/SwipeableDrawer'\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport Typography from '@material-ui/core/Typography'\n\nimport CameraIcon from '@material-ui/icons/Camera'\nimport CancelIcon from '@material-ui/icons/Cancel'\nimport PhotoLibraryIcon from '@material-ui/icons/PhotoLibrary'\n\nimport PhotoFadeSlider from './controls/PhotoFadeSlider'\nimport PhotoGrid from './subViews/PhotoGrid'\nimport Photo from './subViews/Photo'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport style from './CameraTool.style'\nimport { useCamera } from '../../../lib/useCamera'\n\nconst useStyles = makeStyles(style)\n\n// https://googlechrome.github.io/samples/image-capture/grab-frame-take-photo.html\nconst CameraTool = ({ photos, onCancel, onShutter, defaultRefPhotoId }) => {\n  const classes = useStyles()\n  const [slider, setSlider] = useState(50)\n  const newRefPhoto = defaultRefPhotoId\n    ? photos.find(p => p.id === defaultRefPhotoId)\n    : photos && photos.length > 0 ? photos[0] : null\n\n  const [refPhoto, setRefPhoto] = useState(newRefPhoto)\n  const [drawerOpen, setDrawerOpen] = useState(false)\n  const { cameraError, captureImage, cameraOnline } = useCamera((data) => onShutter(data, refPhoto ? refPhoto.id : null))\n\n  const handleTileClick = (id) => {\n    setRefPhoto(photos.find(p => p.id === id))\n    setDrawerOpen(false)\n  }\n\n  return (\n    <div className={classes.root}>\n      <CssBaseline />\n      { !cameraError && Boolean(refPhoto) && (\n        <PhotoFadeSlider defaultValue={slider} onChange={setSlider} />\n      )}\n\n      { cameraError && (\n        <div className={classes.cameraErrorText}>\n          <Typography variant='subtitle1' color='inherit'>No Camera Access</Typography>\n          <Typography variant='body2' color='inherit'>Please enabled access in your settings.</Typography>\n        </div>\n      )}\n\n      <div className={classes.captured}>\n        { Boolean(refPhoto) && (\n          <div className={classes.reference} >\n            <Photo\n              className={classes.referenceContainer}\n              opacity={(100 - slider) / 100}\n              photo={refPhoto}\n            />\n          </div>\n        )}\n        { !cameraError && (\n          <video\n            autoPlay\n            playsInline\n            muted\n            id='webcam'\n            width={window.innerWidth}\n            height={window.innerHeight}\n            className={classes.video}\n          />\n        )}\n      </div>\n\n      <Fab\n        color='primary'\n        aria-label='Take Photo'\n        classes={{\n          disabled: classes.disabledFab\n        }}\n        disabled={cameraError || !cameraOnline}\n        className={classNames(classes.cameraFab, classes.buttonFab)}\n        onClick={captureImage}\n      >\n        <CameraIcon className={classes.cameraIcon} />\n      </Fab>\n\n      <Fab\n        color='secondary'\n        aria-label='cancel'\n        onClick={onCancel}\n        classes={{\n          disabled: classes.disabledFab\n        }}\n        className={classNames(classes.cancelFab, classes.buttonFab)}\n      >\n        <CancelIcon className={classes.cancelIcon} />\n      </Fab>\n\n      <Fab\n        aria-label='cancel'\n        className={classNames(classes.libraryFab, classes.buttonFab)}\n        classes={{\n          disabled: classes.disabledFab\n        }}\n        disabled={!photos || photos.length === 0}\n        onClick={() => setDrawerOpen(true)}\n      >\n        <PhotoLibraryIcon className={classes.libraryIcon} />\n      </Fab>\n\n      <SwipeableDrawer\n        anchor='left'\n        open={drawerOpen}\n        classes={{\n          paperAnchorLeft: classes.swipeDrawer\n        }}\n        onClose={() => setDrawerOpen(false)}\n        onOpen={() => setDrawerOpen(true)}\n      >\n        <div\n          tabIndex={0}\n          className={classes.swipeDrawerContainer}\n          role='button'\n          onClick={() => setDrawerOpen(false)}\n          onKeyDown={() => setDrawerOpen(false)}\n        >\n          <PhotoGrid\n            multiSelect={false}\n            columns={1}\n            photos={photos}\n            onTileClick={handleTileClick}\n          />\n        </div>\n      </SwipeableDrawer>\n\n    </div>\n  )\n}\n\nCameraTool.propTypes = {\n  photos: PropTypes.array,\n  defaultRefPhotoId: PropTypes.string, // id of the reference photo\n  onCancel: PropTypes.func.isRequired,\n  onShutter: PropTypes.func.isRequired\n}\n\nexport default CameraTool\n","export default theme => ({\n  root: {\n    background: 'black',\n    // border: '5px solid red',\n    height: '100%',\n    width: '100%'\n  },\n  cameraErrorText: {\n    color: 'white',\n    position: 'absolute',\n    top: '50%',\n    left: '50%',\n    width: '90%',\n    transform: 'translateY(-50%) translateX(-50%)',\n    textAlign: 'center'\n  },\n  disabledFab: {\n    color: '#AAAAA!important',\n    background: '#DDDDDD!important',\n    opacity: 0.2\n  },\n  cameraFab: {\n    position: 'absolute',\n    zIndex: 10,\n    '@media (orientation: landscape)': {\n      right: '20px',\n      top: '50%',\n      transform: 'translateY(-50%)',\n      height: '25vh',\n      width: '25vh'\n    },\n    '@media (orientation: portrait)': {\n      bottom: '20px',\n      left: '50%',\n      transform: 'translateX(-50%)',\n      height: '25vw',\n      width: '25vw'\n    }\n  },\n  cameraIcon: {\n    height: '100%',\n    width: '100%'\n  },\n  cancelFab: {\n    position: 'absolute',\n    zIndex: 10,\n    '@media (orientation: landscape)': {\n      right: '15px',\n      top: '15px',\n      height: '15vh',\n      width: '15vh'\n    },\n    '@media (orientation: portrait)': {\n      right: '15px',\n      bottom: '15px',\n      height: '15vw',\n      width: '15vw'\n    }\n  },\n  cancelIcon: {\n    height: '100%',\n    width: '100%'\n  },\n\n  swipeDrawer: {\n    width: '50%'\n  },\n\n  libraryFab: {\n    position: 'absolute',\n    zIndex: 10,\n    '@media (orientation: landscape)': {\n      left: '15px',\n      top: '15px',\n      height: '15vh',\n      width: '15vh'\n    },\n    '@media (orientation: portrait)': {\n      left: '15px',\n      top: '15px',\n      height: '15vw',\n      width: '15vw'\n    }\n  },\n\n  myLocationFab: {\n    position: 'absolute',\n    zIndex: 10,\n    '@media (orientation: landscape)': {\n      right: '15px',\n      bottom: '15px',\n      height: '15vh',\n      width: '15vh'\n    },\n    '@media (orientation: portrait)': {\n      left: '15px',\n      bottom: '15px',\n      height: '15vw',\n      width: '15vw'\n    }\n  },\n  myLocationIcon: {\n    height: '80%',\n    width: '80%'\n  },\n  capturedContainer: {\n    position: 'absolute',\n    zIndex: 1,\n    height: '100%',\n    width: '100%'\n  },\n  referenceContainer: {\n    position: 'absolute',\n    zIndex: 2,\n    height: '100%',\n    width: '100%'\n  },\n  captured: {\n\n  },\n  reference: {\n\n  },\n  video: {\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    height: '100vh',\n    width: '100vw',\n    zIndex: 1\n    // '@media (orientation: portrait)': {\n    //   transform: 'rotate(90)'\n    // }\n  }\n  // overlayImage: {\n  //   position: 'absolute',\n  //   top: 0,\n  //   left: 0,\n  //   zIndex: 3,\n  //   height: '100vh',\n  //   width: '100vw',\n  //   textAlign: 'center'\n  // },\n  // overlayImageInner: {\n  //   '@media (orientation: landscape)': {\n  //     height: '100%',\n  //     width: 'auto'\n  //   },\n  //   '@media (orientation: portrait)': {\n  //     width: '100%',\n  //     height: 'auto'\n  //   }\n  // },\n  // newImage: {\n  //   position: 'absolute',\n  //   top: 0,\n  //   left: 0,\n  //   zIndex: 2\n  // }\n})\n","import React from 'react'\n\nexport const SeriesContext = React.createContext({})\n","import numeral from 'numeral'\n\nexport const isNumeric = num => {\n  try {\n    return !isNaN(parseFloat(num)) && isFinite(num)\n  }\n  catch (e) {\n    return false\n  }\n}\n/**\n * This is a correction to strip === signs off of base64-encoded strings\n * @param {} x\n */\nexport const urlizeb64 = x => x.replace('+', '-').replace('/', '_').replace(/=+$/, '')\n\n/**\n * We need numbers displayed consistently. This is how we do it.\n * @param {*} num\n * @param {*} precision\n */\nexport function formatNum (num, precision) {\n  try {\n    const precstr = precision > 0 ? '.' + Array(precision + 1).join('0') : ''\n    const newprec = isNumeric(num) ? numeral(num).format(`0,0${precstr}`) : num\n    return newprec.replace(/(\\.(0{0,1}[1-9]*))0+$/, '$1')\n  }\n  catch (e) {\n    return num\n  }\n}\n\n/**\n * Magic function to clear mouse selection. Use sparingly.\n */\nexport function clearSelection () {\n  if (document.selection && document.selection.empty) {\n    document.selection.empty()\n  }\n  else if (window.getSelection) {\n    var sel = window.getSelection()\n    sel.removeAllRanges()\n  }\n}\n\nexport function isObjectWithKeys (obj) {\n  return ((typeof obj === 'object') && (obj !== null) && Object.keys(obj).length > 0)\n}\n\n/**\n * Dom node parsing is weird because it may return an array or a single element with no way to know\n * which is which.\n */\nexport function makeDomArray (domnode) {\n  if (!domnode) return []\n  const keys = Object.keys(domnode)\n  // This is not the pattern we expect\n  if (keys.length > 1 || keys.length === 0) throw Error('Expected nester domnode structure.')\n  if (!domnode) return []\n  if (!domnode[keys[0]]) return []\n  return Array.isArray(domnode[keys[0]]) ? domnode[keys[0]] : [domnode[keys[0]]]\n}\n\nexport function capitalizeFirstLetter (string) {\n  return string.charAt(0).toUpperCase() + string.slice(1)\n}\n\n/**\n * Good for comparing two purely numeric arrays\n * @param {*} arr1\n * @param {*} arr2\n */\nexport function numericArrayCompare (arr1, arr2) {\n  if (!Array.isArray(arr1) || !Array.isArray(arr2)) return false\n  if (arr1.length !== arr2.length) return false\n\n  return !arr1.some((el, idx) => el !== arr2[idx])\n}\n\n/**\n * We need a function to add the padding '=' signs back before we decode\n * @param {*} hash\n */\nexport function decodeUnbufferedBase64 (hash) {\n  const missingPadding = hash.length % 4\n  if (missingPadding !== 0) {\n    const newhash = hash + Array(4 - missingPadding).join('=')\n    return Buffer.from(newhash, 'base64').toString()\n  }\n  else {\n    return Buffer.from(hash, 'base64').toString()\n  }\n}\n\nexport function encodeUnbufferedBase64 (str) {\n  return urlizeb64(Buffer.from(str).toString('base64'))\n}\n\n/**\n *\n * @param {*} o\n */\nexport function isObject (o) {\n  return o instanceof Object && o.constructor === Object\n}\n\n/**\n * XML to JSON is a non-trivial exercise. We can make certain assumptions\n * about our incoming file\n * @param {*} data\n */\nexport function arrToObj (data) {\n  for (const key in data) {\n    // Make sure we're looping over legitimate objects\n    if (data.hasOwnProperty(key)) {\n      const keyDat = data[key]\n      if (keyDat._) {\n        keyDat.val = keyDat._\n        delete keyDat._\n      }\n      if (keyDat.$) {\n        keyDat.attr = keyDat.$\n        delete keyDat.$\n      }\n      if (typeof keyDat === 'object') {\n        data[key] = arrToObj(keyDat)\n        // There's a pattern we want to collapse\n        // It puts every single individual value into its own array. Not cool\n        if (Array.isArray(keyDat) && keyDat.length === 1 && typeof keyDat[0] === 'string') {\n          if (isNumeric(keyDat[0])) data[key] = Number(keyDat[0])\n          else data[key] = keyDat[0].replace(/\\\\/g, '/')\n        }\n        else if (Array.isArray(keyDat) && keyDat.length === 1 &&\n        // The second case is when it puts objects into its own array\n          isObject(keyDat[0]) &&\n          Object.keys(keyDat[0]).length === 1) {\n          // xml2js does a weird thing where attributes get put into the following structure\n          // [{ \"_\": \"475945.992587164,5125837.37170763\", \"$\": { \"units\": \"m\"  } }]\n          data[key] = keyDat[0][Object.keys(keyDat[0])[0]]\n        }\n        // Dynamo DB does not like empty strings\n        if (typeof data[key] && data[key].length === 0) {\n          delete data[key]\n        }\n        if (typeof data[key] === 'string' && isNumeric(data[key])) data[key] = Number(data[key])\n      }\n    }\n  }\n  return data\n}\n\n/**\n * Returns a random number between min (inclusive) and max (exclusive)\n */\nexport function getRandomArbitraryInt (min, max) {\n  return parseInt(Math.random() * (max - min) + min, 10)\n}\n\n/**\n * Returns a function, that, as long as it continues to be invoked, will not\n * be triggered. The function will be called after it stops being called for\n * N milliseconds. If `immediate` is passed, trigger the function on the\n * leading edge, instead of the trailing.\n * @param {*} func\n * @param {*} wait\n * @param {*} immediate\n */\nexport function debounce (func, wait, immediate) {\n  let timeout = null\n  return (...innerArgs) => {\n    const context = this\n    // const args = arguments\n    const callNow = immediate && !timeout\n    clearTimeout(timeout)\n\n    timeout = setTimeout(() => {\n      timeout = null\n      if (!immediate) {\n        // console.log('debounce', innerArgs)\n        func.apply(context, innerArgs)\n      }\n    }, wait)\n    if (callNow) {\n      // console.log('debounce', innerArgs)\n      func.apply(context, innerArgs)\n    }\n  }\n};\n\n// var myEfficientFn = debounce(function() {\n// // All the taxing stuff you do\n// }, 250);\n\n// window.addEventListener('resize', myEfficientFn);\n","// https://medium.com/@shalkam/create-react-app-i18n-the-easy-way-b05536c594cb\nimport React, { useContext } from 'react'\nimport PropTypes from 'prop-types'\nimport { IntlProvider, addLocaleData } from 'react-intl'\nimport frLocaleData from 'react-intl/locale-data/fr'\n\naddLocaleData(frLocaleData)\n\nexport const IntlContext = React.createContext({})\n\n// the format message hook\nexport const useIntl = () => {\n  const intl = useContext(IntlContext)\n  return intl.formatMessage\n}\n\nexport const IntlWrapper = ({ children }) => (\n  <IntlProvider locale='en'>\n    {children}\n  </IntlProvider>\n)\nIntlWrapper.propTypes = {\n  children: PropTypes.any\n}\n","import gql from 'graphql-tag'\n\nexport const allSeries = gql`\n  query allSeries($limit: Int, $nextToken: String) {\n    allSeries(limit: $limit, nextToken: $nextToken) {\n      seriesSummaries {\n        id\n        name\n        access\n        createdUser {\n          id\n          gravatar\n          gravatarProfile\n          username        \n        }\n        updatedOn\n        createdOn\n        photoCount\n        coords\n        direction\n        watchers\n        featured {\n          id\n          takenOn\n          paths {\n            base\n            thumb\n            medium\n            large\n          }\n        }\n        latest {\n          id\n          takenOn\n          paths {\n            base\n            thumb\n            medium\n            large\n          }\n        }\n      }\n      nextToken\n    }\n  }\n`\n\nexport const pollQuery = gql`\n  query pollQuery($lastCheck: String!, $limit: Int, $nextToken: String) {\n    changedSeries(lastCheck: $lastCheck, limit: $limit, nextToken: $nextToken){\n      seriesSummaries {\n        id\n        name\n        access\n        createdUser {\n          id\n          gravatar\n          gravatarProfile\n          username        \n        }\n        updatedOn\n        createdOn\n        photoCount\n        coords\n        direction\n        watchers\n        featured {\n          id\n          takenOn\n          paths {\n            base\n            thumb\n            medium\n            large\n          }\n        }\n        latest {\n          id\n          takenOn\n          paths {\n            base\n            thumb\n            medium\n            large\n          }\n        }\n      }\n    }\n  }\n`\n\nexport const userSeries = gql`\n  query userSeries($createdBy: ID) {\n    userSeries(createdBy: $createdBy ) {\n      seriesSummaries {\n        id\n        name\n        access\n        \n        createdUser {\n          id\n          gravatar\n          gravatarProfile\n          username        \n        }\n        updatedOn\n        createdOn\n        \n        photoCount\n        coords\n        direction\n        watchers\n        \n        featured {\n          id\n          takenOn\n          paths {\n            base\n            thumb\n            medium\n            large\n          }\n        }\n        latest {\n          id\n          takenOn\n          paths {\n            base\n            thumb\n            medium\n            large\n          }\n        }\n      }\n      nextToken\n    }\n  }\n`\n\nexport const seriesFromList = gql`\n  query seriesFromList($seriesList: [ID]) {\n    arraySeries(seriesIds: $seriesList) {\n      id\n      name\n      access\n      createdUser {\n        id\n        gravatar\n        gravatarProfile\n        username        \n      }\n      updatedOn\n      createdOn\n      photoCount\n      coords\n      direction\n      watchers\n      featured {\n        id\n        takenOn\n        paths {\n          base\n          thumb\n          medium\n          large\n        }\n      }\n      latest {\n          id\n          takenOn\n          paths {\n            base\n            thumb\n            medium\n            large\n          }\n        }\n    }\n  }\n`\n\nexport const seriesWithTag = gql`\n  query seriesWithTag($tag: String!, $limit: Int, $nextToken: String) {\n    tagSeries(tag: $tag, limit: $limit, nextToken: $nextToken) {\n      seriesSummaries{\n        id\n        name\n        access\n        createdUser {\n          id\n          gravatar\n          gravatarProfile\n          username        \n        }\n        updatedOn\n        createdOn\n        photoCount\n        coords\n        direction\n        watchers\n        featured {\n          id\n          takenOn\n          paths {\n            base\n            thumb\n            medium\n            large\n          }\n        }\n        latest {\n          id\n          takenOn\n          paths {\n            base\n            thumb\n            medium\n            large\n          }\n        }\n      }\n      nextToken\n    }\n  }\n`\n\nexport const tagSearch = gql`\n  query tagSearch($limit: Int, $tag: String) {\n    tags(limit: $limit, tag: $tag ){\n      name\n      count\n    }\n  }\n`\n\nexport const geoSeries = gql`\n  query seriesInGeoBounds($bounds: [Float], $limit: Int, $nextToken: String) {\n    seriesInGeoBounds(bounds: $bounds, limit: $limit, nextToken: $nextToken) {\n      seriesSummaries {\n        id\n        name\n        access\n        createdUser {\n          id\n          gravatar\n          gravatarProfile\n          username        \n        }\n        updatedOn\n        photoCount\n        coords\n        direction\n        watchers\n        featured {\n          id\n          takenOn\n          paths {\n            base\n            thumb\n            medium\n            large\n          }\n        }\n        latest {\n          id\n          takenOn\n          paths {\n            base\n            thumb\n            medium\n            large\n          }\n        }\n      }\n    }\n  }\n`\n\nexport const getUser = gql`\n  query getUser($userId: ID) {\n    user(id: $userId){\n      id\n      username\n      gravatar\n      gravatarProfile\n      createdOn\n      updatedOn\n      createdOn\n      watching\n    }\n  }\n`\n\nexport const geocode = gql`\n  query geocode($search: String!) {\n    geocoder(search: $search) {\n      relevance\n      text\n      placeName\n      bbox\n      center\n      # geoType\n      # context\n    }\n  }\n`\nexport const getMyFeed = gql`\n  query myFeed($start: String, $end: String, $limit: Int) {\n    myFeed(start: $start, end: $end, limit: $limit) {\n      feed {\n        series {\n          id\n          name\n          createdUser {\n            id\n            gravatar\n            username\n          }\n          updatedOn\n          createdOn\n          access\n          coords\n          watchers\n          photoCount\n        }\n        photo {\n          id\n          updatedOn\n          createdOn\n          createdUser {\n            id\n            gravatar\n            gravatarProfile\n            username\n          }\n          paths {\n            base\n            thumb\n            medium\n          }\n        }\n        relation\n      }\n      window\n    }\n  }\n`\n\nexport const userSearch = gql`\n  query userSearch($searchStr: String!, $limit: Int) {\n    userSearch(searchStr: $searchStr, limit: $limit ){\n      id\n      username\n      gravatar\n      gravatarProfile\n      createdOn\n      updatedOn\n      createdOn\n    }\n  }\n`\n\nexport const getWholeSeries = gql`\nquery getWholeSeries($id: ID!) {\n  series(id: $id) {\n    id\n    name\n    note\n    meta\n    watchers\n    createdOn\n    createdUser {\n      id\n      gravatar\n      gravatarProfile\n      username\n    }\n    updatedOn\n    createdOn\n    coords\n    direction\n    photoCount\n    featured {\n      id\n      takenOn\n      paths {\n        base\n        large\n        thumb\n        medium\n      }\n    }\n    latest {\n      id\n      paths {\n        base\n        large\n        thumb\n        medium\n      }\n      takenOn\n    }\n    photos {\n      id\n      meta\n      createdOn\n      takenOn\n      updatedOn\n      createdOn\n      createdUser {\n        id\n        gravatar\n        gravatarProfile\n        username\n      }\n      tags {\n        label\n        typeId\n        coords {\n          x\n          y\n        }\n      }\n      paths {\n        base\n        large\n        thumb\n        medium\n      }\n    }\n  }\n}\n`\n","import { createMuiTheme } from '@material-ui/core/styles'\nimport { fade, lighten } from '@material-ui/core/styles/colorManipulator'\n// import {\n//   cyan, teal, indigo, grey, blueGrey, pink, yellow, deepOrange, red\n// } from '@material-ui/core/colors'\n\n// We need this so that it doesn't freak out abotu old variants\nconst typography = {\n  useNextVariants: true\n}\n\nconst colors = {\n  jet: '#3a3335', // JET\n  rose: '#d81e5b', // DOGWOOD ROSE\n  redorange: '#f0544f', // RED-ORANGE\n  papayawhip: '#FDF0D5', // PAPAYA WHIP\n  cblue: '#C6D8D3' // COLUMBIA-BLUE\n}\n\nconst home = {\n  palette: {\n    primary: {\n      main: colors.redorange\n    },\n    secondary: {\n      main: colors.rose\n    },\n    text: {\n      primary: colors.jet,\n      secondary: fade(colors.jet, 0.7)\n    }\n  },\n  typography\n}\n\nconst series = {\n  palette: {\n    primary: {\n      main: lighten(colors.jet, 0.1)\n    },\n    secondary: {\n      main: colors.rose\n    },\n    text: {\n      primary: colors.jet,\n      secondary: fade(colors.jet, 0.7)\n    }\n  },\n  typography\n}\n\nconst topbar = {\n  palette: {\n    primary: {\n      main: colors.redorange\n    },\n    secondary: {\n      main: colors.rose\n    }\n  },\n  typography\n}\n\nconst bottombar = {\n  palette: {\n    primary: {\n      main: colors.papayawhip\n    },\n    secondary: {\n      main: colors.redorange\n    }\n  },\n  typography\n}\n\nconst login = {\n  palette: {\n    primary: {\n      main: colors.redorange\n    },\n    secondary: {\n      main: colors.rose\n    },\n    text: {\n      primary: colors.papayawhip,\n      secondary: fade(colors.papayawhip, 0.7)\n    },\n    background: {\n      default: colors.jet,\n      paper: colors.jet\n    }\n  },\n  typography\n}\n\nexport default {\n  home: createMuiTheme(home),\n  login: createMuiTheme(login),\n  series: createMuiTheme(series),\n  topbar: createMuiTheme(topbar),\n  bottombar: createMuiTheme(bottombar)\n}\n","import React from 'react'\n\nexport const AppContext = React.createContext({})\n","import { useRef, useEffect } from 'react'\n\nconst useAuthCommon = () => {\n  const containerRef = useRef()\n  const handleKeyPress = (event) => {\n    if (event.key === 'Enter') {\n      if (containerRef.current) {\n        try {\n          const found = containerRef.current.getElementsByClassName('enterAction')\n          if (found && found[0]) found[0].click()\n        }\n        catch (e) {\n          console.error('useAuthCommon::handleKeyPress', e)\n        }\n      }\n    }\n  }\n  useEffect(() => {\n    if (containerRef.current) {\n      try {\n        document.addEventListener('keypress', handleKeyPress, false)\n      }\n      catch (e) {\n        console.error('useAuthCommon::useEffect', e)\n      }\n      return () => document.removeEventListener('keypress', handleKeyPress, false)\n    }\n  }, [])\n\n  return containerRef\n}\n\nexport default useAuthCommon\n","import React from 'react'\nimport createSvgIcon from '@material-ui/icons/utils/createSvgIcon'\n\nexport default createSvgIcon(\n  <React.Fragment>\n    <path d='M13.685,2.797c-0.44,1.273 0.852,3.525 -1.082,4.966c-1.247,0.93 -2.133,2.247 -2.743,4.167c-3.78,-7.611 2.788,-8.409 3.682,-10.699c0.64,1.255 5.18,2.608 2.89,4.873c1.28,-2.034 -2.359,-1.862 -2.747,-3.307Z' />\n    <path d='M4.921,5.953c0.883,1.017 3.479,1.024 3.76,3.42c0.181,1.545 0.879,2.971 2.238,4.459c-8.482,-0.532 -5.889,-6.619 -7.425,-8.538c1.407,0.073 4.848,-3.183 5.665,-0.066c-1.121,-2.126 -2.792,1.111 -4.238,0.725Z' />\n    <path d='M3.236,15.092c1.323,-0.256 2.627,-2.5 4.842,-1.546c1.428,0.615 3.013,0.724 4.98,0.292c-4.701,7.079 -8.676,1.79 -11.106,2.161c0.766,-1.183 -0.332,-5.791 2.775,-4.94c-2.402,-0.091 -0.433,2.974 -1.491,4.033Z' />\n    <path d='M10.309,21.121c0.439,-1.274 -0.852,-3.525 1.081,-4.967c1.247,-0.929 2.133,-2.246 2.743,-4.167c3.781,7.611 -2.788,8.409 -3.681,10.699c-0.641,-1.255 -5.181,-2.607 -2.891,-4.873c-1.28,2.034 2.359,1.863 2.748,3.308Z' />\n    <path d='M19.066,18.01c-0.883,-1.017 -3.479,-1.024 -3.76,-3.42c-0.182,-1.544 -0.88,-2.971 -2.238,-4.459c8.482,0.532 5.889,6.619 7.425,8.538c-1.407,-0.072 -4.849,3.183 -5.665,0.067c1.121,2.125 2.792,-1.112 4.238,-0.726Z' />\n    <path d='M20.751,8.871c-1.323,0.256 -2.627,2.501 -4.842,1.546c-1.429,-0.615 -3.013,-0.723 -4.98,-0.291c4.701,-7.08 8.676,-1.791 11.106,-2.162c-0.767,1.183 0.332,5.791 -2.775,4.94c2.401,0.092 0.433,-2.974 1.491,-4.033Z' />\n\n  </React.Fragment>, 'AppLogo')\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport { makeStyles } from '@material-ui/core/styles'\n// import style from './auth.style'\nimport useAuthCommon from './useAuthCommon'\nimport AppLogo from '../../icons/AppLogo'\n\nimport { ThemeProvider } from '@material-ui/styles'\nimport themes from '../../themes'\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    height: '100%'\n  },\n  bgSwoosh: {\n    width: '100%',\n    height: '100%',\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    zIndex: 0\n  },\n  logo: {\n    width: '100%',\n    height: '100%',\n    zIndex: 1\n  },\n  inner: {\n    width: '100%',\n    minWidth: 200,\n    maxWidth: 300,\n    position: 'absolute',\n    zIndex: 2,\n    textAlign: 'center',\n    top: '50%',\n    left: '50%',\n    transformOrigin: '50% 50%',\n    transform: 'translateY(-50%) translateX(-50%)'\n  }\n}))\n\nconst AuthContainer = ({ children }) => {\n  const containerRef = useAuthCommon()\n  const classes = useStyles()\n  return (\n    <ThemeProvider theme={themes.login}>\n      <div ref={containerRef} className={classes.root}>\n        <CssBaseline />\n        {/* Look for: LoginSwoosh.svg */}\n        {/* <svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 500 500' preserveAspectRatio='none' className={classes.bgSwoosh}>\n        <path className={classes.bgSwooshFill} d=' M 0 0 L 500 0 C 500 209.782 489.956 180 250 180 C 10.044 180 0 219.954 0 370 L 0 0 Z ' />\n      </svg> */}\n\n        <div className={classes.inner}>\n          {/* Look for: Logo.svg */}\n          <AppLogo className={classes.logo} />\n\n          <Typography variant='h5'>Photomon</Typography>\n          {children}\n        </div>\n      </div>\n    </ThemeProvider>\n  )\n}\n\nAuthContainer.propTypes = {\n  children: PropTypes.any\n}\n\nexport default AuthContainer\n","import React from 'react'\n// import PropTypes from 'prop-types'\n// import MenuIcon from '@material-ui/core/Menu'\n// import { makeStyles } from '@material-ui/core/styles'\n// import style from './auth.style'\nimport AuthContainer from './AuthContainer'\nimport { Typography } from '@material-ui/core'\n\n// const useStyles = makeStyles(style)\n\nconst Loading = () => {\n  // const classes = useStyles()\n  return (\n    <AuthContainer>\n      <Typography variant='h3'>Loading...</Typography>\n    </AuthContainer>\n  )\n}\n\nLoading.propTypes = {\n}\n\nexport default Loading\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\n/**\n * Note: this was one of the few components we didn't use hooks for\n * mostly because I couldn't find an easy way to do getDerivedStateFromError()\n *\n * We might revise this later\n */\nclass ErrorBoundary extends React.Component {\n  constructor (props) {\n    console.log('ErrorBoundary constructor')\n    super(props)\n    this.state = { hasError: false }\n  }\n\n  static getDerivedStateFromError (error) {\n    // Update state so the next render will show the fallback UI.\n    console.log('ErrorBoundary getDerivedStateFromError')\n    console.error(error)\n    return { hasError: true, error }\n  }\n\n  componentDidCatch (error, info) {\n    console.log('ErrorBoundary componentDidCatch')\n    console.error(error)\n    // You can also log the error to an error reporting service\n    // logErrorToMyService(error, info)\n  }\n\n  render () {\n    const { hasError, error } = this.state\n    const { fallback: FallbackUI } = this.props\n    if (hasError) {\n      console.log('ErrorBoundary hasError')\n      // You can render any custom fallback UI\n      return <FallbackUI error={error} />\n    }\n\n    return this.props.children\n  }\n}\nErrorBoundary.propTypes = {\n  children: PropTypes.any,\n  fallback: PropTypes.any\n}\n\nexport default ErrorBoundary\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport Button from '@material-ui/core/Button'\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport DialogContentText from '@material-ui/core/DialogContentText'\nimport TextField from '@material-ui/core/TextField'\nimport DialogActions from '@material-ui/core/DialogActions'\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport BugReportIcon from '@material-ui/icons/BugReport'\nimport ErrorIcon from '@material-ui/icons/Error'\nimport { makeStyles } from '@material-ui/core/styles'\n\nexport const SEND_STATES = {\n  UNSENT: 'UNSENT',\n  SENDING: 'SENDING',\n  SENT: 'SENT',\n  ERROR: 'ERROR'\n}\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    height: '100%',\n    overflow: 'hidden',\n    padding: theme.spacing(1),\n    display: 'flex',\n    flexDirection: 'column',\n    textAlign: 'center',\n    color: theme.palette.text.primary,\n    border: `20px solid ${theme.palette.text.secondary}`\n  },\n  button: {\n    // background: theme.palette.success.main,\n    // color: theme.palette.success.contrastText\n  },\n  icon: {\n    opacity: 0.5,\n    margin: 'auto',\n    flex: '0 1 10%',\n    // height: '50%',\n    width: '50%'\n  },\n  text: {\n  },\n  spacer: {\n    flexGrow: 1\n  },\n  stack: {\n    padding: theme.spacing(2),\n    marginBottom: theme.spacing(2),\n    fontSize: '8px',\n    flexGrow: 1,\n    textAlign: 'left',\n    whiteSpace: 'pre-wrap',\n    overflow: 'scroll',\n    color: theme.palette.error.main,\n    fontFamily: 'Consolas, monaco, monospace'\n  }\n}))\n\nconst ErrorScreen = ({ error, sendState, reportError }) => {\n  const classes = useStyles()\n  const [dlgOpen, setDialogOpen] = useState(false)\n  const [note, setNote] = useState('')\n\n  let stackEl = <div className={classes.spacer} />\n  try {\n    if (process.env.NODE_ENV === 'development') {\n      stackEl = (\n        <Typography className={classes.stack}>\n          {error.stack}\n        </Typography>\n      )\n    }\n  }\n  catch (e) {}\n\n  let buttonText = 'Report this bug'\n  let disabled = false\n  let color = 'primary'\n  switch (sendState) {\n    case SEND_STATES.UNSENT:\n      buttonText = 'Report this bug'\n      break\n    case SEND_STATES.SENDING:\n      disabled = true\n      color = 'default'\n      buttonText = 'Sending...'\n      break\n    case SEND_STATES.SENT:\n      color = 'default'\n      disabled = true\n      buttonText = 'Thank you for your feedback'\n      break\n    case SEND_STATES.ERROR:\n      color = 'secondary'\n      disabled = true\n      buttonText = 'ERROR SENDING BUG REPORT'\n      break\n    default:\n      break\n  }\n\n  return (\n    <div className={classes.root}>\n      <CssBaseline />\n      <ErrorIcon className={classes.icon} color='error' />\n      <Typography variant='subtitle1' className={classes.text} color='inherit'>\n        Something went wrong\n      </Typography>\n      {error && error.message && <Typography variant='body1' className={classes.text} color='inherit'>\n        {error.message}\n      </Typography>}\n      <Button\n        className={classes.button}\n        variant='contained'\n        disabled={disabled}\n        color={color}\n        onClick={() => setDialogOpen(true)}\n      >\n        <BugReportIcon />\n        {buttonText}\n      </Button>\n      {stackEl}\n      <Dialog open={dlgOpen} onClose={() => setDialogOpen(false)} aria-labelledby='form-dialog-title'>\n        <DialogTitle id='form-dialog-title'>Report a bug</DialogTitle>\n        <DialogContent>\n          <DialogContentText>\n            What were you trying to do when the error happened?\n          </DialogContentText>\n          <TextField\n            autoFocus\n            margin='dense'\n            multiline\n            onChange={(e) => setNote(e.target.value)}\n            rowsMax='6'\n            id='note'\n            placeholder='I tried to X and then Y happened...'\n            label='Note'\n            fullWidth\n          />\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={() => setDialogOpen(false)} color='primary'>\n            Cancel\n          </Button>\n          <Button onClick={() => {\n            reportError(note)\n            setDialogOpen(false)\n          }} color='primary'>\n            Send\n          </Button>\n        </DialogActions>\n      </Dialog>\n    </div>\n  )\n}\n\nErrorScreen.propTypes = {\n  error: PropTypes.object,\n  sendState: PropTypes.string,\n  reportError: PropTypes.func.isRequired\n}\n\nexport default ErrorScreen\n","import gql from 'graphql-tag'\n\nexport const deletePhoto = gql`\n  mutation deletePhoto($seriesId: ID!, $photoId: ID!) {\n    deletePhoto(seriesId: $seriesId, photoId: $photoId)\n  }\n`\n\nexport const deleteSeries = gql`\n  mutation deleteSeries($id: ID!) {\n    deleteSeries(id: $id)\n  }\n`\n\nexport const updateSeries = gql`\n  mutation updateSeries($series: UpdateSeriesInput!) {\n    updateSeries(series: $series){\n      id\n      name\n      note\n      meta\n      latitude\n      longitude\n      direction\n      photoCount\n      featured {\n        id\n        takenOn\n        paths {\n          base\n          thumb\n          medium\n          large\n        }\n      }     \n    }\n  }\n`\n\nexport const updatePhoto = gql`\n  mutation updatePhoto($photo: UpdatePhotoInput!) {\n    updatePhoto(photo: $photo){\n      id\n    }\n  }\n`\n\nexport const createPhoto = gql`\n  mutation createPhoto($photo: NewPhotoInput!, $ext: String!) {\n    createPhoto(photo: $photo, ext: $ext) {\n      photo {\n        id\n        meta\n        createdUser {\n          id\n          gravatar\n          gravatarProfile\n          name\n        }\n        seriesId\n        # createdOn\n        takenOn\n        # updatedOn\n        tags {\n          label\n          typeId\n          coords {\n            x\n            y\n          }\n        }\n        paths {\n          base\n          thumb\n          medium\n          large\n        }\n      }\n      preAuth\n    }\n  }\n`\n\nexport const createSeries = gql`\n  mutation createSeries($series: NewSeriesInput!) {\n    createSeries(series: $series) {\n      id\n      name\n      note\n      meta\n      # createdOn\n      # updatedOn\n      latitude\n      longitude\n      direction\n      photoCount\n      featured {\n        id\n        takenOn\n        paths {\n          base\n          thumb\n          medium\n          large\n        }\n      }\n      # latest {\n      #   id\n      #   paths {\n      #     thumb\n      #   }\n      #   createdBy\n      #   createdOn\n      #   takenOn\n      #   updatedOn\n      # }\n      photos {\n        id\n        meta\n        createdUser {\n          id\n          gravatar\n          gravatarProfile\n          name\n        }   \n        # createdOn\n        takenOn\n        # updatedOn\n        tags {\n          label\n          typeId\n          coords {\n            x\n            y\n          }\n        }\n        paths {\n          base\n          thumb\n          medium\n          large\n        }\n      }\n    }\n  }\n`\n\nexport const watchSeries = gql`\n  mutation watch($seriesId: ID) {\n    watchSeries(seriesId: $seriesId)\n  }\n`\n\nexport const unWatchSeries = gql`\n  mutation unWatch($seriesId: ID) {\n    unWatchSeries(seriesId: $seriesId)\n  }\n`\n\nexport const reportBug = gql`\n  mutation reportBug($reportJSON: String!) {\n    reportBug(reportJSON: $reportJSON)\n  }\n`\n","import React, { useState } from 'react'\n// import PropTypes from 'prop-types'\nimport { graphql } from 'react-apollo'\nimport { connect } from 'react-redux'\nimport ErrorScreen, { SEND_STATES } from '../components/misc/ErrorScreen'\nimport { reportBug } from './mutations'\n\nconst ErrorConnect = (props) => {\n  const [state, setState] = useState(SEND_STATES.UNSENT)\n  const Wrapped = withReportBugMutation(ErrorScreen)\n  return <Wrapped {...props} setState={setState} sendState={state} />\n}\n\nconst withReportBugMutation = graphql(reportBug, {\n  props: ({ mutate, ownProps: { reduxState, error, setState } }) => {\n    console.log('withReportBugMutation props', { mutate, reduxState, error })\n    if (mutate.error) setState(SEND_STATES.ERROR)\n    return {\n      reportError: (note) => {\n        setState(SEND_STATES.SENDING)\n        let reportJSON = ''\n        const errObj = { note, reduxState, error, env: process.env }\n        console.log('withReportBugMutation StartingError', errObj)\n        try {\n          reportJSON = JSON.stringify(errObj)\n        }\n        catch (e) {\n          reportJSON = error.toString()\n        }\n        console.log('withReportBugMutation got through it', reportJSON)\n        return mutate({\n          variables: { reportJSON },\n          update: (store, { data }) => {\n            console.log('withReportBugMutation update', data)\n            setState(SEND_STATES.SENT)\n          }\n        })\n      }\n    }\n  }\n})\n\n/**\n * Map our redux state and functions\n */\nconst mapStateToProps = (state, props) => {\n  const { map, home, uploader, ...other } = state\n  const newMap = map.slice(-5) // only the last 5 map states come through\n\n  return {\n    reduxState: {\n      ...other,\n      map: newMap,\n      home\n    }\n  }\n}\n\nexport default connect(\n  mapStateToProps\n)(ErrorConnect)\n","import { useMemo } from 'react'\nimport { createHttpLink } from 'apollo-link-http'\nimport { setContext } from 'apollo-link-context'\nimport Amplify, { Auth } from 'aws-amplify'\n// import PropTypes from 'prop-types'\nimport { endpoints, aws } from '../config'\nimport { ApolloLink } from 'apollo-link'\nimport { InMemoryCache, ApolloClient } from 'apollo-boost'\n\nAmplify.configure(aws)\n\nconst LOCAL_STORAGE_TOKEN = 'apollo-token'\n\nfunction useGraphQL () {\n  const apolloClient = useMemo(createApolloClient, [])\n  return apolloClient\n}\n\nexport default useGraphQL\n\n/**\n * Helper function to create our Apollo Client object\n * @param {*} tokenFunc\n */\nconst getCurrentToken = async () => {\n  try {\n    const currSession = await Auth.currentSession()\n    return currSession.accessToken.jwtToken\n  }\n  catch (e) {\n    console.error(e)\n    return null\n  }\n}\n\nfunction createApolloClient () {\n  // Set up our headers for authentication through graphql\n  const cache = new InMemoryCache()\n\n  // The auth link is just used to decorate our HTTP headers with authentication data\n  const authLink = setContext(async (_, { headers }) => {\n    const token = await getCurrentToken()\n    const newHeaders = {\n      ...headers,\n      authorization: token ? `Bearer ${token}` : ''\n    }\n    // on Dev machines, allow us to fake a user. This will ONLY work with a complimentary\n    // Dev graphql endpoint and singin is still required.\n\n    // This was done so we can test what the App looks like from varying perspectives\n    if (token && process.env.NODE_ENV === 'development' && process.env.REACT_APP_FAKE_USER) {\n      newHeaders.auth_user = process.env.REACT_APP_FAKE_USER\n    }\n    return { headers: newHeaders }\n  })\n\n  // HTTP link creates the network connection to our graphql host\n  const httpLink = createHttpLink({ uri: endpoints.graphql })\n  console.log('Creating Apollo Client Client', endpoints.graphql)\n\n  const apolloClient = new ApolloClient({\n    link: ApolloLink.from([authLink, httpLink]),\n    tokenName: LOCAL_STORAGE_TOKEN,\n    cache,\n    connectToDevTools: process.env.NODE_ENV === 'development'\n  })\n\n  // Now put it all together\n  return apolloClient\n}\n\n// Note: this method comes from isntructions here:\n// https://www.apollographql.com/docs/react/recipes/authentication.html\n// export const withApollo = compose(\n//   lifecycle({\n//     shouldComponentUpdate (nextProps) {\n//       const { authStore: { jwtToken: oldToken } } = nextProps\n//       const { authStore: { jwtToken: newToken } } = this.props\n//       if (newToken === oldToken) {\n//         return true\n//       }\n//       return true\n//     }\n//   }),\n//   withWrapClient\n// )\n","export default theme => ({\n  root: {\n  },\n  spacer: {\n    flexGrow: 1\n  },\n  forgotPassword: {\n    width: '100%',\n    textAlign: 'right'\n  },\n  switch: {\n\n  },\n  switchButton: {\n    flexGrow: 1,\n    '&:last-child': {\n      borderRadius: 0\n    },\n    '&:first-child': {\n      borderRadius: 0\n    }\n  },\n  phoneNumInner: {\n    marginTop: theme.spacing(1),\n    display: 'flex'\n    // border: '1px solid red'\n  },\n  phoneNumDropdown: {\n    margin: theme.spacing(1),\n    minWidth: 120\n  },\n  warnText: {\n    marginTop: theme.spacing(2),\n    fontStyle: 'italic'\n  },\n  noSignin: {\n    marginTop: theme.spacing(2)\n  }\n})\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport TextField from '@material-ui/core/TextField'\nimport Button from '@material-ui/core/Button'\nimport Link from '@material-ui/core/Link'\nimport Toolbar from '@material-ui/core/Toolbar'\n// import MenuIcon from '@material-ui/core/Menu'\n// import { FederatedButtons } from 'aws-amplify-react'\nimport { makeStyles } from '@material-ui/core/styles'\nimport style from './auth.style'\nimport AuthContainer from './AuthContainer'\nimport { Typography } from '@material-ui/core'\n\nconst useStyles = makeStyles(style)\n\nconst SignIn = ({ loading,\n  handleSignup,\n  federated,\n  handleForgotPassword,\n  handleInputChange,\n  handleBeAnonymous,\n  handleSignIn, ...props }) => {\n  const classes = useStyles()\n  return (\n    <AuthContainer>\n      {/* {props.federated && (\n        <FederatedButtons {...props} />\n      )} */}\n      <TextField\n        id='username'\n        fullWidth\n        key='username'\n        name='username'\n        label='Username'\n        color='inherit'\n        autoFocus\n        className={classes.textField}\n        margin='normal'\n        onChange={handleInputChange}\n      />\n      <TextField\n        fullWidth\n        id='password'\n        label='Password'\n        color='inherit'\n        key='password'\n        name='password'\n        type='password'\n        className={classes.textField}\n        autoComplete='current-password'\n        margin='normal'\n        onChange={handleInputChange}\n      />\n      <Link component='button' variant='body2' className={classes.forgotPassword} disabled={loading} onClick={handleForgotPassword}>\n          Forgot Password\n      </Link>\n      <Toolbar disableGutters>\n\n        <Button component='button' color='secondary' variant='contained' disabled={loading} onClick={handleSignup}>\n          New Account\n        </Button>\n        <div className={classes.spacer} />\n        <Button\n          className='enterAction'\n          component='button'\n          color='primary'\n          variant='contained'\n          disabled={loading}\n          onClick={handleSignIn}\n        >\n          Sign In\n        </Button>\n      </Toolbar>\n\n      <div className={classes.noSignin}>\n        <Button fullWidth variant={'outlined'} onClick={handleBeAnonymous} color='inherit'>\n          Continue without logging in\n        </Button>\n        <Typography variant='caption' className={classes.warnText} color='textSecondary' component='div'>\n          You will not be able to add content and many features will be unavailable.\n        </Typography>\n      </div>\n    </AuthContainer>\n  )\n}\n\nSignIn.propTypes = {\n  loading: PropTypes.bool,\n  federated: PropTypes.object,\n  handleSignup: PropTypes.func.isRequired,\n  handleForgotPassword: PropTypes.func.isRequired,\n  handleInputChange: PropTypes.func.isRequired,\n  handleBeAnonymous: PropTypes.func.isRequired,\n  handleSignIn: PropTypes.func.isRequired\n}\n\nexport default SignIn\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport TextField from '@material-ui/core/TextField'\nimport Button from '@material-ui/core/Button'\nimport Toolbar from '@material-ui/core/Toolbar'\n// import MenuIcon from '@material-ui/core/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nimport style from './auth.style'\nimport AuthContainer from './AuthContainer'\n\nconst useStyles = makeStyles(style)\n\nconst ConfirmSignIn = ({ handleInputChange, handleBack, handleConfirm }) => {\n  const classes = useStyles()\n  return (\n    <AuthContainer>\n      <TextField\n        id='mfaCode'\n        fullWidth\n        autoFocus\n        label='MFA Code'\n        name='code'\n        className={classes.textField}\n        margin='normal'\n        onChange={handleInputChange}\n      />\n\n      <Toolbar disableGutters>\n        <Button color='secondary' variant='contained' onClick={handleBack}>\n          Back\n        </Button>\n        <div className={classes.spacer} />\n        <Button\n          className='enterAction'\n          color='primary'\n          variant='contained'\n          onClick={handleConfirm}\n        >\n          Confirm\n        </Button>\n      </Toolbar>\n    </AuthContainer>\n  )\n}\n\nConfirmSignIn.propTypes = {\n  handleInputChange: PropTypes.func.isRequired,\n  handleBack: PropTypes.func.isRequired,\n  handleConfirm: PropTypes.func.isRequired\n}\n\nexport default ConfirmSignIn\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport TextField from '@material-ui/core/TextField'\nimport Button from '@material-ui/core/Button'\nimport Typography from '@material-ui/core/Typography'\nimport Toolbar from '@material-ui/core/Toolbar'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport style from './auth.style'\nimport AuthContainer from './AuthContainer'\n\nconst useStyles = makeStyles(style)\n\nconst RequireNewPassword = ({ change, requiredAttributes, placeholders, handleInputChange }) => {\n  const classes = useStyles()\n  return (\n    <AuthContainer>\n      <Typography>A new password is required</Typography>\n      <TextField\n        id='newassword'\n        fullWidth\n        autoFocus\n        label='New Password'\n        className={classes.textField}\n        type='password'\n        autoComplete='new-password'\n        margin='normal'\n        onChange={handleInputChange}\n      />\n      {requiredAttributes\n        .map((attribute, idx) => (\n          <TextField\n            fullWidth\n            key={attribute}\n            name={attribute}\n            className={classes.textField}\n            placeholder={placeholders[idx]}\n            type='text'\n            margin='normal'\n            onChange={handleInputChange}\n          />\n        ))}\n\n      <Toolbar disableGutters>\n\n        <Button color='secondary' variant='contained'>\n          Back\n        </Button>\n        <div className={classes.spacer} />\n        <Button\n          color='primary'\n          variant='contained'\n          onClick={change}\n          className='enterAction'\n        >\n          Change\n        </Button>\n      </Toolbar>\n    </AuthContainer>\n  )\n}\n\nRequireNewPassword.propTypes = {\n  change: PropTypes.func.isRequired,\n  handleInputChange: PropTypes.func.isRequired,\n  requiredAttributes: PropTypes.array,\n  placeholders: PropTypes.array\n}\n\nexport default RequireNewPassword\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\nimport TextField from '@material-ui/core/TextField'\nimport Button from '@material-ui/core/Button'\nimport Toolbar from '@material-ui/core/Toolbar'\nimport FormControl from '@material-ui/core/FormControl'\nimport InputLabel from '@material-ui/core/InputLabel'\nimport Select from '@material-ui/core/Select'\nimport AuthContainer from './AuthContainer'\n\n// import MenuIcon from '@material-ui/core/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nimport style from './auth.style'\n// import AuthPhoneNum from './AuthPhoneNum'\nconst useStyles = makeStyles(style)\n\nconst SignUp = ({ handleInputChange, signUpFields, signUpFieldLabels, signUpFieldPlaceholders,\n  handleSignup, handleBack, countryDialCodes, defaultDialCode }) => {\n  console.log('SIGNUPPROPS', { defaultDialCode, countryDialCodes, signUpFields, signUpFieldLabels, signUpFieldPlaceholders })\n  const [selectVal, setSelectVal] = useState(defaultDialCode)\n  const classes = useStyles()\n  const handleDialCodeChange = e => {\n    handleInputChange(e)\n    setSelectVal(e.target.value)\n  }\n  return (\n    <AuthContainer>\n      {\n        signUpFields.map((field, idx) => {\n          return field.key !== 'phone_number' ? (\n            <TextField\n              fullWidth\n              autoFocus={signUpFields.findIndex(f => f.key === field.key) === 0}\n              type={field.type}\n              name={field.key}\n              key={field.key}\n              placeholder={signUpFieldPlaceholders[idx]}\n              label={signUpFieldLabels[idx]}\n              className={classes.textField}\n              margin='normal'\n              onChange={handleInputChange}\n            />\n          ) : (\n            <FormControl\n              className={classes.phoneNumDropdown}\n              fullWidth\n              key='phonenum'\n            >\n              <InputLabel htmlFor='dial_code' shrink>\n                {signUpFieldLabels[idx]}\n                {field.required ? '*' : ''}\n              </InputLabel>\n              <div className={classes.phoneNumInner}>\n                <Select\n                  value={selectVal}\n                  onChange={handleDialCodeChange}\n                  inputProps={{\n                    name: 'dial_code',\n                    id: 'dial_code'\n                  }}\n                >\n                  {countryDialCodes.map(dialCode =>\n                    <option key={dialCode} value={dialCode}>\n                      {dialCode}\n                    </option>\n                  )}\n                </Select>\n                <TextField\n                  placeholder={signUpFieldPlaceholders[idx]}\n                  type='tel'\n                  fullWidth\n                  id='phone_line_number'\n                  key='phone_line_number'\n                  name='phone_line_number'\n                  onChange={handleInputChange}\n                />\n              </div>\n            </FormControl>\n          )\n        })\n      }\n      <Toolbar disableGutters>\n        <Button color='secondary' variant='outlined' onClick={handleBack}>\n          Back\n        </Button>\n        <div className={classes.spacer} />\n        <Button\n          className='enterAction'\n          component='button'\n          color='primary'\n          variant='contained'\n          onClick={handleSignup}\n        >\n          Create Account\n        </Button>\n      </Toolbar>\n    </AuthContainer>\n  )\n}\n\nSignUp.propTypes = {\n  handleInputChange: PropTypes.func.isRequired,\n  signUpFields: PropTypes.array.isRequired,\n  signUpFieldLabels: PropTypes.array.isRequired,\n  signUpFieldPlaceholders: PropTypes.array.isRequired,\n  countryDialCodes: PropTypes.array.isRequired,\n  defaultDialCode: PropTypes.string.isRequired,\n  handleSignup: PropTypes.func.isRequired,\n  handleBack: PropTypes.func.isRequired\n}\n\nexport default SignUp\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport TextField from '@material-ui/core/TextField'\nimport Button from '@material-ui/core/Button'\nimport Link from '@material-ui/core/Link'\nimport Toolbar from '@material-ui/core/Toolbar'\n// import MenuIcon from '@material-ui/core/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nimport style from './auth.style'\nimport AuthContainer from './AuthContainer'\n\nconst useStyles = makeStyles(style)\n\nconst ConfirmSignUp = ({ handleInputChange, handleBack, handleResend, handleConfirm }) => {\n  const classes = useStyles()\n  return (\n    <AuthContainer>\n      <TextField\n        id='username'\n        fullWidth\n        autoFocus\n        name='username'\n        label='Username'\n        className={classes.textField}\n        margin='normal'\n        onChange={handleInputChange}\n      />\n      <TextField\n        id='confirmationCode'\n        fullWidth\n        name='code'\n        label='Confirmation Code'\n        className={classes.textField}\n        margin='normal'\n        onChange={handleInputChange}\n\n      />\n      <Link component='button' variant='body2' className={classes.resendCode} onClick={handleResend}>\n          Resend Code\n      </Link>\n      <Toolbar disableGutters>\n\n        <Button color='secondary' variant='outlined' onClick={handleBack}>\n          Back\n        </Button>\n        <div className={classes.spacer} />\n        <Button\n          color='primary'\n          variant='contained'\n          className='enterAction'\n          onClick={handleConfirm}\n        >\n          Sign In\n        </Button>\n      </Toolbar>\n    </AuthContainer>\n  )\n}\n\nConfirmSignUp.propTypes = {\n  handleInputChange: PropTypes.func.isRequired,\n  handleBack: PropTypes.func.isRequired,\n  handleResend: PropTypes.func.isRequired,\n  handleConfirm: PropTypes.func.isRequired\n}\n\nexport default ConfirmSignUp\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\nimport Link from '@material-ui/core/Link'\nimport TextField from '@material-ui/core/TextField'\nimport Typography from '@material-ui/core/Typography'\nimport Button from '@material-ui/core/Button'\n\nimport Toolbar from '@material-ui/core/Toolbar'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport style from './auth.style'\nimport AuthContainer from './AuthContainer'\n\nconst useStyles = makeStyles(style)\n\nconst ForgotPassword = ({ handleSubmit, handleInputChange, handleSendCode, handleBack }) => {\n  const [sent, setSent] = useState(false)\n  const classes = useStyles()\n  return (\n    <AuthContainer>\n      <Typography>Forgot Password</Typography>\n      {!sent && (\n        <TextField\n          id='username'\n          autoFocus\n          fullWidth\n          label='Username'\n          name='username'\n          className={classes.textField}\n          margin='normal'\n          onChange={handleInputChange}\n        />\n      )}\n      {sent && (\n        <TextField\n          id='changecode'\n          fullWidth\n          autoFocus\n          label='Code'\n          name='code'\n          className={classes.textField}\n          margin='normal'\n          onChange={handleInputChange}\n        />\n      )}\n      {sent && (\n        <TextField\n          id='newpassword'\n          fullWidth\n          label='New Password'\n          className={classes.textField}\n          type='password'\n          name='password'\n          autoComplete='current-password'\n          margin='normal'\n          onChange={handleInputChange}\n        />\n      )}\n      {sent && (\n        <Link component='button' variant='body2' className={classes.resendCode} onClick={handleSendCode}>\n          Resend Code\n        </Link>\n\n      )}\n      <Toolbar disableGutters>\n        <Button\n          color='secondary'\n          variant='outlined'\n          onClick={() => {\n            sent ? setSent(false) : handleBack()\n          }}\n        >\n          Back\n        </Button>\n        <div className={classes.spacer} />\n        {!sent && (\n          <Button\n            color='primary'\n            variant='contained'\n            className='enterAction'\n            onClick={() => {\n              setSent(true)\n              handleSendCode()\n            }}\n          >\n          Send Code\n          </Button>\n        )}\n        {sent && (\n          <Button\n            className='enterAction'\n            color='primary'\n            variant='contained'\n            onClick={handleSubmit}\n          >\n          Submit\n          </Button>\n        )}\n      </Toolbar>\n    </AuthContainer>\n  )\n}\n\nForgotPassword.propTypes = {\n  handleSubmit: PropTypes.func.isRequired,\n  handleInputChange: PropTypes.func.isRequired,\n  handleSendCode: PropTypes.func.isRequired,\n  handleBack: PropTypes.func.isRequired\n}\n\nexport default ForgotPassword\n","import React, { useState } from 'react'\nimport Amplify, { Auth } from 'aws-amplify'\nimport { I18n } from '@aws-amplify/core' // ConsoleLogger as Logger\nimport countryDialCodes from 'aws-amplify-react/dist/Auth/common/country-dial-codes'\nimport {\n  Authenticator,\n  SignIn as SignInOrig,\n  SignUp as SignUpOrig,\n  ConfirmSignIn as ConfirmSignInOrig,\n  ConfirmSignUp as ConfirmSignUpOrig,\n  RequireNewPassword as RequireNewPasswordOrig,\n  Loading as LoadingOrig,\n  VerifyContact as VerifyContactOrig,\n  ForgotPassword as ForgotPasswordOrig\n} from 'aws-amplify-react'\n\nimport CompSignIn from '../components/auth/SignIn'\nimport CompConfirmSignIn from '../components/auth/ConfirmSignIn'\nimport CompRequireNewPassword from '../components/auth/RequireNewPassword'\nimport CompSignUp from '../components/auth/SignUp'\nimport CompLoading from '../components/auth/Loading'\nimport CompConfirmSignUp from '../components/auth/ConfirmSignUp'\n// import CompVerifyContact from '../components/auth/VerifyContact'\nimport CompForgotPassword from '../components/auth/ForgotPassword' // or 'aws-amplify-react-native';\nimport { aws } from '../config'\n\nAmplify.configure(aws)\n\nconst defaultAuthState = { authState: 'init', authData: {}, signedIn: null }\n\nconst useAuthentication = () => {\n  const [{ authState, authData, signedIn }, setAuth] = useState(defaultAuthState)\n\n  // Set up the trinary\n  // if (authState === 'signedIn') signedIn = true\n\n  const handleAuthStateChange = (state, data) => {\n    // console.log('handleAuthStateChange', { state, data })\n    setAuth({\n      authState: state,\n      authData: data,\n      // true = signedIn, false = beAnonymous, null = showLoginScreen\n      signedIn: !state || state.length === 0\n        ? null\n        : state === 'signedIn'\n          ? true\n          : signedIn\n    })\n  }\n\n  const getCurrentToken = async () => {\n    const currSession = await Auth.currentSession()\n    console.log('here', currSession.accessToken)\n    return currSession && currSession.accessToken ? currSession.accessToken : null\n  }\n\n  const signOut = () => Auth.signOut()\n    .then(data => console.log(data))\n    .catch(err => console.log(err))\n\n  const beAnonymous = () => {\n    setAuth({ authState, authData, signedIn: false })\n  }\n\n  const authScreen = signedIn ? null\n    : <Authenticator onStateChange={handleAuthStateChange} hideDefault>\n      <SignIn handleBeAnonymous={beAnonymous} />\n      <Loading />\n      <RequireNewPassword />\n      {/* <RequireNewPasswordOrig /> */}\n      <ConfirmSignIn />\n      <ConfirmSignUp />\n      {/* <VerifyContact /> NOT READY */}\n      <VerifyContactOrig />\n      <ForgotPassword />\n      <SignUp />\n      {/* <SignUpOrig /> */}\n    </Authenticator>\n\n  let isGod = false\n  try {\n    isGod = authData.signInUserSession.idToken.payload['cognito:groups'].indexOf('GodUsers') > -1\n  }\n  catch (e) {}\n\n  return {\n    authState,\n    authData,\n    isGod,\n    signOut,\n    getCurrentToken,\n    forceSignIn: () => setAuth(defaultAuthState),\n    signedIn,\n    authScreen\n  }\n}\n\nexport default useAuthentication\n\nclass SignIn extends SignInOrig {\n  showComponent () {\n    const { loading } = this.state\n    const newProps = {\n      ...this.props,\n      loading,\n      handleForgotPassword: () => this.changeState('forgotPassword'),\n      handleSignup: () => this.changeState('signUp'),\n      handleInputChange: this.handleInputChange,\n      handleSignIn: this.signIn\n    }\n    return <CompSignIn {...newProps} />\n  }\n}\n\nclass SignUp extends SignUpOrig {\n  showComponent () {\n    const { hide } = this.props\n    if (hide && hide.includes(SignUp)) {\n      return null\n    }\n    if (this.checkCustomSignUpFields()) {\n      this.signUpFields = this.props.signUpConfig.signUpFields\n    }\n    this.sortFields()\n\n    const newProps = {\n      ...this.props,\n      countryDialCodes,\n      defaultDialCode: this.getDefaultDialCode(),\n      handleInputChange: this.handleInputChange,\n      signUpFields: this.signUpFields,\n      signUpFieldLabels: this.signUpFields.map(field => I18n.get(field.label)),\n      signUpFieldPlaceholders: this.signUpFields.map(field => I18n.get(field.placeholder)),\n      handleSignup: this.signUp,\n      handleBack: () => this.changeState('signIn')\n    }\n    return <CompSignUp {...newProps} />\n  }\n}\n\nclass ConfirmSignIn extends ConfirmSignInOrig {\n  showComponent () {\n    const newProps = {\n      ...this.props,\n      handleBack: () => this.changeState('signIn'),\n      handleInputChange: this.handleInputChange,\n      handleConfirm: this.confirm\n    }\n    return <CompConfirmSignIn {...newProps} />\n  }\n}\n\nclass ConfirmSignUp extends ConfirmSignUpOrig {\n  showComponent () {\n    const newProps = {\n      ...this.props,\n      handleBack: () => this.changeState('signIn'),\n      handleInputChange: this.handleInputChange,\n      handleConfirm: this.confirm,\n      handleResend: this.resend\n    }\n    return <CompConfirmSignUp {...newProps} />\n  }\n}\n\nclass RequireNewPassword extends RequireNewPasswordOrig {\n  showComponent () {\n    const user = this.props.authData\n    const { requiredAttributes } = user.challengeParam\n    const placeholders = Array.isArray(requiredAttributes)\n      ? requiredAttributes.map(attribute => I18n.get(convertToPlaceholder(attribute)))\n      : []\n\n    const newProps = {\n      ...this.props,\n      handleInputChange: this.handleInputChange,\n      requiredAttributes,\n      placeholders,\n      change: this.change\n    }\n    return <CompRequireNewPassword {...newProps} />\n  }\n}\n\nclass Loading extends LoadingOrig {\n  showComponent () {\n    return <CompLoading {...this.props} />\n  }\n}\n// class VerifyContact extends VerifyContactOrig {\n//   showComponent () {\n//     const user = this.props.authData\n//     if (!user) {\n//       verifyLogger.debug('no user for verify')\n//       return null\n//     }\n//     const { unverified } = user\n//     if (!unverified) {\n//       verifyLogger.debug('no unverified on user')\n//       return null\n//     }\n//     const { email, phoneNumber } = unverified\n\n//     const { authData } = this.props\n//     const newProps = {\n//       ...this.props,\n//       handleInputChange: this.handleInputChange,\n//       handleSkip: () => this.changeState('signedIn', authData),\n//       handleVerify: this.verify,\n//       handleSubmit: this.submit\n//     }\n//     return <CompVerifyContact {...newProps} />\n//   }\n// }\nclass ForgotPassword extends ForgotPasswordOrig {\n  showComponent () {\n    const newProps = {\n      ...this.props,\n      handleBack: () => this.changeState('signIn'),\n      handleInputChange: this.handleInputChange,\n      handleConfirm: this.confirm,\n      handleResend: this.send,\n      handleSubmit: this.submit,\n      handleSendCode: this.send\n    }\n    return <CompForgotPassword {...newProps} />\n  }\n}\n\n// const verifyLogger = new Logger('VerifyContact')\n\nfunction convertToPlaceholder (str) {\n  return str.split('_').map(part => part.charAt(0).toUpperCase() + part.substr(1).toLowerCase()).join(' ')\n}\n\n// const eqSpacer = '==============================================================='\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Snackbar from '@material-ui/core/Snackbar'\nimport Typography from '@material-ui/core/Typography'\nimport Paper from '@material-ui/core/Paper'\nimport AppLogo from '../../icons/AppLogo'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { Button } from '@material-ui/core'\nconst useStyles = makeStyles(theme => ({\n  root: {\n\n  },\n  content: {\n\n  },\n  messageWrapper: {\n    display: 'flex'\n  },\n  logo: {\n    height: 50,\n    width: 50\n  },\n  paper: {\n    background: theme.palette.text.primary,\n    color: theme.palette.primary.contrastText,\n    border: `2px solid ${theme.palette.primary.contrastText}`,\n    boxShadow: `0 0 0 0 ${theme.palette.primary.main}`,\n    animation: '$installPulse 2s infinite',\n    padding: theme.spacing(2, 3),\n    width: '100%'\n  },\n  '@keyframes installPulse': {\n    '0%': {\n      boxShadow: `0 0 0 0px ${theme.palette.primary.main}`\n    },\n    '50%': {\n      boxShadow: `0 0 0 0px ${theme.palette.primary.main}`\n    },\n    '100%': {\n      boxShadow: `0 0 0 20px transparent`\n    }\n  },\n  textWrapper: {\n    flexGrow: 1,\n    paddingLeft: theme.spacing(1)\n  },\n  buttons: {\n    display: 'flex'\n  },\n  spacer: {\n    flexGrow: 1\n  }\n}))\n\nconst InstallPrompt = ({ open, onClose, onInstall }) => {\n  const classes = useStyles()\n\n  return (\n    <Snackbar\n      anchorOrigin={{\n        vertical: 'bottom',\n        horizontal: 'center'\n      }}\n      open={open}\n      // autoHideDuration={6000}\n      onClose={onClose}\n    >\n      <Paper className={classes.paper} elevation={24}>\n        <div id='client-snackbar' className={classes.messageWrapper}>\n          <AppLogo className={classes.logo} />\n          <div className={classes.textWrapper}>\n            <Typography variant='body1' color='inherit'>Install Photomon</Typography>\n            <Typography variant='body2' color='inherit' paragraph>This app can be installed and used on your device natively and offline if you would like.</Typography>\n            <div className={classes.buttons}>\n              <Button color='secondary' variant='contained' onClick={onClose}>No thanks</Button>\n              <div className={classes.spacer} />\n              <Button color='primary' variant='contained' onClick={onInstall}>Install</Button>\n            </div>\n          </div>\n        </div>\n      </Paper>\n    </Snackbar>\n  )\n}\n\nInstallPrompt.propTypes = {\n  open: PropTypes.bool,\n  onClose: PropTypes.func.isRequired,\n  onInstall: PropTypes.func.isRequired\n}\n\nexport default InstallPrompt\n","import React, { useEffect, useState, useMemo } from 'react'\nimport { isIos } from './sensors'\nimport InstallPrompt from '../components/misc/InstallPrompt'\n/**\n * Everything below here is about the prompt for installing a PWA\n */\n\n// Detects if device is in standalone mode\nconst isInStandaloneMode = () => ('standalone' in window.navigator) && (window.navigator.standalone)\n\nconst useShowAddToHome = (showInstall, dismissInstall) => {\n  const [deferredPrompt, setPrompt] = useState(null)\n\n  const handleBeforePrompt = e => {\n    // Prevent Chrome 67 and earlier from automatically showing the prompt\n    e.preventDefault()\n    // Stash the event so it can be triggered later.\n    setPrompt(e)\n    // showAddToHomeScreen()\n  }\n\n  const installPrompt = useMemo(() => {\n    if (!showInstall || !deferredPrompt) return null\n    return <InstallPrompt open onClose={dismissInstall} onInstall={addToHomeScreen} />\n  }, [showInstall, deferredPrompt])\n\n  useEffect(() => {\n    // window.orientation [0,90,180, 270]\n    // screen\n    // Checks if should display install popup notification:\n    if (isIos() && !isInStandaloneMode()) {\n      console.log('I AM on IOS and I am NOT in standalone mode.')\n    // this.setState({ showInstallMessage: true })\n    }\n\n    window.addEventListener('beforeinstallprompt', handleBeforePrompt)\n    return () => {\n      window.removeEventListener('beforeinstallprompt', handleBeforePrompt)\n    }\n  }, [])\n\n  function addToHomeScreen () {\n    // Show the prompt\n    deferredPrompt.prompt()\n    // Wait for the user to respond to the prompt\n    deferredPrompt.userChoice\n      .then((choiceResult) => {\n        if (choiceResult.outcome === 'accepted') {\n          console.log('User accepted the A2HS prompt')\n          dismissInstall()\n        }\n        else {\n          console.log('User dismissed the A2HS prompt')\n          dismissInstall()\n        }\n        setPrompt(null)\n      })\n  }\n\n  // function showAddToHomeScreen () {\n  //   const a2hsBtn = document.querySelector('.ad2hs-prompt')\n  //   a2hsBtn.style.display = 'block'\n  //   a2hsBtn.addEventListener('click', addToHomeScreen)\n  // }\n\n  return {\n    installPrompt,\n    addToHomeScreen: installPrompt ? addToHomeScreen : null\n  }\n}\n\nexport default useShowAddToHome\n","import { useCallback, useState, useLayoutEffect } from 'react'\nimport { debounce } from './util'\nimport { isIos, isPhone } from './sensors'\n\nconst getState = () => {\n  const { orientation, innerWidth, innerHeight, screen: { width, height } } = window\n  const wOrient = [90, 270].indexOf(orientation) !== 0 ? 'portrait' : 'landscape'\n  const bIsIos = isIos()\n  const bIsPhone = isPhone()\n  const windowSize = { width: innerWidth, height: innerHeight }\n  const screenSize = { width, height }\n\n  const returnState = {\n    isPhone: bIsPhone,\n    isIos: bIsIos,\n    orientation: wOrient,\n    windowSize,\n    screenSize\n    // This failed. the only way to handle this is to set it explicitly\n    // isVKeyBdOn: bIsPhone && windowSize.height < screenSize.height\n  }\n  return returnState\n}\n\nconst useResponsive = (mediQueries) => {\n  const [state, setState] = useState(getState())\n\n  const handleResize = (e) => {\n    if (e) {\n      e.preventDefault()\n      e.stopPropagation()\n    }\n    const newState = getState()\n    // console.log('handleResize', newState)\n    setState(newState)\n  }\n\n  // const handleFlip = (e) => {\n  //   e.preventDefault()\n  //   e.stopPropagation()\n  //   const newState = getState()\n  //   console.log('handleFlip', newState)\n  //   setState(newState)\n  // }\n\n  const handleResizeDebounced = useCallback(debounce(handleResize, 500), [])\n  // const handleFlipDebounced = useCallback(debounce(handleFlip, 500), [])\n\n  useLayoutEffect(() => {\n    handleResizeDebounced()\n    window.addEventListener('resize', handleResizeDebounced)\n    // window.addEventListener('orientationchange', handleFlipDebounced)\n\n    return () => {\n      window.removeEventListener('resize', handleResizeDebounced)\n      // window.removeEventListener('orientationchange', handleFlipDebounced)\n    }\n  },\n  [])\n\n  return state\n}\n\nexport default useResponsive\n","/**\n * We put our action types at the top to keep them straight\n *\n * This is just a handy enumeration we use everywhere to make sure we're\n * all talking about the same ations\n */\nexport const Actions = {\n\n  HOME_CHANGE_STATE: 'HOME_CHANGE_STATE',\n  HOME_CHANGE_ACTIVE_SERIES: 'HOME_CHANGE_ACTIVE_SERIES',\n  HOME_STATE_BACK: 'HOME_STATE_BACK',\n\n  MAP_HISTORY_POP: 'MAP_HISTORY_POP',\n  MAP_HISTORY_PUSH: 'MAP_HISTORY_PUSH',\n  MAP_HISTORY_CLEAR: 'MAP_HISTORY_CLEAR',\n\n  UPLOADER_START: 'UPLOADER_START',\n  UPLOADER_COMPLETE: 'UPLOADER_COMPLETE',\n  UPLOADER_UPDATE_PROGRESS: 'UPLOADER_UPDATE_PROGRESS',\n\n  SETFLAG: 'SETFLAG'\n}\n\n/**\n * Now here are the actual action functions we will be dispatching\n * The actions have arguments related to what they do but they action they\n * dispatch consists only of a type and data3\n */\nexport default {\n  setHomeState: (newDomain, params) => ({ type: Actions.HOME_CHANGE_STATE, data: { newDomain, params } }),\n  homeStateBack: () => ({ type: Actions.HOME_STATE_BACK }),\n  setActiveSeries: (seriesId, initialPhoto) => ({ type: Actions.HOME_CHANGE_ACTIVE_SERIES, data: { seriesId, initialPhoto } }),\n\n  setFlag: (flagName, flagVal) => ({ type: Actions.SETFLAG, data: { flagName, flagVal } }),\n\n  popMapHistory: () => ({ type: Actions.MAP_HISTORY_POP }),\n  pushMapHistory: (viewportSave) => ({ type: Actions.MAP_HISTORY_PUSH, data: viewportSave }),\n  clearMapHistory: () => ({ type: Actions.MAP_HISTORY_CLEAR }),\n\n  queueUpload: (uploadObj) => ({ type: Actions.UPLOADER_START, data: uploadObj }),\n  // startActiveUpload: () => ({ type: Actions.UPLOADER_START }),\n  completeActiveUpload: () => ({ type: Actions.UPLOADER_COMPLETE }),\n  updateUploadProgress: (newProgress) => ({ type: Actions.UPLOADER_UPDATE_PROGRESS, data: newProgress })\n\n}\n","import { Actions } from '../actions'\nimport { home } from '../../config'\nconst mapInit = [\n  {\n    mode: home.MapModeTypes.FREE,\n    // selectedItem: null\n    viewport: {\n      // 'latitude': 49.2707848, // vancouver\n      // 'longitude': -123.0714866,\n      latitude: 36.80191008366581, // Grand Canyon\n      longitude: -111.63999999999784,\n      zoom: 11\n    }\n  }\n]\n\nexport default (state = mapInit, action) => {\n  const { type, data } = action\n\n  switch (type) {\n    case Actions.MAP_HISTORY_CLEAR:\n      const newClearerHistory = state.length > 0 ? [[state.length - 1]] : []\n      return newClearerHistory\n\n    case Actions.MAP_HISTORY_POP:\n      return state.slice(0, -1)\n\n    case Actions.MAP_HISTORY_PUSH:\n      return [...state, data]\n    default:\n      return state\n  }\n}\n","import { Actions } from '../actions'\nimport { home } from '../../config'\n\nconst homeInit = {\n  history: [],\n  current: {\n    domain: home.AppStateTypes.FEED\n    // search: null // { tab, text }\n    // defaultSearchTab:\n    // defaultSearchText:\n    // activeSeries: 'fda17bae-0335-4f0d-9065-dc8d7aa23ed1',\n    // initialPhoto: 'someguid'\n  }\n}\n\nexport default (state = homeInit, action) => {\n  const { type, data } = action\n  const { history, current } = state\n\n  switch (type) {\n    case Actions.HOME_STATE_BACK:\n      const newStateHistory = [...history]\n      const newCurrentState = newStateHistory.length > 0 ? newStateHistory.pop() : homeInit.current\n      return {\n        ...state,\n        current: newCurrentState,\n        history: newStateHistory\n      }\n\n    case Actions.HOME_CHANGE_ACTIVE_SERIES:\n      const { activeSeries, initialPhoto } = current\n      return {\n        ...state,\n        history,\n        current: {\n          ...current,\n          activeSeries: activeSeries || null,\n          initialPhoto: activeSeries && initialPhoto ? initialPhoto : null\n        }\n      }\n\n    case Actions.HOME_CHANGE_STATE:\n      const { newDomain, params } = data\n      const newParams = params || {}\n      const newHistory = [...history, current]\n      return {\n        ...state,\n        history: newHistory,\n        current: {\n          ...current,\n          domain: newDomain,\n          ...newParams\n        }\n      }\n\n    default:\n      return state\n  }\n}\n","import { Actions } from '../actions'\n\nconst initState = {\n  store: [],\n  activeUpload: null\n}\n\nexport default (state = initState, action) => {\n  const { type, data } = action\n  const { store, activeUpload } = state\n\n  switch (type) {\n    case Actions.UPLOADER_START:\n      if (!activeUpload) {\n        return {\n          ...state,\n          activeUpload: data\n        }\n      }\n      else {\n        return {\n          ...state,\n          store: [...store, data]\n        }\n      }\n    case Actions.UPLOADER_COMPLETE:\n      if (store.length === 0) {\n        return {\n          ...state,\n          activeUpload: null\n        }\n      }\n      else {\n        const newStore = [...store]\n        const newActive = newStore.pop()\n        return {\n          ...state,\n          store: newStore,\n          activeUpload: newActive\n        }\n      }\n    case Actions.UPLOADER_UPDATE_PROGRESS:\n      return {\n        ...state,\n        activeUpload: { ...activeUpload, ...data }\n      }\n    default:\n      return state\n  }\n}\n","import { Actions } from '../actions'\nimport { isIos } from '../../lib/sensors'\n\nconst defaultFlags = {\n  iOSWarning: isIos(),\n  install: true,\n  useLoggedOut: false\n}\nexport default (state = defaultFlags, action) => {\n  const { type, data } = action\n\n  switch (type) {\n    case Actions.SETFLAG:\n      const { flagName, flagVal } = data\n      return { ...state, [flagName]: flagVal }\n\n    default:\n      return state\n  }\n}\n","import { combineReducers } from 'redux'\nimport map from './map'\nimport home from './home'\nimport uploader from './uploader'\nimport flags from './flags'\n\nexport default combineReducers({ map, home, uploader, flags })\n","import { createStore, applyMiddleware, compose } from 'redux'\nimport thunk from 'redux-thunk'\nimport rootReducer from './reducers'\nimport { persistStore, persistReducer } from 'redux-persist'\nimport storage from 'redux-persist/lib/storage' // defaults to localStorage for web\n\n// import api from '../middleware/api'\n// https://github.com/reduxjs/redux/blob/master/examples/real-world/src/middleware/api.js\n\nconst persistConfig = {\n  key: 'root',\n  storage\n}\n\nconst persistedReducer = persistReducer(persistConfig, rootReducer)\n\n/**\n * On Dev we want our devTools available\n */\nconst configureStoreDev = preloadedState => {\n  const { devToolsEnhancer } = require('redux-devtools-extension')\n  const { createLogger } = require('redux-logger')\n  const store = createStore(\n    persistedReducer,\n    preloadedState,\n    compose(\n      devToolsEnhancer(),\n      applyMiddleware(\n        thunk,\n        createLogger()\n      )\n    )\n  )\n  if (module.hot) {\n    // Enable Webpack hot module replacement for reducers\n    module.hot.accept('./reducers', () => {\n      store.replaceReducer(rootReducer)\n    })\n  }\n  return store\n}\n\n/**\n * Production gets a simpler more performant store:\n */\nconst configureStoreProd = preloadedState => {\n  const store = createStore(\n    persistedReducer,\n    preloadedState,\n    compose(\n      applyMiddleware(\n        thunk\n      )\n    )\n  )\n  return store\n}\n\nexport default () => {\n  const store = process.env.NODE_ENV === 'production' ? configureStoreProd() : configureStoreDev()\n  return {\n    store,\n    persistor: persistStore(store)\n  }\n}\n","import React from 'react'\nimport { PersistGate } from 'redux-persist/integration/react'\nimport { Provider } from 'react-redux'\nimport storeConfig from './storeConfig'\nimport Loading from '../components/auth/Loading'\n/**\n * In this example, 'store' is the configured Redux store and\n *'persist' is a function that returns a Promise to rehydrate the\n * Redux store using redux-persist\n *\n * FROM: https://medium.com/hexient-labs/redux-store-provider-hoc-3495281905c\n */\nconst withReduxProvider = BaseComponent => (props) => {\n  const { store, persistor } = storeConfig()\n  // console.log('withReduxProvider', { props, store, persistor })\n  return (\n    <Provider store={store}>\n      <PersistGate loading={<Loading />} persistor={persistor}>\n        <BaseComponent {...props} />\n      </PersistGate>\n    </Provider>\n  )\n}\n\nexport default withReduxProvider\n","import React from 'react'\nimport classNames from 'classnames'\nimport PropTypes from 'prop-types'\nimport Paper from '@material-ui/core/Paper'\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport LinearProgress from '@material-ui/core/LinearProgress'\nimport Typography from '@material-ui/core/Typography'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n    background: 'black',\n    color: theme.palette.primary.contrastText,\n    padding: theme.spacing(1) * 2\n  },\n  message: {\n    // width: '100%'\n  },\n  msgText: {\n    display: 'flex'\n  },\n  spacer: {\n    flexGrow: 1\n  },\n  messageInner: {\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst UploadControlUnstyled = ({ className, text, progress }) => {\n  const classes = useStyles()\n  if (!text) return null\n  const message = `Uploading: ${text}`\n  return (\n    <div className={classNames(classes.root, className)}>\n      <div className={classes.messageInner}>\n        <div className={classes.msgText}>\n          <Typography color='inherit'>{message}</Typography>\n          <div className={classes.spacer} />\n          <Typography color='inherit'>{progress}%</Typography>\n        </div>\n        <LinearProgress color='secondary' variant='determinate' value={progress} />\n      </div>\n    </div>\n  )\n}\n\nUploadControlUnstyled.propTypes = {\n  className: PropTypes.string,\n  text: PropTypes.string,\n  progress: PropTypes.number\n}\n\nconst UploadControl = UploadControlUnstyled\nexport default UploadControl\n\nexport const UploadControlCOSMOSWrapper = ({ text, progress }) => {\n  // const [someStateItem, setSomeStateItem] = useState()\n  const classes = useWrapperStyles()\n  return (\n    <div className={classes.root}>\n      <CssBaseline /> {/* You only need this in a root element. Don't put it anywhere else in the dom */}\n      <Paper className={classes.paper}>\n        <Typography variant='h5'>\n          This is a dummy component.\n        </Typography>\n      </Paper>\n      <UploadControl text={text} progress={progress} />\n    </div>\n  )\n}\n\nUploadControlCOSMOSWrapper.propTypes = {\n  text: PropTypes.string,\n  progress: PropTypes.number\n}\nconst wrapperStyle = theme => ({\n  root: {\n    height: '100%',\n    display: 'flex',\n    flexDirection: 'column'\n  },\n  paper: {\n    flexGrow: 1\n  }\n})\n\nconst useWrapperStyles = makeStyles(wrapperStyle)\n\nUploadControlCOSMOSWrapper.displayName = UploadControl.displayName\nexport const UploadControlTest = UploadControlCOSMOSWrapper\n","import axios from 'axios'\nimport FormData from 'form-data'\n\n/**\n * DEbuggers for AXIOS\n */\naxios.interceptors.request.use(\n  request => {\n    console.log('AXIOS:::: Starting Request', request)\n    return request\n  },\n  err => {\n    console.log('AXIOS:::: Starting Request ERROR', err)\n    return Promise.reject(err)\n  }\n)\n\naxios.interceptors.response.use(\n  response => {\n    console.log('AXIOS:::: Response', response)\n    return response\n  },\n  err => {\n    console.log('AXIOS:::: Starting Response ERROR', err)\n    return Promise.reject(err)\n  }\n)\n\nexport default async function doUpload (activeUpload, updateUploadProgress, completeActiveUpload) {\n  console.log('UploadConntect: upload start', activeUpload)\n\n  // Initialising the HTML POST form for posting to S3 directly\n  let formData = new FormData()\n  // Take the auth credentials that we got from the backend and add them to our S3 POST\n  Object.keys(activeUpload.preAuth.fields).forEach(fieldkey => {\n    console.log('APPEND', fieldkey, activeUpload.preAuth.fields[fieldkey])\n    formData.append(fieldkey, activeUpload.preAuth.fields[fieldkey])\n  })\n  const file = dataURLtoFile(activeUpload.base64, 'a.png')\n  formData.append('file', file)\n\n  const config = {\n    headers: {\n      'Content-Type': 'multipart/form-data'\n    },\n    onUploadProgress: progressEvent => {\n      const { loaded, total } = progressEvent\n      // Do something with the progress details\n      console.log('PROGRESSEVENT', loaded, total, Math.floor(100 * loaded / total))\n      updateUploadProgress({ progress: Math.floor(100 * loaded / total) })\n    }\n  }\n\n  console.log('FORMDATA', formData)\n  // Upload file to S3\n  await axios.post(\n    activeUpload.preAuth.url,\n    formData,\n    config\n  ).catch(err => {\n    console.error(err)\n    console.log(err.stack)\n  })\n  console.log('UploadConntect: upload done')\n  completeActiveUpload()\n}\n\nfunction dataURLtoFile (dataurl, filename) {\n  var arr = dataurl.split(','); var mime = arr[0].match(/:(.*?);/)[1]\n\n  var bstr = atob(arr[1]); var n = bstr.length; var u8arr = new Uint8Array(n)\n  while (n--) {\n    u8arr[n] = bstr.charCodeAt(n)\n  }\n  return new File([u8arr], filename, { type: mime })\n}\n","import React, { useRef, useEffect } from 'react'\nimport PropTypes from 'prop-types'\nimport { connect } from 'react-redux'\nimport actions from '../redux/actions'\nimport UploadControl from '../components/UploadControl'\nimport s3Upload from '../lib/s3upload'\n\nconst UploadConntect = ({\n  activeUpload,\n  completeActiveUpload,\n  updateUploadProgress,\n  ...props\n}) => {\n  const uploadingRef = useRef()\n  useEffect(() => {\n    uploadingRef.current = uploadingRef.current && !!activeUpload\n\n    if (activeUpload && !uploadingRef.current) {\n      s3Upload(activeUpload, updateUploadProgress, completeActiveUpload)\n    }\n  }, [Boolean(activeUpload)])\n\n  if (!activeUpload) return null\n  return <UploadControl text={'Uploading thing'} progress={activeUpload.progress || 0} {...props} />\n}\nUploadConntect.propTypes = {\n  // All from redux\n  activeUpload: PropTypes.object,\n  completeActiveUpload: PropTypes.func.isRequired,\n  updateUploadProgress: PropTypes.func.isRequired\n}\n\n/**\n * Map our redux state and functions\n */\nconst mapStateToProps = (state, props) => {\n  const { activeUpload } = state.uploader\n  return { activeUpload }\n}\n\nconst mapDispatchToProps = dispatch => ({\n  completeActiveUpload: () => {\n    dispatch(actions.completeActiveUpload())\n  },\n  updateUploadProgress: (newProgress) => {\n    dispatch(actions.updateUploadProgress(newProgress))\n  }\n})\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(UploadConntect)\n","/**\n * Valid Roles are: admin, user, nonuser\n *\n * Valid Resources are: series, series_public, series_open, photo\n *\n * For more see:\n * https://docs.google.com/spreadsheets/d/1oXsZrsuyOSFs_tufRluSjQiR6OSTObWiGsKDUKb5vLk/edit#gid=0\n *\n * RTFM:\n * https://onury.io/accesscontrol/?content=guide#resources-and-resource-attributes\n */\nexport default {\n  // Admin is god. Be careful who you give this to.\n  admin: {\n    series: {\n      'create:own': ['*'],\n      'read:any': ['*'],\n      'update:any': ['*'],\n      'delete:any': ['*']\n    },\n    photo: {\n      'create:any': ['*'],\n      'read:any': ['*'],\n      'update:any': ['*'],\n      'delete:any': ['*']\n    }\n  },\n  // Logged out users can see public stuff but nothing esle\n  nonuser: {\n    photo: {\n      'read:any': ['*'],\n      'update:any': ['*'],\n      'delete:any': ['*']\n    },\n    series_public: {\n      'read:any': ['*']\n    },\n    series_open: {\n      'read:any': ['*']\n    }\n  },\n  // Users are the key permissions role in V0\n  // Note: we could inherit from user but we keep it explicit for now\n  user: {\n    series: {\n      'create:own': ['*'],\n      'read:own': ['*'],\n      'update:own': ['*'],\n      'delete:own': ['*']\n    },\n    series_public: {\n      'read:any': ['*']\n    },\n    series_open: {\n      'read:any': ['*'],\n      'update:any': ['photos']\n    },\n    photo: {\n      'read:any': ['*'],\n      'create:own': ['*'],\n      'update:own': ['*'],\n      'delete:own': ['*']\n    }\n  }\n}\n","import React, { useState, useLayoutEffect, useContext } from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport Dialog from '@material-ui/core/Dialog'\n// import MenuIcon from '@material-ui/icons/Menu'\nimport QRCode from 'qrcode'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { Paper } from '@material-ui/core'\nimport { SeriesContext } from '../contexts'\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n  },\n  title: {\n    textAlign: 'center'\n  },\n  qrPaper: {\n    padding: theme.spacing(2)\n  },\n  qrCode: {\n    width: '100%',\n    height: 400\n  }\n}))\n\nconst QRDisplay = ({ onClose, open }) => {\n  const classes = useStyles()\n  const { series } = useContext(SeriesContext)\n  const [qrCodeEl, setQRCodeEl] = useState(null)\n  const obj = { type: 'series', id: series.id }\n  const encodedId = encodeURI(JSON.stringify(obj))\n  const url = `${process.env.PUBLIC_URL}/?fromqr=${encodedId}`\n\n  useLayoutEffect(() => {\n    QRCode.toString(url, (err, svgStr) => {\n      if (err) console.error(err)\n      else setQRCodeEl(svgStr)\n    })\n  }, [series])\n\n  return (\n    <Dialog\n      open={open}\n      onClose={onClose}\n      className={classes.root\n      }>\n      <Paper className={classes.qrPaper}>\n        <Typography variant='subtitle1' component='div' className={classes.title}>{series.name}</Typography>\n        <svg className={classes.qrCode} dangerouslySetInnerHTML={{ __html: qrCodeEl }} />\n        {series.coords && <Typography component='div' className={classes.title}>[ {series.coords[0]}, {series.coords[1]} ]</Typography>}\n      </Paper>\n    </Dialog>\n  )\n}\n\nQRDisplay.propTypes = {\n  onClose: PropTypes.func.isRequired,\n  open: PropTypes.bool\n}\n\nexport default QRDisplay\n","import React from 'react'\nimport createSvgIcon from '@material-ui/icons/utils/createSvgIcon'\n\nexport default createSvgIcon(\n  <React.Fragment>\n    <path d='M22,2l0,20l-20,0l0,-20l20,0Zm-2,2l-16,0l0,16l16,0l0,-16Z' />\n    <rect x='5' y='5' width='4' height='4' />\n    <rect x='15' y='5' width='4' height='4' />\n    <rect x='5' y='15' width='4' height='4' />\n    <rect x='10' y='10' width='1' height='5' />\n    <rect x='11' y='10' width='6' height='2' />\n    <rect x='11' y='12' width='2' height='2' />\n    <rect x='13' y='7' width='1' height='2' />\n    <rect x='14' y='9' width='1' height='1' />\n    <rect x='8' y='10' width='1' height='4' />\n    <rect x='7' y='11' width='1' height='3' />\n    <rect x='9' y='11' width='1' height='1' />\n    <rect x='10' y='6' width='2' height='3' />\n    <rect x='12' y='7' width='1' height='1' />\n    <rect x='15' y='14' width='2' height='4' />\n    <rect x='14' y='14' width='1' height='1' />\n    <rect x='17' y='15' width='2' height='2' />\n    <rect x='11' y='16' width='1' height='3' />\n    <rect x='12' y='15' width='2' height='2' />\n    <rect x='10' y='18' width='1' height='1' />\n  </React.Fragment>, 'QRCode')\n","import React, { useState, useRef } from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport SpeedDial from '@material-ui/lab/SpeedDial'\nimport SpeedDialAction from '@material-ui/lab/SpeedDialAction'\nimport { fade } from '@material-ui/core/styles/colorManipulator'\n\n// import useNewImageMenu from '../PhotoSeries/views/controls/useNewImageMenu'\nimport AddCameraIcon from '@material-ui/icons/AddAPhoto'\nimport PhotoLibraryIcon from '@material-ui/icons/PhotoLibrary'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst useStyles = makeStyles(theme => {\n  const pulseCol = fade(theme.palette.secondary.light, 0.4)\n  return {\n    root: {\n    },\n    speedDialFab: {\n      background: theme.palette.secondary.main,\n      color: theme.palette.secondary.contrastText,\n      '&::before': {\n        content: '\"  \"',\n        display: 'block',\n        position: 'absolute',\n        width: '100%',\n        height: '100%',\n        borderRadius: 'inherit',\n        boxShadow: `0 0 0 0 ${pulseCol}`,\n        animation: '$fabPulse 4s',\n        animationIterationCount: 5,\n        animationTimingFunction: 'linear'\n      }\n    },\n    '@keyframes fabPulse': {\n      '0%': {\n        boxShadow: `0 0 0 0px ${pulseCol}`\n      },\n      '90%': {\n        boxShadow: `0 0 0 0px ${pulseCol}`\n      },\n      '100%': {\n        boxShadow: `0 0 0 10px transparent`\n      }\n    },\n    directionUp: {\n    },\n    actionsClosed: {\n      display: 'none'\n    }\n  }\n})\n\nconst AddFab = ({ className, children, onCameraClick, onLibraryClick }) => {\n  const [open, setOpen] = useState(false)\n  const [down, setDown] = useState(false)\n  const classes = useStyles()\n  // const theme = useTheme()\n  const downRef = useRef(down)\n  downRef.current = down\n\n  const startTimer = (el) => {\n    setDown(true)\n    if (!open) {\n      setTimeout(() => {\n        if (downRef.current) setOpen(true)\n      }, 300)\n    }\n  }\n\n  // const onUp = (e) => {\n  //   // console.log('onUp', e.currentTarget)\n  //   // setSeries(series)\n  //   setDown(false)\n  //   setOpen(false)\n  //   // onCameraClick()\n  // }\n\n  const onDown = (e) => {\n    // console.log('onDown', e.currentTarget)\n    // setSeries(series)\n    startTimer(e.currentTarget)\n  }\n\n  const block = (e) => {\n    if (e && e.stopPropagation) {\n      e.stopPropagation()\n      e.preventDefault()\n    }\n  }\n\n  return (\n    <div className={classNames(classes.rootContainer, className)}>\n      <SpeedDial\n        ariaLabel='SpeedDial photo adder'\n        onBlur={(e) => {\n          setTimeout(() => setOpen(false), 250)\n        }}\n        classes={{\n          directionUp: classes.directionUp,\n          actionsClosed: classes.actionsClosed,\n          root: classes.root,\n          fab: classNames(classes.speedDialFab, 'fabanimation')\n        }}\n        icon={children}\n        onClick={(e) => {\n          block(e)\n          setDown(false)\n          if (!open) {\n            console.log('cameraclick MAIN')\n            onCameraClick()\n          }\n        }}\n        onMouseDown={onDown}\n        // onMouseUp={onUp}\n        onTouchStart={onDown}\n        // onTouchEnd={onUp}\n\n        open={open}\n        direction='up'\n      >\n        <SpeedDialAction\n        // Bit of a hack here. This function isn't quite ready for primetime\n          icon={<AddCameraIcon className={classes.speedDialIcon} />}\n          tooltipPlacement='right'\n          tooltipTitle='From Camera'\n          tooltipOpen\n          onClick={(e) => {\n            console.log('cameraclick')\n            setOpen(false)\n            setDown(false)\n            onCameraClick()\n            block(e)\n          }}\n        />\n        <SpeedDialAction\n        // Bit of a hack here. This function isn't quite ready for primetime\n          icon={<PhotoLibraryIcon className={classes.speedDialIcon} />}\n          tooltipPlacement='right'\n          tooltipTitle='From Photo Library'\n          tooltipOpen\n          onClick={(e) => {\n            console.log('libraryClick')\n            setOpen(false)\n            setDown(false)\n            onLibraryClick()\n            block(e)\n          }}\n        />\n      </SpeedDial>\n    </div>\n\n  )\n}\n\nAddFab.propTypes = {\n  className: PropTypes.string,\n  children: PropTypes.any,\n  onCameraClick: PropTypes.func.isRequired,\n  onLibraryClick: PropTypes.func.isRequired\n}\n\nexport default AddFab\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Menu from '@material-ui/core/Menu'\nimport MenuItem from '@material-ui/core/MenuItem'\nimport ListItemIcon from '@material-ui/core/ListItemIcon'\nimport ListItemText from '@material-ui/core/ListItemText'\nimport Divider from '@material-ui/core/Divider'\n\n// import { Menu as MenuIcon } from '@material-ui/icons'\n\nconst ContextMenu = ({ anchorEl, onClose, menuItems }) => {\n  return (\n    <Menu\n      anchorEl={anchorEl}\n      open={!!anchorEl}\n      onClose={onClose}\n    >\n      {menuItems.map(({ icon, color, text, hide, disabled, action, divider }, idx) => {\n        const Icon = icon || null\n        if (hide) return null\n        if (divider) return <Divider key={`contextMenu-${idx}`} />\n        return (\n          <MenuItem\n            key={`contextMenu-${idx}`}\n            disabled={disabled}\n            onClick={() => {\n              onClose()\n              action()\n            }}>\n            {Icon && (\n              <ListItemIcon>\n                <Icon color={disabled ? 'disabled' : color} />\n              </ListItemIcon>\n            )}\n            <ListItemText primary={text} primaryTypographyProps={{ color }} />\n          </MenuItem>\n        )\n      })}\n    </Menu>\n  )\n}\n\nContextMenu.propTypes = {\n  anchorEl: PropTypes.object,\n  onClose: PropTypes.func,\n  menuItems: PropTypes.arrayOf(PropTypes.shape({\n    text: PropTypes.string,\n    icon: PropTypes.any,\n    divider: PropTypes.any,\n    hide: PropTypes.bool,\n    disabled: PropTypes.bool,\n    color: PropTypes.string,\n    action: PropTypes.func\n  }))\n}\n\nexport default ContextMenu\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\n\nimport Divider from '@material-ui/core/Divider'\nimport List from '@material-ui/core/List'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemText from '@material-ui/core/ListItemText'\nimport Typography from '@material-ui/core/Typography'\nimport FormLabel from '@material-ui/core/FormLabel'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport TagChip from '../tags/TagChip'\nimport style from './SeriesInfo.style'\n\nimport ShortLongText from '../controls/ShortLongText'\nimport BigText from '../dialogs/BigText'\nimport { formatDate } from '../../../../lib/datelib'\nimport SeriesConfigClass from '../../../../lib/SeriesConfig'\n\nconst DIALOGS = {\n  NOTEVIEW: 'NOTEVIEW'\n}\nconst useStyles = makeStyles(style)\n\nconst SeriesInfo = ({ seriesConfig, series }) => {\n  const classes = useStyles()\n  const seriesConfigInst = new SeriesConfigClass(seriesConfig)\n  const [activeDialog, setActiveDialog] = useState(null)\n  const newTags = series.photos.reduce((acc, { tags }) => {\n    tags.forEach(tag => {\n      if (!acc[tag.typeId]) {\n        acc[tag.typeId] = {\n          [tag.label]: { ...tag, count: 1 }\n        }\n      }\n      else if (acc[tag.typeId][tag.label]) {\n        const existing = acc[tag.typeId][tag.label]\n        acc[tag.typeId][tag.label] = { ...existing, count: existing.count + 1 }\n      }\n      else acc[tag.typeId][tag.label] = { ...tag, count: 1 }\n    })\n    return acc\n  }, {})\n\n  let metaKeys = []\n  try {\n    metaKeys = series.meta ? Object.keys(JSON.parse(series.meta)) : []\n  }\n  catch (e) {\n    console.error(e)\n  }\n\n  return (\n    <div className={classes.root}>\n      <div className={classes.field}>\n        <FormLabel className={classes.formLabel}>\n      Series Name\n        </FormLabel>\n        <Typography variant='body1' color='inherit'>\n          {series.name}\n        </Typography>\n      </div>\n      {series.note && (\n        <ShortLongText\n          label='Series Note'\n          text={series.note}\n          onClick={() => setActiveDialog(DIALOGS.NOTEVIEW)}\n        />\n      )}\n\n      <Typography className={classes.heading} variant='subtitle1'>Series Summary</Typography>\n      <Divider />\n      <List className={classes.list}>\n        <ListItem disableGutters>\n          <ListItemText\n            primary={`Photos: ${series.photos.length}`}\n            secondary={series.photos.length > 0 && (\n              <span>\n             First: {formatDate(series.photos[series.photos.length - 1].takenOn, 'lll')}\n                <br />\n             Latest: {formatDate(series.photos[0].takenOn, 'lll')}\n              </span>\n            )}\n          />\n        </ListItem>\n\n        <ListItem disableGutters>\n          <ListItemText>\n            <FormLabel className={classes.formLabel}>\n              Tags in use (across all photos)\n            </FormLabel>\n            <Divider />\n            {Object.keys(newTags).length === 0 && (\n              <Typography variant='caption'>No photos in this series have tags</Typography>\n            )}\n            {Object.keys(newTags).map((tagKey, idtk) => (\n              <div key={`tagchipkey${idtk}`} className={classes.tagListItem}>\n                <Typography className={classes.subheading} variant='overline'>{seriesConfigInst.getTagType(tagKey).label}</Typography>\n                <Divider />\n                {Object.values(newTags[tagKey]).length > 0\n                  ? (\n                    Object.values(newTags[tagKey]).map((tag, idx) => (\n                      <TagChip\n                        key={`tagchip-${idtk}-${idx}`}\n                        tag={tag}\n                        color={seriesConfigInst.getTagType(tagKey).color}\n                      />\n                    ))\n                  )\n                  : (\n                    <Typography variant='caption'>No photos in this series have tags</Typography>\n                  )\n                }\n              </div>\n            ))}\n          </ListItemText>\n        </ListItem>\n\n      </List>\n\n      {metaKeys.length > 0 && Object.keys(seriesConfig.meta).length > 0 && (\n        <React.Fragment>\n          <FormLabel className={classes.formLabel}>\n            Metadata\n          </FormLabel>\n          <Divider />\n          <List className={classes.list}>\n            {metaKeys.map((key, idx) => seriesConfig.meta[key] ? (\n              <ListItem key={`metadata${idx}`}>\n                <ListItemText\n                  primary={seriesConfig.meta[key].label}\n                  secondary={seriesConfig.meta[key].render(series.meta[key])}\n                />\n              </ListItem>\n            ) : null\n            )}\n          </List>\n        </React.Fragment>\n      )}\n      {activeDialog === DIALOGS.NOTEVIEW && (\n        <BigText\n          open\n          multiline\n          onClose={() => setActiveDialog(null)}\n          title='Series Note'\n          body={series.note}\n        />\n      )}\n    </div>\n  )\n}\n\nSeriesInfo.propTypes = {\n  seriesConfig: PropTypes.object.isRequired,\n  series: PropTypes.object.isRequired\n}\n\nexport default SeriesInfo\n","export default theme => ({\n  root: {\n    margin: theme.spacing(1),\n    backgroundColor: theme.palette.background.paper,\n    paddingBottom: 60 // a little extra room for the FAB\n\n  },\n  field: {\n    marginBottom: theme.spacing(1)\n  },\n  list: {\n    padding: theme.spacing(1)\n  },\n  heading: {\n    marginTop: theme.spacing(1)\n  },\n  tagListItem: {\n    marginTop: theme.spacing(1),\n    marginBottom: theme.spacing(2)\n  },\n  chip: {\n    margin: theme.spacing(0.5)\n  }\n})\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\n\nimport MobileStepper from '@material-ui/core/MobileStepper'\nimport IconButton from '@material-ui/core/IconButton'\nimport GridListTileBar from '@material-ui/core/GridListTileBar'\nimport Badge from '@material-ui/core/Badge'\n\nimport LabelIcon from '@material-ui/icons/Label'\n// import RemoveRedEye from '@material-ui/icons/RemoveRedEye'\nimport KeyboardArrowLeft from '@material-ui/icons/KeyboardArrowLeft'\nimport KeyboardArrowRight from '@material-ui/icons/KeyboardArrowRight'\n\nimport SwipeableViews from 'react-swipeable-views'\nimport Photo from './Photo'\nimport { formatDate } from '../../../../lib/datelib'\nimport { makeStyles, useTheme } from '@material-ui/core/styles'\nimport style from './SwipeShow.style'\n\nconst useStyles = makeStyles(style)\n\nconst SwipeShow = ({ photos, initialPhoto, onImageSelect }) => {\n  const classes = useStyles()\n  const theme = useTheme()\n  const initPhotoIndex = initialPhoto ? photos.findIndex(p => p.id === initialPhoto) || 0 : 0\n  const [activePhoto, setActivePhoto] = useState(initPhotoIndex >= 0 ? initPhotoIndex : 0)\n  const [showTags, setShowTags] = useState(false)\n  const singular = photos.length < 2\n\n  const sortedPhotos = [...photos]\n  sortedPhotos.sort((a, b) => parseInt(b.takenOn, 10) - parseInt(a.takenOn, 10))\n\n  const handleForward = () => setActivePhoto(activePhoto >= sortedPhotos.length ? 0 : activePhoto + 1)\n  const handleBack = () => setActivePhoto(activePhoto <= 0 ? sortedPhotos.length - 1 : activePhoto - 1)\n\n  return (\n    <div className={classes.root}>\n      <div className={classes.inner}>\n        <SwipeableViews\n          axis={theme.direction === 'rtl' ? 'x-reverse' : 'x'}\n          index={activePhoto}\n          onChangeIndex={(val) => setActivePhoto(val)}\n          enableMouseEvents\n        >\n          {sortedPhotos.map((photo, idx) => (\n            <div className={classes.photoWrapper} key={`swipeshowpic-${idx}`} onClick={() => onImageSelect(sortedPhotos[activePhoto].id)}>\n              <Photo photo={photo} className={classes.photo} showTags={showTags} />\n            </div>\n          ))}\n        </SwipeableViews>\n        <IconButton size='small' className={classes.manualBack} onClick={handleBack} color='inherit' disabled={activePhoto === 0}>\n          {theme.direction === 'rtl' ? <KeyboardArrowRight /> : <KeyboardArrowLeft />}\n        </IconButton>\n        <IconButton size='small' className={classes.manualForward} onClick={handleForward} color='inherit' disabled={activePhoto === photos.length - 1}>\n          {theme.direction === 'rtl' ? <KeyboardArrowLeft /> : <KeyboardArrowRight />}\n        </IconButton>\n        <GridListTileBar\n          title={singular ? 'Photo' : `Photo (${activePhoto + 1}/${sortedPhotos.length})`}\n          subtitle={sortedPhotos.length > 0 && (\n            <span>{formatDate(sortedPhotos[activePhoto].takenOn)}</span>\n          )}\n          actionIcon={\n            <React.Fragment>\n              <IconButton className={classes.tagButton} onClick={() => setShowTags(!showTags)}>\n                <Badge color={showTags ? 'primary' : 'secondary'} badgeContent={sortedPhotos[activePhoto].tags ? sortedPhotos[activePhoto].tags.filter(tag => tag.coords).length : null}>\n                  <LabelIcon />\n                </Badge>\n              </IconButton>\n            </React.Fragment>\n          }\n        />\n      </div>\n      {!singular &&\n      <MobileStepper\n        steps={sortedPhotos.length}\n        position='static'\n        activeStep={activePhoto}\n        classes={{\n          root: classes.mobileStepper,\n          dots: classes.dots\n        }}\n      />\n      }\n    </div>\n  )\n}\n\nSwipeShow.propTypes = {\n  // This is just the basic shape of the photo object\n  initialPhoto: PropTypes.string,\n  photos: PropTypes.arrayOf(PropTypes.shape({\n    img: PropTypes.string,\n    tags: PropTypes.array,\n    date: PropTypes.date\n  })),\n  transition: PropTypes.number,\n  onImageSelect: PropTypes.func.isRequired\n}\n\nSwipeShow.defaultProps = {\n  transition: 5000,\n  isFullScreen: false,\n  slides: []\n}\n\nexport default SwipeShow\n","export default theme => ({\n  root: {\n    position: 'relative'\n  },\n  inner: {\n    position: 'relative'\n  },\n  photoWrapper: {\n    minHeight: 250,\n    height: 250\n  },\n  dateCaption: {\n    padding: theme.spacing(1),\n    background: theme.palette.primary.dark,\n    color: theme.palette.primary.contrastText,\n    textAlign: 'center'\n  },\n  mobileStepper: {\n    // position: 'absolute',\n    // bottom: theme.spacing(1),\n    // right: theme.spacing(1)\n  },\n  manualBack: {\n    color: 'white',\n    zIndex: 10,\n    position: 'absolute',\n    transform: 'translateY(-50%)',\n    left: 0,\n    top: '50%'\n  },\n  manualForward: {\n    color: 'white',\n    zIndex: 10,\n    position: 'absolute',\n    transform: 'translateY(-50%)',\n    right: 0,\n    top: '50%'\n  },\n  tagButton: {\n    color: 'rgba(255, 255, 255, 0.54)'\n  },\n  slideshowButton: {\n    color: 'rgba(255, 255, 255, 0.54)'\n  },\n  dots: {\n    margin: '0 auto'\n  }\n})\n","export default theme => ({\n  root: {\n    display: 'flex',\n    height: '100%',\n    flexDirection: 'column',\n    overflow: 'hidden'\n  },\n  appBar: {\n    flexGrow: 0\n  },\n  inner: {\n    position: 'relative',\n    flexGrow: 1,\n    overflowY: 'scroll',\n    '-webkit-overflow-scrolling': 'touch'\n  },\n  tabMenu: {\n    marginTop: theme.spacing(7)\n  },\n  mapWrap: {\n    position: 'absolute',\n    height: '100%',\n    width: '100%',\n    top: 0,\n    left: 0\n  },\n  toolbarTitle: {\n    flexGrow: 1,\n    textOverflow: 'ellipsis',\n    whiteSpace: 'nowrap',\n    overflow: 'hidden'\n  },\n  AddFab: {\n    position: 'absolute',\n    bottom: theme.spacing(2),\n    right: theme.spacing(2),\n    // left: '50%',\n    // transformOrigin: '0% 50%',\n    // transform: 'translateY(-25%) translateX(-50%)',\n    zIndex: 3000\n  },\n  grow: {\n    flexGrow: 1\n  },\n  gridList: {\n    flexWrap: 'nowrap',\n    // Promote the list into his own layer on Chrome. This cost memory but helps keeping high FPS.\n    transform: 'translateZ(0)'\n  },\n  titleBar: {\n    display: 'flex',\n    padding: theme.spacing(1)\n  },\n  menuButton: {\n    // marginLeft: -12,\n    // marginRight: 20\n  },\n  placeholderInner: {\n    position: 'relative',\n    flexGrow: 1,\n    overflow: 'hidden',\n    textAlign: 'center',\n    display: 'flex',\n    height: '100%',\n    flexDirection: 'column'\n  },\n  progressWrapper: {\n    textAlign: 'center',\n    marginBottom: theme.spacing(4)\n  },\n  placeholderText: {\n    opacity: 0.4\n  },\n  placeholder: {\n\n  },\n  progress: {\n    color: theme.palette.grey[300]\n  }\n})\n","import React, { useState, useContext } from 'react'\nimport PropTypes from 'prop-types'\n\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport AppBar from '@material-ui/core/AppBar'\nimport Toolbar from '@material-ui/core/Toolbar'\nimport IconButton from '@material-ui/core/IconButton'\nimport Typography from '@material-ui/core/Typography'\nimport Tabs from '@material-ui/core/Tabs'\nimport Tab from '@material-ui/core/Tab'\n\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack'\n\nimport AddCameraIcon from '@material-ui/icons/AddAPhoto'\nimport MoreIcon from '@material-ui/icons/MoreVert'\n\nimport AddAlertIcon from '@material-ui/icons/AddAlert'\nimport SlideshowIcon from '@material-ui/icons/Slideshow'\nimport EditIcon from '@material-ui/icons/Edit'\nimport DeleteIcon from '@material-ui/icons/Delete'\n\nimport QRDisplay from './QRDisplay'\nimport QRCodeIcon from '../../../icons/QRCode'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport MapDot from '../../maps/MapDot'\nimport AddFab from './controls/AddFab'\n\nimport ContextMenu from './controls/ContextMenu'\n\nimport SeriesInfo from './subViews/SeriesInfo'\nimport SwipeShow from './subViews/SwipeShow'\nimport PhotoGrid from './subViews/PhotoGrid'\n\nimport DeleteDialog from './dialogs/DeleteDialog'\n\nimport { SeriesContext } from '../contexts'\n\nimport style from './SeriesView.style'\nconst useStyles = makeStyles(style)\n\nconst SeriesView = ({\n  onSlideshowStart, onChange,\n  onEditSeries, onDeletePhotos, onCameraAdd,\n  onDeleteSeries, onLibraryAdd, onTileClick, onMenuBack,\n  onWatch, onUnWatch, initialPhoto,\n  watching, owned\n}) => {\n  const classes = useStyles()\n  const [contextEl, setContextEl] = useState()\n  const [showQR, setShowQR] = useState(false)\n  const [deleteConfirm, setDeleteConfirm] = useState(false)\n\n  const { series, seriesConfig, ac } = useContext(SeriesContext)\n\n  const onDeleteConfirm = (confirmation) => {\n    setDeleteConfirm(false)\n    if (confirmation === true) onDeleteSeries(series.id)\n  }\n\n  const viewport = { zoom: 16 }\n  if (series && series.coords && series.coords.length === 2) {\n    viewport.longitude = series.coords[0]\n    viewport.latitude = series.coords[1]\n  }\n\n  const can = {\n    update: ac.canUser('update', series, 'series', '*'),\n    delete: ac.canUser('delete', series, 'series', '*'),\n    contribute: ac.canUser('update', series, 'series', ['photos'])\n  }\n\n  const [listTypeTab, setListTypeTab] = useState(0)\n  return (\n    <div className={classes.root}>\n      <CssBaseline />\n      <AppBar position='static' className={classes.appBar}>\n        <Toolbar disableGutters>\n          <IconButton className={classes.menuButton} color='inherit' onClick={onMenuBack} aria-label='Menu'>\n            <ArrowBackIcon />\n          </IconButton>\n          <Typography variant='subtitle1' color='inherit' className={classes.toolbarTitle}>\n            {series.name || 'Series'}\n          </Typography>\n\n          {/* <IconButton className={classes.menuButton} color='inherit' onClick={onSlideshowStart} aria-label='Menu'>\n            <SlideshowIcon />\n          </IconButton> */}\n          <IconButton\n            aria-haspopup='true'\n            color='inherit'\n            onClick={event => setContextEl(event.currentTarget)}\n          >\n            <MoreIcon />\n          </IconButton>\n\n          <ContextMenu anchorEl={contextEl} onClose={() => setContextEl(null)} menuItems={[\n            {\n              text: 'Watch Series',\n              icon: AddAlertIcon,\n              hide: !onWatch || owned || watching,\n              action: onWatch\n            },\n            {\n              text: 'Unwatch Series',\n              icon: AddAlertIcon,\n              hide: !onUnWatch || owned || !watching,\n              action: onUnWatch\n            },\n            {\n              text: 'Series QR Code',\n              icon: QRCodeIcon,\n              action: () => setShowQR(true)\n            },\n            {\n              text: 'Start Slideshow',\n              icon: SlideshowIcon,\n              hide: !onSlideshowStart,\n              action: onSlideshowStart\n            },\n            { divider: true },\n            {\n              text: 'Edit Series',\n              icon: EditIcon,\n              hide: !onEditSeries || !can.update,\n              action: onEditSeries\n            },\n            {\n              text: 'Delete Series',\n              icon: DeleteIcon,\n              hide: !setDeleteConfirm || !can.delete,\n              color: 'error',\n              action: () => setDeleteConfirm(true)\n            }\n          ]} />\n        </Toolbar>\n        <Tabs variant='fullWidth'\n          value={listTypeTab}\n          onChange={(e, value) => setListTypeTab(value)}\n        >\n          <Tab label='Info' />\n          <Tab label='Map' />\n          <Tab label='Photos' />\n        </Tabs>\n      </AppBar>\n\n      <div className={classes.inner}>\n        {listTypeTab === 0 && (\n          <React.Fragment>\n            {series.photos && series.photos.length > 0 && (\n              <SwipeShow\n                photos={series.photos}\n                initialPhoto={initialPhoto}\n                onImageSelect={onTileClick}\n              />\n            )}\n            <SeriesInfo series={series} seriesConfig={seriesConfig} onChange={onChange} />\n          </React.Fragment>\n        )}\n        {series.photos && listTypeTab === 2 && (\n          <PhotoGrid\n            photos={series.photos}\n            onTileClick={onTileClick}\n            onDelete={onDeletePhotos}\n          />\n        )}\n      </div>\n\n      {listTypeTab === 1 && (\n        <MapDot\n          showMe\n          longitude={series.longitude}\n          latitude={series.latitude}\n          viewport={viewport}\n          direction={series.direction}\n        />\n      )}\n\n      {listTypeTab === 0 && can.contribute && (\n        <AddFab\n          className={classes.AddFab}\n          onCameraClick={onCameraAdd}\n          onLibraryClick={onLibraryAdd}\n        >\n          <AddCameraIcon />\n        </AddFab>\n      )}\n      <QRDisplay open={showQR} onClose={() => setShowQR(false)} />\n      <DeleteDialog\n        open={deleteConfirm}\n        onConfirm={onDeleteConfirm}\n        title='Delete Series'\n        message='Are you sure you want to delete this series? The record and all images associated with it will be gone forever.'\n      />\n    </div>\n  )\n}\n\nSeriesView.propTypes = {\n  initialPhoto: PropTypes.string,\n  watching: PropTypes.bool,\n  owned: PropTypes.bool,\n  // Action functions\n  onSlideshowStart: PropTypes.func.isRequired,\n  onChange: PropTypes.func.isRequired,\n  onDeletePhotos: PropTypes.func.isRequired,\n  onDeleteSeries: PropTypes.func.isRequired,\n  onCameraAdd: PropTypes.func.isRequired,\n  onEditSeries: PropTypes.func.isRequired,\n  onLibraryAdd: PropTypes.func.isRequired,\n  onTileClick: PropTypes.func.isRequired,\n  onMenuBack: PropTypes.func.isRequired,\n  onWatch: PropTypes.func,\n  onUnWatch: PropTypes.func\n}\n\nexport default SeriesView\n","\nimport React, { useState, useContext } from 'react'\nimport PropTypes from 'prop-types'\n\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport DialogActions from '@material-ui/core/DialogActions'\nimport Button from '@material-ui/core/Button'\nimport Typography from '@material-ui/core/Typography'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport { SeriesContext } from '../contexts'\n\nimport style from './SeriesEdit.style'\nimport SeriesEditInner from './subViews/SeriesEditInner'\n\nconst useStyles = makeStyles(style)\n\nconst SeriesEdit = ({ onOk, onCancel }) => {\n  const classes = useStyles()\n  const { series } = useContext(SeriesContext)\n  const [delta, setDelta] = useState({})\n\n  return (\n    <Dialog\n      scroll='paper'\n      className={classes.root}\n      fullScreen\n      open\n      fullWidth\n      onClose={onCancel}\n    >\n      <CssBaseline />\n      <DialogTitle disableTypography className={classes.dlgTitle}>\n        <Typography variant='subtitle1' color='inherit' className={classes.grow}>\n           Edit Series Details\n        </Typography>\n      </DialogTitle>\n      <DialogContent className={classes.inner}>\n        <SeriesEditInner\n          series={series}\n          delta={delta}\n          onChange={setDelta}\n        />\n      </DialogContent>\n      <DialogActions>\n        <Button className={classes.menuButton} color='inherit' onClick={() => setDelta({})} aria-label='Menu'>\n            Reset\n        </Button>\n        <Button className={classes.menuButton} color='inherit' onClick={onCancel} aria-label='Menu'>\n            Cancel\n        </Button>\n        <Button className={classes.menuButton} color='inherit' onClick={() => onOk({ id: series.id, ...delta })} aria-label='Menu'>\n            Ok\n        </Button>\n      </DialogActions>\n    </Dialog>\n  )\n}\n\nSeriesEdit.propTypes = {\n  // now some functions\n  onOk: PropTypes.func.isRequired,\n  onCancel: PropTypes.func.isRequired\n}\n\nexport default SeriesEdit\n","export default theme => ({\n  root: {\n\n  },\n  inner: {\n    display: 'flex',\n    flexDirection: 'column'\n    // padding: theme.spacing(1)\n  },\n  dlgTitle: {\n    background: theme.palette.primary.main,\n    color: theme.palette.primary.contrastText\n  },\n  grow: {\n    flexGrow: 1\n  },\n  field: {\n    flexGrow: 0,\n    marginBottom: theme.spacing(2)\n  },\n  slider: {\n    paddingLeft: theme.spacing(1),\n    paddingRight: theme.spacing(1)\n  },\n  textField: {\n    marginLeft: theme.spacing(1),\n    marginRight: theme.spacing(1),\n    width: '100%'\n  },\n  formLabel: {\n    display: 'block',\n    marginTop: theme.spacing(1),\n    marginBottom: theme.spacing(1)\n  },\n  mapFormLabel: {\n    display: 'block',\n    marginTop: theme.spacing(1),\n    marginBottom: theme.spacing(1)\n  },\n  mapInnerWrap: {\n    flexGrow: 1\n  },\n  mapWrapper: {\n    flexGrow: 1,\n    display: 'flex',\n    flexDirection: 'column',\n    paddingBottom: theme.spacing(2)\n  },\n  formControl: {\n    margin: theme.spacing(1),\n    minWidth: 120\n  },\n  chips: {\n    display: 'flex',\n    flexWrap: 'wrap'\n  }\n})\n","import React, { useState, useEffect, useRef } from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\n\nimport Badge from '@material-ui/core/Badge'\nimport Typography from '@material-ui/core/Typography'\nimport IconButton from '@material-ui/core/IconButton'\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport GridListTile from '@material-ui/core/GridListTile'\nimport GridListTileBar from '@material-ui/core/GridListTileBar'\nimport MobileStepper from '@material-ui/core/MobileStepper'\nimport Button from '@material-ui/core/Button'\n\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack'\nimport LabelIcon from '@material-ui/icons/Label'\nimport PauseIcon from '@material-ui/icons/PauseCircleFilled'\nimport PlayIcon from '@material-ui/icons/PlayCircleFilled'\nimport KeyboardArrowLeft from '@material-ui/icons/KeyboardArrowLeft'\nimport KeyboardArrowRight from '@material-ui/icons/KeyboardArrowRight'\n\nimport { makeStyles, useTheme } from '@material-ui/core/styles'\n\nimport Photo from './subViews/Photo'\nimport { formatDate } from '../../../lib/datelib'\nimport useComponentSize from '../../../lib/useComponentSize'\n\nimport style from './Slideshow.style'\n\nconst useStyles = makeStyles(style)\n\nconst Slideshow = ({ onCancel, photos, transition }) => {\n  const classes = useStyles()\n  const theme = useTheme()\n  const { activeStep, lastStep, handleForward, handleBack, paused, pause, play } = useStepper(photos.length, transition)\n  const [showXYTags, setShowXYTags] = useState(false)\n\n  const refImgWrap = useRef(null)\n  const { size: { height, width } } = useComponentSize(refImgWrap)\n\n  return (\n    <div className={classes.root}>\n      <CssBaseline />\n      <div ref={refImgWrap} className={classes.slideContainer}>\n        {photos.map((slide, idx) => (\n          <GridListTile\n            key={`slide-${idx}`}\n            className={classNames(\n              classes.slide,\n              activeStep === idx && classes.active,\n              lastStep === idx && classes.last\n            )}\n            onClick={() => setShowXYTags(!showXYTags)}\n            style={{\n              height,\n              width,\n              transition: theme.transitions.create(['opacity'], { duration: 1 / 4 * transition })\n            }}\n          >\n            <Photo photo={slide} className={classes.photo} showTags={showXYTags} />\n            <Typography className={classes.labelBadge} >\n            Tags: {showXYTags ? 'On ' : 'Off '}\n              <Badge color='secondary' badgeContent={photos[activeStep].tags.filter(tag => tag.coords).length}>\n                <LabelIcon color='inherit' />\n              </Badge>\n            </Typography>\n\n            <GridListTileBar\n              className={classes.titleBar}\n              titlePosition='top'\n              title={(\n                <Typography color='inherit' variant='caption'>\n                  <IconButton className={classes.iconButton} onClick={(e) => onCancel()}>\n                    <ArrowBackIcon />\n                  </IconButton>\n                  {formatDate(slide.takenOn)}\n                </Typography>\n              )}\n              subtitle={<em>{paused ? 'Paused' : '    '}</em>}\n              actionIcon={paused ? (\n                <IconButton className={classes.iconButton} onClick={(e) => {\n                  e.preventDefault()\n                  e.stopPropagation()\n                  play()\n                }}>\n                  <PlayIcon />\n                </IconButton>\n              ) : (\n                <IconButton className={classes.iconButton} onClick={(e) => {\n                  e.preventDefault()\n                  e.stopPropagation()\n                  pause()\n                }}>\n                  <PauseIcon />\n                </IconButton>\n              )}\n            />\n          </GridListTile>\n        ))}\n        <IconButton size='small' className={classes.manualBack} onClick={handleBack} color='inherit'>\n          {theme.direction === 'rtl' ? <KeyboardArrowRight /> : <KeyboardArrowLeft />}\n        </IconButton>\n        <IconButton size='small' className={classes.manualForward} onClick={handleForward} color='inherit'>\n          {theme.direction === 'rtl' ? <KeyboardArrowLeft /> : <KeyboardArrowRight />}\n        </IconButton>\n      </div>\n\n      <MobileStepper\n        steps={photos.length}\n        position='static'\n        activeStep={activeStep}\n        classes={{\n          root: classes.mobileStepper,\n          dotActive: classes.dotActive\n        }}\n        nextButton={\n          <Button color='inherit' size='small' onClick={handleForward} disabled={activeStep === photos.length - 1}>\n            Next\n            {theme.direction === 'rtl' ? <KeyboardArrowLeft /> : <KeyboardArrowRight />}\n          </Button>\n        }\n        backButton={\n          <Button color='inherit' size='small' onClick={handleBack} disabled={activeStep === 0}>\n            {theme.direction === 'rtl' ? <KeyboardArrowRight /> : <KeyboardArrowLeft />}\n            Back\n          </Button>\n        }\n      />\n    </div>\n  )\n}\n\nSlideshow.propTypes = {\n  // We might want to go full screen\n  isFullScreen: PropTypes.bool,\n  // This is just the basic shape of the photo object\n  photos: PropTypes.array,\n  transition: PropTypes.number,\n  onCancel: PropTypes.func.isRequired\n}\n\nSlideshow.defaultProps = {\n  transition: 5000,\n  isFullScreen: false,\n  slides: []\n}\n\nexport default Slideshow\n\n/**\n * Custom React Hook for all our timer handling\n */\nconst useStepper = (num, interval) => {\n  const [activeStep, setActiveStep] = useState(0)\n  const [paused, setPaused] = useState(false)\n  const [lastStep, setLastStep] = useState(0)\n  const timerRef = useRef()\n\n  const handleForward = () => {\n    setLastStep(activeStep)\n    if (activeStep + 1 >= num) setActiveStep(0)\n    else setActiveStep(activeStep + 1)\n    if (!paused) {\n      destroyTimer()\n      createTimer()\n    }\n  }\n  const handleBack = () => {\n    setLastStep(activeStep)\n    if (activeStep - 1 < 0) setActiveStep(num - 1)\n    else setActiveStep(activeStep - 1)\n    if (!paused) {\n      destroyTimer()\n      createTimer()\n    }\n  }\n\n  const pause = () => {\n    destroyTimer()\n    setPaused(true)\n  }\n  const play = () => {\n    setPaused(false)\n    destroyTimer()\n    createTimer()\n  }\n\n  const createTimer = () => {\n    timerRef.current = window.setInterval(\n      // We need to use the alternate notation for the useState function\n      // because setInterval will only have access to the activeStep it was\n      // initialized with\n      () => setActiveStep(oldStep => {\n        setLastStep(oldStep)\n        return (oldStep + 1 >= num) ? 0 : oldStep + 1\n      })\n      , interval\n    )\n  }\n  const destroyTimer = () => {\n    if (timerRef.current) window.clearInterval(timerRef.current)\n  }\n\n  useEffect(() => {\n    createTimer()\n    return () => {\n      destroyTimer()\n    }\n  }, []) // Pass in empty array to run useEffect only on mount.\n\n  return { activeStep, lastStep, handleForward, handleBack, setActiveStep, paused, pause, play }\n}\n","export default theme => ({\n  root: {\n    // maxWidth: 400,\n    height: '100%',\n    display: 'flex',\n    flexDirection: 'column'\n  },\n  swipeAble: {\n    height: '100%'\n  },\n  slideContainer: {\n    flexGrow: 1\n  },\n  titleBar: {\n    padding: theme.spacing(0, 1),\n    height: '35px!important'\n  },\n  mobileStepper: {\n    flexGrow: 0,\n    background: theme.palette.grey[800],\n    color: theme.palette.getContrastText(theme.palette.grey[800])\n  },\n  slide: {\n    top: 0,\n    zIndex: 0,\n    opacity: 0,\n    position: 'absolute',\n    display: 'block',\n    overflow: 'hidden',\n    width: '100%',\n    height: '100%',\n    minHeight: 300\n  },\n  dotActive: {\n    background: 'white'\n  },\n  iconButton: {\n    color: 'white'\n  },\n  active: {\n    zIndex: 5,\n    opacity: 1\n  },\n  last: {\n    opacity: 1,\n    zIndex: 4\n  },\n  tagContainer: {\n\n  },\n  labelBadge: {\n    color: 'white',\n    zIndex: 10,\n    position: 'absolute',\n    right: theme.spacing(2),\n    bottom: theme.spacing(1),\n    opacity: 0.8\n  },\n  tagChip: {\n    // height: theme.spacing(3),\n    marginRight: theme.spacing(1),\n    fontSize: 10,\n    height: theme.spacing(2),\n    padding: theme.spacing(0.5)\n  },\n  xyTagChip: {\n    position: 'absolute',\n    fontSize: theme.spacing(1),\n    height: theme.spacing(2)\n  },\n  manualBack: {\n    color: 'white',\n    zIndex: 10,\n    position: 'absolute',\n    transform: 'translateY(-50%)',\n    left: 0,\n    top: '50%'\n  },\n  manualForward: {\n    color: 'white',\n    zIndex: 10,\n    position: 'absolute',\n    transform: 'translateY(-50%)',\n    right: 0,\n    top: '50%'\n  }\n})\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport Button from '@material-ui/core/Button'\nimport Typography from '@material-ui/core/Typography'\nimport DialogActions from '@material-ui/core/DialogActions'\n\n// import MenuIcon from '@material-ui/icons/MenuIcon'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n\n})\n\nconst useStyles = makeStyles(style)\n\nconst CancelConfirm = ({ title, message, onConfirm, open }) => {\n  const classes = useStyles()\n  return (\n    <Dialog\n      className={classes.root}\n      disableBackdropClick\n      fullWidth\n      open={open}\n      disableEscapeKeyDown\n      maxWidth='xl'\n      aria-labelledby='confirmation-dialog-title'\n    >\n      <DialogTitle id='confirmation-dialog-title'>{title}</DialogTitle>\n      <DialogContent>\n        <Typography>\n          {message}\n        </Typography>\n\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={() => onConfirm(false)} color='primary'>\n      No\n        </Button>\n        <Button onClick={() => onConfirm(true)} color='secondary'>\n      Yes\n        </Button>\n      </DialogActions>\n    </Dialog>\n  )\n}\n\nCancelConfirm.propTypes = {\n  open: PropTypes.bool,\n  title: PropTypes.string.isRequired,\n  message: PropTypes.string.isRequired,\n  onConfirm: PropTypes.func.isRequired\n}\n\nexport default CancelConfirm\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\n\nimport Button from '@material-ui/core/Button'\nimport Dialog from '@material-ui/core/Dialog'\nimport IconButton from '@material-ui/core/IconButton'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport Typography from '@material-ui/core/Typography'\nimport DialogActions from '@material-ui/core/DialogActions'\n\nimport CloseIcon from '@material-ui/icons/Close'\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport CancelConfirm from '../dialogs/CancelConfirm'\n\nimport PhotoInfoInner from './PhotoInfoInner'\n\nconst style = theme => ({\n  root: {\n    height: '90%',\n    width: '85%'\n  },\n  dlgTitleContainer: {\n    display: 'flex',\n    padding: 0\n  },\n  dlgTitle: {\n    flexGrow: 1,\n    paddingTop: theme.spacing(2),\n    paddingBottom: theme.spacing(1),\n    paddingLeft: theme.spacing(3)\n  },\n  field: {\n    marginBottom: theme.spacing(2)\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst DIALOGS = {\n  NOTEEDIT: 'noteEdit',\n  NOTEVIEW: 'noteView',\n  PHOTOTAKEN: 'taken',\n  TAGEDIT: 'tag',\n  CANCEL: 'cancel'\n}\n\nconst PhotoInfo = ({ canEdit, photo, onCancel, onOk, open }) => {\n  const classes = useStyles()\n  const [activeDialog, setActiveDialog] = useState(null)\n  const [delta, setDelta] = useState({})\n\n  const dirty = delta && Object.keys(delta).length > 0\n\n  return (\n    <Dialog\n      fullScreen\n      fullWidth\n      onClose={() => {\n        if (dirty) setActiveDialog(DIALOGS.CANCEL)\n        else onCancel()\n      }}\n      aria-labelledby='customized-dialog-title'\n      open={open}\n    >\n      <DialogTitle disableTypography className={classes.dlgTitleContainer}>\n        <Typography variant='h5' className={classes.dlgTitle}>\n          Photo Properties\n        </Typography>\n        <IconButton onClick={onCancel}>\n          <CloseIcon />\n        </IconButton>\n      </DialogTitle>\n      <DialogContent>\n        <PhotoInfoInner\n          photo={photo}\n          delta={delta}\n          onChange={newDelta => setDelta({ ...delta, ...newDelta })}\n          canEdit={canEdit}\n        />\n      </DialogContent>\n\n      <DialogActions>\n        {!canEdit && (\n          <Button onClick={onCancel} color='primary'>\n            Ok\n          </Button>\n        )}\n        {canEdit && !dirty && (\n          <Button onClick={onCancel} color='primary'>\n            Back\n          </Button>\n        )}\n        {canEdit && dirty && (\n          <React.Fragment>\n            <Button onClick={() => setActiveDialog(DIALOGS.CANCEL)} color='primary'>\n              Cancel\n            </Button>\n            <Button onClick={() => setDelta({})} color='primary'>\n              Reset\n            </Button>\n            <Button onClick={() => onOk(delta)} color='primary'>\n              Ok\n            </Button>\n          </React.Fragment>\n        )}\n      </DialogActions>\n      {activeDialog && activeDialog === DIALOGS.CANCEL && (\n        <CancelConfirm\n          open\n          title='Lose unsaved changes?'\n          message='You will lose any changes you made to this form'\n          onConfirm={confirm => {\n            setActiveDialog(null)\n            if (confirm) onCancel()\n          }}\n        />\n      )}\n    </Dialog>\n  )\n}\n\nPhotoInfo.propTypes = {\n  canEdit: PropTypes.bool,\n  onCancel: PropTypes.func.isRequired,\n  onOk: PropTypes.func.isRequired,\n  open: PropTypes.bool,\n  photo: PropTypes.object.isRequired\n}\n\nexport default PhotoInfo\n","import React, { useState, useContext } from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\n\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport Button from '@material-ui/core/Button'\nimport MobileStepper from '@material-ui/core/MobileStepper'\nimport Typography from '@material-ui/core/Typography'\nimport AppBar from '@material-ui/core/AppBar'\nimport Toolbar from '@material-ui/core/Toolbar'\nimport IconButton from '@material-ui/core/IconButton'\nimport Badge from '@material-ui/core/Badge'\nimport Chip from '@material-ui/core/Chip'\n\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack'\nimport InfoIcon from '@material-ui/icons/Info'\nimport LabelIcon from '@material-ui/icons/Label'\n\nimport { makeStyles, useTheme } from '@material-ui/core/styles'\n\nimport PhotoInfo from './subViews/PhotoInfo'\nimport Photo from './subViews/Photo'\n\nimport { formatDate } from '../../../lib/datelib'\nimport Tags from '../../../lib/Tags'\nimport SwipeableViews from 'react-swipeable-views'\nimport { SeriesContext } from '../contexts'\n\nimport style from './PhotoViewTool.style'\nconst useStyles = makeStyles(style)\n\nconst STATES = {\n  VIEWPIC: 0,\n  SHOWINFO: 1,\n  SHOWTAGS: 2,\n  EDITTAGS: 3,\n  FIRSTAGEDIT: 4\n}\n\nconst PhotoViewTool = ({ photos, initPhotoId, onMenuBack, onUpdatePhoto, newPhoto }) => {\n  const classes = useStyles()\n  const theme = useTheme()\n  const { series, seriesConfig, ac } = useContext(SeriesContext)\n  const sortedPhotos = [...photos]\n  sortedPhotos.sort((a, b) => parseInt(b.takenOn, 10) - parseInt(a.takenOn, 10))\n  const [activePhoto, setActivePhoto] = useState(initPhotoId ? sortedPhotos.findIndex(p => p.id === initPhotoId) : 0)\n  // This is a special copy of the photo so we can play around with the XY tags and undo\n  // if we need to\n  const photo = photos[activePhoto]\n  const [delta, setDelta] = useState(newPhoto ? photo : {})\n  const [mode, setMode] = useState({\n    current: newPhoto ? STATES.FIRSTAGEDIT : STATES.VIEWPIC,\n    last: null\n  })\n\n  const tagsClass = new Tags(seriesConfig, delta.tags || photo.tags)\n\n  const changeMode = (desired) => {\n    setMode({ current: desired, last: mode.current })\n  }\n\n  const onCommitTags = () => {\n    changeMode(STATES.SHOWTAGS)\n    onUpdatePhoto(photo, { id: photo.id, ...delta })\n  }\n\n  const onCommitTagsFirst = () => {\n    onUpdatePhoto(photo, { id: photo.id, ...delta })\n    onMenuBack()\n  }\n\n  const onCancelTagEdit = () => {\n    changeMode(STATES.SHOWTAGS)\n    setDelta(photo)\n  }\n\n  const photoClick = (e) => {\n    if (mode.current === STATES.VIEWPIC) {\n      e.preventDefault()\n      e.stopPropagation()\n      changeMode(STATES.SHOWINFO)\n    }\n  }\n\n  const can = {\n    update: ac.canUser('update', series, 'series') ||\n            ac.canUser('update', photo, 'photo')\n  }\n\n  return (\n    <div className={classes.root}>\n      <CssBaseline /> {/* You only need this in a root element. Don't put it anywhere else in the dom */}\n      <AppBar position='static' className={classNames(classes.appBar, mode.current !== STATES.VIEWPIC ? classes.appBarEdit : null)}>\n        <Toolbar>\n          {mode.current !== STATES.FIRSTAGEDIT && (\n            <IconButton\n              className={classes.menuButton}\n              color='inherit'\n              aria-label='Menu'\n              onClick={() => onMenuBack()}\n            >\n              <ArrowBackIcon />\n            </IconButton>\n          )}\n          <div className={classes.grow}>\n            <Typography variant='subtitle2' color='inherit' >\n              {newPhoto ? 'Add Tags' : `Photo View (${activePhoto + 1}/${photos.length})`}\n            </Typography>\n            <Typography variant='subtitle2' color='inherit'>\n              {formatDate(photo.takenOn, 'lll')}\n            </Typography>\n          </div>\n\n          { mode.current === STATES.EDITTAGS &&\n          <Button color='inherit' onClick={onCancelTagEdit}>\n            Cancel\n          </Button>\n          }\n\n          { mode.current === STATES.EDITTAGS &&\n          <Button color='inherit' onClick={onCommitTags}>\n            Save\n          </Button>\n          }\n          { mode.current === STATES.FIRSTAGEDIT &&\n          <Button color='inherit' onClick={onCommitTagsFirst}>\n            Next\n          </Button>\n          }\n\n          { can.update && mode.current === STATES.SHOWTAGS &&\n          <Button color='inherit' onClick={() => changeMode(STATES.EDITTAGS)}>\n            Edit\n          </Button>\n          }\n\n          { (mode.current !== STATES.EDITTAGS && mode.current !== STATES.FIRSTAGEDIT) &&\n          <IconButton color='inherit'\n            className={classNames(classes.tagButton, mode.current === STATES.SHOWTAGS && classes.activeButton)}\n            onClick={() => changeMode(mode.current === STATES.SHOWTAGS ? STATES.VIEWPIC : STATES.SHOWTAGS)}\n          >\n            <Badge className={classes.margin} badgeContent={tagsClass.getXYTags().length} color='primary'>\n              <LabelIcon color='inherit' />\n            </Badge>\n          </IconButton>\n          }\n\n          { (mode.current !== STATES.EDITTAGS && mode.current !== STATES.FIRSTAGEDIT) &&\n          <IconButton color='inherit'\n            className={classNames(classes.infoButton, mode.current === STATES.SHOWINFO && classes.activeButton)}\n            onClick={() => changeMode(mode.current === STATES.SHOWINFO ? STATES.VIEWPIC : STATES.SHOWINFO)}\n          >\n            <InfoIcon />\n          </IconButton>\n          }\n\n        </Toolbar>\n      </AppBar>\n      <div className={classes.inner} onClick={photoClick}>\n        <SwipeableViews\n          axis={theme.direction === 'rtl' ? 'x-reverse' : 'x'}\n          index={activePhoto}\n          containerStyle={{ height: '100%' }}\n          style={{ height: '100%' }}\n          disabled={mode.current !== STATES.VIEWPIC}\n          onChangeIndex={(val) => setActivePhoto(val)}\n          enableMouseEvents\n        >\n          {sortedPhotos.map((photoidx, idx) => (\n            <div className={classes.photoWrapper} key={`swipeshowpic-${idx}`}>\n              <Photo\n                showTags={mode.current === STATES.SHOWTAGS}\n                photo={{ ...photoidx, ...delta }}\n                edit={can.update && (mode.current === STATES.EDITTAGS || mode.current === STATES.FIRSTAGEDIT)}\n                onChange={setDelta}\n                onCommitTags={onCommitTags}\n              />\n            </div>\n          ))}\n        </SwipeableViews>\n\n        {mode.current === STATES.VIEWPIC && (\n          <MobileStepper\n            steps={sortedPhotos.length}\n            position='bottom'\n            activeStep={activePhoto}\n            classes={{\n              root: classes.mobileStepper,\n              dots: classes.dots,\n              dot: classes.dot,\n              dotActive: classes.dotActive\n            }}\n          />\n        )}\n      </div>\n      <PhotoInfo\n        open={mode.current === STATES.SHOWINFO}\n        photo={photo}\n        canEdit={can.update}\n        onOk={(newDelta) => {\n          onUpdatePhoto(photo, { id: photo.id, ...newDelta })\n          changeMode(mode.last)\n        }}\n        onCancel={() => changeMode(mode.last)}\n      />\n      { (mode.current === STATES.EDITTAGS || mode.current === STATES.FIRSTAGEDIT) && (\n        <Chip\n          label='Tap to tag features...'\n          onClick={() => {}}\n          className={classes.tipChip}\n        />\n      )}\n    </div>\n  )\n}\n\nPhotoViewTool.propTypes = {\n  photos: PropTypes.array.isRequired,\n  initPhotoId: PropTypes.string,\n  newPhoto: PropTypes.bool,\n  // Now some action functions\n  onMenuBack: PropTypes.func.isRequired,\n  onUpdatePhoto: PropTypes.func.isRequired\n}\n\nexport default PhotoViewTool\n","export default theme => ({\n  root: {\n    display: 'flex',\n    height: '100%',\n    flexDirection: 'column',\n    overflow: 'hidden'\n  },\n  appBar: {\n    flexGrow: 0\n  },\n  appBarEdit: {\n    color: theme.palette.secondary.contrastText,\n    background: theme.palette.secondary.main\n  },\n  grow: {\n    flexGrow: 1\n  },\n  photoWrapper: {\n    height: '100%'\n  },\n  inner: {\n    flex: '1 1',\n    position: 'relative'\n  },\n  tabMenu: {\n    marginTop: theme.spacing(7)\n  },\n  tipChip: {\n    position: 'absolute',\n    zIndex: 11,\n    bottom: 20,\n    left: '50%',\n    opacity: 0.6,\n    transform: 'translateX(-50%)'\n  },\n  mobileStepper: {\n    background: 'none'\n  },\n  dots: {\n    margin: '0 auto'\n  },\n  dot: {\n    border: '1px solid #FFFFFF77'\n  },\n  dotActive: {\n    background: theme.palette.secondary.main\n  },\n  // tagButton: {\n  //   zIndex: 10,\n  //   color: 'white',\n  //   position: 'absolute',\n  //   fontSize: '2.5rem',\n  //   top: 10,\n  //   left: 10,\n  //   opacity: 0.8\n  // },\n  // infoButton: {\n  //   zIndex: 10,\n  //   color: 'white',\n  //   position: 'absolute',\n  //   top: 10,\n  //   right: 10,\n  //   opacity: 0.8\n  // },\n  activeButton: {\n    color: theme.palette.primary.main,\n    opacity: 1\n  }\n})\n","import AccessControl from 'accesscontrol'\n\nclass AccessHelper {\n  constructor (userSub, role, permissionObj) {\n    this.userSub = userSub\n    this.role = role\n    this.permissionObj = permissionObj\n    this.ac = new AccessControl(permissionObj)\n  }\n\n  // Return the string 'Own' or the string 'Any'\n  ownOrAny = (obj) => {\n    if (!obj || !obj.createdUser || !obj.createdUser.id) throw new Error(`No Created user found`)\n    try {\n      return obj.createdUser.id === this.userSub ? 'Own' : 'Any'\n    }\n    catch (e) {\n      return 'Any'\n    }\n  }\n\n  isOwner = (obj) => {\n    if (!obj || !obj.createdUser || !obj.createdUser.id) throw new Error(`No Created user found`)\n    try {\n      return obj.createdUser.id === this.userSub\n    }\n    catch (e) {\n      return false\n    }\n  }\n\n  toString () {\n    console.log('AccessHelper:', { sub: this.userSub, role: this.role })\n  }\n\n  canUser = (action, obj, type, attrs) => {\n    if (['series', 'photo'].indexOf(type) < 0) throw new Error(`canUser: type not supported ${type}`)\n\n    try {\n      const ownAny = this.ownOrAny(obj)\n\n      const perm = this.ac.can(this.role)[`${action}${ownAny}`](type)\n      let otherPerm = null\n      if (type === 'series') {\n        if (obj.access === 'PUBLIC') otherPerm = this.ac.can(this.role)[`${action}${ownAny}`]('series_public')\n        else if (obj.access === 'OPEN') otherPerm = this.ac.can(this.role)[`${action}${ownAny}`]('series_open')\n      }\n\n      // Trying to recreate the form `can(role).readAny`\n      if (attrs) {\n        if (otherPerm) {\n          return !!perm.attributes.find(p => p === '*' || attrs.indexOf(p) > -1) ||\n           !!otherPerm.attributes.find(p => p === '*' || attrs.indexOf(p) > -1)\n        }\n        else return !!perm.attributes.find(p => p === '*' || attrs.indexOf(p) > -1)\n      }\n      else {\n        if (otherPerm) return perm.granted || otherPerm.granted\n        else return perm.granted\n      }\n    }\n    catch (e) {\n      console.error(e)\n      return false\n    }\n  }\n}\n\nexport default AccessHelper\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport AppBar from '@material-ui/core/AppBar'\nimport Toolbar from '@material-ui/core/Toolbar'\nimport IconButton from '@material-ui/core/IconButton'\nimport Typography from '@material-ui/core/Typography'\n\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport style from './SeriesView.style'\nconst useStyles = makeStyles(style)\n\nconst SeriesNotFound = ({ onMenuBack }) => {\n  const classes = useStyles()\n\n  return (\n    <div className={classes.root}>\n      <CssBaseline />\n      <AppBar position='static' className={classes.appBar}>\n        <Toolbar disableGutters>\n          <IconButton className={classes.menuButton} color='inherit' onClick={onMenuBack} aria-label='Menu'>\n            <ArrowBackIcon />\n          </IconButton>\n          <Typography variant='subtitle1' color='inherit' className={classes.toolbarTitle}>\n            Series\n          </Typography>\n        </Toolbar>\n      </AppBar>\n\n      <div className={classes.placeholderInner}>\n        <div className={classes.grow} />\n        <Typography className={classes.placeholderText} variant='h3'>\n            Series not found\n        </Typography>\n        <div className={classes.grow} />\n      </div>\n    </div>\n  )\n}\n\nSeriesNotFound.propTypes = {\n  // Action functions\n  onMenuBack: PropTypes.func.isRequired\n}\n\nexport default SeriesNotFound\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport AppBar from '@material-ui/core/AppBar'\nimport Toolbar from '@material-ui/core/Toolbar'\nimport IconButton from '@material-ui/core/IconButton'\nimport Typography from '@material-ui/core/Typography'\nimport CircularProgress from '@material-ui/core/CircularProgress'\n\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport style from './SeriesView.style'\nconst useStyles = makeStyles(style)\n\nconst SeriesLoading = ({ onMenuBack }) => {\n  const classes = useStyles()\n\n  return (\n    <div className={classes.root}>\n      <CssBaseline />\n      <AppBar position='static' className={classes.appBar}>\n        <Toolbar disableGutters>\n          <IconButton className={classes.menuButton} color='inherit' onClick={onMenuBack} aria-label='Menu'>\n            <ArrowBackIcon />\n          </IconButton>\n          <Typography variant='subtitle1' color='inherit' className={classes.toolbarTitle}>\n            Series\n          </Typography>\n        </Toolbar>\n      </AppBar>\n\n      <div className={classes.placeholderInner}>\n        <div className={classes.grow} />\n        <div className={classes.progressWrapper}>\n          <CircularProgress className={classes.progress} color='inherit' size={150} thickness={5} />\n        </div>\n        <Typography className={classes.placeholderText} variant='h4'>\n            Loading...\n        </Typography>\n        <div className={classes.grow} />\n      </div>\n    </div>\n  )\n}\n\nSeriesLoading.propTypes = {\n  // Action functions\n  onMenuBack: PropTypes.func.isRequired\n}\n\nexport default SeriesLoading\n","import React, { useState, useEffect } from 'react'\nimport PropTypes from 'prop-types'\n\nimport SeriesView from './views/SeriesView'\nimport SeriesEdit from './views/SeriesEdit'\nimport Slideshow from './views/Slideshow'\nimport PhotoViewTool from './views/PhotoViewTool'\nimport NewPhoto from './views/NewPhoto'\n\nimport AccesHelper from '../../lib/AccessHelper'\n\nimport { SeriesContext } from './contexts'\nimport SeriesNotFound from './views/SeriesNotFound'\nimport SeriesLoading from './views/SeriesLoading'\n\nexport const MODES = {\n  SERIES_VIEW: 'series',\n  SERIES_EDIT: 'editseries',\n  NEWPHOTO: 'newphoto',\n  NEWSERIES: 'newseries',\n  REVIEW: 'review',\n  PHOTO_VIEW: 'photoviewer',\n  PHOTO_VIEW_NEW: 'newphotoviewer',\n  SLIDESHOW: 'slideshow'\n}\nconst VIEW_ONLY_MODES = [MODES.SERIES_VIEW, MODES.PHOTO_VIEW, MODES.SLIDESHOW]\nconst VALID_STARTMODES = [MODES.SERIES_VIEW, MODES.NEWPHOTO, MODES.NEWSERIES, MODES.PHOTO_REVIEW, MODES.PHOTO_VIEW]\n\n/**\n * This component ties all the Repeat Photo components together\n */\nconst RepeatablePhotos = ({\n  modeName, series, seriesConfig, inputMethod: inputMethodINIT,\n  currentUserId, currentUserRole, accessControl, initialPhoto,\n  onChange, onClose, onDelete, onNewSeries, onChangePhoto,\n  onNewPhoto, onDeletePhoto, loading,\n  onWatch, onUnWatch, watching, owned\n}) => {\n  // Manage view modes separately\n  // This is a pretty normal pattern for context\n  const [seriesState, setState] = useState({\n    series,\n    seriesConfig,\n    ac: accessControl ? new AccesHelper(currentUserId, currentUserRole, accessControl) : null\n  })\n  const [mode, setMode] = useState({\n    current: {\n      name: modeName || MODES.SERIES_VIEW,\n      pid: initialPhoto,\n      inputMethod: inputMethodINIT\n    },\n    history: []\n  })\n  // console.log('RepeatablePhotos', state)\n\n  useEffect(() => setState({ ...seriesState, series }), [series])\n\n  // When anything changes about a photo\n  const onUpdatePhoto = (photo, photoDelta) => {\n    const newSeries = { ...seriesState.series }\n    newSeries.photos = newSeries.photos.map(ph => ph.id === photoDelta.id ? { ...ph, ...photoDelta } : ph)\n    onChangePhoto(photo, { ...photoDelta, seriesId: newSeries.id })\n  }\n\n  const onApprovePhoto = async ({ photo: photoDelta, series: seriesDelta }) => {\n    const newSeries = {\n      ...series,\n      photos: [...series.photos, photoDelta]\n    }\n    await onNewPhoto(photoDelta)\n    // THIS SEEMS A LITTLE HACKY BUT GO WITH IT FOR NOW\n    setState({ ...seriesState, series: newSeries })\n    changeMode(MODES.PHOTO_VIEW_NEW, photoDelta.id)\n  }\n\n  const onCreateSeries = async ({ photo: photoDelta, series: seriesDelta }) => {\n    console.log('RepeatablePhotos: waiting for series ID', { seriesDelta, photoDelta })\n    const onNewSeriesReturn = await onNewSeries(seriesDelta, photoDelta)\n    console.log('RepeatablePhotos: waiting for series ID DONE', onNewSeriesReturn)\n  }\n\n  // When a photo is removed\n  const onDeletePhotos = (photoIdArr) => {\n    series.photos.filter(sp => photoIdArr.indexOf(sp.id) > -1).forEach(p => onDeletePhoto(p))\n  }\n\n  // Here's our modeChanger. My guess it will get a lot more complicated\n  // once the reducers get in and working\n  const changeMode = (newModeName, newPid, newInputMethod) => {\n    const canUpdate = seriesState.ac.canUser('update', series, 'series')\n    if (seriesState === null) onClose()\n    if (!canUpdate && VIEW_ONLY_MODES.indexOf(newModeName) < 0) {\n      console.error('ILLEGAL MODE CHANGE!!!!!', { from: mode.current, to: newModeName, canUpdate })\n    }\n    else {\n      // console.log('CHANGING MODE TO', newModeName)\n      setMode({\n        current: {\n          name: newModeName,\n          pid: newPid,\n          inputMethod: newInputMethod\n        },\n        history: [...mode.history, mode.current]\n      })\n    }\n  }\n  const lastMode = () => {\n    // console.log('REPEATABLEPHOTOS lastMode', mode)\n    if (mode.history.length > 0) {\n      const oldHistory = [...mode.history]\n      const oldMode = oldHistory.pop()\n      setMode({\n        current: oldMode,\n        history: oldHistory\n      })\n    }\n    else {\n      onClose()\n    }\n  }\n\n  // The action to initiate the photo viewer\n  const viewPhoto = (pid) => {\n    // console.log('DEBUG', mode, series.photos.find(p => p.id === pid))\n    changeMode(MODES.PHOTO_VIEW, pid)\n  }\n\n  let component = null\n\n  if (loading) return <SeriesLoading onMenuBack={onClose} />\n  else if (!seriesState.series) return <SeriesNotFound onMenuBack={onClose} />\n\n  switch (mode.current.name) {\n    case MODES.SERIES_VIEW:\n      component = (\n        <SeriesView\n          // This one has lots of functionsgit add\n          onSlideshowStart={() => changeMode(MODES.SLIDESHOW)}\n          onChange={() => {\n            console.log('onChange NOT IMPLEMENTED')\n          }}\n          watching={watching}\n          owned={owned}\n          initialPhoto={initialPhoto}\n          onDeletePhotos={onDeletePhotos}\n          onDeleteSeries={onDelete}\n          onCameraAdd={() => changeMode(MODES.NEWPHOTO, null, 'camera')}\n          onEditSeries={() => changeMode(MODES.SERIES_EDIT)}\n          onLibraryAdd={() => changeMode(MODES.NEWPHOTO, null, 'library')}\n          onTileClick={viewPhoto}\n          onMenuBack={onClose}\n          onWatch={onWatch}\n          onUnWatch={onUnWatch}\n        />\n      )\n      break\n    case MODES.SERIES_EDIT:\n      component = (\n        <SeriesEdit\n          onCancel={() => changeMode(MODES.SERIES_VIEW)}\n          onOk={(seriesDelta) => {\n            onChange(series, { ...seriesDelta, id: series.id })\n            changeMode(MODES.SERIES_VIEW)\n          }}\n        />\n      )\n      break\n    case MODES.PHOTO_VIEW:\n      component = (\n        <PhotoViewTool\n          photos={seriesState.series.photos}\n          initPhotoId={mode.current.pid}\n          onMenuBack={lastMode}\n          onUpdatePhoto={onUpdatePhoto}\n        />\n      )\n      break\n    case MODES.PHOTO_VIEW_NEW:\n      component = (\n        <PhotoViewTool\n          photos={seriesState.series.photos}\n          initPhotoId={mode.current.pid}\n          newPhoto\n          onMenuBack={() => changeMode(MODES.SERIES_VIEW)}\n          onUpdatePhoto={onUpdatePhoto}\n        />\n      )\n      break\n    case MODES.SLIDESHOW:\n      component = (\n        <Slideshow photos={seriesState.series.photos} onCancel={lastMode} />\n      )\n      break\n    case MODES.NEWPHOTO:\n      component = (\n        <NewPhoto\n          inputMethod={mode.current.inputMethod}\n          photos={series ? series.photos : null}\n          onCreate={onApprovePhoto}\n          onCancel={lastMode}\n        />\n      )\n      break\n    case MODES.NEWSERIES:\n      component = (\n        <NewPhoto\n          inputMethod={mode.current.inputMethod}\n          isNewSeries\n          onCreate={onCreateSeries}\n          onCancel={lastMode}\n        />\n      )\n      break\n    default:\n      console.log('REPEATABLEPHOTO: default state. you should NEVER see this', seriesState)\n      component = null\n  }\n\n  return (\n    <SeriesContext.Provider value={seriesState}>\n      {component}\n    </SeriesContext.Provider>\n  )\n}\n\nRepeatablePhotos.propTypes = {\n  modeName: PropTypes.oneOf(VALID_STARTMODES),\n  seriesConfig: PropTypes.object.isRequired,\n  watching: PropTypes.bool,\n  owned: PropTypes.bool,\n\n  currentUserId: PropTypes.string,\n  currentUserRole: PropTypes.string,\n  accessControl: PropTypes.object,\n\n  inputMethod: PropTypes.oneOf(['camera', 'library']),\n  series: PropTypes.object,\n  initialPhoto: PropTypes.string,\n  loading: PropTypes.bool,\n\n  // Now some functions to handle actions we might take\n  onChange: PropTypes.func.isRequired,\n  onChangePhoto: PropTypes.func.isRequired,\n  onDeletePhoto: PropTypes.func.isRequired,\n  onNewPhoto: PropTypes.func.isRequired,\n  onNewSeries: PropTypes.func.isRequired,\n  onDelete: PropTypes.func.isRequired,\n  onClose: PropTypes.func.isRequired,\n  onWatch: PropTypes.func,\n  onUnWatch: PropTypes.func\n\n}\nRepeatablePhotos.defaultProps = {\n  mode: MODES.SERIES_VIEW\n}\n\nexport default RepeatablePhotos\n","import { openDb } from 'idb'\nimport { localDb } from '../config'\nimport uuidv4 from 'uuid/v4'\n\n/**\n * This is a leftover from the original, static RepeatablePhotos app.\n * For now it's just a decent way of storing the image data\n */\nconst dbPromise = openDb('serieslistDB', 1, upgradeDB => {\n  console.log('UPGRADE NEEDED', upgradeDB)\n  const store = upgradeDB.createObjectStore(localDb.imgStore)\n  console.log('UPGRADE NEEDED STORE', store)\n}).catch(e => {\n  console.error('ERROR', e)\n})\n\nexport const localUUID = (prefix) => {\n  return `__LOCAL_${prefix}::${uuidv4()}`\n}\n\nexport async function get (key) {\n  const db = await dbPromise\n  return db.transaction(localDb.imgStore).objectStore(localDb.imgStore).get(key)\n}\nexport async function getAll () {\n  const db = await dbPromise\n  return db.transaction(localDb.imgStore).objectStore(localDb.imgStore).getAll()\n}\nexport async function getOne () {\n  const db = await dbPromise\n  return db.transaction(localDb.imgStore).objectStore(localDb.imgStore).getAll(null, 1)\n}\nexport async function setEntry (key, val) {\n  const db = await dbPromise\n  const tx = db.transaction(localDb.imgStore, 'readwrite')\n  tx.objectStore(localDb.imgStore).put(val, key)\n  return tx.complete\n}\nexport async function deleteEntry (key) {\n  const db = await dbPromise\n  const tx = db.transaction(localDb.imgStore, 'readwrite')\n  tx.objectStore(localDb.imgStore).delete(key)\n  return tx.complete\n}\nexport async function clear () {\n  const db = await dbPromise\n  const tx = db.transaction(localDb.imgStore, 'readwrite')\n  tx.objectStore(localDb.imgStore).clear()\n  return tx.complete\n}\nexport async function keys () {\n  const db = await dbPromise\n  return db.transaction(localDb.imgStore).objectStore(localDb.imgStore).getAllKeys()\n}\n","import React, { useContext } from 'react'\nimport PropTypes from 'prop-types'\nimport { home } from '../config'\nimport permissions from '../permissions'\nimport { graphql, compose } from 'react-apollo'\nimport { connect } from 'react-redux'\nimport actions from '../redux/actions'\nimport { getWholeSeries, allSeries, getUser, getMyFeed } from './queries'\nimport { deletePhoto, deleteSeries, updateSeries, createPhoto, createSeries, updatePhoto, watchSeries, unWatchSeries } from './mutations'\nimport RepeatablePhotos, { MODES } from '../components/PhotoSeries'\nimport { localUUID } from '../lib/localdb' // get, setEntry\nimport { AppContext } from '../contexts'\n\nimport { ThemeProvider } from '@material-ui/styles'\nimport themes from '../themes'\n\nconst SeriesConnect = ({\n  series, loading, domain, activeSeries, initialPhoto,\n  onAfterSeriesDelete, onBack, queueUpload, doneCreatingSeries,\n  createSeriesMutation, createPhotoMutation,\n  updateSeriesMutation, updatePhotoMutation,\n  deleteSeriesMutation, deletePhotoMutation,\n  watchSeriesMutation, unWatchSeriesMutation\n}) => {\n  const { role, currentUser, seriesConfig, user, signedIn } = useContext(AppContext)\n  let inputMethod = 'camera'\n  // Hack until we can get good loading object sorted\n  if (domain === home.AppStateTypes.NEW_SERIES_CAMERA) inputMethod = 'camera'\n  else if (domain === home.AppStateTypes.NEW_SERIES_LIBRARY) inputMethod = 'library'\n\n  // console.log('SeriesConnect', { series, loading, currentState, activeSeries, role, currentUser })\n  let modeName = MODES.SERIES_VIEW\n  if (domain !== home.AppStateTypes.SERIES) modeName = MODES.NEWSERIES\n\n  return (\n    <ThemeProvider theme={themes.series}>\n      <RepeatablePhotos\n        modeName={modeName}\n        inputMethod={inputMethod}\n\n        owned={signedIn && user && series && user.id === series.id}\n        watching={signedIn && user && user.watching && user.watching.indexOf(activeSeries) > -1}\n\n        // Everything we need to determine access\n        currentUserId={signedIn ? currentUser.attributes.sub : null}\n        currentUserRole={role}\n        accessControl={permissions}\n        loading={loading}\n        series={series}\n        initialPhoto={initialPhoto}\n        seriesConfig={seriesConfig}\n        // Now some functions to handle actions we might take\n        onNewPhoto={({ base64, ...newPhoto }) => {\n          console.log('onNewPhoto', { base64, ...newPhoto })\n          const ext = base64.split(';')[0].split('/')[1]\n          return createPhotoMutation(newPhoto, ext)\n            .then(({ data }) => {\n              // Don't start an upload until you get back a proper id\n              if (data.createPhoto.preAuth) {\n                const preAuth = JSON.parse(data.createPhoto.preAuth)\n                console.log('PREAUTH', data.createPhoto.preAuth)\n                queueUpload({\n                  id: newPhoto.id,\n                  seriesId: data.createPhoto.seriesId,\n                  base64,\n                  preAuth\n                })\n              }\n              return data\n            })\n            .catch(err => {\n              console.log('onNewPhoto Graphql Error', err.stack)\n              console.error(err)\n            })\n        }}\n        onChangePhoto={(photo, photoDelta) => updatePhotoMutation(photo, photoDelta)\n          .catch(err => {\n            console.log('onChangePhoto Graphql Error', err.stack)\n            console.error(err)\n          })\n        }\n        onDeletePhoto={(photo) => deletePhotoMutation(photo.id)\n          .then((...data) => {\n            console.log('photo deleted', data)\n          })\n          .catch(err => {\n            console.log('onDeletePhoto Graphql Error', err.stack)\n            console.error(err)\n          })\n        }\n        onChange={(series, seriesDelta) => updateSeriesMutation(series, seriesDelta)\n          .catch(err => {\n            console.log('onChange Graphql Error', err.stack)\n            console.error(err)\n          })\n        }\n        onNewSeries={(newSeries, photoNoId) => {\n          console.log('Series.connect: onNewSeries starting', newSeries)\n          return createSeriesMutation(newSeries)\n            .then(async ({ data }) => {\n              const { base64, ...newPhoto } = photoNoId\n              const ext = base64.split(';')[0].split('/')[1]\n              console.log('Series.connect: done createSeriesMutation', data)\n              const { data: photoData } = await createPhotoMutation({ ...photoNoId, seriesId: data.createSeries.id }, ext)\n\n              const preAuth = JSON.parse(photoData.createPhoto.preAuth)\n              console.log('PREAUTH', photoData.createPhoto.preAuth)\n              queueUpload({\n                id: newPhoto.id,\n                seriesId: photoData.createPhoto.seriesId,\n                base64,\n                preAuth\n              })\n              doneCreatingSeries(data.createSeries.id)\n              return data\n            })\n            .catch(err => {\n              console.log('onNewSeries Graphql Error', err.stack)\n              console.error(err)\n            })\n        }}\n        onDelete={() => deleteSeriesMutation()\n          .then(onAfterSeriesDelete)\n          .catch(err => {\n            console.log('onDelete Graphql Error', err.stack)\n            console.error(err)\n          })\n        }\n        onClose={onBack}\n        onWatch={signedIn ? watchSeriesMutation : null}\n        onUnWatch={signedIn ? unWatchSeriesMutation : null}\n      />\n    </ThemeProvider>\n  )\n}\nSeriesConnect.propTypes = {\n  domain: PropTypes.string,\n  activeSeries: PropTypes.string,\n  initialPhoto: PropTypes.string,\n\n  // From Redux\n  onAfterSeriesDelete: PropTypes.func,\n  doneCreatingSeries: PropTypes.func,\n  queueUpload: PropTypes.func,\n  onBack: PropTypes.func,\n\n  // Data from apollo\n  series: PropTypes.object,\n\n  // Functions From Apollo\n  loading: PropTypes.bool,\n  updateSeriesMutation: PropTypes.func,\n  updatePhotoMutation: PropTypes.func,\n  deleteSeriesMutation: PropTypes.func,\n  deletePhotoMutation: PropTypes.func,\n  createSeriesMutation: PropTypes.func,\n  createPhotoMutation: PropTypes.func,\n  watchSeriesMutation: PropTypes.func,\n  unWatchSeriesMutation: PropTypes.func\n}\n\n/**\n * Here's the graphql HOC that gets an individual series\n */\nconst withGetSelectedQuery = graphql(getWholeSeries, {\n  props: ({ data }) => {\n    if (data.error) console.error(data.error)\n    // console.log('HERE', data)\n    let series = null\n    try {\n      if (!data.loading && !data.error) series = data.series\n    }\n    catch (e) {\n      console.error(data)\n      console.error(e)\n    }\n    return {\n      data,\n      loading: data.loading,\n      series\n    }\n  },\n  skip: ({ activeSeries, isNewSeries }) => !activeSeries || isNewSeries,\n  options: ({ activeSeries }) => ({\n    variables: {\n      id: activeSeries\n    }\n  })\n})\n\nconst withUpdateSeriesMutation = graphql(updateSeries, {\n  props: ({ mutate, ownProps }) => ({\n    // We turn this into a thunk so we can handle the business logic here and not in a JSX region\n    updateSeriesMutation: (series, seriesDelta) => mutate({\n      // input UpdateSeries {\n      //   id: ID!\n      //   name: String\n      //   note: String\n      //   latitude: Float\n      //   longitude: Float\n      //   direction: Int\n      // }\n      variables: { series: sanitizeUpdateParams(seriesDelta, ['id', 'name', 'access', 'note', 'latitude', 'longitude', 'direction']) },\n      optimisticResponse: {\n        updateSeries: {\n          ...series,\n          ...seriesDelta,\n          __typename: 'Series'\n        }\n      },\n      update: (store, { data }) => {\n        // console.log('withUpdateSeriesMutation start Manip:', JSON.stringify(data, null, 2))\n        const qdata = store.readQuery({ query: getWholeSeries, variables: { id: ownProps.activeSeries } })\n        qdata.series = { ...qdata.series, ...seriesDelta }\n        store.writeQuery({ query: getWholeSeries, data: qdata })\n        // console.log('withUpdateSeriesMutation Done Manip:', qdata)\n\n        // Update: allSeries\n        // We might not have called this query yet so let it throw if it wants\n        try {\n          const qdataAll = store.readQuery({ query: allSeries, variables: { limit: 100 } })\n          // console.log('withUpdateSeriesMutation qdataAll:', qdataAll)\n          const summary = sanitizeUpdateParams(seriesDelta, ['id', 'name', 'access', 'latitude', 'longitude', 'direction'])\n          qdataAll.allSeries.seriesSummaries = qdataAll.allSeries.seriesSummaries.map(s => s.id !== summary.id\n            ? s\n            : { ...s, ...summary }\n          )\n          store.writeQuery({ query: allSeries, data: qdataAll })\n          // console.log('withUpdateSeriesMutation qdataAll WRITE:', qdataAll)\n        }\n        catch (e) { }\n      }\n    })\n  })\n})\n\n// id: ID!\n// seriesId: ID!\n// takenOn: String\n// tags: [TagInput]\n// note: String\nconst withUpdatePhotoMutation = graphql(updatePhoto, {\n  props: ({ mutate, ownProps }) => ({\n    // We turn this into a thunk so we can handle the business logic here and not in a JSX region\n    updatePhotoMutation: (photo, photoDelta) => {\n      const sanitizedPhotoDelta = sanitizeUpdateParams(photoDelta, [ 'id', 'seriesId', 'takenOn', 'tags', 'note' ])\n      if (sanitizedPhotoDelta.tags && sanitizedPhotoDelta.tags.length > 0) {\n        // input TagInput {\n        //   label: String\n        //   typeId: String,\n        //   coords: ImageCoordsInput\n        // }\n        sanitizedPhotoDelta.tags = sanitizedPhotoDelta.tags.map(t => {\n          const newT = sanitizeUpdateParams(t, [ 'label', 'typeId', 'coords' ])\n          if (newT.coords) newT.coords = sanitizeUpdateParams(newT.coords, [ 'x', 'y' ])\n          return newT\n        })\n      }\n      // console.log('withUpdatePhotoMutation', sanitizedPHoto)\n      return mutate({\n      // input UpdatePhoto {\n      //   id: ID!\n      //   seriesId: ID!\n      //   takenOn: String\n      //   tags: [TagInput]\n      //   note: String\n      // }\n        variables: { photo: sanitizedPhotoDelta },\n        optimisticResponse: {\n          updatePhoto: {\n            ...photo,\n            ...sanitizedPhotoDelta,\n            __typename: 'Photo'\n          }\n        },\n        update: (store, { data }) => {\n          // console.log('updatePhotoMutation start Manip:', JSON.stringify(data, null, 2))\n          const qdata = store.readQuery({ query: getWholeSeries, variables: { id: ownProps.activeSeries } })\n          // Gotta add Typenames\n          const updatedPhoto = {\n            ...sanitizedPhotoDelta,\n            tags: sanitizedPhotoDelta.tags ? sanitizedPhotoDelta.tags.map(t => {\n              const newT = { ...t, __typename: 'Tag' }\n              newT.coords = newT.coords ? { ...newT.coords, __typename: 'ImageCoords' } : null\n              return newT\n            }) : []\n          }\n          // console.log('updatePhotoMutation', updatedPhoto)\n          qdata.series.photos = qdata.series.photos.map(photo => photo.id !== photoDelta.id ? photo : { ...photo, ...updatedPhoto })\n\n          store.writeQuery({ query: getWholeSeries, data: qdata })\n          // console.log('updatePhotoMutation Manip:', { qdata })\n        }\n      })\n    }\n  })\n})\n\nconst withDeleteSeriesDeleteMutation = graphql(deleteSeries, {\n  props: ({ mutate, ownProps }) => {\n    return {\n      deleteSeriesMutation: () => mutate({\n        variables: { id: ownProps.activeSeries },\n        optimisticResponse: {\n          deleteSeries: ownProps.activeSeries\n        },\n        update: (store, { data }) => {\n          try {\n            const qdataAll = store.readQuery({ query: allSeries, variables: { limit: 100 } })\n            qdataAll.allSeries.seriesSummaries = qdataAll.allSeries.seriesSummaries.filter(s => s.id !== data.deleteSeries)\n            store.writeQuery({ query: allSeries, data: qdataAll })\n          }\n          catch (e) { }\n        }\n      })\n    }\n  }\n})\n\nconst withDeletePhotoMutation = graphql(deletePhoto, {\n  props: ({ mutate, ownProps }) => ({\n    // We turn this into a thunk so we can handle the business logic here and not in a JSX region\n    deletePhotoMutation: (photoId) => mutate({\n      variables: { seriesId: ownProps.series.id, photoId },\n      optimisticResponse: {\n        deletePhoto: photoId\n      },\n      update: (store, { data }) => {\n        console.log('deletePhotoMutation start Manip:', JSON.stringify(data, null, 2))\n        let finalCount = null\n\n        const qdata = store.readQuery({ query: getWholeSeries, variables: { id: ownProps.activeSeries } })\n        qdata.series.photos = qdata.series.photos.filter(photo => photo.id !== data.deletePhoto)\n\n        finalCount = qdata.series.photos.length\n        qdata.series.photoCount = finalCount\n        store.writeQuery({ query: getWholeSeries, data: qdata })\n        console.log('deletePhotoMutation start Manip WRITE:', qdata)\n\n        // Update: allSeries\n        // We might not have called this query yet so let it throw if it wants\n        try {\n          const qdataAll = store.readQuery({ query: allSeries, variables: { limit: 100 } })\n          console.log('deletePhotoMutation qdataAll:', qdataAll)\n          qdataAll.allSeries.seriesSummaries = qdataAll.allSeries.seriesSummaries.map(s => s.id !== data.deletePhoto\n            ? s\n            : { ...s, photoCount: finalCount !== null ? finalCount : s.photoCount }\n          )\n          store.writeQuery({ query: allSeries, data: qdataAll })\n          console.log('deletePhotoMutation qdataAll WRITE:', qdataAll)\n        }\n        catch (e) { }\n\n        console.log('Done Manip:', qdata.series.photos)\n      }\n    })\n  })\n})\n\nconst withCreateNewSeries = graphql(createSeries, {\n  props: ({ mutate, ownProps }) => {\n    return {\n      createSeriesMutation: (newSeries) => {\n        // input NewSeriesInput {\n        //   name: String!\n        //   note: String\n        //   latitude: Float!\n        //   longitude: Float!\n        //   direction: Int\n        //   meta: String\n        // }\n        return mutate({\n          variables: { series: sanitizeUpdateParams(newSeries, ['name', 'note', 'latitude', 'longitude', 'direction', 'meta']) },\n          optimisticResponse: {\n            'createSeries': {\n              'id': localUUID('SERIES'),\n              'name': newSeries.name || null,\n              'note': newSeries.note || null,\n              'meta': newSeries.meta || {},\n              'featured': newSeries.featured || null,\n              'coords': newSeries.coords || null,\n              'direction': newSeries.direction || null,\n              'photoCount': 0,\n              'photos': [],\n              __typename: 'Series'\n            }\n          },\n          update: (store, { data }) => {\n            // We need to write this query from scratch\n            console.log('STARTING TO CREATE THE SERIES', data, store)\n            // dumpLog(store.data, '##CACHE-NEW_SERIES_BEFORE')\n            try {\n              store.writeQuery({ query: getWholeSeries,\n                data: { series: data.createSeries }\n              })\n              console.log('Series write getWholeSeries', { series: data.createSeries })\n            }\n            catch (e) {\n              console.error(e)\n            }\n\n            try {\n              const qdataAll = store.readQuery({ query: allSeries, variables: { limit: 100 } })\n              // console.log('createSeriesMutation qdataAll:', qdataAll)\n              const newAllSeriesEntry = sanitizeUpdateParams(data.createSeries, ['id', 'name', 'updatedOn', 'featured', 'longitude', 'latitude', 'photoCount', 'seriesStatus', 'direction'])\n              qdataAll.allSeries.seriesSummaries.push(newAllSeriesEntry)\n              store.writeQuery({ query: allSeries, data: qdataAll })\n              // console.log('createSeriesMutation qdataAll WRITE:', qdataAll)\n            }\n\n            catch (e) {\n              // dumpLog(store.data, '##CACHE-NEW_SERIES_ERROR')\n              console.error('createSeriesMutation allSeries error')\n              console.error(e)\n            }\n            // dumpLog(store.data, '##CACHE-NEW_SERIES_AFTER')\n          }\n        })\n      }\n    }\n  }\n})\n\nconst withCreateNewPhoto = graphql(createPhoto, {\n  props: ({ mutate, ownProps }) => {\n    return {\n      createPhotoMutation: (newPhoto, ext) => {\n        // input NewPhotoInput {\n        //   seriesId: ID!\n        //   takenOn: String\n        //   meta: String\n        //   tags: [TagInput]\n        //   note: String\n        // }\n        // When we're not creating a series the seriesId isn't passed in\n        // so we add it now\n        const { base64, ...newPhotoInput } = newPhoto\n        if (!newPhotoInput.seriesId && ownProps.activeSeries) {\n          newPhotoInput.seriesId = ownProps.activeSeries\n        }\n        return mutate({\n          variables: { photo: sanitizeUpdateParams(newPhotoInput, [ 'seriesId', 'takenOn', 'meta', 'tags', 'note' ]), ext },\n          optimisticResponse: {\n            'createPhoto': {\n              'photo': {\n                'id': localUUID('PHOTO'),\n                'meta': newPhotoInput.meta,\n                'seriesId': newPhotoInput.seriesId,\n                'createdOn': Date.now().toString(),\n                'createdUser': {\n                  'id': ownProps.authData.attributes.sub,\n                  'username': ownProps.authData.Username\n                },\n                'updatedBy': ownProps.authData.attributes.sub,\n                'updatedOn': Date.now().toString(),\n                'takenOn': newPhotoInput.takenOn,\n                'tags': newPhotoInput.tags || [],\n                'paths': {\n                  large: null,\n                  orig: null,\n                  thumb: null,\n                  medium: null,\n                  __typename: 'Paths'\n                },\n                '__typename': 'Photo'\n              },\n              'preAuth': null,\n              '__typename': 'NewPhotoOutput'\n            }\n          },\n          update: (store, { data }) => {\n            // Update: getWholeSeries\n            console.log('createPhotoMutation store.readQuery:', { data, store, ownProps })\n\n            try {\n              const qdata = store.readQuery({ query: getWholeSeries, variables: { id: data.createPhoto.seriesId } })\n              qdata.series.photos = qdata.series.photos = [...qdata.series.photos, data.createPhoto]\n\n              store.writeQuery({ query: getWholeSeries, data: qdata })\n            }\n            catch (e) {\n              // This won't fire on new series and that's ok for now.\n            }\n\n            // Update: allSeries\n            // We might not have called this query yet so let it throw if it wants\n            let qdataAll = null\n            try {\n              qdataAll = store.readQuery({ query: allSeries, variables: { limit: 100 } })\n              console.log('createPhotoMutation qdataAll:', qdataAll)\n              qdataAll.allSeries.seriesSummaries = qdataAll.allSeries.seriesSummaries.map(s => s.id !== data.createPhoto.photo.seriesId\n                ? s\n                : { ...s, photoCount: s.photoCount + 1 }\n              )\n              store.writeQuery({ query: allSeries, data: qdataAll })\n              console.log('createPhotoMutation qdataAll: WRITE', qdataAll)\n            }\n            catch (e) {\n              console.error('createPhotoMutation allSeries ERROR')\n              console.error(e)\n            }\n          }\n        })\n      }\n    }\n  }\n})\n\nconst withWatchSeriesMutation = graphql(watchSeries, {\n  props: ({ mutate, ownProps }) => {\n    return {\n      watchSeriesMutation: () => mutate({\n        variables: { seriesId: ownProps.activeSeries },\n        optimisticResponse: {\n          watchSeries: ownProps.activeSeries\n        },\n        update: (store, { data }) => {\n          // TODO: modify the getuser query to add this to the list of favourites\n          // try {\n          const qdataAll = store.readQuery({ query: getUser })\n          qdataAll.user.watching = [...new Set([...qdataAll.user.watching || [], data.watchSeries])]\n          store.writeQuery({ query: getUser, data: qdataAll })\n\n          const qFeedData = store.readQuery({ query: getMyFeed })\n          console.log('DEBUG', qFeedData)\n          // qdataAll.user.watching = [...new Set([...qdataAll.user.watching || [], data.watchSeries])]\n          // store.writeQuery({ query: getUser, data: qdataAll })\n          // }\n          // catch (e) { }\n        }\n      })\n    }\n  }\n})\n\nconst withUnWatchSeriesMutation = graphql(unWatchSeries, {\n  props: ({ mutate, ownProps }) => {\n    return {\n      unWatchSeriesMutation: () => mutate({\n        variables: { seriesId: ownProps.activeSeries },\n        optimisticResponse: {\n          unWatchSeries: ownProps.activeSeries\n        },\n        update: (store, { data }) => {\n          // try {\n          const qdataAll = store.readQuery({ query: getUser })\n          qdataAll.user.watching = qdataAll.user.watching.filter(sid => sid !== data.unWatchSeries)\n          store.writeQuery({ query: getUser, data: qdataAll })\n          // }\n          // catch (e) { }\n        }\n      })\n    }\n  }\n})\n\n/**\n * Compose all our queries together\n */\nconst connectedWithApollo = compose(\n  withGetSelectedQuery,\n  withCreateNewSeries,\n  withCreateNewPhoto,\n  withUpdateSeriesMutation,\n  withUpdatePhotoMutation,\n  withDeleteSeriesDeleteMutation,\n  withDeletePhotoMutation,\n  withWatchSeriesMutation,\n  withUnWatchSeriesMutation\n)(SeriesConnect)\n\n/**\n * Map our redux state and functions\n */\nconst mapStateToProps = (state, props) => {\n  const { current: { activeSeries, initialPhoto, domain } } = state.home\n  return { activeSeries, initialPhoto, domain }\n}\n\nconst mapDispatchToProps = dispatch => ({\n  onBack: () => {\n    dispatch(actions.homeStateBack())\n  },\n  onAfterSeriesDelete: (key, newProgress) => {\n    dispatch(actions.setActiveSeries(null))\n    dispatch(actions.homeStateBack())\n  },\n  queueUpload: (uploadObj) => {\n    dispatch(actions.queueUpload(uploadObj))\n  },\n  doneCreatingSeries: (seriesId) => {\n    dispatch(actions.setActiveSeries(seriesId))\n    dispatch(actions.setHomeState(home.AppStateTypes.SERIES))\n  }\n})\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(connectedWithApollo)\n\n/**\n * We need to filter out null values and params we don't desire\n */\nfunction sanitizeUpdateParams (inputObj, desiredParams) {\n  const newDesiredParams = [...desiredParams, '__typename']\n  const remainder = Object.keys(inputObj).filter(key => newDesiredParams.indexOf(key) > -1)\n  console.log('sanitizeUpdateParams', { orig: Object.keys(inputObj), remainder })\n  return remainder.reduce((acc, key) => ({ ...acc, [key]: inputObj[key] }), {})\n}\n\n// function dumpLog (obj, name) {\n//   console.log(`${Date.now()}__${name}`, JSON.stringify(obj, null, 2))\n// }\n","import { useState, useEffect, useCallback } from 'react'\nimport uuid from 'uuid/v4'\nimport WebMercatorViewport from 'viewport-mercator-project'\nimport rbush from 'rbush'\nimport { point, centroid, featureCollection } from '@turf/turf'\nimport { debounce } from './util'\n\nconst useClusteredData = (data, filterBounds, currentZoom, viewport, sizeScale, queryVersion) => {\n  const [clusteredData, setClusteredData] = useState([])\n  const [filteredData, setFilteredData] = useState({ single: [], cluster: [] })\n  const [version, setVersion] = useState(0)\n\n  // We promisify and debounce the expensive stuff so it runs outside our render loop\n  const updateDataDebounce = useCallback(debounce(async (...innerArgs) => {\n    const updatedData = await updateData(...innerArgs)\n    setClusteredData(updatedData)\n    // setClusteredData(updatedData)\n    setVersion(version + 1)\n  }, 1000), [])\n\n  const filterDataDebounce = useCallback(debounce(async (...innerArgs) => {\n    const filtered = await filterData(...innerArgs)\n    setFilteredData(filtered)\n  }, 300), [])\n\n  // Here's the really expensive call. Make sure this only runs when the data changes\n  useEffect(() => {\n    updateDataDebounce(data, sizeScale, viewport)\n  }, [data.length, queryVersion])\n\n  useEffect(() => {\n    filterDataDebounce(clusteredData, filterBounds, currentZoom)\n  }, [clusteredData, currentZoom, filterBounds, version])\n\n  return { filteredClusteredData: filteredData }\n}\n\nexport default useClusteredData\n\n// Compute icon clusters\n// We use the projected positions instead of longitude and latitude to build\n// the spatial index, because this particular dataset is distributed all over\n// the world, we can't use some fixed deltaLon and deltaLat\nconst updateData = (data, sizeScale, viewport) => {\n  // console.log('----------------------------------UPDATE CLUSTER----------------------------------', { data, sizeScale, viewport })\n\n  if (!data) {\n    return []\n  }\n  const tree = rbush(9, ['.x', '.y', '.x', '.y'])\n\n  const transform = new WebMercatorViewport({\n    ...viewport,\n    zoom: 0\n  })\n\n  // console.log('DATA', data)\n  // The root of this is GeoJSON so that's what we have to build\n  const newData = data.map(p => {\n    // Create some GeoJSON that we can render as a dot\n    let screenCoords = [0, 0]\n    try {\n      screenCoords = transform.project(p.coords)\n    }\n    catch (e) {\n      console.error(e)\n    }\n    const { longitude, latitude, ...properties } = p\n    return {\n      x: screenCoords[0],\n      y: screenCoords[1],\n      photoCount: properties.photoCount,\n      zoomLevels: [],\n      geoJSON: p.coords ? point(p.coords, { ...properties }) : null\n    }\n  })\n\n  tree.clear()\n  tree.load(newData)\n\n  for (let z = 0; z <= 20; z++) {\n    const radius = sizeScale / Math.sqrt(2) / Math.pow(2, z)\n    // const radius = 60 / Math.sqrt(2) / Math.pow(2, z)\n\n    newData.forEach(p => {\n      if (p.zoomLevels[z] === undefined) {\n        // this point does not belong to a cluster\n        const { x, y } = p\n\n        // find all points within radius that do not belong to a cluster\n        const neighbors = tree\n          .search({\n            minX: x - radius,\n            minY: y - radius,\n            maxX: x + radius,\n            maxY: y + radius\n          })\n          .filter(neighbor => neighbor.zoomLevels[z] === undefined)\n\n        // only show the center point at this zoom level\n        neighbors.forEach(neighbor => {\n          if (neighbor === p) {\n            const newGeoJSON = neighbors.length === 1\n              ? p.geoJSON\n              : centroid(featureCollection(neighbors.map(n => n.geoJSON)))\n\n            newGeoJSON.properties = {\n              ...newGeoJSON.properties,\n              id: newGeoJSON.properties.id || uuid(),\n              count: neighbors.length,\n              reducedPhotoCount: neighbors.reduce((acc, { photoCount }) => photoCount ? acc + photoCount : acc, 0),\n              points: neighbors.map(n => n.geoJSON)\n            }\n            p.zoomLevels[z] = newGeoJSON\n          }\n          else {\n            neighbor.zoomLevels[z] = null\n          }\n        })\n      }\n    })\n  }\n\n  // console.log('----------------------------------UPDATE CLUSTER DONE----------------------------------')\n  return newData.map(({ zoomLevels }) => zoomLevels)\n}\n\nfunction filterData (clusteredData, filterBounds, newZ) {\n  // console.log('----------------------------------FILTER CLUSTER----------------------------------', { clusteredData, filterBounds, newZ })\n\n  return clusteredData\n    // Filter out anything not relevant to this zoom level\n    .filter(d => !!d[newZ])\n    // Restructure the object to be a little more JSON-friendly\n    .reduce((acc, zoomLevels) => {\n      const geoJSON = zoomLevels[newZ]\n      const coords = geoJSON.geometry.coordinates\n      const { count } = geoJSON.properties\n\n      if (!filterBounds || filterBounds.length < 4 || (\n        filterBounds[0] < coords[0] && filterBounds[1] < coords[1] &&\n        filterBounds[2] > coords[0] && filterBounds[3] > coords[1]\n      )) {\n        if (count > 1) acc.cluster.push(geoJSON)\n        else acc.single.push(geoJSON)\n      }\n      return acc\n    }, {\n      single: [],\n      cluster: []\n    })\n}\n","export default theme => ({\n  root: {\n    position: 'relative',\n    height: '100%',\n    '& .myPosMarker': {\n      zIndex: 1\n    },\n    '& .singleMarker': {\n      zIndex: 3\n    },\n    '& .clusterMarker': {\n      zIndex: 2\n    }\n  },\n  fab: {\n    background: theme.palette.secondary.main,\n    color: theme.palette.secondary.contrastText\n  },\n  topBar: {\n    position: 'absolute',\n    zIndex: 1000,\n    top: 0\n  },\n  loadingWrapper: {\n    position: 'absolute',\n    color: theme.palette.text.primary,\n    opacity: 0.5,\n    zIndex: 3000,\n    textAlign: 'center',\n    top: '50%',\n    left: '50%',\n    transform: 'translateY(-50%) translateX(-50%)'\n  },\n  zoomOutFab: {\n    margin: theme.spacing(0.5),\n    padding: theme.spacing(0.5),\n    border: '2px solid',\n    borderRadius: theme.spacing(1),\n    background: theme.palette.common.white,\n    fontSize: 20,\n    position: 'absolute',\n    zIndex: 100,\n    bottom: theme.spacing(2),\n    right: theme.spacing(10)\n  },\n  selectedPopup: {\n    // padding: theme.spacing(0, 1, 0, 1),\n    width: '90%',\n    maxWidth: 400,\n    zIndex: 2000,\n    position: 'absolute',\n    bottom: theme.spacing(1),\n    left: '50%',\n    transformOrigin: '0% 50%',\n    transform: 'translateY(0%) translateX(-50%)'\n  }\n})\n","import React from 'react'\nimport createSvgIcon from '@material-ui/icons/utils/createSvgIcon'\n\nexport default createSvgIcon(\n  <React.Fragment>\n    <path d='M16.432,6.104c-2.671,-1.06 -6.842,4.123 -6.572,5.826c-3.78,-7.611 2.788,-8.409 3.682,-10.699c0.64,1.255 5.18,2.608 2.89,4.873Z' />\n    <path d='M9.159,5.228c-2.254,1.782 0.149,7.986 1.76,8.604c-8.482,-0.532 -5.889,-6.619 -7.425,-8.538c1.407,0.073 4.848,-3.183 5.665,-0.066Z' />\n    <path d='M4.727,11.059c0.417,2.844 6.991,3.864 8.331,2.779c-4.701,7.079 -8.676,1.79 -11.106,2.161c0.766,-1.183 -0.332,-5.791 2.775,-4.94Z' />\n    <path d='M7.561,17.813c2.671,1.061 6.842,-4.122 6.572,-5.826c3.781,7.611 -2.788,8.409 -3.681,10.699c-0.641,-1.255 -5.181,-2.607 -2.891,-4.873Z' />\n    <path d='M14.828,18.736c2.254,-1.783 -0.149,-7.987 -1.76,-8.605c8.482,0.532 5.889,6.619 7.425,8.538c-1.407,-0.072 -4.849,3.183 -5.665,0.067Z' />\n    <path d='M19.26,12.904c-0.417,-2.843 -6.991,-3.864 -8.331,-2.778c4.701,-7.08 8.676,-1.791 11.106,-2.162c-0.767,1.183 0.332,5.791 -2.775,4.94Z' />\n  </React.Fragment>, 'AppLogoSimple')\n","import React, { useContext } from 'react'\nimport PropTypes from 'prop-types'\nimport { makeStyles } from '@material-ui/core/styles'\nimport SwipeableDrawer from '@material-ui/core/SwipeableDrawer'\nimport Avatar from '@material-ui/core/Avatar'\n\nimport List from '@material-ui/core/List'\nimport Divider from '@material-ui/core/Divider'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemIcon from '@material-ui/core/ListItemIcon'\nimport ListItemText from '@material-ui/core/ListItemText'\nimport CloudDownload from '@material-ui/icons/CloudDownload'\nimport { AppContext } from '../contexts'\n\nimport ExitToAppIcon from '@material-ui/icons/ExitToApp'\nimport QRCodeIcon from '../icons/QRCode'\nimport AccountCircleIcon from '@material-ui/icons/AccountCircle'\n\nconst useStyles = makeStyles(theme => ({\n  drawerInner: {\n    width: 250,\n    display: 'flex',\n    flexDirection: 'column',\n    height: '100%'\n  },\n  avatar: {\n    height: theme.spacing(7),\n    width: theme.spacing(7),\n    border: `3px solid ${theme.palette.primary.main}`,\n    margin: theme.spacing(0, 1)\n  },\n  gravatarImg: {\n    width: '100%'\n  },\n  spacer: {\n    flexGrow: 1\n  },\n  fullList: {\n    width: 'auto'\n  }\n}))\n\nconst SideDrawer = ({ open, onOpen, onClose }) => {\n  const classes = useStyles()\n  const { signOut, signedIn, forceSignIn, user, onQRClick, addToHomeScreen } = useContext(AppContext)\n  return (\n    <SwipeableDrawer\n      open={open}\n      onClose={onClose}\n      onOpen={onOpen}\n    >\n      <div\n        className={classes.drawerInner}\n        role='presentation'\n        onClick={onClose}\n        onKeyDown={onClose}\n      >\n        {user && user.username && (\n          <List>\n            <ListItem className={classes.root} onClick={() => {}} disableGutters>\n              <Avatar className={classes.avatar}>\n                {signedIn && user\n                  ? <img alt='profile' className={classes.gravatarImg} src={user.gravatar} />\n                  : <AccountCircleIcon color='inherit' className={classes.loginButton} />\n                }\n              </Avatar>\n            </ListItem>\n            <ListItem className={classes.root} onClick={() => {}}>\n              <ListItemText\n                primary={user.username}\n              />\n            </ListItem>\n          </List>\n\n        )}\n        <Divider />\n        <List>\n          <ListItem button onClick={onQRClick}>\n            <ListItemIcon>\n              <QRCodeIcon />\n            </ListItemIcon>\n            <ListItemText primary={'Scan QR Code'} />\n          </ListItem>\n          {addToHomeScreen && (\n            <ListItem button onClick={addToHomeScreen}>\n              <ListItemIcon>\n                <CloudDownload />\n              </ListItemIcon>\n              <ListItemText primary={'Install this app'} secondary={'It works better!'} />\n            </ListItem>\n          )}\n        </List>\n        <div className={classes.spacer} />\n        <Divider />\n        <List>\n          {signedIn\n            ? (\n              <ListItem button onClick={signOut}>\n                <ListItemIcon>\n                  <ExitToAppIcon />\n                </ListItemIcon>\n                <ListItemText primary={'Sign Out'} />\n              </ListItem>\n            )\n            : (\n              <ListItem button onClick={forceSignIn}>\n                <ListItemIcon>\n                  <AccountCircleIcon />\n                </ListItemIcon>\n                <ListItemText primary={'Sign In'} />\n              </ListItem>\n            )}\n\n        </List>\n      </div>\n    </SwipeableDrawer>\n  )\n}\n\nSideDrawer.propTypes = {\n  open: PropTypes.bool,\n  onOpen: PropTypes.func,\n  onClose: PropTypes.func\n}\n\nexport default SideDrawer\n\n//         {/*\n// <ContextMenu\n//             anchorEl={contextEl}\n//             onClose={() => setContextEl(null)}\n//             menuItems={[\n//               ...finalMenuItems,\n//               {\n//                 text: 'Sign Out',\n//                 icon: ExitToAppIcon,\n//                 action: signOut\n//               }\n//             ]}\n\n//                       {!signedIn && (\n//             <IconButton\n//               color='inherit'\n//               className={classes.iconButton}\n//               aria-label='Menu'\n//               onClick={forceSignIn}\n//             >\n//               <AccountCircleIcon color='inherit' className={classes.loginButton} />\n//             </IconButton>\n//           )}\n//           /> */}\n","import React, { useState, useContext } from 'react'\nimport classNames from 'classnames'\nimport PropTypes from 'prop-types'\n\nimport Toolbar from '@material-ui/core/Toolbar'\nimport AppBar from '@material-ui/core/AppBar'\nimport IconButton from '@material-ui/core/IconButton'\nimport AppLogoSimple from '../icons/AppLogoSimple'\nimport { AppContext } from '../contexts'\n\nimport QRCodeIcon from '../icons/QRCode'\nimport SideDrawer from './SideDrawer'\n\n// import MenuIcon from '@material-ui/core/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { ThemeProvider } from '@material-ui/styles'\nimport themes from '../themes'\n\nconst style = theme => ({\n  root: {\n    display: 'flex',\n    alignItems: 'center',\n    width: '100%',\n    padding: theme.spacing(0, 1),\n    backgroundColor: theme.palette.primary.main,\n    color: theme.palette.primary.contrastText,\n    borderBottom: `2px solid ${theme.palette.primary}`,\n    background: `linear-gradient(90deg, ${theme.palette.secondary.main} 0%, ${theme.palette.primary.main} 100%)`\n  },\n  searchIcon: {\n    opacity: 0.3,\n    marginRight: theme.spacing(1)\n  },\n  transparent: {\n    backgroundColor: 'transparent',\n    background: 'none',\n    color: theme.palette.text.primary\n    // borderBottom: `2px transparent`\n  },\n  logo: {\n    padding: theme.spacing(0, 0),\n    height: 40,\n    width: 40\n  },\n  transparentLogo: {\n    background: `linear-gradient(90deg, ${theme.palette.secondary.main} 0%, ${theme.palette.primary.main} 100%)`,\n    padding: theme.spacing(0.5, 0.5)\n  },\n  transparentLogoIcon: {\n    color: 'white',\n    height: 35,\n    width: 35\n  },\n  children: {\n    flexGrow: 1,\n    padding: theme.spacing(0, 1)\n  },\n  qrButton: {\n    padding: theme.spacing(0, 0)\n  },\n  qrButtonTransparent: {\n    background: 'white',\n    padding: theme.spacing(0.5, 0.5)\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst TopBar = ({ className, children, isTransparent, menuItems, hideLogo }) => {\n  const classes = useStyles()\n  const [drawerOpen, setDrawerOpen] = useState(false)\n  const { onQRClick } = useContext(AppContext)\n\n  return (\n    <React.Fragment>\n      <AppBar position='static'>\n        <Toolbar className={classNames(classes.root, className, isTransparent ? classes.transparent : null)} disableGutters>\n          {!hideLogo && (\n            <IconButton\n              className={isTransparent ? classes.transparentLogo : classes.logo}\n              color='inherit'\n              onClick={() => setDrawerOpen(true)}\n            >\n              <AppLogoSimple className={isTransparent ? classes.transparentLogoIcon : classes.logo} />\n            </IconButton>\n          )}\n          <div className={classes.children}>\n            {children}\n          </div>\n          <IconButton\n            color='inherit'\n            className={isTransparent ? classes.qrButtonTransparent : classes.qrButton}\n            aria-label='Menu'\n            onClick={onQRClick}\n          >\n            <QRCodeIcon color='inherit' />\n          </IconButton>\n        </Toolbar>\n      </AppBar>\n      <SideDrawer\n        open={drawerOpen}\n        onClose={() => setDrawerOpen(false)}\n        onOpen={() => setDrawerOpen(true)}\n      />\n    </React.Fragment>\n  )\n}\n\nTopBar.propTypes = {\n  className: PropTypes.string,\n  children: PropTypes.any,\n  isTransparent: PropTypes.bool,\n  hideLogo: PropTypes.bool,\n  menuItems: PropTypes.arrayOf(PropTypes.shape({\n    callback: PropTypes.func,\n    text: PropTypes.string,\n    icon: PropTypes.any,\n    color: PropTypes.string\n  }))\n}\n\nexport default (props) => <ThemeProvider theme={themes.topbar}><TopBar {...props} /></ThemeProvider>\n","import React, { useRef, useLayoutEffect, useCallback } from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport { fade } from '@material-ui/core/styles/colorManipulator'\nimport InputBase from '@material-ui/core/InputBase'\n\nimport SearchIcon from '@material-ui/icons/Search'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { debounce } from '../../lib/util'\n\nconst useSearchBarStyles = makeStyles(theme => ({\n  root: {\n    position: 'relative',\n    borderRadius: theme.shape.borderRadius,\n    backgroundColor: fade(theme.palette.common.white, 0.3),\n    '&:hover': {\n      backgroundColor: fade(theme.palette.common.white, 0.5)\n    },\n    marginRight: theme.spacing(2),\n    marginLeft: 0,\n    width: '100%',\n    [theme.breakpoints.up('sm')]: {\n      marginLeft: theme.spacing(3),\n      width: 'auto'\n    }\n  },\n  transparent: {\n    backgroundColor: fade(theme.palette.common.white, 0.7),\n    '&:hover': {\n      backgroundColor: fade(theme.palette.common.white, 0.9)\n    }\n  },\n  inputRoot: {\n    color: 'inherit',\n    width: '100%'\n  },\n  inputInput: {\n    padding: theme.spacing(1, 1, 1, 4),\n    transition: theme.transitions.create('width'),\n    width: '100%',\n    [theme.breakpoints.up('md')]: {\n      width: 200\n    }\n  },\n  searchIcon: {\n    width: theme.spacing(4),\n    height: '100%',\n    position: 'absolute',\n    pointerEvents: 'none',\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center'\n  }\n}))\n\n/**\n *\n */\nexport const SearchInput = ({ autoFocus, disabled, onChange, onClick, defaultValue, isTransparent }) => {\n  const inputRef = useRef()\n  const classes = useSearchBarStyles()\n\n  const debounceSearchText = useCallback(\n    debounce(onChange, 500),\n    [onChange]\n  )\n\n  useLayoutEffect(() => {\n    if (inputRef.current && !autoFocus) {\n      console.log('Setting blur')\n      inputRef.current.blur()\n    }\n  }, [autoFocus])\n  return (\n    <div className={classNames(classes.root, isTransparent ? classes.transparent : null)} onClick={onClick}>\n      <div className={classes.searchIcon}>\n        <SearchIcon />\n      </div>\n      <InputBase\n        autoFocus={!disabled && autoFocus}\n        inputProps={{\n          onBlur: () => {\n            // console.log('onBlur')\n            // inputRef.current.focus()\n          }\n        }}\n        onChange={(e) => {\n          // console.log('onChange', e.target.value)\n          debounceSearchText(e.target.value)\n        }}\n        placeholder='Search…'\n        disabled={disabled}\n        defaultValue={defaultValue}\n\n        inputRef={inputRef}\n        classes={{\n          root: classes.inputRoot,\n          input: classes.inputInput\n        }}\n      />\n    </div>\n  )\n}\n\nSearchInput.propTypes = {\n  autoFocus: PropTypes.bool,\n  isTransparent: PropTypes.bool,\n  disabled: PropTypes.bool,\n  onChange: PropTypes.func,\n  defaultValue: PropTypes.string,\n  onClick: PropTypes.func\n}\n\nexport default SearchInput\n","import React, { useContext } from 'react'\nimport PropTypes from 'prop-types'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemText from '@material-ui/core/ListItemText'\nimport List from '@material-ui/core/List'\nimport classNames from 'classnames'\nimport Typography from '@material-ui/core/Typography'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { formatDate } from '../../lib/datelib'\n\nimport { ACCESS } from '../../config'\nimport { AppContext } from '../../contexts'\n\nconst style = theme => ({\n  root: {\n    margin: 0,\n    padding: theme.spacing(1)\n  },\n  chipContainer: {\n    display: 'flex',\n    width: '100%'\n  },\n  grow: { flexGrow: 1 },\n  accessLabel: {\n    padding: theme.spacing(0.5, 0.5)\n  },\n  accessPUBLIC: {\n    color: 'white',\n    background: ACCESS.PUBLIC.color[900]\n  },\n  accessPRIVATE: {\n    color: 'white',\n    background: ACCESS.PRIVATE.color[900]\n  },\n  accessOPEN: {\n    color: 'white',\n    background: ACCESS.OPEN.color[900]\n  },\n  img: {\n    verticalAlign: 'top',\n    objectFit: 'cover',\n    height: '100%',\n    width: '100%'\n  },\n  text: {\n    height: '115px',\n    margin: 0,\n    padding: theme.spacing(0, 1),\n    alignSelf: 'flex-start',\n    display: 'flex',\n    flexDirection: 'column'\n  },\n  titleText: {\n    textOverflow: 'ellipsis',\n    whiteSpace: 'nowrap',\n    overflow: 'hidden'\n  },\n  dateContainer: {\n    display: 'flex'\n  },\n  dateLabel: {\n    fontWeight: 'bold',\n    flex: '1 1 50px'\n  },\n  dateText: {\n\n  },\n  imgFiller: {\n    flexGrow: 1,\n    background: theme.palette.text.primary\n  },\n  imgContainer: {\n    flex: '0 0 115px',\n    alignSelf: 'flex-start',\n    height: '100%',\n    minHeight: 115,\n    display: 'flex',\n    flexDirection: 'column'\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst SeriesListItem = ({ series, loading, onClick, children, showCreatedOn, showLastPhoto }) => {\n  const classes = useStyles()\n  const { seriesConfig } = useContext(AppContext)\n  if (loading || !series) return 'LOADING...'\n  let thumb = null\n  let accessLabel = ACCESS.PRIVATE.label\n  try {\n    thumb = seriesConfig.getPhotoUrl(series.featured, 'thumb')\n    accessLabel = series.access ? ACCESS[series.access].label : ACCESS.PRIVATE.label\n  }\n  catch (e) {\n    console.error(e)\n  }\n  return (\n    <ListItem className={classes.root} button component='div' disableGutters>\n      <div className={classes.imgContainer} >\n        <div className={classes.imgFiller}>\n          <img alt='thumbnail' src={thumb} className={classes.img} onClick={onClick} />\n        </div>\n        {series.access && (\n          <Typography className={classNames(classes.accessLabel, classes[`access${series.access}`])}\n            variant='caption'\n            component='div'\n          >\n            {`${series.photoCount || 0} Photos`} <em>({accessLabel})</em>\n          </Typography>\n        )}\n      </div>\n      <ListItemText className={classes.text} disableTypography onClick={onClick}>\n        <Typography variant='body1' component='div' className={classes.titleText}>\n          {series.name || loading}\n        </Typography>\n        <Typography variant='body2' component='div'>\n          <strong>Created by:</strong> {series.createdUser.username}\n        </Typography>\n        <div className={classes.grow} />\n        {showCreatedOn && <div className={classes.dateContainer}>\n          <Typography variant='caption' className={classes.dateLabel}>Created:</Typography>\n          <Typography variant='caption' className={classes.dateText}>{formatDate(series.createdOn, 'lll')}</Typography>\n        </div>}\n        {showLastPhoto && <div className={classes.dateContainer}>\n          <Typography variant='caption' className={classes.dateLabel}>Last Photo:</Typography>\n          <Typography variant='caption' className={classes.dateText}>{formatDate(series.latest.takenOn, 'lll')}</Typography>\n        </div>}\n      </ListItemText>\n      {/*  <TinyChip label='Watching' color='secondary' /> */}\n      {children}\n    </ListItem>\n  )\n}\n\nSeriesListItem.propTypes = {\n  series: PropTypes.object,\n  loading: PropTypes.bool,\n  showCreatedOn: PropTypes.bool,\n  showLastPhoto: PropTypes.bool,\n  onClick: PropTypes.func,\n  children: PropTypes.array\n}\n\nexport default SeriesListItem\n\n// const useCosmosStyles = makeStyles(theme => ({\n//   root: {\n\n//   }\n// }))\n\nexport const SeriesListItemCosmos = (props) => {\n  // const classes = useCosmosStyles()\n  return (\n    <List disablePadding dense>\n      <SeriesListItem {...props} />\n    </List>\n  )\n}\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemText from '@material-ui/core/ListItemText'\nimport List from '@material-ui/core/List'\n// import IconButton from '@material-ui/core/IconButton'\n// import ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction'\nimport ZoomOutMapIcon from '@material-ui/icons/ZoomOutMap'\n// import CancelIcon from '@material-ui/icons/Cancel'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { ListItemIcon } from '@material-ui/core'\n\nconst style = theme => ({\n  root: {\n\n  }\n})\n\nconst useStyles = makeStyles(style)\n\nconst ClusterSelected = ({ seriesCount, reducedPhotoCount, onZoomTo, onClose }) => {\n  const classes = useStyles()\n  console.log('cluster selected', { seriesCount, reducedPhotoCount })\n  return (\n    <List>\n      <ListItem className={classes.root}>\n        <ListItemIcon onClick={onZoomTo}>\n          <ZoomOutMapIcon />\n        </ListItemIcon>\n        <ListItemText\n          onClick={onZoomTo}\n          primary={`${seriesCount} Photo series`}\n          secondary={`containing ${reducedPhotoCount} individual photo${reducedPhotoCount === 1 ? '' : 's'}`}\n        />\n        {/* <ListItemSecondaryAction>\n          <IconButton aria-label='Close' onClick={onClose}>\n            <CancelIcon />\n          </IconButton>\n        </ListItemSecondaryAction> */}\n\n      </ListItem>\n    </List>\n  )\n}\n\nClusterSelected.propTypes = {\n  seriesCount: PropTypes.number.isRequired,\n  reducedPhotoCount: PropTypes.number.isRequired,\n  onZoomTo: PropTypes.func.isRequired,\n  onClose: PropTypes.func.isRequired\n}\n\nexport default ClusterSelected\n","import React from 'react'\nimport classNames from 'classnames'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport Badge from '@material-ui/core/Badge'\nimport Avatar from '@material-ui/core/Avatar'\nimport Camera from '@material-ui/icons/Camera'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { ACCESS } from '../../../config'\n\nconst style = theme => ({\n  root: {\n    color: theme.palette.primary.main,\n    width: 150,\n    position: 'absolute',\n    top: '50%',\n    left: '50%',\n    textAlign: 'center',\n    transformOrigin: '50% 50%',\n    transform: 'translateY(-50%) translateX(-50%)'\n  },\n  rootActive: {\n    zIndex: 1000\n  },\n  icon: {\n    // height: 16,\n    // width: 16\n  },\n  avatar: {\n    position: 'relative',\n    margin: '0 auto',\n    background: 'green',\n    color: 'white',\n    border: '2px solid white',\n    height: 40,\n    width: 40,\n    zIndex: 120,\n    '&.PUBLIC': { background: ACCESS.PUBLIC.color },\n    '&.PRIVATE': { background: ACCESS.PRIVATE.color },\n    '&.OPEN': { background: ACCESS.OPEN.color }\n  },\n  avatarActive: {\n    background: '#FFFF00',\n    color: 'black',\n    border: `2px solid black`,\n    '&.PUBLIC': { background: '#FFFF00' },\n    '&.PRIVATE': { background: '#FFFF00' },\n    '&.OPEN': { background: '#FFFF00' }\n  },\n  badge: {\n    zIndex: 124,\n    color: theme.palette.secondary.contrastText,\n    background: theme.palette.secondary.main,\n    transform: 'scale(1) translate(30%, -30%)'\n  },\n  badgeActive: {\n    color: theme.palette.primary.contrastText,\n    background: theme.palette.primary.main\n  },\n  directionIndicator: {\n    position: 'absolute',\n    top: 20,\n    left: '50%',\n    // transformOrigin: '50% 50%',\n    // transform: 'translateY(-50%) translateX(-50%)',\n    zIndex: 100\n  },\n  name: {\n    color: 'white',\n    fontWeight: 'bold',\n    textShadow: `\n        0px 0px 4px #000000, \n        0px 0px 4px #000000 \n    `,\n    zIndex: 122,\n    position: 'relative'\n    // textStroke: '1px white'\n  },\n  nameActive: {\n    color: 'black',\n    textShadow: `\n    0px 0px 2px #FFFFFF, \n    0px 0px 2px #FFFFFF,\n    0px 0px 4px #FFFFFF \n`\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst Single = ({ name, access, onClick, active, photoCount, direction }) => {\n  const classes = useStyles()\n  return (\n    <div className={classNames(classes.root, active ? classes.rootActive : null, access)}>\n      <Badge classes={{ badge: classNames(classes.badge, active ? classes.badgeActive : null, access) }} badgeContent={photoCount}>\n        <Avatar className={classNames(classes.avatar, active ? classes.avatarActive : null, access)} onClick={onClick}>\n          <Camera className={classes.icon} color='inherit' />\n        </Avatar>\n      </Badge>\n      {direction && direction >= 0 ? (\n        <div className={classes.directionIndicator}>\n          <svg className={classes.svgArc}\n            version='1.1'\n            width='100'\n            height='100'\n            viewBox='0, 0, 100, 100'\n            style={{ transform: `translateY(-50%) translateX(-50%) rotateZ(${direction}deg)` }}>\n            <path d='M50,0 C60.946,0.151 72.136,3.514 80.675,10.56 L50,50 L19.325,10.56 C27.938,3.461 39,0.278 50,0 z'\n              fill='#009DC1'\n              fillOpacity='0.444'\n              strokeWidth='1'\n              strokeOpacity='0.6'\n              stroke='#FFFFFF'\n            />\n          </svg>\n        </div>\n      ) : null}\n      <Typography variant='body1' className={classNames(classes.name, active ? classes.nameActive : null)}>\n        {name}\n      </Typography>\n    </div>\n  )\n}\n\nSingle.propTypes = {\n  access: PropTypes.string,\n  name: PropTypes.string,\n  photoCount: PropTypes.number,\n  onClick: PropTypes.func.isRequired,\n  direction: PropTypes.number,\n  active: PropTypes.bool\n}\n\nexport default Single\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport Avatar from '@material-ui/core/Avatar'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport numeral from 'numeral'\n\nconst style = theme => ({\n  avatar: {\n    background: theme.palette.grey[900],\n    border: `2px solid ${theme.palette.grey[100]}`,\n    color: theme.palette.grey[100]\n  },\n  avatarActive: {\n    background: '#FFFF00',\n    border: `2px solid black`,\n    color: 'black',\n    zIndex: 1000\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst Cluster = ({ seriesCount, active, onClick }) => {\n  const classes = useStyles()\n  return (\n    <Avatar onClick={onClick} className={classNames(classes.avatar, active ? classes.avatarActive : null)}>\n      {numeral(seriesCount).format('0,0')}\n    </Avatar>\n  )\n}\n\nCluster.propTypes = {\n  seriesCount: PropTypes.number,\n  onClick: PropTypes.func.isRequired,\n  active: PropTypes.bool\n}\n\nexport default Cluster\n","\nimport React, { useState, useMemo, useRef, useEffect } from 'react'\nimport PropTypes from 'prop-types'\nimport Paper from '@material-ui/core/Paper'\n// import Typography from '@material-ui/core/Typography'\nimport { FlyToInterpolator, LinearInterpolator, Marker } from 'react-map-gl'\nimport { easeCubic } from 'd3-ease'\nimport { CircularProgress } from '@material-ui/core'\nimport MapStyles from '../../mapStyles'\n\nimport BaseMap from './BaseMap'\nimport useClusteredData from '../../lib/useClusteredData'\nimport { bbox, featureCollection, buffer, point } from '@turf/turf'\nimport { makeStyles } from '@material-ui/core/styles'\n// import { debounce } from '../../lib/util'\nimport style from './HomeMap.style'\n\nimport TopBar from '../TopBar'\nimport SearchInput from '../Search/SearchInput'\nimport SeriesListItem from '../misc/SeriesListItem'\nimport ClusterSelected from '../misc/ClusterSelected'\n\nimport SingleMarker from './markers/Single'\nimport ClusterMarker from './markers/Cluster'\n\nconst useStyles = makeStyles(style)\n\nconst defaultView = {\n  zoom: 4,\n  latitude: 44.629701,\n  longitude: -120.333379\n}\n\nconst SIZESCALE = 80\n\nconst HomeMap = ({\n  seriesList, initViewport, loading, activeSeries, queryVersion,\n  onSeriesClick, onSearchClick,\n  popMapHistory, pushMapHistory, clearMapHistory\n}) => {\n  const [mapViewObj, setMapViewObj] = useState({\n    viewport: { ...defaultView, ...initViewport.viewport },\n    bounds: initViewport.bounds,\n    filterBounds: null\n  })\n  // console.log('INITVIEW', initViewport)\n  const classes = useStyles()\n  const mapViewRef = useRef()\n  const [isTransitioning, setIsTransitioning] = useState(false)\n  const homeMapContainerRef = useRef()\n\n  const [currentZoom, setCurrentZoom] = useState(0)\n  const [transitions, setTransitions] = useState(null)\n  const [selectedItem, setSelectedItem] = useState()\n\n  // This custom hook is heavily debounced\n  const { filteredClusteredData } = useClusteredData(\n    seriesList || [],\n    mapViewObj.filterBounds,\n    currentZoom,\n    mapViewObj.viewport,\n    SIZESCALE,\n    queryVersion\n  )\n\n  // If we're coming back to the map with something aleady selected then we need to\n  // reselect the series we had before\n  useEffect(() => {\n    if (!activeSeries || !seriesList || selectedItem) return\n    try {\n      const selected = seriesList.find(s => s.id === activeSeries)\n      // if (selected && homeMapContainerRef.current) setSelectedItem(selected)\n      if (selected && selected.coords) {\n        const bufferPts = buffer(point(selected.coords), 10, { units: 'meters' })\n        const bounds = bbox(bufferPts)\n        setMapViewObj({ ...mapViewObj, bounds })\n      }\n    }\n    catch (e) {\n      console.error(e)\n    }\n  }, [seriesList])\n  // Once we have the zoom in place we might need to select an initial series\n  useEffect(() => {\n    if (!activeSeries || !filteredClusteredData.single || selectedItem) return\n    try {\n      const selected = filteredClusteredData.single.find(s => s.properties.id === activeSeries)\n      if (selected && homeMapContainerRef.current) setSelectedItem(selected)\n    }\n    catch (e) {\n      console.error(e)\n    }\n  }, [filteredClusteredData.single])\n\n  const saveMap = () => {\n    const { latitude, longitude, zoom, bearing, pitch, altitude } = mapViewRef.current ? mapViewRef.current : mapViewObj.viewport\n    setTimeout(() => pushMapHistory({\n      viewport: { latitude, longitude, zoom, bearing, pitch, altitude }\n    }), 2000)\n  }\n  // const saveMapDebounced = debounce(saveMap, 2000)\n\n  const updateSelectedItem = (item) => {\n    // regardless, set the map selected Item\n    setSelectedItem(item)\n    saveMap()\n  }\n\n  const onZoomTo = (object) => {\n    try {\n      const pts = featureCollection(object.properties.points)\n      const bounds = bbox(pts)\n      // buffer a further 10%\n      const lngBuff = (bounds[2] - bounds[0]) * 0.2\n      const latBuff = (bounds[3] - bounds[1]) * 0.2\n      const buffBounds = [\n        bounds[0] - lngBuff,\n        bounds[1] - latBuff,\n        bounds[2] + lngBuff,\n        bounds[3] + latBuff\n      ]\n\n      setTransitions({\n        transitionDuration: 2000,\n        transitionInterpolator: new FlyToInterpolator(),\n        transitionEasing: easeCubic\n      })\n      setMapViewObj({ ...mapViewObj, bounds: buffBounds })\n      if (object.properties.count > 1) setTimeout(() => updateSelectedItem(null), 2000)\n    }\n    catch (e) {\n      console.error(e)\n    }\n  }\n\n  const onViewportChange = ({ viewport, map }) => {\n    mapViewRef.current = viewport\n    // mapViewObj\n    // {\n    //   \"_sw\": {\n    //     \"lng\": -120.40788003760076,\n    //     \"lat\": 44.609051464438835\n    //   },\n    //   \"_ne\": {\n    //     \"lng\": -120.25887796240545,\n    //     \"lat\": 44.65034319161438\n    //   }\n    // minX, minY, maxX, maxY\n    // [W-122.87948116236043, S26.15346805640254, E-82.00799782432676, N47.3795453070757]\n    const viewZoom = Math.floor(viewport.zoom)\n    if (!isTransitioning && map && map.getBounds) {\n      // console.log('onViewportChange', isTransitioning)\n      const { _sw: { lng: minLng, lat: minLat }, _ne: { lng: maxLng, lat: maxLat } } = map.getBounds()\n      const [oldMinLng, oldMinLat, oldMaxLng, oldMaxLat] = mapViewObj.filterBounds || [minLng, minLat, maxLng, maxLat]\n      if (viewZoom !== currentZoom ||\n        oldMinLng >= minLng || oldMinLat >= minLat ||\n        oldMaxLng <= maxLng || oldMaxLat <= maxLat\n      ) {\n        // console.log('RECALCING filterBounds')\n        const filterBounds = [\n          minLng - (maxLng - minLng) / 2,\n          minLat - (maxLat - minLat) / 2,\n          maxLng + (maxLng - minLng) / 2,\n          maxLat + (maxLat - minLat) / 2\n        ]\n        setMapViewObj({ ...mapViewObj, filterBounds })\n      }\n    }\n    if (viewZoom !== currentZoom) {\n      setCurrentZoom(viewZoom)\n    }\n  }\n  // Debounce this to improve performance\n  // const onViewportChangeDebounced = useCallback(debounce(onViewportChange, 300), [])\n\n  const lock = {}\n\n  const onMarkerClick = (obj) => {\n    // Second click zooms\n    if (selectedItem && selectedItem.properties.id === obj.properties.id) {\n      // console.log('onMarkerClick SECOND CLICK')\n      onZoomTo(selectedItem)\n    }\n    else {\n      // console.log('onMarkerClick First click')\n      setTransitions({\n        transitionDuration: 500,\n        transitionInterpolator: new LinearInterpolator(),\n        transitionEasing: easeCubic\n      })\n      setMapViewObj({\n        viewport: {\n          longitude: obj.geometry.coordinates[0],\n          latitude: obj.geometry.coordinates[1]\n        }\n      })\n    }\n    updateSelectedItem(obj)\n  }\n\n  // This one should be debounced by filteredClusteredData\n  const markersRendered = useMemo(() => ([\n    ...filteredClusteredData.single.map(obj => (\n      <Marker\n        className={'singleMarker'}\n        key={`single-${obj.properties.id}`}\n        latitude={obj.geometry.coordinates[1]}\n        longitude={obj.geometry.coordinates[0]}\n        offsetLeft={0}\n        offsetTop={-20}\n      >\n        <SingleMarker name={obj.properties.name}\n          access={obj.properties.access}\n          photoCount={obj.properties.photoCount}\n          onClick={() => onMarkerClick(obj)}\n          direction={currentZoom > 10 && obj.properties.direction ? obj.properties.direction : null}\n          active={selectedItem && selectedItem.properties.id === obj.properties.id}\n        />\n      </Marker>\n    )),\n    ...filteredClusteredData.cluster.map(obj => (\n      <Marker\n        className='clusterMarker'\n        key={`cluster-${obj.properties.id}`}\n        latitude={obj.geometry.coordinates[1]}\n        longitude={obj.geometry.coordinates[0]}\n        offsetLeft={-20}\n        offsetTop={-20}\n      >\n        <ClusterMarker\n          seriesCount={obj.properties.count}\n          photoCount={obj.properties.reducedPhotoCount}\n          onClick={() => onMarkerClick(obj)}\n          active={\n            selectedItem &&\n            selectedItem.properties.id === obj.properties.id &&\n            selectedItem.properties.count === obj.properties.count\n          }\n        />\n      </Marker>\n    ))\n  ]), [filteredClusteredData, selectedItem])\n\n  const selectedItemRender = useMemo(() => !!selectedItem && (\n    <Paper className={classes.selectedPopup}>\n      {selectedItem.properties.count === 1\n        ? <SeriesListItem\n          series={selectedItem.properties}\n          showCreatedOn\n          showLastPhoto\n          onClick={() => onSeriesClick(selectedItem.properties.id)}\n        />\n        : <ClusterSelected\n          seriesCount={selectedItem.properties.count}\n          reducedPhotoCount={selectedItem.properties.reducedPhotoCount}\n          onClose={() => updateSelectedItem(null)}\n          onZoomTo={() => onZoomTo(selectedItem)}\n        />\n      }\n    </Paper>\n  ), [selectedItem])\n\n  return (\n    <div className={classes.root} ref={homeMapContainerRef}>\n      <TopBar isTransparent className={classes.topBar}>\n        <SearchInput\n          isTransparent\n          onClick={onSearchClick}\n          defaultValue={''}\n        />\n      </TopBar>\n      {loading && (\n        <div className={classes.loadingWrapper}>\n          <CircularProgress size={80} thickness={7} color='inherit' />\n          {/* <Typography variant='h3' color='inherit'>Loading...</Typography> */}\n        </div>\n      )}\n\n      <BaseMap\n        showMe\n        // This should only change on INIT or transition events\n        viewport={mapViewObj.viewport}\n        transitions={transitions}\n        mapStyles={MapStyles}\n        controlPadding={{ top: 56 }}\n        initStyle={MapStyles.length > 1 ? 1 : 0}\n        {...lock}\n        onTransitionStart={() => {\n          // console.log('handletransitionStart')\n          setIsTransitioning(true)\n        }}\n        onTransitionEnd={() => {\n          // console.log('handletransitionEnd')\n          setIsTransitioning(false)\n          setTransitions(null)\n        }}\n        bounds={mapViewObj.bounds}\n        maxZoom={20}\n        minZoom={1}\n        onViewportChange={onViewportChange}\n        onNativeClick={() => {\n          if (selectedItem) updateSelectedItem(null)\n        }}\n      >\n        {markersRendered}\n      </BaseMap>\n\n      {selectedItemRender}\n    </div>\n  )\n}\n\nHomeMap.propTypes = {\n  seriesList: PropTypes.array,\n  queryVersion: PropTypes.number,\n  activeSeries: PropTypes.string,\n  initViewport: PropTypes.object,\n  loading: PropTypes.bool,\n  // These all get loaded up through mapFuncs in HomeMap.connect\n  onSearchClick: PropTypes.func,\n  onSeriesClick: PropTypes.func,\n  popMapHistory: PropTypes.func,\n  pushMapHistory: PropTypes.func,\n  clearMapHistory: PropTypes.func\n}\n\nexport default HomeMap\n\n// function getInitialState (initViewport) {\n//   return {\n//     viewport: { ...defaultView, ...initViewport.viewport },\n//     bounds: initViewport.bounds,\n//     filterBounds: null\n//   }\n// }\n","import React, { useEffect, useState, useRef, useMemo } from 'react'\nimport PropTypes from 'prop-types'\nimport { connect } from 'react-redux'\nimport { graphql } from 'react-apollo'\nimport { allSeries, pollQuery } from './queries'\nimport actions from '../redux/actions'\nimport { home } from '../config'\nimport HomeMap from '../components/maps/HomeMap'\n\nconst POLL_INTERVAL = 5 // (seconds)\n\n/**\n * The outer component handles the lastCheck variable which, when changed will\n * cause the poll event\n */\nconst HomeMapConnector = ({ initViewport, activeSeries, mapFuncs }) => {\n  const [seriesProps, setSeriesProps] = useState()\n  const [queryVersion, setVersion] = useState(0)\n  const updateIncrement = () => setVersion(queryVersion + 1)\n  const timerRef = useRef()\n  const [lastCheck, setLastCheck] = useState(null)\n  timerRef.current = lastCheck\n\n  // These are expensive queries so we render them memoized to prevent erroneous re-renders\n  const allSeriesQUERY = useMemo(() => <AllSeriesConnect setSeriesProps={setSeriesProps} />, [])\n  const pollSeriesQUERY = useMemo(() => <PollQueryConnect lastCheck={lastCheck} seriesProps={seriesProps} updateIncrement={updateIncrement} />, [lastCheck])\n\n  // Initiate the polling process. We simply update the timestamp every N seconds\n  useEffect(() => {\n    if (!seriesProps) return\n    function ping () {\n      if (timerRef.current) setLastCheck(String(Date.now() - POLL_INTERVAL * 1000))\n    }\n    if (!timerRef.current && seriesProps.readyForPolling) timerRef.current = setInterval(ping, POLL_INTERVAL * 1000)\n    return () => {\n      if (timerRef.current) {\n        console.log('clear poll timer')\n        clearInterval(timerRef.current)\n        timerRef.current = null\n      }\n    }\n  }, [seriesProps])\n\n  return (\n    <React.Fragment>\n      {allSeriesQUERY}\n      {pollSeriesQUERY}\n      <HomeMap\n        queryVersion={queryVersion}\n        seriesList={seriesProps && seriesProps.allSeries ? seriesProps.allSeries.seriesSummaries : []}\n        activeSeries={activeSeries}\n        initViewport={initViewport}\n        loading={seriesProps && seriesProps.loading}\n        {...mapFuncs}\n      />\n    </React.Fragment>\n  )\n}\nHomeMapConnector.propTypes = {\n  activeSeries: PropTypes.string, // from redux\n  initViewport: PropTypes.object, // from redux\n  mapFuncs: PropTypes.object // from redux passed straight through to the map\n\n}\n\nconst withAllSeries = graphql(allSeries, {\n  props: ({ data, ownProps }) => {\n    // If there's more data to load we should go get another batch\n    if (!data.loading && !data.error && data.allSeries && data.allSeries.seriesSummaries.length > 0 && data.allSeries.nextToken) {\n      data.fetchMore({\n        variables: { ...data.variables, nextToken: data.allSeries.nextToken },\n        // How do we mush the new query with the old one\n        updateQuery: (prev, { fetchMoreResult }) => {\n          return {\n            allSeries: {\n              ...fetchMoreResult.allSeries,\n              seriesSummaries: [ ...prev.allSeries.seriesSummaries, ...fetchMoreResult.allSeries.seriesSummaries ]\n            }\n          }\n        }\n      })\n    }\n    else if (data.loading || data.error) {\n      ownProps.setSeriesProps(data)\n    }\n    else {\n      ownProps.setSeriesProps({ ...data, readyForPolling: true })\n    }\n    return null\n  },\n  options: {\n    variables: { limit: 100 }\n  }\n})\n\n/**\n * Here's the graphql HOC that gets an individual series\n */\nconst withPollQuery = graphql(pollQuery, {\n  skip: ({ lastCheck }) => !lastCheck,\n  props: ({ data, ownProps: { seriesProps, updateIncrement } }) => {\n    if (data.error) {\n      console.log('POLL FAIL', data.error, data)\n      console.error(data.error)\n    }\n    if (!data.loading && data.changedSeries && data.changedSeries.seriesSummaries) {\n      // console.log('POLLING', { data, seriesProps })\n      const newData = data.changedSeries.seriesSummaries\n      const oldList = seriesProps.allSeries.seriesSummaries\n\n      // If the polling has begun and we have some good polling data back then\n      // Process it and decide if we need to incorporate it\n      if (data.changedSeries) {\n        let newSeriesSummaries = seriesProps.allSeries.seriesSummaries\n        newData.forEach(({ seriesStatus, ...polledSeries }) => {\n          if (seriesStatus === 'deleted') {\n            console.log('Polling found a series to delete: ', polledSeries.id)\n            newSeriesSummaries = oldList.filter(s => s.id !== polledSeries.id)\n          }\n          else {\n            const idx = oldList.findIndex(ds => ds.id === polledSeries.id)\n            if (idx >= 0) {\n              console.log('Polling found a series to Update: ', polledSeries.id)\n              newSeriesSummaries = oldList.map((oldSeries, oldId) => oldId === idx ? polledSeries : oldSeries)\n            }\n            else {\n              console.log('Polling found a series to add: ', polledSeries.id)\n              newSeriesSummaries = [...oldList, polledSeries]\n            }\n          }\n          seriesProps.updateQuery((data, options) => {\n            try {\n              const newData = { ...data }\n              newData.allSeries.seriesSummaries = newSeriesSummaries\n              updateIncrement()\n              return data\n            }\n            catch (e) {\n              console.error(e)\n              return data\n            }\n          })\n        })\n      }\n    }\n    return null\n  },\n  options: ({ lastCheck }) => ({\n    variables: {\n      limit: 100,\n      lastCheck\n    }\n  })\n})\n\n// We're using graphql() HOC because it's convenient but it doesn't need to render anything\nconst AllSeriesConnect = withAllSeries(() => null)\nconst PollQueryConnect = withPollQuery(() => null)\n\n// The only part of the state the main view caes about is teh window\nconst mapStateToProps = (state, props) => {\n  const { current: { activeSeries } } = state.home\n  const initViewport = state.map.slice(-1).pop()\n  return { activeSeries, initViewport }\n}\n\n// There are a few presentational actions the main window can use\nconst mapDispatchToProps = dispatch => ({\n  mapFuncs: {\n    onSeriesClick: (activeSeries) => {\n      dispatch(actions.setHomeState(home.AppStateTypes.SERIES, { activeSeries }))\n    },\n    onSearchClick: () => {\n      dispatch(actions.setHomeState(home.AppStateTypes.SEARCH, { search: { tab: home.SEARCH_TABS.LOCATION, text: '' } }))\n    },\n    popMapHistory: () => {\n      dispatch(actions.popMapHistory())\n    },\n    pushMapHistory: (viewportSave) => {\n      dispatch(actions.pushMapHistory(viewportSave))\n    },\n    clearMapHistory: () => {\n      dispatch(actions.clearMapHistory())\n    }\n  }\n})\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(HomeMapConnector)\n","import React from 'react'\nimport classNames from 'classnames'\nimport PropTypes from 'prop-types'\nimport List from '@material-ui/core/List'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemAvatar from '@material-ui/core/ListItemAvatar'\nimport ListItemText from '@material-ui/core/ListItemText'\nimport ListItemIcon from '@material-ui/core/ListItemIcon'\nimport IconButton from '@material-ui/core/IconButton'\nimport Avatar from '@material-ui/core/Avatar'\n\nimport PlaceIcon from '@material-ui/icons/Place'\nimport PersonIcon from '@material-ui/icons/Person'\nimport LabelIcon from '@material-ui/icons/Label'\nimport CancelIcon from '@material-ui/icons/Cancel'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport { Typography } from '@material-ui/core'\nconst useStyles = makeStyles(theme => ({\n  root: {\n\n  },\n  chosenItem: {\n    color: theme.palette.primary.contrastText,\n    background: theme.palette.primary.dark\n  },\n  avatar: {\n    background: theme.palette.primary.main\n  },\n  closeIcon: {\n    color: theme.palette.primary.contrastText,\n    paddingRight: 0\n  },\n  avatarImg: {\n    height: '100%',\n    width: '100%',\n    objectFit: 'cover'\n  }\n}))\n\nconst SearchContextItem = ({ className, variant, name, description, gravatar, onClick, onCancel }) => {\n  const classes = useStyles()\n  let TheIcon = PlaceIcon\n\n  const getAvatar = (src) => () => (\n    <Avatar className={classes.avatar}>\n      <img className={classes.avatarImg} alt='profile' src={src} />\n    </Avatar>\n  )\n\n  switch (variant) {\n    case 'tag':\n      TheIcon = LabelIcon\n      break\n    case 'location':\n      TheIcon = PlaceIcon\n      break\n    case 'user':\n      TheIcon = gravatar ? getAvatar(gravatar) : PersonIcon\n      break\n    default:\n      break\n  }\n  return (\n    <ListItem\n      className={classNames(className, classes.root, onCancel ? classes.chosenItem : null)}\n      button={!!onClick}\n      onClick={onClick}\n    >\n      <ListItemAvatar>\n        <Avatar className={classes.avatar}>\n          <TheIcon color='inherit' />\n        </Avatar>\n      </ListItemAvatar>\n      <ListItemText disableTypography>\n        <Typography variant='body1' color='inherit'>{name}</Typography>\n        <Typography variant='body2' color='inherit'>{description}</Typography>\n      </ListItemText>\n      {onCancel && (\n        <ListItemIcon>\n          <IconButton onClick={onCancel} className={classes.closeIcon}>\n            <CancelIcon color='inherit' />\n          </IconButton>\n        </ListItemIcon>\n      )}\n    </ListItem>\n  )\n}\n\nSearchContextItem.propTypes = {\n  variant: PropTypes.oneOf(['tag', 'location', 'user']),\n  onClick: PropTypes.func,\n  gravatar: PropTypes.string,\n  className: PropTypes.string,\n  name: PropTypes.string.isRequired,\n  description: PropTypes.string,\n  onCancel: PropTypes.func\n}\n\nexport default SearchContextItem\n\nexport const SearchContexItemCosmos = () => {\n  return (\n    <List>\n      <SearchContextItem variant='tag' name='SomeTag' description='Some description of what I am' />\n      <SearchContextItem variant='location' name='Some Location' description='Some description of what I am' />\n      <SearchContextItem variant='user' name='User McUserSon' description='Some description of what I am' />\n    </List>\n  )\n}\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport List from '@material-ui/core/List'\nimport Typography from '@material-ui/core/Typography'\n\nimport SearchContextItem from './SearchContextItem'\n// import MenuIcon from '@material-ui/icons/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    height: '100%',\n    backgroundColor: theme.palette.background.paper,\n    position: 'relative',\n    overflowX: 'hidden',\n    overflowY: 'scroll'\n  },\n  listSection: {\n    backgroundColor: 'inherit'\n  },\n  placeholderText: {\n    textAlign: 'center',\n    padding: theme.spacing(3, 1),\n    color: theme.palette.grey[400]\n  },\n  ul: {\n    backgroundColor: 'inherit',\n    padding: 0\n  }\n}))\n\nconst SearchContextResults = ({ variant, loading, contextResults, setContextChoice }) => {\n  const classes = useStyles()\n  if (loading) {\n    return <Typography className={classes.placeholderText} variant='h3'>Searching...</Typography>\n  }\n  else if (!contextResults || contextResults.length === 0) {\n    return <Typography className={classes.placeholderText} variant='h4'>No {variant} results</Typography>\n  }\n\n  return (\n    <List className={classes.root}>\n      {contextResults.map((cr, idx) => (\n        <SearchContextItem\n          key={`scr-${idx}`}\n          variant={variant}\n          onClick={() => setContextChoice(cr)}\n          {...cr}\n        />\n      ))}\n    </List>\n  )\n}\n\nSearchContextResults.propTypes = {\n  variant: PropTypes.oneOf(['tag', 'location', 'user']),\n  loading: PropTypes.bool,\n  contextResults: PropTypes.array.isRequired,\n  setContextChoice: PropTypes.func.isRequired\n}\n\nexport default SearchContextResults\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\n// import MenuIcon from '@material-ui/icons/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nconst useStyles = makeStyles(theme => ({\n  root: {\n    textAlign: 'center',\n    fontStyle: 'italic',\n    padding: theme.spacing(2, 1)\n  }\n}))\n\nconst SearchEnder = ({ style, icon, text }) => {\n  const classes = useStyles()\n  return (\n    <Typography className={classes.root} variant='subtitle1' color='textSecondary' component='div' style={style}>\n      {icon}\n      {text}\n    </Typography>\n  )\n}\n\nSearchEnder.propTypes = {\n  style: PropTypes.object,\n  icon: PropTypes.any,\n  text: PropTypes.string\n}\n\nexport default SearchEnder\n","import React, { useRef, useEffect } from 'react'\nimport PropTypes from 'prop-types'\nimport List from '@material-ui/core/List'\nimport Typography from '@material-ui/core/Typography'\n\nimport SearchContextItem from './SearchContextItem'\nimport SearchEnder from './SearchEnder'\n// import MenuIcon from '@material-ui/icons/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nimport SeriesListItem from '../misc/SeriesListItem'\nimport { debounce } from '../../lib/util'\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    height: '100%',\n    display: 'flex',\n    flexDirection: 'column',\n    overflow: 'hidden'\n  },\n  ctxItem: {\n    flexGrow: 0\n  },\n  list: {\n    flexGrow: 1,\n    backgroundColor: theme.palette.background.paper,\n    position: 'relative',\n    overflowX: 'hidden',\n    overflowY: 'scroll'\n  },\n  placeholderText: {\n    textAlign: 'center',\n    padding: theme.spacing(3, 1),\n    color: theme.palette.grey[400]\n  },\n  listSection: {\n    backgroundColor: 'inherit'\n  },\n  ul: {\n    backgroundColor: 'inherit',\n    padding: 0\n  }\n}))\n\nconst SearchResults = ({ variant, loading, seriesList, contextChoice, onCancel, onResultClick, fetchMore }) => {\n  const classes = useStyles()\n  const listRef = useRef()\n  const enderRef = useRef()\n\n  const handleScroll = debounce(() => {\n    if (!loading && fetchMore && enderRef.current && listRef.current) {\n      const { offsetTop } = enderRef.current\n      const { scrollTop, offsetHeight } = listRef.current\n      const scrollBottom = offsetHeight + scrollTop\n      if (offsetTop < scrollBottom * 2) {\n        console.log('SCROLL', { offsetHeight, scrollTop, offsetTop })\n        fetchMore()\n      }\n    }\n  }, 500)\n\n  useEffect(handleScroll, [seriesList])\n\n  let content = null\n  if (loading) {\n    content = (\n      <Typography className={classes.placeholderText} variant='h3'>Searching...</Typography>\n    )\n  }\n  else if (seriesList && seriesList.length > 0) {\n    content = seriesList.map((series, idx) => (\n      <SeriesListItem\n        key={`series-${idx}`}\n        series={series}\n        onClick={() => onResultClick(series.id)}\n        showCreatedOn\n        showLastPhoto\n      />\n    ))\n    content.push(\n      <div key='ender' ref={enderRef}>\n        <SearchEnder text={fetchMore ? 'Loading...' : 'No More Results'} />\n      </div>\n    )\n  }\n  else {\n    content = (\n      <Typography className={classes.placeholderText} variant='h4'>No series found</Typography>\n    )\n  }\n\n  return (\n    <div className={classes.root}>\n      <SearchContextItem className={classes.ctxItem} {...contextChoice} variant={variant} onCancel={onCancel} />\n      <List className={classes.list} subheader={<li />} onScroll={handleScroll} innerRef={listRef}>\n        {content}\n      </List>\n    </div>\n  )\n}\n\nSearchResults.propTypes = {\n  variant: PropTypes.oneOf(['tag', 'location', 'user']),\n  seriesList: PropTypes.array.isRequired,\n  loading: PropTypes.bool,\n  contextChoice: PropTypes.object.isRequired,\n  onResultClick: PropTypes.func.isRequired,\n  onCancel: PropTypes.func.isRequired,\n  fetchMore: PropTypes.func\n}\n\nexport default SearchResults\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\nimport Typography from '@material-ui/core/Typography'\n// import MenuIcon from '@material-ui/icons/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nconst useStyles = makeStyles(theme => ({\n  root: {\n    flexGrow: 1,\n    padding: '10%',\n    display: 'flex',\n    flexDirection: 'column',\n    opacity: 0.3,\n    textAlign: 'center'\n  },\n  icon: {\n    width: '100%',\n    flex: '1 1 40%',\n    color: theme.palette.primary.light,\n    opacity: 0.5\n  },\n  primary: {\n    flex: '1 1 30%',\n    width: '100%'\n  },\n  secondary: {\n    flex: '1 1 30%',\n    width: '100%'\n  }\n}))\n\nconst SearchPlaceholder = ({ icon, primary, secondary }) => {\n  const classes = useStyles()\n  const PlaceholderIcon = icon\n  return (\n    <div className={classes.root}>\n      <PlaceholderIcon className={classes.icon} />\n      {primary && (\n        <Typography className={classes.primary} variant='h3'>\n          {primary}\n        </Typography>\n      )}\n      {secondary && (\n        <Typography className={classes.secondary} variant='h4'>\n          {secondary}\n        </Typography>\n      )}\n    </div>\n  )\n}\n\nSearchPlaceholder.propTypes = {\n  icon: PropTypes.object,\n  primary: PropTypes.string,\n  secondary: PropTypes.string\n}\n\nexport default SearchPlaceholder\n","import { useEffect, useState } from 'react'\n\nconst useOnline = () => {\n  const [state, setState] = useState(null)\n\n  const setOnline = () => {\n    console.log('ONLINE')\n    setState(null)\n  }\n  const setOffline = () => {\n    console.log('OFFLINE')\n    const newDate = Date.now()\n    setState(newDate)\n  }\n\n  useEffect(() => {\n    window.addEventListener('online', setOnline)\n    window.addEventListener('offline', setOffline)\n\n    return () => {\n      window.removeEventListener('online', setOnline)\n      window.removeEventListener('offline', setOffline)\n    }\n  }, [])\n\n  return {\n    online: state === null,\n    since: state\n  }\n}\n\nexport default useOnline\n","import React, { useEffect } from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport Tabs from '@material-ui/core/Tabs'\nimport Tab from '@material-ui/core/Tab'\n\nimport SearchContextResults from './SearchContextResults'\nimport SearchResults from './SearchResults'\nimport SearchPlaceholder from './SearchPlaceholder'\nimport TopBar from '../TopBar'\nimport SearchInput from './SearchInput'\nimport useOnline from '../../lib/useOnline'\nimport { home } from '../../config'\nimport PortableWifiOffIcon from '@material-ui/icons/PortableWifiOff'\nimport LabelIcon from '@material-ui/icons/Label'\nimport PlaceIcon from '@material-ui/icons/Place'\nimport PersonIcon from '@material-ui/icons/Person'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst TABS = home.SEARCH_TABS\n\nconst style = theme => ({\n  root: {\n    height: '100%',\n    display: 'flex',\n    overflow: 'hidden',\n    flexDirection: 'column'\n  },\n  tabs: {\n    // backgroundColor: theme.palette.primary.main,\n    // color: theme.palette.primary.contrastText,\n    // background: `linear-gradient(90deg, ${theme.palette.primary.dark} 0%, ${theme.palette.secondary.dark} 100%)`\n\n  },\n  ListWrapper: {\n    flexGrow: 1,\n    overflow: 'hidden'\n  },\n  tab: {\n    flexGrow: 1\n  },\n  grow: {\n    flexGrow: 1\n  }\n})\n\nconst useStyles = makeStyles(style)\n\nconst Search = ({\n  onMenuBack, currentTab, setCurrentTab, defaultText, searchText,\n  setSearchText, contextResults, searchResults, contextChoice,\n  loading, setContextChoice, onMapClick, onResultClick, fetchMore\n}) => {\n  const classes = useStyles()\n\n  const { online } = useOnline()\n\n  // If there's only one thing then use it\n  useEffect(() => {\n    if (contextResults && !searchResults && contextResults.length === 1) {\n      setContextChoice(contextResults[0])\n    }\n  }, [contextResults])\n\n  let placeholder = {}\n  switch (currentTab) {\n    case TABS.TAG:\n      placeholder = { primary: 'Tag search', secondary: 'example: \\'beaver...\\'', icon: LabelIcon }\n      break\n    case TABS.USER:\n      placeholder = { primary: 'User search', secondary: 'example: \\'SuperGreg123...\\'', icon: PersonIcon }\n      break\n    case TABS.LOCATION:\n      placeholder = { primary: 'Location Search', secondary: 'example: \\'Vancouver...\\'', icon: PlaceIcon }\n      break\n\n    default:\n      break\n  }\n\n  let content = null\n  if (!online) {\n    content = (\n      <SearchPlaceholder\n        primary='Search Disabled'\n        secondary='(Offline)'\n        icon={PortableWifiOffIcon}\n      />\n    )\n  }\n  else if (contextChoice && searchResults) {\n    content = (\n      <SearchResults\n        variant={currentTab}\n        loading={loading}\n        onResultClick={onResultClick}\n        fetchMore={fetchMore}\n        seriesList={searchResults}\n        contextChoice={contextChoice}\n        onCancel={() => setContextChoice(null)}\n      />\n    )\n  }\n  else if (contextResults) {\n    content = (\n      <SearchContextResults\n        loading={loading}\n        variant={currentTab}\n        contextResults={contextResults}\n        setContextChoice={currentTab === TABS.LOCATION ? onMapClick : setContextChoice}\n      />\n    )\n  }\n  else if (defaultText.length > 0) {\n    content = (\n      <Typography>Searching for {`'${searchText}'` || '...'}</Typography>\n    )\n  }\n  else {\n    content = <SearchPlaceholder {...placeholder} />\n  }\n\n  return (\n    <div className={classes.root}>\n      <TopBar>\n        <SearchInput\n          disabled={!online}\n          // autoFocus\n          onChange={setSearchText}\n          defaultValue={searchText}\n        />\n      </TopBar>\n      {online && (\n        <Tabs\n          value={currentTab}\n          disabled={!online}\n          onChange={(e, val) => setCurrentTab(val)}\n          indicatorColor='primary'\n          classes={{ flexContainer: classes.tabs }}\n          centered\n        >\n          <Tab className={classes.tab} value={TABS.TAG} label='Tags' />\n          <Tab className={classes.tab} value={TABS.LOCATION} label='Places' />\n          <Tab className={classes.tab} value={TABS.USER} label='Users' />\n        </Tabs>\n      )}\n      <div\n        className={classes.ListWrapper}\n      >\n        {content}\n      </div>\n    </div>\n  )\n}\n\nSearch.propTypes = {\n  onMenuBack: PropTypes.func.isRequired,\n  loading: PropTypes.bool,\n  currentTab: PropTypes.string.isRequired,\n  setCurrentTab: PropTypes.func.isRequired,\n  searchText: PropTypes.string.isRequired,\n  setSearchText: PropTypes.func.isRequired,\n  fetchMore: PropTypes.func,\n  contextResults: PropTypes.array,\n  searchResults: PropTypes.array,\n  contextChoice: PropTypes.object,\n  setContextChoice: PropTypes.func.isRequired,\n  onMapClick: PropTypes.func.isRequired,\n  onResultClick: PropTypes.func.isRequired\n}\nSearch.defaultProps = {\n  currentTab: TABS.TAGS,\n  defaultText: ''\n}\n\nexport default Search\n","import React, { useState, useMemo } from 'react'\nimport PropTypes from 'prop-types'\nimport { home } from '../config'\n// import { smallestHash } from 'geotilehash'\nimport { graphql, compose } from 'react-apollo'\nimport { point, bbox as bboxFunc, buffer } from '@turf/turf'\n\nimport { connect } from 'react-redux'\nimport actions from '../redux/actions'\nimport { tagSearch, seriesWithTag, userSearch, userSeries, geocode } from './queries'\nimport Search from '../components/Search/Search'\n// import { AppContext } from '../contexts'\n// import { debounce } from '../lib/util'\nimport { formatDatAgo } from '../lib/datelib'\n\nconst SearchConnect = ({\n  jumpToMap, jumpToSeries, defaultTab, defaultText, fetchMore\n}) => {\n  // const { role, user } = useContext(AppContext)\n\n  const [currentTab, setCurrentTab] = useState(defaultTab || home.SEARCH_TABS.TAG)\n  // We separate these because one of them needs to be immediate and the\n  const [searchText, setSearchText] = useState(defaultText || '')\n  const [contextChoice, setContextChoice] = useState(null)\n\n  const handleTabChange = (newTab) => {\n    setContextChoice(null)\n    setCurrentTab(newTab)\n  }\n  const handleContextChoiceChange = (newContextChoice) => {\n    setContextChoice(newContextChoice)\n  }\n  const handleSearchTextChange = (text) => {\n    setSearchText(text)\n    setContextChoice(null)\n  }\n\n  let withContextQuery = null\n  let withSearchQuery = null\n\n  switch (currentTab) {\n    case home.SEARCH_TABS.TAG:\n      withContextQuery = withTagSearch\n      withSearchQuery = withTagSeries\n      break\n    case home.SEARCH_TABS.LOCATION:\n      withContextQuery = withGeoCode\n      // withSearchQuery = withGeoSearch\n      break\n    case home.SEARCH_TABS.USER:\n      withContextQuery = withUserSearch\n      withSearchQuery = withUserSeries\n      break\n    default:\n      break\n  }\n\n  const ComposedSearch = useMemo(() => withSearchQuery\n    ? compose(\n      withContextQuery,\n      withSearchQuery\n    )(Search)\n    : withContextQuery(Search), [withContextQuery, withSearchQuery])\n\n  return <ComposedSearch {...{ currentTab, searchText, contextChoice }}\n    onMenuBack={() => {}}\n    onMapClick={jumpToMap}\n    onResultClick={jumpToSeries}\n    setContextChoice={handleContextChoiceChange}\n    fetchMore={fetchMore}\n    setCurrentTab={handleTabChange}\n    setSearchText={handleSearchTextChange}\n  />\n}\nSearchConnect.propTypes = {\n  searchResults: PropTypes.array,\n  contextResults: PropTypes.array,\n  loading: PropTypes.bool,\n  jumpToMap: PropTypes.func,\n  jumpToSeries: PropTypes.func,\n  fetchMore: PropTypes.func\n}\n/*****************************************************************\n *  PART 1: SEARCH QUERIES\n *****************************************************************/\n\n/**\n * Here's the graphql HOC that gets an individual series\n */\nconst withTagSearch = graphql(tagSearch, {\n  props: ({ data }) => {\n    if (data.error) console.error(data.error)\n    // console.log('withTagSearch', data)\n    let series = null\n    try {\n      if (!data.loading && !data.error) series = data.series\n    }\n    catch (e) {\n      console.error(data)\n      console.error(e)\n    }\n    const contextResults = data.tags ? data.tags.map(({ name, count }) => ({\n      name, description: `~ ${Math.ceil(count / 10) * 10} Photo series tagged`\n    })) : []\n\n    return {\n      contextResults,\n      loading: data.loading,\n      series\n    }\n  },\n  // skip: ({ searchText }) => !searchText || searchText.length < 3,\n  options: ({ searchText }) => ({\n    variables: {\n      tag: !searchText || searchText.length < 3 ? '' : searchText,\n      limit: 10\n    }\n  })\n})\n\nconst withUserSearch = graphql(userSearch, {\n  props: ({ data }) => {\n    if (data.error) console.error(data.error)\n    // console.log('withUserSearch', data)\n    let series = null\n    try {\n      if (!data.loading && !data.error) series = data.series\n    }\n    catch (e) {\n      console.error(data)\n      console.error(e)\n    }\n\n    const contextResults = data.userSearch ? data.userSearch.map(({ username, gravatar, createdOn, id }) => ({\n      name: username,\n      id,\n      description: `Joined ${formatDatAgo(createdOn)}`,\n      gravatar\n    })) : []\n\n    return {\n      contextResults,\n      loading: data.loading,\n      series\n    }\n  },\n  skip: ({ searchText }) => !searchText || searchText.length < 3,\n  options: ({ searchText }) => ({\n    variables: {\n      searchStr: searchText,\n      limit: 10\n    }\n  })\n})\n\nconst withGeoCode = graphql(geocode, {\n  props: ({ data }) => {\n    if (data.error) console.error(data.error)\n    // console.log('withGeoCode', data)\n    let series = null\n    try {\n      if (!data.loading && !data.error) series = data.series\n    }\n    catch (e) {\n      console.error(data)\n      console.error(e)\n    }\n\n    const contextResults = data.geocoder ? data.geocoder.map(({ relevance, text, placeName, bbox, center }) => ({\n      name: text,\n      description: placeName,\n      bbox,\n      center,\n      relevance\n    })) : []\n\n    return {\n      contextResults,\n      loading: data.loading,\n      series\n    }\n  },\n  skip: ({ searchText }) => !searchText || searchText.length < 3,\n  options: ({ searchText }) => ({\n    variables: {\n      search: searchText\n      // limit: 10\n    }\n  })\n})\n\n/*****************************************************************\n * PART 2: SERIES SEARCH QUERIES\n *****************************************************************/\n\nconst withTagSeries = graphql(seriesWithTag, {\n  props: ({ data }) => {\n    if (data.error) console.error(data.error)\n    // console.log('withTagSeries', data)\n    let series = null\n    try {\n      if (!data.loading && !data.error) series = data.series\n    }\n    catch (e) {\n      console.error(data)\n      console.error(e)\n    }\n\n    // A second Thunk function designed to get more elements in the feed history\n    const fetchMore = data.loading || !data.tagSeries || !data.tagSeries.nextToken ? null : () => {\n      console.log('fetchMore', data)\n      data.fetchMore({\n        variables: { ...data.variables, nextToken: data.tagSeries.nextToken },\n        // How do we mush the new query with the old one\n        updateQuery: (prev, { fetchMoreResult }) => {\n          return {\n            tagSeries: {\n              ...fetchMoreResult.tagSeries,\n              seriesSummaries: [ ...prev.tagSeries.seriesSummaries, ...fetchMoreResult.tagSeries.seriesSummaries ]\n            }\n          }\n        }\n      })\n    }\n\n    const searchResults = data.tagSeries && data.tagSeries.seriesSummaries\n      ? data.tagSeries.seriesSummaries\n      : []\n\n    return {\n      searchResults,\n      fetchMore,\n      loading: data.loading,\n      series\n    }\n  },\n  skip: ({ contextChoice }) => !contextChoice,\n  options: ({ contextChoice }) => ({\n    variables: {\n      tag: contextChoice.name,\n      limit: 10\n    }\n  })\n})\n\nconst withUserSeries = graphql(userSeries, {\n  props: ({ data }) => {\n    if (data.error) console.error(data.error)\n    // console.log('withUserSeries', data)\n    let series = null\n    try {\n      if (!data.loading && !data.error) series = data.series\n    }\n    catch (e) {\n      console.error(data)\n      console.error(e)\n    }\n\n    // A second Thunk function designed to get more elements in the feed history\n    const fetchMore = data.loading || !data.userSeries || !data.userSeries.nextToken ? null : () => {\n      console.log('fetchMore', data)\n      data.fetchMore({\n        variables: { ...data.variables, nextToken: data.userSeries.nextToken },\n        // How do we mush the new query with the old one\n        updateQuery: (prev, { fetchMoreResult }) => {\n          return {\n            userSeries: {\n              ...fetchMoreResult.userSeries,\n              seriesSummaries: [ ...prev.userSeries.seriesSummaries, ...fetchMoreResult.userSeries.seriesSummaries ]\n            }\n          }\n        }\n      })\n    }\n\n    const searchResults = data.userSeries && data.userSeries.seriesSummaries\n      ? data.userSeries.seriesSummaries\n      : []\n\n    return {\n      searchResults,\n      fetchMore,\n      loading: data.loading,\n      series\n    }\n  },\n  skip: ({ contextChoice }) => !contextChoice,\n  options: ({ contextChoice }) => ({\n    variables: {\n      createdBy: contextChoice.id,\n      limit: 10\n    }\n  })\n})\n\n// const withGeoSearch = graphql(geoSeries, {\n//   props: ({ data }) => {\n//     if (data.error) console.error(data.error)\n//     // console.log('HERE', data)\n//     let series = null\n//     try {\n//       if (!data.loading && !data.error) series = data.series\n//     }\n//     catch (e) {\n//       console.error(data)\n//       console.error(e)\n//     }\n//     return {\n//       data,\n//       loading: data.loading,\n//       series\n//     }\n//   },\n//   skip: ({ contextChoice }) => !contextChoice,\n//   options: ({ contextChoice }) => ({\n//     variables: {\n//       bounds: contextChoice.bbox\n//       // limit: 10\n//       // nextToken\n//     }\n//   })\n// })\n\n/**\n * Map our redux state and functions\n */\nconst mapStateToProps = (state, props) => {\n  const { current: { search, activeSeries, domain } } = state.home\n  return {\n    defaultTab: search ? search.tab : null,\n    defaultText: search ? search.text : null,\n    activeSeries,\n    domain\n  }\n}\n\nconst mapDispatchToProps = dispatch => ({\n  onBack: () => {\n    dispatch(actions.homeStateBack())\n  },\n  queueUpload: (uploadObj) => {\n    dispatch(actions.queueUpload(uploadObj))\n  },\n  jumpToSeries: (seriesId) => {\n    dispatch(actions.setHomeState(home.AppStateTypes.SERIES, { activeSeries: seriesId }))\n  },\n\n  jumpToMap: ({ bbox, center }) => {\n    let bounds = bbox\n    if (!bounds && center) {\n      const bufferPts = buffer(point(center), 500, { units: 'meters' })\n      bounds = bboxFunc(bufferPts)\n    }\n\n    if (bounds) {\n      dispatch(actions.pushMapHistory({\n        mode: home.MapModeTypes.FREE,\n        bounds: bounds\n      }))\n      dispatch(actions.setHomeState(home.AppStateTypes.MAP, { activeSeries: null, initialPhoto: null }))\n    }\n  }\n})\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(SearchConnect)\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemText from '@material-ui/core/ListItemText'\n// import MenuIcon from '@material-ui/icons/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { formatDate } from '../../lib/datelib'\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n\n  },\n  gravatarImg: {\n    display: 'block',\n    marginLeft: theme.spacing(1),\n    marginRight: theme.spacing(2),\n    width: '100%',\n    maxWidth: '25%',\n    height: 'auto'\n  }\n}))\n\nconst MeCard = ({ user, loading, onAvatarClick }) => {\n  const classes = useStyles()\n\n  if (loading || !user) return 'LOADING...'\n  // console.log('USER', user)\n\n  return (\n    <ListItem className={classes.root} onClick={onAvatarClick} disableGutters>\n      <img alt='profile' className={classes.gravatarImg} src={user.gravatar} />\n      <ListItemText\n        primary={user.username}\n        secondary={`Member since: ${formatDate(user.createdOn, 'LL')}`}\n      />\n    </ListItem>\n  )\n}\n\nMeCard.propTypes = {\n  user: PropTypes.object,\n  loading: PropTypes.bool,\n  onAvatarClick: PropTypes.func\n}\n\nexport default MeCard\n","import React, { useState, useContext } from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport Divider from '@material-ui/core/Divider'\nimport Tabs from '@material-ui/core/Tabs'\nimport Tab from '@material-ui/core/Tab'\n\nimport SeriesListItem from '../misc/SeriesListItem'\nimport { makeStyles } from '@material-ui/core/styles'\nimport TopBar from '../TopBar'\nimport MeCard from './MeCard'\nimport { Button } from '@material-ui/core'\n\nimport { AppContext } from '../../contexts'\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    background: theme.palette.background.paper,\n    display: 'flex',\n    flexDirection: 'column',\n    height: '100%'\n  },\n  filterContainer: {\n    color: theme.palette.primary.secondary,\n    background: theme.palette.background.default,\n    textAlign: 'center',\n    padding: theme.spacing(1, 1)\n  },\n  filterChip: {\n\n  },\n  seriesListItemWrap: {\n    margin: theme.spacing(1, 0.5)\n  },\n  seriesList: {\n    height: '100%',\n    overflowX: 'hidden',\n    overflowY: 'scroll'\n  },\n  tabs: {\n    // background: theme.palette.background.default\n  },\n  noneFound: {\n    color: theme.palette.text.secondary,\n    textAlign: 'center',\n    padding: theme.spacing(2)\n  }\n}))\n\nconst SORT = {\n  ACTIVITY: 'Last Photo',\n  CREATED: 'Created',\n  NAME: 'Name'\n}\n\nconst MyProfile = ({ mySeries, watchingSeries, loading, jumpToSeries, jumpToMap }) => {\n  const classes = useStyles()\n  const [currentTab, setCurrentTab] = useState(0)\n  const [sortVal, setSort] = useState(SORT.ACTIVITY)\n  const [sortAsc, setSortAsc] = useState(false)\n\n  const { user } = useContext(AppContext)\n\n  const sortSetter = (newSort) => {\n    if (newSort === sortVal) setSortAsc(!sortAsc)\n    else setSort(newSort)\n  }\n\n  let tabFeed = currentTab === 0 ? mySeries : watchingSeries\n\n  switch (sortVal) {\n    case SORT.ACTIVITY:\n      if (sortAsc) tabFeed.sort((a, b) => a.latest.takenOn - b.latest.takenOn)\n      else tabFeed.sort((a, b) => b.latest.takenOn - a.latest.takenOn)\n      break\n    case SORT.CREATED:\n      if (sortAsc) tabFeed.sort((a, b) => a.createdOn - b.createdOn)\n      else tabFeed.sort((a, b) => b.createdOn - a.createdOn)\n      break\n    case SORT.NAME:\n      if (sortAsc) {\n        tabFeed.sort((a, b) => {\n          if (a.name < b.name) {\n            return -1\n          }\n          if (a.name > b.firstname) {\n            return 1\n          }\n          return 0\n        })\n      }\n      else {\n        tabFeed.sort((a, b) => {\n          if (b.name < a.name) {\n            return -1\n          }\n          if (b.name > a.name) {\n            return 1\n          }\n          return 0\n        })\n      }\n      break\n    default:\n      break\n  }\n\n  return (\n    <div className={classes.root}>\n      <TopBar>\n        <Typography>My Profile</Typography>\n      </TopBar>\n      <MeCard user={user} />\n      {/* <Divider /> */}\n      <Tabs\n        value={currentTab}\n        onChange={(e, val) => setCurrentTab(val)}\n        indicatorColor='primary'\n        centered\n        classes={{ flexContainer: classes.tabs }}\n      >\n        <Tab className={classes.tab} value={0} label='My Series' />\n        <Tab className={classes.tab} value={1} label='Watching' />\n      </Tabs>\n      <Divider />\n      <div className={classes.filterContainer}>\n        <FilterSortItem asc={sortAsc} active={sortVal === SORT.NAME} onClick={() => sortSetter(SORT.NAME)} label={SORT.NAME} />\n        |\n        <FilterSortItem asc={sortAsc} active={sortVal === SORT.ACTIVITY} onClick={() => sortSetter(SORT.ACTIVITY)} label={SORT.ACTIVITY} />\n        |\n        <FilterSortItem asc={sortAsc} active={sortVal === SORT.CREATED} onClick={() => sortSetter(SORT.CREATED)} label={SORT.CREATED} />\n      </div>\n      <Divider />\n      <div className={classes.seriesList}>\n        {!loading && (!tabFeed || tabFeed.length === 0) && (\n          <Typography className={classes.noneFound} component='div'>No Series Found</Typography>\n        )}\n        {tabFeed.map((series, idx) => (\n          <SeriesListItem\n            key={`seriesListItem${idx}`}\n            series={series}\n            showCreatedOn\n            showLastPhoto\n            onClick={() => jumpToSeries(series.id)}\n          />\n        ))}\n      </div>\n    </div>\n  )\n}\n\nMyProfile.propTypes = {\n  loading: PropTypes.bool.isRequired,\n  mySeries: PropTypes.array.isRequired,\n  watchingSeries: PropTypes.array.isRequired,\n  jumpToSeries: PropTypes.func.isRequired,\n  jumpToMap: PropTypes.func.isRequired\n}\n\nexport default MyProfile\n\nconst useFilterStyles = makeStyles(theme => ({\n  root: {\n    margin: theme.spacing(0, 1, 0, 1)\n  }\n}))\n\nconst FilterSortItem = ({ active, asc, onClick, label }) => {\n  const classes = useFilterStyles()\n\n  const arrow = asc === true ? '▲' : '▼'\n\n  return (\n    <Button\n      size='small'\n      className={classes.root}\n      onClick={onClick}\n      // variant='caption'\n      color={active ? 'secondary' : 'inherit'}\n    >\n      {label}\n      <span style={{ opacity: active ? 1 : 0 }}>\n        {arrow}\n      </span>\n    </Button>\n  )\n}\n\nFilterSortItem.propTypes = {\n  active: PropTypes.bool,\n  asc: PropTypes.bool,\n  onClick: PropTypes.func.isRequired,\n  label: PropTypes.string.isRequired\n}\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport { graphql, compose } from 'react-apollo'\nimport actions from '../redux/actions'\nimport { connect } from 'react-redux'\nimport { home } from '../config'\n\nimport { userSeries, seriesFromList } from './queries'\nimport MyProfile from '../components/MyProfile/MyProfile'\n\nconst ProfileConnect = ({ data, jumpToSeries, jumpToMap }) => {\n  const { seriesQ, watchedSeriesQ } = data\n\n  const mySeries = seriesQ && seriesQ.userSeries && seriesQ.userSeries.seriesSummaries ? seriesQ.userSeries.seriesSummaries : []\n  const watchingSeries = watchedSeriesQ && watchedSeriesQ.arraySeries ? watchedSeriesQ.arraySeries : []\n  // console.log('ProfileConnect', { mySeries, watchedSeriesQ, watchingSeries })\n\n  const loading = Boolean(\n    (seriesQ && seriesQ.loading) ||\n    (watchedSeriesQ && watchedSeriesQ.loading)\n  )\n\n  return <MyProfile {...{ loading, mySeries, watchingSeries, jumpToSeries, jumpToMap }} />\n}\n\nProfileConnect.propTypes = {\n  data: PropTypes.object, // from graphql\n  jumpToSeries: PropTypes.func, // from redux\n  jumpToMap: PropTypes.func // from redux\n}\n\nconst withuserSeriesQuery = graphql(userSeries, {\n  props: ({ data, ownProps }) => {\n    // console.log('ProfileConnect withuserSeriesQuery', { data, ownProps })\n    return { data: { ...ownProps.data, seriesQ: data } }\n  }\n})\n\nconst withMyWatchedSeriesQuery = graphql(seriesFromList, {\n  props: ({ data, ownProps }) => {\n    // console.log('ProfileConnect withMyWatchedSeriesQuery', { data, ownProps })\n    return { data: { ...ownProps.data, watchedSeriesQ: data } }\n  },\n  skip: ({ data, user }) => {\n    try {\n      return user.watching.length < 1\n    }\n    catch (e) {\n      return true\n    }\n  },\n  options: ({ data, user }) => {\n    return {\n      variables: { seriesList: user.watching }\n    }\n  }\n})\n\n/**\n * Compose all our queries together\n */\nconst queryWrapped = compose(\n  withuserSeriesQuery,\n  // withMyPhotosQuery,\n  withMyWatchedSeriesQuery\n)(ProfileConnect)\n\n/**\n * Map our redux state and functions\n */\nconst mapStateToProps = (state, props) => {\n  return { }\n}\n\nconst mapDispatchToProps = dispatch => ({\n  jumpToSeries: (seriesId) => {\n    dispatch(actions.setHomeState(home.AppStateTypes.SERIES, { activeSeries: seriesId }))\n  },\n  jumpToMap: (seriesId) => {\n    dispatch(actions.setHomeState(home.AppStateTypes.MAP, { activeSeries: seriesId }))\n  }\n})\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(queryWrapped)\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\n// import MenuIcon from '@material-ui/icons/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nconst useStyles = makeStyles(theme => ({\n  root: {\n    display: 'flex',\n    alignItems: 'center'\n  },\n  grow: { flexGrow: 1 },\n  text: {\n    textAlign: 'center',\n    fontStyle: 'italic',\n    padding: theme.spacing(2, 1)\n  }\n}))\n\nconst FeedEnder = ({ style, icon, text }) => {\n  const classes = useStyles()\n  return (\n    <div className={classes.root}>\n      <div className={classes.grow} />\n      {icon}\n      <Typography className={classes.text} variant='subtitle1' color='textSecondary' component='div' style={style}>\n        {text}\n      </Typography>\n      <div className={classes.grow} />\n    </div>\n  )\n}\n\nFeedEnder.propTypes = {\n  style: PropTypes.object,\n  icon: PropTypes.any,\n  text: PropTypes.string\n}\n\nexport default FeedEnder\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Avatar from '@material-ui/core/Avatar'\nimport IconButton from '@material-ui/core/IconButton'\n\nimport PlaceIcon from '@material-ui/icons/Place'\nimport { makeStyles } from '@material-ui/core/styles'\nconst useStyles = makeStyles(theme => ({\n  root: {\n    textAlign: 'center'\n  },\n  placeAvatar: {\n    color: theme.palette.primary.contrastText,\n    border: `2px solid ${theme.palette.primary.contrastText}`,\n    background: theme.palette.text.primary,\n    margin: 'auto'\n  },\n  placeIcon: {\n  }\n}))\n\nconst FindOnMapButton = ({ onClick }) => {\n  const classes = useStyles()\n  return (\n    <div className={classes.root}>\n      <Avatar className={classes.placeAvatar}>\n        <IconButton color='inherit' onClick={e => {\n          e.preventDefault()\n          e.stopPropagation()\n          onClick()\n        }}>\n          <PlaceIcon color='inherit' />\n        </IconButton>\n      </Avatar>\n      {/* <Typography variant='caption' component='div'>MAP</Typography> */}\n    </div>\n  )\n}\n\nFindOnMapButton.propTypes = {\n  onClick: PropTypes.func.isRequired\n}\n\nexport default FindOnMapButton\n","import React, { useContext } from 'react'\nimport PropTypes from 'prop-types'\nimport Paper from '@material-ui/core/Paper'\nimport Typography from '@material-ui/core/Typography'\n// import MenuIcon from '@material-ui/icons/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nimport FindOnMapButton from '../misc/FindOnMapButton'\n// import StarIcon from '@material-ui/icons/Star'\n// import StarBorderIcon from '@material-ui/icons/StarBorder'\nimport { Avatar } from '@material-ui/core'\nimport { AppContext } from '../../contexts'\nimport { formatDate } from '../../lib/datelib'\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    height: '100%',\n    // borderTop: `4px solid ${theme.palette.grey[700]}`\n    padding: theme.spacing(0.5, 1)\n  },\n  imgContainer: {\n    overflow: 'hidden',\n    height: '100%',\n    position: 'relative'\n  },\n  findOnMapButtonContainer: {\n    position: 'absolute',\n    opacity: 0.8,\n    bottom: theme.spacing(1),\n    right: theme.spacing(1)\n  },\n  titleContainer: {\n    background: '#444444AA',\n    textShadow: '1px 1px 10px black',\n    color: 'white',\n    position: 'absolute',\n    alignItems: 'center',\n    display: 'flex',\n    top: 0,\n    width: '100%',\n    paddingRight: theme.spacing(1)\n  },\n  avatar: {\n    border: '1px solid white',\n    margin: theme.spacing(0, 1)\n  },\n  title: {\n    flex: '1 1 50%',\n    overflow: 'hidden'\n  },\n  seriesName: {\n    textOverflow: 'ellipsis',\n    whiteSpace: 'nowrap',\n    overflow: 'hidden'\n  },\n  img: {\n    objectFit: 'cover',\n    height: '100%',\n    width: '100%'\n  },\n  gravatarImg: {\n    width: '100%'\n  }\n}))\n\nconst EVENT_VERBS = {\n  DELETE: 'Deleted',\n  ADD: 'Added'\n}\n\nconst FeedItem = ({ event, onMapClick, onImageClick, onProfileClick, onSeriesClick }) => {\n  const { series, photo } = event\n  // console.log('EVENT', { series, relation, photo })\n  const classes = useStyles()\n  const { seriesConfig } = useContext(AppContext)\n  return (\n    <div className={classes.root}>\n      <Paper className={classes.imgContainer}>\n        <img\n          alt='medium'\n          className={classes.img}\n          src={seriesConfig.getPhotoUrl(photo, 'medium')}\n          onClick={() => onImageClick(series.id, photo.id)}\n        />\n        <div className={classes.titleContainer}>\n          <Avatar onClick={() => onProfileClick(photo.createdUser.username)} className={classes.avatar}>\n            <img alt='profile' className={classes.gravatarImg} src={photo.createdUser.gravatar} />\n          </Avatar>\n          <div className={classes.title}>\n            <Typography className={classes.seriesName} variant='body1' color='inherit'>{series.name}</Typography>\n            <Typography variant='body2' color='inherit'>{photo.createdUser.username} {EVENT_VERBS.ADD} a photo</Typography>\n            <Typography variant='caption' color='inherit'>{formatDate(photo.updatedOn)}</Typography>\n          </div>\n          <FindOnMapButton onClick={() => onMapClick(series.id, photo.id)} />\n        </div>\n      </Paper>\n    </div>\n  )\n}\n\nFeedItem.propTypes = {\n  // TODO: THIS IS NOT THE SHAPE WE WANT. NEED TO HASH THIS OUT\n  event: PropTypes.object.isRequired,\n  onSeriesClick: PropTypes.func.isRequired,\n  onImageClick: PropTypes.func.isRequired,\n  onProfileClick: PropTypes.func.isRequired,\n  onMapClick: PropTypes.func.isRequired\n}\n\nexport default FeedItem\n\nexport const FeedItemCosmos = (props) => {\n  return (\n    <div>\n      <FeedItem {...props} />\n      <FeedItem {...props} />\n      <FeedItem {...props} />\n      <FeedItem {...props} />\n      <FeedItem {...props} />\n      <FeedItem {...props} />\n      <FeedItem {...props} />\n      <FeedItem {...props} />\n      <FeedItem {...props} />\n      <FeedItem {...props} />\n      <FeedItem {...props} />\n    </div>\n  )\n}\nFeedItemCosmos.propTypes = {\n  // TODO: THIS IS NOT THE SHAPE WE WANT. NEED TO HASH THIS OUT\n  event: PropTypes.object.isRequired\n}\n","import React, { useRef } from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\n\nimport { List } from 'react-virtualized' // InfiniteLoader\nimport useOnline from '../../lib/useOnline'\nimport FeedEnder from './FeedEnder'\n\nimport ErrorIcon from '@material-ui/icons/Error'\nimport { makeStyles } from '@material-ui/core/styles'\nimport FeedItem from './FeedItem'\n\nimport TopBar from '../TopBar'\n\nimport useComponentSize from '../../lib/useComponentSize'\nimport { CircularProgress } from '@material-ui/core'\n\nconst ROWHEIGHT = 300\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    display: 'flex',\n    flexDirection: 'column',\n    height: '100%'\n  },\n  listContainer: {\n    flexGrow: 1,\n    overflow: 'hidden'\n  },\n  vList: {\n    height: '100%',\n    width: '100%'\n  },\n  feedContainer: {\n    flexGrow: 1,\n    // Promote the list into his own layer on Chrome. This cost memory but helps keeping high FPS.\n    transform: 'translateZ(0)'\n  },\n  grow: {\n    flexGrow: 1\n  }\n}))\n\nconst MyFeed = ({\n  events, loading, onMapClick, onImageClick, onProfileClick,\n  onSeriesClick, fetchNewest, fetchMore, window\n}) => {\n  const classes = useStyles()\n  const listRef = useRef()\n  const { size } = useComponentSize(listRef)\n  const { online } = useOnline()\n\n  const rowRenderer = ({\n    index, // Index of row\n    isScrolling, // The List is currently being scrolled\n    isVisible, // This row is visible within the List (eg it is not an overscanned row)\n    key, // Unique key within array of rendered rows\n    parent, // Reference to the parent List (instance)\n    style // Style object to be applied to row (to position it);\n    // This must be passed through to the rendered row element.\n  }) => {\n    const row = events[index]\n    let content\n    if (index < events.length && row) {\n      content = <FeedItem\n        event={events[index]}\n        onSeriesClick={onSeriesClick}\n        onImageClick={onImageClick}\n        onProfileClick={onProfileClick}\n        onMapClick={onMapClick}\n      />\n    }\n    else if (index === events.length) {\n      // content = <div className={classes.placeholder} style={{ width: row.size }} />\n      const wEnd = window && window[0] === 0\n      content = <FeedEnder icon={<CircularProgress size={30} thickness={2} color='inherit' />} text='Loading...' />\n\n      const almostAtEnd = ROWHEIGHT * 4 + parent.state.scrollTop > style.top\n\n      if (!online) {\n        content = <FeedEnder icon={<ErrorIcon />} text='Cannot Refresh Offline' />\n      }\n      else if (wEnd) {\n        content = <FeedEnder text='End of feed' />\n      }\n      // Only if we're online, not loading and visible\n      else if (!loading && almostAtEnd) {\n        fetchMore()\n      }\n    }\n\n    return (\n      <div className={classes.row} key={key} style={style}>\n        {content}\n      </div>\n    )\n  }\n  rowRenderer.propTypes = {\n    index: PropTypes.any,\n    key: PropTypes.any,\n    style: PropTypes.any,\n    isScrolling: PropTypes.any,\n    isVisible: PropTypes.any,\n    parent: PropTypes.any\n  }\n\n  // console.log('DEBUGLIST', size)\n\n  return (\n    <div className={classes.root}>\n      <TopBar>\n        <Typography className={classes.grow}>Home Feed</Typography>\n      </TopBar>\n      <div className={classes.listContainer} ref={listRef}>\n        <List\n          height={size.height}\n          width={size.width}\n          className={classes.vList}\n          rowCount={events.length + 1}\n          rowHeight={ROWHEIGHT}\n          rowRenderer={rowRenderer}\n        />\n      </div>\n    </div>\n  )\n}\n\nMyFeed.propTypes = {\n  events: PropTypes.array.isRequired,\n  loading: PropTypes.bool,\n  window: PropTypes.arrayOf(PropTypes.number),\n  onSeriesClick: PropTypes.func.isRequired,\n  onImageClick: PropTypes.func.isRequired,\n  onProfileClick: PropTypes.func.isRequired,\n  onMapClick: PropTypes.func.isRequired,\n  fetchNewest: PropTypes.func.isRequired,\n  fetchMore: PropTypes.func.isRequired\n}\n\nexport default MyFeed\n","import React, { useRef, useState, useEffect } from 'react'\nimport PropTypes from 'prop-types'\nimport { graphql } from 'react-apollo'\nimport { home } from '../config'\nimport actions from '../redux/actions'\nimport { connect } from 'react-redux'\nimport { getMyFeed } from './queries'\nimport MyFeed from '../components/MyFeed/MyFeed'\nimport useOnline from '../lib/useOnline'\n\nconst POLL_INTERVAL = 20 // (seconds)\nconst FEED_LIMIT = 5 // (items to load)\n\nconst FeedConnect = ({\n  data, loading, fetchMore, fetchNewest,\n  loadingNewest,\n  loadingMore,\n  jumpToSeries,\n  jumpToMap,\n  jumpToUser\n}) => {\n  const timerRef = useRef()\n  const { online } = useOnline()\n  const [lastCheck, setLastCheck] = useState(null)\n  timerRef.current = lastCheck\n\n  // Initiate the polling process. We simply update the timestamp every N seconds\n  useEffect(() => {\n    function ping () {\n      if (!loading && online) fetchNewest()\n      if (timerRef.current) setLastCheck(String(Date.now() - POLL_INTERVAL * 1000))\n    }\n    if (!timerRef.current) timerRef.current = setInterval(ping, POLL_INTERVAL * 1000)\n    return () => {\n      if (timerRef.current) {\n        console.log('clear poll timer')\n        clearInterval(timerRef.current)\n        timerRef.current = null\n      }\n    }\n  }, [])\n\n  const events = data.myFeed ? data.myFeed.feed || [] : []\n  const window = data.myFeed ? data.myFeed.window.map(v => parseInt(v, 10)) || [null, null] : [null, null]\n\n  return (\n    <MyFeed {...{ events, loading, window, fetchMore, fetchNewest, jumpToSeries }}\n      onSeriesClick={() => {}}\n      onImageClick={jumpToSeries}\n      onProfileClick={jumpToUser}\n      onMapClick={jumpToMap}\n    />\n  )\n}\n\nFeedConnect.propTypes = {\n  data: PropTypes.object, // from graphql\n  loading: PropTypes.bool, // from graphql\n  loadingNewest: PropTypes.bool, // from graphql\n  loadingMore: PropTypes.bool, // from graphql\n  fetchMore: PropTypes.func,\n  fetchNewest: PropTypes.func,\n  jumpToSeries: PropTypes.func,\n  jumpToMap: PropTypes.func,\n  jumpToUser: PropTypes.func\n}\n\nconst withFeedQuery = graphql(getMyFeed, {\n  props: ({ data }) => {\n    if (data.error) console.error(data.error)\n\n    // TODO: Not sure this will propagate correctly. Test it.\n    let loadingNewest = false\n    let loadingMore = false\n\n    // console.log('withFeedQuery', data)\n\n    // One Thunk function designed for getting everything since the last check\n    const fetchNewest = () => {\n      loadingNewest = true\n      console.log('fetchNewest', data)\n      data.fetchMore({\n        variables: { ...data.variables, start: data.myFeed.window[1] },\n        // How do we mush the new query with the old one\n        updateQuery: (prev, { fetchMoreResult }) => {\n          loadingNewest = false\n          return {\n            myFeed: {\n              ...fetchMoreResult.myFeed,\n              // put the newest stuff first\n              feed: [ ...fetchMoreResult.myFeed.feed, ...prev.myFeed.feed ],\n              window: [prev.myFeed.window[0], fetchMoreResult.myFeed.window[1]]\n            }\n          }\n        }\n      })\n    }\n\n    // A second Thunk function designed to get more elements in the feed history\n    const fetchMore = () => {\n      loadingMore = true\n      console.log('fetchMore', data)\n      data.fetchMore({\n        variables: { ...data.variables, end: data.myFeed.window[0] },\n        // How do we mush the new query with the old one\n        updateQuery: (prev, { fetchMoreResult }) => {\n          loadingMore = false\n          return {\n            myFeed: {\n              ...fetchMoreResult.myFeed,\n              feed: [ ...prev.myFeed.feed, ...fetchMoreResult.myFeed.feed ],\n              window: [fetchMoreResult.myFeed.window[0], prev.myFeed.window[1]]\n            }\n          }\n        }\n      })\n    }\n\n    return {\n      data,\n      loadingNewest,\n      loadingMore,\n      fetchNewest, // This is the poll we do every n seconds\n      fetchMore, // This is when we scroll to the bottom of the list\n      loading: data.loading\n    }\n  },\n  // skip: ({ activeSeries, isNewSeries }) => !activeSeries || isNewSeries,\n  options: ({ activeSeries }) => ({\n    variables: {\n      limit: FEED_LIMIT\n    }\n  })\n})\n\n/**\n * Map our redux state and functions\n */\nconst mapStateToProps = (state, props) => {\n  return { }\n}\n\n// We're using graphql() HOC because it's convenient but it doesn't need to render anything\n// const FeedQueryConnect = withFeedQuery(() => null)\nconst mapDispatchToProps = dispatch => ({\n  jumpToSeries: (seriesId, photoId) => {\n    dispatch(actions.setHomeState(home.AppStateTypes.SERIES, { activeSeries: seriesId, initialPhoto: photoId }))\n  },\n  jumpToUser: (username) => {\n    dispatch(actions.setHomeState(home.AppStateTypes.SEARCH, { search: { tab: home.SEARCH_TABS.USER, text: username } }))\n  },\n  jumpToMap: (seriesId, photoId) => {\n    dispatch(actions.pushMapHistory({\n      mode: home.MapModeTypes.FREE\n    }))\n    dispatch(actions.setHomeState(home.AppStateTypes.MAP, { activeSeries: seriesId, initialPhoto: photoId }))\n  }\n})\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(\n  withFeedQuery(FeedConnect)\n)\n","import React, { useState, useEffect, useRef, useCallback } from 'react'\nimport PropTypes from 'prop-types'\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport AppBar from '@material-ui/core/AppBar'\nimport Toolbar from '@material-ui/core/Toolbar'\nimport Snackbar from '@material-ui/core/Snackbar'\nimport SnackbarContent from '@material-ui/core/SnackbarContent'\nimport IconButton from '@material-ui/core/IconButton'\nimport Typography from '@material-ui/core/Typography'\nimport QRcodeIcon from '../../../icons/QRCode'\nimport jsQR from 'jsqr'\nimport { debounce } from '../../../lib/util'\nimport {\n  green, red\n} from '@material-ui/core/colors'\n\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack'\nimport Paper from '@material-ui/core/Paper'\n// import MenuIcon from '@material-ui/icons/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { useCamera } from '../../../lib/useCamera'\n\nconst CAMERAWIDTH = 400\nconst CAMERAHEIGHT = 400\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    display: 'flex',\n    height: '100%',\n    flexDirection: 'column'\n  },\n  qrIcon: {\n    border: '5px solid red',\n    padding: theme.spacing(2),\n    position: 'absolute',\n    color: 'white',\n    opacity: 0.4,\n    zIndex: 2,\n    width: '70%',\n    height: '70%',\n    top: '50%',\n    left: '50%',\n    transformOrigin: '50% 50%',\n    transform: 'translateY(-50%) translateX(-50%)'\n  },\n  appBar: {\n\n  },\n  inner: {\n    padding: theme.spacing(2),\n    height: '100%',\n    flexGrow: 1,\n    overflow: 'hidden'\n  },\n  tipPaper: {\n    padding: theme.spacing(2),\n    margin: theme.spacing(2)\n  },\n  docContainer: {\n    flexGrow: 1,\n    padding: theme.spacing(2)\n  },\n  cameraContainer: {\n    width: '80%',\n    margin: '0 auto',\n    position: 'relative',\n    // this is a CSS trick: https://spin.atomicobject.com/2015/07/14/css-responsive-square/\n    '&::before': {\n      content: ' ',\n      display: 'block',\n      paddingTop: '100%'\n    }\n  },\n  snackErr: {\n    background: red[500],\n    color: 'white'\n  },\n  snackSuccess: {\n    background: green[500],\n    color: 'white'\n  },\n  snackMsg: {\n\n  },\n  video: {\n    height: '100%',\n    width: '100%',\n    verticalAlign: 'top'\n    // display: 'none'\n    // position: 'absolute'\n    // top: 0,\n    // left: 0,\n    // zIndex: 1\n    // '@media (orientation: portrait)': {\n    //   transform: 'rotate(90)'\n    // }\n  }\n}))\n\nconst QRReader = ({ onMenuBack, onCapture }) => {\n  const classes = useStyles()\n  const [capturedImg, setCapturedImg] = useState()\n  const [err, setErr] = useState(null)\n  const [code, setCode] = useState(null)\n\n  const { cameraError, captureRawData, cameraOnline } = useCamera(setCapturedImg, CAMERAWIDTH, CAMERAHEIGHT)\n  // limit to 10 frames per second\n  const captureFunc = useCallback(debounce(captureRawData, 100), [cameraOnline, cameraError])\n\n  useEffect(() => {\n    if (cameraOnline && !cameraError && !err && !code) {\n      if (!capturedImg || !capturedImg.data) captureFunc()\n      else {\n        const scan = async () => {\n          let scannedCode = null\n          try {\n            scannedCode = await jsQRFromBase64(capturedImg)\n          }\n          catch (e) {\n            console.error(e)\n          }\n          try {\n            if (scannedCode) {\n              const find = '?fromqr='\n              const foundIdx = scannedCode.data.indexOf(find) + find.length\n              const newData = scannedCode.data.slice(foundIdx)\n              console.log('DEBUG', { data: scannedCode.data, newData })\n              const decodedUrl = JSON.parse(decodeURI(newData))\n              if (!decodedUrl.type || !decodedUrl.id) throw new Error('Type or ID missing from QR Code')\n              setCode(decodedUrl)\n              setErr(null)\n              console.log('QRCODE', scannedCode)\n            }\n            captureFunc()\n          }\n          catch (e) {\n            setErr('Not a valid QR Code')\n            console.error(e)\n            captureFunc()\n          }\n        }\n        scan()\n      }\n    }\n  }, [cameraOnline, capturedImg, err, code])\n\n  // console.log(capturedImg)\n  return (\n    <div className={classes.root}>\n      <CssBaseline /> {/* You only need this in a root element. Don't put it anywhere else in the dom */}\n      <AppBar position='static' className={classes.appBar}>\n        <Toolbar disableGutters>\n          <IconButton className={classes.menuButton} color='inherit' onClick={onMenuBack} aria-label='Menu'>\n            <ArrowBackIcon />\n          </IconButton>\n          <Typography variant='subtitle1' color='inherit' className={classes.toolbarTitle}>\n            Capture QR Code\n          </Typography>\n        </Toolbar>\n      </AppBar>\n      <div className={classes.inner}>\n        <Paper className={classes.cameraContainer}>\n          <QRcodeIcon className={classes.qrIcon} />\n          <video\n            autoPlay\n            playsInline\n            muted\n            id='webcam'\n            className={classes.video}\n          />\n        </Paper>\n        <Paper className={classes.tipPaper}>\n          <Typography>TIP: You can find the QR code for a series in the SHARE tab of that series</Typography>\n        </Paper>\n      </div>\n      <Snackbar\n        anchorOrigin={{ vertical: 'bottom', horizontal: 'center' }}\n        open={!!err}\n        autoHideDuration={2000}\n        onClose={() => setErr(null)}\n      >\n        <SnackbarContent\n          className={classes.snackErr}\n          message={<span className={classes.snackMsg}>{err}</span>}\n        />\n      </Snackbar>\n      <Snackbar\n        anchorOrigin={{ vertical: 'bottom', horizontal: 'center' }}\n        open={cameraError}\n      >\n        <SnackbarContent\n          className={classes.snackErr}\n          message={<span className={classes.snackMsg}>Camera Error. Check your device's permissions</span>}\n        />\n      </Snackbar>\n      <Snackbar\n        anchorOrigin={{ vertical: 'bottom', horizontal: 'center' }}\n        open={!!code}\n        autoHideDuration={500}\n        onClose={() => onCapture(code.type, code.id)}\n      >\n        <SnackbarContent\n          className={classes.snackSuccess}\n          message={<span className={classes.snackMsg}>Valid QR Code found!</span>}\n        />\n      </Snackbar>\n\n    </div>\n  )\n}\n\nQRReader.propTypes = {\n  onMenuBack: PropTypes.func.isRequired,\n  onCapture: PropTypes.func.isRequired\n}\n\nexport default QRReader\n\nconst jsQRFromBase64 = ({ data, imageHeight, imageWidth }) => {\n  return new Promise((resolve, reject) => {\n    try {\n      // console.log(imageHeight, imageWidth)\n      const qrCode = jsQR(data, imageWidth, imageHeight)\n      resolve(qrCode)\n    }\n    catch (e) {\n      reject(e)\n    }\n  })\n}\n","import React, { useRef, useEffect, useState } from 'react'\nimport Typography from '@material-ui/core/Typography'\n// import MenuIcon from '@material-ui/icons/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nimport useOnline from '../../lib/useOnline'\nimport moment from 'moment'\n\nconst CHECKINTERVAL = 5000\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    background: 'black',\n    color: 'white',\n    textAlign: 'center'\n  }\n}))\n\nconst OfflineBar = () => {\n  const classes = useStyles()\n  const { online, since } = useOnline()\n  const [sinceStr, setSinceStr] = useState()\n  const timerRef = useRef()\n\n  const calcSinceStr = () => {\n    const newText = moment(since, 'x').fromNow()\n    // console.log('OFFLINE SINCE', since, newText)\n    setSinceStr(newText)\n  }\n  const clearTimer = () => {\n    if (timerRef.current) {\n      clearInterval(timerRef.current)\n      timerRef.current = null\n    }\n  }\n\n  useEffect(() => {\n    if (since && !timerRef.current) {\n      calcSinceStr()\n      timerRef.current = setInterval(calcSinceStr, CHECKINTERVAL)\n    }\n    else if (!since)clearTimer()\n    return () => {\n      clearTimer()\n    }\n  }, [since])\n\n  if (online) return null\n  return (\n    <Typography className={classes.root} variant='caption' component='div'>\n      Offline ({sinceStr})\n    </Typography>\n  )\n}\n\nexport default OfflineBar\n","import React from 'react'\nimport classNames from 'classnames'\nimport PropTypes from 'prop-types'\n\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport AppBar from '@material-ui/core/AppBar'\nimport Paper from '@material-ui/core/Paper'\nimport Typography from '@material-ui/core/Typography'\nimport Toolbar from '@material-ui/core/Toolbar'\nimport Button from '@material-ui/core/Button'\n// import Fab from '@material-ui/core/Fab'\n\nimport HomeIcon from '@material-ui/icons/HomeOutlined'\nimport MapIcon from '@material-ui/icons/MapOutlined'\nimport SearchIcon from '@material-ui/icons/SearchOutlined'\nimport AddIcon from '@material-ui/icons/Add'\nimport PersonOutline from '@material-ui/icons/PersonOutline'\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport useOnline from '../lib/useOnline'\nimport AddFab from '../components/PhotoSeries/views/controls/AddFab'\nimport OfflineBar from './misc/OfflineBar'\n\nimport { home as homeConfig } from '../config'\n\nconst STATES = homeConfig.AppStateTypes\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    borderTop: `2px solid ${theme.palette.secondary.main}`\n  },\n  text: {\n    padding: theme.spacing(2, 2, 0)\n  },\n  paper: {\n    paddingBottom: 50\n  },\n  list: {\n    marginBottom: theme.spacing(2)\n  },\n  subheader: {\n    backgroundColor: theme.palette.background.paper\n  },\n  grow: {\n    flexGrow: 1\n  },\n  addFab: {\n    position: 'absolute',\n    bottom: 0,\n    left: '50%',\n    transformOrigin: '0% 50%',\n    // Promote the list into his own layer on Chrome. This cost memory but helps keeping high FPS.\n    transform: 'translateY(-25%) translateX(-50%) translateZ(0)',\n    zIndex: 3000\n  },\n  spacer: {\n    width: 40,\n    flexGrow: 1\n  }\n}))\n\nconst BottomBar = ({ className, domain, signedIn, onHomeClick, onMapClick, onSearchClick, onProfileClick, onCameraClick, onLibraryClick }) => {\n  const classes = useStyles()\n  const { online } = useOnline()\n\n  return (\n    <AppBar position='static' className={classNames(classes.root, className)}>\n      <Toolbar>\n        {signedIn && (\n          <Button\n            edge='start'\n            className={classes.grow}\n            color={domain === STATES.FEED ? 'secondary' : 'inherit'}\n            onClick={onHomeClick}\n          >\n            <HomeIcon />\n          </Button>\n        )}\n        <Button\n          edge='start'\n          className={classes.grow}\n          color={domain === STATES.MAP ? 'secondary' : 'inherit'}\n          onClick={onMapClick}\n        >\n          <MapIcon />\n        </Button>\n        {signedIn && (\n          <AddFab\n            className={classes.addFab}\n            onCameraClick={onCameraClick}\n            onLibraryClick={onLibraryClick}\n          >\n            <AddIcon />\n          </AddFab>\n        )}\n        <div className={classes.spacer} />\n        <Button\n          color={domain === STATES.SEARCH ? 'secondary' : 'inherit'}\n          className={classes.grow}\n          disabled={!online}\n          onClick={onSearchClick}\n        >\n          <SearchIcon />\n        </Button>\n        {signedIn && (\n          <Button\n            edge='end'\n            color={domain === STATES.PROFILE ? 'secondary' : 'inherit'}\n            className={classes.grow}\n            onClick={onProfileClick}\n          >\n            <PersonOutline />\n          </Button>\n        )}\n      </Toolbar>\n    </AppBar>\n  )\n}\n\nBottomBar.propTypes = {\n  className: PropTypes.string,\n  domain: PropTypes.string,\n  signedIn: PropTypes.bool,\n  // Here are our button handlers\n  onHomeClick: PropTypes.func.isRequired,\n  onMapClick: PropTypes.func.isRequired,\n  onSearchClick: PropTypes.func.isRequired,\n  onProfileClick: PropTypes.func.isRequired,\n  onCameraClick: PropTypes.func.isRequired,\n  onLibraryClick: PropTypes.func.isRequired\n}\n\nexport default BottomBar\n\nexport const BottomBarCosmosWrapper = (props) => {\n  // const [someStateItem, setSomeStateItem] = useState()\n  const classes = useWrapperStyles()\n  return (\n    <div className={classes.root}>\n      <OfflineBar />\n      <CssBaseline /> {/* You only need this in a root element. Don't put it anywhere else in the dom */}\n      <Paper className={classes.paper}>\n        <Typography variant='h5'>\n          This is a dummy component.\n        </Typography>\n      </Paper>\n      <BottomBar {...props} />\n    </div>\n  )\n}\n\nconst wrapperStyle = theme => ({\n  root: {\n    height: '100%',\n    display: 'flex',\n    flexDirection: 'column'\n  },\n  paper: {\n    flexGrow: 1\n  }\n})\n\nconst useWrapperStyles = makeStyles(wrapperStyle)\n","import React, { useContext, useEffect } from 'react'\nimport PropTypes from 'prop-types'\n\nimport CssBaseline from '@material-ui/core/CssBaseline'\n\nimport UploaderConnect from './graphql/Uploader.connect'\nimport SeriesConnect from './graphql/Series.connect'\nimport MapConnect from './graphql/Map.connect'\nimport SearchConnect from './graphql/Search.connect'\nimport ProfileConnect from './graphql/Profile.connect'\nimport FeedConnect from './graphql/Feed.connect'\nimport QRReader from './components/PhotoSeries/views/QRReader'\n\nimport OfflineBar from './components/misc/OfflineBar'\nimport BottomBar from './components/BottomBar'\nimport { AppContext } from './contexts'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport { home as homeConfig } from './config'\n\nimport { ThemeProvider } from '@material-ui/styles'\nimport themes from './themes'\n\nconst STATES = homeConfig.AppStateTypes\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    height: '100%',\n    overflow: 'hidden',\n    display: 'flex',\n    flexDirection: 'column'\n  },\n  offlineBar: {\n    flex: '0 0'\n  },\n  activeWrapper: {\n    overflow: 'hidden',\n    flexGrow: 1,\n    flexShrink: 1\n  },\n  uploaderContainer: {\n    zIndex: 2000,\n    flex: '0 0'\n  }\n}))\n\n/**\n * This is the over-arching wrapper for the app. It combines all the\n * same place. Time will tell if that's a good strategy.\n */\nconst App = ({ domain, onQRCapture, onMenuBack, setHomeState, onCameraClick, onLibraryClick, children }) => {\n  const classes = useStyles()\n  const { signedIn, user } = useContext(AppContext)\n\n  useEffect(() => {\n    // Anonymous Users are only allowed home and search\n    if (!signedIn && [STATES.MAP, STATES.SEARCH, STATES.SERIES, STATES.QRCAPTURE].indexOf(domain) < 0) setHomeState(STATES.MAP)\n  }, [domain])\n\n  let showBottomBar = true\n  let activeProps = {}\n  let ActiveComponent = FeedConnect\n  switch (domain) {\n    case STATES.FEED:\n      ActiveComponent = FeedConnect\n      break\n    case STATES.MAP:\n      ActiveComponent = MapConnect\n      break\n    case STATES.PROFILE:\n      ActiveComponent = ProfileConnect\n      activeProps = { user }\n      break\n    case STATES.SEARCH:\n      ActiveComponent = SearchConnect\n      break\n    case STATES.SERIES:\n      ActiveComponent = SeriesConnect\n      showBottomBar = false\n      break\n    case STATES.NEW_SERIES_CAMERA:\n      ActiveComponent = SeriesConnect\n      showBottomBar = false\n      break\n    case STATES.NEW_SERIES_LIBRARY:\n      ActiveComponent = SeriesConnect\n      showBottomBar = false\n      break\n    case STATES.QRCAPTURE:\n      ActiveComponent = QRReader\n      showBottomBar = false\n      activeProps = { onCapture: onQRCapture, onMenuBack }\n      break\n    default:\n      break\n  }\n\n  return (\n    <div className={classes.root}>\n      <CssBaseline /> {/* You only need this in a root element. Don't put it anywhere else in the dom */}\n      <OfflineBar className={classes.offlineBar} />\n      <div className={classes.activeWrapper}>\n        <ActiveComponent {...activeProps} />\n      </div>\n      { showBottomBar && (\n        <ThemeProvider theme={themes.bottombar}>\n          <BottomBar\n            signedIn={signedIn}\n            domain={domain}\n            onHomeClick={() => setHomeState(STATES.FEED)}\n            onMapClick={() => setHomeState(STATES.MAP)}\n            onSearchClick={() => setHomeState(STATES.SEARCH, { search: null })}\n            onProfileClick={() => setHomeState(STATES.PROFILE)}\n            onCameraClick={onCameraClick}\n            onLibraryClick={onLibraryClick}\n          />\n        </ThemeProvider>\n      )}\n      {/* Uploader is persistent across all views */}\n      <UploaderConnect className={classes.uploaderContainer} />\n      {children}\n    </div>\n  )\n}\n\nApp.propTypes = {\n  // All of this comes in from From Redux\n  domain: PropTypes.string.isRequired,\n  children: PropTypes.any,\n  setHomeState: PropTypes.func.isRequired,\n  onCameraClick: PropTypes.func.isRequired,\n  onLibraryClick: PropTypes.func.isRequired,\n  onQRCapture: PropTypes.func.isRequired,\n  onMenuBack: PropTypes.func.isRequired\n}\n\nexport default App\n","import React, { useEffect } from 'react'\nimport { Query, ApolloProvider, compose } from 'react-apollo'\nimport { IntlWrapper } from './translations'\nimport { getUser } from './graphql/queries'\nimport themes from './themes'\nimport { AppContext } from './contexts'\nimport Loading from './components/auth/Loading'\nimport ErrorBoundary from './lib/ErrorBoundary'\nimport ErrorConnect from './graphql/Error.connect'\nimport useGraphQL from './lib/useGraphQL'\nimport useAuthentication from './lib/useAuthentication'\nimport useShowAddToHome from './lib/useShowAddToHome'\nimport useResponsive from './lib/useResponsive'\nimport withReduxProvider from './redux/withReduxProvider'\nimport { connect } from 'react-redux'\nimport actions from './redux/actions'\nimport config, { home as homeConfig } from './config'\n\nimport App from './App'\nimport { ThemeProvider } from '@material-ui/styles'\n\n/**\n * HOC for AppContext and ApolloProvider\n */\nexport const withApolloAuthProvider = Wrapped => ({ onQRClick, setUseOffline, dismissInstall, flags, ...props }) => {\n  // console.log('withApolloAuthProvider', props)\n  const { isGod, signedIn, authData, signOut, authScreen, forceSignIn } = useAuthentication(flags.useLoggedOut, setUseOffline)\n\n  const apolloClient = useGraphQL()\n\n  // This triggers all the PWA Goodness\n  const { installPrompt, addToHomeScreen } = useShowAddToHome(flags.install, dismissInstall)\n  const responsive = useResponsive()\n\n  // If the user hasn't decided to be anonymous or sign in yet show them the login screen\n  // console.log('Rendering AppConnect', { flags, responsive, props, signedIn, isGod, authData })\n  useEffect(() => {\n    if (signedIn === true && flags.useLoggedOut) setUseOffline(false)\n    else if (signedIn === false && !flags.useLoggedOut) setUseOffline(true)\n  }, [signedIn])\n\n  if (signedIn === null && !flags.useLoggedOut) return authScreen\n\n  // These are the things the rest of the app needs to find:\n  const appContext = {\n    signOut,\n    forceSignIn: () => {\n      setUseOffline(false)\n      forceSignIn()\n    },\n    ...responsive,\n    signedIn: Boolean(signedIn),\n    role: !signedIn\n      ? 'nonuser'\n      : isGod\n        ? 'admin'\n        : 'user',\n    currentUser: authData, // TODO: Need this supported by a graphql query\n    onQRClick,\n    addToHomeScreen,\n    seriesConfig: {\n      meta: {},\n      tags: [\n        {\n          id: 'freeBothType',\n          label: null,\n          color: config.tagColors[0],\n          allowXY: true,\n          allowNonXY: true,\n          allowAdditions: true,\n          // This one returns a promise\n          getValues: () => Promise.resolve(['a', 'b', 'c']),\n          values: []\n        }\n      ],\n      getPhotoUrl: (photo, size) => {\n        try {\n          return `${photo.paths.base}${photo.paths[size]}`\n        }\n        catch (e) {\n          return null\n        }\n      }\n    }\n  }\n\n  return (\n  // We wrap the outside in an error handler\n\n    <ThemeProvider theme={themes.home}>\n      <ApolloProvider client={apolloClient}>\n        <Query query={getUser} skip={!signedIn}>\n          {({ loading, error, data }) => {\n            if (loading) return <Loading />\n            if (error) {\n              console.error(error)\n            }\n            if (signedIn) appContext.user = data.user\n            return (\n              <AppContext.Provider value={appContext}>\n                <IntlWrapper>\n                  <Wrapped {...props}>\n                    {installPrompt}\n                  </Wrapped>\n                </IntlWrapper>\n              </AppContext.Provider>\n            )\n          }}\n        </Query>\n      </ApolloProvider>\n    </ThemeProvider>\n  )\n}\n\n/**\n * Map our redux state and functions\n */\nconst mapStateToProps = (state, props) => {\n  const { domain } = state.home.current\n  return { domain, flags: state.flags }\n}\n\nconst mapDispatchToProps = dispatch => ({\n  setHomeState: (newDomain, newParams) => {\n    dispatch(actions.setHomeState(newDomain, newParams))\n  },\n  onCameraClick: () => {\n    dispatch(actions.setHomeState(homeConfig.AppStateTypes.NEW_SERIES_CAMERA))\n  },\n  onLibraryClick: () => {\n    dispatch(actions.setHomeState(homeConfig.AppStateTypes.NEW_SERIES_LIBRARY))\n  },\n  dismissInstall: () => {\n    dispatch(actions.setFlag('install', false))\n  },\n  setUseOffline: (bVal) => {\n    dispatch(actions.setFlag('useLoggedOut', bVal))\n  },\n  onQRClick: () => {\n    dispatch(actions.setHomeState(homeConfig.AppStateTypes.QRCAPTURE))\n  },\n  onMenuBack: () => {\n    dispatch(actions.homeStateBack())\n  },\n  onQRCapture: (type, activeSeries) => {\n    switch (type) {\n      case 'series':\n        dispatch(actions.setHomeState(homeConfig.AppStateTypes.SERIES, { activeSeries }))\n        break\n      default:\n        break\n    }\n  }\n})\n\nconst withErrorBoundary = (Wrapped) => (props) => (\n  <ErrorBoundary fallback={ErrorConnect}>\n    <Wrapped {...props} />\n  </ErrorBoundary>\n)\n\n/**\n * Nearly everything we do depends on who you are as a user so we commit this to state\n */\n\n// The order we compose things here matters a lot\nexport default compose(\n  // ORDER IS CRITICAL HERE\n  withReduxProvider,\n  connect(\n    mapStateToProps,\n    mapDispatchToProps\n  ),\n  withApolloAuthProvider,\n  withErrorBoundary\n)(App)\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n)\n\nexport function register (config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href)\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config)\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\n          )\n        })\n      }\n      else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config)\n      }\n    })\n  }\n}\n\nfunction registerValidSW (swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing\n        if (installingWorker == null) {\n          return\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n              )\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration)\n              }\n            }\n            else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.')\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration)\n              }\n            }\n          }\n        }\n      }\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error)\n    })\n}\n\nfunction checkValidServiceWorker (swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type')\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload()\n          })\n        })\n      }\n      else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config)\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      )\n    })\n}\n\nexport function unregister () {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister()\n    })\n  }\n}\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport AppConnect from './App.connect'\nimport * as serviceWorker from './serviceWorker'\n// Here's our global overrides css\nimport './index.css'\n// This is the font we need\nrequire('typeface-roboto')\n\nconsole.log('Rendering Main App')\nReactDOM.render(<AppConnect />, document.getElementById('root'))\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.register()\n"],"sourceRoot":""}