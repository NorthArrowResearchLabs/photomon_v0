{"version":3,"sources":["config.js","components/PhotoSeries/views/tags/XYTagChip.style.js","components/PhotoSeries/views/tags/XYTagChip.jsx","components/PhotoSeries/views/tags/XYTagSelect.jsx","components/PhotoSeries/views/tags/XYTagSelect.style.js","components/PhotoSeries/views/tags/XYTagChooser.jsx","components/PhotoSeries/views/tags/XYTagChooser.style.js","components/PhotoSeries/views/tags/useXYTags.js","components/PhotoSeries/views/subViews/BrokenImg.jsx","components/PhotoSeries/views/subViews/Photo.jsx","components/PhotoSeries/views/subViews/Photo.style.js","lib/useComponentSize.js","lib/sensors.js","lib/SeriesConfig.js","components/PhotoSeries/views/tags/TagChip.jsx","components/PhotoSeries/views/controls/ShortLongText.jsx","lib/Tags.js","components/maps/markers/Dot.jsx","components/maps/BaseStaticMap.jsx","components/maps/MapDot.jsx","mapStyles/index.js","components/maps/controls/StyleButtons.jsx","components/PhotoSeries/views/dialogs/BigText.jsx","components/PhotoSeries/views/dialogs/DeleteDialog.jsx","components/PhotoSeries/views/dialogs/BigTextEdit.jsx","components/PhotoSeries/views/controls/PhotoFadeSlider.jsx","components/PhotoSeries/views/controls/TagControl.style.js","components/PhotoSeries/views/controls/TagView.jsx","components/PhotoSeries/views/controls/DateControl.jsx","components/PhotoSeries/views/controls/TagControl.jsx","components/PhotoSeries/views/dialogs/TagEdit.jsx","components/PhotoSeries/views/controls/DateView.jsx","components/PhotoSeries/views/subViews/PhotoInfoInner.jsx","components/PhotoSeries/views/dialogs/MapDirPicker.jsx","components/PhotoSeries/views/subViews/SeriesEditInner.jsx","components/PhotoSeries/views/subViews/SeriesEditInner.style.js","components/maps/markers/MyLocation.jsx","components/maps/controls/MyLocationButton.jsx","components/maps/BaseMap.jsx","components/PhotoSeries/views/subViews/PhotoGrid.jsx","components/PhotoSeries/views/subViews/PhotoGrid.style.js","components/PhotoSeries/views/NewPhoto.jsx","lib/Photo.js","lib/Series.js","lib/datelib.js","lib/useCamera.js","components/PhotoSeries/views/CameraTool.jsx","components/PhotoSeries/views/CameraTool.style.js","components/PhotoSeries/views/NewPhotoInfo.jsx","components/PhotoSeries/views/NewPhotoInfo.style.js","components/PhotoSeries/views/PhotoReviewTool.jsx","components/PhotoSeries/views/PhotoReviewTool.style.js","lib/useFileInput.js","components/PhotoSeries/views/controls/LibraryFilePicker.jsx","components/PhotoSeries/contexts.js","lib/util.js","translations.js","graphql/queries.js","themes/index.js","contexts.js","components/auth/useAuthCommon.js","icons/AppLogo.jsx","components/auth/AuthContainer.jsx","components/auth/Loading.jsx","lib/ErrorBoundary.jsx","components/misc/ErrorScreen.jsx","graphql/mutations.js","graphql/Error.connect.js","lib/useGraphQL.js","components/auth/auth.style.js","components/auth/SignIn.jsx","components/auth/ConfirmSignIn.jsx","components/auth/RequireNewPassword.jsx","components/auth/SignUp.jsx","components/auth/ConfirmSignUp.jsx","components/auth/ForgotPassword.jsx","lib/useAuthentication.js","lib/useShowAddToHome.js","lib/useResponsive.js","redux/actions.js","redux/reducers/map.js","redux/reducers/home.js","redux/reducers/uploader.js","redux/reducers/index.js","redux/storeConfig.js","redux/withReduxProvider.js","components/UploadControl.jsx","lib/s3upload.js","graphql/Uploader.connect.js","permissions.js","components/PhotoSeries/views/controls/AddFab.jsx","components/PhotoSeries/views/controls/ContextMenu.jsx","components/PhotoSeries/views/subViews/SeriesInfo.jsx","components/PhotoSeries/views/subViews/SeriesInfo.style.js","components/PhotoSeries/views/subViews/SwipeShow.jsx","components/PhotoSeries/views/subViews/SwipeShow.style.js","components/PhotoSeries/views/SeriesView.style.js","components/PhotoSeries/views/SeriesView.jsx","components/PhotoSeries/views/SeriesEdit.jsx","components/PhotoSeries/views/SeriesEdit.style.js","components/PhotoSeries/views/Slideshow.jsx","components/PhotoSeries/views/Slideshow.style.js","components/PhotoSeries/views/dialogs/CancelConfirm.jsx","components/PhotoSeries/views/subViews/PhotoInfo.jsx","components/PhotoSeries/views/PhotoViewTool.jsx","components/PhotoSeries/views/PhotoViewTool.style.js","lib/AccessHelper.js","components/PhotoSeries/views/SeriesNotFound.jsx","components/PhotoSeries/views/SeriesLoading.jsx","components/PhotoSeries/index.jsx","lib/localdb.js","graphql/Series.connect.js","lib/useClusteredData.js","components/maps/HomeMap.style.js","icons/AppLogoSimple.jsx","components/TopBar.jsx","components/Search/SearchInput.jsx","components/misc/SeriesListItem.jsx","components/misc/ClusterSelected.jsx","components/maps/markers/Single.jsx","components/maps/markers/Cluster.jsx","components/maps/HomeMap.jsx","graphql/Map.connect.js","components/Search/SearchContextItem.jsx","components/Search/SearchContextResults.jsx","components/Search/SearchEnder.jsx","components/Search/SearchResults.jsx","components/Search/SearchPlaceholder.jsx","lib/useOnline.js","components/Search/Search.jsx","graphql/Search.connect.js","components/MyProfile/MeCard.jsx","components/MyProfile/MyProfile.jsx","graphql/Profile.connect.js","components/MyFeed/FeedEnder.jsx","components/misc/FindOnMapButton.jsx","components/MyFeed/FeedItem.jsx","components/MyFeed/MyFeed.jsx","graphql/Feed.connect.js","components/misc/OfflineBar.jsx","components/BottomBar.jsx","App.jsx","App.connect.js","serviceWorker.js","index.js"],"names":["__webpack_require__","d","__webpack_exports__","mapConfig","home","endpoints","localDb","aws","ACCESS","_mapStyles__WEBPACK_IMPORTED_MODULE_0__","_material_ui_core_colors__WEBPACK_IMPORTED_MODULE_1__","_material_ui_core_colors__WEBPACK_IMPORTED_MODULE_2__","_material_ui_core_colors__WEBPACK_IMPORTED_MODULE_3__","tagColors","mapBoxToken","process","styles","MapStyles","baseurl","REACT_APP_BASEURL","console","log","AppStateTypes","FEED","MAP","SEARCH","PROFILE","SERIES","NEW_SERIES_CAMERA","NEW_SERIES_LIBRARY","SEARCH_TABS","TAG","LOCATION","USER","MapModeTypes","FREE","graphql","imgStore","Auth","region","userPoolId","userPoolWebClientId","mandatorySignIn","cookieStorage","domain","concat","expires","secure","OPEN","label","description","color","green","PRIVATE","red","PUBLIC","blue","tagChips","useStyles","makeStyles","theme","xyTagChip","cursor","fontSize","background","height","position","left","top","editing","reversedChip","flexDirection","right","deleteIcon","width","chipAvatarIcon","chipAvatar","reversedDelete","margin","chipBucket","display","reversedChipBucket","XYTagChip","_ref","edit","tag","newSize","onTagDragOver","onTagDragStop","onTagDelete","onNewTag","props","Object","objectWithoutProperties","isReversed","relCoords","x","newWidth","classes","useTheme","stopBadness","e","preventDefault","stopPropagation","react_default","a","createElement","react_draggable_default","disabled","bounds","bottom","newHeight","y","onDrag","data","onStop","onClick","className","classNames","Chip","assign","style","palette","getContrastText","id","onDelete","Cancel_default","avatar","Avatar","MyLocation_default","root","noOptionsMessage","padding","spacing","singleValue","placeholder","input","valueContainer","flexWrap","flex","alignItems","overflow","paper","zIndex","marginTop","XYTagSelect","tagConfig","onChange","options","values","map","tc","value","allowAdditions","react_select_esm","components","Control","Menu","NoOptionsMessage","Option","Placeholder","ValueContainer","blurInputOnSelect","isClearable","isSearchable","Creatable_default","TextField","fullWidth","InputProps","inputComponent","inputProps","objectSpread","selectProps","inputRef","innerRef","children","innerProps","textFieldProps","_ref2","Typography","_ref3","Paper","square","_ref4","ref","_ref5","isFocused","isSelected","MenuItem","buttonRef","selected","component","fontWeight","_ref6","header","listItem","dlgBody","paddingLeft","paddingRight","paddingBottom","closeButton","grey","XYTagChooser","coords","open","seriesConfig","onClose","xyTags","tags","filter","t","allowXY","Dialog","scroll","fullScreen","paperScrollPaper","aria-labelledby","DialogTitle","IconButton","Close_default","length","variant","tagType","idx","key","tags_XYTagSelect","useXYTags","photo","setResizeActive","useContext","SeriesContext","_useState","useState","_useState2","slicedToArray","isDragging","setIsDragging","_useState3","_useState4","newTagDialog","setNewTagDialog","tagClass","Tags","addTag","__isNew__","createNewXYTagObj","createExistingXYTagObj","toConsumableArray","updateTagLocation","oldTag","newX","parseInt","multiplier","newY","onAddTagTrigger","pageX","window","innerWidth","pageY","innerHeight","TagChooser","tags_XYTagChooser","Boolean","getRelXYTags","flexGrow","opacity","textAlign","icon","primary","secondary","BrokenImg","BrokenImage_default","inner","transform","img","brokenImg","formControl","Photo","showTags","transition","refImgWrap","useRef","setNewSize","url","setUrl","_useState5","_useState6","broken","setBroken","_useState7","_useState8","urlRetryCounter","setURLRetryCounter","useEffect","base64","current","newUrl","getPhotoUrl","getURL","_useComponentSize","useComponentSize","_useComponentSize$siz","size","urlWithRetries","_useXYTags","tags_XYTagChip","subViews_BrokenImg","alt","onError","err","error","setTimeout","src","onLoad","event","_event$target","target","naturalHeight","naturalWidth","Math","min","getSize","el","minSize","defaultSize","max","offsetWidth","offsetHeight","resizeActiveRef","_Users_matt_Work_Git_PBR_PhotoMonitoring_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_0__","resizeActive","setComponentSize","handleResize","handleResizeDebounced","useCallback","debounce","useLayoutEffect","ResizeObserver","resizeObserver","observe","disconnect","addEventListener","removeEventListener","useGeolocation","accuracy","altitude","altitudeAccuracy","heading","latitude","longitude","speed","timestamp","Date","now","state","setState","mountedRef","watchIdRef","onEvent","navigator","geolocation","getCurrentPosition","watchPosition","clearWatch","useDeviceOrientation","absolute","alpha","beta","gamma","deviceOrientation","setDeviceOrientation","handleDeviceOrientation","isIos","test","userAgent","vendor","opera","isPhone","substr","TYPES","SeriesConfig","_this","this","_Users_matt_Work_Git_PBR_PhotoMonitoring_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_2__","getTagType","typeId","config","find","tt","getTagTypeIndex","findIndex","getXYTagTypes","getNonXYTagTypes","allowNonXY","getSeriesMeta","keys","meta","type","reduce","acc","_Users_matt_Work_Git_PBR_PhotoMonitoring_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_1__","_Users_matt_Work_Git_PBR_PhotoMonitoring_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_defineProperty__WEBPACK_IMPORTED_MODULE_0__","default","getPhotoMeta","Error","marginRight","TagChip","_Users_matt_Work_Git_PBR_PhotoMonitoring_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectWithoutProperties__WEBPACK_IMPORTED_MODULE_0__","react__WEBPACK_IMPORTED_MODULE_1___default","_material_ui_core_Chip__WEBPACK_IMPORTED_MODULE_2__","_material_ui_icons_Cancel__WEBPACK_IMPORTED_MODULE_3___default","react__WEBPACK_IMPORTED_MODULE_0__","react__WEBPACK_IMPORTED_MODULE_0___default","n","classnames__WEBPACK_IMPORTED_MODULE_1__","classnames__WEBPACK_IMPORTED_MODULE_1___default","_material_ui_core_Typography__WEBPACK_IMPORTED_MODULE_2__","_material_ui_core_FormLabel__WEBPACK_IMPORTED_MODULE_3__","_material_ui_core_styles__WEBPACK_IMPORTED_MODULE_4__","whiteSpace","&::before","content","ShortLongText","text","formLabel","defaultProps","_Users_matt_Work_Git_PBR_PhotoMonitoring_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_1__","findTagById","tagId","getXYTags","xyTagIds","indexOf","getNonXYTags","NonXYTagIds","createNewTagObj","uuid","createExistingTagObj","_Users_matt_Work_Git_PBR_PhotoMonitoring_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_objectSpread__WEBPACK_IMPORTED_MODULE_0__","group","main","transformOrigin","rootActive","svgDot","dot","stroke","contrastText","strokeWidth","fill","directionIndicator","name","textShadow","nameActive","dark","Single","direction","version","viewBox","cx","cy","r","svgArc","fillOpacity","strokeOpacity","BaseStaticMap","controlPadding","viewport","mapStyles","onMapDataEvent","passthroughProps","mapRef","currStyle","setCurrStyle","projection","setProjection","recalcProjection","getDistanceScales","useMemo","esm","mapStyle","onData","mapboxApiAccessToken","StyleButtons","Array","isArray","c","handleChild","child","stylechooser","initStyle","MapDot","staticMap","editable","Map","BaseMap","mapProps","touchRotate","dragRotate","showMe","lockPan","onViewportChange","Dot","_Satellite_json__WEBPACK_IMPORTED_MODULE_0__","_TopoMap_json__WEBPACK_IMPORTED_MODULE_1__","_material_ui_icons__WEBPACK_IMPORTED_MODULE_2__","_material_ui_icons__WEBPACK_IMPORTED_MODULE_3__","_material_ui_icons__WEBPACK_IMPORTED_MODULE_4__","_material_ui_icons__WEBPACK_IMPORTED_MODULE_5__","toolTip","Icon","SatelliteOutlined","ActiveIcon","SatIcon","Satellite","TerrainOutlined","Terrain","TopoMap","speedDialFab","border","speedDialAction","marginBottom","speedDialIcon","speedDialLabel","actionsClosed","setOpen","noEventSetOpen","_material_ui_lab_SpeedDial__WEBPACK_IMPORTED_MODULE_2__","ariaLabel","speedDial","fab","_material_ui_lab_SpeedDialAction__WEBPACK_IMPORTED_MODULE_3__","tooltipPlacement","ButtonProps","TooltipClasses","tooltip","tooltipTitle","tooltipOpen","_material_ui_core_Typography__WEBPACK_IMPORTED_MODULE_1__","_material_ui_core_DialogContent__WEBPACK_IMPORTED_MODULE_2__","_material_ui_core_Dialog__WEBPACK_IMPORTED_MODULE_3__","_material_ui_core_IconButton__WEBPACK_IMPORTED_MODULE_4__","_material_ui_core_DialogTitle__WEBPACK_IMPORTED_MODULE_5__","_material_ui_icons_Close__WEBPACK_IMPORTED_MODULE_6__","_material_ui_icons_Close__WEBPACK_IMPORTED_MODULE_6___default","_material_ui_core_styles__WEBPACK_IMPORTED_MODULE_7__","body","title","alignSelf","dlgTitle","BigText","maxWidth","disableTypography","_material_ui_core_Dialog__WEBPACK_IMPORTED_MODULE_1__","_material_ui_core_DialogTitle__WEBPACK_IMPORTED_MODULE_2__","_material_ui_core_DialogContent__WEBPACK_IMPORTED_MODULE_3__","_material_ui_core_Button__WEBPACK_IMPORTED_MODULE_4__","_material_ui_core_Typography__WEBPACK_IMPORTED_MODULE_5__","_material_ui_core_DialogActions__WEBPACK_IMPORTED_MODULE_6__","DeleteDialog","message","onConfirm","disableBackdropClick","disableEscapeKeyDown","BigTextEdit","onOk","multiline","setValue","_material_ui_core_DialogTitle__WEBPACK_IMPORTED_MODULE_7__","_material_ui_core_TextField__WEBPACK_IMPORTED_MODULE_5__","rows","rowsMax","defaultValue","_material_ui_core_DialogActions__WEBPACK_IMPORTED_MODULE_4__","_material_ui_core_Button__WEBPACK_IMPORTED_MODULE_6__","sliderLabel","container","track","thumb","PhotoFadeSlider","slider","setSlider","_material_ui_lab_Slider__WEBPACK_IMPORTED_MODULE_3__","vertical","TagControl_style","tagContainer","actionButtons","TagControl","tagValues","fieldTitle","rootEdit","textBody","DateControl","hint","timestampToHTML5Input","textField","HTML5InputToTimestamp","controls_TagControl","onSelectChange","inputValue","action","removedValue","option","val","newVal","tcv","newCreateVal","v","selectOptions","remainingTags","deleteRemoves","isMulti","onMouseDown","onTouchEnd","_ref7","_ref8","_ref9","dlgContent","overflowY","TagEdit","onCancel","DialogContent","field","DialogActions","Button","DateView","formatDate","dlgTitleContainer","catTagTitle","paddingTop","DIALOGS","PhotoInfo","canEdit","delta","_useState2$","activeDialog","activeDialogContext","setActiveDialog","tagInst","TagClass","metaKeys","JSON","parse","controls_DateControl","takenOn","controls_DateView","note","Divider","TagView","Fragment","List","list","ListItem","ListItemText","render","dialogs_TagEdit","mapWrapper","sliderWrapper","sliderRoor","MapDirPicker","initLat","initLong","initDir","setCoords","setRotation","initViewport","zoom","_ref2$viewport","FormLabel","mapFormLabel","Slider","step","access","accessRadio","grow","marginLeft","mapInnerWrap","minHeight","minWidth","chips","SeriesEditInner","series","FormControlLabel","control","Switch","checked","dialogs_MapDirPicker","newNote","svgAccuracyDot","MyLocation","accHeight","pixelsPerMeter","accWidth","MyLocationButton","Fab","aria-label","lockToBounds","incomingOnViewportChange","incomingOnTransitionStart","onTransitionStart","incomingOnTransitionEnd","onTransitionEnd","transitions","mapContainerRef","mapBoxRef","innerTransitionsRef","defaultViewVals","setViewport","isTransitioning","setIsTransitioning","myPosition","geoMarker","markers_MyLocation","viewportChange","newViewport","getMap","_bounds","minlng","minlat","maxlng","maxlat","_fitBounds","WebMercatorViewport","fitBounds","offset","dragPan","React","cloneElement","hideNavControls","showZoom","touchZoom","scrollZoom","showCompass","controls_MyLocationButton","transitionDuration","transitionInterpolator","FlyToInterpolator","transitionEasing","easeCubic","bearing","pitch","tile","addFab","notDeleteable","unSelectedTile","& img","selectedTile","snackbarContent","backgroundColor","snackbar","PhotoGrid","photos","columns","multiSelect","onTileClick","selectMode","setSelectMode","selectedItems","setSelectedItems","deleteConfirm","setDeleteConfirm","_useContext","ac","handleCancelSelection","toggleListItem","remaining","arrId","sortedPhotos","sort","b","GridList","cols","cellHeight","canDelete","canUser","photoUrl","GridListTile","handlePhotoTap","handleAddToSelection","Remove_default","Add_default","GridListTileBar","Snackbar","autoHideDuration","ContentProps","aria-describedby","confirmation","MODES","NewPhoto","inputMethod","onCreate","isNewSeries","_Users_matt_Work_Git_PBR_PhotoMonitoring_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_2__","newPhoto","setNewPhoto","SeriesClass","newSeries","setNewSeries","photoRefId","setPhotoRefId","history","mode","_changeMode","orientation","geo","changeMode","newModeName","_Users_matt_Work_Git_PBR_PhotoMonitoring_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_toConsumableArray__WEBPACK_IMPORTED_MODULE_0__","react__WEBPACK_IMPORTED_MODULE_3___default","_CameraTool__WEBPACK_IMPORTED_MODULE_7__","onShutter","refId","photoInitObj","PhotoClass","exif","foundIdx","newData","slice","parser","exifParser","create","Buffer","from","stringify","rawData","orient","geolocate","_controls_LibraryFilePicker__WEBPACK_IMPORTED_MODULE_9__","onLibraryAdd","date","String","DateTimeOriginal","GPSLatitude","isNumeric","GPSLongitude","fullNewPhotoObject","_PhotoReviewTool__WEBPACK_IMPORTED_MODULE_6__","defaultRefPhotoId","captured","onRetry","oldHistory","oldMode","pop","_NewPhotoInfo__WEBPACK_IMPORTED_MODULE_8__","onSave","_Users_matt_Work_Git_PBR_PhotoMonitoring_client_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__","setMeta","convertJSDatetoTimestamp","Series","formatDatAgo","moment__WEBPACK_IMPORTED_MODULE_0__","moment__WEBPACK_IMPORTED_MODULE_0___default","utctimestamp","format","arguments","undefined","moment","fromNow","jsDate","utc","isoStr","Webcam","webcamElement","canvasElement","classCallCheck","location","protocol","hostname","warn","mediaDevices","getUserMedia","aspectRatio","srcObject","getTracks","stop","Promise","resolve","reject","audio","video","facingMode","then","mediaStream","URL","createObjectURL","onloadedmetadata","play","onplaying","catch","imageWidth","videoWidth","imageHeight","videoHeight","context","getContext","drawImage","_this2","_this$_drawImage","_drawImage","toBlob","blob","quality","_this$_drawImage2","toDataURL","cameraErrorText","disabledFab","cameraFab","@media (orientation: landscape)","@media (orientation: portrait)","cameraIcon","cancelFab","cancelIcon","swipeDrawer","libraryFab","myLocationFab","myLocationIcon","capturedContainer","referenceContainer","reference","CameraTool","newRefPhoto","p","refPhoto","setRefPhoto","drawerOpen","setDrawerOpen","_useCamera","onCapture","cameraError","setCameraError","cameraOnline","setCameraOnline","camRef","initCamera","document","getElementById","setup","captureImage","asyncToGenerator","regenerator_default","mark","_callee","capturedData","wrap","_context","prev","next","takeBase64Photo","apply","delayedOrientationChange","destroy","useCamera","CssBaseline","autoPlay","playsInline","muted","buttonFab","Camera_default","PhotoLibrary_default","libraryIcon","SwipeableDrawer","anchor","paperAnchorLeft","onOpen","tabIndex","swipeDrawerContainer","role","onKeyDown","NewPhotoInfo","seriesDelta","setSeriesDelta","photoDelta","setPhotoDelta","PhotoInfoInner","newAttr","referenceTextContainer","newText","refText","PhotoReviewTool","useFileInput","clickRef","element","handleChange","evt","file","files","reader","FileReader","onload","result","readAsDataURL","click","fileClickEl","forceClick","LibraryFilePicker","_useFileInput","createContext","num","isNaN","parseFloat","isFinite","func","wait","immediate","timeout","_len","innerArgs","_key","callNow","clearTimeout","addLocaleData","frLocaleData","IntlWrapper","index_es","locale","allSeries","gql","_templateObject","pollQuery","_templateObject2","userSeries","_templateObject3","seriesFromList","_templateObject4","seriesWithTag","_templateObject5","tagSearch","_templateObject6","getUser","_templateObject7","_templateObject8","geocode","_templateObject9","getMyFeed","_templateObject10","userSearch","_templateObject11","getWholeSeries","_templateObject12","typography","useNextVariants","colors","fade","topbar","bottombar","login","themes","createMuiTheme","AppContext","useAuthCommon","containerRef","handleKeyPress","found","getElementsByClassName","createSvgIcon","bgSwoosh","logo","AuthContainer","ThemeProvider","AppLogo","Loading","auth_AuthContainer","ErrorBoundary","possibleConstructorReturn","getPrototypeOf","call","hasError","info","_this$state","FallbackUI","fallback","Component","SEND_STATES","button","stack","fontFamily","ErrorScreen","sendState","reportError","dlgOpen","setDialogOpen","setNote","buttonText","Error_default","BugReport_default","DialogContentText","autoFocus","deletePhoto","mutations_templateObject","deleteSeries","mutations_templateObject2","updateSeries","mutations_templateObject3","updatePhoto","mutations_templateObject4","createPhoto","mutations_templateObject5","createSeries","mutations_templateObject6","watchSeries","mutations_templateObject7","unWatchSeries","mutations_templateObject8","reportBug","mutations_templateObject9","withReportBugMutation","mutate","_ref$ownProps","ownProps","reduxState","reportJSON","errObj","env","toString","variables","update","store","connect","other","uploader","newMap","Wrapped","LOCAL_STORAGE_TOKEN","auth_style","spacer","forgotPassword","switch","switchButton","&:last-child","borderRadius","&:first-child","phoneNumInner","phoneNumDropdown","warnText","fontStyle","noSignin","SignIn","loading","handleSignup","handleForgotPassword","federated","handleInputChange","handleBeAnonymous","handleSignIn","autoComplete","Link","Toolbar","disableGutters","ConfirmSignIn","handleBack","handleConfirm","RequireNewPassword","change","requiredAttributes","placeholders","attribute","SignUp","signUpFields","signUpFieldLabels","signUpFieldPlaceholders","countryDialCodes","defaultDialCode","selectVal","setSelectVal","handleDialCodeChange","f","FormControl","InputLabel","htmlFor","shrink","required","Select","dialCode","ConfirmSignUp","handleResend","resendCode","ForgotPassword","handleSubmit","handleSendCode","sent","setSent","Amplify","configure","defaultAuthState","authState","authData","signedIn","lib_useAuthentication","setAuth","authScreen","dist","onStateChange","hideDefault","useAuthentication_SignIn","useAuthentication_Loading","useAuthentication_RequireNewPassword","useAuthentication_ConfirmSignIn","useAuthentication_ConfirmSignUp","useAuthentication_ForgotPassword","useAuthentication_SignUp","accessToken","signInUserSession","jwtToken","isGod","idToken","payload","signOut","forceSignIn","newProps","changeState","signIn","auth_SignIn","SignInOrig","hide","includes","checkCustomSignUpFields","signUpConfig","sortFields","getDefaultDialCode","I18n","get","signUp","auth_SignUp","SignUpOrig","_this3","confirm","auth_ConfirmSignIn","ConfirmSignInOrig","_this4","resend","auth_ConfirmSignUp","ConfirmSignUpOrig","challengeParam","split","part","charAt","toUpperCase","toLowerCase","join","auth_RequireNewPassword","RequireNewPasswordOrig","auth_Loading","LoadingOrig","_this5","send","submit","auth_ForgotPassword","ForgotPasswordOrig","useShowAddToHome","deferredPrompt","handleBeforePrompt","a2hsBtn","querySelector","addToHomeScreen","showAddToHomeScreen","prompt","userChoice","choiceResult","outcome","standalone","getState","_window","_window$screen","screen","wOrient","bIsIos","windowSize","screenSize","useResponsive","mediQueries","newState","Actions","actions","newDomain","params","seriesId","initialPhoto","viewportSave","uploadObj","newProgress","mapInit","homeInit","initState","activeUpload","combineReducers","newStateHistory","activeSeries","newParams","newStore","newActive","persistConfig","storage","persistedReducer","persistReducer","rootReducer","storeConfig","preloadedState","createStore","compose","applyMiddleware","thunk","persistor","persistStore","withReduxProvider","BaseComponent","_storeConfig","es","integration_react","msgText","messageInner","UploadControl","progress","LinearProgress","UploadControlCOSMOSWrapper","useWrapperStyles","displayName","updateUploadProgress","completeActiveUpload","formData","FormData","preAuth","fields","forEach","fieldkey","append","dataURLtoFile","headers","Content-Type","onUploadProgress","progressEvent","loaded","total","floor","axios","post","dataurl","filename","arr","mime","match","bstr","atob","u8arr","Uint8Array","charCodeAt","File","interceptors","request","use","response","dispatch","uploadingRef","_x","_x2","_x3","_doUpload","s3Upload","components_UploadControl","permissions","admin","create:own","read:any","update:any","delete:any","create:any","nonuser","series_public","series_open","user","read:own","update:own","delete:own","pulseCol","light","boxShadow","animation","@keyframes fabPulse","0%","70%","100%","directionUp","AddFab","onCameraClick","onLibraryClick","down","setDown","downRef","onDown","currentTarget","block","SpeedDial","onBlur","onTouchStart","SpeedDialAction","AddAPhoto_default","ContextMenu","anchorEl","menuItems","divider","ListItemIcon","primaryTypographyProps","tagListItem","chip","SeriesInfo","seriesConfigInst","SeriesConfigClass","newTags","existing","count","defineProperty","tagKey","idtk","subheading","photoWrapper","dateCaption","mobileStepper","manualBack","manualForward","tagButton","slideshowButton","dots","SwipeShow","onImageSelect","initPhotoIndex","activePhoto","setActivePhoto","setShowTags","singular","react_swipeable_views_lib_default","axis","index","onChangeIndex","enableMouseEvents","KeyboardArrowRight_default","KeyboardArrowLeft_default","subtitle","actionIcon","Badge","badgeContent","Label_default","MobileStepper","steps","activeStep","isFullScreen","slides","SeriesView_style","appBar","-webkit-overflow-scrolling","tabMenu","mapWrap","toolbarTitle","textOverflow","gridList","titleBar","menuButton","SeriesView","onSlideshowStart","onEditSeries","onDeletePhotos","onCameraAdd","onDeleteSeries","onMenuBack","onWatch","onUnWatch","watching","owned","contextEl","setContextEl","can","delete","contribute","listTypeTab","setListTypeTab","AppBar","ArrowBack_default","Slideshow_default","aria-haspopup","MoreVert_default","controls_ContextMenu","AddAlertIcon","EditIcon","DeleteIcon","Tabs","Tab","subViews_SwipeShow","subViews_SeriesInfo","controls_AddFab","SeriesEdit","setDelta","swipeAble","slideContainer","slide","dotActive","iconButton","active","last","labelBadge","tagChip","Slideshow","_useStepper","useStepper","lastStep","handleForward","paused","pause","showXYTags","setShowXYTags","duration","titlePosition","PlayCircleFilled_default","PauseCircleFilled_default","nextButton","backButton","interval","setActiveStep","setPaused","setLastStep","timerRef","createTimer","setInterval","oldStep","destroyTimer","clearInterval","CancelConfirm","dirty","newDelta","dialogs_CancelConfirm","appBarEdit","tipChip","activeButton","STATES","PhotoViewTool","initPhotoId","onUpdatePhoto","setMode","tagsClass","desired","onCommitTags","infoButton","Info_default","containerStyle","photoidx","subViews_PhotoInfo","AccessHelper","userSub","permissionObj","ownOrAny","obj","createdUser","isOwner","attrs","ownAny","perm","otherPerm","attributes","granted","AccessControl","sub","SeriesNotFound","notFound","SeriesLoading","VIEW_ONLY_MODES","RepeatablePhotos","modeName","inputMethodINIT","currentUserId","currentUserRole","accessControl","onNewSeries","onChangePhoto","onNewPhoto","onDeletePhoto","AccesHelper","seriesState","pid","ph","onApprovePhoto","onCreateSeries","_callee2","onNewSeriesReturn","_context2","newPid","newInputMethod","canUpdate","to","lastMode","views_SeriesLoading","views_SeriesNotFound","views_SeriesView","photoIdArr","sp","views_SeriesEdit","views_PhotoViewTool","views_Slideshow","contexts","Provider","localUUID","openDb","upgradeDB","createObjectStore","prefix","uuidv4","withGetSelectedQuery","skip","withUpdateSeriesMutation","_ref10","updateSeriesMutation","sanitizeUpdateParams","optimisticResponse","__typename","_ref11","qdata","readQuery","query","writeQuery","qdataAll","limit","summary","seriesSummaries","s","withUpdatePhotoMutation","_ref12","updatePhotoMutation","sanitizedPhotoDelta","newT","_ref13","updatedPhoto","withDeleteSeriesDeleteMutation","_ref14","deleteSeriesMutation","_ref15","withDeletePhotoMutation","_ref16","deletePhotoMutation","photoId","_ref17","finalCount","photoCount","withCreateNewSeries","_ref18","createSeriesMutation","featured","_ref19","newAllSeriesEntry","push","withCreateNewPhoto","_ref20","createPhotoMutation","ext","newPhotoInput","createdOn","username","Username","updatedBy","updatedOn","paths","large","orig","medium","_ref21","withWatchSeriesMutation","_ref22","watchSeriesMutation","_ref23","withUnWatchSeriesMutation","_ref24","unWatchSeriesMutation","_ref25","connectedWithApollo","onAfterSeriesDelete","onBack","queueUpload","doneCreatingSeries","currentUser","PhotoSeries","photoNoId","photoData","abrupt","_state$home$current","inputObj","desiredParams","newDesiredParams","remainder","useClusteredData","filterBounds","currentZoom","sizeScale","queryVersion","clusteredData","setClusteredData","single","cluster","filteredData","setFilteredData","setVersion","updateDataDebounce","updatedData","_args","updateData","filterDataDebounce","filtered","_args2","filterData","filteredClusteredData","tree","rbush","screenCoords","project","properties","zoomLevels","geoJSON","point","clear","load","_loop","z","radius","sqrt","pow","neighbors","search","minX","minY","maxX","maxY","neighbor","newGeoJSON","centroid","featureCollection","reducedPhotoCount","points","newZ","geometry","coordinates","searchIcon","transparent","transparentIcon","& path","TopBar","isTransparent","hideLogo","finalMenuItems","AppLogoSimple","Menu_default","AccountCircle_default","ExitToAppIcon","useSearchBarStyles","shape","common","white","&:hover","breakpoints","up","inputRoot","inputInput","pointerEvents","justifyContent","SearchInput","debounceSearchText","Search_default","InputBase","chipContainer","accessLabel","accessPUBLIC","accessPRIVATE","accessOPEN","verticalAlign","objectFit","titleText","dateContainer","dateLabel","dateText","imgContainer","SeriesListItem","showCreatedOn","showLastPhoto","latest","misc_SeriesListItem","ClusterSelected","seriesCount","onZoomTo","ZoomOutMap_default","&.PUBLIC","&.PRIVATE","&.OPEN","avatarActive","badge","badgeActive","Cluster","numeral","& .myPosMarker","& .singleMarker","& .clusterMarker","topBar","zoomOutFab","selectedPopup","defaultView","HomeMap","seriesList","onSeriesClick","onSearchClick","pushMapHistory","popMapHistory","clearMapHistory","mapViewObj","setMapViewObj","mapViewRef","homeMapContainerRef","setCurrentZoom","setTransitions","_useState9","_useState10","selectedItem","setSelectedItem","bufferPts","buffer","units","bbox","updateSelectedItem","item","saveMap","object","pts","lngBuff","latBuff","buffBounds","onMarkerClick","LinearInterpolator","markersRendered","offsetLeft","offsetTop","markers_Single","markers_Cluster","selectedItemRender","selectedSeries","misc_ClusterSelected","components_TopBar","Search_SearchInput","maxZoom","minZoom","viewZoom","getBounds","_map$getBounds","_map$getBounds$_sw","_sw","minLng","lng","minLat","lat","_map$getBounds$_ne","_ne","maxLng","maxLat","oldMinLng","oldMinLat","oldMaxLng","oldMaxLat","onNativeClick","POLL_INTERVAL","withAllSeries","nextToken","fetchMore","updateQuery","fetchMoreResult","setSeriesProps","readyForPolling","withPollQuery","lastCheck","_ref5$ownProps","seriesProps","updateIncrement","changedSeries","oldList","newSeriesSummaries","seriesStatus","polledSeries","ds","oldSeries","oldId","AllSeriesConnect","PollQueryConnect","mapFuncs","tab","setLastCheck","allSeriesQUERY","pollSeriesQUERY","maps_HomeMap","chosenItem","closeIcon","avatarImg","SearchContextItem","gravatar","TheIcon","PlaceIcon","LabelIcon","PersonIcon","ListItemAvatar","Search_SearchContextItem","listSection","placeholderText","ul","SearchContextResults","contextResults","setContextChoice","cr","SearchEnder","ctxItem","overflowX","SearchResults","contextChoice","onResultClick","listRef","enderRef","handleScroll","_listRef$current","scrollTop","Search_SearchEnder","subheader","onScroll","SearchPlaceholder","PlaceholderIcon","useOnline","setOnline","setOffline","newDate","online","since","TABS","tabs","Search","currentTab","setCurrentTab","defaultText","searchText","setSearchText","searchResults","onMapClick","Search_SearchResults","Search_SearchContextResults","Search_SearchPlaceholder","PortableWifiOffIcon","indicatorColor","flexContainer","centered","TAGS","withTagSearch","ceil","withUserSearch","searchStr","withGeoCode","geocoder","relevance","placeName","center","withTagSeries","tagSeries","withUserSeries","createdBy","defaultTab","jumpToSeries","jumpToMap","bboxFunc","withContextQuery","withSearchQuery","ComposedSearch","newContextChoice","newTab","gravatarImg","MeCard","onAvatarClick","filterContainer","filterChip","seriesListItemWrap","FILTERS","SORT","MyProfile","feed","filterVal","setFilter","sortVal","setSort","sortAsc","setSortAsc","sortSetter","newSort","filteredFeed","fi","firstname","MyProfile_MeCard","MyProfile_FilterSortItem","asc","useFilterStyles","FilterSortItem","arrow","withGetUserQuery","userQ","withuserSeriesQuery","seriesQ","withMyWatchedSeriesQuery","watchedSeriesQ","queryWrapped","seriesQArr","watchedSeriesQArr","arraySeries","components_MyProfile_MyProfile","FeedEnder","placeAvatar","placeIcon","FindOnMapButton","Place_default","findOnMapButtonContainer","titleContainer","EVENT_VERBS","FeedItem","onImageClick","onProfileClick","misc_FindOnMapButton","listContainer","vList","feedContainer","MyFeed","events","fetchNewest","dist_es","rowCount","rowHeight","rowRenderer","isScrolling","isVisible","parent","row","MyFeed_FeedItem","wEnd","MyFeed_FeedEnder","almostAtEnd","ROWHEIGHT","withFeedQuery","loadingNewest","loadingMore","start","myFeed","end","jumpToUser","components_MyFeed_MyFeed","OfflineBar","_useOnline","sinceStr","setSinceStr","calcSinceStr","clearTimer","homeConfig","borderTop","BottomBar","onHomeClick","edge","HomeOutlined_default","MapOutlined_default","SearchOutlined_default","PersonOutline_default","components_BottomBar","offlineBar","activeWrapper","flexShrink","uploaderContainer","App","setHomeState","isVKeyBdOn","showBottomBar","ActiveComponent","FeedConnect","MapConnect","ProfileConnect","SearchConnect","SeriesConnect","misc_OfflineBar","Uploader_connect","_useAuthentication","useAuthentication","apolloClient","token","cache","InMemoryCache","authLink","setContext","_","authorization","httpLink","createHttpLink","uri","ApolloClient","link","ApolloLink","tokenName","connectToDevTools","createApolloClient","responsive","appContext","getValues","base","react_apollo_esm","client","translations_IntlWrapper","lib_ErrorBoundary","ErrorConnect","isLocalhost","registerValidSW","swUrl","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","onUpdate","onSuccess","require","ReactDOM","App_connect","href","origin","fetch","contentType","status","ready","unregister","reload","checkValidServiceWorker"],"mappings":"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","file":"static/js/main.0d7c106c.chunk.js","sourcesContent":["import MapStyles from './mapStyles'\nimport {\n  green, blue, red\n} from '@material-ui/core/colors'\n\nexport default {\n  // Bright Pastel\n  tagColors: [\n    '#418CF0', '#FCB441', '#E0400A', '#056492', '#BFBFBF', '#1A3B69', '#FFE382', '#129CDD', '#CA6B4B',\n    '#005CDB', '#F3D288', '#506381', '#F1B9A8', '#E0830A', '#7893BE'\n  ]\n}\n\nexport const mapConfig = {\n  mapBoxToken: process.env.REACT_APP_MAPBOX_TOKEN,\n  styles: MapStyles\n}\n\nlet baseurl = process.env.REACT_APP_BASEURL\nlet basename = process.env.REACT_APP_BASENAME\nlet domain = process.env.REACT_APP_DOMAIN\nif (process.env.NODE_ENV && process.env.NODE_ENV === 'development') {\n  domain = 'localhost'\n  basename = ''\n}\nconsole.log('config: ', baseurl, basename)\n\nexport const home = {\n  AppStateTypes: {\n    FEED: 'feed', // Looking at the Home Feed\n    MAP: 'map', // Looking at the map\n    SEARCH: 'search', // looking at the search\n    PROFILE: 'profile', // Looking at user information\n    SERIES: 'series', // Looking at one particular series\n    NEW_SERIES_CAMERA: 'new_series_camera', // Looking at one particular sereis\n    NEW_SERIES_LIBRARY: 'new_series_library' // Looking at one particular sereis\n  },\n  SEARCH_TABS: {\n    TAG: 'tag',\n    LOCATION: 'location',\n    USER: 'user'\n  },\n  MapModeTypes: {\n    FREE: 'free', //\n    USER: 'user', // filtered to a given user\n    TAG: 'tag' // filtered to a given tag\n  }\n}\n\nexport const federated = {\n  // oauth_config: {\n\n  // },\n  // google_client_id: process.env.REACT_APP_GOOGLE_APP_ID\n}\n\nexport const endpoints = {\n  graphql: process.env.REACT_APP_GRAPHQL\n}\n\nexport const localDb = {\n  imgStore: 'imgStore'\n}\n\nexport const aws = {\n  Auth: {\n    // REQUIRED - Amazon Cognito Identity Pool ID\n    // identityPoolId: process.env.REACT_APP_COGNITO_IDPOOLID, // XX-XXXX-X:XXXXXXXX-XXXX-1234-abcd-1234567890ab\n    // REQUIRED - Amazon Cognito Region\n    region: process.env.REACT_APP_AWS_REGION,\n    // OPTIONAL - Amazon Cognito User Pool ID\n    userPoolId: process.env.REACT_APP_COGNITO_USER_POOL_ID,\n    // OPTIONAL - Amazon Cognito Web Client ID (26-char alphanumeric string)\n    userPoolWebClientId: process.env.REACT_APP_COGNITO_CLIENT_ID,\n    // OPTIONAL - Enforce user authentication prior to accessing AWS resources or not\n    mandatorySignIn: true,\n    // OPTIONAL - Configuration for cookie storage\n    cookieStorage: {\n      // REQUIRED - Cookie domain (only required if cookieStorage is provided)\n      domain: `${domain}`,\n      // OPTIONAL - Cookie path\n      // path: `/${basename}`,\n      // OPTIONAL - Cookie expiration in days\n      expires: 20,\n      // OPTIONAL - Cookie secure flag\n      secure: false\n    }\n\n  }\n\n}\n\nexport const ACCESS = {\n  OPEN: {\n    label: 'Open',\n    description: 'Anyone can contribute',\n    color: green\n  },\n  PRIVATE: {\n    label: 'Private',\n    description: 'Can only be seen by their createors',\n    color: red\n  },\n  PUBLIC: {\n    label: 'Public',\n    description: 'Anyone can see',\n    color: blue\n  }\n}\n","const tagChips = {\n  height: 20\n}\n\nexport default theme => ({\n  xyTagChip: {\n    cursor: 'pointer',\n    color: 'white',\n    fontSize: '0.6em',\n    background: '#444444',\n    height: tagChips.height,\n    position: 'absolute',\n    left: -tagChips.height / 2,\n    top: -tagChips.height / 2\n  },\n  editing: {\n    // color: 'white',\n    // background: theme.palette.secondary.main\n  },\n  // The tag is flipped on the right side of the screen\n  reversedChip: {\n    flexDirection: 'row-reverse',\n    left: 'unset',\n    right: -tagChips.height / 2\n  },\n  deleteIcon: {\n    // color: 'white',\n    width: tagChips.height - 1,\n    height: tagChips.height - 1\n  },\n  chipAvatarIcon: {\n    color: 'white',\n    width: tagChips.height - 4,\n    height: tagChips.height - 4\n  },\n  chipAvatar: {\n    background: 'inherit',\n    width: tagChips.height,\n    height: tagChips.height\n  },\n  reversedDelete: {\n    margin: `0 -${tagChips.height / 8}px 0 ${tagChips.height / 8}px`\n  },\n  // The chip bucket is the container div for the chip and represents the\n  // Actual XY coordinates. The chip itself is offset to make the\n  chipBucket: {\n    width: 1,\n    height: 1,\n    display: 'flex',\n    flexDirection: 'row',\n    position: 'absolute'\n  },\n  reversedChipBucket: {\n    flexDirection: 'row-reverse'\n  }\n})\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport Draggable from 'react-draggable'\n\nimport Chip from '@material-ui/core/Chip'\nimport Avatar from '@material-ui/core/Avatar'\n\nimport CancelIcon from '@material-ui/icons/Cancel'\nimport MyLocation from '@material-ui/icons/MyLocation'\n\nimport { makeStyles, useTheme } from '@material-ui/core/styles'\nimport style from './XYTagChip.style'\n\nconst useStyles = makeStyles(style)\n\nconst XYTagChip = ({\n  color, edit, tag, newSize,\n  onTagDragOver, onTagDragStop, onNewTag, onTagDelete, ...props\n}) => {\n  const isReversed = tag.relCoords.x > newSize.newWidth / 2\n  const classes = useStyles()\n  const theme = useTheme()\n  const stopBadness = (e) => {\n    e.preventDefault()\n    e.stopPropagation()\n  }\n\n  const handleDrag = (e, data) => {\n    stopBadness(e)\n    onTagDragOver(data, tag)\n  }\n  const handleStopDrag = (e, data) => {\n    stopBadness(e)\n    onTagDragStop(data, tag)\n  }\n\n  // Draggable chip if it is editable\n  return (\n    <Draggable\n      disabled={!edit}\n      bounds={{ left: 10, top: 10, right: newSize.newWidth - 10, bottom: newSize.newHeight - 10 }}\n      position={{ x: tag.relCoords.x, y: tag.relCoords.y }}\n      onDrag={handleDrag}\n      onStop={handleStopDrag}\n      onClick={stopBadness}\n    >\n      <div className={classNames(classes.chipBucket, isReversed && classes.reversedChipBucket)}>\n        <Chip\n          style={{\n            background: color ? `${color}!important` : null,\n            color: color ? `${theme.palette.getContrastText(color)}!important` : null\n          }}\n          color={edit ? 'secondary' : 'default'}\n          label={tag.label}\n          data={tag.id}\n          onClick={stopBadness}\n          onDelete={edit ? onTagDelete(tag) : null}\n          deleteIcon={edit ? <CancelIcon className={classNames(classes.deleteIcon, isReversed && classes.reversedDelete)} /> : <div />}\n          className={classNames(\n            classes.xyTagChip,\n            isReversed && classes.reversedChip,\n            edit && classes.editing\n          )}\n          {...props}\n          avatar={<Avatar className={classNames(classes.chipAvatar, edit && classes.editing)}>\n            <MyLocation className={classNames(classes.chipAvatarIcon, edit && classes.editing)} />\n          </Avatar>}\n        />\n      </div>\n    </Draggable>\n  )\n}\n\nXYTagChip.propTypes = {\n  color: PropTypes.string,\n  edit: PropTypes.bool,\n  tag: PropTypes.object.isRequired,\n  newSize: PropTypes.object,\n  onTagDragOver: PropTypes.func,\n  onTagDragStop: PropTypes.func,\n  onNewTag: PropTypes.func,\n  onTagDelete: PropTypes.func\n}\n\nexport default XYTagChip\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\nimport Paper from '@material-ui/core/Paper'\nimport Typography from '@material-ui/core/Typography'\nimport TextField from '@material-ui/core/TextField'\nimport MenuItem from '@material-ui/core/MenuItem'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport Select from 'react-select'\nimport CreatableSelect from 'react-select/lib/Creatable'\nimport style from './XYTagSelect.style'\n\nconst useStyles = makeStyles(style)\n\nconst XYTagSelect = ({ tagConfig, onChange }) => {\n  const classes = useStyles()\n  const options = tagConfig.values.map(tc => ({ label: tc.label, value: tc.id }))\n  console.log('XYTagSelect', tagConfig)\n  return (\n    <div className={classes.root}>\n      {!tagConfig.allowAdditions && (\n        <Select\n          options={options}\n          classes={classes}\n          components={{\n            Control,\n            Menu,\n            NoOptionsMessage,\n            Option,\n            Placeholder,\n            ValueContainer\n          }}\n          value={null}\n          // onBlur={e => e.preventDefault()}\n          blurInputOnSelect\n          isClearable={false}\n          onChange={onChange}\n          placeholder={tagConfig.label}\n          isSearchable\n        />\n      ) }\n      { tagConfig.allowAdditions && (\n        <CreatableSelect\n          options={options}\n          classes={classes}\n          components={{\n            Control,\n            Menu,\n            NoOptionsMessage,\n            Option,\n            Placeholder,\n            ValueContainer\n          }}\n          value={null}\n          isClearable={false}\n          // onBlur={e => e.preventDefault()}\n          blurInputOnSelect\n          onChange={onChange}\n          placeholder={tagConfig.label}\n          isSearchable\n        />\n      )}\n    </div>\n  )\n}\nXYTagSelect.propTypes = {\n  tagConfig: PropTypes.object.isRequired,\n  onChange: PropTypes.func.isRequired\n}\n\nexport default XYTagSelect\n\nfunction Control (props) {\n  return (\n    <TextField\n      fullWidth\n      InputProps={{\n        inputComponent,\n        inputProps: {\n          className: props.selectProps.classes.input,\n          inputRef: props.innerRef,\n          children: props.children,\n          ...props.innerProps\n        }\n      }}\n      {...props.selectProps.textFieldProps}\n    />\n  )\n}\n\nconst NoOptionsMessage = ({ innerProps, selectProps, children }) => (\n  <Typography\n    color='textSecondary'\n    className={selectProps.classes.noOptionsMessage}\n    {...innerProps}\n  >\n    {children}\n  </Typography>\n)\n\nconst Menu = ({ selectProps, innerProps, children }) => (\n  <Paper square className={selectProps.classes.paper} {...innerProps}>\n    {children}\n  </Paper>\n)\n\nconst inputComponent = ({ inputRef, ...props }) => <div ref={inputRef} {...props} />\n\nconst Placeholder = (props) => (\n  <Typography\n    color='textSecondary'\n    className={props.selectProps.classes.placeholder}\n    {...props.innerProps}\n  >\n    {props.children}\n  </Typography>\n)\n\nconst Option = ({ innerRef, isFocused, isSelected, innerProps, children }) => (\n  <MenuItem\n    buttonRef={innerRef}\n    selected={isFocused}\n    component='div'\n    style={{ fontWeight: isSelected ? 500 : 400 }}\n    {...innerProps}\n  >\n    {children}\n  </MenuItem>\n)\n\nconst ValueContainer = ({ selectProps, children }) => (\n  <div className={selectProps.classes.valueContainer}>{children}</div>\n)\nValueContainer.propTypes = {\n  selectProps: PropTypes.object.isRequired,\n  children: PropTypes.any\n}\n","export default theme => ({\n  root: {\n    width: '100%'\n  },\n  noOptionsMessage: {\n    padding: `${theme.spacing(1)}px ${theme.spacing(1) * 2}px`\n  },\n  singleValue: {\n    fontSize: 16\n  },\n  placeholder: {\n    position: 'absolute',\n    left: 2,\n    fontSize: 16\n  },\n  input: {\n    display: 'flex',\n    padding: 0\n  },\n  valueContainer: {\n    display: 'flex',\n    flexWrap: 'wrap',\n    flex: 1,\n    alignItems: 'center',\n    overflow: 'hidden'\n  },\n  paper: {\n    position: 'absolute',\n    zIndex: 100,\n    marginTop: theme.spacing(1),\n    left: 0,\n    right: 0\n  }\n})\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport Typography from '@material-ui/core/Typography'\nimport IconButton from '@material-ui/core/IconButton'\n\nimport CloseIcon from '@material-ui/icons/Close'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport XYTagSelect from './XYTagSelect'\nimport style from './XYTagChooser.style'\n\nconst useStyles = makeStyles(style)\n\nconst XYTagChooser = ({ coords, open, seriesConfig, onNewTag, onClose }) => {\n  const classes = useStyles()\n  const xyTags = seriesConfig.tags.filter(t => t.allowXY)\n  if (!coords) return null\n  return (\n    <Dialog\n      open={open}\n      scroll='paper'\n      fullScreen\n      classes={{ paperScrollPaper: classes.root }}\n      onClose={() => onClose()}\n      aria-labelledby='simple-dialog-title'\n    >\n      <DialogTitle id='simple-dialog-title' className={classes.header}>\n      New Tag:\n        <IconButton className={classes.closeButton} onClick={onClose}>\n          <CloseIcon />\n        </IconButton>\n      </DialogTitle>\n      <div className={classes.dlgBody}>\n        {xyTags.length > 1 && (\n          <Typography variant='caption'>What kind of tag would you like to create?</Typography>\n        )}\n\n        {xyTags.map((tagType, idx) => (\n          <div className={classes.listItem} key={`tagSelect${idx}`}>\n            <XYTagSelect tagConfig={tagType} onChange={onNewTag(coords, tagType)} />\n          </div>\n        ))}\n      </div>\n    </Dialog>\n  )\n}\n\nXYTagChooser.propTypes = {\n  seriesConfig: PropTypes.object.isRequired,\n  open: PropTypes.bool.isRequired,\n  coords: PropTypes.object,\n  onClose: PropTypes.func.isRequired,\n  onNewTag: PropTypes.func.isRequired\n}\n\nexport default XYTagChooser\n","export default theme => ({\n  root: {\n    overflow: 'visible'\n  },\n  header: {\n    padding: theme.spacing(1) * 2\n  },\n  listItem: {\n    flexDirection: 'column'\n  },\n  dlgBody: {\n    paddingLeft: theme.spacing(1) * 2,\n    paddingRight: theme.spacing(1) * 2,\n    paddingBottom: theme.spacing(1) * 2\n  },\n  closeButton: {\n    position: 'absolute',\n    right: theme.spacing(1),\n    top: theme.spacing(1),\n    color: theme.palette.grey[500]\n  }\n})\n","import React, { useState, useContext } from 'react'\nimport { SeriesContext } from '../../contexts'\nimport XYTagChooser from './XYTagChooser'\nimport Tags from '../../../../lib/Tags'\n\nconst useXYTags = (photo, newSize, onChange, setResizeActive) => {\n  const { seriesConfig } = useContext(SeriesContext)\n\n  // we hold the tags in state so that every little drag motion\n  // doesn't cause an updated state until you let go\n  const [isDragging, setIsDragging] = useState(false)\n  const [newTagDialog, setNewTagDialog] = useState(null)\n\n  const tagClass = new Tags(seriesConfig, photo.tags)\n\n  const onNewTag = (coords, tagType) => ({ value, __isNew__: isNew }) => {\n    let addTag = isNew\n      ? tagClass.createNewXYTagObj(value, tagType.id, coords)\n      : tagClass.createExistingXYTagObj(value, tagType.id, coords)\n\n    setNewTagDialog(null)\n    onChange({ ...photo, tags: [...photo.tags, addTag] })\n  }\n\n  const onTagDelete = (tag) => () => {\n    const tags = photo.tags.filter(oldTag => oldTag.id !== tag.id)\n    onChange({\n      ...photo,\n      tags\n    })\n  }\n\n  // When the photo is tapped, send the x,y coords of that tap\n  // to a dialog we will open\n  const onAddTagTrigger = (e) => {\n    if (!newTagDialog) {\n      // Turn off resizing so mobile keyboards don't complete F us.\n      setResizeActive(false)\n      setNewTagDialog({\n        x: parseInt(e.pageX - (window.innerWidth - newSize.newWidth) / 2 * newSize.multiplier, 10),\n        y: parseInt(e.pageY - (window.innerHeight - newSize.newHeight) / 2 * newSize.multiplier, 10)\n      })\n    }\n  }\n\n  // This gets used by the drag AND the stop\n  const updateTagLocation = ({ x, y }, tag) => {\n    const newTags = photo.tags.map(oldTag => {\n      if (oldTag.id !== tag.id) return oldTag\n      else {\n        let newX = parseInt(x / newSize.multiplier, 10)\n        let newY = parseInt(y / newSize.multiplier, 10)\n\n        return {\n          ...oldTag,\n          coords: { x: newX, y: newY }\n        }\n      }\n    })\n    return newTags\n  }\n\n  const onTagDragStop = (coords, tag) => {\n    const tags = updateTagLocation(coords, tag)\n    setIsDragging(false)\n    onChange({\n      ...photo,\n      tags\n    })\n  }\n\n  const onTagDragOver = (coords, tag) => {\n    updateTagLocation(coords, tag)\n    setIsDragging(true)\n  }\n  const TagChooser = () => (\n    <XYTagChooser\n      open={!isDragging && Boolean(newTagDialog)}\n      coords={newTagDialog}\n      seriesConfig={seriesConfig}\n      onNewTag={onNewTag}\n      onClose={() => {\n        setNewTagDialog(null)\n        // Turn on resizing again.\n        setResizeActive(true)\n      }}\n    />\n  )\n\n  return {\n    onNewTag,\n    onTagDelete,\n    onAddTagTrigger,\n    onTagDragOver,\n    onTagDragStop,\n    TagChooser,\n    getRelXYTags: tagClass.getRelXYTags\n  }\n}\n\nexport default useXYTags\n","import React from 'react'\nimport Typography from '@material-ui/core/Typography'\nimport BrokenImageIcon from '@material-ui/icons/BrokenImage'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    flexGrow: 1,\n    padding: '10%',\n    display: 'flex',\n    flexDirection: 'column',\n    opacity: 0.3,\n    textAlign: 'center',\n    color: theme.palette.grey[100]\n  },\n  icon: {\n    width: '100%',\n    flex: '1 1 40%',\n    color: theme.palette.grey[100],\n    opacity: 0.5\n  },\n  primary: {\n    color: theme.palette.grey[100],\n    textAlign: 'center',\n    flex: '1 1 30%',\n    width: '100%'\n  },\n  secondary: {\n    flex: '1 1 30%',\n    width: '100%'\n  }\n}))\n\nconst BrokenImg = () => {\n  const classes = useStyles()\n  return (\n    <div className={classes.root}>\n      <BrokenImageIcon className={classes.icon} />\n      <Typography className={classes.primary}>Img not found</Typography>\n    </div>\n  )\n}\n\nexport default BrokenImg\n","import React, { useState, useRef, useContext, useEffect } from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport useComponentSize from '../../../../lib/useComponentSize'\n\nimport { SeriesContext } from '../../contexts'\nimport XYTagChip from '../tags/XYTagChip'\nimport useXYTags from '../tags/useXYTags'\nimport BrokenImg from './BrokenImg'\nimport style from './Photo.style'\n\nconst useStyles = makeStyles(style)\n\nconst Photo = ({ photo, opacity, edit, showTags, transition, onChange, className }) => {\n  const classes = useStyles()\n  const refImgWrap = useRef(null)\n  const [newSize, setNewSize] = useState({ multiplier: 1 })\n  const [url, setUrl] = useState(null)\n  const [broken, setBroken] = useState(false)\n  const [urlRetryCounter, setURLRetryCounter] = useState(0)\n  const { seriesConfig } = useContext(SeriesContext)\n\n  useEffect(() => {\n    function getURL () {\n      if (!photo.base64) {\n        const newUrl = seriesConfig.getPhotoUrl(photo, 'large')\n        if (refImgWrap.current) setUrl(newUrl)\n      }\n      else {\n        if (refImgWrap.current) setUrl(photo.base64)\n      }\n    }\n    getURL()\n  }, [photo])\n\n  const { size: { height, width }, setResizeActive } = useComponentSize(refImgWrap)\n  const urlWithRetries = urlRetryCounter > 0 ? `${url}?retry=${urlRetryCounter}` : url\n\n  // All tag-related info is put in its own hook\n  const { onAddTagTrigger, TagChooser, getRelXYTags, onTagDragOver, onTagDragStop, onTagDelete } = useXYTags(photo, { height, width }, onChange, setResizeActive)\n\n  const handleImageLoaded = event => {\n    if (refImgWrap.current) {\n      setBroken(false)\n      const { naturalHeight, naturalWidth } = event.target\n      // 4 different cases of orientation:\n      const multiplier = Math.min(\n        height / naturalHeight,\n        width / naturalWidth\n      )\n\n      const newWidth = multiplier * naturalWidth\n      const newHeight = multiplier * naturalHeight\n      setNewSize({ newWidth, newHeight, naturalWidth, naturalHeight, multiplier })\n    }\n  }\n\n  return (\n    <div className={classNames(classes.root, className)}\n      style={{ opacity: opacity !== null ? opacity : 1 }}\n      ref={refImgWrap}\n    >\n      <div className={classes.inner}\n        style={{\n          height: newSize ? newSize.newHeight : 1,\n          width: newSize ? newSize.newWidth : 1\n        }}\n        onClick={onAddTagTrigger}\n      >\n        { showTags || edit\n          ? (\n            <div className={className}>\n              { getRelXYTags(newSize.multiplier).map((tag, idx) => (\n                <XYTagChip\n                  key={`xytag-${idx}`}\n                  color={tag.color}\n                  {...{ edit, newSize, tag, onTagDragOver, onTagDragStop, onTagDelete }} />\n              ))}\n            </div>\n          ) : null\n        }\n        {broken && <BrokenImg />}\n        <img className={classNames(broken ? classes.brokenImg : classes.img)}\n          alt={urlWithRetries}\n          onError={(err) => {\n            if (urlRetryCounter < 10) {\n              setBroken(true)\n              console.log('Image Retry', urlRetryCounter)\n              console.error(err)\n              setTimeout(() => {\n                if (refImgWrap.current) setURLRetryCounter(urlRetryCounter + 1)\n              }, 4000)\n            }\n          }}\n          src={urlWithRetries}\n          onLoad={handleImageLoaded}\n          style={{ height: newSize.newHeight, width: newSize.newWidth }}\n        />\n      </div>\n      {edit && <TagChooser />}\n    </div>\n  )\n}\n\nPhoto.propTypes = {\n  className: PropTypes.string,\n  opacity: PropTypes.number,\n  photo: PropTypes.object.isRequired,\n  edit: PropTypes.bool,\n  showTags: PropTypes.bool,\n  transition: PropTypes.string,\n  onChange: PropTypes.func\n}\n\nexport default Photo\n","// import { fade } from '@material-ui/core/styles/colorManipulator'\nexport default theme => ({\n  root: {\n    // maxWidth: 400,\n    display: 'block',\n    position: 'relative',\n    width: '100%',\n    height: '100%',\n    background: 'black',\n    overflow: 'hidden'\n  },\n  inner: {\n    position: 'absolute',\n    top: '50%',\n    left: '50%',\n    transform: 'translateY(-50%) translateX(-50%)',\n    overflow: 'hidden'\n  },\n  xyTags: {\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    // opacity: 0.8,\n    // border: '4px solid red',\n    height: '100%',\n    width: '100%'\n    // background: 'rgba(150, 150, 150, 0.5)'\n  },\n  img: {\n    display: 'block'\n  },\n  brokenImg: {\n    display: 'none'\n  },\n  formControl: {\n    width: '100%'\n  }\n})\n","import { useCallback, useState, useLayoutEffect, useRef } from 'react'\nimport { debounce } from './util'\n\nconst getSize = (el, minSize, defaultSize) => {\n  if (!el) return defaultSize || minSize || { width: 0, height: 0 }\n\n  if (minSize) {\n    return {\n      width: Math.max(minSize.width, el.offsetWidth),\n      height: Math.max(minSize.height, el.offsetHeight)\n    }\n  }\n  else {\n    return {\n      width: el.offsetWidth,\n      height: el.offsetHeight\n    }\n  }\n}\n\nconst useComponentSize = (ref, minSize, defaultSize) => {\n  const resizeActiveRef = useRef()\n  const [resizeActive, setResizeActive] = useState(true)\n\n  resizeActiveRef.current = resizeActive\n  const [size, setComponentSize] = useState(\n    getSize(ref ? ref.current : null, minSize, defaultSize)\n  )\n\n  const handleResize = () => {\n    if (!resizeActiveRef.current || !ref.current) return\n    const newSize = getSize(ref.current, minSize, defaultSize)\n    if (newSize.height !== size.height || newSize.width !== size.width) {\n      // console.log('handleResize Called', { newSize, size })\n      setComponentSize(newSize)\n    }\n  }\n\n  const handleResizeDebounced = useCallback(\n    debounce(handleResize, 500),\n    []\n  )\n\n  useLayoutEffect(() => {\n    if (!ref.current) return\n    handleResize()\n\n    if (typeof ResizeObserver === 'function') {\n      let resizeObserver = new ResizeObserver(handleResizeDebounced)\n      resizeObserver.observe(ref.current)\n\n      return () => {\n        resizeObserver.disconnect(ref.current)\n        resizeObserver = null\n      }\n    }\n    else {\n      window.addEventListener('resize', handleResizeDebounced)\n\n      return () => {\n        window.removeEventListener('resize', handleResizeDebounced)\n      }\n    }\n  },\n  [ref.current])\n\n  return { size, setResizeActive }\n}\n\nexport default useComponentSize\n","import { useState, useEffect, useRef } from 'react'\n\nexport const useGeolocation = () => {\n  const [state, setState] = useState({\n    accuracy: null,\n    altitude: null,\n    altitudeAccuracy: null,\n    heading: null,\n    latitude: null,\n    longitude: null,\n    speed: null,\n    timestamp: Date.now()\n  })\n  const mountedRef = useRef()\n  const watchIdRef = useRef()\n  mountedRef.current = true\n\n  const onEvent = event => {\n    if (mountedRef.current) {\n      setState({\n        accuracy: event.coords.accuracy,\n        altitude: event.coords.altitude,\n        altitudeAccuracy: event.coords.altitudeAccuracy,\n        heading: event.coords.heading,\n        latitude: event.coords.latitude,\n        longitude: event.coords.longitude,\n        speed: event.coords.speed,\n        timestamp: event.timestamp\n      })\n    }\n  }\n\n  useEffect(() => {\n    navigator.geolocation.getCurrentPosition(onEvent)\n    watchIdRef.current = navigator.geolocation.watchPosition(onEvent)\n\n    return () => {\n      mountedRef.current = false\n      navigator.geolocation.clearWatch(watchIdRef.current)\n    }\n  }, [navigator.geolocation])\n\n  return state\n}\n\nexport function useDeviceOrientation () {\n  const [deviceOrientation, setDeviceOrientation] = useState({ absolute: false, alpha: null, beta: null, gamma: null })\n\n  function handleDeviceOrientation (event) {\n    setDeviceOrientation({\n      absolute: event.absolute,\n      alpha: event.alpha,\n      beta: event.beta,\n      gamma: event.gamma\n    })\n  }\n\n  useEffect(() => {\n    window.addEventListener('deviceorientation', handleDeviceOrientation, true)\n\n    return () => {\n      window.removeEventListener('deviceorientation', handleDeviceOrientation)\n    }\n  }, [])\n\n  return deviceOrientation\n}\n\nexport function playClickAudio (clickSound) {\n  let audio = new Audio('data:audio/mp3;base64,' + clickSound.base64)\n  audio.play()\n}\n\n// Detects if device is on iOS\nexport const isIos = () => {\n  return /iphone|ipad|ipod/i.test(window.navigator.userAgent || navigator.vendor || window.opera || '')\n}\n\nexport const isPhone = () => {\n  const a = (window.navigator.userAgent || navigator.vendor || window.opera || '')\n  return /(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i\n    .test(a) ||\n  /1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw-(n|u)|c55\\/|capi|ccwa|cdm-|cell|chtm|cldc|cmd-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc-s|devi|dica|dmob|do(c|p)o|ds(12|-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(-|_)|g1 u|g560|gene|gf-5|g-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd-(m|p|t)|hei-|hi(pt|ta)|hp( i|ip)|hs-c|ht(c(-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i-(20|go|ma)|i230|iac( |-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|-[a-w])|libw|lynx|m1-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|-([1-8]|c))|phil|pire|pl(ay|uc)|pn-2|po(ck|rt|se)|prox|psio|pt-g|qa-a|qc(07|12|21|32|60|-[2-7]|i-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h-|oo|p-)|sdk\\/|se(c(-|0|1)|47|mc|nd|ri)|sgh-|shar|sie(-|m)|sk-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h-|v-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl-|tdg-|tel(i|m)|tim-|t-mo|to(pl|sh)|ts(70|m-|m3|m5)|tx-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas-|your|zeto|zte-/i\n    .test(a.substr(0, 4))\n}\n","const TYPES = {\n  // Series meta gets appended automatically to the seriees\n  SERIES: 'SERIES',\n  // Same but now only gets appended to the photo\n  PHOTO: 'PHOTO'\n}\nclass SeriesConfig {\n  constructor (seriesConfig) {\n    if (!seriesConfig) throw new Error('No seriesConfig object provided to SeriesConfig class')\n    this.config = seriesConfig\n  }\n\n  getTagType = (typeId) => this.config.tags.find(tt => tt.id === typeId)\n  // getTagTypeIndex = (typeId) => this.config.tags.findIndex(tt => tt.id === typeId)\n  getTagTypeIndex = (typeId) => {\n    // console.log('HERE', typeId)\n    return this.config.tags.findIndex(tt => tt.id === typeId)\n  }\n\n  getXYTagTypes = () => this.config.tags.filter(tt => tt.allowXY)\n  getNonXYTagTypes = () => this.config.tags.filter(tt => tt.allowNonXY)\n\n  getSeriesMeta = () => Object.keys(this.config.meta)\n    .filter(key => this.config.meta[key].type === TYPES.SERIES)\n    .reduce((acc, key) => ({\n      ...acc,\n      [key]: this.config.meta[key].default\n    }), {})\n\n  getPhotoMeta = () => Object.keys(this.config.meta)\n    .filter(key => this.config.meta[key].type === TYPES.PHOTO)\n    .reduce((acc, key) => ({\n      ...acc,\n      [key]: this.config.meta[key].default\n    }), {})\n}\n\nexport default SeriesConfig\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Chip from '@material-ui/core/Chip'\nimport CancelIcon from '@material-ui/icons/Cancel'\nimport { makeStyles, useTheme } from '@material-ui/core/styles'\n\nexport const tagChips = {\n  height: 20\n}\n\nconst style = theme => ({\n  root: {\n    fontSize: '0.6em',\n    height: tagChips.height,\n    marginRight: theme.spacing(1) / 2,\n    marginTop: theme.spacing(1) / 2\n  },\n  deleteIcon: {\n    width: tagChips.height - 1,\n    height: tagChips.height - 1\n  },\n  chipAvatar: {\n    width: tagChips.height,\n    height: tagChips.height\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst TagChip = ({ edit, tag, color, onDelete, ...props }) => {\n  const classes = useStyles()\n  const theme = useTheme()\n  return (\n    <Chip\n      style={{\n        background: color || null,\n        color: color ? `${theme.palette.getContrastText(color)}` : null\n      }}\n      label={tag.label}\n      data={tag.id}\n      onDelete={edit ? () => onDelete(tag) : null}\n      deleteIcon={(\n        <CancelIcon\n          className={classes.deleteIcon}\n          onClick={e => {\n            console.log('this click')\n          }}\n          style={{\n            opacity: 0.5,\n            color: color ? `${theme.palette.getContrastText(color)}` : null\n          }}\n        />\n      )}\n      className={classes.root}\n      {...props}\n    />\n  )\n}\n\nTagChip.propTypes = {\n  color: PropTypes.string.isRequired,\n  edit: PropTypes.bool,\n  tag: PropTypes.object.isRequired,\n  onDelete: PropTypes.func\n}\n\nexport default TagChip\n","import React from 'react'\nimport classNames from 'classnames'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport FormLabel from '@material-ui/core/FormLabel'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n    position: 'relative',\n    display: 'block',\n    overflow: 'hidden',\n    whiteSpace: 'pre-line',\n    '&::before': {\n      content: '\"  \"',\n      display: 'block',\n      position: 'absolute',\n      bottom: 0,\n      width: '100%',\n      height: 100,\n      background: `linear-gradient(180deg, rgba(255,255,255,0) 0%, ${theme.palette.background.paper} 100%)`\n    }\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst ShortLongText = ({ label, text, height, onClick }) => {\n  const classes = useStyles()\n  return (\n    <div onClick={onClick}>\n      {label && (\n        <FormLabel className={classes.formLabel}>\n          {label}\n        </FormLabel>\n      )}\n      <Typography\n\n        variant='body1'\n        color='inherit'\n        style={{ height }}\n        className={classNames(classes.root)}\n      >\n        {text}\n      </Typography>\n    </div>\n  )\n}\n\nShortLongText.propTypes = {\n  label: PropTypes.string,\n  text: PropTypes.string,\n  height: PropTypes.number,\n  onClick: PropTypes.func\n}\nShortLongText.defaultProps = {\n  height: 100\n}\n\nexport default ShortLongText\n","import uuid from 'uuid/v4'\nimport SeriesConfig from './SeriesConfig'\n\nclass Tags {\n  constructor (seriesConfig, tags) {\n    this.tags = tags\n    this.seriesConfig = new SeriesConfig(seriesConfig)\n  }\n\n  findTagById = (typeId, tagId) => {\n    return this.seriesConfig.getTagType(typeId).values\n      .find(tt => tt.id === tagId)\n  }\n\n  // Filter the list of tags to those that are XY tags\n  getXYTags = () => {\n    const xyTagIds = this.seriesConfig.getXYTagTypes().map(tt => tt.id)\n    return this.tags.filter(tag => xyTagIds.indexOf(tag.typeId) > -1 && tag.coords && tag.coords.x)\n  }\n\n  getNonXYTags = () => {\n    const NonXYTagIds = this.seriesConfig.getNonXYTagTypes().map(tt => tt.id)\n    return this.tags.filter(tag => NonXYTagIds.indexOf(tag.typeId) > -1)\n  }\n\n  createNewTagObj = (label, typeId) => (\n    { id: uuid(), label, typeId }\n  )\n\n  createExistingTagObj = (id, typeId) => ({\n    ...this.findTagById(typeId, id),\n    typeId\n  })\n\n  createNewXYTagObj = (label, typeId, coords) => ({\n    id: uuid(),\n    label,\n    typeId,\n    coords\n  })\n\n  createExistingXYTagObj = (id, typeId, coords) => ({\n    ...this.findTagById(typeId, id),\n    typeId,\n    coords\n  })\n\n  // Get tags in a way that's easy to render them\n  // We augment these tags with relative positions\n  // and a group number for coloring.\n  getRelXYTags = (multiplier) => this.getXYTags().map(tag => ({\n    ...tag,\n    group: this.seriesConfig.getTagTypeIndex(tag.typeId),\n    relCoords: {\n      x: tag.coords.x * multiplier,\n      y: tag.coords.y * multiplier\n    }\n  }))\n}\n\nexport default Tags\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n    color: theme.palette.primary.main,\n    position: 'absolute',\n    top: '50%',\n    left: '50%',\n    textAlign: 'center',\n    transformOrigin: '50% 50%',\n    transform: 'translateY(-50%) translateX(-50%)',\n    zIndex: 1\n  },\n  rootActive: {\n    zIndex: 1000\n  },\n  svgDot: {\n    zIndex: 102,\n    width: 20,\n    height: 20,\n    position: 'absolute',\n    top: '50%',\n    left: '50%',\n    textAlign: 'center',\n    transformOrigin: '50% 50%',\n    transform: 'translateY(-50%) translateX(-50%)'\n  },\n  dot: {\n    stroke: theme.palette.secondary.contrastText,\n    strokeWidth: '1',\n    fill: theme.palette.secondary.main\n  },\n  directionIndicator: {\n    position: 'absolute',\n    left: '50%',\n    // transformOrigin: '50% 50%',\n    // transform: 'translateY(-50%) translateX(-50%)',\n    zIndex: 100\n  },\n  name: {\n    color: 'white',\n    fontWeight: 'bold',\n    textShadow: `\n        0px 0px 4px #000000, \n        0px 0px 4px #000000 \n    `,\n    zIndex: 122,\n    position: 'relative'\n    // textStroke: '1px white'\n  },\n  nameActive: {\n    color: theme.palette.secondary.dark,\n    textShadow: `\n    0px 0px 2px #FFFFFF, \n    0px 0px 2px #FFFFFF,\n    0px 0px 4px #FFFFFF \n`\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst Single = ({ direction }) => {\n  const classes = useStyles()\n  return (\n    <div className={classes.root}>\n      <svg className={classes.svgDot} version='1.1' viewBox='0, 0, 10, 10' >\n        <circle cx='5' cy='5' r='4' className={classes.dot} />\n      </svg>\n      {direction && direction >= 0 ? (\n        <div className={classes.directionIndicator}>\n          <svg className={classes.svgArc}\n            version='1.1'\n            width='100'\n            height='100'\n            viewBox='0, 0, 100, 100'\n            style={{ transform: `translateY(-50%) translateX(-50%) rotateZ(${direction}deg)` }}>\n            <path d='M50,0 C60.946,0.151 72.136,3.514 80.675,10.56 L50,50 L19.325,10.56 C27.938,3.461 39,0.278 50,0 z'\n              fill='#009DC1'\n              fillOpacity='0.444'\n              strokeWidth='0.5'\n              strokeOpacity='0.6'\n              stroke='#FFFFFF'\n            />\n          </svg>\n        </div>\n      ) : null}\n    </div>\n  )\n}\n\nSingle.propTypes = {\n  direction: PropTypes.number\n}\n\nexport default Single\n","import React, { useState, useRef, useMemo } from 'react'\nimport { StaticMap } from 'react-map-gl'\nimport PropTypes from 'prop-types'\nimport { getDistanceScales } from 'viewport-mercator-project'\nimport useComponentSize from '../../lib/useComponentSize'\nimport StyleButtons from './controls/StyleButtons'\nimport { mapConfig } from '../../config'\nimport classNames from 'classnames'\nimport 'mapbox-gl/dist/mapbox-gl.css'\nimport './BaseMap.css'\n\n/**\n * Note that this component technically has state but it is designed to be functionally stateless\n */\nconst BaseStaticMap = (props) => {\n  const {\n    controlPadding,\n    viewport,\n    children,\n    mapStyles,\n    onMapDataEvent,\n    ...passthroughProps\n  } = props\n\n  const mapRef = useRef(null)\n  const { size } = useComponentSize(mapRef, { width: 100, height: 50 })\n\n  const [currStyle, setCurrStyle] = useState(0)\n  const [projection, setProjection] = useState(null)\n\n  const recalcProjection = () => {\n    if (!size || size.width < 10 || size.height < 10) return\n    try {\n      const projection = getDistanceScales(viewport)\n      // console.log('recalcProjection', { projection, size })\n      setProjection(projection)\n    }\n    catch (e) {\n      // Sometimes we don't have a valid bound. Don't make a big deal out of it.\n      console.error(e)\n    }\n  }\n\n  if (!projection) recalcProjection()\n  useMemo(recalcProjection, [size])\n\n  return (\n    <div className={classNames('BaseMap', props.className)} ref={mapRef} style={{ height: '100%', width: '100%' }}>\n      <StaticMap\n        {...viewport}\n        height={size.height}\n        width={size.width}\n        mapStyle={mapStyles[currStyle].style}\n        onData={onMapDataEvent}\n        mapboxApiAccessToken={mapConfig.mapBoxToken}\n        {...passthroughProps}\n      >\n        { mapStyles && mapStyles.length > 1 ? (\n          <StyleButtons\n            controlPadding={controlPadding}\n            currStyle={currStyle}\n            mapStyles={mapStyles}\n            setCurrStyle={setCurrStyle}\n          />\n        ) : null }\n        {\n          children && Array.isArray(children)\n            ? children.map(c => handleChild(c, viewport, size.height, size.width, projection))\n            : handleChild(children, viewport, size.height, size.width, projection)\n        }\n      </StaticMap>\n    </div>\n  )\n}\n\nfunction handleChild (child, viewport, height, width, projection) {\n  return typeof child === 'function'\n    ? child(viewport, height, width, projection)\n    : child\n}\n\nBaseStaticMap.propTypes = {\n  // Anything else we want to add to the map\n  children: PropTypes.any,\n  deckelements: PropTypes.array,\n  data: PropTypes.array,\n  // Maybe we want map controls to be padded\n  controlPadding: PropTypes.object,\n\n  minPitch: PropTypes.number,\n  maxPitch: PropTypes.number,\n  pitch: PropTypes.number,\n\n  // Lock the bounds of a map to a rectangle [minlng, minlat], [maxlng, maxlat]\n  bounds: PropTypes.array,\n  // Lock the possible zoom levels to a range: [minZoom, maxZoom]\n  zoomBounds: PropTypes.array,\n  // InitialBounds of the map.\n  InnerBounds: PropTypes.array,\n\n  // List of valid styles that will get picker buttons\n  mapStyles: PropTypes.array,\n\n  // Just some default props we probably won't set.\n  latitude: PropTypes.number,\n  longitude: PropTypes.number,\n  zoom: PropTypes.number,\n\n  onMapDataEvent: PropTypes.func\n}\nBaseStaticMap.defaultProps = {\n  controlPadding: {},\n  stylechooser: true,\n  // viewport: {\n  //   zoom: 12,\n  //   latitude: 49.3050394,\n  //   longitude: -123.1398254\n  // },\n  initStyle: 0,\n  mapStyles: mapConfig.styles\n}\n\nexport default BaseStaticMap\n","import React from 'react'\nimport PropTypes from 'prop-types'\n// import { makeStyles } from '@material-ui/core/styles'\nimport { Marker } from 'react-map-gl'\nimport BaseMap from './BaseMap'\nimport Dot from './markers/Dot'\nimport BaseStaticMap from './BaseStaticMap'\n// import style from './MapDot.style'\n\n// const useStyles = makeStyles(style)\n\nconst MapDot = ({ staticMap, editable, latitude, longitude, onChange, direction, ...props }) => {\n  const Map = staticMap ? BaseStaticMap : BaseMap\n  // const classes = useStyles()\n  const mapProps = staticMap ? {} : {\n    touchRotate: false,\n    dragRotate: false,\n    showMe: editable,\n    lockPan: !editable,\n    onViewportChange: onChange\n  }\n\n  return (\n    <Map\n      {...mapProps}\n      {...props}\n    >\n      {latitude && longitude ? (\n        <Marker\n          className={'singleMarker'}\n          latitude={latitude}\n          longitude={longitude}\n        >\n          <Dot direction={direction} />\n        </Marker>\n      )\n        : <Dot direction={direction} />\n      }\n\n    </Map>\n  )\n}\n\nMapDot.propTypes = {\n  direction: PropTypes.number,\n  latitude: PropTypes.number,\n  longitude: PropTypes.number,\n  editable: PropTypes.bool,\n  staticMap: PropTypes.bool,\n  onChange: PropTypes.func\n}\n\nexport default MapDot\n","import Satellite from './Satellite.json'\n// import BasicMap from './BasicMap.json'\nimport TopoMap from './TopoMap.json'\n\nimport {\n  Satellite as SatIcon,\n  SatelliteOutlined,\n  // DirectionsCar,\n  // DirectionsCarOutlined,\n  Terrain,\n  TerrainOutlined\n} from '@material-ui/icons'\n\nexport default [\n  {\n    toolTip: 'Sat',\n    Icon: SatelliteOutlined,\n    ActiveIcon: SatIcon,\n    color: 'green',\n    style: Satellite\n  },\n  {\n    toolTip: 'Topo',\n    Icon: TerrainOutlined,\n    ActiveIcon: Terrain,\n    color: 'blue',\n    style: TopoMap\n  }\n]\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\nimport SpeedDial from '@material-ui/lab/SpeedDial'\nimport SpeedDialAction from '@material-ui/lab/SpeedDialAction'\n// import MapLayersIcon from '@material-ui/icons/Layers'\nimport { makeStyles, useTheme } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n    zIndex: 10,\n    position: 'absolute'\n  },\n  speedDialFab: {\n    border: '2px solid',\n    background: theme.palette.text.primary,\n    color: theme.palette.primary.contrastText,\n    width: 40,\n    height: 40\n  },\n  speedDialAction: {\n    border: '2px solid',\n    background: theme.palette.primary.main,\n    color: theme.palette.primary.contrastText,\n    marginTop: 0,\n    marginBottom: 0\n  },\n  speedDialIcon: {\n    // border: '1px solid red'\n  },\n  speedDialLabel: {\n    background: 'black',\n    color: 'white'\n  },\n  actionsClosed: {\n    display: 'none'\n  }\n})\n\nconst useStyles = makeStyles(style)\n\nconst StyleButtons = ({ controlPadding, currStyle, mapStyles, setCurrStyle }) => {\n  const [open, setOpen] = useState(false)\n  const classes = useStyles()\n  const theme = useTheme()\n  const noEventSetOpen = (e, state) => {\n    console.log('noEventSetOpen', e, state)\n    e.preventDefault()\n    e.stopPropagation()\n    setOpen(state)\n  }\n\n  if (!mapStyles || !Array.isArray(mapStyles) || mapStyles.length < 2 || !mapStyles[currStyle]) return null\n\n  const currStyleObj = mapStyles[currStyle]\n  const ActiveIcon = currStyleObj.ActiveIcon\n\n  return (\n    <div className={classes.root} style={{\n      top: controlPadding.top ? controlPadding.top : theme.spacing(2),\n      right: controlPadding.right ? controlPadding.right : theme.spacing(2)\n    }}>\n      {mapStyles.length > 1 && (\n        <SpeedDial\n          ariaLabel='SpeedDial example'\n          className={classes.speedDial}\n          classes={{\n            fab: classes.speedDialFab,\n            actionsClosed: classes.actionsClosed\n          }}\n          icon={<ActiveIcon className={classes.icon} />}\n          // onBlur={(e) => noEventSetOpen(e, false)}\n          onClick={(e) => noEventSetOpen(e, !open)}\n          onClose={(e) => noEventSetOpen(e, false)}\n          // onFocus={(e) => noEventSetOpen(e, true)}\n          // onMouseEnter={(e) => noEventSetOpen(e, true)}\n          // onMouseLeave={(e) => noEventSetOpen(e, false)}\n          open={open}\n          direction='left'\n        >\n\n          {mapStyles.map(({ Icon, ActiveIcon, toolTip }, idx) => (\n            <SpeedDialAction\n              key={`stylebutton${idx}`}\n              // Bit of a hack here. This function isn't quite ready for primetime\n              icon={<Icon className={classes.speedDialIcon} />}\n              tooltipPlacement='bottom'\n              ButtonProps={{\n                classes: {\n                  root: classes.speedDialAction\n                }\n              }}\n              TooltipClasses={{\n                tooltip: classes.speedDialLabel\n              }}\n              tooltipTitle={toolTip}\n              tooltipOpen\n              onClick={() => {\n                console.log('SET', idx)\n                setCurrStyle(idx)\n                setOpen(false)\n              }}\n            />\n          ))}\n\n        </SpeedDial>\n      ) }\n    </div>\n  )\n}\n\nStyleButtons.propTypes = {\n  // controlPadding: {top, right, bottom, left}\n  controlPadding: PropTypes.object,\n  currStyle: PropTypes.number,\n  mapStyles: PropTypes.array,\n  setCurrStyle: PropTypes.func\n}\nStyleButtons.defaultProps = {\n  controlPadding: {}\n}\n\nexport default StyleButtons\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport Dialog from '@material-ui/core/Dialog'\nimport IconButton from '@material-ui/core/IconButton'\nimport DialogTitle from '@material-ui/core/DialogTitle'\n\nimport CloseIcon from '@material-ui/icons/Close'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n\n  },\n  body: {\n    overflow: 'hidden',\n    whiteSpace: 'pre-line',\n    paddingBottom: theme.spacing(1)\n  },\n  title: {\n    alignSelf: 'flex-start',\n    width: '100%',\n    margin: 0,\n    display: 'flex',\n    padding: theme.spacing(2)\n  },\n  dlgTitle: {\n    flexGrow: 1\n  },\n  closeButton: {\n    alignSelf: 'flex-start',\n    color: theme.palette.grey[500]\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst BigText = ({ open, onClose, title, body }) => {\n  const classes = useStyles()\n  return (\n    <Dialog\n      scroll='paper'\n      open={open}\n      fullWidth\n      maxWidth='xl'\n      onClose={onClose}\n      aria-labelledby='simple-dialog-title'\n    >\n      <DialogTitle className={classes.title} disableTypography>\n        <Typography className={classes.dlgTitle}>{title}</Typography>\n        <IconButton className={classes.closeButton} onClick={onClose}>\n          <CloseIcon />\n        </IconButton>\n      </DialogTitle>\n      <DialogContent>\n        <Typography variant='body2' className={classes.body}>{body}</Typography>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nBigText.propTypes = {\n  open: PropTypes.bool,\n  onClose: PropTypes.func,\n  title: PropTypes.string,\n  body: PropTypes.string\n}\n\nexport default BigText\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport Button from '@material-ui/core/Button'\nimport Typography from '@material-ui/core/Typography'\nimport DialogActions from '@material-ui/core/DialogActions'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n\n})\nconst useStyles = makeStyles(style)\n\nconst DeleteDialog = ({ title, message, onConfirm, open }) => {\n  const classes = useStyles()\n  return (\n    <Dialog\n      className={classes.root}\n      disableBackdropClick\n      open={open}\n      disableEscapeKeyDown\n      maxWidth='xl'\n      aria-labelledby='confirmation-dialog-title'\n    >\n      <DialogTitle id='confirmation-dialog-title'>{title}</DialogTitle>\n      <DialogContent>\n        <Typography>\n          {message}\n        </Typography>\n\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={() => onConfirm(false)} color='primary'>\n      No\n        </Button>\n        <Button onClick={() => onConfirm(true)} color='primary'>\n      Yes\n        </Button>\n      </DialogActions>\n    </Dialog>\n  )\n}\n\nDeleteDialog.propTypes = {\n  open: PropTypes.bool,\n  title: PropTypes.string.isRequired,\n  message: PropTypes.string.isRequired,\n  onConfirm: PropTypes.func.isRequired\n}\n\nexport default DeleteDialog\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\n// import Typography from '@material-ui/core/Typography'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogActions from '@material-ui/core/DialogActions'\nimport TextField from '@material-ui/core/TextField'\nimport Button from '@material-ui/core/Button'\nimport DialogTitle from '@material-ui/core/DialogTitle'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n\n  },\n  body: {\n    overflow: 'hidden',\n    whiteSpace: 'pre-line',\n    paddingBottom: theme.spacing(1)\n  },\n  title: {\n    margin: 0,\n    padding: theme.spacing(2)\n  },\n  closeButton: {\n    position: 'absolute',\n    right: theme.spacing(1),\n    top: theme.spacing(1),\n    color: theme.palette.grey[500]\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst BigTextEdit = ({ open, onOk, title, body, multiline }) => {\n  const classes = useStyles()\n  const [value, setValue] = useState(body || '')\n  return (\n    <Dialog\n      scroll='paper'\n      open={open}\n      fullWidth\n      onClose={() => onOk(value)}\n    >\n      <DialogTitle className={classes.title}>\n        {title}\n      </DialogTitle>\n      <DialogContent>\n        <TextField\n          className={classes.body}\n          multiline={multiline}\n          fullWidth\n          rows={6}\n          rowsMax={20}\n          onChange={e => setValue(e.target.value)}\n          defaultValue={body}\n        />\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={() => onOk(body)}>Cancel</Button>\n        <div style={{ flexGrow: 1 }} />\n        <Button onClick={() => onOk(value)}>Ok</Button>\n      </DialogActions>\n    </Dialog>\n  )\n}\n\nBigTextEdit.propTypes = {\n  open: PropTypes.bool,\n  multiline: PropTypes.bool,\n  onOk: PropTypes.func,\n  title: PropTypes.string,\n  body: PropTypes.string\n}\n\nexport default BigTextEdit\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport Slider from '@material-ui/lab/Slider'\n// import { Menu as MenuIcon } from '@material-ui/icons'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n    color: 'white',\n    zIndex: 10,\n    display: 'flex',\n    flexDirection: 'column',\n    position: 'absolute',\n    height: '50%',\n    top: '45%',\n    left: '0',\n    transform: 'translateY(-50%)'\n  },\n  sliderLabel: {\n    display: 'block',\n    flexGrow: 1,\n    textAlign: 'center',\n    padding: theme.spacing(3, 0, 3, 0)\n  },\n  container: {\n    // padding: '10px 36px'\n  },\n  track: {\n    width: `4px!important`,\n    background: 'white'\n  },\n  thumb: {\n    transform: 'translate(50%, -50%)',\n    background: 'white',\n    width: 30,\n    height: 30\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst PhotoFadeSlider = ({ defaultValue, onChange }) => {\n  const classes = useStyles()\n  // we control the state internally so we get a smooth experience\n  const [slider, setSlider] = useState(defaultValue)\n\n  const onSliderMove = (event, value) => {\n    setSlider(value)\n    // send it back if we need to\n    onChange(value)\n  }\n\n  return (\n    <div className={classes.root}>\n      <Typography className={classes.sliderLabel} color='inherit' variant='caption'>New</Typography>\n      <Slider\n        classes={{\n          container: classes.container,\n          track: classes.track,\n          thumb: classes.thumb\n        }}\n        value={slider}\n        aria-labelledby='label'\n        onChange={onSliderMove}\n        vertical\n      />\n      <Typography className={classes.sliderLabel} color='inherit' variant='caption'>Reference</Typography>\n    </div>\n  )\n}\n\nPhotoFadeSlider.propTypes = {\n  defaultValue: PropTypes.number,\n  onChange: PropTypes.func\n}\n\nPhotoFadeSlider.defaultProps = {\n  defaultValue: 100,\n  onChange: () => {}\n}\n\nexport default PhotoFadeSlider\n","export default theme => ({\n  root: {\n    width: '100%'\n  },\n  tagContainer: {\n  },\n  formControl: {\n\n  },\n  actionButtons: {\n    textAlign: 'right'\n  },\n  noOptionsMessage: {\n    padding: theme.spacing(1, 2)\n  },\n  singleValue: {\n    fontSize: 16\n  },\n  placeholder: {\n    position: 'absolute',\n    left: 2,\n    fontSize: 16\n  },\n  input: {\n    display: 'flex',\n    padding: 0\n  },\n  valueContainer: {\n    display: 'flex',\n    flexWrap: 'wrap',\n    flex: 1,\n    alignItems: 'center',\n    overflow: 'hidden'\n  },\n  paper: {\n    position: 'absolute',\n    zIndex: 1,\n    marginTop: theme.spacing(1),\n    left: 0,\n    right: 0\n  }\n})\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport Typography from '@material-ui/core/Typography'\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport TagChip from '../tags/TagChip'\nimport style from './TagControl.style'\n\nconst useStyles = makeStyles(style)\n/**\n * Just to be clear: the state here is being stored as []\n */\nconst TagControl = ({ tags, label, tagConfig, className }) => {\n  const classes = useStyles()\n  // Filter to just this tag type\n  const tagValues = tags.filter(tag => tag.typeId === tagConfig.id && !tag.coords)\n\n  return (\n    <div className={classNames(classes.root, className)}>\n      <Typography variant='overline' className={classes.fieldTitle}>\n        {tagConfig.label}\n      </Typography>\n      <div className={classes.tagContainer}>\n        {tagValues.map((tag, idx) => (\n          <TagChip tag={tag} key={`tagchip${idx}`} color={tagConfig.color} />\n        ))}\n      </div>\n\n    </div>\n  )\n}\n\nTagControl.propTypes = {\n  className: PropTypes.string,\n  label: PropTypes.string,\n  tags: PropTypes.array,\n  tagConfig: PropTypes.object\n}\n\nexport default TagControl\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport {\n  TextField,\n  Typography\n} from '@material-ui/core'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { timestampToHTML5Input, HTML5InputToTimestamp } from '../../../../lib/datelib'\n\nconst style = theme => ({\n  root: {\n  },\n  rootEdit: {\n  },\n  formControl: {\n    width: '100%'\n  },\n  textBody: {\n    whiteSpace: 'pre-line'\n  },\n  actionButtons: {\n    textAlign: 'right'\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst DateControl = ({\n  label,\n  value,\n  hint,\n  onChange,\n  className\n}) => {\n  const classes = useStyles()\n  return (\n    <div className={classNames(classes.root, className)}>\n      <Typography variant='overline' className={classes.fieldTitle}>\n        {label}\n      </Typography>\n      <TextField\n        type='datetime-local'\n        fullWidth\n        value={timestampToHTML5Input(value)}\n        className={classes.textField}\n        onChange={(e) => onChange(HTML5InputToTimestamp(e.target.value))}\n      />\n      {hint && <Typography variant='caption' className={classes.hint}>{hint}</Typography>}\n    </div>\n  )\n}\n\nDateControl.propTypes = {\n  className: PropTypes.string,\n  label: PropTypes.string.isRequired,\n  hint: PropTypes.string,\n  value: PropTypes.string, // all timestamps come in as integerstrings\n  onChange: PropTypes.func.isRequired\n}\n\nexport default DateControl\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport uuid from 'uuid/v4'\nimport Paper from '@material-ui/core/Paper'\nimport TextField from '@material-ui/core/TextField'\nimport Typography from '@material-ui/core/Typography'\nimport MenuItem from '@material-ui/core/MenuItem'\n\nimport Select from 'react-select'\nimport CreatableSelect from 'react-select/lib/Creatable'\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport TagChip from '../tags/TagChip'\nimport style from './TagControl.style'\nconst useStyles = makeStyles(style)\n\n/**\n * Just to be clear: the state here is being stored as []\n */\nconst TagControl = ({\n  tags, onChange,\n  hint, tagConfig, className\n}) => {\n  const classes = useStyles()\n  // console.log('TagControl Rnder', { tags, tagConfig })\n  const onSelectChange = (inputValue, { action, removedValue, option }) => {\n    // If this was the last tag then close the menu\n    switch (action) {\n      case 'clear':\n        onChange([])\n        break\n      case 'remove-value':\n        // Remember we need to potentially remove it from the old AND the new\n        onChange(tags.filter(val => val.id !== removedValue.value))\n        break\n      case 'select-option':\n        const newVal = {\n          ...tagConfig.values.find(tcv => tcv.id === option.value),\n          typeId: tagConfig.id\n        }\n        onChange([...tags, newVal])\n        break\n      case 'create-option':\n        const newLabel = inputValue.find(v => v.__isNew__).value\n        const newCreateVal = {\n          label: newLabel,\n          id: uuid(),\n          typeId: tagConfig.id\n        }\n        onChange([...tags, newCreateVal])\n        break\n      default:\n        break\n    }\n  }\n\n  const SingleValue = ({ removeProps, innerProps, data, ...props }) => {\n    // console.log('SingleValue PROPS', { removeProps, innerProps, data, props })\n    return (\n      <TagChip tag={data} onDelete={(e) => {\n        // console.log('EVENT', e)\n        removeProps.onClick()\n      }} color={tagConfig.color} edit />\n    )\n  }\n  SingleValue.propTypes = {\n    removeProps: PropTypes.any,\n    innerProps: PropTypes.any,\n    data: PropTypes.any\n  }\n\n  const MultiValue = ({ removeProps, innerProps, data, ...props }) => {\n    // console.log('MultiValue PROPS', { removeProps, innerProps, data, props })\n    return (\n      <TagChip tag={data} onDelete={(e) => {\n        // console.log('EVENT', e)\n        removeProps.onClick()\n      }} color={tagConfig.color} edit />\n    )\n  }\n  MultiValue.propTypes = {\n    removeProps: PropTypes.any,\n    innerProps: PropTypes.any,\n    data: PropTypes.any\n  }\n\n  // Filter to just this tag type\n  const tagValues = tags.filter(tag => tag.typeId === tagConfig.id && !tag.coords)\n  // Now format it as {label, value: id} for react-select\n  const selectOptions = tagValues.map(val => ({ label: val.label, value: val.id }))\n\n  // Filter out things we haven't chosen yet\n  // Also transform the options into a label/value pair for react-select\n  const remainingTags = tagConfig.values\n    .filter(val => tagValues.map(t => t.id).indexOf(val.id) === -1)\n    .map(val => ({ label: val.label, value: val.id }))\n\n  // console.log('TAG DEBUG', { value, tagValues, tagConfig })\n\n  return (\n    <div className={classNames(classes.root, className)}>\n      <Typography variant='overline' className={classes.fieldTitle}>\n        {tagConfig.label}\n      </Typography>\n      {!tagConfig.allowAdditions && (\n        <Select\n          options={remainingTags}\n          classes={classes}\n          isFocused\n          components={{\n            Control,\n            Menu,\n            //   MultiValue,\n            NoOptionsMessage,\n            Option,\n            Placeholder,\n            //   SingleValue,\n            ValueContainer\n          }}\n          deleteRemoves\n          value={selectOptions}\n          isClearable={false}\n          onChange={onSelectChange}\n          placeholder='Select Tags'\n          isMulti\n          isSearchable\n        />\n      ) }\n      { tagConfig.allowAdditions && (\n        <CreatableSelect\n          options={remainingTags}\n          classes={classes}\n          isFocused\n          deleteRemoves\n          components={{\n            Control,\n            Menu,\n            //   MultiValue,\n            NoOptionsMessage,\n            Option,\n            Placeholder,\n            //   SingleValue,\n            ValueContainer\n          }}\n          value={selectOptions}\n          isClearable={false}\n          onChange={onSelectChange}\n          placeholder='Select Tags'\n          isMulti\n          isSearchable\n        />\n      )}\n      {hint && <Typography variant='caption' className={classes.hint}>{hint}</Typography>}\n    </div>\n  )\n}\n\nTagControl.propTypes = {\n  className: PropTypes.string,\n  hint: PropTypes.string,\n  tags: PropTypes.array,\n  onChange: PropTypes.func.isRequired,\n  tagConfig: PropTypes.object\n}\n\nexport default TagControl\n\nfunction Control (props) {\n  // console.log('CONTROL PROPS', props)\n  return (\n    <TextField\n      fullWidth\n      InputProps={{\n        inputComponent,\n        inputProps: {\n          className: props.selectProps.classes.input,\n          inputRef: props.innerRef,\n          children: props.children,\n          // innerProps: {\n          onMouseDown: (e) => {\n            props.innerProps.onMouseDown(e)\n          },\n          onTouchEnd: (e) => {\n            props.innerProps.onTouchEnd(e)\n          }\n          // }\n          // ...props.innerProps\n        }\n      }}\n      {...props.selectProps.textFieldProps}\n    />\n  )\n}\n\nconst NoOptionsMessage = ({ innerProps, selectProps, children }) => (\n  <Typography\n    color='textSecondary'\n    className={selectProps.classes.noOptionsMessage}\n    {...innerProps}\n  >\n    {children}\n  </Typography>\n)\n\nconst Menu = ({ selectProps, innerProps, children }) => (\n  <Paper square className={selectProps.classes.paper} {...innerProps}>\n    {children}\n    {/* {console.log('MENU PROPS', { selectProps, innerProps, children })} */}\n  </Paper>\n)\n\nconst inputComponent = ({ inputRef, ...props }) => <div ref={inputRef} {...props} />\n\nconst Placeholder = (props) => (\n  <Typography\n    color='textSecondary'\n    className={props.selectProps.classes.placeholder}\n    {...props.innerProps}\n  >\n    {props.children}\n  </Typography>\n)\n\nconst Option = ({ innerRef, isFocused, isSelected, innerProps, children }) => (\n  <MenuItem\n    buttonRef={innerRef}\n    selected={isFocused}\n    component='div'\n    style={{ fontWeight: isSelected ? 500 : 400 }}\n    {...innerProps}\n  >\n    {children}\n  </MenuItem>\n)\n\nconst ValueContainer = ({ selectProps, children }) => (\n  <div className={selectProps.classes.valueContainer}>{children}</div>\n)\nValueContainer.propTypes = {\n  selectProps: PropTypes.any,\n  children: PropTypes.any\n}\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\n// import Typography from '@material-ui/core/Typography'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport Typography from '@material-ui/core/Typography'\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogActions from '@material-ui/core/DialogActions'\nimport Button from '@material-ui/core/Button'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport IconButton from '@material-ui/core/IconButton'\n\nimport CloseIcon from '@material-ui/icons/Close'\nimport TagControl from '../controls/TagControl'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n  },\n  dlgContent: {\n    // position: 'relative',\n    // maxWidth: '200px',\n    overflowY: 'visible!important',\n    paddingBottom: 300\n    // overflowX: 'hidden'\n  },\n  title: {\n    width: '100%',\n    margin: 0,\n    display: 'flex',\n    padding: theme.spacing(2)\n  },\n  dlgTitle: {\n    flexGrow: 1\n  },\n  closeButton: {\n    color: theme.palette.grey[500]\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst TagEdit = ({ open, title, onOk, onCancel, tags, tagConfig }) => {\n  const classes = useStyles()\n  const [value, setValue] = useState(tags)\n  return (\n    <Dialog\n      className={classes.root}\n      scroll='body'\n      fullScreen\n      open={open}\n      onClose={() => onOk(value)}\n    >\n      <DialogTitle className={classes.title} disableTypography>\n        <Typography className={classes.dlgTitle}>{title}</Typography>\n        <IconButton className={classes.closeButton} onClick={onCancel}>\n          <CloseIcon />\n        </IconButton>\n      </DialogTitle>\n      <DialogContent className={classes.dlgContent}>\n        <TagControl\n          className={classes.field}\n          tags={value}\n          tagConfig={tagConfig}\n          onChange={setValue}\n        />\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={onCancel}>Cancel</Button>\n        <div style={{ flexGrow: 1 }} />\n        <Button onClick={() => setValue(tags)}>Reset</Button>\n        <Button onClick={() => onOk(value)}>Ok</Button>\n      </DialogActions>\n    </Dialog>\n  )\n}\n\nTagEdit.propTypes = {\n  open: PropTypes.bool,\n  title: PropTypes.string,\n  onOk: PropTypes.func,\n  onCancel: PropTypes.func,\n  tags: PropTypes.array.isRequired,\n  tagConfig: PropTypes.object.isRequired\n}\n\nexport default TagEdit\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport Typography from '@material-ui/core/Typography'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { formatDate } from '../../../../lib/datelib'\n\nconst style = theme => ({\n  root: { },\n  rootEdit: { },\n  formControl: {\n    width: '100%'\n  },\n  textBody: {\n    whiteSpace: 'pre-line'\n  },\n  actionButtons: {\n    textAlign: 'right'\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst DateView = ({\n  label,\n  value,\n  className\n}) => {\n  const classes = useStyles()\n  return (\n    <div className={classNames(classes.root, className)}>\n      <Typography variant='overline' className={classes.fieldTitle}>\n        {label}\n      </Typography>\n      <Typography variant='body1' className={classes.hint}>{value ? formatDate(value) : ''}</Typography>\n    </div>\n  )\n}\n\nDateView.propTypes = {\n  className: PropTypes.string,\n  label: PropTypes.string.isRequired,\n  value: PropTypes.string\n}\n\nexport default DateView\n","import React, { useContext, useState } from 'react'\nimport PropTypes from 'prop-types'\n\nimport Typography from '@material-ui/core/Typography'\nimport Divider from '@material-ui/core/Divider'\nimport List from '@material-ui/core/List'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemText from '@material-ui/core/ListItemText'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport TagView from '../controls/TagView'\nimport ShortLongText from '../controls/ShortLongText'\nimport DateControl from '../controls/DateControl'\nimport TagClass from '../../../../lib/Tags'\nimport BigTextEdit from '../dialogs/BigTextEdit'\nimport BigText from '../dialogs/BigText'\nimport TagEdit from '../dialogs/TagEdit'\n\nimport { SeriesContext } from '../../contexts'\nimport DateView from '../controls/DateView'\n\nconst style = theme => ({\n  root: {\n    height: '90%',\n    width: '85%'\n  },\n  dlgTitleContainer: {\n    display: 'flex',\n    padding: 0\n  },\n  catTagTitle: {\n    marginTop: theme.spacing(2)\n  },\n  dlgTitle: {\n    flexGrow: 1,\n    paddingTop: theme.spacing(2),\n    paddingBottom: theme.spacing(1),\n    paddingLeft: theme.spacing(3)\n  },\n  field: {\n    marginBottom: theme.spacing(2)\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst DIALOGS = {\n  NOTEEDIT: 'noteEdit',\n  NOTEVIEW: 'noteView',\n  PHOTOTAKEN: 'taken',\n  TAGEDIT: 'tag',\n  CANCEL: 'cancel'\n}\n\nconst PhotoInfo = ({ canEdit, photo, delta, onChange }) => {\n  const classes = useStyles()\n  const { seriesConfig } = useContext(SeriesContext)\n  const [{ activeDialog, activeDialogContext }, setActiveDialog] = useState({})\n\n  const tagInst = new TagClass(seriesConfig, delta.tags || photo.tags)\n\n  let metaKeys = []\n  try {\n    metaKeys = photo.meta ? Object.keys(JSON.parse(photo.meta)) : []\n  }\n  catch (e) {\n    console.error(e)\n  }\n  return (\n    <div>\n      {canEdit ? (\n        <DateControl\n          className={classes.field}\n          label='Photo taken on'\n          value={delta.takenOn || photo.takenOn}\n          onChange={takenOn => onChange({ takenOn })}\n          canEdit={canEdit}\n        />\n      )\n        : (\n          <DateView\n            label='Photo taken on'\n            value={delta.takenOn || photo.takenOn}\n          />\n        )}\n\n      {(canEdit || photo.note) && (\n        <ShortLongText\n          label='Photo Note'\n          text={delta.note || photo.note}\n          onClick={() => {\n            if (canEdit) setActiveDialog({ activeDialog: DIALOGS.NOTEEDIT })\n            else setActiveDialog({ activeDialog: DIALOGS.NOTEVIEW })\n          }}\n        />\n      )}\n      <Typography variant='subtitle1' className={classes.catTagTitle}>Category tags</Typography>\n      <Divider />\n      {tagInst.seriesConfig.getNonXYTagTypes().map((tt, idx) => (\n        <div\n          key={`tagtype-${idx}`}\n          onClick={() => canEdit ? setActiveDialog({ activeDialog: DIALOGS.TAGEDIT, activeDialogContext: tt }) : null}\n        >\n          <TagView\n            className={classes.field}\n            label={tt.label}\n            tags={delta.tags || photo.tags}\n            tagConfig={tt}\n          />\n        </div>\n      ))}\n\n      {metaKeys.length > 0 && Object.keys(seriesConfig.meta).length > 0 && (\n        <React.Fragment>\n          <Typography className={classes.heading}>Metadata</Typography>\n          <Divider />\n          <List className={classes.list}>\n            {metaKeys.map((key, idx) => seriesConfig.meta[key] ? (\n              <ListItem key={`metadata${idx}`}>\n                <ListItemText\n                  primary={seriesConfig.meta[key].label}\n                  secondary={seriesConfig.meta[key].render(photo.meta[key])}\n                />\n              </ListItem>\n            ) : null\n            )}\n          </List>\n        </React.Fragment>\n      )}\n      {activeDialog && activeDialog === DIALOGS.NOTEEDIT && (\n        <BigTextEdit\n          open\n          multiline\n          onOk={note => {\n            onChange({ note })\n            setActiveDialog({})\n          }}\n          title='Edit Photo Note'\n          body={delta.note || photo.note}\n        />\n      )}\n      {activeDialog && activeDialog === DIALOGS.NOTEVIEW && (\n        <BigText\n          open\n          multiline\n          onClose={() => setActiveDialog({})}\n          title='Photo Note'\n          body={delta.note || photo.note}\n        />\n      )}\n      {activeDialog && activeDialog === DIALOGS.TAGEDIT && (\n        <TagEdit\n          open\n          title={`Edit Tags: ${activeDialogContext.label}`}\n          onOk={tags => {\n            setActiveDialog({})\n            onChange({ tags })\n          }}\n          onCancel={() => setActiveDialog({})}\n          tags={delta.tags || photo.tags}\n          tagConfig={activeDialogContext}\n        />\n      )}\n    </div>\n  )\n}\n\nPhotoInfo.propTypes = {\n  canEdit: PropTypes.bool,\n  onChange: PropTypes.func.isRequired,\n  photo: PropTypes.object.isRequired,\n  delta: PropTypes.object.isRequired\n}\n\nexport default PhotoInfo\n","import React, { useState, useMemo } from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogActions from '@material-ui/core/DialogActions'\nimport Button from '@material-ui/core/Button'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport FormLabel from '@material-ui/core/FormLabel'\nimport Slider from '@material-ui/lab/Slider'\n\nimport MapDot from '../../../maps/MapDot'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n\n  },\n  dlgContent: {\n    display: 'flex',\n    flexDirection: 'column',\n    padding: 0\n  },\n  mapWrapper: {\n    flexGrow: 1\n  },\n  sliderWrapper: {\n    padding: '20px'\n  },\n  slider: {\n    padding: '22px 0px'\n  },\n  sliderRoor: {\n    padding: '0 20px'\n  },\n  body: {\n    overflow: 'hidden',\n    whiteSpace: 'pre-line',\n    paddingBottom: theme.spacing(1)\n  },\n  title: {\n    background: theme.palette.primary.main,\n    color: theme.palette.primary.contrastText,\n    margin: 0,\n    padding: theme.spacing(2)\n  },\n  closeButton: {\n    position: 'absolute',\n    right: theme.spacing(1),\n    top: theme.spacing(1),\n    color: theme.palette.grey[500]\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst MapDirPicker = ({ open, onOk, onCancel, title, latitude: initLat, longitude: initLong, direction: initDir }) => {\n  const classes = useStyles()\n  const [{ longitude, latitude }, setCoords] = useState({ longitude: initLong, latitude: initLat })\n  const [direction, setRotation] = useState(initDir)\n\n  const initViewport = useMemo(() => ({\n    zoom: 18,\n    latitude: initLat,\n    longitude: initLong\n  }), [initLat, initLong])\n\n  const mapChange = ({ viewport: { longitude, latitude } }) => setCoords({ longitude, latitude })\n\n  return (\n    <Dialog\n      scroll='paper'\n      open={open}\n      fullWidth\n      fullScreen\n      onClose={onCancel}\n    >\n      <DialogTitle className={classes.title} disableTypography>\n        <Typography color='inherit'>{title}</Typography>\n      </DialogTitle>\n      <DialogContent className={classes.dlgContent}>\n        <div className={classes.mapWrapper}>\n          <MapDot\n            editable\n            className={classes.map}\n            direction={direction > 0 ? direction : null}\n            viewport={initViewport}\n            onChange={mapChange}\n          />\n        </div>\n        <div className={classes.sliderWrapper}>\n          <FormLabel className={classes.mapFormLabel}>Direction {direction > -1 ? '' : '(off)'}</FormLabel>\n          <Slider\n            classes={{ root: classes.sliderRoor, container: classes.slider }}\n            value={direction || -1}\n            min={-1}\n            max={360}\n            step={1}\n            onChange={(e, value) => setRotation(value)}\n          />\n        </div>\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={onCancel}>Cancel</Button>\n        <div style={{ flexGrow: 1 }} />\n        <Button onClick={() => onOk({ longitude, latitude, direction })}>Ok</Button>\n      </DialogActions>\n    </Dialog>\n  )\n}\n\nMapDirPicker.propTypes = {\n  open: PropTypes.bool,\n  latitude: PropTypes.number,\n  longitude: PropTypes.number,\n  direction: PropTypes.number,\n  onOk: PropTypes.func,\n  onCancel: PropTypes.func,\n  title: PropTypes.string\n}\n\nexport default MapDirPicker\n","\nimport React, { useState } from 'react'\nimport PropTypes from 'prop-types'\n\nimport TextField from '@material-ui/core/TextField'\nimport FormLabel from '@material-ui/core/FormLabel'\nimport Typography from '@material-ui/core/Typography'\nimport FormControlLabel from '@material-ui/core/FormControlLabel'\nimport Switch from '@material-ui/core/Switch'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport MapDot from '../../../maps/MapDot'\n\nimport MapDirPicker from '../dialogs/MapDirPicker'\nimport BigTextEdit from '../dialogs/BigTextEdit'\n\nimport style from './SeriesEditInner.style'\nimport { ACCESS } from '../../../../config'\nimport ShortLongText from '../controls/ShortLongText'\n\nconst DIALOGS = {\n  MAPPICK: 'mapPicker',\n  NOTEEDIT: 'noteEdit'\n}\n\nconst useStyles = makeStyles(style)\n\n/**\n * SeriesEdit appears in two places so we need this to be a bit reusable\n */\nconst SeriesEditInner = ({ series, delta, onChange }) => {\n  const classes = useStyles()\n  const [activeDialog, setActiveDialog] = useState(null)\n\n  const viewport = { zoom: 18 }\n  if ((delta.latitude || series.coords[1]) && (delta.longitude || series.coords[0])) {\n    viewport.longitude = delta.longitude || series.coords[0]\n    viewport.latitude = delta.latitude || series.coords[1]\n  }\n\n  const access = delta.access || series.access || 'PRIVATE'\n  // console.log('ACESS', access)\n  return (\n    <div>\n      <TextField\n        label='Series Name'\n        fullWidth\n        placeholder='New Series'\n        className={classes.field}\n        value={delta.name || series.name || ''}\n        onChange={e => onChange({ ...delta, name: e.target.value })}\n      />\n      <div className={classes.mapWrapper} onClick={() => setActiveDialog(DIALOGS.MAPPICK)}>\n        <FormLabel className={classes.mapFormLabel}>Location</FormLabel>\n        <div className={classes.mapInnerWrap}>\n          <MapDot\n            staticMap\n            className={classes.map}\n            direction={delta.direction || series.direction}\n            viewport={viewport}\n          />\n        </div>\n      </div>\n      <div className={classes.field}>\n        <FormLabel>Series Access</FormLabel>\n        <div className={classes.access}>\n          <FormControlLabel\n            className={classes.accessRadio}\n            control={\n              <Switch\n                checked={['OPEN', 'PUBLIC'].indexOf(access) > -1}\n                onChange={(e) => {\n                  onChange({ ...delta, access: e.target.checked ? 'PUBLIC' : 'PRIVATE' })\n                }}\n                value={'PUBLIC'}\n              />\n            }\n            label={<div>\n              <Typography variant='body2' component='div'>{ACCESS.PUBLIC.label}</Typography>\n              <Typography variant='caption' component='div'>{ACCESS.PUBLIC.description}</Typography>\n            </div>}\n\n          />\n          <FormControlLabel\n            className={classes.accessRadio}\n            disabled={['PRIVATE'].indexOf(access) > -1}\n            control={\n              <Switch\n                checked={['OPEN'].indexOf(access) > -1}\n                onChange={(e) => onChange({ ...delta, access: e.target.checked ? 'OPEN' : 'PUBLIC' })}\n                value={'OPEN'}\n              />\n            }\n            label={<div>\n              <Typography variant='body2' component='div'>{ACCESS.OPEN.label}</Typography>\n              <Typography variant='caption' component='div'>{ACCESS.OPEN.description}</Typography>\n            </div>}\n          />\n        </div>\n      </div>\n\n      <ShortLongText\n        onClick={() => setActiveDialog(DIALOGS.NOTEEDIT)}\n        className={classes.field}\n        label='Series Note'\n        text={delta.note || series.note}\n      />\n      {activeDialog === DIALOGS.MAPPICK && (\n        <MapDirPicker\n          open\n          title='Series Location & Direction'\n          latitude={delta.latitude || series.coords[1]}\n          longitude={delta.longitude || series.coords[0]}\n          direction={delta.direction || series.direction}\n          onOk={(data) => {\n            onChange({ ...delta, ...data })\n            setActiveDialog(null)\n          }}\n          onCancel={() => setActiveDialog(null)}\n        />\n      )}\n      {activeDialog === DIALOGS.NOTEEDIT && (\n        <BigTextEdit\n          open\n          title='Series Note'\n          body={delta.note || series.note}\n          multiline\n          onOk={(newNote) => {\n            onChange({ ...delta, note: newNote })\n            setActiveDialog(null)\n          }}\n          onCancel={() => setActiveDialog(null)}\n        />\n      )}\n    </div>\n  )\n}\n\nSeriesEditInner.propTypes = {\n  // now some functions\n  series: PropTypes.object.isRequired,\n  delta: PropTypes.object.isRequired,\n  onChange: PropTypes.func.isRequired\n}\n\nexport default SeriesEditInner\n","export default theme => ({\n  root: {\n\n  },\n  inner: {\n    display: 'flex',\n    flexDirection: 'column'\n    // padding: theme.spacing(1)\n  },\n  dlgTitle: {\n    background: theme.palette.primary.main,\n    color: theme.palette.primary.contrastText\n  },\n  access: {\n    // display: 'flex'\n  },\n  accessRadio: {\n    // flex: '1 1 50%'\n  },\n  grow: {\n    flexGrow: 1\n  },\n  field: {\n    flexGrow: 0,\n    marginBottom: theme.spacing(1) * 2\n  },\n  slider: {\n    paddingLeft: theme.spacing(1),\n    paddingRight: theme.spacing(1)\n  },\n  textField: {\n    marginLeft: theme.spacing(1),\n    marginRight: theme.spacing(1),\n    width: '100%'\n  },\n  formLabel: {\n    display: 'block',\n    marginTop: theme.spacing(1),\n    marginBottom: theme.spacing(1)\n  },\n  mapFormLabel: {\n    display: 'block',\n    marginTop: theme.spacing(1),\n    marginBottom: theme.spacing(1)\n  },\n  mapInnerWrap: {\n    flexGrow: 1,\n    height: '200px',\n    minHeight: '200px'\n  },\n  mapWrapper: {\n    flexGrow: 1,\n    display: 'flex',\n    flexDirection: 'column',\n    paddingBottom: theme.spacing(1) * 2\n  },\n  formControl: {\n    margin: theme.spacing(1),\n    minWidth: 120\n  },\n  chips: {\n    display: 'flex',\n    flexWrap: 'wrap'\n  }\n})\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n    width: 1,\n    height: 1,\n    zIndex: 1\n  },\n  svgDot: {\n    width: 20,\n    height: 20,\n    position: 'absolute',\n    top: '50%',\n    left: '50%',\n    textAlign: 'center',\n    transformOrigin: '50% 50%',\n    transform: 'translateY(-50%) translateX(-50%)'\n  },\n  svgAccuracyDot: {\n    position: 'absolute',\n    top: '50%',\n    left: '50%',\n    textAlign: 'center',\n    transformOrigin: '50% 50%',\n    transform: 'translateY(-50%) translateX(-50%)'\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst MyLocation = ({ position, projection }) => {\n  const classes = useStyles()\n  const accuracy = 20 // assume 20m to start\n  // metersPerPixel [12, 12, 12]\n  // pixelsPerMeter [0: 0.08029229250399847, 1: -0.08029229250399847, 2: 0.08029229250399847]\n  // console.log('POSITION', { position, projection })\n  const accHeight = projection.pixelsPerMeter[0] * (accuracy)\n  const accWidth = projection.pixelsPerMeter[1] * (accuracy)\n  return (\n    <div className={classes.root}>\n      {/* This is the accuracy radius */}\n      <svg\n        style={{ height: accHeight, width: accWidth }}\n        className={classes.svgAccuracyDot}\n        version='1.1'\n        viewBox='0, 0, 100, 100'\n      >\n        <circle cx='50' cy='50' r={49}\n          stroke='#8888FF'\n          fillOpacity='0.4'\n          strokeWidth='1'\n          fill='#AAAAFF'\n        />\n      </svg>\n      {/* This is the dot */}\n      <svg className={classes.svgDot} version='1.1' viewBox='0, 0, 10, 10'>\n        <circle cx='5' cy='5' r='4'\n          stroke='#FFFFFF'\n          strokeWidth='1'\n          fill='#4444FF'\n        />\n      </svg>\n    </div>\n  )\n}\n\nMyLocation.propTypes = {\n  position: PropTypes.object,\n  projection: PropTypes.object\n}\n\nexport default MyLocation\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Fab from '@material-ui/core/Fab'\nimport MyLocationIcon from '@material-ui/icons/MyLocation'\n\nimport { makeStyles, useTheme } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n    border: '1px solid',\n    background: theme.palette.grey[100],\n    color: 'black',\n    width: 40,\n    height: 40,\n    zIndex: 10,\n    position: 'absolute'\n    // margin: theme.spacing(0.5),\n    // padding: theme.spacing(0.5),\n    // border: '2px solid',\n    // borderRadius: theme.spacing(1),\n    // background: theme.palette.common.white,\n    // fontSize: 20,\n    // position: 'absolute',\n    // zIndex: 100,\n    // bottom: theme.spacing(10),\n    // right: theme.spacing(2)\n  }\n})\n\nconst useStyles = makeStyles(style)\n\nconst MyLocationButton = ({ onClick, controlPadding, disabled }) => {\n  const classes = useStyles()\n  const theme = useTheme()\n  return (\n    <Fab\n      disabled={disabled}\n      style={{\n        top: 56 + (controlPadding.top ? controlPadding.top : theme.spacing(2)),\n        right: controlPadding.right ? controlPadding.right : theme.spacing(2)\n      }}\n      aria-label='myLocation'\n      className={classes.root}\n      onClick={onClick}\n    >\n      <MyLocationIcon />\n    </Fab>\n  )\n}\n\nMyLocationButton.propTypes = {\n  controlPadding: PropTypes.object,\n  onClick: PropTypes.func.isRequired,\n  disabled: PropTypes.bool\n}\n\nexport default MyLocationButton\n","import React, { useState, useRef, useMemo, useEffect } from 'react'\nimport ReactMapGL, { NavigationControl, Marker, FlyToInterpolator } from 'react-map-gl'\nimport PropTypes from 'prop-types'\nimport { easeCubic } from 'd3-ease'\nimport WebMercatorViewport, { getDistanceScales } from 'viewport-mercator-project'\nimport useComponentSize from '../../lib/useComponentSize'\nimport MyLocation from './markers/MyLocation'\nimport { useGeolocation } from '../../lib/sensors'\n// import { debounce } from '../../lib/util'\nimport StyleButtons from './controls/StyleButtons'\nimport MyLocationButton from './controls/MyLocationButton'\nimport { mapConfig } from '../../config'\nimport classNames from 'classnames'\nimport 'mapbox-gl/dist/mapbox-gl.css'\nimport './BaseMap.css'\n\n/**\n * Note that this component technically has state but it is designed to be functionally stateless\n */\nconst BaseMap = (props) => {\n  // pull what we need out of the props\n  const {\n    showMe,\n    children,\n    mapStyles,\n    controlPadding,\n    viewport: initViewport,\n    bounds,\n    lockToBounds,\n    lockPan,\n    initStyle,\n    onViewportChange: incomingOnViewportChange,\n    onTransitionStart: incomingOnTransitionStart,\n    onTransitionEnd: incomingOnTransitionEnd,\n    transitions,\n    onMapDataEvent,\n    stylechooser,\n    ...passthroughProps\n  } = props\n\n  const mapContainerRef = useRef(null)\n  const mapBoxRef = useRef(null)\n  const innerTransitionsRef = useRef(null)\n\n  const { size } = useComponentSize(mapContainerRef)\n\n  const [currStyle, setCurrStyle] = useState(initStyle)\n\n  // This is the truth of the viewport!!\n  const [viewport, setViewport] = useState({ ...defaultViewVals, ...initViewport })\n  const [isTransitioning, setIsTransitioning] = useState(false)\n  const [projection, setProjection] = useState(null)\n\n  let myPosition = {}\n  if (showMe) {\n    myPosition = useGeolocation()\n  }\n  const geoMarker = (myPosition.latitude && myPosition.longitude)\n    ? (\n      <Marker key='myPos' className='myPosMarker' latitude={myPosition.latitude} longitude={myPosition.longitude} style={{ zIndex: 1 }}>\n        <MyLocation position={myPosition} projection={projection} />\n      </Marker>\n    ) : null\n\n  // Recalculate the projection if we need to but only when zoom changes\n  useMemo(() => {\n    if (!size || size.width < 10 || size.height < 10) return\n    if (mapStyles.length <= currStyle) setCurrStyle(initStyle)\n    try {\n      const projection = getDistanceScales(viewport)\n      // console.log('recalcProjection', { projection, size })\n      setProjection(projection)\n    }\n    catch (e) {\n      console.log('ERROR', viewport)\n      console.error(e)\n    }\n  }, [viewport.zoom, size])\n\n  const flyToMe = () => {\n    if (!myPosition.latitude || !myPosition.longitude) return\n    const transitionTime = 2000\n    innerTransitionsRef.current = {\n      transitionDuration: transitionTime,\n      transitionInterpolator: new FlyToInterpolator(),\n      transitionEasing: easeCubic\n    }\n    // You get `transitionTime` ms to figure this out. then we just jump\n    setTimeout(() => {\n      if (innerTransitionsRef.current) innerTransitionsRef.current = null\n    }, transitionTime)\n    setViewport({\n      ...viewport,\n      latitude: myPosition.latitude,\n      longitude: myPosition.longitude,\n      zoom: viewport.zoom > 10 ? viewport.zoom : 12\n    })\n  }\n\n  /**\n   * Callback fired when the user changes the viewport object\n   * @param {*} viewport\n   */\n  const onViewportChange = (viewportChange) => {\n    const newViewport = { ...viewportChange }\n    // Here we set/reset the bounds\n    if (bounds && lockToBounds) {\n      if (newViewport.longitude < bounds[0]) newViewport.longitude = bounds[0]\n      else if (newViewport.longitude > bounds[2]) newViewport.longitude = bounds[2]\n\n      if (newViewport.latitude < bounds[1]) newViewport.latitude = bounds[1]\n      else if (newViewport.latitude > bounds[3]) newViewport.latitude = bounds[3]\n    }\n    if (lockPan) {\n      newViewport.latitude = viewport.latitude\n      newViewport.longitude = viewport.longitude\n    }\n\n    // console.log('onViewportChange', newViewport)\n    // Fire the external callback so parent components can track viewport if they need to\n    if (!isTransitioning && typeof incomingOnViewportChange === 'function') {\n      incomingOnViewportChange({\n        viewport: newViewport,\n        size,\n        projection,\n        map: mapBoxRef.current && mapBoxRef.current.getMap()\n      })\n    }\n    setViewport(newViewport)\n  }\n\n  const recalcZoomBounds = () => {\n    // console.log('Should I recalc viewbounds?')\n    if (!bounds || !size || size.width < 10 || size.height < 10 || isTransitioning) return\n    // On the first run we're going to try to center the bounds.\n    const [minlng, minlat, maxlng, maxlat] = bounds\n    try {\n      console.log('recalcZoomBounds')\n      const { longitude, latitude, zoom } = new WebMercatorViewport({ ...size, ...viewport }).fitBounds(\n        [ [minlng, minlat], [maxlng, maxlat] ],\n        { padding: 40, offset: [0, 0] }\n      )\n      console.log('Changing Zoom ', bounds, viewport.zoom, zoom, viewport)\n\n      // console.log('recalcZoomBounds')\n      setViewport({ ...viewport, longitude, latitude, zoom })\n    }\n    catch (e) {\n      // Sometimes we don't have a valid bound. Don't make a big deal out of it.\n      console.error(e)\n    }\n  }\n\n  const handleTransitionStart = () => {\n    console.log('handleTransitionStart (internal)')\n    setIsTransitioning(true)\n    if (typeof incomingOnTransitionStart === 'function') incomingOnTransitionStart()\n  }\n\n  const handleTransitionEnd = () => {\n    console.log('handleTransitionEnd (internal)')\n    setIsTransitioning(false)\n    innerTransitionsRef.current = null\n    if (incomingOnTransitionEnd) incomingOnTransitionEnd()\n    if (typeof incomingOnViewportChange === 'function') {\n      incomingOnViewportChange({\n        viewport,\n        size,\n        projection,\n        map: mapBoxRef.current && mapBoxRef.current.getMap()\n      })\n    }\n  }\n\n  // RecalcZoombounds should only be done sparingly\n  useMemo(recalcZoomBounds, [size, bounds])\n\n  useEffect(() => {\n    setViewport({ ...viewport, ...initViewport })\n  }\n  , [initViewport])\n\n  return (\n    <div className={classNames('mapContainer', props.className)} ref={mapContainerRef}>\n      {size.height > 0 && size.width > 0 && (\n        <ReactMapGL\n          {...viewport}\n          {...(innerTransitionsRef.current || transitions)}\n          ref={map => {\n            mapBoxRef.current = map\n          }}\n          height={size.height}\n          width={size.width}\n          mapStyle={currStyle < mapStyles.length ? mapStyles[currStyle].style : mapStyles[0].style}\n          onData={onMapDataEvent}\n          onTransitionStart={handleTransitionStart}\n          onTransitionEnd={handleTransitionEnd}\n          dragPan={!lockPan}\n          onViewportChange={onViewportChange}\n          mapboxApiAccessToken={mapConfig.mapBoxToken}\n          {...passthroughProps}\n        >\n          {\n            children && Array.isArray(children)\n              ? children.map((c, idx) => c ? React.cloneElement(\n                handleChild(c, viewport, size.height, size.width, projection),\n                { key: `mapChild-${idx}` }\n              ) : null)\n              : handleChild(children, viewport, size.height, size.width, projection)\n          }\n          {/* Make sure the controls are above everything else */}\n          { stylechooser && (\n            <StyleButtons\n              controlPadding={controlPadding}\n              currStyle={currStyle}\n              mapStyles={mapStyles}\n              setCurrStyle={setCurrStyle}\n            />\n          )}\n          {/* Augment children with some props they need to survive in this harsh world */}\n          { !props.hideNavControls && (\n            <NavigationControl\n              onViewportChange={viewport => onViewportChange({ ...viewport, ...size })}\n              showZoom={!props.touchZoom === false && !props.scrollZoom === false}\n              showCompass={!props.touchRotate === false && !props.dragRotate === false}\n            />\n          )}\n          {showMe && (\n            <React.Fragment>\n              {geoMarker}\n              <MyLocationButton disabled={!myPosition || !myPosition.latitude} controlPadding={controlPadding} onClick={flyToMe} />\n            </React.Fragment>\n          )}\n        </ReactMapGL>\n      )}\n    </div>\n  )\n}\n\nBaseMap.propTypes = {\n  // Anything else we want to add to the map\n  children: PropTypes.any,\n  data: PropTypes.array,\n  // Maybe we want map controls to be padded\n  controlPadding: PropTypes.object,\n\n  showMe: PropTypes.bool,\n\n  // Separate transitions from viewport so we can set them independently\n  transitions: PropTypes.object,\n  initStyle: PropTypes.number,\n\n  // Some switches to make things easier\n  stylechooser: PropTypes.bool,\n  lockPan: PropTypes.bool,\n  lockRotation: PropTypes.bool,\n  lockZoom: PropTypes.bool,\n  lockToBounds: PropTypes.bool,\n  hideNavControls: PropTypes.bool,\n\n  // bounds of the map. may be locked or not [minlng, minlat], [maxlng, maxlat]\n  bounds: PropTypes.array,\n\n  // List of valid styles that will get picker buttons\n  mapStyles: PropTypes.array,\n\n  onMapDataEvent: PropTypes.func,\n  onViewportChange: PropTypes.func\n}\n\nBaseMap.defaultProps = {\n  controlPadding: {},\n  stylechooser: true,\n  initStyle: 0,\n  mapStyles: mapConfig.styles,\n  lockToBounds: false\n}\n\nexport default BaseMap\n\nconst defaultViewVals = {\n  latitude: 49.3050394,\n  longitude: -123.1398254,\n  bearing: 0,\n  pitch: 0,\n  zoom: 12\n}\n\nfunction handleChild (child, viewport, height, width, projection) {\n  return typeof child === 'function'\n    ? child(viewport, height, width, projection)\n    : child\n}\n","import React, { useState, useContext } from 'react'\nimport classNames from 'classnames'\nimport PropTypes from 'prop-types'\n\nimport GridList from '@material-ui/core/GridList'\nimport GridListTile from '@material-ui/core/GridListTile'\nimport GridListTileBar from '@material-ui/core/GridListTileBar'\nimport Snackbar from '@material-ui/core/Snackbar'\nimport Button from '@material-ui/core/Button'\nimport Fab from '@material-ui/core/Fab'\n\nimport AddIcon from '@material-ui/icons/Add'\nimport RemoveIcon from '@material-ui/icons/Remove'\n\nimport { SeriesContext } from '../../contexts'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport style from './PhotoGrid.style'\nimport DeleteDialog from '../dialogs/DeleteDialog'\nimport { formatDate } from '../../../../lib/datelib'\n\nconst useStyles = makeStyles(style)\n\nconst PhotoGrid = ({ photos, columns, multiSelect, onDelete, onTileClick }) => {\n  const [selectMode, setSelectMode] = useState(false)\n  const classes = useStyles()\n  const [selectedItems, setSelectedItems] = useState([])\n  const [deleteConfirm, setDeleteConfirm] = useState(false)\n\n  const { seriesConfig, ac } = useContext(SeriesContext)\n\n  const handleAddToSelection = (e, id) => {\n    e.preventDefault()\n    e.stopPropagation()\n\n    setSelectMode(true)\n    toggleListItem(id)\n  }\n\n  const handleCancelSelection = () => {\n    setSelectMode(false)\n    setSelectedItems([])\n  }\n\n  const onDeleteConfirm = (confirmation) => {\n    setDeleteConfirm(false)\n    if (confirmation === true && selectedItems.length < photos.length) onDelete(selectedItems)\n    handleCancelSelection()\n  }\n\n  const toggleListItem = (id) => {\n    const index = selectedItems.indexOf(id)\n    if (index < 0) setSelectedItems([...selectedItems, id])\n    else {\n      const remaining = selectedItems.filter(arrId => arrId !== id)\n      if (remaining.length === 0) handleCancelSelection()\n      setSelectedItems(remaining)\n    }\n  }\n\n  const handlePhotoTap = (e, photo) => {\n    e.preventDefault()\n    e.stopPropagation()\n    // Select / deselect the item in edit mode\n    if (selectMode) toggleListItem(photo.id)\n    // navigate if tileClick selected\n    else onTileClick(photo.id)\n  }\n\n  const sortedPhotos = [...photos]\n  sortedPhotos.sort((a, b) => parseInt(b.takenOn, 10) - parseInt(a.takenOn, 10))\n\n  return (\n    <div>\n      <GridList cols={columns} cellHeight={200} className={classes.root}>\n        {sortedPhotos.map((photo, idx) => {\n          const selected = selectedItems.indexOf(photo.id) > -1\n          const canDelete = ac.canUser('delete', photo, 'photo')\n\n          let photoUrl = seriesConfig.getPhotoUrl(photo, 'thumb') || photo.base64\n\n          return (\n            <GridListTile\n              key={`gridTile${idx}`}\n              onClick={(e) => canDelete && handlePhotoTap(e, photo)}\n              className={classNames(\n                classes.tile,\n                selectMode && !canDelete && classes.notDeleteable,\n                selectMode && canDelete && !selected && classes.unSelectedTile,\n                selectMode && selected && classes.selectedTile\n              )}\n            >\n              <img src={photoUrl} alt={photoUrl} className={classes.img} />\n              {canDelete && multiSelect && (\n                <Fab size='small' aria-label='Add' className={classes.addFab} onClick={(e) => handleAddToSelection(e, photo.id)}>\n                  {!selectMode || !selected ? <AddIcon /> : <RemoveIcon />}\n                </Fab>\n              )}\n              <GridListTileBar\n                title={<span>{formatDate(photo.takenOn)}</span>}\n              />\n            </GridListTile>\n          )\n        })}\n      </GridList>\n      <Snackbar\n        open={selectMode}\n        autoHideDuration={null}\n        ContentProps={{\n          'aria-describedby': 'snackbar-fab-message-id',\n          className: classes.snackbarContent\n        }}\n        message={<span id='snackbar-fab-message-id'>{selectedItems.length} Photos selected</span>}\n        action={<div>\n          <Button color='inherit' disabled={selectedItems.length >= photos.length} size='small' onClick={() => setDeleteConfirm(true)}>\n                Delete\n          </Button>\n          <Button color='inherit' size='small' onClick={() => handleCancelSelection()}>\n                Cancel\n          </Button>\n        </div>\n        }\n        className={classes.snackbar}\n      />\n\n      <DeleteDialog\n        open={deleteConfirm}\n        onConfirm={onDeleteConfirm}\n        title={`Delete ${selectedItems.length} Photos`}\n        message='Are you sure you want to delete these photos?'\n      />\n    </div>\n\n  )\n}\n\nPhotoGrid.propTypes = {\n  photos: PropTypes.array.isRequired,\n  columns: PropTypes.number,\n\n  multiSelect: PropTypes.bool,\n  onDelete: PropTypes.func,\n  onTileClick: PropTypes.func.isRequired\n}\nPhotoGrid.defaultProps = {\n  multiSelect: true,\n  columns: 2\n}\n\nexport default PhotoGrid\n","import { red } from '@material-ui/core/colors'\nexport default theme => ({\n  root: {\n\n  },\n  tile: {\n\n  },\n  addFab: {\n    position: 'absolute',\n    zIndex: 10,\n    top: theme.spacing(1),\n    left: theme.spacing(1),\n    opacity: 0.3\n  },\n  notDeleteable: {\n    background: 'black',\n    opacity: 0.1\n    // '& img': {\n    // }\n  },\n  unSelectedTile: {\n    '& img': {\n      opacity: 0.7\n    }\n  },\n  selectedTile: {\n    padding: `${theme.spacing(2)}px!important`,\n    '& img': {\n      opacity: 1\n    }\n  },\n  img: {\n\n  },\n  snackbarContent: {\n    backgroundColor: red[700]\n  },\n  snackbar: {\n  }\n})\n","import React, { useState, useContext } from 'react'\nimport PropTypes from 'prop-types'\nimport exifParser from 'exif-parser'\nimport { isNumeric } from '../../../lib/util'\n\nimport PhotoReviewTool from './PhotoReviewTool'\nimport CameraTool from './CameraTool'\nimport NewPhotoInfo from './NewPhotoInfo'\nimport LibraryFilePicker from './controls/LibraryFilePicker'\n\nimport PhotoClass from '../../../lib/Photo'\nimport SeriesClass from '../../../lib/Series'\nimport { useDeviceOrientation, useGeolocation } from '../../../lib/sensors'\n\nimport { SeriesContext } from '../contexts'\n\nconst MODES = {\n  CAMERA: 'camera',\n  FILEPICKER: 'library',\n  PHOTOREVIEW: 'photoreview',\n  PHOTOINFOEDIT: 'photoinfoedit'\n}\n\nconst NewPhoto = ({ inputMethod, onCreate, onCancel, isNewSeries }) => {\n  const { seriesConfig, series } = useContext(SeriesContext)\n  const [newPhoto, setNewPhoto] = useState(null)\n  const [newSeries, setNewSeries] = useState(isNewSeries ? new SeriesClass(seriesConfig).series : null)\n\n  const [photoRefId, setPhotoRefId] = useState(null)\n  const [mode, _changeMode] = useState({ current: inputMethod, history: [] })\n  const orientation = useDeviceOrientation()\n  const geo = useGeolocation()\n\n  const photos = series && series.photos ? series.photos : []\n\n  const onLibraryAdd = (data) => {\n    console.log('onLibraryAdd Debug GOT DATA', { data })\n    const find = 'base64,'\n    let exif = {}\n    const foundIdx = data.indexOf(find) + find.length\n    const newData = data.slice(foundIdx)\n    const parser = exifParser.create(Buffer.from(newData, 'base64'))\n    console.log('onLibraryAdd Buffered')\n    try {\n      exif = parser.parse()\n      console.log('got EXIF', JSON.stringify(exif))\n    }\n    catch (err) {\n    // got invalid data, handle error\n      console.error('EXIF ERROR', err)\n    }\n    // Ok, now try to get the datetime off the EXIF\n    let date = String(Date.now())\n    try {\n      date = String(exif.tags.DateTimeOriginal)\n    }\n    catch (err) {\n      console.log('EXIF', exif)\n      console.error('ERROR GETTING TIMESTAMP', err)\n    }\n    console.log('isNewSeries', { isNewSeries })\n    if (isNewSeries) {\n      let { latitude, longitude } = geo\n      // Stanley park as a fallback if we can't get the geo\n      if (!latitude || !longitude) {\n        latitude = 49.3050394\n        longitude = -123.1398254\n      }\n      try {\n        if (exif.tags.GPSLatitude && isNumeric(exif.tags.GPSLatitude) && exif.tags.GPSLongitude && isNumeric(exif.tags.GPSLongitude)) {\n          latitude = exif.tags.GPSLatitude\n          longitude = exif.tags.GPSLongitude\n        }\n      }\n      catch (e) {\n        console.error('GPS Longitude and Latitude could not be determined')\n      }\n      console.log('LATLONG FOR LIB PICK', { geo, latitude, longitude })\n      setNewSeries({ ...newSeries, latitude, longitude })\n    }\n    const photoInitObj = new PhotoClass(seriesConfig).photo\n    const fullNewPhotoObject = {\n      ...photoInitObj,\n      takenOn: date,\n      rawData: { exif },\n      base64: data\n    }\n    setNewPhoto(fullNewPhotoObject)\n    changeMode(MODES.PHOTOREVIEW)\n    console.log('onLibraryAdd FINISHED', fullNewPhotoObject)\n  }\n\n  const changeMode = (newModeName) => {\n    console.log('NEWPHOTO changeMode', mode, newModeName)\n    _changeMode({\n      current: newModeName,\n      history: [...mode.history, mode.current]\n    })\n  }\n  const lastMode = () => {\n    if (mode.history.length > 0) {\n      const oldHistory = [...mode.history]\n      const oldMode = oldHistory.pop()\n      _changeMode({\n        current: oldMode,\n        history: oldHistory\n      })\n    }\n    else {\n      onCancel()\n    }\n  }\n\n  const onShutter = (data, refId) => {\n    const photoInitObj = new PhotoClass(seriesConfig).photo\n\n    console.log('onShutter Debug GOT DATA', { data })\n    const find = 'base64,'\n    let exif = {}\n    const foundIdx = data.base64.indexOf(find) + find.length\n    const newData = data.base64.slice(foundIdx)\n    const parser = exifParser.create(Buffer.from(newData, 'base64'))\n    console.log('onLibraryAdd Buffered')\n    try {\n      exif = parser.parse()\n      console.log('got EXIF', JSON.stringify(exif))\n    }\n    catch (err) {\n    // got invalid data, handle error\n      console.error('EXIF ERROR', err)\n    }\n\n    if (isNewSeries) {\n      let { latitude, longitude } = geo\n      // Stanley park as a fallback if we can't get the geo\n      if (!latitude || !longitude) {\n        latitude = 49.3050394\n        longitude = -123.1398254\n      }\n      setNewSeries({ ...newSeries, latitude, longitude })\n    }\n    setNewPhoto({\n      ...photoInitObj,\n      rawData: {\n        orient: orientation,\n        geolocate: geo\n      },\n      base64: data.base64\n    })\n    setPhotoRefId(refId)\n    changeMode(MODES.PHOTOREVIEW)\n  }\n\n  let component = null\n  switch (mode.current) {\n    case MODES.CAMERA:\n      component = (\n        <CameraTool\n          photos={photos}\n          onShutter={onShutter}\n          onCancel={onCancel}\n        />\n      )\n      break\n    case MODES.FILEPICKER:\n      component = <LibraryFilePicker onLibraryAdd={onLibraryAdd} />\n      // fileClick() // move this to useEffect to help with click handling\n      break\n    case MODES.PHOTOREVIEW:\n      component = (\n        <PhotoReviewTool\n          defaultRefPhotoId={photoRefId}\n          photos={photos}\n          captured={newPhoto}\n          onConfirm={() => changeMode(MODES.PHOTOINFOEDIT)}\n          onCancel={onCancel}\n          onRetry={lastMode}\n        />\n      )\n      break\n    case MODES.PHOTOINFOEDIT:\n      component = (\n        <NewPhotoInfo\n          photo={newPhoto}\n          newSeries={newSeries}\n          onSave={onCreate}\n          onCancel={onCancel}\n        />\n      )\n      break\n    default:\n      console.log('NEWPHOTO: default state. you should NEVER see this', mode)\n      onCancel()\n  }\n\n  return component\n}\n\nNewPhoto.propTypes = {\n  inputMethod: PropTypes.oneOf(['camera', 'library']),\n  onCreate: PropTypes.func.isRequired,\n  onCancel: PropTypes.func.isRequired,\n  isNewSeries: PropTypes.bool,\n  seriesConfig: PropTypes.object,\n  // This might be a new series so we might have\n  // actions to work on that\n  // This will be provided EITHER photos or onSeriesCreate\n  photos: PropTypes.array\n}\n\nexport default NewPhoto\n","import uuid from 'uuid/v4'\nimport { convertJSDatetoTimestamp } from './datelib'\nimport SeriesConfig from './SeriesConfig'\n\nclass Photo {\n  constructor (seriesConfig, photo) {\n    this.config = new SeriesConfig(seriesConfig)\n    if (photo) this.photo = photo\n    else {\n      this.photo = this.newPhoto()\n    }\n  }\n\n  setMeta = () => {\n    this.meta = JSON.stringify(this.config.getPhotoMeta())\n  }\n\n  newPhoto = () => ({\n    id: '_' + uuid(),\n    takenOn: convertJSDatetoTimestamp(new Date()),\n    meta: JSON.stringify(this.config.getPhotoMeta()),\n    tags: []\n  })\n}\n\nexport default Photo\n","import uuid from 'uuid/v4'\nimport SeriesConfig from './SeriesConfig'\n\nclass Series {\n  constructor (seriesConfig, series) {\n    this.config = new SeriesConfig(seriesConfig)\n    if (series) this.series = series\n    else {\n      this.series = this.newSeries()\n    }\n  }\n\n  setMeta = () => {\n    this.meta = JSON.stringify(this.config.getSeriesMeta())\n  }\n\n  newSeries = () => ({\n    id: '_' + uuid(),\n    meta: JSON.stringify(this.config.getSeriesMeta()),\n    photos: []\n  })\n}\n\nexport default Series\n","import moment from 'moment'\n\n/**\n * Takes a UTC unix timestamp integer or string (milliseconds)\n * and a valid moment format string and returns a formatted\n * date string\n * @param {*} utctimestamp\n * @param {*} format\n */\nexport const formatDate = (utctimestamp, format = 'LLLL') => {\n  return moment(utctimestamp, 'x').format(format)\n}\n\nexport const formatDatAgo = (utctimestamp) => {\n  return moment(utctimestamp, 'x').fromNow()\n}\n\n/**\n * Takes a UTC timestamp and returns a moment object in LOCAL mode\n * @param {*} utctimestamp\n */\nexport const parseDate = (utctimestamp) => {\n  return moment(utctimestamp, 'x')\n}\n\n/**\n * This returns the object in LOCAL mode\n * @param {*} jsDate\n */\nexport const convertJSDatetoTimestamp = (jsDate) => {\n  return moment\n    .utc(jsDate)\n    .format('x')\n}\n\n/**\n *\n * @param {*} utctimestamp\n */\nexport function timestampToHTML5Input (utctimestamp) {\n  // // trim the Z and milliseconds + seconds\n  return moment(utctimestamp, 'x').format('YYYY-MM-DDTkk:mm')\n}\n\n/**\n * Returns an integer timestamp\n * @param {*} isoStr\n */\nexport function HTML5InputToTimestamp (isoStr) {\n  return moment(new Date(isoStr), 'YYYY-MM-DDTkk:mm').format('x')\n}\n","import { useState, useEffect, useRef } from 'react'\n\nexport const useCamera = (onCapture) => {\n  const [cameraError, setCameraError] = useState(false)\n  const [cameraOnline, setCameraOnline] = useState(false)\n  const camRef = useRef()\n\n  const initCamera = () => {\n    if (!camRef.current) {\n      camRef.current = new Webcam(\n        document.getElementById('webcam'),\n        document.createElement('canvas')\n      )\n      camRef.current.setup(\n        window.innerWidth, // width\n        window.innerHeight // height\n      )\n        .then((data) => {\n          setCameraOnline(true)\n        })\n        .catch((e) => {\n          console.error(e)\n          setCameraError(true)\n        })\n    }\n  }\n\n  const captureImage = async () => {\n    if (camRef.current && cameraOnline) {\n      const capturedData = camRef.current.takeBase64Photo({ type: 'jpeg', quality: 1 })\n      onCapture(capturedData)\n    }\n  }\n\n  const delayedOrientationChange = () => {\n    window.setTimeout(initCamera, 1000)\n  }\n\n  useEffect(() => {\n    window.addEventListener('orientationchange', delayedOrientationChange)\n    if (!camRef.current && !cameraError) initCamera()\n    return () => {\n      window.removeEventListener('orientationchange', delayedOrientationChange)\n      if (camRef.current) {\n        camRef.current.destroy()\n        setCameraError(false)\n        setCameraOnline(false)\n      }\n      camRef.current = null\n    }\n  }, [])\n\n  return { cameraError, captureImage, cameraOnline }\n}\n\nclass Webcam {\n  constructor (webcamElement, canvasElement) {\n    this.webcamElement = webcamElement\n    this.canvasElement = canvasElement\n\n    if (window.location.protocol !== 'https:' && window.location.hostname !== 'localhost') {\n      console.warn('getUserMedia() must be run from a secure origin: https or localhost.\\nChanging protocol to https.')\n    }\n\n    if (!navigator.mediaDevices && !navigator.getUserMedia) {\n      console.warn(`Your browser doesn't support navigator.mediaDevices.getUserMedia and navigator.getUserMedia.`)\n    }\n  }\n\n  adjustVideoSize (width, height) {\n    const aspectRatio = width / height\n    if (width >= height) {\n      this.webcamElement.width = aspectRatio * this.webcamElement.height\n    }\n    else if (width < height) {\n      this.webcamElement.height = this.webcamElement.width / aspectRatio\n    }\n  }\n\n  async destroy () {\n    try {\n      this.webcamElement.srcObject.getTracks()[0].stop()\n      this.webcamElement = null\n      this.canvasElement = null\n    }\n    catch (e) {\n      console.error(e)\n    }\n  }\n\n  async setup (width, height) {\n    return new Promise((resolve, reject) => {\n      if (navigator.mediaDevices.getUserMedia !== undefined) {\n        navigator.mediaDevices.getUserMedia({ audio: false, video: { facingMode: 'environment', width, height } })\n          .then((mediaStream) => {\n            if ('srcObject' in this.webcamElement) {\n              this.webcamElement.srcObject = mediaStream\n            }\n            else {\n              // For older browsers withouth the srcObject.\n              this.webcamElement.src = window.URL.createObjectURL(mediaStream)\n            }\n            this.webcamElement.onloadedmetadata = (e) => {\n              this.webcamElement.play()\n            }\n            this.webcamElement.onplaying = (e) => {\n              resolve()\n            }\n          })\n          .catch(err => reject(err))\n      }\n      else {\n        reject(new Error('Error accessing camera'))\n      }\n    })\n  }\n\n  _drawImage () {\n    const imageWidth = this.webcamElement.videoWidth\n    const imageHeight = this.webcamElement.videoHeight\n\n    const context = this.canvasElement.getContext('2d')\n    this.canvasElement.width = imageWidth\n    this.canvasElement.height = imageHeight\n\n    context.drawImage(this.webcamElement, 0, 0, imageWidth, imageHeight)\n\n    return { imageHeight, imageWidth }\n  }\n\n  takeBlobPhoto () {\n    const { imageWidth, imageHeight } = this._drawImage()\n    return new Promise((resolve, reject) => {\n      this.canvasElement.toBlob((blob) => {\n        resolve({ blob, imageHeight, imageWidth })\n      })\n    })\n  }\n\n  takeBase64Photo ({ type, quality } = { type: 'jpeg', quality: 1 }) {\n    const { imageHeight, imageWidth } = this._drawImage()\n    const base64 = this.canvasElement.toDataURL('image/' + type, quality)\n    return { base64, imageHeight, imageWidth }\n  }\n}\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\n\nimport Fab from '@material-ui/core/Fab'\nimport SwipeableDrawer from '@material-ui/core/SwipeableDrawer'\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport Typography from '@material-ui/core/Typography'\n\nimport CameraIcon from '@material-ui/icons/Camera'\nimport CancelIcon from '@material-ui/icons/Cancel'\nimport PhotoLibraryIcon from '@material-ui/icons/PhotoLibrary'\n\nimport PhotoFadeSlider from './controls/PhotoFadeSlider'\nimport PhotoGrid from './subViews/PhotoGrid'\nimport Photo from './subViews/Photo'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport style from './CameraTool.style'\nimport { useCamera } from '../../../lib/useCamera'\n\nconst useStyles = makeStyles(style)\n\n// https://googlechrome.github.io/samples/image-capture/grab-frame-take-photo.html\nconst CameraTool = ({ photos, onCancel, onShutter, defaultRefPhotoId }) => {\n  const classes = useStyles()\n  const [slider, setSlider] = useState(50)\n  const newRefPhoto = defaultRefPhotoId\n    ? photos.find(p => p.id === defaultRefPhotoId)\n    : photos && photos.length > 0 ? photos[0] : null\n\n  const [refPhoto, setRefPhoto] = useState(newRefPhoto)\n  const [drawerOpen, setDrawerOpen] = useState(false)\n  const { cameraError, captureImage, cameraOnline } = useCamera((data) => onShutter(data, refPhoto ? refPhoto.id : null))\n\n  const handleTileClick = (id) => {\n    setRefPhoto(photos.find(p => p.id === id))\n    setDrawerOpen(false)\n  }\n\n  return (\n    <div className={classes.root}>\n      <CssBaseline />\n      { !cameraError && Boolean(refPhoto) && (\n        <PhotoFadeSlider defaultValue={slider} onChange={setSlider} />\n      )}\n\n      { cameraError && (\n        <div className={classes.cameraErrorText}>\n          <Typography variant='subtitle1' color='inherit'>No Camera Access</Typography>\n          <Typography variant='body2' color='inherit'>Please enabled access in your settings.</Typography>\n        </div>\n      )}\n\n      <div className={classes.captured}>\n        { Boolean(refPhoto) && (\n          <div className={classes.reference} >\n            <Photo\n              className={classes.referenceContainer}\n              opacity={(100 - slider) / 100}\n              photo={refPhoto}\n            />\n          </div>\n        )}\n        { !cameraError && (\n          <video\n            autoPlay\n            playsInline\n            muted\n            id='webcam'\n            width={window.innerWidth}\n            height={window.innerHeight}\n            className={classes.video}\n          />\n        )}\n      </div>\n\n      <Fab\n        color='primary'\n        aria-label='Take Photo'\n        classes={{\n          disabled: classes.disabledFab\n        }}\n        disabled={cameraError || !cameraOnline}\n        className={classNames(classes.cameraFab, classes.buttonFab)}\n        onClick={captureImage}\n      >\n        <CameraIcon className={classes.cameraIcon} />\n      </Fab>\n\n      <Fab\n        color='secondary'\n        aria-label='cancel'\n        onClick={onCancel}\n        classes={{\n          disabled: classes.disabledFab\n        }}\n        className={classNames(classes.cancelFab, classes.buttonFab)}\n      >\n        <CancelIcon className={classes.cancelIcon} />\n      </Fab>\n\n      <Fab\n        aria-label='cancel'\n        className={classNames(classes.libraryFab, classes.buttonFab)}\n        classes={{\n          disabled: classes.disabledFab\n        }}\n        disabled={!photos || photos.length === 0}\n        onClick={() => setDrawerOpen(true)}\n      >\n        <PhotoLibraryIcon className={classes.libraryIcon} />\n      </Fab>\n\n      <SwipeableDrawer\n        anchor='left'\n        open={drawerOpen}\n        classes={{\n          paperAnchorLeft: classes.swipeDrawer\n        }}\n        onClose={() => setDrawerOpen(false)}\n        onOpen={() => setDrawerOpen(true)}\n      >\n        <div\n          tabIndex={0}\n          className={classes.swipeDrawerContainer}\n          role='button'\n          onClick={() => setDrawerOpen(false)}\n          onKeyDown={() => setDrawerOpen(false)}\n        >\n          <PhotoGrid\n            multiSelect={false}\n            columns={1}\n            photos={photos}\n            onTileClick={handleTileClick}\n          />\n        </div>\n      </SwipeableDrawer>\n\n    </div>\n  )\n}\n\nCameraTool.propTypes = {\n  photos: PropTypes.array,\n  defaultRefPhotoId: PropTypes.string, // id of the reference photo\n  onCancel: PropTypes.func.isRequired,\n  onShutter: PropTypes.func.isRequired\n}\n\nexport default CameraTool\n","export default theme => ({\n  root: {\n    background: 'black',\n    // border: '5px solid red',\n    height: '100%',\n    width: '100%'\n  },\n  cameraErrorText: {\n    color: 'white',\n    position: 'absolute',\n    top: '50%',\n    left: '50%',\n    width: '90%',\n    transform: 'translateY(-50%) translateX(-50%)',\n    textAlign: 'center'\n  },\n  disabledFab: {\n    color: '#AAAAA!important',\n    background: '#DDDDDD!important',\n    opacity: 0.2\n  },\n  cameraFab: {\n    position: 'absolute',\n    zIndex: 10,\n    '@media (orientation: landscape)': {\n      right: '20px',\n      top: '50%',\n      transform: 'translateY(-50%)',\n      height: '25vh',\n      width: '25vh'\n    },\n    '@media (orientation: portrait)': {\n      bottom: '20px',\n      left: '50%',\n      transform: 'translateX(-50%)',\n      height: '25vw',\n      width: '25vw'\n    }\n  },\n  cameraIcon: {\n    height: '100%',\n    width: '100%'\n  },\n  cancelFab: {\n    position: 'absolute',\n    zIndex: 10,\n    '@media (orientation: landscape)': {\n      right: '15px',\n      top: '15px',\n      height: '15vh',\n      width: '15vh'\n    },\n    '@media (orientation: portrait)': {\n      right: '15px',\n      bottom: '15px',\n      height: '15vw',\n      width: '15vw'\n    }\n  },\n  cancelIcon: {\n    height: '100%',\n    width: '100%'\n  },\n\n  swipeDrawer: {\n    width: '50%'\n  },\n\n  libraryFab: {\n    position: 'absolute',\n    zIndex: 10,\n    '@media (orientation: landscape)': {\n      left: '15px',\n      top: '15px',\n      height: '15vh',\n      width: '15vh'\n    },\n    '@media (orientation: portrait)': {\n      left: '15px',\n      top: '15px',\n      height: '15vw',\n      width: '15vw'\n    }\n  },\n\n  myLocationFab: {\n    position: 'absolute',\n    zIndex: 10,\n    '@media (orientation: landscape)': {\n      right: '15px',\n      bottom: '15px',\n      height: '15vh',\n      width: '15vh'\n    },\n    '@media (orientation: portrait)': {\n      left: '15px',\n      bottom: '15px',\n      height: '15vw',\n      width: '15vw'\n    }\n  },\n  myLocationIcon: {\n    height: '80%',\n    width: '80%'\n  },\n  capturedContainer: {\n    position: 'absolute',\n    zIndex: 1,\n    height: '100%',\n    width: '100%'\n  },\n  referenceContainer: {\n    position: 'absolute',\n    zIndex: 2,\n    height: '100%',\n    width: '100%'\n  },\n  captured: {\n\n  },\n  reference: {\n\n  },\n  video: {\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    height: '100vh',\n    width: '100vw',\n    zIndex: 1\n    // '@media (orientation: portrait)': {\n    //   transform: 'rotate(90)'\n    // }\n  }\n  // overlayImage: {\n  //   position: 'absolute',\n  //   top: 0,\n  //   left: 0,\n  //   zIndex: 3,\n  //   height: '100vh',\n  //   width: '100vw',\n  //   textAlign: 'center'\n  // },\n  // overlayImageInner: {\n  //   '@media (orientation: landscape)': {\n  //     height: '100%',\n  //     width: 'auto'\n  //   },\n  //   '@media (orientation: portrait)': {\n  //     width: '100%',\n  //     height: 'auto'\n  //   }\n  // },\n  // newImage: {\n  //   position: 'absolute',\n  //   top: 0,\n  //   left: 0,\n  //   zIndex: 2\n  // }\n})\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport Typography from '@material-ui/core/Typography'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport DialogActions from '@material-ui/core/DialogActions'\nimport Button from '@material-ui/core/Button'\n\nimport SeriesEditInner from './subViews/SeriesEditInner'\n\n// import { SeriesContext } from '../contexts'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport style from './NewPhotoInfo.style'\nimport PhotoInfoInner from './subViews/PhotoInfoInner'\n\nconst useStyles = makeStyles(style)\n\nconst NewPhotoInfo = ({ photo, newSeries, onCancel, onSave }) => {\n  const classes = useStyles()\n  // const { series } = useContext(SeriesContext)\n  const [seriesDelta, setSeriesDelta] = useState(newSeries || {})\n  const [photoDelta, setPhotoDelta] = useState(photo)\n\n  // console.log('NewPhotoInfo', {\n  //   seriesDelta,\n  //   photoDelta,\n  //   photo,\n  //   series,\n  //   newSeries,\n  //   onCancel,\n  //   onSave\n  // })\n  // console.log('NewPhotoInfo', { series, seriesDelta, photoDelta })\n\n  return (\n    <div className={classes.root}>\n      <CssBaseline /> {/* You only need this in a root element. Don't put it anywhere else in the dom */}\n      <Dialog\n        fullScreen\n        fullWidth\n        scroll='paper'\n        disableBackdropClick\n        disableEscapeKeyDown\n        onClose={onCancel}\n        aria-labelledby='customized-dialog-title'\n        open\n      >\n        <DialogTitle disableTypography className={classes.dlgTitleContainer}>\n          <Typography variant='h5' className={classes.dlgTitle}>\n          New Photo Properties\n          </Typography>\n        </DialogTitle>\n        <DialogContent>\n\n          {!!newSeries && (\n            <SeriesEditInner\n              series={newSeries}\n              delta={seriesDelta}\n              onChange={setSeriesDelta}\n            />\n          )}\n\n          <PhotoInfoInner\n            photo={photo}\n            canEdit\n            delta={photoDelta}\n            onChange={(newAttr) => setPhotoDelta({ ...photoDelta, ...newAttr })}\n          />\n\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={onCancel} color='primary'>\n            Cancel\n          </Button>\n          <Button onClick={() => onSave({ series: seriesDelta, photo: photoDelta })} color='primary'>\n            Next\n          </Button>\n        </DialogActions>\n      </Dialog>\n    </div>\n  )\n}\n\nNewPhotoInfo.propTypes = {\n  photo: PropTypes.object.isRequired,\n  newSeries: PropTypes.object,\n  // Standard functions\n  onCancel: PropTypes.func.isRequired,\n  onSave: PropTypes.func\n}\n\nexport default NewPhotoInfo\n","export default theme => ({\n  root: {\n\n  },\n  formLabel: {\n    color: theme.palette.text.secondary\n  },\n  mapFormLabel: {\n    marginTop: theme.spacing(2),\n    marginBottom: theme.spacing(1),\n    color: theme.palette.text.secondary\n  },\n  map: {\n    marginBottom: theme.spacing(2)\n  },\n  mapWrapper: {\n    marginBottom: theme.spacing(2)\n  },\n  field: {\n    marginBottom: theme.spacing(2)\n  }\n})\n","import React, { useState, useContext } from 'react'\nimport PropTypes from 'prop-types'\n\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport Snackbar from '@material-ui/core/Snackbar'\nimport Button from '@material-ui/core/Button'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport Photo from './subViews/Photo'\nimport PhotoFadeSlider from './controls/PhotoFadeSlider'\nimport style from './PhotoReviewTool.style'\n\nimport { SeriesContext } from '../contexts'\nconst useStyles = makeStyles(style)\n\nconst PhotoReviewTool = ({\n  captured, defaultRefPhotoId,\n  onConfirm, onCancel, onRetry\n}) => {\n  const { series } = useContext(SeriesContext)\n  const photos = series && series.photos ? series.photos : null\n  const classes = useStyles()\n\n  const newRefPhoto = defaultRefPhotoId\n    ? photos.find(p => p.id === defaultRefPhotoId)\n    : photos && photos.length > 0 ? photos[0] : null\n\n  const [refPhoto, setRefPhoto] = useState(newRefPhoto)\n  const [slider, setSlider] = useState(100)\n\n  if (!captured) return 'Loading...'\n\n  return (\n    <div className={classes.root}>\n      <CssBaseline />\n      { Boolean(refPhoto) && (\n        <PhotoFadeSlider defaultValue={100} onChange={setSlider} />\n      )}\n\n      <div className={classes.captured}>\n        <Photo\n          opacity={slider / 100}\n          className={classes.capturedContainer}\n          photo={captured}\n        />\n      </div>\n      { Boolean(refPhoto) && (\n        <div className={classes.reference} >\n          <Photo\n            className={classes.referenceContainer}\n            photo={refPhoto}\n          />\n        </div>\n      )}\n      <Snackbar\n        open\n        autoHideDuration={null}\n        ContentProps={{\n          'aria-describedby': 'snackbar-fab-message-id',\n          className: classes.snackbarContent\n        }}\n        message={<span id='snackbar-fab-message-id'>Keep this photo?</span>}\n        action={<div>\n          <Button color='inherit' size='small' onClick={onCancel}>\n                Cancel\n          </Button>\n          {Boolean(onRetry) && (\n            <Button color='inherit' size='small' onClick={onRetry}>\n          Retry\n            </Button>\n          )}\n\n          <Button color='inherit' size='small' onClick={onConfirm}>\n                Keep\n          </Button>\n        </div>\n        }\n        className={classes.snackbar}\n      />\n    </div>\n  )\n}\n\nPhotoReviewTool.propTypes = {\n  defaultRefPhotoId: PropTypes.string,\n  captured: PropTypes.object,\n  // Now some functions\n  onConfirm: PropTypes.func.isRequired,\n  onCancel: PropTypes.func.isRequired,\n  onRetry: PropTypes.func // only for camera\n\n}\n\nexport default PhotoReviewTool\n","export default theme => ({\n  root: {\n    background: 'rgb(150,150, 150)',\n    // border: '5px solid red',\n    height: '100%',\n    width: '100%'\n  },\n  capturedContainer: {\n    position: 'absolute',\n    zIndex: 1,\n    height: '100%',\n    width: '100%'\n  },\n  referenceContainer: {\n    position: 'absolute',\n    zIndex: 0,\n    height: '100%',\n    width: '100%'\n  },\n  captured: {\n\n  },\n  reference: {\n\n  },\n  referenceTextContainer: {\n    width: '100%',\n    display: 'flex',\n    color: 'white',\n    background: 'rgba(0,0,0,0.5)',\n    padding: theme.spacing(3),\n    position: 'absolute',\n    zIndex: 4,\n    top: 0\n  },\n  newText: {\n    flexGrow: 1,\n    color: 'white',\n    textShadow: '1 1 1 black',\n    textAlign: 'right'\n  },\n  refText: {\n    flexGrow: 1,\n    color: 'white',\n    textShadow: '1 1 1 black'\n  }\n})\n","import React, { useEffect, useRef } from 'react'\n\nconst useFileInput = (onChange = () => {}) => {\n  const inputRef = useRef()\n  const clickRef = useRef()\n\n  const element = (\n    <input style={{ display: 'none' }} ref={inputRef} type='file' />\n  )\n\n  const forceClick = () => {\n    if (inputRef.current) inputRef.current.click()\n  }\n\n  useEffect(() => {\n    const handleChange = evt => {\n      const [file] = [...inputRef.current.files]\n      if (file) {\n        const reader = new FileReader()\n        reader.onload = e => {\n          onChange(e.target.result)\n        }\n        reader.readAsDataURL(file)\n      }\n      inputRef.current.value = null\n    }\n\n    if (inputRef.current) {\n      inputRef.current.addEventListener('change', handleChange)\n      if (!clickRef.current) {\n        inputRef.current.click()\n        clickRef.current = true\n      }\n    }\n    return () => {\n      if (inputRef.current) {\n        inputRef.current.removeEventListener('change', handleChange)\n      }\n    }\n  }, [inputRef.current])\n\n  return { fileClickEl: element, forceClick }\n}\n\nexport default useFileInput\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport PhotoLibraryIcon from '@material-ui/icons/PhotoLibrary'\nimport { makeStyles } from '@material-ui/core/styles'\nimport useFileInput from '../../../../lib/useFileInput'\n\nconst color = '#AAAAAA'\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    height: '100%',\n    display: 'flex',\n    flexDirection: 'column',\n    textAlign: 'center',\n    color,\n    border: `20px solid ${color}`\n  },\n  icon: {\n    margin: 'auto',\n    flex: '1 1 50%',\n    height: '70%',\n    width: '70%'\n  },\n  text: {\n    flex: '1 1 50%'\n  }\n}))\n\nconst LibraryFilePicker = ({ onLibraryAdd }) => {\n  const classes = useStyles()\n  const { fileClickEl, forceClick } = useFileInput(onLibraryAdd)\n  return (\n    <div className={classes.root} onClick={forceClick}>\n      {fileClickEl}\n      <PhotoLibraryIcon className={classes.icon}color='inherit' />\n      <Typography variant='h2' className={classes.text} color='inherit'>\n        Import from Library\n      </Typography>\n    </div>\n  )\n}\n\nLibraryFilePicker.propTypes = {\n  onLibraryAdd: PropTypes.func.isRequired\n}\n\nexport default LibraryFilePicker\n","import React from 'react'\n\nexport const SeriesContext = React.createContext({})\n","import numeral from 'numeral'\n\nexport const isNumeric = num => {\n  try {\n    return !isNaN(parseFloat(num)) && isFinite(num)\n  }\n  catch (e) {\n    return false\n  }\n}\n/**\n * This is a correction to strip === signs off of base64-encoded strings\n * @param {} x\n */\nexport const urlizeb64 = x => x.replace('+', '-').replace('/', '_').replace(/=+$/, '')\n\n/**\n * We need numbers displayed consistently. This is how we do it.\n * @param {*} num\n * @param {*} precision\n */\nexport function formatNum (num, precision) {\n  try {\n    const precstr = precision > 0 ? '.' + Array(precision + 1).join('0') : ''\n    const newprec = isNumeric(num) ? numeral(num).format(`0,0${precstr}`) : num\n    return newprec.replace(/(\\.(0{0,1}[1-9]*))0+$/, '$1')\n  }\n  catch (e) {\n    return num\n  }\n}\n\n/**\n * Magic function to clear mouse selection. Use sparingly.\n */\nexport function clearSelection () {\n  if (document.selection && document.selection.empty) {\n    document.selection.empty()\n  }\n  else if (window.getSelection) {\n    var sel = window.getSelection()\n    sel.removeAllRanges()\n  }\n}\n\nexport function isObjectWithKeys (obj) {\n  return ((typeof obj === 'object') && (obj !== null) && Object.keys(obj).length > 0)\n}\n\n/**\n * Dom node parsing is weird because it may return an array or a single element with no way to know\n * which is which.\n */\nexport function makeDomArray (domnode) {\n  if (!domnode) return []\n  const keys = Object.keys(domnode)\n  // This is not the pattern we expect\n  if (keys.length > 1 || keys.length === 0) throw Error('Expected nester domnode structure.')\n  if (!domnode) return []\n  if (!domnode[keys[0]]) return []\n  return Array.isArray(domnode[keys[0]]) ? domnode[keys[0]] : [domnode[keys[0]]]\n}\n\nexport function capitalizeFirstLetter (string) {\n  return string.charAt(0).toUpperCase() + string.slice(1)\n}\n\n/**\n * Good for comparing two purely numeric arrays\n * @param {*} arr1\n * @param {*} arr2\n */\nexport function numericArrayCompare (arr1, arr2) {\n  if (!Array.isArray(arr1) || !Array.isArray(arr2)) return false\n  if (arr1.length !== arr2.length) return false\n\n  return !arr1.some((el, idx) => el !== arr2[idx])\n}\n\n/**\n * We need a function to add the padding '=' signs back before we decode\n * @param {*} hash\n */\nexport function decodeUnbufferedBase64 (hash) {\n  const missingPadding = hash.length % 4\n  if (missingPadding !== 0) {\n    const newhash = hash + Array(4 - missingPadding).join('=')\n    return Buffer.from(newhash, 'base64').toString()\n  }\n  else {\n    return Buffer.from(hash, 'base64').toString()\n  }\n}\n\nexport function encodeUnbufferedBase64 (str) {\n  return urlizeb64(Buffer.from(str).toString('base64'))\n}\n\n/**\n *\n * @param {*} o\n */\nexport function isObject (o) {\n  return o instanceof Object && o.constructor === Object\n}\n\n/**\n * XML to JSON is a non-trivial exercise. We can make certain assumptions\n * about our incoming file\n * @param {*} data\n */\nexport function arrToObj (data) {\n  for (const key in data) {\n    // Make sure we're looping over legitimate objects\n    if (data.hasOwnProperty(key)) {\n      const keyDat = data[key]\n      if (keyDat._) {\n        keyDat.val = keyDat._\n        delete keyDat._\n      }\n      if (keyDat.$) {\n        keyDat.attr = keyDat.$\n        delete keyDat.$\n      }\n      if (typeof keyDat === 'object') {\n        data[key] = arrToObj(keyDat)\n        // There's a pattern we want to collapse\n        // It puts every single individual value into its own array. Not cool\n        if (Array.isArray(keyDat) && keyDat.length === 1 && typeof keyDat[0] === 'string') {\n          if (isNumeric(keyDat[0])) data[key] = Number(keyDat[0])\n          else data[key] = keyDat[0].replace(/\\\\/g, '/')\n        }\n        else if (Array.isArray(keyDat) && keyDat.length === 1 &&\n        // The second case is when it puts objects into its own array\n          isObject(keyDat[0]) &&\n          Object.keys(keyDat[0]).length === 1) {\n          // xml2js does a weird thing where attributes get put into the following structure\n          // [{ \"_\": \"475945.992587164,5125837.37170763\", \"$\": { \"units\": \"m\"  } }]\n          data[key] = keyDat[0][Object.keys(keyDat[0])[0]]\n        }\n        // Dynamo DB does not like empty strings\n        if (typeof data[key] && data[key].length === 0) {\n          delete data[key]\n        }\n        if (typeof data[key] === 'string' && isNumeric(data[key])) data[key] = Number(data[key])\n      }\n    }\n  }\n  return data\n}\n\n/**\n * Returns a random number between min (inclusive) and max (exclusive)\n */\nexport function getRandomArbitraryInt (min, max) {\n  return parseInt(Math.random() * (max - min) + min, 10)\n}\n\n/**\n * Returns a function, that, as long as it continues to be invoked, will not\n * be triggered. The function will be called after it stops being called for\n * N milliseconds. If `immediate` is passed, trigger the function on the\n * leading edge, instead of the trailing.\n * @param {*} func\n * @param {*} wait\n * @param {*} immediate\n */\nexport function debounce (func, wait, immediate) {\n  let timeout = null\n  return (...innerArgs) => {\n    const context = this\n    // const args = arguments\n    const callNow = immediate && !timeout\n    clearTimeout(timeout)\n\n    timeout = setTimeout(() => {\n      timeout = null\n      if (!immediate) {\n        // console.log('debounce', innerArgs)\n        func.apply(context, innerArgs)\n      }\n    }, wait)\n    if (callNow) {\n      // console.log('debounce', innerArgs)\n      func.apply(context, innerArgs)\n    }\n  }\n};\n\n// var myEfficientFn = debounce(function() {\n// // All the taxing stuff you do\n// }, 250);\n\n// window.addEventListener('resize', myEfficientFn);\n","// https://medium.com/@shalkam/create-react-app-i18n-the-easy-way-b05536c594cb\nimport React, { useContext } from 'react'\nimport PropTypes from 'prop-types'\nimport { IntlProvider, addLocaleData } from 'react-intl'\nimport frLocaleData from 'react-intl/locale-data/fr'\n\naddLocaleData(frLocaleData)\n\nexport const IntlContext = React.createContext({})\n\n// the format message hook\nexport const useIntl = () => {\n  const intl = useContext(IntlContext)\n  return intl.formatMessage\n}\n\nexport const IntlWrapper = ({ children }) => (\n  <IntlProvider locale='en'>\n    {children}\n  </IntlProvider>\n)\nIntlWrapper.propTypes = {\n  children: PropTypes.any\n}\n","import gql from 'graphql-tag'\n\nexport const allSeries = gql`\n  query allSeries($limit: Int, $nextToken: String) {\n    allSeries(limit: $limit, nextToken: $nextToken) {\n      seriesSummaries {\n        id\n        name\n        access\n        createdUser {\n          id\n          gravatar\n          gravatarProfile\n          username        \n        }\n        updatedOn\n        createdOn\n        photoCount\n        coords\n        direction\n        watchers\n        featured {\n          id\n          takenOn\n          paths {\n            base\n            thumb\n            medium\n            large\n          }\n        }\n        latest {\n          id\n          takenOn\n          paths {\n            base\n            thumb\n            medium\n            large\n          }\n        }\n      }\n      nextToken\n    }\n  }\n`\n\nexport const pollQuery = gql`\n  query pollQuery($lastCheck: String!, $limit: Int, $nextToken: String) {\n    changedSeries(lastCheck: $lastCheck, limit: $limit, nextToken: $nextToken){\n      seriesSummaries {\n        id\n        name\n        access\n        createdUser {\n          id\n          gravatar\n          gravatarProfile\n          username        \n        }\n        updatedOn\n        createdOn\n        photoCount\n        coords\n        direction\n        watchers\n        featured {\n          id\n          takenOn\n          paths {\n            base\n            thumb\n            medium\n            large\n          }\n        }\n        latest {\n          id\n          takenOn\n          paths {\n            base\n            thumb\n            medium\n            large\n          }\n        }\n      }\n    }\n  }\n`\n\nexport const userSeries = gql`\n  query userSeries($createdBy: ID) {\n    userSeries(createdBy: $createdBy ) {\n      seriesSummaries {\n        id\n        name\n        access\n        \n        createdUser {\n          id\n          gravatar\n          gravatarProfile\n          username        \n        }\n        updatedOn\n        createdOn\n        \n        photoCount\n        coords\n        direction\n        watchers\n        \n        featured {\n          id\n          takenOn\n          paths {\n            base\n            thumb\n            medium\n            large\n          }\n        }\n        latest {\n          id\n          takenOn\n          paths {\n            base\n            thumb\n            medium\n            large\n          }\n        }\n      }\n      nextToken\n    }\n  }\n`\n\nexport const seriesFromList = gql`\n  query seriesFromList($seriesList: [ID]) {\n    arraySeries(seriesIds: $seriesList) {\n      id\n      name\n      access\n      createdUser {\n        id\n        gravatar\n        gravatarProfile\n        username        \n      }\n      updatedOn\n      createdOn\n      photoCount\n      coords\n      direction\n      watchers\n      featured {\n        id\n        takenOn\n        paths {\n          base\n          thumb\n          medium\n          large\n        }\n      }\n      latest {\n          id\n          takenOn\n          paths {\n            base\n            thumb\n            medium\n            large\n          }\n        }\n    }\n  }\n`\n\nexport const seriesWithTag = gql`\n  query seriesWithTag($tag: String!, $limit: Int, $nextToken: String) {\n    tagSeries(tag: $tag, limit: $limit, nextToken: $nextToken) {\n      seriesSummaries{\n        id\n        name\n        access\n        createdUser {\n          id\n          gravatar\n          gravatarProfile\n          username        \n        }\n        updatedOn\n        createdOn\n        photoCount\n        coords\n        direction\n        watchers\n        featured {\n          id\n          takenOn\n          paths {\n            base\n            thumb\n            medium\n            large\n          }\n        }\n        latest {\n          id\n          takenOn\n          paths {\n            base\n            thumb\n            medium\n            large\n          }\n        }\n      }\n      nextToken\n    }\n  }\n`\n\nexport const tagSearch = gql`\n  query tagSearch($limit: Int, $tag: String) {\n    tags(limit: $limit, tag: $tag ){\n      name\n      count\n    }\n  }\n`\n\nexport const geoSeries = gql`\n  query seriesInGeoBounds($bounds: [Float], $limit: Int, $nextToken: String) {\n    seriesInGeoBounds(bounds: $bounds, limit: $limit, nextToken: $nextToken) {\n      seriesSummaries {\n        id\n        name\n        access\n        createdUser {\n          id\n          gravatar\n          gravatarProfile\n          username        \n        }\n        updatedOn\n        photoCount\n        coords\n        direction\n        watchers\n        featured {\n          id\n          takenOn\n          paths {\n            base\n            thumb\n            medium\n            large\n          }\n        }\n        latest {\n          id\n          takenOn\n          paths {\n            base\n            thumb\n            medium\n            large\n          }\n        }\n      }\n    }\n  }\n`\n\nexport const getUser = gql`\n  query getUser($userId: ID) {\n    user(id: $userId){\n      id\n      username\n      gravatar\n      gravatarProfile\n      createdOn\n      updatedOn\n      createdOn\n      watching\n    }\n  }\n`\n\nexport const geocode = gql`\n  query geocode($search: String!) {\n    geocoder(search: $search) {\n      relevance\n      text\n      placeName\n      bbox\n      center\n      # geoType\n      # context\n    }\n  }\n`\nexport const getMyFeed = gql`\n  query myFeed($start: String, $end: String, $limit: Int) {\n    myFeed(start: $start, end: $end, limit: $limit) {\n      feed {\n        series {\n          id\n          name\n          createdUser {\n            id\n            gravatar\n            username\n          }\n          updatedOn\n          createdOn\n          access\n          coords\n          watchers\n          photoCount\n        }\n        photo {\n          id\n          updatedOn\n          createdOn\n          createdUser {\n            id\n            gravatar\n            gravatarProfile\n            username\n          }\n          paths {\n            base\n            thumb\n            medium\n          }\n        }\n        relation\n      }\n      window\n    }\n  }\n`\n\nexport const userSearch = gql`\n  query userSearch($searchStr: String!, $limit: Int) {\n    userSearch(searchStr: $searchStr, limit: $limit ){\n      id\n      username\n      gravatar\n      gravatarProfile\n      createdOn\n      updatedOn\n      createdOn\n    }\n  }\n`\n\nexport const getWholeSeries = gql`\nquery getWholeSeries($id: ID!) {\n  series(id: $id) {\n    id\n    name\n    note\n    meta\n    watchers\n    createdOn\n    createdUser {\n      id\n      gravatar\n      gravatarProfile\n      username\n    }\n    updatedOn\n    createdOn\n    coords\n    direction\n    photoCount\n    featured {\n      id\n      takenOn\n      paths {\n        base\n        large\n        thumb\n        medium\n      }\n    }\n    latest {\n      id\n      paths {\n        base\n        large\n        thumb\n        medium\n      }\n      takenOn\n    }\n    photos {\n      id\n      meta\n      createdOn\n      takenOn\n      updatedOn\n      createdOn\n      createdUser {\n        id\n        gravatar\n        gravatarProfile\n        username\n      }\n      tags {\n        label\n        typeId\n        coords {\n          x\n          y\n        }\n      }\n      paths {\n        base\n        large\n        thumb\n        medium\n      }\n    }\n  }\n}\n`\n","import { createMuiTheme, createPalette } from '@material-ui/core/styles'\nimport { fade } from '@material-ui/core/styles/colorManipulator'\n// import {\n//   cyan, teal, indigo, grey, blueGrey, pink, yellow, deepOrange, red\n// } from '@material-ui/core/colors'\n\n// We need this so that it doesn't freak out abotu old variants\nconst typography = {\n  useNextVariants: true\n}\n\nconst colors = {\n  jet: '#3a3335', // JET\n  rose: '#d81e5b', // DOGWOOD ROSE\n  redorange: '#f0544f', // RED-ORANGE\n  papayawhip: '#FDF0D5', // PAPAYA WHIP\n  cblue: '#C6D8D3' // COLUMBIA-BLUE\n}\n\nconst home = {\n  palette: {\n    primary: {\n      main: colors.redorange\n    },\n    secondary: {\n      main: colors.rose\n    },\n    text: {\n      primary: colors.jet,\n      secondary: fade(colors.jet, 0.7)\n    }\n  },\n  typography\n}\n\nconst topbar = {\n  palette: {\n    primary: {\n      main: colors.redorange\n    },\n    secondary: {\n      main: colors.rose\n    }\n  },\n  typography\n}\n\nconst bottombar = {\n  palette: {\n    primary: {\n      main: colors.jet\n    },\n    secondary: {\n      main: colors.redorange\n    }\n  },\n  typography\n}\n\nconst login = {\n  palette: {\n    primary: {\n      main: colors.redorange\n    },\n    secondary: {\n      main: colors.rose\n    },\n    text: {\n      primary: colors.papayawhip,\n      secondary: fade(colors.papayawhip, 0.7)\n    },\n    background: {\n      default: colors.jet,\n      paper: colors.jet\n    }\n  },\n  typography\n}\n\nexport default {\n  home: createMuiTheme(home),\n  login: createMuiTheme(login),\n  topbar: createMuiTheme(topbar),\n  bottombar: createMuiTheme(bottombar)\n}\n","import React from 'react'\n\nexport const AppContext = React.createContext({})\n","import { useRef, useEffect } from 'react'\n\nconst useAuthCommon = () => {\n  const containerRef = useRef()\n  const handleKeyPress = (event) => {\n    if (event.key === 'Enter') {\n      if (containerRef.current) {\n        try {\n          const found = containerRef.current.getElementsByClassName('enterAction')\n          if (found && found[0]) found[0].click()\n        }\n        catch (e) {\n          console.error('useAuthCommon::handleKeyPress', e)\n        }\n      }\n    }\n  }\n  useEffect(() => {\n    if (containerRef.current) {\n      try {\n        document.addEventListener('keypress', handleKeyPress, false)\n      }\n      catch (e) {\n        console.error('useAuthCommon::useEffect', e)\n      }\n      return () => document.removeEventListener('keypress', handleKeyPress, false)\n    }\n  }, [])\n\n  return containerRef\n}\n\nexport default useAuthCommon\n","import React from 'react'\nimport createSvgIcon from '@material-ui/icons/utils/createSvgIcon'\n\nexport default createSvgIcon(\n  <React.Fragment>\n    <path d='M13.685,2.797c-0.44,1.273 0.852,3.525 -1.082,4.966c-1.247,0.93 -2.133,2.247 -2.743,4.167c-3.78,-7.611 2.788,-8.409 3.682,-10.699c0.64,1.255 5.18,2.608 2.89,4.873c1.28,-2.034 -2.359,-1.862 -2.747,-3.307Z' />\n    <path d='M4.921,5.953c0.883,1.017 3.479,1.024 3.76,3.42c0.181,1.545 0.879,2.971 2.238,4.459c-8.482,-0.532 -5.889,-6.619 -7.425,-8.538c1.407,0.073 4.848,-3.183 5.665,-0.066c-1.121,-2.126 -2.792,1.111 -4.238,0.725Z' />\n    <path d='M3.236,15.092c1.323,-0.256 2.627,-2.5 4.842,-1.546c1.428,0.615 3.013,0.724 4.98,0.292c-4.701,7.079 -8.676,1.79 -11.106,2.161c0.766,-1.183 -0.332,-5.791 2.775,-4.94c-2.402,-0.091 -0.433,2.974 -1.491,4.033Z' />\n    <path d='M10.309,21.121c0.439,-1.274 -0.852,-3.525 1.081,-4.967c1.247,-0.929 2.133,-2.246 2.743,-4.167c3.781,7.611 -2.788,8.409 -3.681,10.699c-0.641,-1.255 -5.181,-2.607 -2.891,-4.873c-1.28,2.034 2.359,1.863 2.748,3.308Z' />\n    <path d='M19.066,18.01c-0.883,-1.017 -3.479,-1.024 -3.76,-3.42c-0.182,-1.544 -0.88,-2.971 -2.238,-4.459c8.482,0.532 5.889,6.619 7.425,8.538c-1.407,-0.072 -4.849,3.183 -5.665,0.067c1.121,2.125 2.792,-1.112 4.238,-0.726Z' />\n    <path d='M20.751,8.871c-1.323,0.256 -2.627,2.501 -4.842,1.546c-1.429,-0.615 -3.013,-0.723 -4.98,-0.291c4.701,-7.08 8.676,-1.791 11.106,-2.162c-0.767,1.183 0.332,5.791 -2.775,4.94c2.401,0.092 0.433,-2.974 1.491,-4.033Z' />\n\n  </React.Fragment>, 'AppLogo')\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport { makeStyles } from '@material-ui/core/styles'\n// import style from './auth.style'\nimport useAuthCommon from './useAuthCommon'\nimport AppLogo from '../../icons/AppLogo'\n\nimport { ThemeProvider } from '@material-ui/styles'\nimport themes from '../../themes'\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    height: '100%'\n  },\n  bgSwoosh: {\n    width: '100%',\n    height: '100%',\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    zIndex: 0\n  },\n  logo: {\n    width: '100%',\n    height: '100%',\n    zIndex: 1\n  },\n  inner: {\n    width: '100%',\n    minWidth: 200,\n    maxWidth: 300,\n    position: 'absolute',\n    zIndex: 2,\n    textAlign: 'center',\n    top: '50%',\n    left: '50%',\n    transformOrigin: '50% 50%',\n    transform: 'translateY(-50%) translateX(-50%)'\n  }\n}))\n\nconst AuthContainer = ({ children }) => {\n  const containerRef = useAuthCommon()\n  const classes = useStyles()\n  return (\n    <ThemeProvider theme={themes.login}>\n      <div ref={containerRef} className={classes.root}>\n        <CssBaseline />\n        {/* Look for: LoginSwoosh.svg */}\n        {/* <svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 500 500' preserveAspectRatio='none' className={classes.bgSwoosh}>\n        <path className={classes.bgSwooshFill} d=' M 0 0 L 500 0 C 500 209.782 489.956 180 250 180 C 10.044 180 0 219.954 0 370 L 0 0 Z ' />\n      </svg> */}\n\n        <div className={classes.inner}>\n          {/* Look for: Logo.svg */}\n          <AppLogo className={classes.logo} />\n\n          <Typography variant='h5'>Photomon</Typography>\n          {children}\n        </div>\n      </div>\n    </ThemeProvider>\n  )\n}\n\nAuthContainer.propTypes = {\n  children: PropTypes.any\n}\n\nexport default AuthContainer\n","import React from 'react'\n// import PropTypes from 'prop-types'\n// import MenuIcon from '@material-ui/core/Menu'\n// import { makeStyles } from '@material-ui/core/styles'\n// import style from './auth.style'\nimport AuthContainer from './AuthContainer'\nimport { Typography } from '@material-ui/core'\n\n// const useStyles = makeStyles(style)\n\nconst Loading = () => {\n  // const classes = useStyles()\n  return (\n    <AuthContainer>\n      <Typography variant='h3'>Loading...</Typography>\n    </AuthContainer>\n  )\n}\n\nLoading.propTypes = {\n}\n\nexport default Loading\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\n/**\n * Note: this was one of the few components we didn't use hooks for\n * mostly because I couldn't find an easy way to do getDerivedStateFromError()\n *\n * We might revise this later\n */\nclass ErrorBoundary extends React.Component {\n  constructor (props) {\n    console.log('ErrorBoundary constructor')\n    super(props)\n    this.state = { hasError: false }\n  }\n\n  static getDerivedStateFromError (error) {\n    // Update state so the next render will show the fallback UI.\n    console.log('ErrorBoundary getDerivedStateFromError')\n    console.error(error)\n    return { hasError: true, error }\n  }\n\n  componentDidCatch (error, info) {\n    console.log('ErrorBoundary componentDidCatch')\n    console.error(error)\n    // You can also log the error to an error reporting service\n    // logErrorToMyService(error, info)\n  }\n\n  render () {\n    const { hasError, error } = this.state\n    const { fallback: FallbackUI } = this.props\n    console.log('ErrorBoundary render', hasError, error)\n    if (hasError) {\n      console.log('ErrorBoundary hasError')\n      // You can render any custom fallback UI\n      return <FallbackUI error={error} />\n    }\n\n    return this.props.children\n  }\n}\nErrorBoundary.propTypes = {\n  children: PropTypes.any,\n  fallback: PropTypes.any\n}\n\nexport default ErrorBoundary\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport Button from '@material-ui/core/Button'\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport DialogContentText from '@material-ui/core/DialogContentText'\nimport TextField from '@material-ui/core/TextField'\nimport DialogActions from '@material-ui/core/DialogActions'\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport BugReportIcon from '@material-ui/icons/BugReport'\nimport ErrorIcon from '@material-ui/icons/Error'\nimport { makeStyles } from '@material-ui/core/styles'\n\nexport const SEND_STATES = {\n  UNSENT: 'UNSENT',\n  SENDING: 'SENDING',\n  SENT: 'SENT',\n  ERROR: 'ERROR'\n}\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    height: '100%',\n    overflow: 'hidden',\n    padding: theme.spacing(1),\n    display: 'flex',\n    flexDirection: 'column',\n    textAlign: 'center',\n    color: theme.palette.text.primary,\n    border: `20px solid ${theme.palette.text.secondary}`\n  },\n  button: {\n    // background: theme.palette.success.main,\n    // color: theme.palette.success.contrastText\n  },\n  icon: {\n    opacity: 0.5,\n    margin: 'auto',\n    flex: '0 1 10%',\n    // height: '50%',\n    width: '50%'\n  },\n  text: {\n  },\n  stack: {\n    padding: theme.spacing(2),\n    marginBottom: theme.spacing(2),\n    fontSize: '8px',\n    flexGrow: 1,\n    textAlign: 'left',\n    whiteSpace: 'pre-wrap',\n    overflow: 'scroll',\n    color: theme.palette.error.main,\n    fontFamily: 'Consolas, monaco, monospace'\n  }\n}))\n\nconst ErrorScreen = ({ error, sendState, reportError }) => {\n  const classes = useStyles()\n  const [dlgOpen, setDialogOpen] = useState(false)\n  const [note, setNote] = useState('')\n  let stackEl = null\n  try {\n    if (process.env.NODE_ENV === 'development') {\n      stackEl = (\n        <Typography className={classes.stack}>\n          {error.stack}\n        </Typography>\n      )\n    }\n  }\n  catch (e) {}\n\n  let buttonText = 'Report this bug'\n  let disabled = false\n  let color = 'primary'\n  switch (sendState) {\n    case SEND_STATES.UNSENT:\n      buttonText = 'Report this bug'\n      break\n    case SEND_STATES.SENDING:\n      disabled = true\n      color = 'default'\n      buttonText = 'Sending...'\n      break\n    case SEND_STATES.SENT:\n      color = 'default'\n      disabled = true\n      buttonText = 'Thank you for your feedback'\n      break\n\n    default:\n      break\n  }\n\n  return (\n    <div className={classes.root}>\n      <CssBaseline />\n      <ErrorIcon className={classes.icon} color='error' />\n      <Typography variant='subtitle1' className={classes.text} color='inherit'>\n        Something went wrong\n      </Typography>\n      {error && error.message && <Typography variant='body1' className={classes.text} color='inherit'>\n        {error.message}\n      </Typography>}\n      <Button\n        className={classes.button}\n        variant='contained'\n        disabled={disabled}\n        color={color}\n        onClick={() => setDialogOpen(true)}\n      >\n        <BugReportIcon />\n        {buttonText}\n      </Button>\n      {stackEl}\n      <Dialog open={dlgOpen} onClose={() => setDialogOpen(false)} aria-labelledby='form-dialog-title'>\n        <DialogTitle id='form-dialog-title'>Report a bug</DialogTitle>\n        <DialogContent>\n          <DialogContentText>\n            What were you trying to do when the error happened?\n          </DialogContentText>\n          <TextField\n            autoFocus\n            margin='dense'\n            multiline\n            onChange={(e) => setNote(e.target.value)}\n            rowsMax='6'\n            id='note'\n            placeholder='I tried to X and then Y happened...'\n            label='Note'\n            fullWidth\n          />\n        </DialogContent>\n        <DialogActions>\n          <Button onClick={() => setDialogOpen(false)} color='primary'>\n            Cancel\n          </Button>\n          <Button onClick={() => {\n            reportError(note)\n            setDialogOpen(false)\n          }} color='primary'>\n            Send\n          </Button>\n        </DialogActions>\n      </Dialog>\n    </div>\n  )\n}\n\nErrorScreen.propTypes = {\n  error: PropTypes.object,\n  sendState: PropTypes.string,\n  reportError: PropTypes.func.isRequired\n}\n\nexport default ErrorScreen\n","import gql from 'graphql-tag'\n\nexport const deletePhoto = gql`\n  mutation deletePhoto($seriesId: ID!, $photoId: ID!) {\n    deletePhoto(seriesId: $seriesId, photoId: $photoId)\n  }\n`\n\nexport const deleteSeries = gql`\n  mutation deleteSeries($id: ID!) {\n    deleteSeries(id: $id)\n  }\n`\n\nexport const updateSeries = gql`\n  mutation updateSeries($series: UpdateSeriesInput!) {\n    updateSeries(series: $series){\n      id\n      name\n      note\n      meta\n      latitude\n      longitude\n      direction\n      photoCount\n      featured {\n        id\n        takenOn\n        paths {\n          base\n          thumb\n          medium\n          large\n        }\n      }     \n    }\n  }\n`\n\nexport const updatePhoto = gql`\n  mutation updatePhoto($photo: UpdatePhotoInput!) {\n    updatePhoto(photo: $photo){\n      id\n    }\n  }\n`\n\nexport const createPhoto = gql`\n  mutation createPhoto($photo: NewPhotoInput!, $ext: String!) {\n    createPhoto(photo: $photo, ext: $ext) {\n      photo {\n        id\n        meta\n        createdUser {\n          id\n          gravatar\n          gravatarProfile\n          name\n        }\n        seriesId\n        # createdOn\n        takenOn\n        # updatedOn\n        tags {\n          label\n          typeId\n          coords {\n            x\n            y\n          }\n        }\n        paths {\n          base\n          thumb\n          medium\n          large\n        }\n      }\n      preAuth\n    }\n  }\n`\n\nexport const createSeries = gql`\n  mutation createSeries($series: NewSeriesInput!) {\n    createSeries(series: $series) {\n      id\n      name\n      note\n      meta\n      # createdOn\n      # updatedOn\n      latitude\n      longitude\n      direction\n      photoCount\n      featured {\n        id\n        takenOn\n        paths {\n          base\n          thumb\n          medium\n          large\n        }\n      }\n      # latest {\n      #   id\n      #   paths {\n      #     thumb\n      #   }\n      #   createdBy\n      #   createdOn\n      #   takenOn\n      #   updatedOn\n      # }\n      photos {\n        id\n        meta\n        createdUser {\n          id\n          gravatar\n          gravatarProfile\n          name\n        }   \n        # createdOn\n        takenOn\n        # updatedOn\n        tags {\n          label\n          typeId\n          coords {\n            x\n            y\n          }\n        }\n        paths {\n          base\n          thumb\n          medium\n          large\n        }\n      }\n    }\n  }\n`\n\nexport const watchSeries = gql`\n  mutation watch($seriesId: ID) {\n    watchSeries(seriesId: $seriesId)\n  }\n`\n\nexport const unWatchSeries = gql`\n  mutation unWatch($seriesId: ID) {\n    unWatchSeries(seriesId: $seriesId)\n  }\n`\n\nexport const reportBug = gql`\n  mutation reportBug($reportJSON: String!) {\n    reportBug(reportJSON: $reportJSON)\n  }\n`\n","import React, { useState } from 'react'\n// import PropTypes from 'prop-types'\nimport { graphql } from 'react-apollo'\nimport { connect } from 'react-redux'\nimport ErrorScreen, { SEND_STATES } from '../components/misc/ErrorScreen'\nimport { reportBug } from './mutations'\n\nconst ErrorConnect = (props) => {\n  const [state, setState] = useState(SEND_STATES.UNSENT)\n  const Wrapped = withReportBugMutation(ErrorScreen)\n  return <Wrapped {...props} setState={setState} sendState={state} />\n}\n\nconst withReportBugMutation = graphql(reportBug, {\n  props: ({ mutate, ownProps: { reduxState, error, setState } }) => {\n    console.log('withReportBugMutation', { mutate, reduxState, error })\n    return {\n      reportError: (note) => {\n        setState(SEND_STATES.SENDING)\n        let reportJSON = ''\n        const errObj = { note, reduxState, error, env: process.env }\n        console.log('withReportBugMutation StartingError', errObj)\n        try {\n          reportJSON = JSON.stringify(errObj)\n        }\n        catch (e) {\n          reportJSON = error.toString()\n        }\n        mutate({\n          variables: { reportJSON },\n          update: (store, { data }) => {\n            console.log('withReportBugMutation update', data)\n            setState(SEND_STATES.SENT)\n          }\n        })\n      }\n    }\n  }\n})\n\n/**\n * Map our redux state and functions\n */\nconst mapStateToProps = (state, props) => {\n  const { map, home, uploader, ...other } = state\n  const newMap = map.slice(-5) // only the last 5 map states come through\n\n  return {\n    reduxState: {\n      ...other,\n      map: newMap,\n      home\n    }\n  }\n}\n\nexport default connect(\n  mapStateToProps\n)(ErrorConnect)\n","import { createHttpLink } from 'apollo-link-http'\nimport { setContext } from 'apollo-link-context'\n// import PropTypes from 'prop-types'\nimport { endpoints } from '../config'\nimport { ApolloLink } from 'apollo-link'\nimport { InMemoryCache, ApolloClient } from 'apollo-boost'\n\nconst LOCAL_STORAGE_TOKEN = 'apollo-token'\n/**\n * Helper function to create our Apollo Client object\n * @param {*} token\n */\nexport function createApolloClient (token = '') {\n  // Set up our headers for authentication through graphql\n  const cache = new InMemoryCache()\n\n  // The auth link is just used to decorate our HTTP headers with authentication data\n  const authLink = setContext((_, { headers }) => {\n    const newHeaders = {\n      ...headers,\n      authorization: token ? `Bearer ${token}` : ''\n    }\n    // on Dev machines, allow us to fake a user. This will ONLY work with a complimentary\n    // Dev graphql endpoint and singin is still required.\n\n    // This was done so we can test what the App looks like from varying perspectives\n    if (process.env.NODE_ENV === 'development' && process.env.REACT_APP_FAKE_USER) {\n      newHeaders.auth_user = process.env.REACT_APP_FAKE_USER\n    }\n    return { headers: newHeaders }\n  })\n\n  // HTTP link creates the network connection to our graphql host\n  const httpLink = createHttpLink({ uri: endpoints.graphql })\n  console.log('Creating Apollo Client Client', endpoints.graphql, token ? 'TOKEN PROVIDED' : 'NO TOKEN')\n\n  const apolloClient = new ApolloClient({\n    link: ApolloLink.from([authLink, httpLink]),\n    tokenName: LOCAL_STORAGE_TOKEN,\n    cache,\n    connectToDevTools: true\n  })\n\n  // Now put it all together\n  return apolloClient\n}\n\n// Note: this method comes from isntructions here:\n// https://www.apollographql.com/docs/react/recipes/authentication.html\n// export const withApollo = compose(\n//   lifecycle({\n//     shouldComponentUpdate (nextProps) {\n//       const { authStore: { jwtToken: oldToken } } = nextProps\n//       const { authStore: { jwtToken: newToken } } = this.props\n//       if (newToken === oldToken) {\n//         return true\n//       }\n//       return true\n//     }\n//   }),\n//   withWrapClient\n// )\n","export default theme => ({\n  root: {\n  },\n  spacer: {\n    flexGrow: 1\n  },\n  forgotPassword: {\n    width: '100%',\n    textAlign: 'right'\n  },\n  switch: {\n\n  },\n  switchButton: {\n    flexGrow: 1,\n    '&:last-child': {\n      borderRadius: 0\n    },\n    '&:first-child': {\n      borderRadius: 0\n    }\n  },\n  phoneNumInner: {\n    marginTop: theme.spacing(1),\n    display: 'flex'\n    // border: '1px solid red'\n  },\n  phoneNumDropdown: {\n    margin: theme.spacing(1),\n    minWidth: 120\n  },\n  warnText: {\n    marginTop: theme.spacing(2),\n    fontStyle: 'italic'\n  },\n  noSignin: {\n    marginTop: theme.spacing(2)\n  }\n})\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport TextField from '@material-ui/core/TextField'\nimport Button from '@material-ui/core/Button'\nimport Link from '@material-ui/core/Link'\nimport Toolbar from '@material-ui/core/Toolbar'\n// import MenuIcon from '@material-ui/core/Menu'\n// import { FederatedButtons } from 'aws-amplify-react'\nimport { makeStyles } from '@material-ui/core/styles'\nimport style from './auth.style'\nimport AuthContainer from './AuthContainer'\nimport { Typography } from '@material-ui/core'\n\nconst useStyles = makeStyles(style)\n\nconst SignIn = ({ loading,\n  handleSignup,\n  federated,\n  handleForgotPassword,\n  handleInputChange,\n  handleBeAnonymous,\n  handleSignIn, ...props }) => {\n  const classes = useStyles()\n  return (\n    <AuthContainer>\n      {/* {props.federated && (\n        <FederatedButtons {...props} />\n      )} */}\n      <TextField\n        id='username'\n        fullWidth\n        key='username'\n        name='username'\n        label='Username'\n        color='inherit'\n        autoFocus\n        className={classes.textField}\n        margin='normal'\n        onChange={handleInputChange}\n      />\n      <TextField\n        fullWidth\n        id='password'\n        label='Password'\n        color='inherit'\n        key='password'\n        name='password'\n        type='password'\n        className={classes.textField}\n        autoComplete='current-password'\n        margin='normal'\n        onChange={handleInputChange}\n      />\n      <Link component='button' variant='body2' className={classes.forgotPassword} disabled={loading} onClick={handleForgotPassword}>\n          Forgot Password\n      </Link>\n      <Toolbar disableGutters>\n\n        <Button component='button' color='secondary' variant='contained' disabled={loading} onClick={handleSignup}>\n          New Account\n        </Button>\n        <div className={classes.spacer} />\n        <Button\n          className='enterAction'\n          component='button'\n          color='primary'\n          variant='contained'\n          disabled={loading}\n          onClick={handleSignIn}\n        >\n          Sign In\n        </Button>\n      </Toolbar>\n\n      <div className={classes.noSignin}>\n        <Button fullWidth variant={'outlined'} onClick={handleBeAnonymous} color='inherit'>\n          Continue without logging in\n        </Button>\n        <Typography variant='caption' className={classes.warnText} color='textSecondary' component='div'>\n          You will not be able to add content and many features will be unavailable.\n        </Typography>\n      </div>\n    </AuthContainer>\n  )\n}\n\nSignIn.propTypes = {\n  loading: PropTypes.bool,\n  federated: PropTypes.object,\n  handleSignup: PropTypes.func.isRequired,\n  handleForgotPassword: PropTypes.func.isRequired,\n  handleInputChange: PropTypes.func.isRequired,\n  handleBeAnonymous: PropTypes.func.isRequired,\n  handleSignIn: PropTypes.func.isRequired\n}\n\nexport default SignIn\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport TextField from '@material-ui/core/TextField'\nimport Button from '@material-ui/core/Button'\nimport Toolbar from '@material-ui/core/Toolbar'\n// import MenuIcon from '@material-ui/core/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nimport style from './auth.style'\nimport AuthContainer from './AuthContainer'\n\nconst useStyles = makeStyles(style)\n\nconst ConfirmSignIn = ({ handleInputChange, handleBack, handleConfirm }) => {\n  const classes = useStyles()\n  return (\n    <AuthContainer>\n      <TextField\n        id='mfaCode'\n        fullWidth\n        autoFocus\n        label='MFA Code'\n        name='code'\n        className={classes.textField}\n        margin='normal'\n        onChange={handleInputChange}\n      />\n\n      <Toolbar disableGutters>\n        <Button color='secondary' variant='contained' onClick={handleBack}>\n          Back\n        </Button>\n        <div className={classes.spacer} />\n        <Button\n          className='enterAction'\n          color='primary'\n          variant='contained'\n          onClick={handleConfirm}\n        >\n          Confirm\n        </Button>\n      </Toolbar>\n    </AuthContainer>\n  )\n}\n\nConfirmSignIn.propTypes = {\n  handleInputChange: PropTypes.func.isRequired,\n  handleBack: PropTypes.func.isRequired,\n  handleConfirm: PropTypes.func.isRequired\n}\n\nexport default ConfirmSignIn\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport TextField from '@material-ui/core/TextField'\nimport Button from '@material-ui/core/Button'\nimport Typography from '@material-ui/core/Typography'\nimport Toolbar from '@material-ui/core/Toolbar'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport style from './auth.style'\nimport AuthContainer from './AuthContainer'\n\nconst useStyles = makeStyles(style)\n\nconst RequireNewPassword = ({ change, requiredAttributes, placeholders, handleInputChange }) => {\n  const classes = useStyles()\n  return (\n    <AuthContainer>\n      <Typography>A new password is required</Typography>\n      <TextField\n        id='newassword'\n        fullWidth\n        autoFocus\n        label='New Password'\n        className={classes.textField}\n        type='password'\n        autoComplete='new-password'\n        margin='normal'\n        onChange={handleInputChange}\n      />\n      {requiredAttributes\n        .map((attribute, idx) => (\n          <TextField\n            fullWidth\n            key={attribute}\n            name={attribute}\n            className={classes.textField}\n            placeholder={placeholders[idx]}\n            type='text'\n            margin='normal'\n            onChange={handleInputChange}\n          />\n        ))}\n\n      <Toolbar disableGutters>\n\n        <Button color='secondary' variant='contained'>\n          Back\n        </Button>\n        <div className={classes.spacer} />\n        <Button\n          color='primary'\n          variant='contained'\n          onClick={change}\n          className='enterAction'\n        >\n          Change\n        </Button>\n      </Toolbar>\n    </AuthContainer>\n  )\n}\n\nRequireNewPassword.propTypes = {\n  change: PropTypes.func.isRequired,\n  handleInputChange: PropTypes.func.isRequired,\n  requiredAttributes: PropTypes.array,\n  placeholders: PropTypes.array\n}\n\nexport default RequireNewPassword\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\nimport TextField from '@material-ui/core/TextField'\nimport Button from '@material-ui/core/Button'\nimport Toolbar from '@material-ui/core/Toolbar'\nimport FormControl from '@material-ui/core/FormControl'\nimport InputLabel from '@material-ui/core/InputLabel'\nimport Select from '@material-ui/core/Select'\nimport AuthContainer from './AuthContainer'\n\n// import MenuIcon from '@material-ui/core/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nimport style from './auth.style'\n// import AuthPhoneNum from './AuthPhoneNum'\nconst useStyles = makeStyles(style)\n\nconst SignUp = ({ handleInputChange, signUpFields, signUpFieldLabels, signUpFieldPlaceholders,\n  handleSignup, handleBack, countryDialCodes, defaultDialCode }) => {\n  console.log('SIGNUPPROPS', { defaultDialCode, countryDialCodes, signUpFields, signUpFieldLabels, signUpFieldPlaceholders })\n  const [selectVal, setSelectVal] = useState(defaultDialCode)\n  const classes = useStyles()\n  const handleDialCodeChange = e => {\n    handleInputChange(e)\n    setSelectVal(e.target.value)\n  }\n  return (\n    <AuthContainer>\n      {\n        signUpFields.map((field, idx) => {\n          return field.key !== 'phone_number' ? (\n            <TextField\n              fullWidth\n              autoFocus={signUpFields.findIndex(f => f.key === field.key) === 0}\n              type={field.type}\n              name={field.key}\n              key={field.key}\n              placeholder={signUpFieldPlaceholders[idx]}\n              label={signUpFieldLabels[idx]}\n              className={classes.textField}\n              margin='normal'\n              onChange={handleInputChange}\n            />\n          ) : (\n            <FormControl\n              className={classes.phoneNumDropdown}\n              fullWidth\n              key='phonenum'\n            >\n              <InputLabel htmlFor='dial_code' shrink>\n                {signUpFieldLabels[idx]}\n                {field.required ? '*' : ''}\n              </InputLabel>\n              <div className={classes.phoneNumInner}>\n                <Select\n                  value={selectVal}\n                  onChange={handleDialCodeChange}\n                  inputProps={{\n                    name: 'dial_code',\n                    id: 'dial_code'\n                  }}\n                >\n                  {countryDialCodes.map(dialCode =>\n                    <option key={dialCode} value={dialCode}>\n                      {dialCode}\n                    </option>\n                  )}\n                </Select>\n                <TextField\n                  placeholder={signUpFieldPlaceholders[idx]}\n                  type='tel'\n                  fullWidth\n                  id='phone_line_number'\n                  key='phone_line_number'\n                  name='phone_line_number'\n                  onChange={handleInputChange}\n                />\n              </div>\n            </FormControl>\n          )\n        })\n      }\n      <Toolbar disableGutters>\n        <Button color='secondary' variant='outlined' onClick={handleBack}>\n          Back\n        </Button>\n        <div className={classes.spacer} />\n        <Button\n          className='enterAction'\n          component='button'\n          color='primary'\n          variant='contained'\n          onClick={handleSignup}\n        >\n          Create Account\n        </Button>\n      </Toolbar>\n    </AuthContainer>\n  )\n}\n\nSignUp.propTypes = {\n  handleInputChange: PropTypes.func.isRequired,\n  signUpFields: PropTypes.array.isRequired,\n  signUpFieldLabels: PropTypes.array.isRequired,\n  signUpFieldPlaceholders: PropTypes.array.isRequired,\n  countryDialCodes: PropTypes.array.isRequired,\n  defaultDialCode: PropTypes.string.isRequired,\n  handleSignup: PropTypes.func.isRequired,\n  handleBack: PropTypes.func.isRequired\n}\n\nexport default SignUp\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport TextField from '@material-ui/core/TextField'\nimport Button from '@material-ui/core/Button'\nimport Link from '@material-ui/core/Link'\nimport Toolbar from '@material-ui/core/Toolbar'\n// import MenuIcon from '@material-ui/core/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nimport style from './auth.style'\nimport AuthContainer from './AuthContainer'\n\nconst useStyles = makeStyles(style)\n\nconst ConfirmSignUp = ({ handleInputChange, handleBack, handleResend, handleConfirm }) => {\n  const classes = useStyles()\n  return (\n    <AuthContainer>\n      <TextField\n        id='username'\n        fullWidth\n        autoFocus\n        name='username'\n        label='Username'\n        className={classes.textField}\n        margin='normal'\n        onChange={handleInputChange}\n      />\n      <TextField\n        id='confirmationCode'\n        fullWidth\n        name='code'\n        label='Confirmation Code'\n        className={classes.textField}\n        margin='normal'\n        onChange={handleInputChange}\n\n      />\n      <Link component='button' variant='body2' className={classes.resendCode} onClick={handleResend}>\n          Resend Code\n      </Link>\n      <Toolbar disableGutters>\n\n        <Button color='secondary' variant='outlined' onClick={handleBack}>\n          Back\n        </Button>\n        <div className={classes.spacer} />\n        <Button\n          color='primary'\n          variant='contained'\n          className='enterAction'\n          onClick={handleConfirm}\n        >\n          Sign In\n        </Button>\n      </Toolbar>\n    </AuthContainer>\n  )\n}\n\nConfirmSignUp.propTypes = {\n  handleInputChange: PropTypes.func.isRequired,\n  handleBack: PropTypes.func.isRequired,\n  handleResend: PropTypes.func.isRequired,\n  handleConfirm: PropTypes.func.isRequired\n}\n\nexport default ConfirmSignUp\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\nimport Link from '@material-ui/core/Link'\nimport TextField from '@material-ui/core/TextField'\nimport Typography from '@material-ui/core/Typography'\nimport Button from '@material-ui/core/Button'\n\nimport Toolbar from '@material-ui/core/Toolbar'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport style from './auth.style'\nimport AuthContainer from './AuthContainer'\n\nconst useStyles = makeStyles(style)\n\nconst ForgotPassword = ({ handleSubmit, handleInputChange, handleSendCode, handleBack }) => {\n  const [sent, setSent] = useState(false)\n  const classes = useStyles()\n  return (\n    <AuthContainer>\n      <Typography>Forgot Password</Typography>\n      {!sent && (\n        <TextField\n          id='username'\n          autoFocus\n          fullWidth\n          label='Username'\n          name='username'\n          className={classes.textField}\n          margin='normal'\n          onChange={handleInputChange}\n        />\n      )}\n      {sent && (\n        <TextField\n          id='changecode'\n          fullWidth\n          autoFocus\n          label='Code'\n          name='code'\n          className={classes.textField}\n          margin='normal'\n          onChange={handleInputChange}\n        />\n      )}\n      {sent && (\n        <TextField\n          id='newpassword'\n          fullWidth\n          label='New Password'\n          className={classes.textField}\n          type='password'\n          name='password'\n          autoComplete='current-password'\n          margin='normal'\n          onChange={handleInputChange}\n        />\n      )}\n      {sent && (\n        <Link component='button' variant='body2' className={classes.resendCode} onClick={handleSendCode}>\n          Resend Code\n        </Link>\n\n      )}\n      <Toolbar disableGutters>\n        <Button\n          color='secondary'\n          variant='outlined'\n          onClick={() => {\n            sent ? setSent(false) : handleBack()\n          }}\n        >\n          Back\n        </Button>\n        <div className={classes.spacer} />\n        {!sent && (\n          <Button\n            color='primary'\n            variant='contained'\n            className='enterAction'\n            onClick={() => {\n              setSent(true)\n              handleSendCode()\n            }}\n          >\n          Send Code\n          </Button>\n        )}\n        {sent && (\n          <Button\n            className='enterAction'\n            color='primary'\n            variant='contained'\n            onClick={handleSubmit}\n          >\n          Submit\n          </Button>\n        )}\n      </Toolbar>\n    </AuthContainer>\n  )\n}\n\nForgotPassword.propTypes = {\n  handleSubmit: PropTypes.func.isRequired,\n  handleInputChange: PropTypes.func.isRequired,\n  handleSendCode: PropTypes.func.isRequired,\n  handleBack: PropTypes.func.isRequired\n}\n\nexport default ForgotPassword\n","import React, { useState } from 'react'\nimport Amplify, { Auth } from 'aws-amplify'\nimport { I18n } from '@aws-amplify/core' // ConsoleLogger as Logger\nimport countryDialCodes from 'aws-amplify-react/dist/Auth/common/country-dial-codes'\nimport {\n  Authenticator,\n  SignIn as SignInOrig,\n  SignUp as SignUpOrig,\n  ConfirmSignIn as ConfirmSignInOrig,\n  ConfirmSignUp as ConfirmSignUpOrig,\n  RequireNewPassword as RequireNewPasswordOrig,\n  Loading as LoadingOrig,\n  VerifyContact as VerifyContactOrig,\n  ForgotPassword as ForgotPasswordOrig\n} from 'aws-amplify-react'\n\nimport CompSignIn from '../components/auth/SignIn'\nimport CompConfirmSignIn from '../components/auth/ConfirmSignIn'\nimport CompRequireNewPassword from '../components/auth/RequireNewPassword'\nimport CompSignUp from '../components/auth/SignUp'\nimport CompLoading from '../components/auth/Loading'\nimport CompConfirmSignUp from '../components/auth/ConfirmSignUp'\n// import CompVerifyContact from '../components/auth/VerifyContact'\nimport CompForgotPassword from '../components/auth/ForgotPassword' // or 'aws-amplify-react-native';\nimport { aws } from '../config'\n\nAmplify.configure(aws)\n\nconst defaultAuthState = { authState: 'init', authData: {}, signedIn: null }\n\nconst useAuthentication = () => {\n  const [{ authState, authData, signedIn }, setAuth] = useState(defaultAuthState)\n\n  // Set up the trinary\n  // if (authState === 'signedIn') signedIn = true\n\n  const handleAuthStateChange = (state, data) => {\n    // console.log('handleAuthStateChange', { state, data })\n    setAuth({\n      authState: state,\n      authData: data,\n      // true = signedIn, false = beAnonymous, null = showLoginScreen\n      signedIn: !state || state.length === 0\n        ? null\n        : state === 'signedIn'\n          ? true\n          : signedIn\n    })\n  }\n\n  const signOut = () => Auth.signOut()\n    .then(data => console.log(data))\n    .catch(err => console.log(err))\n\n  const beAnonymous = () => {\n    setAuth({ authState, authData, signedIn: false })\n  }\n\n  const authScreen = signedIn ? null\n    : <Authenticator onStateChange={handleAuthStateChange} hideDefault>\n      <SignIn handleBeAnonymous={beAnonymous} />\n      <Loading />\n      <RequireNewPassword />\n      {/* <RequireNewPasswordOrig /> */}\n      <ConfirmSignIn />\n      <ConfirmSignUp />\n      {/* <VerifyContact /> NOT READY */}\n      <VerifyContactOrig />\n      <ForgotPassword />\n      <SignUp />\n      {/* <SignUpOrig /> */}\n    </Authenticator>\n\n  let accessToken = null\n  try {\n    if (signedIn) accessToken = authData.signInUserSession.accessToken.jwtToken\n    // console.log(`ACCESS TOKEN ${eqSpacer}\\n${accessToken}\\n/ACCESS TOKEN ${eqSpacer}`)\n  }\n  catch (e) {\n    console.error(e)\n  }\n  let isGod = false\n  try {\n    isGod = authData.signInUserSession.idToken.payload['cognito:groups'].indexOf('GodUsers') > -1\n  }\n  catch (e) {}\n\n  return {\n    authState,\n    authData,\n    isGod,\n    signOut,\n    forceSignIn: () => setAuth(defaultAuthState),\n    signedIn,\n    accessToken,\n    authScreen\n  }\n}\n\nexport default useAuthentication\n\nclass SignIn extends SignInOrig {\n  showComponent () {\n    const { loading } = this.state\n    const newProps = {\n      ...this.props,\n      loading,\n      handleForgotPassword: () => this.changeState('forgotPassword'),\n      handleSignup: () => this.changeState('signUp'),\n      handleInputChange: this.handleInputChange,\n      handleSignIn: this.signIn\n    }\n    return <CompSignIn {...newProps} />\n  }\n}\n\nclass SignUp extends SignUpOrig {\n  showComponent () {\n    const { hide } = this.props\n    if (hide && hide.includes(SignUp)) {\n      return null\n    }\n    if (this.checkCustomSignUpFields()) {\n      this.signUpFields = this.props.signUpConfig.signUpFields\n    }\n    this.sortFields()\n\n    const newProps = {\n      ...this.props,\n      countryDialCodes,\n      defaultDialCode: this.getDefaultDialCode(),\n      handleInputChange: this.handleInputChange,\n      signUpFields: this.signUpFields,\n      signUpFieldLabels: this.signUpFields.map(field => I18n.get(field.label)),\n      signUpFieldPlaceholders: this.signUpFields.map(field => I18n.get(field.placeholder)),\n      handleSignup: this.signUp,\n      handleBack: () => this.changeState('signIn')\n    }\n    return <CompSignUp {...newProps} />\n  }\n}\n\nclass ConfirmSignIn extends ConfirmSignInOrig {\n  showComponent () {\n    const newProps = {\n      ...this.props,\n      handleBack: () => this.changeState('signIn'),\n      handleInputChange: this.handleInputChange,\n      handleConfirm: this.confirm\n    }\n    return <CompConfirmSignIn {...newProps} />\n  }\n}\n\nclass ConfirmSignUp extends ConfirmSignUpOrig {\n  showComponent () {\n    const newProps = {\n      ...this.props,\n      handleBack: () => this.changeState('signIn'),\n      handleInputChange: this.handleInputChange,\n      handleConfirm: this.confirm,\n      handleResend: this.resend\n    }\n    return <CompConfirmSignUp {...newProps} />\n  }\n}\n\nclass RequireNewPassword extends RequireNewPasswordOrig {\n  showComponent () {\n    const user = this.props.authData\n    const { requiredAttributes } = user.challengeParam\n    const placeholders = Array.isArray(requiredAttributes)\n      ? requiredAttributes.map(attribute => I18n.get(convertToPlaceholder(attribute)))\n      : []\n\n    const newProps = {\n      ...this.props,\n      handleInputChange: this.handleInputChange,\n      requiredAttributes,\n      placeholders,\n      change: this.change\n    }\n    return <CompRequireNewPassword {...newProps} />\n  }\n}\n\nclass Loading extends LoadingOrig {\n  showComponent () {\n    return <CompLoading {...this.props} />\n  }\n}\n// class VerifyContact extends VerifyContactOrig {\n//   showComponent () {\n//     const user = this.props.authData\n//     if (!user) {\n//       verifyLogger.debug('no user for verify')\n//       return null\n//     }\n//     const { unverified } = user\n//     if (!unverified) {\n//       verifyLogger.debug('no unverified on user')\n//       return null\n//     }\n//     const { email, phoneNumber } = unverified\n\n//     const { authData } = this.props\n//     const newProps = {\n//       ...this.props,\n//       handleInputChange: this.handleInputChange,\n//       handleSkip: () => this.changeState('signedIn', authData),\n//       handleVerify: this.verify,\n//       handleSubmit: this.submit\n//     }\n//     return <CompVerifyContact {...newProps} />\n//   }\n// }\nclass ForgotPassword extends ForgotPasswordOrig {\n  showComponent () {\n    const newProps = {\n      ...this.props,\n      handleBack: () => this.changeState('signIn'),\n      handleInputChange: this.handleInputChange,\n      handleConfirm: this.confirm,\n      handleResend: this.send,\n      handleSubmit: this.submit,\n      handleSendCode: this.send\n    }\n    return <CompForgotPassword {...newProps} />\n  }\n}\n\n// const verifyLogger = new Logger('VerifyContact')\n\nfunction convertToPlaceholder (str) {\n  return str.split('_').map(part => part.charAt(0).toUpperCase() + part.substr(1).toLowerCase()).join(' ')\n}\n\n// const eqSpacer = '==============================================================='\n","import { useEffect } from 'react'\nimport { isIos } from './sensors'\n/**\n * Everything below here is about the prompt for installing a PWA\n */\n\n// Detects if device is in standalone mode\nconst isInStandaloneMode = () => ('standalone' in window.navigator) && (window.navigator.standalone)\n\nconst useShowAddToHome = () => {\n  const handleBeforePrompt = e => {\n    // Prevent Chrome 67 and earlier from automatically showing the prompt\n    e.preventDefault()\n    // Stash the event so it can be triggered later.\n    deferredPrompt = e\n    showAddToHomeScreen()\n  }\n\n  useEffect(() => {\n    // window.orientation [0,90,180, 270]\n    // screen\n    // Checks if should display install popup notification:\n    if (isIos() && !isInStandaloneMode()) {\n      console.log('I AM on IOS and I am NOT in standalone mode.')\n    // this.setState({ showInstallMessage: true })\n    }\n\n    window.addEventListener('beforeinstallprompt', handleBeforePrompt)\n    return () => {\n      window.removeEventListener('beforeinstallprompt', handleBeforePrompt)\n    }\n  }, [])\n\n  function addToHomeScreen () {\n    const a2hsBtn = document.querySelector('.ad2hs-prompt') // hide our user interface that shows our A2HS button\n    a2hsBtn.style.display = 'none' // Show the prompt\n    deferredPrompt.prompt() // Wait for the user to respond to the prompt\n    deferredPrompt.userChoice\n      .then(choiceResult => {\n        if (choiceResult.outcome === 'accepted') console.log('User accepted the A2HS prompt')\n        else console.log('User dismissed the A2HS prompt')\n\n        deferredPrompt = null\n      })\n  }\n\n  function showAddToHomeScreen () {\n    const a2hsBtn = document.querySelector('.ad2hs-prompt')\n    a2hsBtn.style.display = 'block'\n    a2hsBtn.addEventListener('click', addToHomeScreen)\n  }\n\n  let deferredPrompt\n}\n\nexport default useShowAddToHome\n","import { useCallback, useState, useLayoutEffect } from 'react'\nimport { debounce } from './util'\nimport { isIos, isPhone } from './sensors'\n\nconst getState = () => {\n  const { orientation, innerWidth, innerHeight, screen: { width, height } } = window\n  const wOrient = [90, 270].indexOf(orientation) !== 0 ? 'portrait' : 'landscape'\n  const bIsIos = isIos()\n  const bIsPhone = isPhone()\n  const windowSize = { width: innerWidth, height: innerHeight }\n  const screenSize = { width, height }\n\n  const returnState = {\n    isPhone: bIsPhone,\n    isIos: bIsIos,\n    orientation: wOrient,\n    windowSize,\n    screenSize\n    // This failed. the only way to handle this is to set it explicitly\n    // isVKeyBdOn: bIsPhone && windowSize.height < screenSize.height\n  }\n  return returnState\n}\n\nconst useResponsive = (mediQueries) => {\n  const [state, setState] = useState(getState())\n\n  const handleResize = (e) => {\n    if (e) {\n      e.preventDefault()\n      e.stopPropagation()\n    }\n    const newState = getState()\n    console.log('handleResize', newState)\n    setState(newState)\n  }\n\n  // const handleFlip = (e) => {\n  //   e.preventDefault()\n  //   e.stopPropagation()\n  //   const newState = getState()\n  //   console.log('handleFlip', newState)\n  //   setState(newState)\n  // }\n\n  const handleResizeDebounced = useCallback(debounce(handleResize, 500), [])\n  // const handleFlipDebounced = useCallback(debounce(handleFlip, 500), [])\n\n  useLayoutEffect(() => {\n    handleResizeDebounced()\n    window.addEventListener('resize', handleResizeDebounced)\n    // window.addEventListener('orientationchange', handleFlipDebounced)\n\n    return () => {\n      window.removeEventListener('resize', handleResizeDebounced)\n      // window.removeEventListener('orientationchange', handleFlipDebounced)\n    }\n  },\n  [])\n\n  return state\n}\n\nexport default useResponsive\n","/**\n * We put our action types at the top to keep them straight\n *\n * This is just a handy enumeration we use everywhere to make sure we're\n * all talking about the same ations\n */\nexport const Actions = {\n\n  HOME_CHANGE_STATE: 'HOME_CHANGE_STATE',\n  HOME_CHANGE_ACTIVE_SERIES: 'HOME_CHANGE_ACTIVE_SERIES',\n  HOME_STATE_BACK: 'HOME_STATE_BACK',\n\n  MAP_HISTORY_POP: 'MAP_HISTORY_POP',\n  MAP_HISTORY_PUSH: 'MAP_HISTORY_PUSH',\n  MAP_HISTORY_CLEAR: 'MAP_HISTORY_CLEAR',\n\n  UPLOADER_START: 'UPLOADER_START',\n  UPLOADER_COMPLETE: 'UPLOADER_COMPLETE',\n  UPLOADER_UPDATE_PROGRESS: 'UPLOADER_UPDATE_PROGRESS'\n\n}\n\n/**\n * Now here are the actual action functions we will be dispatching\n * The actions have arguments related to what they do but they action they\n * dispatch consists only of a type and data3\n */\nexport default {\n  setHomeState: (newDomain, params) => ({ type: Actions.HOME_CHANGE_STATE, data: { newDomain, params } }),\n  homeStateBack: () => ({ type: Actions.HOME_STATE_BACK }),\n  setActiveSeries: (seriesId, initialPhoto) => ({ type: Actions.HOME_CHANGE_ACTIVE_SERIES, data: { seriesId, initialPhoto } }),\n\n  popMapHistory: () => ({ type: Actions.MAP_HISTORY_POP }),\n  pushMapHistory: (viewportSave) => ({ type: Actions.MAP_HISTORY_PUSH, data: viewportSave }),\n  clearMapHistory: () => ({ type: Actions.MAP_HISTORY_CLEAR }),\n\n  queueUpload: (uploadObj) => ({ type: Actions.UPLOADER_START, data: uploadObj }),\n  // startActiveUpload: () => ({ type: Actions.UPLOADER_START }),\n  completeActiveUpload: () => ({ type: Actions.UPLOADER_COMPLETE }),\n  updateUploadProgress: (newProgress) => ({ type: Actions.UPLOADER_UPDATE_PROGRESS, data: newProgress })\n\n}\n","import { Actions } from '../actions'\nimport { home } from '../../config'\nconst mapInit = [\n  {\n    mode: home.MapModeTypes.FREE,\n    // selectedItem: null\n    viewport: {\n      // 'latitude': 49.2707848, // vancouver\n      // 'longitude': -123.0714866,\n      latitude: 36.80191008366581, // Grand Canyon\n      longitude: -111.63999999999784,\n      zoom: 11\n    }\n  }\n]\n\nexport default (state = mapInit, action) => {\n  const { type, data } = action\n\n  switch (type) {\n    case Actions.MAP_HISTORY_CLEAR:\n      const newClearerHistory = state.length > 0 ? [[state.length - 1]] : []\n      return newClearerHistory\n\n    case Actions.MAP_HISTORY_POP:\n      return state.slice(0, -1)\n\n    case Actions.MAP_HISTORY_PUSH:\n      return [...state, data]\n    default:\n      return state\n  }\n}\n","import { Actions } from '../actions'\nimport { home } from '../../config'\n\nconst homeInit = {\n  history: [],\n  current: {\n    domain: home.AppStateTypes.FEED\n    // search: null // { tab, text }\n    // defaultSearchTab:\n    // defaultSearchText:\n    // activeSeries: 'fda17bae-0335-4f0d-9065-dc8d7aa23ed1',\n    // initialPhoto: 'someguid'\n  }\n}\n\nexport default (state = homeInit, action) => {\n  const { type, data } = action\n  const { history, current } = state\n\n  switch (type) {\n    case Actions.HOME_STATE_BACK:\n      const newStateHistory = [...history]\n      const newCurrentState = newStateHistory.length > 0 ? newStateHistory.pop() : homeInit.current\n      return {\n        current: newCurrentState,\n        history: newStateHistory\n      }\n\n    case Actions.HOME_CHANGE_ACTIVE_SERIES:\n      const { activeSeries, initialPhoto } = current\n      return {\n        history,\n        current: {\n          ...current,\n          activeSeries: activeSeries || null,\n          initialPhoto: activeSeries && initialPhoto ? initialPhoto : null\n        }\n      }\n\n    case Actions.HOME_CHANGE_STATE:\n      const { newDomain, params } = data\n      const newParams = params || {}\n      const newHistory = [...history, current]\n      return {\n        history: newHistory,\n        current: {\n          ...current,\n          domain: newDomain,\n          ...newParams\n        }\n      }\n\n    default:\n      return state\n  }\n}\n","import { Actions } from '../actions'\n\nconst initState = {\n  store: [],\n  activeUpload: null\n}\n\nexport default (state = initState, action) => {\n  const { type, data } = action\n  const { store, activeUpload } = state\n\n  switch (type) {\n    case Actions.UPLOADER_START:\n      if (!activeUpload) {\n        return {\n          ...state,\n          activeUpload: data\n        }\n      }\n      else {\n        return {\n          ...state,\n          store: [...store, data]\n        }\n      }\n    case Actions.UPLOADER_COMPLETE:\n      if (store.length === 0) {\n        return {\n          ...state,\n          activeUpload: null\n        }\n      }\n      else {\n        const newStore = [...store]\n        const newActive = newStore.pop()\n        return {\n          ...state,\n          store: newStore,\n          activeUpload: newActive\n        }\n      }\n    case Actions.UPLOADER_UPDATE_PROGRESS:\n      return {\n        ...state,\n        activeUpload: { ...activeUpload, ...data }\n      }\n    default:\n      return state\n  }\n}\n","import { combineReducers } from 'redux'\nimport map from './map'\nimport home from './home'\nimport uploader from './uploader'\n\nexport default combineReducers({ map, home, uploader })\n","import { createStore, applyMiddleware, compose } from 'redux'\nimport thunk from 'redux-thunk'\nimport rootReducer from './reducers'\nimport { persistStore, persistReducer } from 'redux-persist'\nimport storage from 'redux-persist/lib/storage' // defaults to localStorage for web\n\n// import api from '../middleware/api'\n// https://github.com/reduxjs/redux/blob/master/examples/real-world/src/middleware/api.js\n\nconst persistConfig = {\n  key: 'root',\n  storage\n}\n\nconst persistedReducer = persistReducer(persistConfig, rootReducer)\n\n/**\n * On Dev we want our devTools available\n */\nconst configureStoreDev = preloadedState => {\n  const { devToolsEnhancer } = require('redux-devtools-extension')\n  const { createLogger } = require('redux-logger')\n  const store = createStore(\n    persistedReducer,\n    preloadedState,\n    compose(\n      devToolsEnhancer(),\n      applyMiddleware(\n        thunk,\n        createLogger()\n      )\n    )\n  )\n  if (module.hot) {\n    // Enable Webpack hot module replacement for reducers\n    module.hot.accept('./reducers', () => {\n      store.replaceReducer(rootReducer)\n    })\n  }\n  return store\n}\n\n/**\n * Production gets a simpler more performant store:\n */\nconst configureStoreProd = preloadedState => {\n  const store = createStore(\n    persistedReducer,\n    preloadedState,\n    compose(\n      applyMiddleware(\n        thunk\n      )\n    )\n  )\n  return store\n}\n\nexport default () => {\n  const store = process.env.NODE_ENV === 'production' ? configureStoreProd() : configureStoreDev()\n  return {\n    store,\n    persistor: persistStore(store)\n  }\n}\n","import React from 'react'\nimport { PersistGate } from 'redux-persist/integration/react'\nimport { Provider } from 'react-redux'\nimport storeConfig from './storeConfig'\nimport Loading from '../components/auth/Loading'\n/**\n * In this example, 'store' is the configured Redux store and\n *'persist' is a function that returns a Promise to rehydrate the\n * Redux store using redux-persist\n *\n * FROM: https://medium.com/hexient-labs/redux-store-provider-hoc-3495281905c\n */\nconst withReduxProvider = BaseComponent => (props) => {\n  const { store, persistor } = storeConfig()\n  console.log('withReduxProvider', { props, store, persistor })\n  return (\n    <Provider store={store}>\n      <PersistGate loading={<Loading />} persistor={persistor}>\n        <BaseComponent {...props} />\n      </PersistGate>\n    </Provider>\n  )\n}\n\nexport default withReduxProvider\n","import React from 'react'\nimport classNames from 'classnames'\nimport PropTypes from 'prop-types'\nimport Paper from '@material-ui/core/Paper'\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport LinearProgress from '@material-ui/core/LinearProgress'\nimport Typography from '@material-ui/core/Typography'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n  root: {\n    background: 'black',\n    color: theme.palette.primary.contrastText,\n    padding: theme.spacing(1) * 2\n  },\n  message: {\n    // width: '100%'\n  },\n  msgText: {\n    display: 'flex'\n  },\n  spacer: {\n    flexGrow: 1\n  },\n  messageInner: {\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst UploadControlUnstyled = ({ className, text, progress }) => {\n  const classes = useStyles()\n  if (!text) return null\n  const message = `Uploading: ${text}`\n  return (\n    <div className={classNames(classes.root, className)}>\n      <div className={classes.messageInner}>\n        <div className={classes.msgText}>\n          <Typography color='inherit'>{message}</Typography>\n          <div className={classes.spacer} />\n          <Typography color='inherit'>{progress}%</Typography>\n        </div>\n        <LinearProgress color='secondary' variant='determinate' value={progress} />\n      </div>\n    </div>\n  )\n}\n\nUploadControlUnstyled.propTypes = {\n  className: PropTypes.string,\n  text: PropTypes.string,\n  progress: PropTypes.number\n}\n\nconst UploadControl = UploadControlUnstyled\nexport default UploadControl\n\nexport const UploadControlCOSMOSWrapper = ({ text, progress }) => {\n  // const [someStateItem, setSomeStateItem] = useState()\n  const classes = useWrapperStyles()\n  return (\n    <div className={classes.root}>\n      <CssBaseline /> {/* You only need this in a root element. Don't put it anywhere else in the dom */}\n      <Paper className={classes.paper}>\n        <Typography variant='h5'>\n          This is a dummy component.\n        </Typography>\n      </Paper>\n      <UploadControl text={text} progress={progress} />\n    </div>\n  )\n}\n\nUploadControlCOSMOSWrapper.propTypes = {\n  text: PropTypes.string,\n  progress: PropTypes.number\n}\nconst wrapperStyle = theme => ({\n  root: {\n    height: '100%',\n    display: 'flex',\n    flexDirection: 'column'\n  },\n  paper: {\n    flexGrow: 1\n  }\n})\n\nconst useWrapperStyles = makeStyles(wrapperStyle)\n\nUploadControlCOSMOSWrapper.displayName = UploadControl.displayName\nexport const UploadControlTest = UploadControlCOSMOSWrapper\n","import axios from 'axios'\nimport FormData from 'form-data'\n\n/**\n * DEbuggers for AXIOS\n */\naxios.interceptors.request.use(\n  request => {\n    console.log('AXIOS:::: Starting Request', request)\n    return request\n  },\n  err => {\n    console.log('AXIOS:::: Starting Request ERROR', err)\n    return Promise.reject(err)\n  }\n)\n\naxios.interceptors.response.use(\n  response => {\n    console.log('AXIOS:::: Response', response)\n    return response\n  },\n  err => {\n    console.log('AXIOS:::: Starting Response ERROR', err)\n    return Promise.reject(err)\n  }\n)\n\nexport default async function doUpload (activeUpload, updateUploadProgress, completeActiveUpload) {\n  console.log('UploadConntect: upload start', activeUpload)\n\n  // Initialising the HTML POST form for posting to S3 directly\n  let formData = new FormData()\n  // Take the auth credentials that we got from the backend and add them to our S3 POST\n  Object.keys(activeUpload.preAuth.fields).forEach(fieldkey => {\n    console.log('APPEND', fieldkey, activeUpload.preAuth.fields[fieldkey])\n    formData.append(fieldkey, activeUpload.preAuth.fields[fieldkey])\n  })\n  const file = dataURLtoFile(activeUpload.base64, 'a.png')\n  formData.append('file', file)\n\n  const config = {\n    headers: {\n      'Content-Type': 'multipart/form-data'\n    },\n    onUploadProgress: progressEvent => {\n      const { loaded, total } = progressEvent\n      // Do something with the progress details\n      console.log('PROGRESSEVENT', loaded, total, Math.floor(100 * loaded / total))\n      updateUploadProgress({ progress: Math.floor(100 * loaded / total) })\n    }\n  }\n\n  console.log('FORMDATA', formData)\n  // Upload file to S3\n  await axios.post(\n    activeUpload.preAuth.url,\n    formData,\n    config\n  ).catch(err => {\n    console.error(err)\n    console.log(err.stack)\n  })\n  console.log('UploadConntect: upload done')\n  completeActiveUpload()\n}\n\nfunction dataURLtoFile (dataurl, filename) {\n  var arr = dataurl.split(','); var mime = arr[0].match(/:(.*?);/)[1]\n\n  var bstr = atob(arr[1]); var n = bstr.length; var u8arr = new Uint8Array(n)\n  while (n--) {\n    u8arr[n] = bstr.charCodeAt(n)\n  }\n  return new File([u8arr], filename, { type: mime })\n}\n","import React, { useRef, useEffect } from 'react'\nimport PropTypes from 'prop-types'\nimport { connect } from 'react-redux'\nimport actions from '../redux/actions'\nimport UploadControl from '../components/UploadControl'\nimport s3Upload from '../lib/s3upload'\n\nconst UploadConntect = ({\n  activeUpload,\n  completeActiveUpload,\n  updateUploadProgress,\n  ...props\n}) => {\n  const uploadingRef = useRef()\n  useEffect(() => {\n    uploadingRef.current = uploadingRef.current && !!activeUpload\n\n    if (activeUpload && !uploadingRef.current) {\n      s3Upload(activeUpload, updateUploadProgress, completeActiveUpload)\n    }\n  }, [Boolean(activeUpload)])\n\n  if (!activeUpload) return null\n  return <UploadControl text={'Uploading thing'} progress={activeUpload.progress || 0} {...props} />\n}\nUploadConntect.propTypes = {\n  // All from redux\n  activeUpload: PropTypes.object,\n  completeActiveUpload: PropTypes.func.isRequired,\n  updateUploadProgress: PropTypes.func.isRequired\n}\n\n/**\n * Map our redux state and functions\n */\nconst mapStateToProps = (state, props) => {\n  const { activeUpload } = state.uploader\n  return { activeUpload }\n}\n\nconst mapDispatchToProps = dispatch => ({\n  completeActiveUpload: () => {\n    dispatch(actions.completeActiveUpload())\n  },\n  updateUploadProgress: (newProgress) => {\n    dispatch(actions.updateUploadProgress(newProgress))\n  }\n})\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(UploadConntect)\n","/**\n * Valid Roles are: admin, user, nonuser\n *\n * Valid Resources are: series, series_public, series_open, photo\n *\n * For more see:\n * https://docs.google.com/spreadsheets/d/1oXsZrsuyOSFs_tufRluSjQiR6OSTObWiGsKDUKb5vLk/edit#gid=0\n *\n * RTFM:\n * https://onury.io/accesscontrol/?content=guide#resources-and-resource-attributes\n */\nexport default {\n  // Admin is god. Be careful who you give this to.\n  admin: {\n    series: {\n      'create:own': ['*'],\n      'read:any': ['*'],\n      'update:any': ['*'],\n      'delete:any': ['*']\n    },\n    photo: {\n      'create:any': ['*'],\n      'read:any': ['*'],\n      'update:any': ['*'],\n      'delete:any': ['*']\n    }\n  },\n  // Logged out users can see public stuff but nothing esle\n  nonuser: {\n    photo: {\n      'read:any': ['*'],\n      'update:any': ['*'],\n      'delete:any': ['*']\n    },\n    series_public: {\n      'read:any': ['*']\n    },\n    series_open: {\n      'read:any': ['*']\n    }\n  },\n  // Users are the key permissions role in V0\n  // Note: we could inherit from user but we keep it explicit for now\n  user: {\n    series: {\n      'create:own': ['*'],\n      'read:own': ['*'],\n      'update:own': ['*'],\n      'delete:own': ['*']\n    },\n    series_public: {\n      'read:any': ['*']\n    },\n    series_open: {\n      'read:any': ['*'],\n      'update:any': ['photos']\n    },\n    photo: {\n      'read:any': ['*'],\n      'create:own': ['*'],\n      'update:own': ['*'],\n      'delete:own': ['*']\n    }\n  }\n}\n","import React, { useState, useRef } from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport SpeedDial from '@material-ui/lab/SpeedDial'\nimport SpeedDialAction from '@material-ui/lab/SpeedDialAction'\nimport { fade } from '@material-ui/core/styles/colorManipulator'\n\n// import useNewImageMenu from '../PhotoSeries/views/controls/useNewImageMenu'\nimport AddCameraIcon from '@material-ui/icons/AddAPhoto'\nimport PhotoLibraryIcon from '@material-ui/icons/PhotoLibrary'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst useStyles = makeStyles(theme => {\n  const pulseCol = fade(theme.palette.secondary.light, 0.4)\n  return {\n    root: {\n    },\n    speedDialFab: {\n      background: theme.palette.secondary.main,\n      color: theme.palette.secondary.contrastText,\n      boxShadow: `0 0 0 0 ${pulseCol}`,\n      animation: '$fabPulse 4s infinite'\n    },\n    '@keyframes fabPulse': {\n      '0%': {\n        boxShadow: `0 0 0 0 transparent`\n      },\n      '70%': {\n        boxShadow: `0 0 0 0px ${pulseCol}`\n      },\n      '100%': {\n        boxShadow: `0 0 0 10px transparent`\n      }\n    },\n    directionUp: {\n    },\n    actionsClosed: {\n      display: 'none'\n    }\n  }\n})\n\nconst AddFab = ({ className, children, onCameraClick, onLibraryClick }) => {\n  const [open, setOpen] = useState(false)\n  const [down, setDown] = useState(false)\n  const classes = useStyles()\n  // const theme = useTheme()\n  const downRef = useRef(down)\n  downRef.current = down\n\n  const startTimer = (el) => {\n    setDown(true)\n    if (!open) {\n      setTimeout(() => {\n        if (downRef.current) setOpen(true)\n      }, 300)\n    }\n  }\n\n  // const onUp = (e) => {\n  //   // console.log('onUp', e.currentTarget)\n  //   // setSeries(series)\n  //   setDown(false)\n  //   setOpen(false)\n  //   // onCameraClick()\n  // }\n\n  const onDown = (e) => {\n    // console.log('onDown', e.currentTarget)\n    // setSeries(series)\n    startTimer(e.currentTarget)\n  }\n\n  const block = (e) => {\n    if (e && e.stopPropagation) {\n      e.stopPropagation()\n      e.preventDefault()\n    }\n  }\n\n  return (\n    <div className={className}>\n      <SpeedDial\n        ariaLabel='SpeedDial photo adder'\n        onBlur={(e) => {\n          setTimeout(() => setOpen(false), 250)\n        }}\n        classes={{\n          directionUp: classes.directionUp,\n          actionsClosed: classes.actionsClosed,\n          root: classes.root,\n          fab: classNames(classes.speedDialFab, 'fabanimation')\n        }}\n        icon={children}\n        onClick={(e) => {\n          block(e)\n          setDown(false)\n          if (!open) {\n            console.log('cameraclick MAIN')\n            onCameraClick()\n          }\n        }}\n        onMouseDown={onDown}\n        // onMouseUp={onUp}\n        onTouchStart={onDown}\n        // onTouchEnd={onUp}\n\n        open={open}\n        direction='up'\n      >\n        <SpeedDialAction\n        // Bit of a hack here. This function isn't quite ready for primetime\n          icon={<AddCameraIcon className={classes.speedDialIcon} />}\n          tooltipPlacement='right'\n          tooltipTitle='From Camera'\n          tooltipOpen\n          onClick={(e) => {\n            console.log('cameraclick')\n            setOpen(false)\n            setDown(false)\n            onCameraClick()\n            block(e)\n          }}\n        />\n        <SpeedDialAction\n        // Bit of a hack here. This function isn't quite ready for primetime\n          icon={<PhotoLibraryIcon className={classes.speedDialIcon} />}\n          tooltipPlacement='right'\n          tooltipTitle='From Photo Library'\n          tooltipOpen\n          onClick={(e) => {\n            console.log('libraryClick')\n            setOpen(false)\n            setDown(false)\n            onLibraryClick()\n            block(e)\n          }}\n        />\n      </SpeedDial>\n    </div>\n\n  )\n}\n\nAddFab.propTypes = {\n  className: PropTypes.string,\n  children: PropTypes.any,\n  onCameraClick: PropTypes.func.isRequired,\n  onLibraryClick: PropTypes.func.isRequired\n}\n\nexport default AddFab\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Menu from '@material-ui/core/Menu'\nimport MenuItem from '@material-ui/core/MenuItem'\nimport ListItemIcon from '@material-ui/core/ListItemIcon'\nimport ListItemText from '@material-ui/core/ListItemText'\nimport Divider from '@material-ui/core/Divider'\n\n// import { Menu as MenuIcon } from '@material-ui/icons'\n\nconst ContextMenu = ({ anchorEl, onClose, menuItems }) => {\n  return (\n    <Menu\n      anchorEl={anchorEl}\n      open={!!anchorEl}\n      onClose={onClose}\n    >\n      {menuItems.map(({ icon, color, text, hide, disabled, action, divider }, idx) => {\n        const Icon = icon || null\n        if (hide) return null\n        if (divider) return <Divider key={`contextMenu-${idx}`} />\n        return (\n          <MenuItem\n            key={`contextMenu-${idx}`}\n            disabled={disabled}\n            onClick={() => {\n              onClose()\n              action()\n            }}>\n            {Icon && (\n              <ListItemIcon>\n                <Icon color={disabled ? 'disabled' : color} />\n              </ListItemIcon>\n            )}\n            <ListItemText primary={text} primaryTypographyProps={{ color }} />\n          </MenuItem>\n        )\n      })}\n    </Menu>\n  )\n}\n\nContextMenu.propTypes = {\n  anchorEl: PropTypes.object,\n  onClose: PropTypes.func,\n  menuItems: PropTypes.arrayOf(PropTypes.shape({\n    text: PropTypes.string,\n    icon: PropTypes.any,\n    divider: PropTypes.any,\n    hide: PropTypes.bool,\n    disabled: PropTypes.bool,\n    color: PropTypes.string,\n    action: PropTypes.func\n  }))\n}\n\nexport default ContextMenu\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\n\nimport Divider from '@material-ui/core/Divider'\nimport List from '@material-ui/core/List'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemText from '@material-ui/core/ListItemText'\nimport Typography from '@material-ui/core/Typography'\nimport FormLabel from '@material-ui/core/FormLabel'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport TagChip from '../tags/TagChip'\nimport style from './SeriesInfo.style'\n\nimport ShortLongText from '../controls/ShortLongText'\nimport BigText from '../dialogs/BigText'\nimport { formatDate } from '../../../../lib/datelib'\nimport SeriesConfigClass from '../../../../lib/SeriesConfig'\n\nconst DIALOGS = {\n  NOTEVIEW: 'NOTEVIEW'\n}\nconst useStyles = makeStyles(style)\n\nconst SeriesInfo = ({ seriesConfig, series }) => {\n  const classes = useStyles()\n  const seriesConfigInst = new SeriesConfigClass(seriesConfig)\n  const [activeDialog, setActiveDialog] = useState(null)\n  const newTags = series.photos.reduce((acc, { tags }) => {\n    tags.forEach(tag => {\n      if (!acc[tag.typeId]) {\n        acc[tag.typeId] = {\n          [tag.label]: { ...tag, count: 1 }\n        }\n      }\n      else if (acc[tag.typeId][tag.label]) {\n        const existing = acc[tag.typeId][tag.label]\n        acc[tag.typeId][tag.label] = { ...existing, count: existing.count + 1 }\n      }\n      else acc[tag.typeId][tag.label] = { ...tag, count: 1 }\n    })\n    return acc\n  }, {})\n\n  let metaKeys = []\n  try {\n    metaKeys = series.meta ? Object.keys(JSON.parse(series.meta)) : []\n  }\n  catch (e) {\n    console.error(e)\n  }\n\n  return (\n    <div className={classes.root}>\n      <div className={classes.field}>\n        <FormLabel className={classes.formLabel}>\n      Series Name\n        </FormLabel>\n        <Typography variant='body1' color='inherit'>\n          {series.name}\n        </Typography>\n      </div>\n      {series.note && (\n        <ShortLongText\n          label='Series Note'\n          text={series.note}\n          onClick={() => setActiveDialog(DIALOGS.NOTEVIEW)}\n        />\n      )}\n\n      <Typography className={classes.heading} variant='subtitle1'>Series Summary</Typography>\n      <Divider />\n      <List className={classes.list}>\n        <ListItem disableGutters>\n          <ListItemText\n            primary={`Photos: ${series.photos.length}`}\n            secondary={series.photos.length > 0 && (\n              <span>\n             First: {formatDate(series.photos[series.photos.length - 1].takenOn, 'lll')}\n                <br />\n             Latest: {formatDate(series.photos[0].takenOn, 'lll')}\n              </span>\n            )}\n          />\n        </ListItem>\n\n        <ListItem disableGutters>\n          <ListItemText>\n            <FormLabel className={classes.formLabel}>\n              Tags in use (across all photos)\n            </FormLabel>\n            <Divider />\n            {Object.keys(newTags).length === 0 && (\n              <Typography variant='caption'>No photos in this series have tags</Typography>\n            )}\n            {Object.keys(newTags).map((tagKey, idtk) => (\n              <div key={`tagchipkey${idtk}`} className={classes.tagListItem}>\n                <Typography className={classes.subheading} variant='overline'>{seriesConfigInst.getTagType(tagKey).label}</Typography>\n                <Divider />\n                {Object.values(newTags[tagKey]).length > 0\n                  ? (\n                    Object.values(newTags[tagKey]).map((tag, idx) => (\n                      <TagChip\n                        key={`tagchip-${idtk}-${idx}`}\n                        tag={tag}\n                        color={seriesConfigInst.getTagType(tagKey).color}\n                      />\n                    ))\n                  )\n                  : (\n                    <Typography variant='caption'>No photos in this series have tags</Typography>\n                  )\n                }\n              </div>\n            ))}\n          </ListItemText>\n        </ListItem>\n\n      </List>\n\n      {metaKeys.length > 0 && Object.keys(seriesConfig.meta).length > 0 && (\n        <React.Fragment>\n          <FormLabel className={classes.formLabel}>\n            Metadata\n          </FormLabel>\n          <Divider />\n          <List className={classes.list}>\n            {metaKeys.map((key, idx) => seriesConfig.meta[key] ? (\n              <ListItem key={`metadata${idx}`}>\n                <ListItemText\n                  primary={seriesConfig.meta[key].label}\n                  secondary={seriesConfig.meta[key].render(series.meta[key])}\n                />\n              </ListItem>\n            ) : null\n            )}\n          </List>\n        </React.Fragment>\n      )}\n      {activeDialog === DIALOGS.NOTEVIEW && (\n        <BigText\n          open\n          multiline\n          onClose={() => setActiveDialog(null)}\n          title='Series Note'\n          body={series.note}\n        />\n      )}\n    </div>\n  )\n}\n\nSeriesInfo.propTypes = {\n  seriesConfig: PropTypes.object.isRequired,\n  series: PropTypes.object.isRequired\n}\n\nexport default SeriesInfo\n","export default theme => ({\n  root: {\n    margin: theme.spacing(1),\n    backgroundColor: theme.palette.background.paper,\n    paddingBottom: 60 // a little extra room for the FAB\n\n  },\n  field: {\n    marginBottom: theme.spacing(1)\n  },\n  list: {\n    padding: theme.spacing(1)\n  },\n  heading: {\n    marginTop: theme.spacing(1)\n  },\n  tagListItem: {\n    marginTop: theme.spacing(1),\n    marginBottom: theme.spacing(2)\n  },\n  chip: {\n    margin: theme.spacing(0.5)\n  }\n})\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\n\nimport MobileStepper from '@material-ui/core/MobileStepper'\nimport IconButton from '@material-ui/core/IconButton'\nimport GridListTileBar from '@material-ui/core/GridListTileBar'\nimport Badge from '@material-ui/core/Badge'\n\nimport LabelIcon from '@material-ui/icons/Label'\n// import RemoveRedEye from '@material-ui/icons/RemoveRedEye'\nimport KeyboardArrowLeft from '@material-ui/icons/KeyboardArrowLeft'\nimport KeyboardArrowRight from '@material-ui/icons/KeyboardArrowRight'\n\nimport SwipeableViews from 'react-swipeable-views'\nimport Photo from './Photo'\nimport { formatDate } from '../../../../lib/datelib'\nimport { makeStyles, useTheme } from '@material-ui/core/styles'\nimport style from './SwipeShow.style'\n\nconst useStyles = makeStyles(style)\n\nconst SwipeShow = ({ photos, initialPhoto, onImageSelect }) => {\n  const classes = useStyles()\n  const theme = useTheme()\n  const initPhotoIndex = initialPhoto ? photos.findIndex(p => p.id === initialPhoto) || 0 : 0\n  const [activePhoto, setActivePhoto] = useState(initPhotoIndex >= 0 ? initPhotoIndex : 0)\n  const [showTags, setShowTags] = useState(false)\n  const singular = photos.length < 2\n\n  const sortedPhotos = [...photos]\n  sortedPhotos.sort((a, b) => parseInt(b.takenOn, 10) - parseInt(a.takenOn, 10))\n\n  const handleForward = () => setActivePhoto(activePhoto >= sortedPhotos.length ? 0 : activePhoto + 1)\n  const handleBack = () => setActivePhoto(activePhoto <= 0 ? sortedPhotos.length - 1 : activePhoto - 1)\n\n  return (\n    <div className={classes.root}>\n      <div className={classes.inner}>\n        <SwipeableViews\n          axis={theme.direction === 'rtl' ? 'x-reverse' : 'x'}\n          index={activePhoto}\n          onChangeIndex={(val) => setActivePhoto(val)}\n          enableMouseEvents\n        >\n          {sortedPhotos.map((photo, idx) => (\n            <div className={classes.photoWrapper} key={`swipeshowpic-${idx}`} onClick={() => onImageSelect(sortedPhotos[activePhoto].id)}>\n              <Photo photo={photo} className={classes.photo} showTags={showTags} />\n            </div>\n          ))}\n        </SwipeableViews>\n        <IconButton size='small' className={classes.manualBack} onClick={handleBack} color='inherit' disabled={activePhoto === 0}>\n          {theme.direction === 'rtl' ? <KeyboardArrowRight /> : <KeyboardArrowLeft />}\n        </IconButton>\n        <IconButton size='small' className={classes.manualForward} onClick={handleForward} color='inherit' disabled={activePhoto === photos.length - 1}>\n          {theme.direction === 'rtl' ? <KeyboardArrowLeft /> : <KeyboardArrowRight />}\n        </IconButton>\n        <GridListTileBar\n          title={singular ? 'Photo' : `Photo (${activePhoto + 1}/${sortedPhotos.length})`}\n          subtitle={sortedPhotos.length > 0 && (\n            <span>{formatDate(sortedPhotos[activePhoto].takenOn)}</span>\n          )}\n          actionIcon={\n            <React.Fragment>\n              <IconButton className={classes.tagButton} onClick={() => setShowTags(!showTags)}>\n                <Badge color={showTags ? 'primary' : 'secondary'} badgeContent={sortedPhotos[activePhoto].tags ? sortedPhotos[activePhoto].tags.filter(tag => tag.coords).length : null}>\n                  <LabelIcon />\n                </Badge>\n              </IconButton>\n            </React.Fragment>\n          }\n        />\n      </div>\n      {!singular &&\n      <MobileStepper\n        steps={sortedPhotos.length}\n        position='static'\n        activeStep={activePhoto}\n        classes={{\n          root: classes.mobileStepper,\n          dots: classes.dots\n        }}\n      />\n      }\n    </div>\n  )\n}\n\nSwipeShow.propTypes = {\n  // This is just the basic shape of the photo object\n  initialPhoto: PropTypes.string,\n  photos: PropTypes.arrayOf(PropTypes.shape({\n    img: PropTypes.string,\n    tags: PropTypes.array,\n    date: PropTypes.date\n  })),\n  transition: PropTypes.number,\n  onImageSelect: PropTypes.func.isRequired\n}\n\nSwipeShow.defaultProps = {\n  transition: 5000,\n  isFullScreen: false,\n  slides: []\n}\n\nexport default SwipeShow\n","export default theme => ({\n  root: {\n    position: 'relative'\n  },\n  inner: {\n    position: 'relative'\n  },\n  photoWrapper: {\n    minHeight: 250,\n    height: 250\n  },\n  dateCaption: {\n    padding: theme.spacing(1),\n    background: 'black',\n    color: 'white',\n    textAlign: 'center'\n  },\n  mobileStepper: {\n    // position: 'absolute',\n    // bottom: theme.spacing(1),\n    // right: theme.spacing(1)\n  },\n  manualBack: {\n    color: 'white',\n    zIndex: 10,\n    position: 'absolute',\n    transform: 'translateY(-50%)',\n    left: 0,\n    top: '50%'\n  },\n  manualForward: {\n    color: 'white',\n    zIndex: 10,\n    position: 'absolute',\n    transform: 'translateY(-50%)',\n    right: 0,\n    top: '50%'\n  },\n  tagButton: {\n    color: 'rgba(255, 255, 255, 0.54)'\n  },\n  slideshowButton: {\n    color: 'rgba(255, 255, 255, 0.54)'\n  },\n  dots: {\n    margin: '0 auto'\n  }\n})\n","export default theme => ({\n  root: {\n    display: 'flex',\n    height: '100%',\n    flexDirection: 'column',\n    overflow: 'hidden'\n  },\n  appBar: {\n    flexGrow: 0\n  },\n  inner: {\n    position: 'relative',\n    flexGrow: 1,\n    overflowY: 'scroll',\n    '-webkit-overflow-scrolling': 'touch'\n  },\n  tabMenu: {\n    marginTop: theme.spacing(7)\n  },\n  mapWrap: {\n    position: 'absolute',\n    height: '100%',\n    width: '100%',\n    top: 0,\n    left: 0\n  },\n  toolbarTitle: {\n    flexGrow: 1,\n    textOverflow: 'ellipsis',\n    whiteSpace: 'nowrap',\n    overflow: 'hidden'\n  },\n  AddFab: {\n    position: 'absolute',\n    bottom: theme.spacing(2),\n    right: theme.spacing(2),\n    // left: '50%',\n    // transformOrigin: '0% 50%',\n    // transform: 'translateY(-25%) translateX(-50%)',\n    zIndex: 3000\n  },\n  grow: {\n    flexGrow: 1\n  },\n  gridList: {\n    flexWrap: 'nowrap',\n    // Promote the list into his own layer on Chrome. This cost memory but helps keeping high FPS.\n    transform: 'translateZ(0)'\n  },\n  titleBar: {\n    display: 'flex',\n    padding: theme.spacing(1)\n  },\n  menuButton: {\n    // marginLeft: -12,\n    // marginRight: 20\n  }\n})\n","import React, { useState, useContext } from 'react'\nimport PropTypes from 'prop-types'\n\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport AppBar from '@material-ui/core/AppBar'\nimport Toolbar from '@material-ui/core/Toolbar'\nimport IconButton from '@material-ui/core/IconButton'\nimport Typography from '@material-ui/core/Typography'\nimport Tabs from '@material-ui/core/Tabs'\nimport Tab from '@material-ui/core/Tab'\n\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack'\n\nimport AddCameraIcon from '@material-ui/icons/AddAPhoto'\nimport MoreIcon from '@material-ui/icons/MoreVert'\n\nimport AddAlertIcon from '@material-ui/icons/AddAlert'\nimport SlideshowIcon from '@material-ui/icons/Slideshow'\nimport EditIcon from '@material-ui/icons/Edit'\nimport DeleteIcon from '@material-ui/icons/Delete'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport MapDot from '../../maps/MapDot'\nimport AddFab from './controls/AddFab'\n\nimport ContextMenu from './controls/ContextMenu'\n\nimport SeriesInfo from './subViews/SeriesInfo'\nimport SwipeShow from './subViews/SwipeShow'\nimport PhotoGrid from './subViews/PhotoGrid'\n\nimport DeleteDialog from './dialogs/DeleteDialog'\n\nimport { SeriesContext } from '../contexts'\n\nimport style from './SeriesView.style'\nconst useStyles = makeStyles(style)\n\nconst SeriesView = ({\n  onSlideshowStart, onChange,\n  onEditSeries, onDeletePhotos, onCameraAdd,\n  onDeleteSeries, onLibraryAdd, onTileClick, onMenuBack,\n  onWatch, onUnWatch, initialPhoto,\n  watching, owned\n}) => {\n  const classes = useStyles()\n  const [contextEl, setContextEl] = useState()\n  const [deleteConfirm, setDeleteConfirm] = useState(false)\n\n  const { series, seriesConfig, ac } = useContext(SeriesContext)\n\n  console.log('FINAL DEBUG', series)\n\n  const onDeleteConfirm = (confirmation) => {\n    setDeleteConfirm(false)\n    if (confirmation === true) onDeleteSeries(series.id)\n  }\n\n  const viewport = { zoom: 16 }\n  if (series && series.coords && series.coords.length === 2) {\n    viewport.longitude = series.coords[0]\n    viewport.latitude = series.coords[1]\n  }\n\n  const can = {\n    update: ac.canUser('update', series, 'series', '*'),\n    delete: ac.canUser('delete', series, 'series', '*'),\n    contribute: ac.canUser('update', series, 'series', ['photos'])\n  }\n\n  const [listTypeTab, setListTypeTab] = useState(0)\n  return (\n    <div className={classes.root}>\n      <CssBaseline />\n      <AppBar position='static' className={classes.appBar}>\n        <Toolbar disableGutters>\n          <IconButton className={classes.menuButton} color='inherit' onClick={onMenuBack} aria-label='Menu'>\n            <ArrowBackIcon />\n          </IconButton>\n          <Typography variant='subtitle1' color='inherit' className={classes.toolbarTitle}>\n            {series.name || 'Series'}\n          </Typography>\n\n          <IconButton className={classes.menuButton} color='inherit' onClick={onSlideshowStart} aria-label='Menu'>\n            <SlideshowIcon />\n          </IconButton>\n          <IconButton\n            aria-haspopup='true'\n            color='inherit'\n            onClick={event => setContextEl(event.currentTarget)}\n          >\n            <MoreIcon />\n          </IconButton>\n\n          <ContextMenu anchorEl={contextEl} onClose={() => setContextEl(null)} menuItems={[\n            {\n              text: 'Watch Series',\n              icon: AddAlertIcon,\n              hide: !onWatch || owned || watching,\n              action: onWatch\n            },\n            {\n              text: 'Unwatch Series',\n              icon: AddAlertIcon,\n              hide: !onUnWatch || owned || !watching,\n              action: onUnWatch\n            },\n            // {\n            //   text: 'Start Slideshow',\n            //   icon: SlideshowIcon,\n            //   hide: !onSlideshowStart,\n            //   action: onSlideshowStart\n            // },\n            { divider: true },\n            {\n              text: 'Edit Series',\n              icon: EditIcon,\n              hide: !onEditSeries || !can.update,\n              action: onEditSeries\n            },\n            {\n              text: 'Delete Series',\n              icon: DeleteIcon,\n              hide: !setDeleteConfirm || !can.delete,\n              color: 'error',\n              action: () => setDeleteConfirm(true)\n            }\n          ]} />\n        </Toolbar>\n        <Tabs variant='fullWidth'\n          value={listTypeTab}\n          onChange={(e, value) => setListTypeTab(value)}\n        >\n          <Tab label='Info' />\n          <Tab label='Map' />\n          <Tab label='Photos' />\n        </Tabs>\n      </AppBar>\n\n      <div className={classes.inner}>\n        {listTypeTab === 0 && (\n          <React.Fragment>\n            {series.photos && series.photos.length > 0 && (\n              <SwipeShow\n                photos={series.photos}\n                initialPhoto={initialPhoto}\n                onImageSelect={onTileClick}\n              />\n            )}\n            <SeriesInfo series={series} seriesConfig={seriesConfig} onChange={onChange} />\n          </React.Fragment>\n        )}\n        {series.photos && listTypeTab === 2 && (\n          <PhotoGrid\n            photos={series.photos}\n            onTileClick={onTileClick}\n            onDelete={onDeletePhotos}\n          />\n        )}\n      </div>\n\n      {listTypeTab === 1 && (\n        <MapDot\n          longitude={series.longitude}\n          latitude={series.latitude}\n          viewport={viewport}\n          direction={series.direction}\n        />\n      )}\n      {listTypeTab === 0 && can.contribute && (\n        <AddFab\n          className={classes.AddFab}\n          onCameraClick={onCameraAdd}\n          onLibraryClick={onLibraryAdd}\n        >\n          <AddCameraIcon />\n        </AddFab>\n      )}\n\n      <DeleteDialog\n        open={deleteConfirm}\n        onConfirm={onDeleteConfirm}\n        title='Delete Series'\n        message='Are you sure you want to delete this series? The record and all images associated with it will be gone forever.'\n      />\n    </div>\n  )\n}\n\nSeriesView.propTypes = {\n  initialPhoto: PropTypes.string,\n  watching: PropTypes.bool,\n  owned: PropTypes.bool,\n  // Action functions\n  onSlideshowStart: PropTypes.func.isRequired,\n  onChange: PropTypes.func.isRequired,\n  onDeletePhotos: PropTypes.func.isRequired,\n  onDeleteSeries: PropTypes.func.isRequired,\n  onCameraAdd: PropTypes.func.isRequired,\n  onEditSeries: PropTypes.func.isRequired,\n  onLibraryAdd: PropTypes.func.isRequired,\n  onTileClick: PropTypes.func.isRequired,\n  onMenuBack: PropTypes.func.isRequired,\n  onWatch: PropTypes.func.isRequired,\n  onUnWatch: PropTypes.func.isRequired\n}\n\nexport default SeriesView\n","\nimport React, { useState, useContext } from 'react'\nimport PropTypes from 'prop-types'\n\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport DialogActions from '@material-ui/core/DialogActions'\nimport Button from '@material-ui/core/Button'\nimport Typography from '@material-ui/core/Typography'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport { SeriesContext } from '../contexts'\n\nimport style from './SeriesEdit.style'\nimport SeriesEditInner from './subViews/SeriesEditInner'\n\nconst useStyles = makeStyles(style)\n\nconst SeriesEdit = ({ onOk, onCancel }) => {\n  const classes = useStyles()\n  const { series } = useContext(SeriesContext)\n  const [delta, setDelta] = useState({})\n\n  return (\n    <Dialog\n      scroll='paper'\n      className={classes.root}\n      fullScreen\n      open\n      fullWidth\n      onClose={onCancel}\n    >\n      <CssBaseline />\n      <DialogTitle disableTypography className={classes.dlgTitle}>\n        <Typography variant='subtitle1' color='inherit' className={classes.grow}>\n           Edit Series Details\n        </Typography>\n      </DialogTitle>\n      <DialogContent className={classes.inner}>\n        <SeriesEditInner\n          series={series}\n          delta={delta}\n          onChange={setDelta}\n        />\n      </DialogContent>\n      <DialogActions>\n        <Button className={classes.menuButton} color='inherit' onClick={() => setDelta({})} aria-label='Menu'>\n            Reset\n        </Button>\n        <Button className={classes.menuButton} color='inherit' onClick={onCancel} aria-label='Menu'>\n            Cancel\n        </Button>\n        <Button className={classes.menuButton} color='inherit' onClick={() => onOk({ id: series.id, ...delta })} aria-label='Menu'>\n            Ok\n        </Button>\n      </DialogActions>\n    </Dialog>\n  )\n}\n\nSeriesEdit.propTypes = {\n  // now some functions\n  onOk: PropTypes.func.isRequired,\n  onCancel: PropTypes.func.isRequired\n}\n\nexport default SeriesEdit\n","export default theme => ({\n  root: {\n\n  },\n  inner: {\n    display: 'flex',\n    flexDirection: 'column'\n    // padding: theme.spacing(1)\n  },\n  dlgTitle: {\n    background: theme.palette.primary.main,\n    color: theme.palette.primary.contrastText\n  },\n  grow: {\n    flexGrow: 1\n  },\n  field: {\n    flexGrow: 0,\n    marginBottom: theme.spacing(2)\n  },\n  slider: {\n    paddingLeft: theme.spacing(1),\n    paddingRight: theme.spacing(1)\n  },\n  textField: {\n    marginLeft: theme.spacing(1),\n    marginRight: theme.spacing(1),\n    width: '100%'\n  },\n  formLabel: {\n    display: 'block',\n    marginTop: theme.spacing(1),\n    marginBottom: theme.spacing(1)\n  },\n  mapFormLabel: {\n    display: 'block',\n    marginTop: theme.spacing(1),\n    marginBottom: theme.spacing(1)\n  },\n  mapInnerWrap: {\n    flexGrow: 1\n  },\n  mapWrapper: {\n    flexGrow: 1,\n    display: 'flex',\n    flexDirection: 'column',\n    paddingBottom: theme.spacing(2)\n  },\n  formControl: {\n    margin: theme.spacing(1),\n    minWidth: 120\n  },\n  chips: {\n    display: 'flex',\n    flexWrap: 'wrap'\n  }\n})\n","import React, { useState, useEffect, useRef } from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\n\nimport Badge from '@material-ui/core/Badge'\nimport Typography from '@material-ui/core/Typography'\nimport IconButton from '@material-ui/core/IconButton'\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport GridListTile from '@material-ui/core/GridListTile'\nimport GridListTileBar from '@material-ui/core/GridListTileBar'\nimport MobileStepper from '@material-ui/core/MobileStepper'\nimport Button from '@material-ui/core/Button'\n\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack'\nimport LabelIcon from '@material-ui/icons/Label'\nimport PauseIcon from '@material-ui/icons/PauseCircleFilled'\nimport PlayIcon from '@material-ui/icons/PlayCircleFilled'\nimport KeyboardArrowLeft from '@material-ui/icons/KeyboardArrowLeft'\nimport KeyboardArrowRight from '@material-ui/icons/KeyboardArrowRight'\n\nimport { makeStyles, useTheme } from '@material-ui/core/styles'\n\nimport Photo from './subViews/Photo'\nimport { formatDate } from '../../../lib/datelib'\nimport useComponentSize from '../../../lib/useComponentSize'\n\nimport style from './Slideshow.style'\n\nconst useStyles = makeStyles(style)\n\nconst Slideshow = ({ onCancel, photos, transition }) => {\n  const classes = useStyles()\n  const theme = useTheme()\n  const { activeStep, lastStep, handleForward, handleBack, paused, pause, play } = useStepper(photos.length, transition)\n  const [showXYTags, setShowXYTags] = useState(false)\n\n  const refImgWrap = useRef(null)\n  const { size: { height, width } } = useComponentSize(refImgWrap)\n\n  return (\n    <div className={classes.root}>\n      <CssBaseline />\n      <div ref={refImgWrap} className={classes.slideContainer}>\n        {photos.map((slide, idx) => (\n          <GridListTile\n            key={`slide-${idx}`}\n            className={classNames(\n              classes.slide,\n              activeStep === idx && classes.active,\n              lastStep === idx && classes.last\n            )}\n            onClick={() => setShowXYTags(!showXYTags)}\n            style={{\n              height,\n              width,\n              transition: theme.transitions.create(['opacity'], { duration: 1 / 4 * transition })\n            }}\n          >\n            <Photo photo={slide} className={classes.photo} showTags={showXYTags} />\n            <Typography className={classes.labelBadge} >\n            Tags: {showXYTags ? 'On ' : 'Off '}\n              <Badge color='secondary' badgeContent={photos[activeStep].tags.filter(tag => tag.coords).length}>\n                <LabelIcon color='inherit' />\n              </Badge>\n            </Typography>\n\n            <GridListTileBar\n              titlePosition='top'\n              title={(\n                <Typography color='inherit' variant='caption'>\n                  <IconButton className={classes.iconButton} onClick={(e) => onCancel()}>\n                    <ArrowBackIcon />\n                  </IconButton>\n                  {formatDate(slide.takenOn)}\n                </Typography>\n              )}\n              subtitle={<em>{paused ? 'Paused' : '    '}</em>}\n              actionIcon={paused ? (\n                <IconButton className={classes.iconButton} onClick={(e) => {\n                  e.preventDefault()\n                  e.stopPropagation()\n                  play()\n                }}>\n                  <PlayIcon />\n                </IconButton>\n              ) : (\n                <IconButton className={classes.iconButton} onClick={(e) => {\n                  e.preventDefault()\n                  e.stopPropagation()\n                  pause()\n                }}>\n                  <PauseIcon />\n                </IconButton>\n              )}\n            />\n          </GridListTile>\n        ))}\n        <IconButton size='small' className={classes.manualBack} onClick={handleBack} color='inherit'>\n          {theme.direction === 'rtl' ? <KeyboardArrowRight /> : <KeyboardArrowLeft />}\n        </IconButton>\n        <IconButton size='small' className={classes.manualForward} onClick={handleForward} color='inherit'>\n          {theme.direction === 'rtl' ? <KeyboardArrowLeft /> : <KeyboardArrowRight />}\n        </IconButton>\n      </div>\n\n      <MobileStepper\n        steps={photos.length}\n        position='static'\n        activeStep={activeStep}\n        classes={{\n          root: classes.mobileStepper,\n          dotActive: classes.dotActive\n        }}\n        nextButton={\n          <Button color='inherit' size='small' onClick={handleForward} disabled={activeStep === photos.length - 1}>\n            Next\n            {theme.direction === 'rtl' ? <KeyboardArrowLeft /> : <KeyboardArrowRight />}\n          </Button>\n        }\n        backButton={\n          <Button color='inherit' size='small' onClick={handleBack} disabled={activeStep === 0}>\n            {theme.direction === 'rtl' ? <KeyboardArrowRight /> : <KeyboardArrowLeft />}\n            Back\n          </Button>\n        }\n      />\n    </div>\n  )\n}\n\nSlideshow.propTypes = {\n  // We might want to go full screen\n  isFullScreen: PropTypes.bool,\n  // This is just the basic shape of the photo object\n  photos: PropTypes.array,\n  transition: PropTypes.number,\n  onCancel: PropTypes.func.isRequired\n}\n\nSlideshow.defaultProps = {\n  transition: 5000,\n  isFullScreen: false,\n  slides: []\n}\n\nexport default Slideshow\n\n/**\n * Custom React Hook for all our timer handling\n */\nconst useStepper = (num, interval) => {\n  const [activeStep, setActiveStep] = useState(0)\n  const [paused, setPaused] = useState(false)\n  const [lastStep, setLastStep] = useState(0)\n  const timerRef = useRef()\n\n  const handleForward = () => {\n    setLastStep(activeStep)\n    if (activeStep + 1 >= num) setActiveStep(0)\n    else setActiveStep(activeStep + 1)\n    if (!paused) {\n      destroyTimer()\n      createTimer()\n    }\n  }\n  const handleBack = () => {\n    setLastStep(activeStep)\n    if (activeStep - 1 < 0) setActiveStep(num - 1)\n    else setActiveStep(activeStep - 1)\n    if (!paused) {\n      destroyTimer()\n      createTimer()\n    }\n  }\n\n  const pause = () => {\n    destroyTimer()\n    setPaused(true)\n  }\n  const play = () => {\n    setPaused(false)\n    destroyTimer()\n    createTimer()\n  }\n\n  const createTimer = () => {\n    timerRef.current = window.setInterval(\n      // We need to use the alternate notation for the useState function\n      // because setInterval will only have access to the activeStep it was\n      // initialized with\n      () => setActiveStep(oldStep => {\n        setLastStep(oldStep)\n        return (oldStep + 1 >= num) ? 0 : oldStep + 1\n      })\n      , interval\n    )\n  }\n  const destroyTimer = () => {\n    if (timerRef.current) window.clearInterval(timerRef.current)\n  }\n\n  useEffect(() => {\n    createTimer()\n    return () => {\n      destroyTimer()\n    }\n  }, []) // Pass in empty array to run useEffect only on mount.\n\n  return { activeStep, lastStep, handleForward, handleBack, setActiveStep, paused, pause, play }\n}\n","export default theme => ({\n  root: {\n    // maxWidth: 400,\n    height: '100%',\n    display: 'flex',\n    flexDirection: 'column'\n  },\n  swipeAble: {\n    height: '100%'\n  },\n  slideContainer: {\n    flexGrow: 1\n  },\n  mobileStepper: {\n    flexGrow: 0,\n    background: theme.palette.grey[800],\n    color: theme.palette.getContrastText(theme.palette.grey[800])\n  },\n  slide: {\n    top: 0,\n    zIndex: 0,\n    opacity: 0,\n    position: 'absolute',\n    display: 'block',\n    overflow: 'hidden',\n    width: '100%',\n    height: '100%',\n    minHeight: 300\n  },\n  dotActive: {\n    background: 'white'\n  },\n  iconButton: {\n    color: 'white'\n  },\n  active: {\n    zIndex: 5,\n    opacity: 1\n  },\n  last: {\n    opacity: 1,\n    zIndex: 4\n  },\n  tagContainer: {\n\n  },\n  labelBadge: {\n    color: 'white',\n    zIndex: 10,\n    position: 'absolute',\n    right: theme.spacing(2),\n    bottom: theme.spacing(1),\n    opacity: 0.8\n  },\n  tagChip: {\n    // height: theme.spacing(3),\n    marginRight: theme.spacing(1),\n    fontSize: 10,\n    height: theme.spacing(2),\n    padding: theme.spacing(0.5)\n  },\n  xyTagChip: {\n    position: 'absolute',\n    fontSize: theme.spacing(1),\n    height: theme.spacing(2)\n  },\n  manualBack: {\n    color: 'white',\n    zIndex: 10,\n    position: 'absolute',\n    transform: 'translateY(-50%)',\n    left: 0,\n    top: '50%'\n  },\n  manualForward: {\n    color: 'white',\n    zIndex: 10,\n    position: 'absolute',\n    transform: 'translateY(-50%)',\n    right: 0,\n    top: '50%'\n  }\n})\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Dialog from '@material-ui/core/Dialog'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport Button from '@material-ui/core/Button'\nimport Typography from '@material-ui/core/Typography'\nimport DialogActions from '@material-ui/core/DialogActions'\n\n// import MenuIcon from '@material-ui/icons/MenuIcon'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst style = theme => ({\n\n})\n\nconst useStyles = makeStyles(style)\n\nconst CancelConfirm = ({ title, message, onConfirm, open }) => {\n  const classes = useStyles()\n  return (\n    <Dialog\n      className={classes.root}\n      disableBackdropClick\n      fullWidth\n      open={open}\n      disableEscapeKeyDown\n      maxWidth='xl'\n      aria-labelledby='confirmation-dialog-title'\n    >\n      <DialogTitle id='confirmation-dialog-title'>{title}</DialogTitle>\n      <DialogContent>\n        <Typography>\n          {message}\n        </Typography>\n\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={() => onConfirm(false)} color='primary'>\n      No\n        </Button>\n        <Button onClick={() => onConfirm(true)} color='secondary'>\n      Yes\n        </Button>\n      </DialogActions>\n    </Dialog>\n  )\n}\n\nCancelConfirm.propTypes = {\n  open: PropTypes.bool,\n  title: PropTypes.string.isRequired,\n  message: PropTypes.string.isRequired,\n  onConfirm: PropTypes.func.isRequired\n}\n\nexport default CancelConfirm\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\n\nimport Button from '@material-ui/core/Button'\nimport Dialog from '@material-ui/core/Dialog'\nimport IconButton from '@material-ui/core/IconButton'\nimport DialogTitle from '@material-ui/core/DialogTitle'\nimport DialogContent from '@material-ui/core/DialogContent'\nimport Typography from '@material-ui/core/Typography'\nimport DialogActions from '@material-ui/core/DialogActions'\n\nimport CloseIcon from '@material-ui/icons/Close'\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport CancelConfirm from '../dialogs/CancelConfirm'\n\nimport PhotoInfoInner from './PhotoInfoInner'\n\nconst style = theme => ({\n  root: {\n    height: '90%',\n    width: '85%'\n  },\n  dlgTitleContainer: {\n    display: 'flex',\n    padding: 0\n  },\n  dlgTitle: {\n    flexGrow: 1,\n    paddingTop: theme.spacing(2),\n    paddingBottom: theme.spacing(1),\n    paddingLeft: theme.spacing(3)\n  },\n  field: {\n    marginBottom: theme.spacing(2)\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst DIALOGS = {\n  NOTEEDIT: 'noteEdit',\n  NOTEVIEW: 'noteView',\n  PHOTOTAKEN: 'taken',\n  TAGEDIT: 'tag',\n  CANCEL: 'cancel'\n}\n\nconst PhotoInfo = ({ canEdit, photo, onCancel, onOk, open }) => {\n  const classes = useStyles()\n  const [activeDialog, setActiveDialog] = useState(null)\n  const [delta, setDelta] = useState({})\n\n  const dirty = delta && Object.keys(delta).length > 0\n\n  return (\n    <Dialog\n      fullScreen\n      fullWidth\n      onClose={() => {\n        if (dirty) setActiveDialog(DIALOGS.CANCEL)\n        else onCancel()\n      }}\n      aria-labelledby='customized-dialog-title'\n      open={open}\n    >\n      <DialogTitle disableTypography className={classes.dlgTitleContainer}>\n        <Typography variant='h5' className={classes.dlgTitle}>\n          Photo Properties\n        </Typography>\n        <IconButton onClick={onCancel}>\n          <CloseIcon />\n        </IconButton>\n      </DialogTitle>\n      <DialogContent>\n        <PhotoInfoInner\n          photo={photo}\n          delta={delta}\n          onChange={newDelta => setDelta({ ...delta, ...newDelta })}\n          canEdit={canEdit}\n        />\n      </DialogContent>\n\n      <DialogActions>\n        {!canEdit && (\n          <Button onClick={onCancel} color='primary'>\n            Ok\n          </Button>\n        )}\n        {canEdit && !dirty && (\n          <Button onClick={onCancel} color='primary'>\n            Back\n          </Button>\n        )}\n        {canEdit && dirty && (\n          <React.Fragment>\n            <Button onClick={() => setActiveDialog(DIALOGS.CANCEL)} color='primary'>\n              Cancel\n            </Button>\n            <Button onClick={() => setDelta({})} color='primary'>\n              Reset\n            </Button>\n            <Button onClick={() => onOk(delta)} color='primary'>\n              Ok\n            </Button>\n          </React.Fragment>\n        )}\n      </DialogActions>\n      {activeDialog && activeDialog === DIALOGS.CANCEL && (\n        <CancelConfirm\n          open\n          title='Lose unsaved changes?'\n          message='You will lose any changes you made to this form'\n          onConfirm={confirm => {\n            setActiveDialog(null)\n            if (confirm) onCancel()\n          }}\n        />\n      )}\n    </Dialog>\n  )\n}\n\nPhotoInfo.propTypes = {\n  canEdit: PropTypes.bool,\n  onCancel: PropTypes.func.isRequired,\n  onOk: PropTypes.func.isRequired,\n  open: PropTypes.bool,\n  photo: PropTypes.object.isRequired\n}\n\nexport default PhotoInfo\n","import React, { useState, useContext } from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\n\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport Button from '@material-ui/core/Button'\nimport MobileStepper from '@material-ui/core/MobileStepper'\nimport Typography from '@material-ui/core/Typography'\nimport AppBar from '@material-ui/core/AppBar'\nimport Toolbar from '@material-ui/core/Toolbar'\nimport IconButton from '@material-ui/core/IconButton'\nimport Badge from '@material-ui/core/Badge'\nimport Chip from '@material-ui/core/Chip'\n\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack'\nimport InfoIcon from '@material-ui/icons/Info'\nimport LabelIcon from '@material-ui/icons/Label'\n\nimport { makeStyles, useTheme } from '@material-ui/core/styles'\n\nimport PhotoInfo from './subViews/PhotoInfo'\nimport Photo from './subViews/Photo'\n\nimport { formatDate } from '../../../lib/datelib'\nimport Tags from '../../../lib/Tags'\nimport SwipeableViews from 'react-swipeable-views'\nimport { SeriesContext } from '../contexts'\n\nimport style from './PhotoViewTool.style'\nconst useStyles = makeStyles(style)\n\nconst STATES = {\n  VIEWPIC: 0,\n  SHOWINFO: 1,\n  SHOWTAGS: 2,\n  EDITTAGS: 3,\n  FIRSTAGEDIT: 4\n}\n\nconst PhotoViewTool = ({ photos, initPhotoId, onMenuBack, onUpdatePhoto, newPhoto }) => {\n  const classes = useStyles()\n  const theme = useTheme()\n  const { series, seriesConfig, ac } = useContext(SeriesContext)\n  const [activePhoto, setActivePhoto] = useState(initPhotoId ? photos.findIndex(p => p.id === initPhotoId) : 0)\n  // This is a special copy of the photo so we can play around with the XY tags and undo\n  // if we need to\n  const photo = photos[activePhoto]\n  const [delta, setDelta] = useState(newPhoto ? photo : {})\n  const [mode, setMode] = useState({\n    current: newPhoto ? STATES.FIRSTAGEDIT : STATES.VIEWPIC,\n    last: null\n  })\n\n  const tagsClass = new Tags(seriesConfig, delta.tags || photo.tags)\n\n  const changeMode = (desired) => {\n    setMode({ current: desired, last: mode.current })\n  }\n\n  const onCommitTags = () => {\n    changeMode(STATES.SHOWTAGS)\n    onUpdatePhoto(photo, { id: photo.id, ...delta })\n  }\n\n  const onCommitTagsFirst = () => {\n    onUpdatePhoto(photo, { id: photo.id, ...delta })\n    onMenuBack()\n  }\n\n  const onCancelTagEdit = () => {\n    changeMode(STATES.SHOWTAGS)\n    setDelta(photo)\n  }\n\n  const photoClick = (e) => {\n    if (mode.current === STATES.VIEWPIC) {\n      e.preventDefault()\n      e.stopPropagation()\n      changeMode(STATES.SHOWINFO)\n    }\n  }\n\n  const can = {\n    update: ac.canUser('update', series, 'series') ||\n            ac.canUser('update', photo, 'photo')\n  }\n\n  const sortedPhotos = [...photos]\n  sortedPhotos.sort((a, b) => parseInt(b.takenOn, 10) - parseInt(a.takenOn, 10))\n\n  return (\n    <div className={classes.root}>\n      <CssBaseline /> {/* You only need this in a root element. Don't put it anywhere else in the dom */}\n      <AppBar position='static' className={classNames(classes.appBar, mode.current !== STATES.VIEWPIC ? classes.appBarEdit : null)}>\n        <Toolbar>\n          {mode.current !== STATES.FIRSTAGEDIT && (\n            <IconButton\n              className={classes.menuButton}\n              color='inherit'\n              aria-label='Menu'\n              onClick={() => onMenuBack()}\n            >\n              <ArrowBackIcon />\n            </IconButton>\n          )}\n          <div className={classes.grow}>\n            <Typography variant='subtitle2' color='inherit' >\n              {newPhoto ? 'Add Tags' : `Photo View (${activePhoto + 1}/${photos.length})`}\n            </Typography>\n            <Typography variant='subtitle2' color='inherit'>\n              {formatDate(photo.takenOn, 'lll')}\n            </Typography>\n          </div>\n\n          { mode.current === STATES.EDITTAGS &&\n          <Button color='inherit' onClick={onCancelTagEdit}>\n            Cancel\n          </Button>\n          }\n\n          { mode.current === STATES.EDITTAGS &&\n          <Button color='inherit' onClick={onCommitTags}>\n            Save\n          </Button>\n          }\n          { mode.current === STATES.FIRSTAGEDIT &&\n          <Button color='inherit' onClick={onCommitTagsFirst}>\n            Next\n          </Button>\n          }\n\n          { can.update && mode.current === STATES.SHOWTAGS &&\n          <Button color='inherit' onClick={() => changeMode(STATES.EDITTAGS)}>\n            Edit\n          </Button>\n          }\n\n          { (mode.current !== STATES.EDITTAGS && mode.current !== STATES.FIRSTAGEDIT) &&\n          <IconButton color='inherit'\n            className={classNames(classes.tagButton, mode.current === STATES.SHOWTAGS && classes.activeButton)}\n            onClick={() => changeMode(mode.current === STATES.SHOWTAGS ? STATES.VIEWPIC : STATES.SHOWTAGS)}\n          >\n            <Badge className={classes.margin} badgeContent={tagsClass.getXYTags().length} color='primary'>\n              <LabelIcon />\n            </Badge>\n          </IconButton>\n          }\n\n          { (mode.current !== STATES.EDITTAGS && mode.current !== STATES.FIRSTAGEDIT) &&\n          <IconButton color='inherit'\n            className={classNames(classes.infoButton, mode.current === STATES.SHOWINFO && classes.activeButton)}\n            onClick={() => changeMode(mode.current === STATES.SHOWINFO ? STATES.VIEWPIC : STATES.SHOWINFO)}\n          >\n            <InfoIcon />\n          </IconButton>\n          }\n\n        </Toolbar>\n      </AppBar>\n      <div className={classes.inner} onClick={photoClick}>\n        <SwipeableViews\n          axis={theme.direction === 'rtl' ? 'x-reverse' : 'x'}\n          index={activePhoto}\n          containerStyle={{ height: '100%' }}\n          style={{ height: '100%' }}\n          disabled={mode.current !== STATES.VIEWPIC}\n          onChangeIndex={(val) => setActivePhoto(val)}\n          enableMouseEvents\n        >\n          {sortedPhotos.map((photoidx, idx) => (\n            <div className={classes.photoWrapper} key={`swipeshowpic-${idx}`}>\n              <Photo\n                showTags={mode.current === STATES.SHOWTAGS}\n                photo={{ ...photoidx, ...delta }}\n                edit={can.update && (mode.current === STATES.EDITTAGS || mode.current === STATES.FIRSTAGEDIT)}\n                onChange={setDelta}\n                onCommitTags={onCommitTags}\n              />\n            </div>\n          ))}\n        </SwipeableViews>\n\n        {mode.current === STATES.VIEWPIC && (\n          <MobileStepper\n            steps={sortedPhotos.length}\n            position='bottom'\n            activeStep={activePhoto}\n            classes={{\n              root: classes.mobileStepper,\n              dots: classes.dots,\n              dot: classes.dot,\n              dotActive: classes.dotActive\n            }}\n          />\n        )}\n      </div>\n      <PhotoInfo\n        open={mode.current === STATES.SHOWINFO}\n        photo={photo}\n        canEdit={can.update}\n        onOk={(newDelta) => {\n          onUpdatePhoto(photo, { id: photo.id, ...newDelta })\n          changeMode(mode.last)\n        }}\n        onCancel={() => changeMode(mode.last)}\n      />\n      { (mode.current === STATES.EDITTAGS || mode.current === STATES.FIRSTAGEDIT) && (\n        <Chip\n          label='Tap to tag features...'\n          onClick={() => {}}\n          className={classes.tipChip}\n        />\n      )}\n    </div>\n  )\n}\n\nPhotoViewTool.propTypes = {\n  photos: PropTypes.array.isRequired,\n  initPhotoId: PropTypes.string,\n  newPhoto: PropTypes.bool,\n  // Now some action functions\n  onMenuBack: PropTypes.func.isRequired,\n  onUpdatePhoto: PropTypes.func.isRequired\n}\n\nexport default PhotoViewTool\n","export default theme => ({\n  root: {\n    display: 'flex',\n    height: '100%',\n    flexDirection: 'column',\n    overflow: 'hidden'\n  },\n  appBar: {\n    flexGrow: 0\n  },\n  appBarEdit: {\n    color: theme.palette.secondary.contrastText,\n    background: theme.palette.secondary.main\n  },\n  grow: {\n    flexGrow: 1\n  },\n  photoWrapper: {\n    height: '100%'\n  },\n  inner: {\n    flex: '1 1',\n    position: 'relative'\n  },\n  tabMenu: {\n    marginTop: theme.spacing(7)\n  },\n  tipChip: {\n    position: 'absolute',\n    zIndex: 11,\n    bottom: 20,\n    left: '50%',\n    opacity: 0.6,\n    transform: 'translateX(-50%)'\n  },\n  mobileStepper: {\n    background: 'none'\n  },\n  dots: {\n    margin: '0 auto'\n  },\n  dot: {\n    border: '1px solid #FFFFFF77'\n  },\n  dotActive: {\n    background: theme.palette.secondary.main\n  },\n  // tagButton: {\n  //   zIndex: 10,\n  //   color: 'white',\n  //   position: 'absolute',\n  //   fontSize: '2.5rem',\n  //   top: 10,\n  //   left: 10,\n  //   opacity: 0.8\n  // },\n  // infoButton: {\n  //   zIndex: 10,\n  //   color: 'white',\n  //   position: 'absolute',\n  //   top: 10,\n  //   right: 10,\n  //   opacity: 0.8\n  // },\n  activeButton: {\n    color: theme.palette.secondary.main,\n    opacity: 1\n  }\n})\n","import AccessControl from 'accesscontrol'\n\nclass AccessHelper {\n  constructor (userSub, role, permissionObj) {\n    this.userSub = userSub\n    this.role = role\n    this.permissionObj = permissionObj\n    this.ac = new AccessControl(permissionObj)\n  }\n\n  // Return the string 'Own' or the string 'Any'\n  ownOrAny = (obj) => {\n    if (!obj || !obj.createdUser || !obj.createdUser.id) throw new Error(`No Created user found`)\n    try {\n      return obj.createdUser.id === this.userSub ? 'Own' : 'Any'\n    }\n    catch (e) {\n      return 'Any'\n    }\n  }\n\n  isOwner = (obj) => {\n    if (!obj || !obj.createdUser || !obj.createdUser.id) throw new Error(`No Created user found`)\n    try {\n      return obj.createdUser.id === this.userSub\n    }\n    catch (e) {\n      return false\n    }\n  }\n\n  toString () {\n    console.log('AccessHelper:', { sub: this.userSub, role: this.role })\n  }\n\n  canUser = (action, obj, type, attrs) => {\n    if (['series', 'photo'].indexOf(type) < 0) throw new Error(`canUser: type not supported ${type}`)\n\n    try {\n      const ownAny = this.ownOrAny(obj)\n\n      const perm = this.ac.can(this.role)[`${action}${ownAny}`](type)\n      let otherPerm = null\n      if (type === 'series') {\n        if (obj.access === 'PUBLIC') otherPerm = this.ac.can(this.role)[`${action}${ownAny}`]('series_public')\n        else if (obj.access === 'OPEN') otherPerm = this.ac.can(this.role)[`${action}${ownAny}`]('series_open')\n      }\n\n      // Trying to recreate the form `can(role).readAny`\n      if (attrs) {\n        if (otherPerm) {\n          return !!perm.attributes.find(p => p === '*' || attrs.indexOf(p) > -1) ||\n           !!otherPerm.attributes.find(p => p === '*' || attrs.indexOf(p) > -1)\n        }\n        else return !!perm.attributes.find(p => p === '*' || attrs.indexOf(p) > -1)\n      }\n      else {\n        if (otherPerm) return perm.granted || otherPerm.granted\n        else return perm.granted\n      }\n    }\n    catch (e) {\n      console.error(e)\n      return false\n    }\n  }\n}\n\nexport default AccessHelper\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport AppBar from '@material-ui/core/AppBar'\nimport Toolbar from '@material-ui/core/Toolbar'\nimport IconButton from '@material-ui/core/IconButton'\nimport Typography from '@material-ui/core/Typography'\n\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport style from './SeriesView.style'\nconst useStyles = makeStyles(style)\n\nconst SeriesNotFound = ({ onMenuBack }) => {\n  const classes = useStyles()\n\n  return (\n    <div className={classes.root}>\n      <CssBaseline />\n      <AppBar position='static' className={classes.appBar}>\n        <Toolbar disableGutters>\n          <IconButton className={classes.menuButton} color='inherit' onClick={onMenuBack} aria-label='Menu'>\n            <ArrowBackIcon />\n          </IconButton>\n          <Typography variant='subtitle1' color='inherit' className={classes.toolbarTitle}>\n            'Not Found'\n          </Typography>\n        </Toolbar>\n      </AppBar>\n\n      <div className={classes.inner}>\n        <Typography className={classes.notFound}>Series Not Found</Typography>\n      </div>\n    </div>\n  )\n}\n\nSeriesNotFound.propTypes = {\n  // Action functions\n  onMenuBack: PropTypes.func.isRequired\n}\n\nexport default SeriesNotFound\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport AppBar from '@material-ui/core/AppBar'\nimport Toolbar from '@material-ui/core/Toolbar'\nimport IconButton from '@material-ui/core/IconButton'\nimport Typography from '@material-ui/core/Typography'\n\nimport ArrowBackIcon from '@material-ui/icons/ArrowBack'\n\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport style from './SeriesView.style'\nconst useStyles = makeStyles(style)\n\nconst SeriesLoading = ({ onMenuBack }) => {\n  const classes = useStyles()\n\n  return (\n    <div className={classes.root}>\n      <CssBaseline />\n      <AppBar position='static' className={classes.appBar}>\n        <Toolbar disableGutters>\n          <IconButton className={classes.menuButton} color='inherit' onClick={onMenuBack} aria-label='Menu'>\n            <ArrowBackIcon />\n          </IconButton>\n          <Typography variant='subtitle1' color='inherit' className={classes.toolbarTitle}>\n            'Not Found'\n          </Typography>\n        </Toolbar>\n      </AppBar>\n\n      <div className={classes.inner}>\n        <Typography className={classes.notFound}>Series Loading...</Typography>\n      </div>\n    </div>\n  )\n}\n\nSeriesLoading.propTypes = {\n  // Action functions\n  onMenuBack: PropTypes.func.isRequired\n}\n\nexport default SeriesLoading\n","import React, { useState, useEffect } from 'react'\nimport PropTypes from 'prop-types'\n\nimport SeriesView from './views/SeriesView'\nimport SeriesEdit from './views/SeriesEdit'\nimport Slideshow from './views/Slideshow'\nimport PhotoViewTool from './views/PhotoViewTool'\nimport NewPhoto from './views/NewPhoto'\n\nimport AccesHelper from '../../lib/AccessHelper'\n\nimport { SeriesContext } from './contexts'\nimport SeriesNotFound from './views/SeriesNotFound'\nimport SeriesLoading from './views/SeriesLoading'\n\nexport const MODES = {\n  SERIES_VIEW: 'series',\n  SERIES_EDIT: 'editseries',\n  NEWPHOTO: 'newphoto',\n  NEWSERIES: 'newseries',\n  REVIEW: 'review',\n  PHOTO_VIEW: 'photoviewer',\n  PHOTO_VIEW_NEW: 'newphotoviewer',\n  SLIDESHOW: 'slideshow'\n}\nconst VIEW_ONLY_MODES = [MODES.SERIES_VIEW, MODES.PHOTO_VIEW, MODES.SLIDESHOW]\nconst VALID_STARTMODES = [MODES.SERIES_VIEW, MODES.NEWPHOTO, MODES.NEWSERIES, MODES.PHOTO_REVIEW, MODES.PHOTO_VIEW]\n\n/**\n * This component ties all the Repeat Photo components together\n */\nconst RepeatablePhotos = ({\n  modeName, series, seriesConfig, inputMethod: inputMethodINIT,\n  currentUserId, currentUserRole, accessControl, initialPhoto,\n  onChange, onClose, onDelete, onNewSeries, onChangePhoto,\n  onNewPhoto, onDeletePhoto, loading,\n  onWatch, onUnWatch, watching, owned\n}) => {\n  // Manage view modes separately\n  // This is a pretty normal pattern for context\n  const [seriesState, setState] = useState({\n    series,\n    seriesConfig,\n    ac: accessControl ? new AccesHelper(currentUserId, currentUserRole, accessControl) : null\n  })\n  const [mode, setMode] = useState({\n    current: {\n      name: modeName || MODES.SERIES_VIEW,\n      pid: initialPhoto,\n      inputMethod: inputMethodINIT\n    },\n    history: []\n  })\n  // console.log('RepeatablePhotos', state)\n\n  useEffect(() => setState({ ...seriesState, series }), [series])\n\n  // When anything changes about a photo\n  const onUpdatePhoto = (photo, photoDelta) => {\n    const newSeries = { ...seriesState.series }\n    newSeries.photos = newSeries.photos.map(ph => ph.id === photoDelta.id ? { ...ph, ...photoDelta } : ph)\n    onChangePhoto(photo, { ...photoDelta, seriesId: newSeries.id })\n  }\n\n  const onApprovePhoto = async ({ photo: photoDelta, series: seriesDelta }) => {\n    const newSeries = {\n      ...series,\n      photos: [...series.photos, photoDelta]\n    }\n    await onNewPhoto(photoDelta)\n    // THIS SEEMS A LITTLE HACKY BUT GO WITH IT FOR NOW\n    setState({ ...seriesState, series: newSeries })\n    changeMode(MODES.PHOTO_VIEW_NEW, photoDelta.id)\n  }\n\n  const onCreateSeries = async ({ photo: photoDelta, series: seriesDelta }) => {\n    console.log('RepeatablePhotos: waiting for series ID', { seriesDelta, photoDelta })\n    const onNewSeriesReturn = await onNewSeries(seriesDelta, photoDelta)\n    console.log('RepeatablePhotos: waiting for series ID DONE', onNewSeriesReturn)\n  }\n\n  // When a photo is removed\n  const onDeletePhotos = (photoIdArr) => {\n    series.photos.filter(sp => photoIdArr.indexOf(sp.id) > -1).forEach(p => onDeletePhoto(p))\n  }\n\n  // Here's our modeChanger. My guess it will get a lot more complicated\n  // once the reducers get in and working\n  const changeMode = (newModeName, newPid, newInputMethod) => {\n    const canUpdate = seriesState.ac.canUser('update', series, 'series')\n    if (seriesState === null) onClose()\n    if (!canUpdate && VIEW_ONLY_MODES.indexOf(newModeName) < 0) {\n      console.error('ILLEGAL MODE CHANGE!!!!!', { from: mode.current, to: newModeName, canUpdate })\n    }\n    else {\n      // console.log('CHANGING MODE TO', newModeName)\n      setMode({\n        current: {\n          name: newModeName,\n          pid: newPid,\n          inputMethod: newInputMethod\n        },\n        history: [...mode.history, mode.current]\n      })\n    }\n  }\n  const lastMode = () => {\n    // console.log('REPEATABLEPHOTOS lastMode', mode)\n    if (mode.history.length > 0) {\n      const oldHistory = [...mode.history]\n      const oldMode = oldHistory.pop()\n      setMode({\n        current: oldMode,\n        history: oldHistory\n      })\n    }\n    else {\n      onClose()\n    }\n  }\n\n  // The action to initiate the photo viewer\n  const viewPhoto = (pid) => {\n    // console.log('DEBUG', mode, series.photos.find(p => p.id === pid))\n    changeMode(MODES.PHOTO_VIEW, pid)\n  }\n\n  let component = null\n\n  if (loading) return <SeriesLoading onMenuBack={onClose} />\n  else if (!seriesState.series) return <SeriesNotFound onMenuBack={onClose} />\n\n  switch (mode.current.name) {\n    case MODES.SERIES_VIEW:\n      component = (\n        <SeriesView\n          // This one has lots of functionsgit add\n          onSlideshowStart={() => changeMode(MODES.SLIDESHOW)}\n          onChange={() => {\n            console.log('onChange NOT IMPLEMENTED')\n          }}\n          watching={watching}\n          owned={owned}\n          initialPhoto={initialPhoto}\n          onDeletePhotos={onDeletePhotos}\n          onDeleteSeries={onDelete}\n          onCameraAdd={() => changeMode(MODES.NEWPHOTO, null, 'camera')}\n          onEditSeries={() => changeMode(MODES.SERIES_EDIT)}\n          onLibraryAdd={() => changeMode(MODES.NEWPHOTO, null, 'library')}\n          onTileClick={viewPhoto}\n          onMenuBack={onClose}\n          onWatch={onWatch}\n          onUnWatch={onUnWatch}\n        />\n      )\n      break\n    case MODES.SERIES_EDIT:\n      component = (\n        <SeriesEdit\n          onCancel={() => changeMode(MODES.SERIES_VIEW)}\n          onOk={(seriesDelta) => {\n            onChange(series, { ...seriesDelta, id: series.id })\n            changeMode(MODES.SERIES_VIEW)\n          }}\n        />\n      )\n      break\n    case MODES.PHOTO_VIEW:\n      component = (\n        <PhotoViewTool\n          photos={seriesState.series.photos}\n          initPhotoId={mode.current.pid}\n          onMenuBack={lastMode}\n          onUpdatePhoto={onUpdatePhoto}\n        />\n      )\n      break\n    case MODES.PHOTO_VIEW_NEW:\n      component = (\n        <PhotoViewTool\n          photos={seriesState.series.photos}\n          initPhotoId={mode.current.pid}\n          newPhoto\n          onMenuBack={() => changeMode(MODES.SERIES_VIEW)}\n          onUpdatePhoto={onUpdatePhoto}\n        />\n      )\n      break\n    case MODES.SLIDESHOW:\n      component = (\n        <Slideshow photos={seriesState.series.photos} onCancel={lastMode} />\n      )\n      break\n    case MODES.NEWPHOTO:\n      component = (\n        <NewPhoto\n          inputMethod={mode.current.inputMethod}\n          photos={series ? series.photos : null}\n          onCreate={onApprovePhoto}\n          onCancel={lastMode}\n        />\n      )\n      break\n    case MODES.NEWSERIES:\n      component = (\n        <NewPhoto\n          inputMethod={mode.current.inputMethod}\n          isNewSeries\n          onCreate={onCreateSeries}\n          onCancel={lastMode}\n        />\n      )\n      break\n    default:\n      console.log('REPEATABLEPHOTO: default state. you should NEVER see this', seriesState)\n      component = null\n  }\n\n  return (\n    <SeriesContext.Provider value={seriesState}>\n      {component}\n    </SeriesContext.Provider>\n  )\n}\n\nRepeatablePhotos.propTypes = {\n  modeName: PropTypes.oneOf(VALID_STARTMODES),\n  seriesConfig: PropTypes.object.isRequired,\n  watching: PropTypes.bool,\n  owned: PropTypes.bool,\n\n  currentUserId: PropTypes.string,\n  currentUserRole: PropTypes.string,\n  accessControl: PropTypes.object,\n\n  inputMethod: PropTypes.oneOf(['camera', 'library']),\n  series: PropTypes.object,\n  initialPhoto: PropTypes.string,\n  loading: PropTypes.bool,\n\n  // Now some functions to handle actions we might take\n  onChange: PropTypes.func.isRequired,\n  onChangePhoto: PropTypes.func.isRequired,\n  onDeletePhoto: PropTypes.func.isRequired,\n  onNewPhoto: PropTypes.func.isRequired,\n  onNewSeries: PropTypes.func.isRequired,\n  onDelete: PropTypes.func.isRequired,\n  onClose: PropTypes.func.isRequired,\n  onWatch: PropTypes.func.isRequired,\n  onUnWatch: PropTypes.func.isRequired\n\n}\nRepeatablePhotos.defaultProps = {\n  mode: MODES.SERIES_VIEW\n}\n\nexport default RepeatablePhotos\n","import { openDb } from 'idb'\nimport { localDb } from '../config'\nimport uuidv4 from 'uuid/v4'\n\n/**\n * This is a leftover from the original, static RepeatablePhotos app.\n * For now it's just a decent way of storing the image data\n */\nconst dbPromise = openDb('serieslistDB', 1, upgradeDB => {\n  console.log('UPGRADE NEEDED', upgradeDB)\n  const store = upgradeDB.createObjectStore(localDb.imgStore)\n  console.log('UPGRADE NEEDED STORE', store)\n}).catch(e => {\n  console.error('ERROR', e)\n})\n\nexport const localUUID = (prefix) => {\n  return `__LOCAL_${prefix}::${uuidv4()}`\n}\n\nexport async function get (key) {\n  const db = await dbPromise\n  return db.transaction(localDb.imgStore).objectStore(localDb.imgStore).get(key)\n}\nexport async function getAll () {\n  const db = await dbPromise\n  return db.transaction(localDb.imgStore).objectStore(localDb.imgStore).getAll()\n}\nexport async function getOne () {\n  const db = await dbPromise\n  return db.transaction(localDb.imgStore).objectStore(localDb.imgStore).getAll(null, 1)\n}\nexport async function setEntry (key, val) {\n  const db = await dbPromise\n  const tx = db.transaction(localDb.imgStore, 'readwrite')\n  tx.objectStore(localDb.imgStore).put(val, key)\n  return tx.complete\n}\nexport async function deleteEntry (key) {\n  const db = await dbPromise\n  const tx = db.transaction(localDb.imgStore, 'readwrite')\n  tx.objectStore(localDb.imgStore).delete(key)\n  return tx.complete\n}\nexport async function clear () {\n  const db = await dbPromise\n  const tx = db.transaction(localDb.imgStore, 'readwrite')\n  tx.objectStore(localDb.imgStore).clear()\n  return tx.complete\n}\nexport async function keys () {\n  const db = await dbPromise\n  return db.transaction(localDb.imgStore).objectStore(localDb.imgStore).getAllKeys()\n}\n","import React, { useContext } from 'react'\nimport PropTypes from 'prop-types'\nimport { home } from '../config'\nimport permissions from '../permissions'\nimport { graphql, compose } from 'react-apollo'\nimport { connect } from 'react-redux'\nimport actions from '../redux/actions'\nimport { getWholeSeries, allSeries } from './queries'\nimport { deletePhoto, deleteSeries, updateSeries, createPhoto, createSeries, updatePhoto, watchSeries, unWatchSeries } from './mutations'\nimport RepeatablePhotos, { MODES } from '../components/PhotoSeries'\nimport { localUUID, get, setEntry } from '../lib/localdb'\nimport { AppContext } from '../contexts'\n\nconst SeriesConnect = ({\n  series, loading, domain, activeSeries, initialPhoto,\n  onAfterSeriesDelete, onBack, queueUpload, doneCreatingSeries,\n  createSeriesMutation, createPhotoMutation,\n  updateSeriesMutation, updatePhotoMutation,\n  deleteSeriesMutation, deletePhotoMutation,\n  watchSeriesMutation, unWatchSeriesMutation\n}) => {\n  const { role, currentUser, seriesConfig, user, signedIn } = useContext(AppContext)\n  let inputMethod = 'camera'\n  // Hack until we can get good loading object sorted\n  if (domain === home.AppStateTypes.NEW_SERIES_CAMERA) inputMethod = 'camera'\n  else if (domain === home.AppStateTypes.NEW_SERIES_LIBRARY) inputMethod = 'library'\n\n  // console.log('SeriesConnect', { series, loading, currentState, activeSeries, role, currentUser })\n  let modeName = MODES.SERIES_VIEW\n  if (domain !== home.AppStateTypes.SERIES) modeName = MODES.NEWSERIES\n\n  return <RepeatablePhotos\n    modeName={modeName}\n    inputMethod={inputMethod}\n\n    owned={signedIn && user && series && user.id === series.id}\n    watching={signedIn && user && user.watching && user.watching.indexOf(activeSeries) > -1}\n\n    // Everything we need to determine access\n    currentUserId={currentUser.attributes.sub}\n    currentUserRole={role}\n    accessControl={permissions}\n    loading={loading}\n    series={series}\n    initialPhoto={initialPhoto}\n    seriesConfig={seriesConfig}\n    // Now some functions to handle actions we might take\n    onNewPhoto={({ base64, ...newPhoto }) => {\n      console.log('onNewPhoto', { base64, ...newPhoto })\n      const ext = base64.split(';')[0].split('/')[1]\n      return createPhotoMutation(newPhoto, ext)\n        .then(({ data }) => {\n          // Don't start an upload until you get back a proper id\n          if (data.createPhoto.preAuth) {\n            const preAuth = JSON.parse(data.createPhoto.preAuth)\n            console.log('PREAUTH', data.createPhoto.preAuth)\n            queueUpload({\n              id: newPhoto.id,\n              seriesId: data.createPhoto.seriesId,\n              base64,\n              preAuth\n            })\n          }\n          return data\n        })\n        .catch(err => {\n          console.log('onNewPhoto Graphql Error', err.stack)\n          console.error(err)\n        })\n    }}\n    onChangePhoto={(photo, photoDelta) => updatePhotoMutation(photo, photoDelta)\n      .catch(err => {\n        console.log('onChangePhoto Graphql Error', err.stack)\n        console.error(err)\n      })\n    }\n    onDeletePhoto={(photo) => deletePhotoMutation(photo.id)\n      .then((...data) => {\n        console.log('photo deleted', data)\n      })\n      .catch(err => {\n        console.log('onDeletePhoto Graphql Error', err.stack)\n        console.error(err)\n      })\n    }\n    onChange={(series, seriesDelta) => updateSeriesMutation(series, seriesDelta)\n      .catch(err => {\n        console.log('onChange Graphql Error', err.stack)\n        console.error(err)\n      })\n    }\n    onNewSeries={(newSeries, photoNoId) => {\n      console.log('Series.connect: onNewSeries starting', newSeries)\n      return createSeriesMutation(newSeries)\n        .then(async ({ data }) => {\n          const { base64, ...newPhoto } = photoNoId\n          const ext = base64.split(';')[0].split('/')[1]\n          console.log('Series.connect: done createSeriesMutation', data)\n          const { data: photoData } = await createPhotoMutation({ ...photoNoId, seriesId: data.createSeries.id }, ext)\n\n          const preAuth = JSON.parse(photoData.createPhoto.preAuth)\n          console.log('PREAUTH', photoData.createPhoto.preAuth)\n          queueUpload({\n            id: newPhoto.id,\n            seriesId: photoData.createPhoto.seriesId,\n            base64,\n            preAuth\n          })\n          doneCreatingSeries(data.createSeries.id)\n          return data\n        })\n        .catch(err => {\n          console.log('onNewSeries Graphql Error', err.stack)\n          console.error(err)\n        })\n    }}\n    onDelete={() => deleteSeriesMutation()\n      .then(onAfterSeriesDelete)\n      .catch(err => {\n        console.log('onDelete Graphql Error', err.stack)\n        console.error(err)\n      })\n    }\n    onClose={onBack}\n    onWatch={signedIn ? watchSeriesMutation : null}\n    onUnWatch={signedIn ? unWatchSeriesMutation : null}\n  />\n}\nSeriesConnect.propTypes = {\n  domain: PropTypes.string,\n  activeSeries: PropTypes.string,\n  initialPhoto: PropTypes.string,\n\n  // From Redux\n  onAfterSeriesDelete: PropTypes.func,\n  doneCreatingSeries: PropTypes.func,\n  queueUpload: PropTypes.func,\n  onBack: PropTypes.func,\n\n  // Data from apollo\n  series: PropTypes.object,\n\n  // Functions From Apollo\n  loading: PropTypes.bool,\n  updateSeriesMutation: PropTypes.func,\n  updatePhotoMutation: PropTypes.func,\n  deleteSeriesMutation: PropTypes.func,\n  deletePhotoMutation: PropTypes.func,\n  createSeriesMutation: PropTypes.func,\n  createPhotoMutation: PropTypes.func,\n  watchSeriesMutation: PropTypes.func,\n  unWatchSeriesMutation: PropTypes.func\n}\n\n/**\n * Here's the graphql HOC that gets an individual series\n */\nconst withGetSelectedQuery = graphql(getWholeSeries, {\n  props: ({ data }) => {\n    if (data.error) console.error(data.error)\n    // console.log('HERE', data)\n    let series = null\n    try {\n      if (!data.loading && !data.error) series = data.series\n    }\n    catch (e) {\n      console.error(data)\n      console.error(e)\n    }\n    return {\n      data,\n      loading: data.loading,\n      series\n    }\n  },\n  skip: ({ activeSeries, isNewSeries }) => !activeSeries || isNewSeries,\n  options: ({ activeSeries }) => ({\n    variables: {\n      id: activeSeries\n    }\n  })\n})\n\nconst withUpdateSeriesMutation = graphql(updateSeries, {\n  props: ({ mutate, ownProps }) => ({\n    // We turn this into a thunk so we can handle the business logic here and not in a JSX region\n    updateSeriesMutation: (series, seriesDelta) => mutate({\n      // input UpdateSeries {\n      //   id: ID!\n      //   name: String\n      //   note: String\n      //   latitude: Float\n      //   longitude: Float\n      //   direction: Int\n      // }\n      variables: { series: sanitizeUpdateParams(seriesDelta, ['id', 'name', 'access', 'note', 'latitude', 'longitude', 'direction']) },\n      optimisticResponse: {\n        updateSeries: {\n          ...series,\n          ...seriesDelta,\n          __typename: 'Series'\n        }\n      },\n      update: (store, { data }) => {\n        // console.log('withUpdateSeriesMutation start Manip:', JSON.stringify(data, null, 2))\n        const qdata = store.readQuery({ query: getWholeSeries, variables: { id: ownProps.activeSeries } })\n        qdata.series = { ...qdata.series, ...seriesDelta }\n        store.writeQuery({ query: getWholeSeries, data: qdata })\n        // console.log('withUpdateSeriesMutation Done Manip:', qdata)\n\n        // Update: allSeries\n        // We might not have called this query yet so let it throw if it wants\n        try {\n          const qdataAll = store.readQuery({ query: allSeries, variables: { limit: 100 } })\n          // console.log('withUpdateSeriesMutation qdataAll:', qdataAll)\n          const summary = sanitizeUpdateParams(seriesDelta, ['id', 'name', 'access', 'latitude', 'longitude', 'direction'])\n          qdataAll.allSeries.seriesSummaries = qdataAll.allSeries.seriesSummaries.map(s => s.id !== summary.id\n            ? s\n            : { ...s, ...summary }\n          )\n          store.writeQuery({ query: allSeries, data: qdataAll })\n          // console.log('withUpdateSeriesMutation qdataAll WRITE:', qdataAll)\n        }\n        catch (e) { }\n      }\n    })\n  })\n})\n\n// id: ID!\n// seriesId: ID!\n// takenOn: String\n// tags: [TagInput]\n// note: String\nconst withUpdatePhotoMutation = graphql(updatePhoto, {\n  props: ({ mutate, ownProps }) => ({\n    // We turn this into a thunk so we can handle the business logic here and not in a JSX region\n    updatePhotoMutation: (photo, photoDelta) => {\n      const sanitizedPhotoDelta = sanitizeUpdateParams(photoDelta, [ 'id', 'seriesId', 'takenOn', 'tags', 'note' ])\n      if (sanitizedPhotoDelta.tags && sanitizedPhotoDelta.tags.length > 0) {\n        // input TagInput {\n        //   label: String\n        //   typeId: String,\n        //   coords: ImageCoordsInput\n        // }\n        sanitizedPhotoDelta.tags = sanitizedPhotoDelta.tags.map(t => {\n          const newT = sanitizeUpdateParams(t, [ 'label', 'typeId', 'coords' ])\n          if (newT.coords) newT.coords = sanitizeUpdateParams(newT.coords, [ 'x', 'y' ])\n          return newT\n        })\n      }\n      // console.log('withUpdatePhotoMutation', sanitizedPHoto)\n      return mutate({\n      // input UpdatePhoto {\n      //   id: ID!\n      //   seriesId: ID!\n      //   takenOn: String\n      //   tags: [TagInput]\n      //   note: String\n      // }\n        variables: { photo: sanitizedPhotoDelta },\n        optimisticResponse: {\n          updatePhoto: {\n            ...photo,\n            ...sanitizedPhotoDelta,\n            __typename: 'Photo'\n          }\n        },\n        update: (store, { data }) => {\n          // console.log('updatePhotoMutation start Manip:', JSON.stringify(data, null, 2))\n          const qdata = store.readQuery({ query: getWholeSeries, variables: { id: ownProps.activeSeries } })\n          // Gotta add Typenames\n          const updatedPhoto = {\n            ...sanitizedPhotoDelta,\n            tags: sanitizedPhotoDelta.tags ? sanitizedPhotoDelta.tags.map(t => {\n              const newT = { ...t, __typename: 'Tag' }\n              newT.coords = newT.coords ? { ...newT.coords, __typename: 'ImageCoords' } : null\n              return newT\n            }) : []\n          }\n          // console.log('updatePhotoMutation', updatedPhoto)\n          qdata.series.photos = qdata.series.photos.map(photo => photo.id !== photoDelta.id ? photo : { ...photo, ...updatedPhoto })\n\n          store.writeQuery({ query: getWholeSeries, data: qdata })\n          // console.log('updatePhotoMutation Manip:', { qdata })\n        }\n      })\n    }\n  })\n})\n\nconst withDeleteSeriesDeleteMutation = graphql(deleteSeries, {\n  props: ({ mutate, ownProps }) => {\n    return {\n      deleteSeriesMutation: () => mutate({\n        variables: { id: ownProps.activeSeries },\n        optimisticResponse: {\n          deleteSeries: ownProps.activeSeries\n        },\n        update: (store, { data }) => {\n          try {\n            const qdataAll = store.readQuery({ query: allSeries, variables: { limit: 100 } })\n            qdataAll.allSeries.seriesSummaries = qdataAll.allSeries.seriesSummaries.filter(s => s.id !== data.deleteSeries)\n            store.writeQuery({ query: allSeries, data: qdataAll })\n          }\n          catch (e) { }\n        }\n      })\n    }\n  }\n})\n\nconst withDeletePhotoMutation = graphql(deletePhoto, {\n  props: ({ mutate, ownProps }) => ({\n    // We turn this into a thunk so we can handle the business logic here and not in a JSX region\n    deletePhotoMutation: (photoId) => mutate({\n      variables: { seriesId: ownProps.series.id, photoId },\n      optimisticResponse: {\n        deletePhoto: photoId\n      },\n      update: (store, { data }) => {\n        console.log('deletePhotoMutation start Manip:', JSON.stringify(data, null, 2))\n        let finalCount = null\n\n        const qdata = store.readQuery({ query: getWholeSeries, variables: { id: ownProps.activeSeries } })\n        qdata.series.photos = qdata.series.photos.filter(photo => photo.id !== data.deletePhoto)\n\n        finalCount = qdata.series.photos.length\n        qdata.series.photoCount = finalCount\n        store.writeQuery({ query: getWholeSeries, data: qdata })\n        console.log('deletePhotoMutation start Manip WRITE:', qdata)\n\n        // Update: allSeries\n        // We might not have called this query yet so let it throw if it wants\n        try {\n          const qdataAll = store.readQuery({ query: allSeries, variables: { limit: 100 } })\n          console.log('deletePhotoMutation qdataAll:', qdataAll)\n          qdataAll.allSeries.seriesSummaries = qdataAll.allSeries.seriesSummaries.map(s => s.id !== data.deletePhoto\n            ? s\n            : { ...s, photoCount: finalCount !== null ? finalCount : s.photoCount }\n          )\n          store.writeQuery({ query: allSeries, data: qdataAll })\n          console.log('deletePhotoMutation qdataAll WRITE:', qdataAll)\n        }\n        catch (e) { }\n\n        console.log('Done Manip:', qdata.series.photos)\n      }\n    })\n  })\n})\n\nconst withCreateNewSeries = graphql(createSeries, {\n  props: ({ mutate, ownProps }) => {\n    return {\n      createSeriesMutation: (newSeries) => {\n        // input NewSeriesInput {\n        //   name: String!\n        //   note: String\n        //   latitude: Float!\n        //   longitude: Float!\n        //   direction: Int\n        //   meta: String\n        // }\n        return mutate({\n          variables: { series: sanitizeUpdateParams(newSeries, ['name', 'note', 'latitude', 'longitude', 'direction', 'meta']) },\n          optimisticResponse: {\n            'createSeries': {\n              'id': localUUID('SERIES'),\n              'name': newSeries.name || null,\n              'note': newSeries.note || null,\n              'meta': newSeries.meta || {},\n              'featured': newSeries.featured || null,\n              'coords': newSeries.coords || null,\n              'direction': newSeries.direction || null,\n              'photoCount': 0,\n              'photos': [],\n              __typename: 'Series'\n            }\n          },\n          update: (store, { data }) => {\n            // We need to write this query from scratch\n            console.log('STARTING TO CREATE THE SERIES', data, store)\n            // dumpLog(store.data, '##CACHE-NEW_SERIES_BEFORE')\n            try {\n              store.writeQuery({ query: getWholeSeries,\n                data: { series: data.createSeries }\n              })\n              console.log('Series write getWholeSeries', { series: data.createSeries })\n            }\n            catch (e) {\n              console.error(e)\n            }\n\n            try {\n              const qdataAll = store.readQuery({ query: allSeries, variables: { limit: 100 } })\n              // console.log('createSeriesMutation qdataAll:', qdataAll)\n              const newAllSeriesEntry = sanitizeUpdateParams(data.createSeries, ['id', 'name', 'updatedOn', 'featured', 'longitude', 'latitude', 'photoCount', 'seriesStatus', 'direction'])\n              qdataAll.allSeries.seriesSummaries.push(newAllSeriesEntry)\n              store.writeQuery({ query: allSeries, data: qdataAll })\n              // console.log('createSeriesMutation qdataAll WRITE:', qdataAll)\n            }\n\n            catch (e) {\n              // dumpLog(store.data, '##CACHE-NEW_SERIES_ERROR')\n              console.error('createSeriesMutation allSeries error')\n              console.error(e)\n            }\n            // dumpLog(store.data, '##CACHE-NEW_SERIES_AFTER')\n          }\n        })\n      }\n    }\n  }\n})\n\nconst withCreateNewPhoto = graphql(createPhoto, {\n  props: ({ mutate, ownProps }) => {\n    return {\n      createPhotoMutation: (newPhoto, ext) => {\n        // input NewPhotoInput {\n        //   seriesId: ID!\n        //   takenOn: String\n        //   meta: String\n        //   tags: [TagInput]\n        //   note: String\n        // }\n        // When we're not creating a series the seriesId isn't passed in\n        // so we add it now\n        const { base64, ...newPhotoInput } = newPhoto\n        if (!newPhotoInput.seriesId && ownProps.activeSeries) {\n          newPhotoInput.seriesId = ownProps.activeSeries\n        }\n        return mutate({\n          variables: { photo: sanitizeUpdateParams(newPhotoInput, [ 'seriesId', 'takenOn', 'meta', 'tags', 'note' ]), ext },\n          optimisticResponse: {\n            'createPhoto': {\n              'photo': {\n                'id': localUUID('PHOTO'),\n                'meta': newPhotoInput.meta,\n                'seriesId': newPhotoInput.seriesId,\n                'createdOn': Date.now().toString(),\n                'createdUser': {\n                  'id': ownProps.authData.attributes.sub,\n                  'username': ownProps.authData.Username\n                },\n                'updatedBy': ownProps.authData.attributes.sub,\n                'updatedOn': Date.now().toString(),\n                'takenOn': newPhotoInput.takenOn,\n                'tags': newPhotoInput.tags || [],\n                'paths': {\n                  large: null,\n                  orig: null,\n                  thumb: null,\n                  medium: null,\n                  __typename: 'Paths'\n                },\n                '__typename': 'Photo'\n              },\n              'preAuth': null,\n              '__typename': 'NewPhotoOutput'\n            }\n          },\n          update: (store, { data }) => {\n            // Update: getWholeSeries\n            console.log('createPhotoMutation store.readQuery:', { data, store, ownProps })\n\n            try {\n              const qdata = store.readQuery({ query: getWholeSeries, variables: { id: data.createPhoto.seriesId } })\n              qdata.series.photos = qdata.series.photos = [...qdata.series.photos, data.createPhoto]\n\n              store.writeQuery({ query: getWholeSeries, data: qdata })\n            }\n            catch (e) {\n              // This won't fire on new series and that's ok for now.\n            }\n\n            // Update: allSeries\n            // We might not have called this query yet so let it throw if it wants\n            let qdataAll = null\n            try {\n              qdataAll = store.readQuery({ query: allSeries, variables: { limit: 100 } })\n              console.log('createPhotoMutation qdataAll:', qdataAll)\n              qdataAll.allSeries.seriesSummaries = qdataAll.allSeries.seriesSummaries.map(s => s.id !== data.createPhoto.photo.seriesId\n                ? s\n                : { ...s, photoCount: s.photoCount + 1 }\n              )\n              store.writeQuery({ query: allSeries, data: qdataAll })\n              console.log('createPhotoMutation qdataAll: WRITE', qdataAll)\n            }\n            catch (e) {\n              console.error('createPhotoMutation allSeries ERROR')\n              console.error(e)\n            }\n          }\n        })\n      }\n    }\n  }\n})\n\nconst withWatchSeriesMutation = graphql(watchSeries, {\n  props: ({ mutate, ownProps }) => {\n    return {\n      watchSeriesMutation: () => mutate({\n        variables: { seriesId: ownProps.activeSeries },\n        optimisticResponse: {\n          watchSeries: ownProps.activeSeries\n        },\n        update: (store, { data }) => {\n          // TODO: modify the getuser query to add this to the list of favourites\n          // try {\n          //   const qdataAll = store.readQuery({ query: allSeries, variables: { limit: 100 } })\n          //   qdataAll.allSeries.seriesSummaries = qdataAll.allSeries.seriesSummaries.filter(s => s.id !== data.deleteSeries)\n          //   store.writeQuery({ query: allSeries, data: qdataAll })\n          // }\n          // catch (e) { }\n        }\n      })\n    }\n  }\n})\n\nconst withUnWatchSeriesMutation = graphql(unWatchSeries, {\n  props: ({ mutate, ownProps }) => {\n    return {\n      unWatchSeriesMutation: () => mutate({\n        variables: { seriesId: ownProps.activeSeries },\n        optimisticResponse: {\n          unWatchSeries: ownProps.activeSeries\n        },\n        update: (store, { data }) => {\n          // try {\n          //   const qdataAll = store.readQuery({ query: allSeries, variables: { limit: 100 } })\n          //   qdataAll.allSeries.seriesSummaries = qdataAll.allSeries.seriesSummaries.filter(s => s.id !== data.deleteSeries)\n          //   store.writeQuery({ query: allSeries, data: qdataAll })\n          // }\n          // catch (e) { }\n        }\n      })\n    }\n  }\n})\n\n/**\n * Compose all our queries together\n */\nconst connectedWithApollo = compose(\n  withGetSelectedQuery,\n  withCreateNewSeries,\n  withCreateNewPhoto,\n  withUpdateSeriesMutation,\n  withUpdatePhotoMutation,\n  withDeleteSeriesDeleteMutation,\n  withDeletePhotoMutation,\n  withWatchSeriesMutation,\n  withUnWatchSeriesMutation\n)(SeriesConnect)\n\n/**\n * Map our redux state and functions\n */\nconst mapStateToProps = (state, props) => {\n  const { current: { activeSeries, initialPhoto, domain } } = state.home\n  return { activeSeries, initialPhoto, domain }\n}\n\nconst mapDispatchToProps = dispatch => ({\n  onBack: () => {\n    dispatch(actions.homeStateBack())\n  },\n  onAfterSeriesDelete: (key, newProgress) => {\n    dispatch(actions.setActiveSeries(null))\n    dispatch(actions.homeStateBack())\n  },\n  queueUpload: (uploadObj) => {\n    dispatch(actions.queueUpload(uploadObj))\n  },\n  doneCreatingSeries: (seriesId) => {\n    dispatch(actions.setActiveSeries(seriesId))\n    dispatch(actions.setHomeState(home.AppStateTypes.SERIES))\n  }\n})\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(connectedWithApollo)\n\n/**\n * We need to filter out null values and params we don't desire\n */\nfunction sanitizeUpdateParams (inputObj, desiredParams) {\n  const newDesiredParams = [...desiredParams, '__typename']\n  const remainder = Object.keys(inputObj).filter(key => newDesiredParams.indexOf(key) > -1)\n  console.log('sanitizeUpdateParams', { orig: Object.keys(inputObj), remainder })\n  return remainder.reduce((acc, key) => ({ ...acc, [key]: inputObj[key] }), {})\n}\n\nfunction dumpLog (obj, name) {\n  console.log(`${Date.now()}__${name}`, JSON.stringify(obj, null, 2))\n}\n","import { useState, useEffect, useCallback } from 'react'\nimport uuid from 'uuid/v4'\nimport WebMercatorViewport from 'viewport-mercator-project'\nimport rbush from 'rbush'\nimport { point, centroid, featureCollection } from '@turf/turf'\nimport { debounce } from './util'\n\nconst useClusteredData = (data, filterBounds, currentZoom, viewport, sizeScale, queryVersion) => {\n  const [clusteredData, setClusteredData] = useState([])\n  const [filteredData, setFilteredData] = useState({ single: [], cluster: [] })\n  const [version, setVersion] = useState(0)\n\n  // We promisify and debounce the expensive stuff so it runs outside our render loop\n  const updateDataDebounce = useCallback(debounce(async (...innerArgs) => {\n    const updatedData = await updateData(...innerArgs)\n    setClusteredData(updatedData)\n    // setClusteredData(updatedData)\n    setVersion(version + 1)\n  }, 1000), [])\n\n  const filterDataDebounce = useCallback(debounce(async (...innerArgs) => {\n    const filtered = await filterData(...innerArgs)\n    setFilteredData(filtered)\n  }, 300), [])\n\n  // Here's the really expensive call. Make sure this only runs when the data changes\n  useEffect(() => {\n    updateDataDebounce(data, sizeScale, viewport)\n  }, [data.length, queryVersion])\n\n  useEffect(() => {\n    filterDataDebounce(clusteredData, filterBounds, currentZoom)\n  }, [clusteredData, currentZoom, filterBounds, version])\n\n  return { filteredClusteredData: filteredData }\n}\n\nexport default useClusteredData\n\n// Compute icon clusters\n// We use the projected positions instead of longitude and latitude to build\n// the spatial index, because this particular dataset is distributed all over\n// the world, we can't use some fixed deltaLon and deltaLat\nconst updateData = (data, sizeScale, viewport) => {\n  // console.log('----------------------------------UPDATE CLUSTER----------------------------------', { data, sizeScale, viewport })\n\n  if (!data) {\n    return []\n  }\n  const tree = rbush(9, ['.x', '.y', '.x', '.y'])\n\n  const transform = new WebMercatorViewport({\n    ...viewport,\n    zoom: 0\n  })\n\n  // console.log('DATA', data)\n  // The root of this is GeoJSON so that's what we have to build\n  const newData = data.map(p => {\n    // Create some GeoJSON that we can render as a dot\n    let screenCoords = [0, 0]\n    try {\n      screenCoords = transform.project(p.coords)\n    }\n    catch (e) {\n      console.error(e)\n    }\n    const { longitude, latitude, ...properties } = p\n    return {\n      x: screenCoords[0],\n      y: screenCoords[1],\n      photoCount: properties.photoCount,\n      zoomLevels: [],\n      geoJSON: p.coords ? point(p.coords, { ...properties }) : null\n    }\n  })\n\n  tree.clear()\n  tree.load(newData)\n\n  for (let z = 0; z <= 20; z++) {\n    const radius = sizeScale / Math.sqrt(2) / Math.pow(2, z)\n    // const radius = 60 / Math.sqrt(2) / Math.pow(2, z)\n\n    newData.forEach(p => {\n      if (p.zoomLevels[z] === undefined) {\n        // this point does not belong to a cluster\n        const { x, y } = p\n\n        // find all points within radius that do not belong to a cluster\n        const neighbors = tree\n          .search({\n            minX: x - radius,\n            minY: y - radius,\n            maxX: x + radius,\n            maxY: y + radius\n          })\n          .filter(neighbor => neighbor.zoomLevels[z] === undefined)\n\n        // only show the center point at this zoom level\n        neighbors.forEach(neighbor => {\n          if (neighbor === p) {\n            const newGeoJSON = neighbors.length === 1\n              ? p.geoJSON\n              : centroid(featureCollection(neighbors.map(n => n.geoJSON)))\n\n            newGeoJSON.properties = {\n              ...newGeoJSON.properties,\n              id: newGeoJSON.properties.id || uuid(),\n              count: neighbors.length,\n              reducedPhotoCount: neighbors.reduce((acc, { photoCount }) => photoCount ? acc + photoCount : acc, 0),\n              points: neighbors.map(n => n.geoJSON)\n            }\n            p.zoomLevels[z] = newGeoJSON\n          }\n          else {\n            neighbor.zoomLevels[z] = null\n          }\n        })\n      }\n    })\n  }\n\n  // console.log('----------------------------------UPDATE CLUSTER DONE----------------------------------')\n  return newData.map(({ zoomLevels }) => zoomLevels)\n}\n\nfunction filterData (clusteredData, filterBounds, newZ) {\n  // console.log('----------------------------------FILTER CLUSTER----------------------------------', { clusteredData, filterBounds, newZ })\n\n  return clusteredData\n    // Filter out anything not relevant to this zoom level\n    .filter(d => !!d[newZ])\n    // Restructure the object to be a little more JSON-friendly\n    .reduce((acc, zoomLevels) => {\n      const geoJSON = zoomLevels[newZ]\n      const coords = geoJSON.geometry.coordinates\n      const { count } = geoJSON.properties\n\n      if (!filterBounds || filterBounds.length < 4 || (\n        filterBounds[0] < coords[0] && filterBounds[1] < coords[1] &&\n        filterBounds[2] > coords[0] && filterBounds[3] > coords[1]\n      )) {\n        if (count > 1) acc.cluster.push(geoJSON)\n        else acc.single.push(geoJSON)\n      }\n      return acc\n    }, {\n      single: [],\n      cluster: []\n    })\n}\n","export default theme => ({\n  root: {\n    position: 'relative',\n    height: '100%',\n    '& .myPosMarker': {\n      zIndex: 1\n    },\n    '& .singleMarker': {\n      zIndex: 3\n    },\n    '& .clusterMarker': {\n      zIndex: 2\n    }\n  },\n  fab: {\n    background: theme.palette.secondary.main,\n    color: theme.palette.secondary.contrastText\n  },\n  topBar: {\n    position: 'absolute',\n    zIndex: 1000,\n    top: 0\n  },\n  zoomOutFab: {\n    margin: theme.spacing(0.5),\n    padding: theme.spacing(0.5),\n    border: '2px solid',\n    borderRadius: theme.spacing(1),\n    background: theme.palette.common.white,\n    fontSize: 20,\n    position: 'absolute',\n    zIndex: 100,\n    bottom: theme.spacing(2),\n    right: theme.spacing(10)\n  },\n  selectedPopup: {\n    padding: theme.spacing(0, 1, 0, 1),\n    width: '90%',\n    maxWidth: 400,\n    zIndex: 2000,\n    position: 'absolute',\n    bottom: theme.spacing(1),\n    left: '50%',\n    transformOrigin: '0% 50%',\n    transform: 'translateY(0%) translateX(-50%)'\n  }\n})\n","import React from 'react'\nimport createSvgIcon from '@material-ui/icons/utils/createSvgIcon'\n\nexport default createSvgIcon(\n  <React.Fragment>\n    <path d='M16.432,6.104c-2.671,-1.06 -6.842,4.123 -6.572,5.826c-3.78,-7.611 2.788,-8.409 3.682,-10.699c0.64,1.255 5.18,2.608 2.89,4.873Z' />\n    <path d='M9.159,5.228c-2.254,1.782 0.149,7.986 1.76,8.604c-8.482,-0.532 -5.889,-6.619 -7.425,-8.538c1.407,0.073 4.848,-3.183 5.665,-0.066Z' />\n    <path d='M4.727,11.059c0.417,2.844 6.991,3.864 8.331,2.779c-4.701,7.079 -8.676,1.79 -11.106,2.161c0.766,-1.183 -0.332,-5.791 2.775,-4.94Z' />\n    <path d='M7.561,17.813c2.671,1.061 6.842,-4.122 6.572,-5.826c3.781,7.611 -2.788,8.409 -3.681,10.699c-0.641,-1.255 -5.181,-2.607 -2.891,-4.873Z' />\n    <path d='M14.828,18.736c2.254,-1.783 -0.149,-7.987 -1.76,-8.605c8.482,0.532 5.889,6.619 7.425,8.538c-1.407,-0.072 -4.849,3.183 -5.665,0.067Z' />\n    <path d='M19.26,12.904c-0.417,-2.843 -6.991,-3.864 -8.331,-2.778c4.701,-7.08 8.676,-1.791 11.106,-2.162c-0.767,1.183 0.332,5.791 -2.775,4.94Z' />\n  </React.Fragment>, 'AppLogoSimple')\n","import React, { useState, useContext } from 'react'\nimport classNames from 'classnames'\nimport PropTypes from 'prop-types'\n\nimport ContextMenu from './PhotoSeries/views/controls/ContextMenu'\nimport Toolbar from '@material-ui/core/Toolbar'\nimport AppBar from '@material-ui/core/AppBar'\nimport IconButton from '@material-ui/core/IconButton'\nimport MenuIcon from '@material-ui/icons/Menu'\nimport AppLogoSimple from '../icons/AppLogoSimple'\nimport { AppContext } from '../contexts'\n\nimport ExitToAppIcon from '@material-ui/icons/ExitToApp'\nimport AccountCircleIcon from '@material-ui/icons/AccountCircle'\n\n// import MenuIcon from '@material-ui/core/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { ThemeProvider } from '@material-ui/styles'\nimport themes from '../themes'\n\nconst style = theme => ({\n  root: {\n    display: 'flex',\n    alignItems: 'center',\n    width: '100%',\n    padding: theme.spacing(0, 1),\n    backgroundColor: theme.palette.primary.main,\n    color: theme.palette.primary.contrastText,\n    background: `linear-gradient(90deg, ${theme.palette.primary.dark} 0%, ${theme.palette.secondary.dark} 100%)`\n  },\n  searchIcon: {\n    opacity: 0.3,\n    marginRight: theme.spacing(1)\n  },\n  transparent: {\n    background: 'none',\n    color: theme.palette.text.primary\n    // borderBottom: `2px transparent`\n  },\n  transparentIcon: {\n    color: 'white',\n    '& path': {\n      stroke: '#00000055',\n      strokeWidth: 0.5\n    }\n  },\n  children: {\n    flexGrow: 1,\n    padding: theme.spacing(0, 1)\n  },\n  iconButton: {\n    padding: theme.spacing(1, 0)\n  },\n  logo: {\n    height: 40,\n    width: 40\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst TopBar = ({ className, children, isTransparent, menuItems, hideLogo }) => {\n  const classes = useStyles()\n  const [contextEl, setContextEl] = useState()\n  const { signOut, signedIn, forceSignIn } = useContext(AppContext)\n\n  let finalMenuItems = []\n  if (menuItems) {\n    finalMenuItems = [ ...menuItems, { divider: true } ]\n  }\n\n  return (\n    <ThemeProvider theme={themes.topbar}>\n      <AppBar position='static'>\n        <Toolbar className={classNames(classes.root, className, isTransparent ? classes.transparent : null)} disableGutters>\n          {!hideLogo && (\n            <IconButton className={classes.iconButton} color='inherit'>\n              <AppLogoSimple className={classNames(classes.logo, isTransparent ? classes.transparentIcon : null)} />\n            </IconButton>\n          )}\n          <div className={classes.children}>\n            {children}\n          </div>\n          {signedIn && (\n            <IconButton\n              color='inherit'\n              className={classes.iconButton}\n              aria-label='Menu'\n              onClick={event => setContextEl(event.currentTarget)}\n              // onClick={() => setDrawerOpen(!drawerOpen)}\n            >\n              <MenuIcon color='inherit' />\n            </IconButton>\n          )}\n          {!signedIn && (\n            <IconButton\n              color='primary'\n              className={classes.iconButton}\n              aria-label='Menu'\n              onClick={forceSignIn}\n            >\n              <AccountCircleIcon color='primary' />\n            </IconButton>\n          )}\n\n          <ContextMenu\n            anchorEl={contextEl}\n            onClose={() => setContextEl(null)}\n            menuItems={[\n              ...finalMenuItems,\n              {\n                text: 'Sign Out',\n                icon: ExitToAppIcon,\n                action: signOut\n              }\n            ]}\n          />\n        </Toolbar>\n      </AppBar>\n    </ThemeProvider>\n  )\n}\n\nTopBar.propTypes = {\n  className: PropTypes.string,\n  children: PropTypes.any,\n  isTransparent: PropTypes.bool,\n  hideLogo: PropTypes.bool,\n  menuItems: PropTypes.arrayOf(PropTypes.shape({\n    callback: PropTypes.func,\n    text: PropTypes.string,\n    icon: PropTypes.any,\n    color: PropTypes.string\n  }))\n}\n\nexport default TopBar\n","import React, { useRef, useLayoutEffect, useCallback } from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport { fade } from '@material-ui/core/styles/colorManipulator'\nimport InputBase from '@material-ui/core/InputBase'\n\nimport SearchIcon from '@material-ui/icons/Search'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { debounce } from '../../lib/util'\n\nconst useSearchBarStyles = makeStyles(theme => ({\n  root: {\n    position: 'relative',\n    borderRadius: theme.shape.borderRadius,\n    backgroundColor: fade(theme.palette.common.white, 0.3),\n    '&:hover': {\n      backgroundColor: fade(theme.palette.common.white, 0.5)\n    },\n    marginRight: theme.spacing(2),\n    marginLeft: 0,\n    width: '100%',\n    [theme.breakpoints.up('sm')]: {\n      marginLeft: theme.spacing(3),\n      width: 'auto'\n    }\n  },\n  transparent: {\n    backgroundColor: fade(theme.palette.common.white, 0.7),\n    '&:hover': {\n      backgroundColor: fade(theme.palette.common.white, 0.9)\n    }\n  },\n  inputRoot: {\n    color: 'inherit'\n  },\n  inputInput: {\n    padding: theme.spacing(1, 1, 1, 7),\n    transition: theme.transitions.create('width'),\n    width: '100%',\n    [theme.breakpoints.up('md')]: {\n      width: 200\n    }\n  },\n  searchIcon: {\n    width: theme.spacing(7),\n    height: '100%',\n    position: 'absolute',\n    pointerEvents: 'none',\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'center'\n  }\n}))\n\n/**\n *\n */\nexport const SearchInput = ({ autoFocus, disabled, onChange, onClick, defaultValue, isTransparent }) => {\n  const inputRef = useRef()\n  const classes = useSearchBarStyles()\n\n  const debounceSearchText = useCallback(\n    debounce(onChange, 500),\n    [onChange]\n  )\n\n  useLayoutEffect(() => {\n    if (inputRef.current) {\n      // console.log('Setting focus')\n      // inputRef.current.focus()\n    }\n  }, [])\n  return (\n    <div className={classNames(classes.root, isTransparent ? classes.transparent : null)} onClick={onClick}>\n      <div className={classes.searchIcon}>\n        <SearchIcon />\n      </div>\n      <InputBase\n        autoFocus={!disabled && autoFocus}\n        inputProps={{\n          onBlur: () => {\n            // console.log('onBlur')\n            // inputRef.current.focus()\n          }\n        }}\n        onChange={(e) => {\n          // console.log('onChange', e.target.value)\n          debounceSearchText(e.target.value)\n        }}\n        placeholder='Search'\n        disabled={disabled}\n        defaultValue={defaultValue}\n\n        inputRef={inputRef}\n        classes={{\n          root: classes.inputRoot,\n          input: classes.inputInput\n        }}\n      />\n    </div>\n  )\n}\n\nSearchInput.propTypes = {\n  autoFocus: PropTypes.bool,\n  isTransparent: PropTypes.bool,\n  disabled: PropTypes.bool,\n  onChange: PropTypes.func,\n  defaultValue: PropTypes.string,\n  onClick: PropTypes.func\n}\n\nexport default SearchInput\n","import React, { useContext } from 'react'\nimport PropTypes from 'prop-types'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemText from '@material-ui/core/ListItemText'\nimport List from '@material-ui/core/List'\nimport classNames from 'classnames'\nimport Typography from '@material-ui/core/Typography'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { formatDate } from '../../lib/datelib'\n\nimport { ACCESS } from '../../config'\nimport { AppContext } from '../../contexts'\nimport { Divider } from '@material-ui/core'\n\nconst style = theme => ({\n  root: {\n    margin: 0,\n    padding: theme.spacing(1)\n  },\n  chipContainer: {\n    display: 'flex',\n    width: '100%'\n  },\n  grow: { flexGrow: 1 },\n  accessLabel: {\n    padding: theme.spacing(0.5, 0.5)\n  },\n  accessPUBLIC: {\n    color: 'white',\n    background: ACCESS.PUBLIC.color[900]\n  },\n  accessPRIVATE: {\n    color: 'white',\n    background: ACCESS.PRIVATE.color[900]\n  },\n  accessOPEN: {\n    color: 'white',\n    background: ACCESS.OPEN.color[900]\n  },\n  img: {\n    verticalAlign: 'top',\n    objectFit: 'cover',\n    height: '100%',\n    width: '100%'\n  },\n  text: {\n    margin: 0,\n    padding: theme.spacing(0, 1),\n    alignSelf: 'flex-start'\n  },\n  titleText: {\n    textOverflow: 'ellipsis',\n    whiteSpace: 'nowrap',\n    overflow: 'hidden'\n  },\n  dateContainer: {\n    display: 'flex'\n  },\n  dateLabel: {\n    fontWeight: 'bold',\n    flex: '1 1 50px'\n  },\n  dateText: {\n\n  },\n  imgContainer: {\n    flex: '0 0 115px',\n    alignSelf: 'flex-start',\n    height: '100%'\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst SeriesListItem = ({ series, loading, onClick, children, showCreatedOn, showLastPhoto }) => {\n  const classes = useStyles()\n  const { seriesConfig } = useContext(AppContext)\n  if (loading || !series) return 'LOADING...'\n  let thumb = null\n  let accessLabel = ACCESS.PRIVATE.label\n  try {\n    thumb = seriesConfig.getPhotoUrl(series.featured, 'thumb')\n    accessLabel = series.access ? ACCESS[series.access].label : ACCESS.PRIVATE.label\n  }\n  catch (e) {\n    console.error(e)\n  }\n  return (\n    <ListItem className={classes.root} button component='div' disableGutters>\n      <div className={classes.imgContainer} >\n        <img alt='thumbnail' src={thumb} className={classes.img} onClick={onClick} />\n        {series.access && (\n          <Typography className={classNames(classes.accessLabel, classes[`access${series.access}`])}\n            variant='caption'\n            component='div'\n          >\n            {`${series.photoCount || 0} Photos`} <em>({accessLabel})</em>\n          </Typography>\n        )}\n      </div>\n      <ListItemText className={classes.text} disableTypography onClick={onClick}>\n        <Typography variant='body1' component='div' className={classes.titleText}>\n          {series.name || loading}\n        </Typography>\n        <Typography variant='body2' component='div'>\n          <strong>Created by:</strong> {series.createdUser.username}\n        </Typography>\n        {(showCreatedOn || showLastPhoto) && <Divider /> }\n        {showCreatedOn && <div className={classes.dateContainer}>\n          <Typography variant='caption' className={classes.dateLabel}>Created:</Typography>\n          <Typography variant='caption' className={classes.dateText}>{formatDate(series.createdOn, 'lll')}</Typography>\n        </div>}\n        {showLastPhoto && <div className={classes.dateContainer}>\n          <Typography variant='caption' className={classes.dateLabel}>Last Photo:</Typography>\n          <Typography variant='caption' className={classes.dateText}>{formatDate(series.latest.takenOn, 'lll')}</Typography>\n        </div>}\n      </ListItemText>\n      {/*  <TinyChip label='Watching' color='secondary' /> */}\n      {children}\n    </ListItem>\n  )\n}\n\nSeriesListItem.propTypes = {\n  series: PropTypes.object,\n  loading: PropTypes.bool,\n  showCreatedOn: PropTypes.bool,\n  showLastPhoto: PropTypes.bool,\n  onClick: PropTypes.func,\n  children: PropTypes.array\n}\n\nexport default SeriesListItem\n\n// const useCosmosStyles = makeStyles(theme => ({\n//   root: {\n\n//   }\n// }))\n\nexport const SeriesListItemCosmos = (props) => {\n  // const classes = useCosmosStyles()\n  return (\n    <List disablePadding dense>\n      <SeriesListItem {...props} />\n    </List>\n  )\n}\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemText from '@material-ui/core/ListItemText'\nimport List from '@material-ui/core/List'\n// import IconButton from '@material-ui/core/IconButton'\n// import ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction'\nimport ZoomOutMapIcon from '@material-ui/icons/ZoomOutMap'\n// import CancelIcon from '@material-ui/icons/Cancel'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { ListItemIcon } from '@material-ui/core'\n\nconst style = theme => ({\n  root: {\n\n  }\n})\n\nconst useStyles = makeStyles(style)\n\nconst ClusterSelected = ({ seriesCount, reducedPhotoCount, onZoomTo, onClose }) => {\n  const classes = useStyles()\n  console.log('cluster selected', { seriesCount, reducedPhotoCount })\n  return (\n    <List>\n      <ListItem className={classes.root}>\n        <ListItemIcon onClick={onZoomTo}>\n          <ZoomOutMapIcon />\n        </ListItemIcon>\n        <ListItemText\n          onClick={onZoomTo}\n          primary={`${seriesCount} Photo series`}\n          secondary={`containing ${reducedPhotoCount} individual photo${reducedPhotoCount === 1 ? '' : 's'}`}\n        />\n        {/* <ListItemSecondaryAction>\n          <IconButton aria-label='Close' onClick={onClose}>\n            <CancelIcon />\n          </IconButton>\n        </ListItemSecondaryAction> */}\n\n      </ListItem>\n    </List>\n  )\n}\n\nClusterSelected.propTypes = {\n  seriesCount: PropTypes.number.isRequired,\n  reducedPhotoCount: PropTypes.number.isRequired,\n  onZoomTo: PropTypes.func.isRequired,\n  onClose: PropTypes.func.isRequired\n}\n\nexport default ClusterSelected\n","import React from 'react'\nimport classNames from 'classnames'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport Badge from '@material-ui/core/Badge'\nimport Avatar from '@material-ui/core/Avatar'\nimport Camera from '@material-ui/icons/Camera'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { ACCESS } from '../../../config'\n\nconst style = theme => ({\n  root: {\n    color: theme.palette.primary.main,\n    width: 150,\n    position: 'absolute',\n    top: '50%',\n    left: '50%',\n    textAlign: 'center',\n    transformOrigin: '50% 50%',\n    transform: 'translateY(-50%) translateX(-50%)'\n  },\n  rootActive: {\n    zIndex: 1000\n  },\n  icon: {\n    // height: 16,\n    // width: 16\n  },\n  avatar: {\n    position: 'relative',\n    margin: '0 auto',\n    background: 'green',\n    color: 'white',\n    border: '2px solid white',\n    height: 40,\n    width: 40,\n    zIndex: 120,\n    '&.PUBLIC': { background: ACCESS.PUBLIC.color },\n    '&.PRIVATE': { background: ACCESS.PRIVATE.color },\n    '&.OPEN': { background: ACCESS.OPEN.color }\n  },\n  avatarActive: {\n    background: '#FFFF00',\n    color: 'black',\n    border: `2px solid black`,\n    '&.PUBLIC': { background: '#FFFF00' },\n    '&.PRIVATE': { background: '#FFFF00' },\n    '&.OPEN': { background: '#FFFF00' }\n  },\n  badge: {\n    zIndex: 124,\n    color: theme.palette.secondary.contrastText,\n    background: theme.palette.secondary.main,\n    transform: 'scale(1) translate(30%, -30%)'\n  },\n  badgeActive: {\n    color: theme.palette.primary.contrastText,\n    background: theme.palette.primary.main\n  },\n  directionIndicator: {\n    position: 'absolute',\n    top: 20,\n    left: '50%',\n    // transformOrigin: '50% 50%',\n    // transform: 'translateY(-50%) translateX(-50%)',\n    zIndex: 100\n  },\n  name: {\n    color: 'white',\n    fontWeight: 'bold',\n    textShadow: `\n        0px 0px 4px #000000, \n        0px 0px 4px #000000 \n    `,\n    zIndex: 122,\n    position: 'relative'\n    // textStroke: '1px white'\n  },\n  nameActive: {\n    color: 'black',\n    textShadow: `\n    0px 0px 2px #FFFFFF, \n    0px 0px 2px #FFFFFF,\n    0px 0px 4px #FFFFFF \n`\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst Single = ({ name, access, onClick, active, photoCount, direction }) => {\n  const classes = useStyles()\n  return (\n    <div className={classNames(classes.root, active ? classes.rootActive : null, access)}>\n      <Badge classes={{ badge: classNames(classes.badge, active ? classes.badgeActive : null, access) }} badgeContent={photoCount}>\n        <Avatar className={classNames(classes.avatar, active ? classes.avatarActive : null, access)} onClick={onClick}>\n          <Camera className={classes.icon} color='inherit' />\n        </Avatar>\n      </Badge>\n      {direction && direction >= 0 ? (\n        <div className={classes.directionIndicator}>\n          <svg className={classes.svgArc}\n            version='1.1'\n            width='100'\n            height='100'\n            viewBox='0, 0, 100, 100'\n            style={{ transform: `translateY(-50%) translateX(-50%) rotateZ(${direction}deg)` }}>\n            <path d='M50,0 C60.946,0.151 72.136,3.514 80.675,10.56 L50,50 L19.325,10.56 C27.938,3.461 39,0.278 50,0 z'\n              fill='#009DC1'\n              fillOpacity='0.444'\n              strokeWidth='1'\n              strokeOpacity='0.6'\n              stroke='#FFFFFF'\n            />\n          </svg>\n        </div>\n      ) : null}\n      <Typography variant='body1' className={classNames(classes.name, active ? classes.nameActive : null)}>\n        {name}\n      </Typography>\n    </div>\n  )\n}\n\nSingle.propTypes = {\n  access: PropTypes.string,\n  name: PropTypes.string,\n  photoCount: PropTypes.number,\n  onClick: PropTypes.func.isRequired,\n  direction: PropTypes.number,\n  active: PropTypes.bool\n}\n\nexport default Single\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport classNames from 'classnames'\nimport Avatar from '@material-ui/core/Avatar'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport numeral from 'numeral'\n\n\nconst style = theme => ({\n  avatar: {\n    background: theme.palette.primary.dark,\n    border: `2px solid ${theme.palette.primary.contrastText}`,\n    color: theme.palette.primary.contrastText\n  },\n  avatarActive: {\n    background: '#FFFF00',\n    border: `2px solid black`,\n    color: 'black',\n    zIndex: 1000\n  }\n})\nconst useStyles = makeStyles(style)\n\nconst Cluster = ({ seriesCount, active, onClick }) => {\n  const classes = useStyles()\n  return (\n    <Avatar onClick={onClick} className={classNames(classes.avatar, active ? classes.avatarActive : null)}>\n      {numeral(seriesCount).format('0,0')}\n    </Avatar>\n  )\n}\n\nCluster.propTypes = {\n  seriesCount: PropTypes.number,\n  onClick: PropTypes.func.isRequired,\n  active: PropTypes.bool\n}\n\nexport default Cluster\n","\nimport React, { useState, useMemo, useRef, useEffect } from 'react'\nimport PropTypes from 'prop-types'\nimport Paper from '@material-ui/core/Paper'\nimport { FlyToInterpolator, LinearInterpolator, Marker } from 'react-map-gl'\nimport { easeCubic } from 'd3-ease'\nimport MapStyles from '../../mapStyles'\n\nimport BaseMap from './BaseMap'\nimport useClusteredData from '../../lib/useClusteredData'\nimport { bbox, featureCollection, buffer, point } from '@turf/turf'\nimport { makeStyles } from '@material-ui/core/styles'\n// import { debounce } from '../../lib/util'\nimport style from './HomeMap.style'\n\nimport TopBar from '../TopBar'\nimport SearchInput from '../Search/SearchInput'\nimport SeriesListItem from '../misc/SeriesListItem'\nimport ClusterSelected from '../misc/ClusterSelected'\n\nimport SingleMarker from './markers/Single'\nimport ClusterMarker from './markers/Cluster'\n\nconst useStyles = makeStyles(style)\n\nconst defaultView = {\n  zoom: 4,\n  latitude: 44.629701,\n  longitude: -120.333379\n}\n\nconst SIZESCALE = 80\n\nconst HomeMap = ({\n  seriesList, initViewport, loading, activeSeries, queryVersion,\n  onSeriesClick, onSearchClick,\n  popMapHistory, pushMapHistory, clearMapHistory\n}) => {\n  const [mapViewObj, setMapViewObj] = useState({\n    viewport: { ...defaultView, ...initViewport.viewport },\n    bounds: initViewport.bounds,\n    filterBounds: null\n  })\n  // console.log('INITVIEW', initViewport)\n  const classes = useStyles()\n  const mapViewRef = useRef()\n  const [isTransitioning, setIsTransitioning] = useState(false)\n  const homeMapContainerRef = useRef()\n\n  const [currentZoom, setCurrentZoom] = useState(0)\n  const [transitions, setTransitions] = useState(null)\n  const [selectedItem, setSelectedItem] = useState()\n\n  // This custom hook is heavily debounced\n  const { filteredClusteredData } = useClusteredData(\n    seriesList || [],\n    mapViewObj.filterBounds,\n    currentZoom,\n    mapViewObj.viewport,\n    SIZESCALE,\n    queryVersion\n  )\n\n  // If we're coming back to the map with something aleady selected then we need to\n  // reselect the series we had before\n  useEffect(() => {\n    if (!activeSeries || !seriesList || selectedItem) return\n    try {\n      const selected = seriesList.find(s => s.id === activeSeries)\n      // if (selected && homeMapContainerRef.current) setSelectedItem(selected)\n      if (selected && selected.coords) {\n        const bufferPts = buffer(point(selected.coords), 10, { units: 'meters' })\n        const bounds = bbox(bufferPts)\n        console.log('DEBUG', { bufferPts, bounds })\n        setMapViewObj({ ...mapViewObj, bounds })\n      }\n    }\n    catch (e) {\n      console.error(e)\n    }\n  }, [seriesList])\n  // Once we have the zoom in place we might need to select an initial series\n  useEffect(() => {\n    if (!activeSeries || !filteredClusteredData.single || selectedItem) return\n    try {\n      const selected = filteredClusteredData.single.find(s => s.properties.id === activeSeries)\n      if (selected && homeMapContainerRef.current) setSelectedItem(selected)\n    }\n    catch (e) {\n      console.error(e)\n    }\n  }, [filteredClusteredData.single])\n\n  const saveMap = () => {\n    const { latitude, longitude, zoom, bearing, pitch, altitude } = mapViewRef.current ? mapViewRef.current : mapViewObj.viewport\n    setTimeout(() => pushMapHistory({\n      viewport: { latitude, longitude, zoom, bearing, pitch, altitude }\n    }), 2000)\n  }\n  // const saveMapDebounced = debounce(saveMap, 2000)\n\n  const updateSelectedItem = (item) => {\n    // regardless, set the map selected Item\n    setSelectedItem(item)\n    saveMap()\n  }\n\n  const onZoomTo = (object) => {\n    try {\n      const pts = featureCollection(object.properties.points)\n      const bufferPts = buffer(pts, 100, { units: 'meters' })\n      const bounds = bbox(bufferPts)\n      // buffer a further 10%\n      const lngBuff = (bounds[2] - bounds[0]) * 0.2\n      const latBuff = (bounds[3] - bounds[1]) * 0.2\n      const buffBounds = [\n        bounds[0] - lngBuff,\n        bounds[1] - latBuff,\n        bounds[2] + lngBuff,\n        bounds[3] + latBuff\n      ]\n\n      setTransitions({\n        transitionDuration: 2000,\n        transitionInterpolator: new FlyToInterpolator(),\n        transitionEasing: easeCubic\n      })\n      setMapViewObj({ ...mapViewObj, bounds: buffBounds })\n      if (object.properties.count > 1) setTimeout(() => updateSelectedItem(null), 2000)\n    }\n    catch (e) {\n      console.error(e)\n    }\n  }\n\n  const onViewportChange = ({ viewport, map }) => {\n    mapViewRef.current = viewport\n    // mapViewObj\n    // {\n    //   \"_sw\": {\n    //     \"lng\": -120.40788003760076,\n    //     \"lat\": 44.609051464438835\n    //   },\n    //   \"_ne\": {\n    //     \"lng\": -120.25887796240545,\n    //     \"lat\": 44.65034319161438\n    //   }\n    // minX, minY, maxX, maxY\n    // [W-122.87948116236043, S26.15346805640254, E-82.00799782432676, N47.3795453070757]\n    const viewZoom = Math.floor(viewport.zoom)\n    if (!isTransitioning && map && map.getBounds) {\n      // console.log('onViewportChange', isTransitioning)\n      const { _sw: { lng: minLng, lat: minLat }, _ne: { lng: maxLng, lat: maxLat } } = map.getBounds()\n      const [oldMinLng, oldMinLat, oldMaxLng, oldMaxLat] = mapViewObj.filterBounds || [minLng, minLat, maxLng, maxLat]\n      if (viewZoom !== currentZoom ||\n        oldMinLng >= minLng || oldMinLat >= minLat ||\n        oldMaxLng <= maxLng || oldMaxLat <= maxLat\n      ) {\n        // console.log('RECALCING filterBounds')\n        const filterBounds = [\n          minLng - (maxLng - minLng) / 2,\n          minLat - (maxLat - minLat) / 2,\n          maxLng + (maxLng - minLng) / 2,\n          maxLat + (maxLat - minLat) / 2\n        ]\n        setMapViewObj({ ...mapViewObj, filterBounds })\n      }\n    }\n    if (viewZoom !== currentZoom) {\n      setCurrentZoom(viewZoom)\n    }\n  }\n  // Debounce this to improve performance\n  // const onViewportChangeDebounced = useCallback(debounce(onViewportChange, 300), [])\n\n  const lock = {}\n\n  const onMarkerClick = (obj) => {\n    // Second click zooms\n    if (selectedItem && selectedItem.properties.id === obj.properties.id) {\n      // console.log('onMarkerClick SECOND CLICK')\n      onZoomTo(selectedItem)\n    }\n    else {\n      // console.log('onMarkerClick First click')\n      setTransitions({\n        transitionDuration: 500,\n        transitionInterpolator: new LinearInterpolator(),\n        transitionEasing: easeCubic\n      })\n      setMapViewObj({\n        viewport: {\n          longitude: obj.geometry.coordinates[0],\n          latitude: obj.geometry.coordinates[1]\n        }\n      })\n    }\n    updateSelectedItem(obj)\n  }\n\n  // This one should be debounced by filteredClusteredData\n  const markersRendered = useMemo(() => ([\n    ...filteredClusteredData.single.map(obj => (\n      <Marker\n        className={'singleMarker'}\n        key={`single-${obj.properties.id}`}\n        latitude={obj.geometry.coordinates[1]}\n        longitude={obj.geometry.coordinates[0]}\n        offsetLeft={0}\n        offsetTop={-20}\n      >\n        <SingleMarker name={obj.properties.name}\n          access={obj.properties.access}\n          photoCount={obj.properties.photoCount}\n          onClick={() => onMarkerClick(obj)}\n          direction={currentZoom > 10 && obj.properties.direction ? obj.properties.direction : null}\n          active={selectedItem && selectedItem.properties.id === obj.properties.id}\n        />\n      </Marker>\n    )),\n    ...filteredClusteredData.cluster.map(obj => (\n      <Marker\n        className='clusterMarker'\n        key={`cluster-${obj.properties.id}`}\n        latitude={obj.geometry.coordinates[1]}\n        longitude={obj.geometry.coordinates[0]}\n        offsetLeft={-20}\n        offsetTop={-20}\n      >\n        <ClusterMarker\n          seriesCount={obj.properties.count}\n          photoCount={obj.properties.reducedPhotoCount}\n          onClick={() => onMarkerClick(obj)}\n          active={\n            selectedItem &&\n            selectedItem.properties.id === obj.properties.id &&\n            selectedItem.properties.count === obj.properties.count\n          }\n        />\n      </Marker>\n    ))\n  ]), [filteredClusteredData, selectedItem])\n\n  const selectedItemRender = useMemo(() => !!selectedItem && (\n    <Paper className={classes.selectedPopup}>\n      {selectedItem.properties.count === 1\n        ? <SeriesListItem\n          loading={loading.selectedSeries}\n          series={selectedItem.properties}\n          showCreatedOn\n          showLastPhoto\n          onClick={() => onSeriesClick(selectedItem.properties.id)}\n        />\n        : <ClusterSelected\n          seriesCount={selectedItem.properties.count}\n          reducedPhotoCount={selectedItem.properties.reducedPhotoCount}\n          onClose={() => updateSelectedItem(null)}\n          onZoomTo={() => onZoomTo(selectedItem)}\n        />\n      }\n    </Paper>\n  ), [selectedItem])\n\n  return (\n    <div className={classes.root} ref={homeMapContainerRef}>\n      <TopBar isTransparent hideLogo className={classes.topBar}>\n        <SearchInput\n          isTransparent\n          onClick={onSearchClick}\n          defaultValue={''}\n        />\n      </TopBar>\n      <BaseMap\n        showMe\n        // This should only change on INIT or transition events\n        viewport={mapViewObj.viewport}\n        transitions={transitions}\n        mapStyles={MapStyles}\n        controlPadding={{ top: 56 }}\n        initStyle={MapStyles.length > 1 ? 1 : 0}\n        {...lock}\n        onTransitionStart={() => {\n          // console.log('handletransitionStart')\n          setIsTransitioning(true)\n        }}\n        onTransitionEnd={() => {\n          // console.log('handletransitionEnd')\n          setIsTransitioning(false)\n          setTransitions(null)\n        }}\n        bounds={mapViewObj.bounds}\n        maxZoom={20}\n        minZoom={1}\n        onViewportChange={onViewportChange}\n        onNativeClick={() => {\n          if (selectedItem) updateSelectedItem(null)\n        }}\n      >\n        {markersRendered}\n      </BaseMap>\n\n      {selectedItemRender}\n    </div>\n  )\n}\n\nHomeMap.propTypes = {\n  seriesList: PropTypes.array,\n  queryVersion: PropTypes.number,\n  activeSeries: PropTypes.string,\n  initViewport: PropTypes.object,\n  loading: PropTypes.object,\n  // These all get loaded up through mapFuncs in HomeMap.connect\n  onSearchClick: PropTypes.func,\n  onSeriesClick: PropTypes.func,\n  popMapHistory: PropTypes.func,\n  pushMapHistory: PropTypes.func,\n  clearMapHistory: PropTypes.func\n}\n\nexport default HomeMap\n\n// function getInitialState (initViewport) {\n//   return {\n//     viewport: { ...defaultView, ...initViewport.viewport },\n//     bounds: initViewport.bounds,\n//     filterBounds: null\n//   }\n// }\n","import React, { useEffect, useState, useRef, useMemo } from 'react'\nimport PropTypes from 'prop-types'\nimport { connect } from 'react-redux'\nimport { graphql } from 'react-apollo'\nimport { allSeries, pollQuery } from './queries'\nimport actions from '../redux/actions'\nimport { home } from '../config'\nimport HomeMap from '../components/maps/HomeMap'\n\nconst POLL_INTERVAL = 5 // (seconds)\n\n/**\n * The outer component handles the lastCheck variable which, when changed will\n * cause the poll event\n */\nconst HomeMapConnector = ({ initViewport, activeSeries, mapFuncs }) => {\n  const [seriesProps, setSeriesProps] = useState()\n  const [queryVersion, setVersion] = useState(0)\n  const updateIncrement = () => setVersion(queryVersion + 1)\n  const timerRef = useRef()\n  const [lastCheck, setLastCheck] = useState(null)\n  timerRef.current = lastCheck\n\n  // These are expensive queries so we render them memoized to prevent erroneous re-renders\n  const allSeriesQUERY = useMemo(() => <AllSeriesConnect setSeriesProps={setSeriesProps} />, [])\n  const pollSeriesQUERY = useMemo(() => <PollQueryConnect lastCheck={lastCheck} seriesProps={seriesProps} updateIncrement={updateIncrement} />, [lastCheck])\n\n  // Initiate the polling process. We simply update the timestamp every N seconds\n  useEffect(() => {\n    if (!seriesProps) return\n    function ping () {\n      if (timerRef.current) setLastCheck(String(Date.now() - POLL_INTERVAL * 1000))\n    }\n    if (!timerRef.current && seriesProps.readyForPolling) timerRef.current = setInterval(ping, POLL_INTERVAL * 1000)\n    return () => {\n      if (timerRef.current) {\n        console.log('clear poll timer')\n        clearInterval(timerRef.current)\n        timerRef.current = null\n      }\n    }\n  }, [seriesProps])\n\n  return (\n    <React.Fragment>\n      {allSeriesQUERY}\n      {pollSeriesQUERY}\n      <HomeMap\n        queryVersion={queryVersion}\n        seriesList={seriesProps && seriesProps.allSeries ? seriesProps.allSeries.seriesSummaries : []}\n        activeSeries={activeSeries}\n        initViewport={initViewport}\n        loading={{\n        }}\n        {...mapFuncs}\n      />\n    </React.Fragment>\n  )\n}\nHomeMapConnector.propTypes = {\n  activeSeries: PropTypes.string, // from redux\n  initViewport: PropTypes.object, // from redux\n  mapFuncs: PropTypes.object // from redux passed straight through to the map\n\n}\n\nconst withAllSeries = graphql(allSeries, {\n  props: ({ data, ownProps }) => {\n    // If there's more data to load we should go get another batch\n    if (!data.loading && !data.error && data.allSeries && data.allSeries.seriesSummaries.length > 0 && data.allSeries.nextToken) {\n      data.fetchMore({\n        variables: { ...data.variables, nextToken: data.allSeries.nextToken },\n        // How do we mush the new query with the old one\n        updateQuery: (prev, { fetchMoreResult }) => {\n          return {\n            allSeries: {\n              ...fetchMoreResult.allSeries,\n              seriesSummaries: [ ...prev.allSeries.seriesSummaries, ...fetchMoreResult.allSeries.seriesSummaries ]\n            }\n          }\n        }\n      })\n    }\n    else if (data.loading || data.error) {\n      ownProps.setSeriesProps(data)\n    }\n    else {\n      ownProps.setSeriesProps({ ...data, readyForPolling: true })\n    }\n    return null\n  },\n  options: {\n    variables: { limit: 100 }\n  }\n})\n\n/**\n * Here's the graphql HOC that gets an individual series\n */\nconst withPollQuery = graphql(pollQuery, {\n  skip: ({ lastCheck }) => !lastCheck,\n  props: ({ data, ownProps: { seriesProps, updateIncrement } }) => {\n    if (data.error) {\n      console.log('POLL FAIL', data.error, data)\n      console.error(data.error)\n    }\n    if (!data.loading && data.changedSeries && data.changedSeries.seriesSummaries) {\n      // console.log('POLLING', { data, seriesProps })\n      const newData = data.changedSeries.seriesSummaries\n      const oldList = seriesProps.allSeries.seriesSummaries\n\n      // If the polling has begun and we have some good polling data back then\n      // Process it and decide if we need to incorporate it\n      if (data.changedSeries) {\n        let newSeriesSummaries = seriesProps.allSeries.seriesSummaries\n        newData.forEach(({ seriesStatus, ...polledSeries }) => {\n          if (seriesStatus === 'deleted') {\n            console.log('Polling found a series to delete: ', polledSeries.id)\n            newSeriesSummaries = oldList.filter(s => s.id !== polledSeries.id)\n          }\n          else {\n            const idx = oldList.findIndex(ds => ds.id === polledSeries.id)\n            if (idx >= 0) {\n              console.log('Polling found a series to Update: ', polledSeries.id)\n              newSeriesSummaries = oldList.map((oldSeries, oldId) => oldId === idx ? polledSeries : oldSeries)\n            }\n            else {\n              console.log('Polling found a series to add: ', polledSeries.id)\n              newSeriesSummaries = [...oldList, polledSeries]\n            }\n          }\n          seriesProps.updateQuery((data, options) => {\n            try {\n              const newData = { ...data }\n              newData.allSeries.seriesSummaries = newSeriesSummaries\n              updateIncrement()\n              return data\n            }\n            catch (e) {\n              console.error(e)\n              return data\n            }\n          })\n        })\n      }\n    }\n    return null\n  },\n  options: ({ lastCheck }) => ({\n    variables: {\n      limit: 100,\n      lastCheck\n    }\n  })\n})\n\n// We're using graphql() HOC because it's convenient but it doesn't need to render anything\nconst AllSeriesConnect = withAllSeries(() => null)\nconst PollQueryConnect = withPollQuery(() => null)\n\n// The only part of the state the main view caes about is teh window\nconst mapStateToProps = (state, props) => {\n  const { current: { activeSeries } } = state.home\n  const initViewport = state.map.slice(-1).pop()\n  return { activeSeries, initViewport }\n}\n\n// There are a few presentational actions the main window can use\nconst mapDispatchToProps = dispatch => ({\n  mapFuncs: {\n    onSeriesClick: (activeSeries) => {\n      dispatch(actions.setHomeState(home.AppStateTypes.SERIES, { activeSeries }))\n    },\n    onSearchClick: () => {\n      dispatch(actions.setHomeState(home.AppStateTypes.SEARCH, { search: { tab: home.SEARCH_TABS.LOCATION, text: '' } }))\n    },\n    popMapHistory: () => {\n      dispatch(actions.popMapHistory())\n    },\n    pushMapHistory: (viewportSave) => {\n      dispatch(actions.pushMapHistory(viewportSave))\n    },\n    clearMapHistory: () => {\n      dispatch(actions.clearMapHistory())\n    }\n  }\n})\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(HomeMapConnector)\n","import React from 'react'\nimport classNames from 'classnames'\nimport PropTypes from 'prop-types'\nimport List from '@material-ui/core/List'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemAvatar from '@material-ui/core/ListItemAvatar'\nimport ListItemText from '@material-ui/core/ListItemText'\nimport ListItemIcon from '@material-ui/core/ListItemIcon'\nimport IconButton from '@material-ui/core/IconButton'\nimport Avatar from '@material-ui/core/Avatar'\n\nimport PlaceIcon from '@material-ui/icons/Place'\nimport PersonIcon from '@material-ui/icons/Person'\nimport LabelIcon from '@material-ui/icons/Label'\nimport CancelIcon from '@material-ui/icons/Cancel'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport { Typography } from '@material-ui/core'\nconst useStyles = makeStyles(theme => ({\n  root: {\n\n  },\n  chosenItem: {\n    color: theme.palette.primary.contrastText,\n    background: theme.palette.primary.dark\n  },\n  avatar: {\n    background: theme.palette.primary.main\n  },\n  closeIcon: {\n    color: theme.palette.primary.contrastText,\n    paddingRight: 0\n  },\n  avatarImg: {\n    height: '100%',\n    width: '100%',\n    objectFit: 'cover'\n  }\n}))\n\nconst SearchContextItem = ({ className, variant, name, description, gravatar, onClick, onCancel }) => {\n  const classes = useStyles()\n  let TheIcon = PlaceIcon\n\n  const getAvatar = (src) => () => (\n    <Avatar className={classes.avatar}>\n      <img className={classes.avatarImg} alt='profile' src={src} />\n    </Avatar>\n  )\n\n  switch (variant) {\n    case 'tag':\n      TheIcon = LabelIcon\n      break\n    case 'location':\n      TheIcon = PlaceIcon\n      break\n    case 'user':\n      TheIcon = gravatar ? getAvatar(gravatar) : PersonIcon\n      break\n    default:\n      break\n  }\n  return (\n    <ListItem\n      className={classNames(className, classes.root, onCancel ? classes.chosenItem : null)}\n      button={!!onClick}\n      onClick={onClick}\n    >\n      <ListItemAvatar>\n        <Avatar className={classes.avatar}>\n          <TheIcon color='inherit' />\n        </Avatar>\n      </ListItemAvatar>\n      <ListItemText disableTypography>\n        <Typography variant='body1' color='inherit'>{name}</Typography>\n        <Typography variant='body2' color='inherit'>{description}</Typography>\n      </ListItemText>\n      {onCancel && (\n        <ListItemIcon>\n          <IconButton onClick={onCancel} className={classes.closeIcon}>\n            <CancelIcon color='inherit' />\n          </IconButton>\n        </ListItemIcon>\n      )}\n    </ListItem>\n  )\n}\n\nSearchContextItem.propTypes = {\n  variant: PropTypes.oneOf(['tag', 'location', 'user']),\n  onClick: PropTypes.func,\n  gravatar: PropTypes.string,\n  className: PropTypes.string,\n  name: PropTypes.string.isRequired,\n  description: PropTypes.string,\n  onCancel: PropTypes.func\n}\n\nexport default SearchContextItem\n\nexport const SearchContexItemCosmos = () => {\n  return (\n    <List>\n      <SearchContextItem variant='tag' name='SomeTag' description='Some description of what I am' />\n      <SearchContextItem variant='location' name='Some Location' description='Some description of what I am' />\n      <SearchContextItem variant='user' name='User McUserSon' description='Some description of what I am' />\n    </List>\n  )\n}\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport List from '@material-ui/core/List'\nimport Typography from '@material-ui/core/Typography'\n\nimport SearchContextItem from './SearchContextItem'\n// import MenuIcon from '@material-ui/icons/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    width: '100%',\n    backgroundColor: theme.palette.background.paper,\n    position: 'relative',\n    overflow: 'auto'\n  },\n  listSection: {\n    backgroundColor: 'inherit'\n  },\n  placeholderText: {\n    textAlign: 'center',\n    padding: theme.spacing(3, 1),\n    color: theme.palette.grey[400]\n  },\n  ul: {\n    backgroundColor: 'inherit',\n    padding: 0\n  }\n}))\n\nconst SearchContextResults = ({ variant, loading, contextResults, setContextChoice }) => {\n  const classes = useStyles()\n  if (loading) {\n    return <Typography className={classes.placeholderText} variant='h3'>Searching...</Typography>\n  }\n  else if (!contextResults || contextResults.length === 0) {\n    return <Typography className={classes.placeholderText} variant='h4'>No {variant} results</Typography>\n  }\n\n  return (\n    <List className={classes.root}>\n      {contextResults.map((cr, idx) => (\n        <SearchContextItem\n          key={`scr-${idx}`}\n          variant={variant}\n          onClick={() => setContextChoice(cr)}\n          {...cr}\n        />\n      ))}\n    </List>\n  )\n}\n\nSearchContextResults.propTypes = {\n  variant: PropTypes.oneOf(['tag', 'location', 'user']),\n  loading: PropTypes.bool,\n  contextResults: PropTypes.array.isRequired,\n  setContextChoice: PropTypes.func.isRequired\n}\n\nexport default SearchContextResults\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\n// import MenuIcon from '@material-ui/icons/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nconst useStyles = makeStyles(theme => ({\n  root: {\n    textAlign: 'center',\n    fontStyle: 'italic',\n    padding: theme.spacing(2, 1)\n  }\n}))\n\nconst SearchEnder = ({ style, icon, text }) => {\n  const classes = useStyles()\n  return (\n    <Typography className={classes.root} variant='subtitle1' color='textSecondary' component='div' style={style}>\n      {icon}\n      {text}\n    </Typography>\n  )\n}\n\nSearchEnder.propTypes = {\n  style: PropTypes.object,\n  icon: PropTypes.any,\n  text: PropTypes.string\n}\n\nexport default SearchEnder\n","import React, { useRef, useEffect } from 'react'\nimport PropTypes from 'prop-types'\nimport List from '@material-ui/core/List'\nimport Typography from '@material-ui/core/Typography'\nimport Paper from '@material-ui/core/Paper'\n\nimport SearchContextItem from './SearchContextItem'\nimport SearchEnder from './SearchEnder'\n// import MenuIcon from '@material-ui/icons/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nimport SeriesListItem from '../misc/SeriesListItem'\nimport { debounce } from '../../lib/util'\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    height: '100%',\n    display: 'flex',\n    flexDirection: 'column',\n    overflow: 'hidden'\n  },\n  ctxItem: {\n    flexGrow: 0\n  },\n  list: {\n    flexGrow: 1,\n    backgroundColor: theme.palette.background.paper,\n    position: 'relative',\n    overflowX: 'hidden',\n    overflowY: 'scroll'\n  },\n  placeholderText: {\n    textAlign: 'center',\n    padding: theme.spacing(3, 1),\n    color: theme.palette.grey[400]\n  },\n  listSection: {\n    backgroundColor: 'inherit'\n  },\n  ul: {\n    backgroundColor: 'inherit',\n    padding: 0\n  }\n}))\n\nconst SearchResults = ({ variant, loading, seriesList, contextChoice, onCancel, onResultClick, fetchMore }) => {\n  const classes = useStyles()\n  const listRef = useRef()\n  const enderRef = useRef()\n\n  const handleScroll = debounce(() => {\n    if (!loading && fetchMore && enderRef.current && listRef.current) {\n      const { offsetTop } = enderRef.current\n      const { scrollTop, offsetHeight } = listRef.current\n      const scrollBottom = offsetHeight + scrollTop\n      if (offsetTop < scrollBottom * 2) {\n        console.log('SCROLL', { offsetHeight, scrollTop, offsetTop })\n        fetchMore()\n      }\n    }\n  }, 500)\n\n  useEffect(handleScroll, [seriesList])\n\n  let content = null\n  if (loading) {\n    content = (\n      <Typography className={classes.placeholderText} variant='h3'>Searching...</Typography>\n    )\n  }\n  else if (seriesList && seriesList.length > 0) {\n    content = seriesList.map((series, idx) => (\n      <SeriesListItem\n        key={`series-${idx}`}\n        series={series}\n        onClick={() => onResultClick(series.id)}\n        showCreatedOn\n        showLastPhoto\n      />\n    ))\n    content.push(\n      <div key='ender' ref={enderRef}>\n        <SearchEnder text={fetchMore ? 'Loading...' : 'No More Results'} />\n      </div>\n    )\n  }\n  else {\n    content = (\n      <Typography className={classes.placeholderText} variant='h4'>No series found</Typography>\n    )\n  }\n\n  return (\n    <div className={classes.root}>\n      <SearchContextItem className={classes.ctxItem} {...contextChoice} variant={variant} onCancel={onCancel} />\n      <List className={classes.list} subheader={<li />} onScroll={handleScroll} innerRef={listRef}>\n        {content}\n      </List>\n    </div>\n  )\n}\n\nSearchResults.propTypes = {\n  variant: PropTypes.oneOf(['tag', 'location', 'user']),\n  seriesList: PropTypes.array.isRequired,\n  loading: PropTypes.bool,\n  contextChoice: PropTypes.object.isRequired,\n  onResultClick: PropTypes.func.isRequired,\n  onCancel: PropTypes.func.isRequired,\n  fetchMore: PropTypes.func\n}\n\nexport default SearchResults\n","import React from 'react'\nimport PropTypes from 'prop-types'\n\nimport Typography from '@material-ui/core/Typography'\n// import MenuIcon from '@material-ui/icons/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nconst useStyles = makeStyles(theme => ({\n  root: {\n    flexGrow: 1,\n    padding: '10%',\n    display: 'flex',\n    flexDirection: 'column',\n    opacity: 0.3,\n    textAlign: 'center'\n  },\n  icon: {\n    width: '100%',\n    flex: '1 1 40%',\n    color: theme.palette.primary.light,\n    opacity: 0.5\n  },\n  primary: {\n    flex: '1 1 30%',\n    width: '100%'\n  },\n  secondary: {\n    flex: '1 1 30%',\n    width: '100%'\n  }\n}))\n\nconst SearchPlaceholder = ({ icon, primary, secondary }) => {\n  const classes = useStyles()\n  const PlaceholderIcon = icon\n  return (\n    <div className={classes.root}>\n      <PlaceholderIcon className={classes.icon} />\n      {primary && (\n        <Typography className={classes.primary} variant='h3'>\n          {primary}\n        </Typography>\n      )}\n      {secondary && (\n        <Typography className={classes.secondary} variant='h4'>\n          {secondary}\n        </Typography>\n      )}\n    </div>\n  )\n}\n\nSearchPlaceholder.propTypes = {\n  icon: PropTypes.object,\n  primary: PropTypes.string,\n  secondary: PropTypes.string\n}\n\nexport default SearchPlaceholder\n","import { useEffect, useState } from 'react'\n\nconst useOnline = () => {\n  const [state, setState] = useState(null)\n\n  const setOnline = () => {\n    console.log('ONLINE')\n    setState(null)\n  }\n  const setOffline = () => {\n    console.log('OFFLINE')\n    const newDate = Date.now()\n    setState(newDate)\n  }\n\n  useEffect(() => {\n    window.addEventListener('online', setOnline)\n    window.addEventListener('offline', setOffline)\n\n    return () => {\n      window.removeEventListener('online', setOnline)\n      window.removeEventListener('offline', setOffline)\n    }\n  }, [])\n\n  return {\n    online: state === null,\n    since: state\n  }\n}\n\nexport default useOnline\n","import React, { useEffect } from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport Tabs from '@material-ui/core/Tabs'\nimport Tab from '@material-ui/core/Tab'\n\nimport SearchContextResults from './SearchContextResults'\nimport SearchResults from './SearchResults'\nimport SearchPlaceholder from './SearchPlaceholder'\nimport TopBar from '../TopBar'\nimport SearchInput from './SearchInput'\nimport useOnline from '../../lib/useOnline'\nimport { home } from '../../config'\nimport PortableWifiOffIcon from '@material-ui/icons/PortableWifiOff'\nimport LabelIcon from '@material-ui/icons/Label'\nimport PlaceIcon from '@material-ui/icons/Place'\nimport PersonIcon from '@material-ui/icons/Person'\nimport { makeStyles } from '@material-ui/core/styles'\n\nconst TABS = home.SEARCH_TABS\n\nconst style = theme => ({\n  root: {\n    height: '100%',\n    display: 'flex',\n    overflow: 'hidden',\n    flexDirection: 'column'\n  },\n  tabs: {\n    // backgroundColor: theme.palette.primary.main,\n    // color: theme.palette.primary.contrastText,\n    // background: `linear-gradient(90deg, ${theme.palette.primary.dark} 0%, ${theme.palette.secondary.dark} 100%)`\n\n  },\n  tab: {\n    flexGrow: 1\n  },\n  grow: {\n    flexGrow: 1\n  }\n})\n\nconst useStyles = makeStyles(style)\n\nconst Search = ({\n  onMenuBack, currentTab, setCurrentTab, defaultText, searchText,\n  setSearchText, contextResults, searchResults, contextChoice,\n  loading, setContextChoice, onMapClick, onResultClick, fetchMore\n}) => {\n  const classes = useStyles()\n\n  const { online } = useOnline()\n\n  // If there's only one thing then use it\n  useEffect(() => {\n    if (contextResults && !searchResults && contextResults.length === 1) {\n      setContextChoice(contextResults[0])\n    }\n  }, [contextResults])\n\n  // TODO: How to get from search results back to context results?\n  let placeholder = {}\n  switch (currentTab) {\n    case TABS.TAG:\n      placeholder = { primary: 'Tag search', secondary: 'example: \\'beaver...\\'', icon: LabelIcon }\n      break\n    case TABS.USER:\n      placeholder = { primary: 'User search', secondary: 'example: \\'SuperGreg123...\\'', icon: PersonIcon }\n      break\n    case TABS.LOCATION:\n      placeholder = { primary: 'Location Search', secondary: 'example: \\'Vancouver...\\'', icon: PlaceIcon }\n      break\n\n    default:\n      break\n  }\n\n  let content = null\n  if (!online) {\n    content = (\n      <SearchPlaceholder\n        primary='Search Disabled'\n        secondary='(Offline)'\n        icon={PortableWifiOffIcon}\n      />\n    )\n  }\n  else if (contextChoice && searchResults) {\n    content = (\n      <SearchResults\n        variant={currentTab}\n        loading={loading}\n        onResultClick={onResultClick}\n        fetchMore={fetchMore}\n        seriesList={searchResults}\n        contextChoice={contextChoice}\n        onCancel={() => setContextChoice(null)}\n      />\n    )\n  }\n  else if (contextResults) {\n    content = (\n      <SearchContextResults\n        loading={loading}\n        variant={currentTab}\n        contextResults={contextResults}\n        setContextChoice={currentTab === TABS.LOCATION ? onMapClick : setContextChoice}\n      />\n    )\n  }\n  else if (defaultText.length > 0) {\n    content = (\n      <Typography>Searching for {`'${searchText}'` || '...'}</Typography>\n    )\n  }\n  else {\n    content = <SearchPlaceholder {...placeholder} />\n  }\n\n  return (\n    <div className={classes.root}>\n      <TopBar>\n        <SearchInput\n          disabled={!online}\n          autoFocus\n          onChange={setSearchText}\n          defaultValue={searchText}\n        />\n      </TopBar>\n      {online && (\n        <Tabs\n          value={currentTab}\n          disabled={!online}\n          onChange={(e, val) => setCurrentTab(val)}\n          indicatorColor='primary'\n          classes={{ flexContainer: classes.tabs }}\n          centered\n        >\n          <Tab className={classes.tab} value={TABS.TAG} label='Tags' />\n          <Tab className={classes.tab} value={TABS.LOCATION} label='Places' />\n          <Tab className={classes.tab} value={TABS.USER} label='Users' />\n        </Tabs>\n      )}\n      {content}\n    </div>\n  )\n}\n\nSearch.propTypes = {\n  onMenuBack: PropTypes.func.isRequired,\n  loading: PropTypes.bool,\n  currentTab: PropTypes.string.isRequired,\n  setCurrentTab: PropTypes.func.isRequired,\n  searchText: PropTypes.string.isRequired,\n  setSearchText: PropTypes.func.isRequired,\n  fetchMore: PropTypes.func,\n  contextResults: PropTypes.array,\n  searchResults: PropTypes.array,\n  contextChoice: PropTypes.object,\n  setContextChoice: PropTypes.func.isRequired,\n  onMapClick: PropTypes.func.isRequired,\n  onResultClick: PropTypes.func.isRequired\n}\nSearch.defaultProps = {\n  currentTab: TABS.TAGS,\n  defaultText: ''\n}\n\nexport default Search\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\nimport { home } from '../config'\n// import { smallestHash } from 'geotilehash'\nimport { graphql, compose } from 'react-apollo'\nimport { point, bbox as bboxFunc, buffer } from '@turf/turf'\n\nimport { connect } from 'react-redux'\nimport actions from '../redux/actions'\nimport { tagSearch, seriesWithTag, userSearch, userSeries, geocode } from './queries'\nimport Search from '../components/Search/Search'\n// import { AppContext } from '../contexts'\n// import { debounce } from '../lib/util'\nimport { formatDatAgo } from '../lib/datelib'\n\nconst SearchConnect = ({\n  jumpToMap, jumpToSeries, defaultTab, defaultText, fetchMore\n}) => {\n  // const { role, user } = useContext(AppContext)\n\n  const [currentTab, setCurrentTab] = useState(defaultTab || home.SEARCH_TABS.TAG)\n  // We separate these because one of them needs to be immediate and the\n  const [searchText, setSearchText] = useState(defaultText || '')\n  const [contextChoice, setContextChoice] = useState(null)\n\n  const handleTabChange = (newTab) => {\n    setContextChoice(null)\n    setCurrentTab(newTab)\n  }\n  const handleContextChoiceChange = (newContextChoice) => {\n    setContextChoice(newContextChoice)\n  }\n  const handleSearchTextChange = (text) => {\n    setSearchText(text)\n    setContextChoice(null)\n  }\n\n  let withContextQuery = null\n  let withSearchQuery = null\n\n  switch (currentTab) {\n    case home.SEARCH_TABS.TAG:\n      withContextQuery = withTagSearch\n      withSearchQuery = withTagSeries\n      break\n    case home.SEARCH_TABS.LOCATION:\n      withContextQuery = withGeoCode\n      // withSearchQuery = withGeoSearch\n      break\n    case home.SEARCH_TABS.USER:\n      withContextQuery = withUserSearch\n      withSearchQuery = withUserSeries\n      break\n    default:\n      break\n  }\n\n  const ComposedSearch = withSearchQuery\n    ? compose(\n      withContextQuery,\n      withSearchQuery\n    )(Search)\n    : withContextQuery(Search)\n\n  return <ComposedSearch {...{ currentTab, searchText, contextChoice }}\n    onMenuBack={() => {}}\n    onMapClick={jumpToMap}\n    onResultClick={jumpToSeries}\n    setContextChoice={handleContextChoiceChange}\n    fetchMore={fetchMore}\n    setCurrentTab={handleTabChange}\n    setSearchText={handleSearchTextChange}\n  />\n}\nSearchConnect.propTypes = {\n  searchResults: PropTypes.array,\n  contextResults: PropTypes.array,\n  loading: PropTypes.bool,\n  jumpToMap: PropTypes.func,\n  jumpToSeries: PropTypes.func,\n  fetchMore: PropTypes.func\n}\n/*****************************************************************\n *  PART 1: SEARCH QUERIES\n *****************************************************************/\n\n/**\n * Here's the graphql HOC that gets an individual series\n */\nconst withTagSearch = graphql(tagSearch, {\n  props: ({ data }) => {\n    if (data.error) console.error(data.error)\n    // console.log('withTagSearch', data)\n    let series = null\n    try {\n      if (!data.loading && !data.error) series = data.series\n    }\n    catch (e) {\n      console.error(data)\n      console.error(e)\n    }\n    const contextResults = data.tags ? data.tags.map(({ name, count }) => ({\n      name, description: `~ ${Math.ceil(count / 10) * 10} Photo series tagged`\n    })) : []\n\n    return {\n      contextResults,\n      loading: data.loading,\n      series\n    }\n  },\n  // skip: ({ searchText }) => !searchText || searchText.length < 3,\n  options: ({ searchText }) => ({\n    variables: {\n      tag: !searchText || searchText.length < 3 ? '' : searchText,\n      limit: 10\n    }\n  })\n})\n\nconst withUserSearch = graphql(userSearch, {\n  props: ({ data }) => {\n    if (data.error) console.error(data.error)\n    // console.log('withUserSearch', data)\n    let series = null\n    try {\n      if (!data.loading && !data.error) series = data.series\n    }\n    catch (e) {\n      console.error(data)\n      console.error(e)\n    }\n\n    const contextResults = data.userSearch ? data.userSearch.map(({ username, gravatar, createdOn, id }) => ({\n      name: username,\n      id,\n      description: `Joined ${formatDatAgo(createdOn)}`,\n      gravatar\n    })) : []\n\n    return {\n      contextResults,\n      loading: data.loading,\n      series\n    }\n  },\n  skip: ({ searchText }) => !searchText || searchText.length < 3,\n  options: ({ searchText }) => ({\n    variables: {\n      searchStr: searchText,\n      limit: 10\n    }\n  })\n})\n\nconst withGeoCode = graphql(geocode, {\n  props: ({ data }) => {\n    if (data.error) console.error(data.error)\n    // console.log('withGeoCode', data)\n    let series = null\n    try {\n      if (!data.loading && !data.error) series = data.series\n    }\n    catch (e) {\n      console.error(data)\n      console.error(e)\n    }\n\n    const contextResults = data.geocoder ? data.geocoder.map(({ relevance, text, placeName, bbox, center }) => ({\n      name: text,\n      description: placeName,\n      bbox,\n      center,\n      relevance\n    })) : []\n\n    return {\n      contextResults,\n      loading: data.loading,\n      series\n    }\n  },\n  skip: ({ searchText }) => !searchText || searchText.length < 3,\n  options: ({ searchText }) => ({\n    variables: {\n      search: searchText\n      // limit: 10\n    }\n  })\n})\n\n/*****************************************************************\n * PART 2: SERIES SEARCH QUERIES\n *****************************************************************/\n\nconst withTagSeries = graphql(seriesWithTag, {\n  props: ({ data }) => {\n    if (data.error) console.error(data.error)\n    // console.log('withTagSeries', data)\n    let series = null\n    try {\n      if (!data.loading && !data.error) series = data.series\n    }\n    catch (e) {\n      console.error(data)\n      console.error(e)\n    }\n\n    // A second Thunk function designed to get more elements in the feed history\n    const fetchMore = data.loading || !data.tagSeries || !data.tagSeries.nextToken ? null : () => {\n      console.log('fetchMore', data)\n      data.fetchMore({\n        variables: { ...data.variables, nextToken: data.tagSeries.nextToken },\n        // How do we mush the new query with the old one\n        updateQuery: (prev, { fetchMoreResult }) => {\n          return {\n            tagSeries: {\n              ...fetchMoreResult.tagSeries,\n              seriesSummaries: [ ...prev.tagSeries.seriesSummaries, ...fetchMoreResult.tagSeries.seriesSummaries ]\n            }\n          }\n        }\n      })\n    }\n\n    const searchResults = data.tagSeries && data.tagSeries.seriesSummaries\n      ? data.tagSeries.seriesSummaries\n      : []\n\n    return {\n      searchResults,\n      fetchMore,\n      loading: data.loading,\n      series\n    }\n  },\n  skip: ({ contextChoice }) => !contextChoice,\n  options: ({ contextChoice }) => ({\n    variables: {\n      tag: contextChoice.name,\n      limit: 10\n    }\n  })\n})\n\nconst withUserSeries = graphql(userSeries, {\n  props: ({ data }) => {\n    if (data.error) console.error(data.error)\n    // console.log('withUserSeries', data)\n    let series = null\n    try {\n      if (!data.loading && !data.error) series = data.series\n    }\n    catch (e) {\n      console.error(data)\n      console.error(e)\n    }\n\n    // A second Thunk function designed to get more elements in the feed history\n    const fetchMore = data.loading || !data.userSeries || !data.userSeries.nextToken ? null : () => {\n      console.log('fetchMore', data)\n      data.fetchMore({\n        variables: { ...data.variables, nextToken: data.userSeries.nextToken },\n        // How do we mush the new query with the old one\n        updateQuery: (prev, { fetchMoreResult }) => {\n          return {\n            userSeries: {\n              ...fetchMoreResult.userSeries,\n              seriesSummaries: [ ...prev.userSeries.seriesSummaries, ...fetchMoreResult.userSeries.seriesSummaries ]\n            }\n          }\n        }\n      })\n    }\n\n    const searchResults = data.userSeries && data.userSeries.seriesSummaries\n      ? data.userSeries.seriesSummaries\n      : []\n\n    return {\n      searchResults,\n      fetchMore,\n      loading: data.loading,\n      series\n    }\n  },\n  skip: ({ contextChoice }) => !contextChoice,\n  options: ({ contextChoice }) => ({\n    variables: {\n      createdBy: contextChoice.id,\n      limit: 10\n    }\n  })\n})\n\n// const withGeoSearch = graphql(geoSeries, {\n//   props: ({ data }) => {\n//     if (data.error) console.error(data.error)\n//     // console.log('HERE', data)\n//     let series = null\n//     try {\n//       if (!data.loading && !data.error) series = data.series\n//     }\n//     catch (e) {\n//       console.error(data)\n//       console.error(e)\n//     }\n//     return {\n//       data,\n//       loading: data.loading,\n//       series\n//     }\n//   },\n//   skip: ({ contextChoice }) => !contextChoice,\n//   options: ({ contextChoice }) => ({\n//     variables: {\n//       bounds: contextChoice.bbox\n//       // limit: 10\n//       // nextToken\n//     }\n//   })\n// })\n\n/**\n * Map our redux state and functions\n */\nconst mapStateToProps = (state, props) => {\n  const { current: { search, activeSeries, domain } } = state.home\n  return {\n    defaultTab: search ? search.tab : null,\n    defaultText: search ? search.text : null,\n    activeSeries,\n    domain\n  }\n}\n\nconst mapDispatchToProps = dispatch => ({\n  onBack: () => {\n    dispatch(actions.homeStateBack())\n  },\n  queueUpload: (uploadObj) => {\n    dispatch(actions.queueUpload(uploadObj))\n  },\n  jumpToSeries: (seriesId) => {\n    dispatch(actions.setHomeState(home.AppStateTypes.SERIES, { activeSeries: seriesId }))\n  },\n\n  jumpToMap: ({ bbox, center }) => {\n    let bounds = bbox\n    if (!bounds && center) {\n      const bufferPts = buffer(point(center), 500, { units: 'meters' })\n      bounds = bboxFunc(bufferPts)\n    }\n\n    if (bounds) {\n      dispatch(actions.pushMapHistory({\n        mode: home.MapModeTypes.FREE,\n        bounds: bounds\n      }))\n      dispatch(actions.setHomeState(home.AppStateTypes.MAP, { activeSeries: null, initialPhoto: null }))\n    }\n  }\n})\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(SearchConnect)\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport ListItem from '@material-ui/core/ListItem'\nimport ListItemText from '@material-ui/core/ListItemText'\n// import MenuIcon from '@material-ui/icons/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nimport { formatDate } from '../../lib/datelib'\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n\n  },\n  gravatarImg: {\n    display: 'block',\n    marginLeft: theme.spacing(1),\n    marginRight: theme.spacing(2),\n    width: '100%',\n    maxWidth: '25%',\n    height: 'auto'\n  }\n}))\n\nconst MeCard = ({ user, loading, onAvatarClick }) => {\n  const classes = useStyles()\n\n  if (loading || !user) return 'LOADING...'\n  console.log('USER', user)\n\n  return (\n    <ListItem className={classes.root} onClick={onAvatarClick} disableGutters>\n      <img alt='profile' className={classes.gravatarImg} src={user.gravatar} />\n      <ListItemText\n        primary={user.username}\n        secondary={`Member since: ${formatDate(user.createdOn, 'LL')}`}\n      />\n    </ListItem>\n  )\n}\n\nMeCard.propTypes = {\n  user: PropTypes.object,\n  loading: PropTypes.bool,\n  onAvatarClick: PropTypes.func\n}\n\nexport default MeCard\n","import React, { useState } from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\nimport Divider from '@material-ui/core/Divider'\n\nimport SeriesListItem from '../misc/SeriesListItem'\nimport { makeStyles } from '@material-ui/core/styles'\nimport TopBar from '../TopBar'\nimport MeCard from './MeCard'\nimport { Paper, Button } from '@material-ui/core'\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    display: 'flex',\n    flexDirection: 'column',\n    height: '100%'\n  },\n  filterContainer: {\n    color: '#AAAAAA',\n    padding: theme.spacing(1, 1)\n  },\n  filterChip: {\n\n  },\n  seriesListItemWrap: {\n    margin: theme.spacing(1, 0.5)\n  },\n  seriesList: {\n    height: '100%',\n    overflowX: 'hidden',\n    overflowY: 'scroll'\n  }\n}))\n\nconst FILTERS = {\n  ALL: 'All',\n  OWN: 'Mine',\n  CONTRIBUTED: 'Contributed',\n  WATCHING: 'Watching'\n}\n\nconst SORT = {\n  ACTIVITY: 'Last Photo',\n  CREATED: 'Created',\n  NAME: 'Name'\n}\n\nconst MyProfile = ({ user, feed, loading, jumpToSeries, jumpToMap }) => {\n  const classes = useStyles()\n\n  const [filterVal, setFilter] = useState(FILTERS.ALL)\n  const [sortVal, setSort] = useState(SORT.ACTIVITY)\n  const [sortAsc, setSortAsc] = useState(true)\n\n  const sortSetter = (newSort) => {\n    if (newSort === sortVal) setSortAsc(!sortAsc)\n    else setSort(newSort)\n  }\n\n  let filteredFeed = []\n\n  switch (filterVal) {\n    case FILTERS.ALL:\n      filteredFeed = [...feed]\n      break\n    case FILTERS.OWN:\n      filteredFeed = feed.filter(fi => fi.createdUser.id === user.id)\n      break\n    case FILTERS.CONTRIBUTED:\n      filteredFeed = []\n      break\n    case FILTERS.WATCHING:\n      filteredFeed = feed.filter(fi => user.watching.indexOf(fi.id) > -1)\n      break\n    default:\n      break\n  }\n\n  switch (sortVal) {\n    case SORT.ACTIVITY:\n      if (sortAsc) filteredFeed.sort((a, b) => a.latest.takenOn - b.latest.takenOn)\n      else filteredFeed.sort((a, b) => b.latest.takenOn - a.latest.takenOn)\n      break\n    case SORT.CREATED:\n      if (sortAsc) filteredFeed.sort((a, b) => a.createdOn - b.createdOn)\n      else filteredFeed.sort((a, b) => b.createdOn - a.createdOn)\n      break\n    case SORT.NAME:\n      if (sortAsc) {\n        filteredFeed.sort((a, b) => {\n          if (a.name < b.name) {\n            return -1\n          }\n          if (a.name > b.firstname) {\n            return 1\n          }\n          return 0\n        })\n      }\n      else {\n        filteredFeed.sort((a, b) => {\n          if (b.name < a.name) {\n            return -1\n          }\n          if (b.name > a.name) {\n            return 1\n          }\n          return 0\n        })\n      }\n      break\n    default:\n      break\n  }\n\n  return (\n    <div className={classes.root}>\n      <TopBar>\n        <Typography>My Profile</Typography>\n      </TopBar>\n      <MeCard user={user} />\n      <Divider />\n      <div className={classes.filterContainer}>\n        <div>\n          <Typography component='span'>Filter: </Typography>\n          <FilterSortItem active={filterVal === FILTERS.ALL} onClick={() => setFilter(FILTERS.ALL)} label={FILTERS.ALL} />\n        |\n          <FilterSortItem active={filterVal === FILTERS.OWN} onClick={() => setFilter(FILTERS.OWN)} label={FILTERS.OWN} />\n          {/* |\n          <FilterSortItem active={filterVal === FILTERS.CONTRIBUTED} onClick={() => setFilter(FILTERS.CONTRIBUTED)} label={FILTERS.CONTRIBUTED} /> */}\n        |\n          <FilterSortItem active={filterVal === FILTERS.WATCHING} onClick={() => setFilter(FILTERS.WATCHING)} label={FILTERS.WATCHING} />\n\n        </div>\n        <div>\n          <Typography component='span'>Sort: </Typography>\n          <FilterSortItem asc={sortAsc} active={sortVal === SORT.NAME} onClick={() => sortSetter(SORT.NAME)} label={SORT.NAME} />\n        |\n          <FilterSortItem asc={sortAsc} active={sortVal === SORT.ACTIVITY} onClick={() => sortSetter(SORT.ACTIVITY)} label={SORT.ACTIVITY} />\n        |\n          <FilterSortItem asc={sortAsc} active={sortVal === SORT.CREATED} onClick={() => sortSetter(SORT.CREATED)} label={SORT.CREATED} />\n        </div>\n      </div>\n      <div className={classes.seriesList}>\n        {filteredFeed.map((series, idx) => (\n          <Paper className={classes.seriesListItemWrap} key={`seriesListItem${idx}`}>\n            <SeriesListItem\n              series={series}\n              showCreatedOn\n              showLastPhoto\n              onClick={() => jumpToSeries(series.id)}\n            />\n          </Paper>\n        ))}\n      </div>\n    </div>\n  )\n}\n\nMyProfile.propTypes = {\n  user: PropTypes.object,\n  loading: PropTypes.object.isRequired,\n  feed: PropTypes.array.isRequired,\n  jumpToSeries: PropTypes.func.isRequired,\n  jumpToMap: PropTypes.func.isRequired\n}\n\nexport default MyProfile\n\nconst useFilterStyles = makeStyles(theme => ({\n  root: {\n    margin: theme.spacing(0, 1, 0, 1)\n  }\n}))\n\nconst FilterSortItem = ({ active, asc, onClick, label }) => {\n  const classes = useFilterStyles()\n\n  const arrow = active && typeof asc !== 'undefined'\n    ? asc === true ? '' : ''\n    : ' '\n\n  return (\n    <Button\n      className={classes.root}\n      onClick={onClick}\n      // variant='caption'\n      color={active ? 'secondary' : 'inherit'}\n    >\n      {label} {arrow}\n    </Button>\n  )\n}\n\nFilterSortItem.propTypes = {\n  active: PropTypes.bool,\n  asc: PropTypes.bool,\n  onClick: PropTypes.func.isRequired,\n  label: PropTypes.string.isRequired\n}\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport { graphql, compose } from 'react-apollo'\nimport actions from '../redux/actions'\nimport { connect } from 'react-redux'\nimport { home } from '../config'\nimport { getUser, userSeries, seriesFromList } from './queries'\nimport MyProfile from '../components/MyProfile/MyProfile'\n\nconst ProfileConnect = ({ data, jumpToSeries, jumpToMap }) => {\n  const { userQ, seriesQ, watchedSeriesQ } = data\n  const user = userQ && userQ.user ? userQ.user : null\n\n  const seriesQArr = seriesQ && seriesQ.userSeries && seriesQ.userSeries.seriesSummaries ? seriesQ.userSeries.seriesSummaries : []\n  const watchedSeriesQArr = watchedSeriesQ && watchedSeriesQ.arraySeries ? watchedSeriesQ.arraySeries : []\n  console.log('ProfileConnect', { seriesQArr, watchedSeriesQ, watchedSeriesQArr })\n  const feed = [...seriesQArr, ...watchedSeriesQArr]\n  const loading = {\n    user: userQ.loading,\n    list: Boolean(\n      (seriesQ && seriesQ.loading) ||\n      (watchedSeriesQ && watchedSeriesQ.loading))\n  }\n\n  return <MyProfile {...{ user, loading, feed, jumpToSeries, jumpToMap }} />\n}\n\nProfileConnect.propTypes = {\n  data: PropTypes.object, // from graphql\n  jumpToSeries: PropTypes.func, // from redux\n  jumpToMap: PropTypes.func // from redux\n}\n\n// This one is really simple.\nconst withGetUserQuery = graphql(getUser, {\n  props: ({ data, ownProps }) => {\n    // console.log('ProfileConnect withGetUserQuery', { data, ownProps })\n    return { data: { userQ: data } }\n  }\n})\n\nconst withuserSeriesQuery = graphql(userSeries, {\n  skip: ({ data }) => !data.userQ.user,\n  props: ({ data, ownProps }) => {\n    // console.log('ProfileConnect withuserSeriesQuery', { data, ownProps })\n    return { data: { ...ownProps.data, seriesQ: data } }\n  }\n})\n\n// const withMyPhotosQuery = graphql(myPhotos)\n\nconst withMyWatchedSeriesQuery = graphql(seriesFromList, {\n  props: ({ data, ownProps }) => {\n    // console.log('ProfileConnect withMyWatchedSeriesQuery', { data, ownProps })\n    return { data: { ...ownProps.data, watchedSeriesQ: data } }\n  },\n  skip: ({ data }) => {\n    try {\n      return data.userQ.user.watching.length < 1\n    }\n    catch (e) {\n      return true\n    }\n  },\n  options: ({ data }) => {\n    return {\n      variables: { seriesList: data.userQ.user.watching }\n    }\n  }\n})\n\n/**\n * Compose all our queries together\n */\nconst queryWrapped = compose(\n  withGetUserQuery,\n  withuserSeriesQuery,\n  // withMyPhotosQuery,\n  withMyWatchedSeriesQuery\n)(ProfileConnect)\n\n/**\n * Map our redux state and functions\n */\nconst mapStateToProps = (state, props) => {\n  return { }\n}\n\nconst mapDispatchToProps = dispatch => ({\n  jumpToSeries: (seriesId) => {\n    dispatch(actions.setHomeState(home.AppStateTypes.SERIES, { activeSeries: seriesId }))\n  },\n  jumpToMap: (seriesId) => {\n    dispatch(actions.setHomeState(home.AppStateTypes.MAP, { activeSeries: seriesId }))\n  }\n})\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(queryWrapped)\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\n// import MenuIcon from '@material-ui/icons/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nconst useStyles = makeStyles(theme => ({\n  root: {\n    textAlign: 'center',\n    fontStyle: 'italic',\n    padding: theme.spacing(2, 1)\n  }\n}))\n\nconst FeedEnder = ({ style, icon, text }) => {\n  const classes = useStyles()\n  return (\n    <Typography className={classes.root} variant='subtitle1' color='textSecondary' component='div' style={style}>\n      {icon}\n      {text}\n    </Typography>\n  )\n}\n\nFeedEnder.propTypes = {\n  style: PropTypes.object,\n  icon: PropTypes.any,\n  text: PropTypes.string\n}\n\nexport default FeedEnder\n","import React from 'react'\nimport PropTypes from 'prop-types'\nimport Avatar from '@material-ui/core/Avatar'\nimport IconButton from '@material-ui/core/IconButton'\n\nimport PlaceIcon from '@material-ui/icons/Place'\nimport { makeStyles } from '@material-ui/core/styles'\nconst useStyles = makeStyles(theme => ({\n  root: {\n    textAlign: 'center'\n  },\n  placeAvatar: {\n    color: theme.palette.primary.contrastText,\n    border: `2px solid ${theme.palette.primary.contrastText}`,\n    background: theme.palette.text.primary,\n    margin: 'auto'\n  },\n  placeIcon: {\n  }\n}))\n\nconst FindOnMapButton = ({ onClick }) => {\n  const classes = useStyles()\n  return (\n    <div className={classes.root}>\n      <Avatar className={classes.placeAvatar}>\n        <IconButton color='inherit' onClick={e => {\n          e.preventDefault()\n          e.stopPropagation()\n          onClick()\n        }}>\n          <PlaceIcon color='inherit' />\n        </IconButton>\n      </Avatar>\n      {/* <Typography variant='caption' component='div'>MAP</Typography> */}\n    </div>\n  )\n}\n\nFindOnMapButton.propTypes = {\n  onClick: PropTypes.func.isRequired\n}\n\nexport default FindOnMapButton\n","import React, { useContext } from 'react'\nimport PropTypes from 'prop-types'\nimport Paper from '@material-ui/core/Paper'\nimport Typography from '@material-ui/core/Typography'\n// import MenuIcon from '@material-ui/icons/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nimport FindOnMapButton from '../misc/FindOnMapButton'\n// import StarIcon from '@material-ui/icons/Star'\n// import StarBorderIcon from '@material-ui/icons/StarBorder'\nimport { Avatar } from '@material-ui/core'\nimport { AppContext } from '../../contexts'\nimport { formatDate } from '../../lib/datelib'\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    height: '100%',\n    // borderTop: `4px solid ${theme.palette.grey[700]}`\n    padding: theme.spacing(0.5, 1)\n  },\n  imgContainer: {\n    overflow: 'hidden',\n    height: '100%',\n    position: 'relative'\n  },\n  findOnMapButtonContainer: {\n    position: 'absolute',\n    opacity: 0.8,\n    bottom: theme.spacing(1),\n    right: theme.spacing(1)\n  },\n  titleContainer: {\n    background: '#444444AA',\n    textShadow: '1px 1px 10px black',\n    color: 'white',\n    position: 'absolute',\n    alignItems: 'center',\n    display: 'flex',\n    top: 0,\n    width: '100%',\n    paddingRight: theme.spacing(1)\n  },\n  avatar: {\n    border: '1px solid white',\n    margin: theme.spacing(0, 1)\n  },\n  title: {\n    flexGrow: 1\n  },\n  img: {\n    objectFit: 'cover',\n    height: '100%',\n    width: '100%'\n  },\n  gravatarImg: {\n    width: '100%'\n  }\n}))\n\nconst EVENT_VERBS = {\n  DELETE: 'Deleted',\n  ADD: 'Added'\n}\n\nconst FeedItem = ({ event, onMapClick, onImageClick, onProfileClick, onSeriesClick }) => {\n  const { series, photo } = event\n  // console.log('EVENT', { series, relation, photo })\n  const classes = useStyles()\n  const { seriesConfig } = useContext(AppContext)\n  return (\n    <div className={classes.root}>\n      <Paper className={classes.imgContainer}>\n        <img\n          alt='medium'\n          className={classes.img}\n          src={seriesConfig.getPhotoUrl(photo, 'medium')}\n          onClick={() => onImageClick(series.id, photo.id)}\n        />\n        <div className={classes.titleContainer}>\n          <Avatar onClick={() => onProfileClick(photo.createdUser.username)} className={classes.avatar}>\n            <img alt='profile' className={classes.gravatarImg} src={photo.createdUser.gravatar} />\n          </Avatar>\n          <div className={classes.title}>\n            <Typography variant='body1' color='inherit'>{series.name}</Typography>\n            <Typography variant='body2' color='inherit'>{photo.createdUser.username} {EVENT_VERBS.ADD} a photo</Typography>\n            <Typography variant='caption' color='inherit'>{formatDate(photo.updatedOn)}</Typography>\n          </div>\n          <FindOnMapButton onClick={() => onMapClick(series.id, photo.id)} />\n        </div>\n      </Paper>\n    </div>\n  )\n}\n\nFeedItem.propTypes = {\n  // TODO: THIS IS NOT THE SHAPE WE WANT. NEED TO HASH THIS OUT\n  event: PropTypes.object.isRequired,\n  onSeriesClick: PropTypes.func.isRequired,\n  onImageClick: PropTypes.func.isRequired,\n  onProfileClick: PropTypes.func.isRequired,\n  onMapClick: PropTypes.func.isRequired\n}\n\nexport default FeedItem\n\nexport const FeedItemCosmos = (props) => {\n  return (\n    <div>\n      <FeedItem {...props} />\n      <FeedItem {...props} />\n      <FeedItem {...props} />\n      <FeedItem {...props} />\n      <FeedItem {...props} />\n      <FeedItem {...props} />\n      <FeedItem {...props} />\n      <FeedItem {...props} />\n      <FeedItem {...props} />\n      <FeedItem {...props} />\n      <FeedItem {...props} />\n    </div>\n  )\n}\nFeedItemCosmos.propTypes = {\n  // TODO: THIS IS NOT THE SHAPE WE WANT. NEED TO HASH THIS OUT\n  event: PropTypes.object.isRequired\n}\n","import React, { useRef } from 'react'\nimport PropTypes from 'prop-types'\nimport Typography from '@material-ui/core/Typography'\n\nimport { List } from 'react-virtualized' // InfiniteLoader\nimport useOnline from '../../lib/useOnline'\nimport FeedEnder from './FeedEnder'\n\nimport ErrorIcon from '@material-ui/icons/Error'\nimport { makeStyles } from '@material-ui/core/styles'\nimport FeedItem from './FeedItem'\n\nimport TopBar from '../TopBar'\n\nimport useComponentSize from '../../lib/useComponentSize'\n\nconst ROWHEIGHT = 300\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    display: 'flex',\n    flexDirection: 'column',\n    height: '100%'\n  },\n  listContainer: {\n    flexGrow: 1,\n    overflow: 'hidden'\n  },\n  vList: {\n    height: '100%',\n    width: '100%'\n  },\n  feedContainer: {\n    flexGrow: 1,\n    // Promote the list into his own layer on Chrome. This cost memory but helps keeping high FPS.\n    transform: 'translateZ(0)'\n  },\n  grow: {\n    flexGrow: 1\n  }\n}))\n\nconst MyFeed = ({\n  events, loading, onMapClick, onImageClick, onProfileClick,\n  onSeriesClick, fetchNewest, fetchMore, window\n}) => {\n  const classes = useStyles()\n  const listRef = useRef()\n  const { size } = useComponentSize(listRef)\n  const { online } = useOnline()\n\n  const rowRenderer = ({\n    index, // Index of row\n    isScrolling, // The List is currently being scrolled\n    isVisible, // This row is visible within the List (eg it is not an overscanned row)\n    key, // Unique key within array of rendered rows\n    parent, // Reference to the parent List (instance)\n    style // Style object to be applied to row (to position it);\n    // This must be passed through to the rendered row element.\n  }) => {\n    const row = events[index]\n    let content\n    if (index < events.length && row) {\n      content = <FeedItem\n        event={events[index]}\n        onSeriesClick={onSeriesClick}\n        onImageClick={onImageClick}\n        onProfileClick={onProfileClick}\n        onMapClick={onMapClick}\n      />\n    }\n    else if (index === events.length) {\n      // content = <div className={classes.placeholder} style={{ width: row.size }} />\n      const wEnd = window && window[0] === 0\n      content = <FeedEnder text='Loading...' />\n\n      const almostAtEnd = ROWHEIGHT * 4 + parent.state.scrollTop > style.top\n\n      if (!online) {\n        content = <FeedEnder icon={<ErrorIcon />} text='Cannot Refresh Offline' />\n      }\n      else if (wEnd) {\n        content = <FeedEnder text='End of feed' />\n      }\n      // Only if we're online, not loading and visible\n      else if (!loading && almostAtEnd) {\n        fetchMore()\n      }\n    }\n\n    return (\n      <div className={classes.row} key={key} style={style}>\n        {content}\n      </div>\n    )\n  }\n  rowRenderer.propTypes = {\n    index: PropTypes.any,\n    key: PropTypes.any,\n    style: PropTypes.any,\n    isScrolling: PropTypes.any,\n    isVisible: PropTypes.any,\n    parent: PropTypes.any\n  }\n\n  // console.log('DEBUGLIST', size)\n\n  return (\n    <div className={classes.root}>\n      <TopBar>\n        <Typography className={classes.grow}>Home Feed</Typography>\n      </TopBar>\n      <div className={classes.listContainer} ref={listRef}>\n        <List\n          height={size.height}\n          width={size.width}\n          className={classes.vList}\n          rowCount={events.length + 1}\n          rowHeight={ROWHEIGHT}\n          rowRenderer={rowRenderer}\n        />\n      </div>\n    </div>\n  )\n}\n\nMyFeed.propTypes = {\n  events: PropTypes.array.isRequired,\n  loading: PropTypes.bool,\n  window: PropTypes.arrayOf(PropTypes.number),\n  onSeriesClick: PropTypes.func.isRequired,\n  onImageClick: PropTypes.func.isRequired,\n  onProfileClick: PropTypes.func.isRequired,\n  onMapClick: PropTypes.func.isRequired,\n  fetchNewest: PropTypes.func.isRequired,\n  fetchMore: PropTypes.func.isRequired\n}\n\nexport default MyFeed\n","import React, { useRef, useState, useEffect } from 'react'\nimport PropTypes from 'prop-types'\nimport { graphql } from 'react-apollo'\nimport { home } from '../config'\nimport actions from '../redux/actions'\nimport { connect } from 'react-redux'\nimport { getMyFeed } from './queries'\nimport MyFeed from '../components/MyFeed/MyFeed'\nimport useOnline from '../lib/useOnline'\n\nconst POLL_INTERVAL = 20 // (seconds)\nconst FEED_LIMIT = 5 // (items to load)\n\nconst FeedConnect = ({\n  data, loading, fetchMore, fetchNewest,\n  loadingNewest,\n  loadingMore,\n  jumpToSeries,\n  jumpToMap,\n  jumpToUser\n}) => {\n  const timerRef = useRef()\n  const { online } = useOnline()\n  const [lastCheck, setLastCheck] = useState(null)\n  timerRef.current = lastCheck\n\n  // Initiate the polling process. We simply update the timestamp every N seconds\n  useEffect(() => {\n    function ping () {\n      if (!loading && online) fetchNewest()\n      if (timerRef.current) setLastCheck(String(Date.now() - POLL_INTERVAL * 1000))\n    }\n    if (!timerRef.current) timerRef.current = setInterval(ping, POLL_INTERVAL * 1000)\n    return () => {\n      if (timerRef.current) {\n        console.log('clear poll timer')\n        clearInterval(timerRef.current)\n        timerRef.current = null\n      }\n    }\n  }, [])\n\n  const events = data.myFeed ? data.myFeed.feed || [] : []\n  const window = data.myFeed ? data.myFeed.window.map(v => parseInt(v, 10)) || [null, null] : [null, null]\n\n  return (\n    <MyFeed {...{ events, loading, window, fetchMore, fetchNewest, jumpToSeries }}\n      onSeriesClick={() => {}}\n      onImageClick={jumpToSeries}\n      onProfileClick={jumpToUser}\n      onMapClick={jumpToMap}\n    />\n  )\n}\n\nFeedConnect.propTypes = {\n  data: PropTypes.object, // from graphql\n  loading: PropTypes.bool, // from graphql\n  loadingNewest: PropTypes.bool, // from graphql\n  loadingMore: PropTypes.bool, // from graphql\n  fetchMore: PropTypes.func,\n  fetchNewest: PropTypes.func,\n  jumpToSeries: PropTypes.func,\n  jumpToMap: PropTypes.func,\n  jumpToUser: PropTypes.func\n}\n\nconst withFeedQuery = graphql(getMyFeed, {\n  props: ({ data }) => {\n    if (data.error) console.error(data.error)\n\n    // TODO: Not sure this will propagate correctly. Test it.\n    let loadingNewest = false\n    let loadingMore = false\n\n    // console.log('withFeedQuery', data)\n\n    // One Thunk function designed for getting everything since the last check\n    const fetchNewest = () => {\n      loadingNewest = true\n      console.log('fetchNewest', data)\n      data.fetchMore({\n        variables: { ...data.variables, start: data.myFeed.window[1] },\n        // How do we mush the new query with the old one\n        updateQuery: (prev, { fetchMoreResult }) => {\n          loadingNewest = false\n          return {\n            myFeed: {\n              ...fetchMoreResult.myFeed,\n              // put the newest stuff first\n              feed: [ ...fetchMoreResult.myFeed.feed, ...prev.myFeed.feed ],\n              window: [prev.myFeed.window[0], fetchMoreResult.myFeed.window[1]]\n            }\n          }\n        }\n      })\n    }\n\n    // A second Thunk function designed to get more elements in the feed history\n    const fetchMore = () => {\n      loadingMore = true\n      console.log('fetchMore', data)\n      data.fetchMore({\n        variables: { ...data.variables, end: data.myFeed.window[0] },\n        // How do we mush the new query with the old one\n        updateQuery: (prev, { fetchMoreResult }) => {\n          loadingMore = false\n          return {\n            myFeed: {\n              ...fetchMoreResult.myFeed,\n              feed: [ ...prev.myFeed.feed, ...fetchMoreResult.myFeed.feed ],\n              window: [fetchMoreResult.myFeed.window[0], prev.myFeed.window[1]]\n            }\n          }\n        }\n      })\n    }\n\n    return {\n      data,\n      loadingNewest,\n      loadingMore,\n      fetchNewest, // This is the poll we do every n seconds\n      fetchMore, // This is when we scroll to the bottom of the list\n      loading: data.loading\n    }\n  },\n  // skip: ({ activeSeries, isNewSeries }) => !activeSeries || isNewSeries,\n  options: ({ activeSeries }) => ({\n    variables: {\n      limit: FEED_LIMIT\n    }\n  })\n})\n\n/**\n * Map our redux state and functions\n */\nconst mapStateToProps = (state, props) => {\n  return { }\n}\n\n// We're using graphql() HOC because it's convenient but it doesn't need to render anything\n// const FeedQueryConnect = withFeedQuery(() => null)\nconst mapDispatchToProps = dispatch => ({\n  jumpToSeries: (seriesId, photoId) => {\n    dispatch(actions.setHomeState(home.AppStateTypes.SERIES, { activeSeries: seriesId, initialPhoto: photoId }))\n  },\n  jumpToUser: (username) => {\n    dispatch(actions.setHomeState(home.AppStateTypes.SEARCH, { search: { tab: home.SEARCH_TABS.USER, text: username } }))\n  },\n  jumpToMap: (seriesId, photoId) => {\n    dispatch(actions.pushMapHistory({\n      mode: home.MapModeTypes.FREE\n    }))\n    dispatch(actions.setHomeState(home.AppStateTypes.MAP, { activeSeries: seriesId, initialPhoto: photoId }))\n  }\n})\n\nexport default connect(\n  mapStateToProps,\n  mapDispatchToProps\n)(\n  withFeedQuery(FeedConnect)\n)\n","import React, { useRef, useEffect, useState } from 'react'\nimport Typography from '@material-ui/core/Typography'\n// import MenuIcon from '@material-ui/icons/Menu'\nimport { makeStyles } from '@material-ui/core/styles'\nimport useOnline from '../../lib/useOnline'\nimport moment from 'moment'\n\nconst CHECKINTERVAL = 5000\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    background: 'black',\n    color: 'white',\n    textAlign: 'center'\n  }\n}))\n\nconst OfflineBar = () => {\n  const classes = useStyles()\n  const { online, since } = useOnline()\n  const [sinceStr, setSinceStr] = useState()\n  const timerRef = useRef()\n\n  const calcSinceStr = () => {\n    const newText = moment(since, 'x').fromNow()\n    // console.log('OFFLINE SINCE', since, newText)\n    setSinceStr(newText)\n  }\n  const clearTimer = () => {\n    if (timerRef.current) {\n      clearInterval(timerRef.current)\n      timerRef.current = null\n    }\n  }\n\n  useEffect(() => {\n    if (since && !timerRef.current) {\n      calcSinceStr()\n      timerRef.current = setInterval(calcSinceStr, CHECKINTERVAL)\n    }\n    else if (!since)clearTimer()\n    return () => {\n      clearTimer()\n    }\n  }, [since])\n\n  if (online) return null\n  return (\n    <Typography className={classes.root} variant='caption' component='div'>\n      Offline ({sinceStr})\n    </Typography>\n  )\n}\n\nexport default OfflineBar\n","import React from 'react'\nimport classNames from 'classnames'\nimport PropTypes from 'prop-types'\n\nimport CssBaseline from '@material-ui/core/CssBaseline'\nimport AppBar from '@material-ui/core/AppBar'\nimport Paper from '@material-ui/core/Paper'\nimport Typography from '@material-ui/core/Typography'\nimport Toolbar from '@material-ui/core/Toolbar'\nimport Button from '@material-ui/core/Button'\n// import Fab from '@material-ui/core/Fab'\n\nimport HomeIcon from '@material-ui/icons/HomeOutlined'\nimport MapIcon from '@material-ui/icons/MapOutlined'\nimport SearchIcon from '@material-ui/icons/SearchOutlined'\nimport AddIcon from '@material-ui/icons/Add'\nimport PersonOutline from '@material-ui/icons/PersonOutline'\nimport { makeStyles } from '@material-ui/core/styles'\n\nimport useOnline from '../lib/useOnline'\nimport AddFab from '../components/PhotoSeries/views/controls/AddFab'\nimport OfflineBar from './misc/OfflineBar'\n\nimport { ThemeProvider } from '@material-ui/styles'\nimport themes from '../themes'\n\nimport { home as homeConfig } from '../config'\n\nconst STATES = homeConfig.AppStateTypes\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    borderTop: `2px solid ${theme.palette.primary.main}`\n  },\n  text: {\n    padding: theme.spacing(2, 2, 0)\n  },\n  paper: {\n    paddingBottom: 50\n  },\n  list: {\n    marginBottom: theme.spacing(2)\n  },\n  subheader: {\n    backgroundColor: theme.palette.background.paper\n  },\n  grow: {\n    flexGrow: 1\n  },\n  addFab: {\n    position: 'absolute',\n    bottom: 0,\n    left: '50%',\n    transformOrigin: '0% 50%',\n    transform: 'translateY(-25%) translateX(-50%)',\n    zIndex: 3000\n  },\n  spacer: {\n    width: 40,\n    flexGrow: 1\n  }\n}))\n\nconst BottomBar = ({ className, domain, signedIn, onHomeClick, onMapClick, onSearchClick, onProfileClick, onCameraClick, onLibraryClick }) => {\n  const classes = useStyles()\n  const { online } = useOnline()\n\n  return (\n    <ThemeProvider theme={themes.bottombar}>\n      <AppBar position='static' className={classNames(classes.root, className)}>\n        <Toolbar>\n          {signedIn && (\n            <Button\n              edge='start'\n              className={classes.grow}\n              color={domain === STATES.FEED ? 'secondary' : 'inherit'}\n              onClick={onHomeClick}\n            >\n              <HomeIcon />\n            </Button>\n          )}\n          <Button\n            edge='start'\n            className={classes.grow}\n            color={domain === STATES.MAP ? 'secondary' : 'inherit'}\n            onClick={onMapClick}\n          >\n            <MapIcon />\n          </Button>\n          {signedIn && (\n            <AddFab\n              className={classes.addFab}\n              onCameraClick={onCameraClick}\n              onLibraryClick={onLibraryClick}\n            >\n              <AddIcon />\n            </AddFab>\n          )}\n          <div className={classes.spacer} />\n          <Button\n            color={domain === STATES.SEARCH ? 'secondary' : 'inherit'}\n            className={classes.grow}\n            disabled={!online}\n            onClick={onSearchClick}\n          >\n            <SearchIcon />\n          </Button>\n          {signedIn && (\n            <Button\n              edge='end'\n              color={domain === STATES.PROFILE ? 'secondary' : 'inherit'}\n              className={classes.grow}\n              onClick={onProfileClick}\n            >\n              <PersonOutline />\n            </Button>\n          )}\n        </Toolbar>\n      </AppBar>\n    </ThemeProvider>\n\n  )\n}\n\nBottomBar.propTypes = {\n  className: PropTypes.string,\n  domain: PropTypes.string,\n  signedIn: PropTypes.bool,\n  // Here are our button handlers\n  onHomeClick: PropTypes.func.isRequired,\n  onMapClick: PropTypes.func.isRequired,\n  onSearchClick: PropTypes.func.isRequired,\n  onProfileClick: PropTypes.func.isRequired,\n  onCameraClick: PropTypes.func.isRequired,\n  onLibraryClick: PropTypes.func.isRequired\n}\n\nexport default BottomBar\n\nexport const BottomBarCosmosWrapper = (props) => {\n  // const [someStateItem, setSomeStateItem] = useState()\n  const classes = useWrapperStyles()\n  return (\n    <div className={classes.root}>\n      <OfflineBar />\n      <CssBaseline /> {/* You only need this in a root element. Don't put it anywhere else in the dom */}\n      <Paper className={classes.paper}>\n        <Typography variant='h5'>\n          This is a dummy component.\n        </Typography>\n      </Paper>\n      <BottomBar {...props} />\n    </div>\n  )\n}\n\nconst wrapperStyle = theme => ({\n  root: {\n    height: '100%',\n    display: 'flex',\n    flexDirection: 'column'\n  },\n  paper: {\n    flexGrow: 1\n  }\n})\n\nconst useWrapperStyles = makeStyles(wrapperStyle)\n","import React, { useContext, useEffect } from 'react'\nimport PropTypes from 'prop-types'\n\nimport CssBaseline from '@material-ui/core/CssBaseline'\n\nimport UploaderConnect from './graphql/Uploader.connect'\nimport SeriesConnect from './graphql/Series.connect'\nimport MapConnect from './graphql/Map.connect'\nimport SearchConnect from './graphql/Search.connect'\nimport ProfileConnect from './graphql/Profile.connect'\nimport FeedConnect from './graphql/Feed.connect'\n\nimport OfflineBar from './components/misc/OfflineBar'\nimport BottomBar from './components/BottomBar'\nimport { AppContext } from './contexts'\n\nimport { makeStyles } from '@material-ui/core/styles'\nimport { home as homeConfig } from './config'\n\nconst STATES = homeConfig.AppStateTypes\n\nconst useStyles = makeStyles(theme => ({\n  root: {\n    height: '100%',\n    overflow: 'hidden',\n    display: 'flex',\n    flexDirection: 'column'\n  },\n  offlineBar: {\n    flex: '0 0'\n  },\n  activeWrapper: {\n    overflow: 'hidden',\n    flexGrow: 1,\n    flexShrink: 1\n  },\n  uploaderContainer: {\n    zIndex: 2000,\n    flex: '0 0'\n  }\n}))\n\n/**\n * This is the over-arching wrapper for the app. It combines all the\n * same place. Time will tell if that's a good strategy.\n */\nconst App = ({ domain, setHomeState, onCameraClick, onLibraryClick }) => {\n  const classes = useStyles()\n  const { signedIn, isVKeyBdOn } = useContext(AppContext)\n\n  useEffect(() => {\n    // Anonymous Users are only allowed home and search\n    if (!signedIn && [STATES.MAP, STATES.SEARCH].indexOf(domain) < 0) setHomeState(STATES.MAP)\n  }, [domain])\n\n  let showBottomBar = true\n  let ActiveComponent = FeedConnect\n  switch (domain) {\n    case STATES.FEED:\n      ActiveComponent = FeedConnect\n      break\n    case STATES.MAP:\n      ActiveComponent = MapConnect\n      break\n    case STATES.PROFILE:\n      ActiveComponent = ProfileConnect\n      break\n    case STATES.SEARCH:\n      ActiveComponent = SearchConnect\n      break\n    case STATES.SERIES:\n      ActiveComponent = SeriesConnect\n      showBottomBar = false\n      break\n    case STATES.NEW_SERIES_CAMERA:\n      ActiveComponent = SeriesConnect\n      showBottomBar = false\n      break\n    case STATES.NEW_SERIES_LIBRARY:\n      ActiveComponent = SeriesConnect\n      showBottomBar = false\n      break\n    default:\n      break\n  }\n\n  return (\n    <div className={classes.root}>\n      <CssBaseline /> {/* You only need this in a root element. Don't put it anywhere else in the dom */}\n      <OfflineBar className={classes.offlineBar} />\n      <div className={classes.activeWrapper}>\n        <ActiveComponent />\n      </div>\n      { showBottomBar && (\n        <BottomBar\n          signedIn={signedIn}\n          domain={domain}\n          onHomeClick={() => setHomeState(STATES.FEED)}\n          onMapClick={() => setHomeState(STATES.MAP)}\n          onSearchClick={() => setHomeState(STATES.SEARCH, { search: null })}\n          onProfileClick={() => setHomeState(STATES.PROFILE)}\n          onCameraClick={onCameraClick}\n          onLibraryClick={onLibraryClick}\n        />\n      )}\n      {/* Uploader is persistent across all views */}\n      <UploaderConnect className={classes.uploaderContainer} />\n    </div>\n  )\n}\n\nApp.propTypes = {\n  // All of this comes in from From Redux\n  domain: PropTypes.string.isRequired,\n  setHomeState: PropTypes.func.isRequired,\n  onCameraClick: PropTypes.func.isRequired,\n  onLibraryClick: PropTypes.func.isRequired\n}\n\nexport default App\n","import React, { useMemo } from 'react'\nimport { Query, ApolloProvider, compose } from 'react-apollo'\nimport { IntlWrapper } from './translations'\nimport { getUser } from './graphql/queries'\nimport themes from './themes'\nimport { AppContext } from './contexts'\nimport Loading from './components/auth/Loading'\nimport ErrorBoundary from './lib/ErrorBoundary'\nimport ErrorConnect from './graphql/Error.connect'\nimport { createApolloClient } from './lib/useGraphQL'\nimport useAuthentication from './lib/useAuthentication'\nimport useShowAddToHome from './lib/useShowAddToHome'\nimport useResponsive from './lib/useResponsive'\nimport withReduxProvider from './redux/withReduxProvider'\nimport { connect } from 'react-redux'\nimport actions from './redux/actions'\nimport config, { home as homeConfig } from './config'\n\nimport App from './App'\nimport { ThemeProvider } from '@material-ui/styles'\n\n/**\n * HOC for AppContext and ApolloProvider\n */\nexport const withApolloAuthProvider = Wrapped => (props) => {\n  // console.log('withApolloAuthProvider', props)\n  const { signedIn, isGod, authData, signOut, authScreen, accessToken, forceSignIn } = useAuthentication()\n  const apolloClient = useMemo(() => createApolloClient(accessToken), [accessToken])\n\n  // This triggers all the PWA Goodness\n  useShowAddToHome()\n  const responsive = useResponsive()\n\n  // If the user hasn't decided to be anonymous or sign in yet show them the login screen\n  console.log('Rendering AppConnect', { responsive, props, signedIn, isGod, authData })\n\n  if (signedIn === null) return authScreen\n\n  // These are the things the rest of the app needs to find:\n  const appContext = {\n    signOut,\n    forceSignIn,\n    ...responsive,\n    signedIn,\n    role: !signedIn\n      ? 'anonymous'\n      : isGod\n        ? 'admin'\n        : 'user',\n    currentUser: authData, // TODO: Need this supported by a graphql query\n    seriesConfig: {\n      meta: {},\n      tags: [\n        {\n          id: 'freeBothType',\n          label: null,\n          color: config.tagColors[0],\n          allowXY: true,\n          allowNonXY: true,\n          allowAdditions: true,\n          // This one returns a promise\n          getValues: () => Promise.resolve(['a', 'b', 'c']),\n          values: []\n        }\n      ],\n      getPhotoUrl: (photo, size) => {\n        try {\n          return `${photo.paths.base}${photo.paths[size]}`\n        }\n        catch (e) {\n          return null\n        }\n      }\n    }\n  }\n\n  return (\n  // We wrap the outside in an error handler\n\n    <ThemeProvider theme={themes.home}>\n      <ApolloProvider client={apolloClient}>\n        <Query query={getUser} skip={!signedIn}>\n          {({ loading, error, data }) => {\n            if (loading) return <Loading />\n            if (error) {\n              console.error(error)\n            }\n            if (signedIn) appContext.user = data.user\n            return (\n              <AppContext.Provider value={appContext}>\n                <IntlWrapper>\n\n                  <Wrapped {...props} />\n\n                </IntlWrapper>\n              </AppContext.Provider>\n            )\n          }}\n        </Query>\n      </ApolloProvider>\n    </ThemeProvider>\n  )\n}\n\n/**\n * Map our redux state and functions\n */\nconst mapStateToProps = (state, props) => {\n  const { domain } = state.home.current\n  return { domain }\n}\n\nconst mapDispatchToProps = dispatch => ({\n  setHomeState: (newDomain, newParams) => {\n    dispatch(actions.setHomeState(newDomain, newParams))\n  },\n  onCameraClick: () => {\n    dispatch(actions.setHomeState(homeConfig.AppStateTypes.NEW_SERIES_CAMERA))\n  },\n  onLibraryClick: () => {\n    dispatch(actions.setHomeState(homeConfig.AppStateTypes.NEW_SERIES_LIBRARY))\n  }\n})\n\nconst withErrorBoundary = (Wrapped) => (props) => (\n  <ErrorBoundary fallback={ErrorConnect}>\n    <Wrapped {...props} />\n  </ErrorBoundary>\n)\n\n/**\n * Nearly everything we do depends on who you are as a user so we commit this to state\n */\n\n// The order we compose things here matters a lot\nexport default compose(\n  // ORDER IS CRITICAL HERE\n  withReduxProvider,\n  withApolloAuthProvider,\n  connect(\n    mapStateToProps,\n    mapDispatchToProps\n  ),\n  withErrorBoundary\n)(App)\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n)\n\nexport function register (config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href)\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config)\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\n          )\n        })\n      }\n      else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config)\n      }\n    })\n  }\n}\n\nfunction registerValidSW (swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing\n        if (installingWorker == null) {\n          return\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n              )\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration)\n              }\n            }\n            else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.')\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration)\n              }\n            }\n          }\n        }\n      }\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error)\n    })\n}\n\nfunction checkValidServiceWorker (swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type')\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload()\n          })\n        })\n      }\n      else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config)\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      )\n    })\n}\n\nexport function unregister () {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister()\n    })\n  }\n}\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport AppConnect from './App.connect'\nimport * as serviceWorker from './serviceWorker'\n// Here's our global overrides css\nimport './index.css'\n// This is the font we need\nrequire('typeface-roboto')\n\nconsole.log('Rendering Main App')\nReactDOM.render(<AppConnect />, document.getElementById('root'))\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.register()\n"],"sourceRoot":""}